/*
Copyright (c) 2003-2014, CKSource - Frederico Knabben. All rights reserved.
For licensing, see LICENSE.html or http://ckeditor.com/license
*/
function mxDictionary(){this.clear()}function mxPoint(t,e){this.x=null!=t?t:0,this.y=null!=e?e:0}function mxRectangle(t,e,n,i){mxPoint.call(this,t,e),this.width=null!=n?n:0,this.height=null!=i?i:0}function mxEventObject(t){this.name=t,this.properties=[];for(var e=1;e<arguments.length;e+=2)null!=arguments[e+1]&&(this.properties[arguments[e]]=arguments[e+1])}function mxMouseEvent(t,e){this.evt=t,this.state=e}function mxEventSource(t){this.setEventSource(t)}function mxXmlRequest(t,e,n,i,o,r){this.url=t,this.params=e,this.method=n||"POST",this.async=null!=i?i:!0,this.username=o,this.password=r}function mxWindow(t,e,n,i,o,r,s,l,a,h){null!=e&&(s=null!=s?s:!0,this.content=e,this.init(n,i,o,r,h),this.installMaximizeHandler(),this.installMinimizeHandler(),this.installCloseHandler(),this.setMinimizable(s),this.setTitle(t),(null==l||l)&&this.installMoveHandler(),null!=a&&null!=a.parentNode?a.parentNode.replaceChild(this.div,a):document.body.appendChild(this.div))}function mxForm(t){this.table=document.createElement("table"),this.table.className=t,this.body=document.createElement("tbody"),this.table.appendChild(this.body)}function mxImage(t,e,n){this.src=t,this.width=e,this.height=n}function mxDivResizer(t,e){if("div"==t.nodeName.toLowerCase()){null==e&&(e=window),this.div=t;var n=mxUtils.getCurrentStyle(t);null!=n&&(this.resizeWidth="auto"==n.width,this.resizeHeight="auto"==n.height),mxEvent.addListener(e,"resize",mxUtils.bind(this,function(){this.handlingResize||(this.handlingResize=!0,this.resize(),this.handlingResize=!1)})),this.resize()}}function mxDragSource(t,e){this.element=t,this.dropHandler=e,mxEvent.addGestureListeners(t,mxUtils.bind(this,this.mouseDown))}function mxToolbar(t){this.container=t}function mxSession(t,e,n,i){this.model=t,this.urlInit=e,this.urlPoll=n,this.urlNotify=i,null!=t&&(this.codec=new mxCodec,this.codec.lookup=function(e){return t.getCell(e)}),t.addListener(mxEvent.NOTIFY,mxUtils.bind(this,function(t,e){var n=e.getProperty("edit");(null!=n&&this.debug||this.connected&&!this.suspended)&&this.notify("<edit>"+this.encodeChanges(n.changes,n.undone)+"</edit>")}))}function mxUndoableEdit(t,e){this.source=t,this.changes=[],this.significant=null!=e?e:!0}function mxUndoManager(t){this.size=null!=t?t:100,this.clear()}function mxPanningManager(t){this.thread=null,this.active=!1,this.dy=this.dx=this.t0y=this.t0x=this.tdy=this.tdx=0,this.scrollbars=!1,this.scrollTop=this.scrollLeft=0,this.mouseListener={mouseDown:function(){},mouseMove:function(){},mouseUp:mxUtils.bind(this,function(){this.active&&this.stop()})},t.addMouseListener(this.mouseListener),mxEvent.addListener(document,"mouseup",mxUtils.bind(this,function(){this.active&&this.stop()}));var e=mxUtils.bind(this,function(){return this.scrollbars=mxUtils.hasScrollbars(t.container),this.scrollLeft=t.container.scrollLeft,this.scrollTop=t.container.scrollTop,window.setInterval(mxUtils.bind(this,function(){if(this.tdx-=this.dx,this.tdy-=this.dy,this.scrollbars){var e=-t.container.scrollLeft-Math.ceil(this.dx),n=-t.container.scrollTop-Math.ceil(this.dy);t.panGraph(e,n),t.panDx=this.scrollLeft-t.container.scrollLeft,t.panDy=this.scrollTop-t.container.scrollTop,t.fireEvent(new mxEventObject(mxEvent.PAN))}else t.panGraph(this.getDx(),this.getDy())}),this.delay)});this.isActive=function(){return active},this.getDx=function(){return Math.round(this.tdx)},this.getDy=function(){return Math.round(this.tdy)},this.start=function(){this.t0x=t.view.translate.x,this.t0y=t.view.translate.y,this.active=!0},this.panTo=function(n,i,o,r){this.active||this.start(),this.scrollLeft=t.container.scrollLeft,this.scrollTop=t.container.scrollTop,r=null!=r?r:0;var s=t.container;this.dx=n+(null!=o?o:0)-s.scrollLeft-s.clientWidth,this.dx=0>this.dx&&Math.abs(this.dx)<this.border?this.border+this.dx:this.handleMouseOut?Math.max(this.dx,0):0,0==this.dx&&(this.dx=n-s.scrollLeft,this.dx=0<this.dx&&this.dx<this.border?this.dx-this.border:this.handleMouseOut?Math.min(0,this.dx):0),this.dy=i+r-s.scrollTop-s.clientHeight,this.dy=0>this.dy&&Math.abs(this.dy)<this.border?this.border+this.dy:this.handleMouseOut?Math.max(this.dy,0):0,0==this.dy&&(this.dy=i-s.scrollTop,this.dy=0<this.dy&&this.dy<this.border?this.dy-this.border:this.handleMouseOut?Math.min(0,this.dy):0),0!=this.dx||0!=this.dy?(this.dx*=this.damper,this.dy*=this.damper,null==this.thread&&(this.thread=e())):null!=this.thread&&(window.clearInterval(this.thread),this.thread=null)},this.stop=function(){if(this.active)if(this.active=!1,null!=this.thread&&(window.clearInterval(this.thread),this.thread=null),this.tdy=this.tdx=0,this.scrollbars)t.panDx=0,t.panDy=0,t.fireEvent(new mxEventObject(mxEvent.PAN));else{var e=t.panDx,n=t.panDy;(0!=e||0!=n)&&(t.panGraph(0,0),t.view.setTranslate(this.t0x+e/t.view.scale,this.t0y+n/t.view.scale))}},this.destroy=function(){t.removeMouseListener(this.mouseListener)}}function mxPopupMenu(t){this.factoryMethod=t,null!=t&&this.init()}function mxAutoSaveManager(t){this.changeHandler=mxUtils.bind(this,function(t,e){this.isEnabled()&&this.graphModelChanged(e.getProperty("edit").changes)}),this.setGraph(t)}function mxAnimation(t){this.delay=null!=t?t:20}function mxMorphing(t,e,n,i){mxAnimation.call(this,i),this.graph=t,this.steps=null!=e?e:6,this.ease=null!=n?n:1.5}function mxImageBundle(t){this.images=[],this.alt=null!=t?t:!1}function mxImageExport(){}function mxAbstractCanvas2D(){this.converter=this.createUrlConverter(),this.reset()}function mxXmlCanvas2D(t){mxAbstractCanvas2D.call(this),this.root=t,this.writeDefaults()}function mxSvgCanvas2D(t,e){mxAbstractCanvas2D.call(this),this.root=t,this.gradients=[],this.defs=null,this.styleEnabled=null!=e?e:!1;var n=null;if(t.ownerDocument!=document)for(n=t;null!=n&&"svg"!=n.nodeName;)n=n.parentNode;null!=n&&(0<n.getElementsByTagName("defs").length&&(this.defs=n.getElementsByTagName("defs")[0]),null==this.defs&&(this.defs=this.createElement("defs"),null!=n.firstChild?n.insertBefore(this.defs,n.firstChild):n.appendChild(this.defs)),this.styleEnabled&&this.defs.appendChild(this.createStyle()))}function mxGuide(t,e){this.graph=t,this.setStates(e)}function mxStencil(t){this.desc=t,this.parseDescription(),this.parseConstraints()}function mxShape(t){this.stencil=t,this.strokewidth=1,this.rotation=0,this.opacity=100,this.flipV=this.flipH=!1}function mxActor(t,e,n,i){mxShape.call(this),this.bounds=t,this.fill=e,this.stroke=n,this.strokewidth=null!=i?i:1}function mxCloud(t,e,n,i){mxActor.call(this),this.bounds=t,this.fill=e,this.stroke=n,this.strokewidth=null!=i?i:1}function mxRectangleShape(t,e,n,i){mxShape.call(this),this.bounds=t,this.fill=e,this.stroke=n,this.strokewidth=null!=i?i:1}function mxEllipse(t,e,n,i){mxShape.call(this),this.bounds=t,this.fill=e,this.stroke=n,this.strokewidth=null!=i?i:1}function mxDoubleEllipse(t,e,n,i){mxShape.call(this),this.bounds=t,this.fill=e,this.stroke=n,this.strokewidth=null!=i?i:1}function mxRhombus(t,e,n,i){mxShape.call(this),this.bounds=t,this.fill=e,this.stroke=n,this.strokewidth=null!=i?i:1}function mxPolyline(t,e,n){mxShape.call(this),this.points=t,this.stroke=e,this.strokewidth=null!=n?n:1}function mxArrow(t,e,n,i,o,r,s){mxShape.call(this),this.points=t,this.fill=e,this.stroke=n,this.strokewidth=null!=i?i:1,this.arrowWidth=null!=o?o:mxConstants.ARROW_WIDTH,this.spacing=null!=r?r:mxConstants.ARROW_SPACING,this.endSize=null!=s?s:mxConstants.ARROW_SIZE}function mxText(t,e,n,i,o,r,s,l,a,h,d,u,c,p,m,g,f,x,C,E){mxShape.call(this),this.value=t,this.bounds=e,this.color=null!=o?o:"black",this.align=null!=n?n:"",this.valign=null!=i?i:"",this.family=null!=r?r:mxConstants.DEFAULT_FONTFAMILY,this.size=null!=s?s:mxConstants.DEFAULT_FONTSIZE,this.fontStyle=null!=l?l:mxConstants.DEFAULT_FONTSTYLE,this.spacing=parseInt(a||2),this.spacingTop=this.spacing+parseInt(h||0),this.spacingRight=this.spacing+parseInt(d||0),this.spacingBottom=this.spacing+parseInt(u||0),this.spacingLeft=this.spacing+parseInt(c||0),this.horizontal=null!=p?p:!0,this.background=m,this.border=g,this.wrap=null!=f?f:!1,this.clipped=null!=x?x:!1,this.overflow=null!=C?C:"visible",this.labelPadding=null!=E?E:0,this.rotation=0}function mxTriangle(){mxActor.call(this)}function mxHexagon(){mxActor.call(this)}function mxLine(t,e,n){mxShape.call(this),this.bounds=t,this.stroke=e,this.strokewidth=null!=n?n:1}function mxImageShape(t,e,n,i,o){mxShape.call(this),this.bounds=t,this.image=e,this.fill=n,this.stroke=i,this.strokewidth=null!=o?o:1,this.shadow=!1}function mxLabel(t,e,n,i){mxRectangleShape.call(this,t,e,n,i)}function mxCylinder(t,e,n,i){mxShape.call(this),this.bounds=t,this.fill=e,this.stroke=n,this.strokewidth=null!=i?i:1}function mxConnector(t,e,n){mxPolyline.call(this,t,e,n)}function mxSwimlane(t,e,n,i){mxShape.call(this),this.bounds=t,this.fill=e,this.stroke=n,this.strokewidth=null!=i?i:1}function mxGraphLayout(t){this.graph=t}function mxStackLayout(t,e,n,i,o,r){mxGraphLayout.call(this,t),this.horizontal=null!=e?e:!0,this.spacing=null!=n?n:0,this.x0=null!=i?i:0,this.y0=null!=o?o:0,this.border=null!=r?r:0}function mxPartitionLayout(t,e,n,i){mxGraphLayout.call(this,t),this.horizontal=null!=e?e:!0,this.spacing=n||0,this.border=i||0}function mxCompactTreeLayout(t,e,n){mxGraphLayout.call(this,t),this.horizontal=null!=e?e:!0,this.invert=null!=n?n:!1}function WeightedCellSorter(t,e){this.cell=t,this.weightedValue=e}function mxFastOrganicLayout(t){mxGraphLayout.call(this,t)}function mxCircleLayout(t,e){mxGraphLayout.call(this,t),this.radius=null!=e?e:100}function mxParallelEdgeLayout(t){mxGraphLayout.call(this,t)}function mxCompositeLayout(t,e,n){mxGraphLayout.call(this,t),this.layouts=e,this.master=n}function mxEdgeLabelLayout(t){mxGraphLayout.call(this,t)}function mxGraphAbstractHierarchyCell(){this.x=[],this.y=[],this.temp=[]}function mxGraphHierarchyNode(t){mxGraphAbstractHierarchyCell.apply(this,arguments),this.cell=t}function mxGraphHierarchyEdge(t){mxGraphAbstractHierarchyCell.apply(this,arguments),this.edges=t}function mxGraphHierarchyModel(t,e,n,i,o){for(t.getGraph(),this.tightenToSource=o,this.roots=n,this.parent=i,this.vertexMapper={},this.edgeMapper={},this.maxRank=0,n=[],null==e&&(e=this.graph.getChildVertices(i)),this.maxRank=this.SOURCESCANSTARTRANK,this.createInternalCells(t,e,n),i=0;i<e.length;i++){o=n[i].connectsAsSource;for(var r=0;r<o.length;r++){var s=o[r],l=s.edges;if(null!=l&&0<l.length){var l=l[0],a=t.getVisibleTerminal(l,!1),a=mxCellPath.create(a),a=this.vertexMapper[a];n[i]==a&&(a=t.getVisibleTerminal(l,!0),a=mxCellPath.create(a),a=this.vertexMapper[a]),null!=a&&n[i]!=a&&(s.target=a,0==a.connectsAsTarget.length&&(a.connectsAsTarget=[]),0>mxUtils.indexOf(a.connectsAsTarget,s)&&a.connectsAsTarget.push(s))}}n[i].temp[0]=1}}function mxHierarchicalLayoutStage(){}function mxMedianHybridCrossingReduction(t){this.layout=t}function MedianCellSorter(){}function mxMinimumCycleRemover(t){this.layout=t}function mxCoordinateAssignment(t,e,n,i,o,r){this.layout=t,this.intraCellSpacing=e,this.interRankCellSpacing=n,this.orientation=i,this.initialX=o,this.parallelEdgeSpacing=r}function WeightedCellSorter(t,e){this.cell=t,this.weightedValue=e}function mxHierarchicalLayout(t,e,n){mxGraphLayout.call(this,t),this.orientation=null!=e?e:mxConstants.DIRECTION_NORTH,this.deterministic=null!=n?n:!0}function mxGraphModel(t){this.currentEdit=this.createUndoableEdit(),null!=t?this.setRoot(t):this.clear()}function mxRootChange(t,e){this.model=t,this.previous=this.root=e}function mxChildChange(t,e,n,i){this.model=t,this.previous=this.parent=e,this.child=n,this.previousIndex=this.index=i}function mxTerminalChange(t,e,n,i){this.model=t,this.cell=e,this.previous=this.terminal=n,this.source=i}function mxValueChange(t,e,n){this.model=t,this.cell=e,this.previous=this.value=n}function mxStyleChange(t,e,n){this.model=t,this.cell=e,this.previous=this.style=n}function mxGeometryChange(t,e,n){this.model=t,this.cell=e,this.previous=this.geometry=n}function mxCollapseChange(t,e,n){this.model=t,this.cell=e,this.previous=this.collapsed=n}function mxVisibleChange(t,e,n){this.model=t,this.cell=e,this.previous=this.visible=n}function mxCellAttributeChange(t,e,n){this.cell=t,this.attribute=e,this.previous=this.value=n}function mxCell(t,e,n){this.value=t,this.setGeometry(e),this.setStyle(n),null!=this.onInit&&this.onInit()}function mxGeometry(t,e,n,i){mxRectangle.call(this,t,e,n,i)}function mxPrintPreview(t,e,n,i,o,r,s,l,a){this.graph=t,this.scale=null!=e?e:1/t.pageScale,this.border=null!=i?i:0,this.pageFormat=null!=n?n:t.pageFormat,this.title=null!=l?l:"Printer-friendly version",this.x0=null!=o?o:0,this.y0=null!=r?r:0,this.borderColor=s,this.pageSelector=null!=a?a:!0}function mxStylesheet(){this.styles={},this.putDefaultVertexStyle(this.createDefaultVertexStyle()),this.putDefaultEdgeStyle(this.createDefaultEdgeStyle())}function mxCellState(t,e,n){this.view=t,this.cell=e,this.style=n,this.origin=new mxPoint,this.absoluteOffset=new mxPoint}function mxGraphSelectionModel(t){this.graph=t,this.cells=[]}function mxSelectionChange(t,e,n){this.selectionModel=t,this.added=null!=e?e.slice():null,this.removed=null!=n?n.slice():null}function mxCellEditor(t){this.graph=t}function mxCellRenderer(){}function mxGraphView(t){this.graph=t,this.translate=new mxPoint,this.graphBounds=new mxRectangle,this.states=new mxDictionary}function mxCurrentRootChange(t,e){if(this.view=t,this.previous=this.root=e,this.isUp=null==e,!this.isUp)for(var n=this.view.currentRoot,i=this.view.graph.getModel();null!=n;){if(n==e){this.isUp=!0;break}n=i.getParent(n)}}function mxGraph(t,e,n,i){this.mouseListeners=null,this.renderHint=n,this.dialect=mxClient.IS_SVG?mxConstants.DIALECT_SVG:n==mxConstants.RENDERING_HINT_EXACT&&mxClient.IS_VML?mxConstants.DIALECT_VML:n==mxConstants.RENDERING_HINT_FASTEST?mxConstants.DIALECT_STRICTHTML:n==mxConstants.RENDERING_HINT_FASTER?mxConstants.DIALECT_PREFERHTML:mxConstants.DIALECT_MIXEDHTML,this.model=null!=e?e:new mxGraphModel,this.multiplicities=[],this.imageBundles=[],this.cellRenderer=this.createCellRenderer(),this.setSelectionModel(this.createSelectionModel()),this.setStylesheet(null!=i?i:this.createStylesheet()),this.view=this.createGraphView(),this.graphModelChangeListener=mxUtils.bind(this,function(t,e){this.graphModelChanged(e.getProperty("edit").changes)}),this.model.addListener(mxEvent.CHANGE,this.graphModelChangeListener),this.createHandlers(),null!=t&&this.init(t),this.view.revalidate()}function mxCellOverlay(t,e,n,i,o,r){this.image=t,this.tooltip=e,this.align=null!=n?n:this.align,this.verticalAlign=null!=i?i:this.verticalAlign,this.offset=null!=o?o:new mxPoint,this.cursor=null!=r?r:"help"}function mxOutline(t,e){this.source=t,null!=e&&this.init(e)}function mxMultiplicity(t,e,n,i,o,r,s,l,a,h){this.source=t,this.type=e,this.attr=n,this.value=i,this.min=null!=o?o:0,this.max=null!=r?r:"n",this.validNeighbors=s,this.countError=mxResources.get(l)||l,this.typeError=mxResources.get(a)||a,this.validNeighborsAllowed=null!=h?h:!0}function mxLayoutManager(t){this.undoHandler=mxUtils.bind(this,function(t,e){this.isEnabled()&&this.beforeUndo(e.getProperty("edit"))}),this.moveHandler=mxUtils.bind(this,function(t,e){this.isEnabled()&&this.cellsMoved(e.getProperty("cells"),e.getProperty("event"))}),this.setGraph(t)}function mxSpaceManager(t,e,n,i){this.resizeHandler=mxUtils.bind(this,function(t,e){this.isEnabled()&&this.cellsResized(e.getProperty("cells"))}),this.foldHandler=mxUtils.bind(this,function(t,e){this.isEnabled()&&this.cellsResized(e.getProperty("cells"))}),this.shiftRightwards=null!=e?e:!0,this.shiftDownwards=null!=n?n:!0,this.extendParents=null!=i?i:!0,this.setGraph(t)}function mxSwimlaneManager(t,e,n,i){this.horizontal=null!=e?e:!0,this.addEnabled=null!=n?n:!0,this.resizeEnabled=null!=i?i:!0,this.addHandler=mxUtils.bind(this,function(t,e){this.isEnabled()&&this.isAddEnabled()&&this.cellsAdded(e.getProperty("cells"))}),this.resizeHandler=mxUtils.bind(this,function(t,e){this.isEnabled()&&this.isResizeEnabled()&&this.cellsResized(e.getProperty("cells"))}),this.setGraph(t)}function mxTemporaryCellStates(t,e,n){if(this.view=t,e=null!=e?e:1,this.oldBounds=t.getGraphBounds(),this.oldStates=t.getStates(),this.oldScale=t.getScale(),t.setStates(new mxDictionary),t.setScale(e),null!=n){e=t.createState(new mxCell);for(var i=0;i<n.length;i++)t.validateBounds(e,n[i]);for(var o=null,i=0;i<n.length;i++){var r=t.validatePoints(e,n[i]);null==o?o=r:o.add(r)}null==o&&(o=new mxRectangle),t.setGraphBounds(o)}}function mxCellStatePreview(t){this.graph=t,this.deltas={}}function mxConnectionConstraint(t,e){this.point=t,this.perimeter=null!=e?e:!0}function mxGraphHandler(t){this.graph=t,this.graph.addMouseListener(this),this.panHandler=mxUtils.bind(this,function(){this.updatePreviewShape()}),this.graph.addListener(mxEvent.PAN,this.panHandler)}function mxPanningHandler(t,e){null!=t&&(this.graph=t,this.factoryMethod=e,this.graph.addMouseListener(this),this.init())}function mxCellMarker(t,e,n,i){mxEventSource.call(this),null!=t&&(this.graph=t,this.validColor=null!=e?e:mxConstants.DEFAULT_VALID_COLOR,this.invalidColor=null!=e?n:mxConstants.DEFAULT_INVALID_COLOR,this.hotspot=null!=i?i:mxConstants.DEFAULT_HOTSPOT,this.highlight=new mxCellHighlight(t))}function mxSelectionCellsHandler(t){mxEventSource.call(this),this.graph=t,this.handlers=new mxDictionary,this.graph.addMouseListener(this),this.refreshHandler=mxUtils.bind(this,function(){this.isEnabled()&&this.refresh()}),this.graph.getSelectionModel().addListener(mxEvent.CHANGE,this.refreshHandler),this.graph.getModel().addListener(mxEvent.CHANGE,this.refreshHandler),this.graph.getView().addListener(mxEvent.SCALE,this.refreshHandler),this.graph.getView().addListener(mxEvent.TRANSLATE,this.refreshHandler),this.graph.getView().addListener(mxEvent.SCALE_AND_TRANSLATE,this.refreshHandler),this.graph.getView().addListener(mxEvent.DOWN,this.refreshHandler),this.graph.getView().addListener(mxEvent.UP,this.refreshHandler)}function mxConnectionHandler(t,e){mxEventSource.call(this),null!=t&&(this.graph=t,this.factoryMethod=e,this.init())}function mxConstraintHandler(t){this.graph=t}function mxRubberband(t){null!=t&&(this.graph=t,this.graph.addMouseListener(this),this.panHandler=mxUtils.bind(this,function(){this.repaint()}),this.graph.addListener(mxEvent.PAN,this.panHandler),mxClient.IS_IE&&mxEvent.addListener(window,"unload",mxUtils.bind(this,function(){this.destroy()})))}function mxVertexHandler(t){null!=t&&(this.state=t,this.init())}function mxEdgeHandler(t){null!=t&&(this.state=t,this.init())}function mxElbowEdgeHandler(t){mxEdgeHandler.call(this,t)}function mxEdgeSegmentHandler(t){mxEdgeHandler.call(this,t)}function mxKeyHandler(t,e){null!=t&&(this.graph=t,this.target=e||document.documentElement,this.normalKeys=[],this.shiftKeys=[],this.controlKeys=[],this.controlShiftKeys=[],mxEvent.addListener(this.target,"keydown",mxUtils.bind(this,function(t){this.keyDown(t)})),mxClient.IS_IE&&mxEvent.addListener(window,"unload",mxUtils.bind(this,function(){this.destroy()})))}function mxTooltipHandler(t,e){null!=t&&(this.graph=t,this.delay=e||500,this.graph.addMouseListener(this))}function mxCellTracker(t,e,n){mxCellMarker.call(this,t,e),this.graph.addMouseListener(this),null!=n&&(this.getCell=n),mxClient.IS_IE&&mxEvent.addListener(window,"unload",mxUtils.bind(this,function(){this.destroy()}))}function mxCellHighlight(t,e,n,i){null!=t&&(this.graph=t,this.highlightColor=null!=e?e:mxConstants.DEFAULT_VALID_COLOR,this.strokeWidth=null!=n?n:mxConstants.HIGHLIGHT_STROKEWIDTH,this.dashed=null!=i?i:!1,this.repaintHandler=mxUtils.bind(this,function(){null!=this.state&&(this.state=this.graph.view.getState(this.state.cell),null==this.state?this.hide():this.repaint())}),this.graph.getView().addListener(mxEvent.SCALE,this.repaintHandler),this.graph.getView().addListener(mxEvent.TRANSLATE,this.repaintHandler),this.graph.getView().addListener(mxEvent.SCALE_AND_TRANSLATE,this.repaintHandler),this.graph.getModel().addListener(mxEvent.CHANGE,this.repaintHandler),this.resetHandler=mxUtils.bind(this,function(){this.hide()}),this.graph.getView().addListener(mxEvent.DOWN,this.resetHandler),this.graph.getView().addListener(mxEvent.UP,this.resetHandler))}function mxDefaultKeyHandler(t){if(null!=t){this.editor=t,this.handler=new mxKeyHandler(t.graph);var e=this.handler.escape;this.handler.escape=function(n){e.apply(this,arguments),t.hideProperties(),t.fireEvent(new mxEventObject(mxEvent.ESCAPE,"event",n))}}}function mxDefaultPopupMenu(t){this.config=t}function mxDefaultToolbar(t,e){this.editor=e,null!=t&&null!=e&&this.init(t)}function mxEditor(t){this.actions=[],this.addActions(),null!=document.body&&(this.cycleAttributeValues=[],this.popupHandler=new mxDefaultPopupMenu,this.undoManager=new mxUndoManager,this.graph=this.createGraph(),this.toolbar=this.createToolbar(),this.keyHandler=new mxDefaultKeyHandler(this),this.configure(t),this.graph.swimlaneIndicatorColorAttribute=this.cycleAttributeName,!mxClient.IS_LOCAL&&null!=this.urlInit&&(this.session=this.createSession()),null!=this.onInit&&this.onInit(),mxClient.IS_IE&&mxEvent.addListener(window,"unload",mxUtils.bind(this,function(){this.destroy()})))}function mxCodec(t){this.document=t||mxUtils.createXmlDocument(),this.objects=[]}function mxObjectCodec(t,e,n,i){this.template=t,this.exclude=null!=e?e:[],this.idrefs=null!=n?n:[],this.mapping=null!=i?i:[],this.reverse={};for(var o in this.mapping)this.reverse[this.mapping[o]]=o}/**
 * $Id: Actions.js,v 1.9 2013/04/10 11:26:47 gaudenz Exp $
 * Copyright (c) 2006-2012, JGraph Ltd
 */
function Actions(t){this.editorUi=t,this.actions=new Object,this.init()}function Action(t,e,n,i,o){mxEventSource.call(this),this.label=t,this.funct=e,this.enabled=null!=n?n:!0,this.iconCls=i,this.shortcut=o}/**
 * $Id: Dialogs.js,v 1.7 2013/05/07 06:54:12 gaudenz Exp $
 * Copyright (c) 2006-2012, JGraph Ltd
 */
function Dialog(t,e,n,i,o,r,s){var l=0;mxClient.IS_IE&&9!=document.documentMode&&(l=60),n+=l,i+=l;var a=Math.max(0,Math.round((document.body.scrollWidth-n)/2)),h=Math.max(0,Math.round((Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)-i)/3)),d=t.createDiv("geDialog");if(d.style.width=n+"px",d.style.height=i+"px",d.style.left=a+"px",d.style.top=h+"px",null==this.bg&&(this.bg=t.createDiv("background"),this.bg.style.position="absolute",this.bg.style.background="white",this.bg.style.left="0px",this.bg.style.top="0px",this.bg.style.bottom="0px",this.bg.style.right="0px",mxUtils.setOpacity(this.bg,80),mxClient.IS_QUIRKS&&new mxDivResizer(this.bg)),o&&document.body.appendChild(this.bg),d.appendChild(e),document.body.appendChild(d),r){var u=document.createElement("img");u.setAttribute("src",IMAGE_PATH+"/close.png"),u.setAttribute("title",mxResources.get("close")),u.className="geDialogClose",u.style.top=h+14+"px",u.style.left=a+n+38-l+"px",mxEvent.addListener(u,"click",mxUtils.bind(this,function(){t.hideDialog()})),document.body.appendChild(u),this.dialogImg=u}this.onDialogClose=s,this.container=d}function OpenDialog(){var t=document.createElement("iframe");t.style.backgroundColor="transparent",t.allowTransparency="true",t.style.borderStyle="none",t.style.borderWidth="0px",t.style.overflow="hidden",t.frameBorder="0",t.setAttribute("width","320px"),t.setAttribute("height","190px"),t.setAttribute("src",OPEN_FORM),this.container=t}function ColorDialog(t,e,n){function i(t,e){e=null!=e?e:12;var n=document.createElement("table");n.style.borderCollapse="collapse",n.setAttribute("cellspacing","0"),n.style.marginBottom="20px",n.style.cellSpacing="0px";var i=document.createElement("tbody");n.appendChild(i);for(var s=t.length/e,a=0;s>a;a++){for(var h=document.createElement("tr"),d=0;e>d;d++)!function(t){var e=document.createElement("td");e.style.border="1px solid black",e.style.padding="0px",e.style.width="16px",e.style.height="16px","none"==t?e.style.background="url('"+IMAGE_PATH+"/nocolor.png')":e.style.backgroundColor="#"+t,h.appendChild(e),mxEvent.addListener(e,"click",function(){"none"==t?(r.fromString("ffffff"),o.value="none"):r.fromString(t)})}(t[a*e+d]);i.appendChild(h)}return l.appendChild(n),n}this.editorUi=t;var o=document.createElement("input");o.style.marginBottom="10px",o.style.width="216px",mxClient.IS_IE&&(o.style.marginTop="10px",document.body.appendChild(o));var r=new jscolor.color(o);r.pickerOnfocus=!1,r.showPicker();var s=document.createElement("div");jscolor.picker.box.style.position="relative",jscolor.picker.box.style.width="230px",jscolor.picker.box.style.height="100px",jscolor.picker.box.style.paddingBottom="10px",s.appendChild(jscolor.picker.box);var l=document.createElement("center");s.appendChild(o),mxUtils.br(s);var a=i(["E6D0DE","CDA2BE","B5739D","E1D5E7","C3ABD0","A680B8","D4E1F5","A9C4EB","7EA6E0","D5E8D4","9AC7BF","67AB9F","D5E8D4","B9E0A5","97D077","FFF2CC","FFE599","FFD966","FFF4C3","FFCE9F","FFB570","F8CECC","F19C99","EA6B66"],12);a.style.marginBottom="8px",a=i(["none","FFFFFF","E6E6E6","CCCCCC","B3B3B3","999999","808080","666666","4D4D4D","333333","1A1A1A","000000","FFCCCC","FFE6CC","FFFFCC","E6FFCC","CCFFCC","CCFFE6","CCFFFF","CCE5FF","CCCCFF","E5CCFF","FFCCFF","FFCCE6","FF9999","FFCC99","FFFF99","CCFF99","99FF99","99FFCC","99FFFF","99CCFF","9999FF","CC99FF","FF99FF","FF99CC","FF6666","FFB366","FFFF66","B3FF66","66FF66","66FFB3","66FFFF","66B2FF","6666FF","B266FF","FF66FF","FF66B3","FF3333","FF9933","FFFF33","99FF33","33FF33","33FF99","33FFFF","3399FF","3333FF","9933FF","FF33FF","FF3399","FF0000","FF8000","FFFF00","80FF00","00FF00","00FF80","00FFFF","007FFF","0000FF","7F00FF","FF00FF","FF0080","CC0000","CC6600","CCCC00","66CC00","00CC00","00CC66","00CCCC","0066CC","0000CC","6600CC","CC00CC","CC0066","990000","994C00","999900","4D9900","009900","00994D","009999","004C99","000099","4C0099","990099","99004D","660000","663300","666600","336600","006600","006633","006666","003366","000066","330066","660066","660033","330000","331A00","333300","1A3300","003300","00331A","003333","001933","000033","190033","330033","33001A"]),a.style.marginBottom="16px",s.appendChild(l);var h=document.createElement("div");h.style.textAlign="right",h.style.whiteSpace="nowrap";var d=null!=n?n:this.createApplyFunction();h.appendChild(mxUtils.button(mxResources.get("apply"),function(){var e=o.value;"none"!=e&&(e="#"+e),d(e),t.hideDialog()})),h.appendChild(mxUtils.button(mxResources.get("cancel"),function(){t.hideDialog()})),null!=e&&("none"==e?(r.fromString("ffffff"),o.value="none"):r.fromString(e)),s.appendChild(h),this.picker=r,this.colorInput=o,this.container=s}function AboutDialog(t){var e=document.createElement("div");e.setAttribute("align","center");var n=document.createElement("h3");mxUtils.write(n,mxResources.get("about")+" GraphEditor"),e.appendChild(n);var i=document.createElement("img");i.style.border="0px",i.setAttribute("width","176"),i.setAttribute("width","151"),i.setAttribute("src",IMAGE_PATH+"/logo.png"),e.appendChild(i),mxUtils.br(e),mxUtils.write(e,"Powered by mxGraph "+mxClient.VERSION),mxUtils.br(e);var o=document.createElement("a");o.setAttribute("href","http://www.jgraph.com/"),o.setAttribute("target","_blank"),mxUtils.write(o,"www.jgraph.com"),e.appendChild(o),mxUtils.br(e),mxUtils.br(e),e.appendChild(mxUtils.button(mxResources.get("close"),function(){t.hideDialog()})),this.container=e}function PageSetupDialog(t){var e,n,i=t.editor.graph,o=mxConstants.PAGE_FORMAT_A4_PORTRAIT,r=i.pageFormat.width==o.width&&i.pageFormat.height==o.height||i.pageFormat.height==o.width&&i.pageFormat.width==o.height?o:mxConstants.PAGE_FORMAT_LETTER_PORTRAIT,s=document.createElement("table");s.style.width="100%",s.style.height="100%";var l=document.createElement("tbody");e=document.createElement("tr"),n=document.createElement("td"),n.style.fontSize="10pt",mxUtils.write(n,mxResources.get("paperSize")+":"),e.appendChild(n);var a=document.createElement("select"),h=document.createElement("option");h.setAttribute("value","a4"),mxUtils.write(h,"A4"),a.appendChild(h);var d=document.createElement("option");d.setAttribute("value","letter"),mxUtils.write(d,"Letter"),a.appendChild(d),r===mxConstants.PAGE_FORMAT_LETTER_PORTRAIT&&d.setAttribute("selected","selected"),n=document.createElement("td"),n.style.fontSize="10pt",n.appendChild(a),e.appendChild(n),l.appendChild(e),e=document.createElement("tr"),n=document.createElement("td"),e.appendChild(n);var u=document.createElement("input");u.setAttribute("type","checkbox"),i.pageFormat.width==r.height&&u.setAttribute("checked","checked"),n=document.createElement("td"),n.style.padding="4 0 16 2px",n.style.fontSize="10pt",n.appendChild(u),mxUtils.write(n," "+mxResources.get("landscape")),e.appendChild(n),l.appendChild(e),e=document.createElement("tr"),n=document.createElement("td"),n.style.fontSize="10pt",n.style.width="130px",mxUtils.write(n,mxResources.get("pageScale")+":"),e.appendChild(n);var c=document.createElement("input");c.setAttribute("value",100*t.editor.graph.pageScale+"%"),c.style.width="60px",n=document.createElement("td"),n.appendChild(c),e.appendChild(n),l.appendChild(e),e=document.createElement("tr"),n=document.createElement("td"),n.colSpan=2,n.style.paddingTop="40px",n.setAttribute("align","right"),n.appendChild(mxUtils.button(mxResources.get("ok"),function(){t.hideDialog();var e=u.checked;i.pageFormat="letter"==a.value?e?mxConstants.PAGE_FORMAT_LETTER_LANDSCAPE:mxConstants.PAGE_FORMAT_LETTER_PORTRAIT:e?mxConstants.PAGE_FORMAT_A4_LANDSCAPE:mxConstants.PAGE_FORMAT_A4_PORTRAIT,t.editor.outline.outline.pageFormat=i.pageFormat,i.pageScale=parseInt(c.value)/100,i.pageVisible?(t.editor.updateGraphComponents(),i.view.validateBackground(),i.sizeDidChange(),t.editor.outline.update()):t.actions.get("pageView").funct()})),n.appendChild(mxUtils.button(mxResources.get("cancel"),function(){t.hideDialog()})),e.appendChild(n),l.appendChild(e),l.appendChild(e),s.appendChild(l),this.container=s}function PrintDialog(t){function e(){var t=c.checked,e="letter"==h.value?t?mxConstants.PAGE_FORMAT_LETTER_LANDSCAPE:mxConstants.PAGE_FORMAT_LETTER_PORTRAIT:t?mxConstants.PAGE_FORMAT_A4_LANDSCAPE:mxConstants.PAGE_FORMAT_A4_PORTRAIT,n=1/o.pageScale;if(p.checked){var i=parseInt(m.value);isNaN(i)||(n=mxUtils.getScaleForPageCount(i,o,e))}var r=o.getGraphBounds(),s=p.checked,l=0,a=0,d=0,u=r.width>0?r.x/o.view.scale-o.view.translate.x:0,g=r.height>0?r.y/o.view.scale-o.view.translate.y:0;if(0>u||0>g)if(s=!0,o.pageVisible){var f=o.pageScale,x=e.width*f,C=e.height*f;a=u>0?u:e.width*-Math.floor(Math.min(0,u)/x)+Math.min(0,u)/o.pageScale,d=g>0?g:e.height*-Math.floor(Math.min(0,g)/C)+Math.min(0,g)/o.pageScale}else a=10,d=10;var E=new mxPrintPreview(o,n,e,l,a,d);return E.title=mxResources.get("preview"),E.autoOrigin=s,E.open()}var n,i,o=t.editor.graph,r=mxConstants.PAGE_FORMAT_A4_PORTRAIT,s=o.pageFormat.width==r.width&&o.pageFormat.height==r.height||o.pageFormat.height==r.width&&o.pageFormat.width==r.height?r:mxConstants.PAGE_FORMAT_LETTER_PORTRAIT,l=document.createElement("table");l.style.width="100%",l.style.height="100%";var a=document.createElement("tbody");n=document.createElement("tr"),i=document.createElement("td"),i.style.fontSize="10pt",mxUtils.write(i,mxResources.get("paperSize")+":"),n.appendChild(i);var h=document.createElement("select"),d=document.createElement("option");d.setAttribute("value","a4"),mxUtils.write(d,"A4"),h.appendChild(d);var u=document.createElement("option");u.setAttribute("value","letter"),mxUtils.write(u,"Letter"),h.appendChild(u),s===mxConstants.PAGE_FORMAT_LETTER_PORTRAIT&&u.setAttribute("selected","selected"),i=document.createElement("td"),i.style.fontSize="10pt",i.appendChild(h),n.appendChild(i),a.appendChild(n),n=document.createElement("tr"),i=document.createElement("td"),n.appendChild(i);var c=document.createElement("input");c.setAttribute("type","checkbox"),o.pageFormat.width==s.height&&c.setAttribute("checked","checked"),i=document.createElement("td"),i.style.padding="4 0 16 2px",i.style.fontSize="10pt",i.appendChild(c),mxUtils.write(i," "+mxResources.get("landscape")),n.appendChild(i),a.appendChild(n),n=document.createElement("tr");var p=document.createElement("input");p.setAttribute("type","checkbox"),i=document.createElement("td"),i.style.paddingRight="10px",i.style.fontSize="10pt",i.appendChild(p),mxUtils.write(i," "+mxResources.get("posterPrint")+":"),n.appendChild(i);var m=document.createElement("input");m.setAttribute("value","1"),m.setAttribute("type","number"),m.setAttribute("min","1"),m.setAttribute("size","4"),m.setAttribute("disabled","disabled"),m.style.width="50px",i=document.createElement("td"),i.style.fontSize="10pt",i.appendChild(m),mxUtils.write(i," "+mxResources.get("pages")),n.appendChild(i),a.appendChild(n),mxEvent.addListener(p,"change",function(){p.checked?m.removeAttribute("disabled"):m.setAttribute("disabled","disabled")}),n=document.createElement("tr"),i=document.createElement("td"),i.colSpan=2,i.style.paddingTop="40px",i.setAttribute("align","right"),i.appendChild(mxUtils.button(mxResources.get("print"),function(){t.hideDialog(),e().print()})),i.appendChild(mxUtils.button(mxResources.get("preview"),function(){t.hideDialog(),e()})),i.appendChild(mxUtils.button(mxResources.get("cancel"),function(){t.hideDialog()})),n.appendChild(i),a.appendChild(n),a.appendChild(n),l.appendChild(a),this.container=l}function SaveDialog(t){var e,n,i=document.createElement("table"),o=document.createElement("tbody");e=document.createElement("tr"),n=document.createElement("td"),n.style.fontSize="10pt",n.style.width="100px",mxUtils.write(n,mxResources.get("filename")+":"),e.appendChild(n);var r=document.createElement("input");r.setAttribute("value",t.editor.getOrCreateFilename()),r.style.width="180px",n=document.createElement("td"),n.appendChild(r),e.appendChild(n),o.appendChild(e),e=document.createElement("tr"),n=document.createElement("td"),n.colSpan=2,n.style.paddingTop="30px",n.style.whiteSpace="nowrap",n.setAttribute("align","right");var s=mxUtils.button(mxResources.get("save"),function(){t.save(r.value),t.hideDialog()});n.appendChild(s),n.appendChild(mxUtils.button(mxResources.get("cancel"),function(){t.hideDialog()})),e.appendChild(n),o.appendChild(e),o.appendChild(e),i.appendChild(o),this.container=i}function EditFileDialog(t){function e(t){if(t.stopPropagation(),t.preventDefault(),t.dataTransfer.files.length>0){var e=t.dataTransfer.files[0],n=new FileReader;n.onload=function(t){o.value=t.target.result},n.readAsText(e)}}function n(t){t.stopPropagation(),t.preventDefault()}var i=document.createElement("div");i.style.textAlign="right";var o=document.createElement("textarea");o.style.width="600px",o.style.height="374px",o.value=mxUtils.getPrettyXml(t.editor.getGraphXml()),i.appendChild(o),fileSupport&&(o.addEventListener("dragover",n,!1),o.addEventListener("drop",e,!1));var r=document.createElement("select");r.style.width="180px";var s=document.createElement("option");s.setAttribute("value","new"),mxUtils.write(s,mxResources.get("openInNewWindow")),r.appendChild(s);var l=document.createElement("option");l.setAttribute("value","replace"),mxUtils.write(l,mxResources.get("replaceExistingDrawing")),r.appendChild(l);var a=document.createElement("option");a.setAttribute("value","import"),mxUtils.write(a,mxResources.get("addToExistingDrawing")),r.appendChild(a),i.appendChild(r),i.appendChild(mxUtils.button(mxResources.get("ok"),function(){if("new"==r.value)window.openFile=new OpenFile(function(){t.hideDialog(),window.openFile=null}),window.openFile.setData(o.value,null),window.open(t.getUrl());else if("replace"==r.value){var e=mxUtils.parseXml(o.value);t.editor.setGraphXml(e.documentElement),t.hideDialog()}else if("import"==r.value){var e=mxUtils.parseXml(o.value),n=new mxGraphModel,i=new mxCodec(e);i.decode(e.documentElement,n);var s=n.getChildren(n.getChildAt(n.getRoot(),0));t.editor.graph.setSelectionCells(t.editor.graph.importCells(s)),t.hideDialog()}})),i.appendChild(mxUtils.button(mxResources.get("cancel"),function(){t.hideDialog()})),this.container=i}function ExportDialog(t){function e(){var t=c.value,e=t.lastIndexOf(".");c.value=e>0?t.substring(0,e+1)+p.value:t+"."+p.value,"xml"===p.value?(y.setAttribute("disabled","true"),v.setAttribute("disabled","true"),T.setAttribute("disabled","true")):(y.removeAttribute("disabled"),v.removeAttribute("disabled"),T.removeAttribute("disabled"))}function n(){y.style.backgroundColor=y.value*v.value>MAX_AREA||y.value<0?"red":"",v.style.backgroundColor=y.value*v.value>MAX_AREA||v.value<0?"red":""}var i,o,r=t.editor.graph,s=r.getGraphBounds(),l=r.view.scale,a=Math.ceil(s.width/l),h=Math.ceil(s.height/l),d=document.createElement("table"),u=document.createElement("tbody");i=document.createElement("tr"),o=document.createElement("td"),o.style.fontSize="10pt",o.style.width="100px",mxUtils.write(o,mxResources.get("filename")+":"),i.appendChild(o);var c=document.createElement("input");c.setAttribute("value",t.editor.getOrCreateFilename()),c.style.width="180px",o=document.createElement("td"),o.appendChild(c),i.appendChild(o),u.appendChild(i),i=document.createElement("tr"),o=document.createElement("td"),o.style.fontSize="10pt",mxUtils.write(o,mxResources.get("format")+":"),i.appendChild(o);var p=document.createElement("select");p.style.width="180px";var m=document.createElement("option");m.setAttribute("value","png"),mxUtils.write(m,"PNG - Portable Network Graphics"),p.appendChild(m);var g=document.createElement("option");g.setAttribute("value","gif"),mxUtils.write(g,"GIF - Graphics Interchange Format"),p.appendChild(g);var f=document.createElement("option");f.setAttribute("value","jpg"),mxUtils.write(f,"JPG - JPEG File Interchange Format"),p.appendChild(f);var x=document.createElement("option");x.setAttribute("value","pdf"),mxUtils.write(x,"PDF - Portable Document Format"),p.appendChild(x);var C=document.createElement("option");C.setAttribute("value","svg"),mxUtils.write(C,"SVG - Scalable Vector Graphics"),p.appendChild(C);var E=document.createElement("option");E.setAttribute("value","xml"),mxUtils.write(E,"XML - Diagramly XML Document"),p.appendChild(E),o=document.createElement("td"),o.appendChild(p),i.appendChild(o),u.appendChild(i),i=document.createElement("tr"),o=document.createElement("td"),o.style.fontSize="10pt",mxUtils.write(o,mxResources.get("width")+":"),i.appendChild(o);var y=document.createElement("input");y.setAttribute("value",a),y.style.width="180px",o=document.createElement("td"),o.appendChild(y),i.appendChild(o),u.appendChild(i),i=document.createElement("tr"),o=document.createElement("td"),o.style.fontSize="10pt",mxUtils.write(o,mxResources.get("height")+":"),i.appendChild(o);var v=document.createElement("input");v.setAttribute("value",h),v.style.width="180px",o=document.createElement("td"),o.appendChild(v),i.appendChild(o),u.appendChild(i),i=document.createElement("tr"),o=document.createElement("td"),o.style.fontSize="10pt",mxUtils.write(o,mxResources.get("borderWidth")+":"),i.appendChild(o);var T=document.createElement("input");T.setAttribute("value",a),T.style.width="180px",T.value="0",o=document.createElement("td"),o.appendChild(T),i.appendChild(o),u.appendChild(i),d.appendChild(u),mxEvent.addListener(p,"change",e),e(),mxEvent.addListener(y,"change",function(){v.value=a>0?Math.ceil(parseInt(y.value)*h/a):"0",n()}),mxEvent.addListener(v,"change",function(){y.value=h>0?Math.ceil(parseInt(v.value)*a/h):"0",n()});var b=new mxImageExport;i=document.createElement("tr"),o=document.createElement("td"),o.colSpan=2,o.style.paddingTop="40px",o.setAttribute("align","right"),o.appendChild(mxUtils.button(mxResources.get("save"),mxUtils.bind(this,function(){if(parseInt(y.value)<=0&&parseInt(v.value)<=0)mxUtils.alert(mxResources.get("drawingEmpty"));else{var e=p.value,n=c.value;if("xml"==e){var i=encodeURIComponent(mxUtils.getXml(t.editor.getGraphXml()));new mxXmlRequest(SAVE_URL,"filename="+n+"&xml="+i).simulate(document,"_blank")}else if("svg"==e){var o=Math.max(0,parseInt(T.value))+1,s=parseInt(y.value)/a,l=r.getGraphBounds(),h=r.view.scale,d=mxUtils.createXmlDocument(),u=null!=d.createElementNS?d.createElementNS(mxConstants.NS_SVG,"svg"):d.createElement("svg");null!=r.background&&(null!=u.style?u.style.backgroundColor=r.background:u.setAttribute("style","background-color:"+r.background)),null==d.createElementNS&&u.setAttribute("xmlns",mxConstants.NS_SVG),u.setAttribute("width",Math.ceil(l.width*s/h+2*o)+"px"),u.setAttribute("height",Math.ceil(l.height*s/h+2*o)+"px"),u.setAttribute("xmlns:xlink",mxConstants.NS_XLINK),u.setAttribute("version","1.1");var m=null!=d.createElementNS?d.createElementNS(mxConstants.NS_SVG,"g"):d.createElement("g");m.setAttribute("transform","translate(0.5,0.5)"),u.appendChild(m),d.appendChild(u);var g=new mxSvgCanvas2D(m);g.translate(Math.floor((o/s-l.x)/h),Math.floor((o/s-l.y)/h)),g.scale(s/h),b.drawState(r.getView().getState(r.model.root),g);var i=mxUtils.getXml(u);i.length<MAX_REQUEST_SIZE?(i=encodeURIComponent(i),new mxXmlRequest(SAVE_URL,"filename="+n+"&format="+e+"&xml="+i).simulate(document,"_blank")):(mxUtils.alert(mxResources.get("drawingTooLarge")),mxUtils.popup(i))}else{var o=Math.max(0,parseInt(T.value))+1,s=parseInt(y.value)/a,l=r.getGraphBounds(),h=r.view.scale,f=mxUtils.createXmlDocument(),u=f.createElement("output");f.appendChild(u);var x=new mxXmlCanvas2D(u);x.translate(Math.floor((o/s-l.x)/h),Math.floor((o/s-l.y)/h)),x.scale(s/h),b.drawState(r.getView().getState(r.model.root),x);var C=Math.ceil(l.width*s/h+2*o),E=Math.ceil(l.height*s/h+2*o),i=mxUtils.getXml(u);if(i.length<=MAX_REQUEST_SIZE&&C>0&&E>0&&MAX_AREA>C*E){var I=r.background||"#ffffff";new mxXmlRequest(EXPORT_URL,"filename="+n+"&format="+e+"&bg="+I+"&w="+C+"&h="+E+"&plain="+encodeURIComponent(i)).simulate(document,"_blank")}else mxUtils.alert(mxResources.get("drawingTooLarge"))}t.hideDialog()}}))),o.appendChild(mxUtils.button(mxResources.get("cancel"),function(){t.hideDialog()})),i.appendChild(o),u.appendChild(i),u.appendChild(i),d.appendChild(u),this.container=d}function Menubar(t,e){this.editorUi=t,this.container=e,mxEvent.addGestureListeners(document,mxUtils.bind(this,function(){this.hideMenu()}))}function Menu(t,e){mxEventSource.call(this),this.funct=t,this.enabled=null!=e?e:!0}/**
 * $Id: Sidebar.js,v 1.42 2013/05/07 09:48:56 gaudenz Exp $
 * Copyright (c) 2006-2012, JGraph Ltd
 */
function Sidebar(t,e,n){this.choices=n,this.editorUi=t,this.container=e,this.palettes=new Object,this.showTooltips=!0,this.graph=new Graph(document.createElement("div"),null,null,this.editorUi.editor.graph.getStylesheet()),this.graph.resetViewOnRootChange=!1,this.graph.foldingEnabled=!1,this.graph.setConnectable(!1),this.graph.autoScroll=!1,this.graph.setTooltips(!1),this.graph.setEnabled(!1),this.graph.container.style.visibility="hidden",this.graph.container.style.position="absolute",document.body.appendChild(this.graph.container),mxClient.IS_TOUCH||(mxEvent.addListener(document,"mouseup",mxUtils.bind(this,function(){this.showTooltips=!0})),mxEvent.addListener(e,"scroll",mxUtils.bind(this,function(){this.showTooltips=!0})),mxEvent.addListener(document,"mousedown",mxUtils.bind(this,function(){this.showTooltips=!1,this.hideTooltip()})),mxEvent.addListener(document,"mousemove",mxUtils.bind(this,function(t){for(var e=mxEvent.getSource(t);null!=e;){if(e==this.currentElt)return;e=e.parentNode}this.hideTooltip()})),mxEvent.addListener(document,"mouseout",mxUtils.bind(this,function(t){null==t.toElement&&null==t.relatedTarget&&this.hideTooltip()}))),this.init(),(new Image).src=IMAGE_PATH+"/tooltip.png"}/**
 * $Id: Toolbar.js,v 1.4 2013/05/01 13:10:22 gaudenz Exp $
 * Copyright (c) 2006-2012, JGraph Ltd
 */
function Toolbar(t,e){this.editorUi=t,this.container=e,this.init(),mxEvent.addGestureListeners(document,mxUtils.bind(this,function(){this.hideMenu()}))}!function(){window.CKEDITOR&&window.CKEDITOR.dom||(window.CKEDITOR||(window.CKEDITOR=function(){var t={timestamp:"E0OL",version:"4.3 DEV",revision:"0",rnd:Math.floor(900*Math.random())+100,_:{pending:[]},status:"unloaded",basePath:function(){var t=window.CKEDITOR_BASEPATH||"";if(!t)for(var e=document.getElementsByTagName("script"),n=0;n<e.length;n++){var i=e[n].src.match(/(^|.*[\\\/])ckeditor(?:_basic)?(?:_source)?.js(?:\?.*)?$/i);if(i){t=i[1];break}}if(-1==t.indexOf(":/")&&"//"!=t.slice(0,2)&&(t=0===t.indexOf("/")?location.href.match(/^.*?:\/\/[^\/]*/)[0]+t:location.href.match(/^[^\?]*\/(?:)/)[0]+t),!t)throw'The CKEditor installation path could not be automatically detected. Please set the global variable "CKEDITOR_BASEPATH" before creating editor instances.';return t}(),getUrl:function(t){return-1==t.indexOf(":/")&&0!==t.indexOf("/")&&(t=this.basePath+t),this.timestamp&&"/"!=t.charAt(t.length-1)&&!/[&?]t=/.test(t)&&(t+=(0<=t.indexOf("?")?"&":"?")+"t="+this.timestamp),t},domReady:function(){function t(){try{document.addEventListener?(document.removeEventListener("DOMContentLoaded",t,!1),e()):document.attachEvent&&"complete"===document.readyState&&(document.detachEvent("onreadystatechange",t),e())}catch(n){}}function e(){for(var t;t=n.shift();)t()}var n=[];return function(e){if(n.push(e),"complete"===document.readyState&&setTimeout(t,1),1==n.length)if(document.addEventListener)document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1);else if(document.attachEvent){document.attachEvent("onreadystatechange",t),window.attachEvent("onload",t),e=!1;try{e=!window.frameElement}catch(i){}if(document.documentElement.doScroll&&e){var o=function(){try{document.documentElement.doScroll("left")}catch(e){return setTimeout(o,1),void 0}t()};o()}}}}()},e=window.CKEDITOR_GETURL;if(e){var n=t.getUrl;t.getUrl=function(i){return e.call(t,i)||n.call(t,i)}}return t}()),CKEDITOR.event||(CKEDITOR.event=function(){},CKEDITOR.event.implementOn=function(t){var e,n=CKEDITOR.event.prototype;for(e in n)void 0==t[e]&&(t[e]=n[e])},CKEDITOR.event.prototype=function(){function t(t){var i=e(this);return i[t]||(i[t]=new n(t))}var e=function(t){return t=t.getPrivate&&t.getPrivate()||t._||(t._={}),t.events||(t.events={})},n=function(t){this.name=t,this.listeners=[]};return n.prototype={getListenerIndex:function(t){for(var e=0,n=this.listeners;e<n.length;e++)if(n[e].fn==t)return e;return-1}},{define:function(e,n){var i=t.call(this,e);CKEDITOR.tools.extend(i,n,!0)},on:function(e,n,i,o,r){function s(t,r,s,a){return t={name:e,sender:this,editor:t,data:r,listenerData:o,stop:s,cancel:a,removeListener:l},n.call(i,t)===!1?!1:t.data}function l(){h.removeListener(e,n)}var a=t.call(this,e);if(a.getListenerIndex(n)<0){a=a.listeners,i||(i=this),isNaN(r)&&(r=10);var h=this;s.fn=n,s.priority=r;for(var d=a.length-1;d>=0;d--)if(a[d].priority<=r)return a.splice(d+1,0,s),{removeListener:l};a.unshift(s)}return{removeListener:l}},once:function(){var t=arguments[1];return arguments[1]=function(e){return e.removeListener(),t.apply(this,arguments)},this.on.apply(this,arguments)},capture:function(){CKEDITOR.event.useCapture=1;var t=this.on.apply(this,arguments);return CKEDITOR.event.useCapture=0,t},fire:function(){var t=0,n=function(){t=1},i=0,o=function(){i=1};return function(r,s,l){var a=e(this)[r],r=t,h=i;if(t=i=0,a){var d=a.listeners;if(d.length)for(var u,d=d.slice(0),c=0;c<d.length;c++){if(a.errorProof)try{u=d[c].call(this,l,s,n,o)}catch(p){}else u=d[c].call(this,l,s,n,o);if(u===!1?i=1:"undefined"!=typeof u&&(s=u),t||i)break}}return s=i?!1:"undefined"==typeof s?!0:s,t=r,i=h,s}}(),fireOnce:function(t,n,i){return n=this.fire(t,n,i),delete e(this)[t],n},removeListener:function(t,n){var i=e(this)[t];if(i){var o=i.getListenerIndex(n);o>=0&&i.listeners.splice(o,1)}},removeAllListeners:function(){var t,n=e(this);for(t in n)delete n[t]},hasListeners:function(t){return(t=e(this)[t])&&t.listeners.length>0}}}()),CKEDITOR.editor||(CKEDITOR.editor=function(){CKEDITOR._.pending.push([this,arguments]),CKEDITOR.event.call(this)},CKEDITOR.editor.prototype.fire=function(t,e){return t in{instanceReady:1,loaded:1}&&(this[t]=!0),CKEDITOR.event.prototype.fire.call(this,t,e,this)},CKEDITOR.editor.prototype.fireOnce=function(t,e){return t in{instanceReady:1,loaded:1}&&(this[t]=!0),CKEDITOR.event.prototype.fireOnce.call(this,t,e,this)},CKEDITOR.event.implementOn(CKEDITOR.editor.prototype)),CKEDITOR.env||(CKEDITOR.env=function(){var t=navigator.userAgent.toLowerCase(),e=window.opera,n={ie:t.indexOf("trident/")>-1,opera:!!e&&e.version,webkit:t.indexOf(" applewebkit/")>-1,air:t.indexOf(" adobeair/")>-1,mac:t.indexOf("macintosh")>-1,quirks:"BackCompat"==document.compatMode&&(!document.documentMode||document.documentMode<10),mobile:t.indexOf("mobile")>-1,iOS:/(ipad|iphone|ipod)/.test(t),isCustomDomain:function(){if(!this.ie)return!1;var t=document.domain,e=window.location.hostname;return t!=e&&t!="["+e+"]"},secure:"https:"==location.protocol};n.gecko="Gecko"==navigator.product&&!n.webkit&&!n.opera&&!n.ie,n.webkit&&(t.indexOf("chrome")>-1?n.chrome=!0:n.safari=!0);var i=0;if(n.ie&&(i=n.quirks||!document.documentMode?parseFloat(t.match(/msie (\d+)/)[1]):document.documentMode,n.ie9Compat=9==i,n.ie8Compat=8==i,n.ie7Compat=7==i,n.ie6Compat=7>i||n.quirks),n.gecko){var o=t.match(/rv:([\d\.]+)/);o&&(o=o[1].split("."),i=1e4*o[0]+100*(o[1]||0)+1*(o[2]||0))}return n.opera&&(i=parseFloat(e.version())),n.air&&(i=parseFloat(t.match(/ adobeair\/(\d+)/)[1])),n.webkit&&(i=parseFloat(t.match(/ applewebkit\/(\d+)/)[1])),n.version=i,n.isCompatible=n.iOS&&i>=534||!n.mobile&&(n.ie&&i>6||n.gecko&&i>=10801||n.opera&&i>=9.5||n.air&&i>=1||n.webkit&&i>=522||!1),n.hidpi=window.devicePixelRatio>=2,n.needsBrFiller=n.gecko||n.webkit||n.ie&&i>10,n.needsNbspFiller=n.ie&&11>i,n.cssClass="cke_browser_"+(n.ie?"ie":n.gecko?"gecko":n.opera?"opera":n.webkit?"webkit":"unknown"),n.quirks&&(n.cssClass=n.cssClass+" cke_browser_quirks"),n.ie&&(n.cssClass=n.cssClass+(" cke_browser_ie"+(n.quirks||n.version<7?"6":n.version)),n.quirks&&(n.cssClass=n.cssClass+" cke_browser_iequirks")),n.gecko&&(10900>i?n.cssClass=n.cssClass+" cke_browser_gecko18":11e3>=i&&(n.cssClass=n.cssClass+" cke_browser_gecko19")),n.air&&(n.cssClass=n.cssClass+" cke_browser_air"),n.iOS&&(n.cssClass=n.cssClass+" cke_browser_ios"),n.hidpi&&(n.cssClass=n.cssClass+" cke_hidpi"),n}()),"unloaded"==CKEDITOR.status&&function(){CKEDITOR.event.implementOn(CKEDITOR),CKEDITOR.loadFullCore=function(){if("basic_ready"!=CKEDITOR.status)CKEDITOR.loadFullCore._load=1;else{delete CKEDITOR.loadFullCore;var t=document.createElement("script");t.type="text/javascript",t.src=CKEDITOR.basePath+"ckeditor.js",document.getElementsByTagName("head")[0].appendChild(t)}},CKEDITOR.loadFullCoreTimeout=0,CKEDITOR.add=function(t){(this._.pending||(this._.pending=[])).push(t)},function(){CKEDITOR.domReady(function(){var t=CKEDITOR.loadFullCore,e=CKEDITOR.loadFullCoreTimeout;t&&(CKEDITOR.status="basic_ready",t&&t._load?t():e&&setTimeout(function(){CKEDITOR.loadFullCore&&CKEDITOR.loadFullCore()},1e3*e))})}(),CKEDITOR.status="basic_loaded"}(),CKEDITOR.dom={},function(){var t=[],e=CKEDITOR.env.gecko?"-moz-":CKEDITOR.env.webkit?"-webkit-":CKEDITOR.env.opera?"-o-":CKEDITOR.env.ie?"-ms-":"";CKEDITOR.on("reset",function(){t=[]}),CKEDITOR.tools={arrayCompare:function(t,e){if(!t&&!e)return!0;if(!t||!e||t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!=e[n])return!1;return!0},clone:function(t){var e;if(t&&t instanceof Array){e=[];for(var n=0;n<t.length;n++)e[n]=CKEDITOR.tools.clone(t[n]);return e}if(null===t||"object"!=typeof t||t instanceof String||t instanceof Number||t instanceof Boolean||t instanceof Date||t instanceof RegExp)return t;e=new t.constructor;for(n in t)e[n]=CKEDITOR.tools.clone(t[n]);return e},capitalize:function(t,e){return t.charAt(0).toUpperCase()+(e?t.slice(1):t.slice(1).toLowerCase())},extend:function(t){var e,n,i=arguments.length;"boolean"==typeof(e=arguments[i-1])?i--:"boolean"==typeof(e=arguments[i-2])&&(n=arguments[i-1],i-=2);for(var o=1;i>o;o++){var r,s=arguments[o];for(r in s)(e===!0||void 0==t[r])&&(!n||r in n)&&(t[r]=s[r])}return t},prototypedCopy:function(t){var e=function(){};return e.prototype=t,new e},copy:function(t){var e,n={};for(e in t)n[e]=t[e];return n},isArray:function(t){return"[object Array]"==Object.prototype.toString.call(t)},isEmpty:function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},cssVendorPrefix:function(t,n,i){return i?e+t+":"+n+";"+t+":"+n:(i={},i[t]=n,i[e+t]=n,i)},cssStyleToDomStyle:function(){var t=document.createElement("div").style,e="undefined"!=typeof t.cssFloat?"cssFloat":"undefined"!=typeof t.styleFloat?"styleFloat":"float";return function(t){return"float"==t?e:t.replace(/-./g,function(t){return t.substr(1).toUpperCase()})}}(),buildStyleHtml:function(t){for(var e,t=[].concat(t),n=[],i=0;i<t.length;i++)(e=t[i])&&(/@import|[{}]/.test(e)?n.push("<style>"+e+"</style>"):n.push('<link type="text/css" rel=stylesheet href="'+e+'">'));return n.join("")},htmlEncode:function(t){return(""+t).replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;")},htmlEncodeAttr:function(t){return t.replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},htmlDecodeAttr:function(t){return t.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">")},getNextNumber:function(){var t=0;return function(){return++t}}(),getNextId:function(){return"cke_"+this.getNextNumber()},override:function(t,e){var n=e(t);return n.prototype=t.prototype,n},setTimeout:function(t,e,n,i,o){return o||(o=window),n||(n=o),o.setTimeout(function(){i?t.apply(n,[].concat(i)):t.apply(n)},e||0)},trim:function(){var t=/(?:^[ \t\n\r]+)|(?:[ \t\n\r]+$)/g;return function(e){return e.replace(t,"")}}(),ltrim:function(){var t=/^[ \t\n\r]+/g;return function(e){return e.replace(t,"")}}(),rtrim:function(){var t=/[ \t\n\r]+$/g;return function(e){return e.replace(t,"")}}(),indexOf:function(t,e){if("function"==typeof e){for(var n=0,i=t.length;i>n;n++)if(e(t[n]))return n}else{if(t.indexOf)return t.indexOf(e);for(n=0,i=t.length;i>n;n++)if(t[n]===e)return n}return-1},search:function(t,e){var n=CKEDITOR.tools.indexOf(t,e);return n>=0?t[n]:null},bind:function(t,e){return function(){return t.apply(e,arguments)}},createClass:function(t){var e=t.$,n=t.base,i=t.privates||t._,o=t.proto,t=t.statics;if(!e&&(e=function(){n&&this.base.apply(this,arguments)}),i)var r=e,e=function(){var t,e=this._||(this._={});for(t in i){var n=i[t];e[t]="function"==typeof n?CKEDITOR.tools.bind(n,this):n}r.apply(this,arguments)};return n&&(e.prototype=this.prototypedCopy(n.prototype),e.prototype.constructor=e,e.base=n,e.baseProto=n.prototype,e.prototype.base=function(){this.base=n.prototype.base,n.apply(this,arguments),this.base=arguments.callee}),o&&this.extend(e.prototype,o,!0),t&&this.extend(e,t,!0),e},addFunction:function(e,n){return t.push(function(){return e.apply(n||this,arguments)})-1},removeFunction:function(e){t[e]=null},callFunction:function(e){var n=t[e];return n&&n.apply(window,Array.prototype.slice.call(arguments,1))},cssLength:function(){var t,e=/^-?\d+\.?\d*px$/;return function(n){return t=CKEDITOR.tools.trim(n+"")+"px",e.test(t)?t:n||""}}(),convertToPx:function(){var t;return function(e){return t||(t=CKEDITOR.dom.element.createFromHtml('<div style="position:absolute;left:-9999px;top:-9999px;margin:0px;padding:0px;border:0px;"></div>',CKEDITOR.document),CKEDITOR.document.getBody().append(t)),/%$/.test(e)?e:(t.setStyle("width",e),t.$.clientWidth)}}(),repeat:function(t,e){return Array(e+1).join(t)},tryThese:function(){for(var t,e=0,n=arguments.length;n>e;e++){var i=arguments[e];try{t=i();break}catch(o){}}return t},genKey:function(){return Array.prototype.slice.call(arguments).join("-")},defer:function(t){return function(){var e=arguments,n=this;window.setTimeout(function(){t.apply(n,e)},0)}},normalizeCssText:function(t,e){var n,i=[],o=CKEDITOR.tools.parseCssText(t,!0,e);for(n in o)i.push(n+":"+o[n]);return i.sort(),i.length?i.join(";")+";":""},convertRgbToHex:function(t){return t.replace(/(?:rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\))/gi,function(t,e,n,i){for(t=[e,n,i],e=0;3>e;e++)t[e]=("0"+parseInt(t[e],10).toString(16)).slice(-2);return"#"+t.join("")})},parseCssText:function(t,e,n){var i={};return n&&(n=new CKEDITOR.dom.element("span"),n.setAttribute("style",t),t=CKEDITOR.tools.convertRgbToHex(n.getAttribute("style")||"")),t&&";"!=t?(t.replace(/&quot;/g,'"').replace(/\s*([^:;\s]+)\s*:\s*([^;]+)\s*(?=;|$)/g,function(t,n,o){e&&(n=n.toLowerCase(),"font-family"==n&&(o=o.toLowerCase().replace(/["']/g,"").replace(/\s*,\s*/g,",")),o=CKEDITOR.tools.trim(o)),i[n]=o}),i):i},writeCssText:function(t,e){var n,i=[];for(n in t)i.push(n+":"+t[n]);return e&&i.sort(),i.join("; ")},objectCompare:function(t,e,n){var i;if(!t&&!e)return!0;if(!t||!e)return!1;for(i in t)if(t[i]!=e[i])return!1;if(!n)for(i in e)if(t[i]!=e[i])return!1;return!0},objectKeys:function(t){var e,n=[];for(e in t)n.push(e);return n},convertArrayToObject:function(t,e){var n={};1==arguments.length&&(e=!0);for(var i=0,o=t.length;o>i;++i)n[t[i]]=e;return n},fixDomain:function(){for(var t;;)try{t=window.parent.document.domain;break}catch(e){if(t=t?t.replace(/.+?(?:\.|$)/,""):document.domain,!t)break;document.domain=t}return!!t},eventsBuffer:function(t,e){function n(){o=(new Date).getTime(),i=!1,e()}var i,o=0;return{input:function(){if(!i){var e=(new Date).getTime()-o;t>e?i=setTimeout(n,t-e):n()}},reset:function(){i&&clearTimeout(i),i=o=0}}},enableHtml5Elements:function(t,e){for(var n,i=["abbr","article","aside","audio","bdi","canvas","data","datalist","details","figcaption","figure","footer","header","hgroup","mark","meter","nav","output","progress","section","summary","time","video"],o=i.length;o--;)n=t.createElement(i[o]),e&&t.appendChild(n)}}}(),CKEDITOR.dtd=function(){var t=CKEDITOR.tools.extend,e=function(t,e){for(var n=CKEDITOR.tools.clone(t),i=1;i<arguments.length;i++){var o,e=arguments[i];for(o in e)delete n[o]}return n},n={},i={},o={address:1,article:1,aside:1,blockquote:1,details:1,div:1,dl:1,fieldset:1,figure:1,footer:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,header:1,hgroup:1,hr:1,menu:1,nav:1,ol:1,p:1,pre:1,section:1,table:1,ul:1},r={command:1,link:1,meta:1,noscript:1,script:1,style:1},s={},l={"#":1},a={center:1,dir:1,noframes:1};return t(n,{a:1,abbr:1,area:1,audio:1,b:1,bdi:1,bdo:1,br:1,button:1,canvas:1,cite:1,code:1,command:1,datalist:1,del:1,dfn:1,em:1,embed:1,i:1,iframe:1,img:1,input:1,ins:1,kbd:1,keygen:1,label:1,map:1,mark:1,meter:1,noscript:1,object:1,output:1,progress:1,q:1,ruby:1,s:1,samp:1,script:1,select:1,small:1,span:1,strong:1,sub:1,sup:1,textarea:1,time:1,u:1,"var":1,video:1,wbr:1},l,{acronym:1,applet:1,basefont:1,big:1,font:1,isindex:1,strike:1,style:1,tt:1}),t(i,o,n,a),e={a:e(n,{a:1,button:1}),abbr:n,address:i,area:s,article:t({style:1},i),aside:t({style:1},i),audio:t({source:1,track:1},i),b:n,base:s,bdi:n,bdo:n,blockquote:i,body:i,br:s,button:e(n,{a:1,button:1}),canvas:n,caption:i,cite:n,code:n,col:s,colgroup:{col:1},command:s,datalist:t({option:1},n),dd:i,del:n,details:t({summary:1},i),dfn:n,div:t({style:1},i),dl:{dt:1,dd:1},dt:i,em:n,embed:s,fieldset:t({legend:1},i),figcaption:i,figure:t({figcaption:1},i),footer:i,form:i,h1:n,h2:n,h3:n,h4:n,h5:n,h6:n,head:t({title:1,base:1},r),header:i,hgroup:{h1:1,h2:1,h3:1,h4:1,h5:1,h6:1},hr:s,html:t({head:1,body:1},i,r),i:n,iframe:l,img:s,input:s,ins:n,kbd:n,keygen:s,label:n,legend:n,li:i,link:s,map:i,mark:n,menu:t({li:1},i),meta:s,meter:e(n,{meter:1}),nav:i,noscript:t({link:1,meta:1,style:1},n),object:t({param:1},n),ol:{li:1},optgroup:{option:1},option:l,output:n,p:n,param:s,pre:n,progress:e(n,{progress:1}),q:n,rp:n,rt:n,ruby:t({rp:1,rt:1},n),s:n,samp:n,script:l,section:t({style:1},i),select:{optgroup:1,option:1},small:n,source:s,span:n,strong:n,style:l,sub:n,summary:n,sup:n,table:{caption:1,colgroup:1,thead:1,tfoot:1,tbody:1,tr:1},tbody:{tr:1},td:i,textarea:l,tfoot:{tr:1},th:i,thead:{tr:1},time:e(n,{time:1}),title:l,tr:{th:1,td:1},track:s,u:n,ul:{li:1},"var":n,video:t({source:1,track:1},i),wbr:s,acronym:n,applet:t({param:1},i),basefont:s,big:n,center:i,dialog:s,dir:{li:1},font:n,isindex:s,noframes:i,strike:n,tt:n},t(e,{$block:t({audio:1,dd:1,dt:1,figcaption:1,li:1,video:1},o,a),$blockLimit:{article:1,aside:1,audio:1,body:1,caption:1,details:1,dir:1,div:1,dl:1,fieldset:1,figcaption:1,figure:1,footer:1,form:1,header:1,hgroup:1,menu:1,nav:1,ol:1,section:1,table:1,td:1,th:1,tr:1,ul:1,video:1},$cdata:{script:1,style:1},$editable:{address:1,article:1,aside:1,blockquote:1,body:1,details:1,div:1,fieldset:1,figcaption:1,footer:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,header:1,hgroup:1,nav:1,p:1,pre:1,section:1},$empty:{area:1,base:1,basefont:1,br:1,col:1,command:1,dialog:1,embed:1,hr:1,img:1,input:1,isindex:1,keygen:1,link:1,meta:1,param:1,source:1,track:1,wbr:1},$inline:n,$list:{dl:1,ol:1,ul:1},$listItem:{dd:1,dt:1,li:1},$nonBodyContent:t({body:1,head:1,html:1},e.head),$nonEditable:{applet:1,audio:1,button:1,embed:1,iframe:1,map:1,object:1,option:1,param:1,script:1,textarea:1,video:1},$object:{applet:1,audio:1,button:1,hr:1,iframe:1,img:1,input:1,object:1,select:1,table:1,textarea:1,video:1},$removeEmpty:{abbr:1,acronym:1,b:1,bdi:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,mark:1,meter:1,output:1,q:1,ruby:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,time:1,tt:1,u:1,"var":1},$tabIndex:{a:1,area:1,button:1,input:1,object:1,select:1,textarea:1},$tableContent:{caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1},$transparent:{a:1,audio:1,canvas:1,del:1,ins:1,map:1,noscript:1,object:1,video:1},$intermediate:{caption:1,colgroup:1,dd:1,dt:1,figcaption:1,legend:1,li:1,optgroup:1,option:1,rp:1,rt:1,summary:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1}}),e}(),CKEDITOR.dom.event=function(t){this.$=t},CKEDITOR.dom.event.prototype={getKey:function(){return this.$.keyCode||this.$.which},getKeystroke:function(){var t=this.getKey();return(this.$.ctrlKey||this.$.metaKey)&&(t+=CKEDITOR.CTRL),this.$.shiftKey&&(t+=CKEDITOR.SHIFT),this.$.altKey&&(t+=CKEDITOR.ALT),t},preventDefault:function(t){var e=this.$;e.preventDefault?e.preventDefault():e.returnValue=!1,t&&this.stopPropagation()},stopPropagation:function(){var t=this.$;t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},getTarget:function(){var t=this.$.target||this.$.srcElement;return t?new CKEDITOR.dom.node(t):null},getPhase:function(){return this.$.eventPhase||2},getPageOffset:function(){var t=this.getTarget().getDocument().$;return{x:this.$.pageX||this.$.clientX+(t.documentElement.scrollLeft||t.body.scrollLeft),y:this.$.pageY||this.$.clientY+(t.documentElement.scrollTop||t.body.scrollTop)}}},CKEDITOR.CTRL=1114112,CKEDITOR.SHIFT=2228224,CKEDITOR.ALT=4456448,CKEDITOR.EVENT_PHASE_CAPTURING=1,CKEDITOR.EVENT_PHASE_AT_TARGET=2,CKEDITOR.EVENT_PHASE_BUBBLING=3,CKEDITOR.dom.domObject=function(t){t&&(this.$=t)},CKEDITOR.dom.domObject.prototype=function(){var t=function(t,e){return function(n){"undefined"!=typeof CKEDITOR&&t.fire(e,new CKEDITOR.dom.event(n))}};return{getPrivate:function(){var t;return(t=this.getCustomData("_"))||this.setCustomData("_",t={}),t},on:function(e){var n=this.getCustomData("_cke_nativeListeners");return n||(n={},this.setCustomData("_cke_nativeListeners",n)),n[e]||(n=n[e]=t(this,e),this.$.addEventListener?this.$.addEventListener(e,n,!!CKEDITOR.event.useCapture):this.$.attachEvent&&this.$.attachEvent("on"+e,n)),CKEDITOR.event.prototype.on.apply(this,arguments)},removeListener:function(t){if(CKEDITOR.event.prototype.removeListener.apply(this,arguments),!this.hasListeners(t)){var e=this.getCustomData("_cke_nativeListeners"),n=e&&e[t];n&&(this.$.removeEventListener?this.$.removeEventListener(t,n,!1):this.$.detachEvent&&this.$.detachEvent("on"+t,n),delete e[t])}},removeAllListeners:function(){var t,e=this.getCustomData("_cke_nativeListeners");for(t in e){var n=e[t];this.$.detachEvent?this.$.detachEvent("on"+t,n):this.$.removeEventListener&&this.$.removeEventListener(t,n,!1),delete e[t]}}}}(),function(t){var e={};CKEDITOR.on("reset",function(){e={}}),t.equals=function(t){try{return t&&t.$===this.$}catch(e){return!1}},t.setCustomData=function(t,n){var i=this.getUniqueId();return(e[i]||(e[i]={}))[t]=n,this},t.getCustomData=function(t){var n=this.$["data-cke-expando"];return(n=n&&e[n])&&t in n?n[t]:null},t.removeCustomData=function(t){var n,i,o=this.$["data-cke-expando"],o=o&&e[o];return o&&(n=o[t],i=t in o,delete o[t]),i?n:null},t.clearCustomData=function(){this.removeAllListeners();var t=this.$["data-cke-expando"];t&&delete e[t]},t.getUniqueId=function(){return this.$["data-cke-expando"]||(this.$["data-cke-expando"]=CKEDITOR.tools.getNextNumber())},CKEDITOR.event.implementOn(t)}(CKEDITOR.dom.domObject.prototype),CKEDITOR.dom.node=function(t){return t?new CKEDITOR.dom[t.nodeType==CKEDITOR.NODE_DOCUMENT?"document":t.nodeType==CKEDITOR.NODE_ELEMENT?"element":t.nodeType==CKEDITOR.NODE_TEXT?"text":t.nodeType==CKEDITOR.NODE_COMMENT?"comment":t.nodeType==CKEDITOR.NODE_DOCUMENT_FRAGMENT?"documentFragment":"domObject"](t):this},CKEDITOR.dom.node.prototype=new CKEDITOR.dom.domObject,CKEDITOR.NODE_ELEMENT=1,CKEDITOR.NODE_DOCUMENT=9,CKEDITOR.NODE_TEXT=3,CKEDITOR.NODE_COMMENT=8,CKEDITOR.NODE_DOCUMENT_FRAGMENT=11,CKEDITOR.POSITION_IDENTICAL=0,CKEDITOR.POSITION_DISCONNECTED=1,CKEDITOR.POSITION_FOLLOWING=2,CKEDITOR.POSITION_PRECEDING=4,CKEDITOR.POSITION_IS_CONTAINED=8,CKEDITOR.POSITION_CONTAINS=16,CKEDITOR.tools.extend(CKEDITOR.dom.node.prototype,{appendTo:function(t,e){return t.append(this,e),t},clone:function(t,e){var n=this.$.cloneNode(t),i=function(n){if(n["data-cke-expando"]&&(n["data-cke-expando"]=!1),n.nodeType==CKEDITOR.NODE_ELEMENT&&(e||n.removeAttribute("id",!1),t))for(var n=n.childNodes,o=0;o<n.length;o++)i(n[o])};return i(n),new CKEDITOR.dom.node(n)},hasPrevious:function(){return!!this.$.previousSibling},hasNext:function(){return!!this.$.nextSibling},insertAfter:function(t){return t.$.parentNode.insertBefore(this.$,t.$.nextSibling),t},insertBefore:function(t){return t.$.parentNode.insertBefore(this.$,t.$),t},insertBeforeMe:function(t){return this.$.parentNode.insertBefore(t.$,this.$),t},getAddress:function(t){for(var e=[],n=this.getDocument().$.documentElement,i=this.$;i&&i!=n;){var o=i.parentNode;o&&e.unshift(this.getIndex.call({$:i},t)),i=o}return e},getDocument:function(){return new CKEDITOR.dom.document(this.$.ownerDocument||this.$.parentNode.ownerDocument)},getIndex:function(t){var e,n=this.$,i=-1;if(!this.$.parentNode)return i;do(!t||n==this.$||n.nodeType!=CKEDITOR.NODE_TEXT||!e&&n.nodeValue)&&(i++,e=n.nodeType==CKEDITOR.NODE_TEXT);while(n=n.previousSibling);return i},getNextSourceNode:function(t,e,n){if(n&&!n.call)var i=n,n=function(t){return!t.equals(i)};var o,t=!t&&this.getFirst&&this.getFirst();if(!t){if(this.type==CKEDITOR.NODE_ELEMENT&&n&&n(this,!0)===!1)return null;t=this.getNext()}for(;!t&&(o=(o||this).getParent());){if(n&&n(o,!0)===!1)return null;t=o.getNext()}return!t||n&&n(t)===!1?null:e&&e!=t.type?t.getNextSourceNode(!1,e,n):t},getPreviousSourceNode:function(t,e,n){if(n&&!n.call)var i=n,n=function(t){return!t.equals(i)};var o,t=!t&&this.getLast&&this.getLast();if(!t){if(this.type==CKEDITOR.NODE_ELEMENT&&n&&n(this,!0)===!1)return null;t=this.getPrevious()}for(;!t&&(o=(o||this).getParent());){if(n&&n(o,!0)===!1)return null;t=o.getPrevious()}return!t||n&&n(t)===!1?null:e&&t.type!=e?t.getPreviousSourceNode(!1,e,n):t},getPrevious:function(t){var e,n=this.$;do e=(n=n.previousSibling)&&10!=n.nodeType&&new CKEDITOR.dom.node(n);while(e&&t&&!t(e));return e},getNext:function(t){var e,n=this.$;do e=(n=n.nextSibling)&&new CKEDITOR.dom.node(n);while(e&&t&&!t(e));return e},getParent:function(t){var e=this.$.parentNode;return e&&(e.nodeType==CKEDITOR.NODE_ELEMENT||t&&e.nodeType==CKEDITOR.NODE_DOCUMENT_FRAGMENT)?new CKEDITOR.dom.node(e):null},getParents:function(t){var e=this,n=[];do n[t?"push":"unshift"](e);while(e=e.getParent());return n},getCommonAncestor:function(t){if(t.equals(this))return this;if(t.contains&&t.contains(this))return t;var e=this.contains?this:this.getParent();do if(e.contains(t))return e;while(e=e.getParent());return null},getPosition:function(t){var e=this.$,n=t.$;if(e.compareDocumentPosition)return e.compareDocumentPosition(n);if(e==n)return CKEDITOR.POSITION_IDENTICAL;if(this.type==CKEDITOR.NODE_ELEMENT&&t.type==CKEDITOR.NODE_ELEMENT){if(e.contains){if(e.contains(n))return CKEDITOR.POSITION_CONTAINS+CKEDITOR.POSITION_PRECEDING;if(n.contains(e))return CKEDITOR.POSITION_IS_CONTAINED+CKEDITOR.POSITION_FOLLOWING}if("sourceIndex"in e)return e.sourceIndex<0||n.sourceIndex<0?CKEDITOR.POSITION_DISCONNECTED:e.sourceIndex<n.sourceIndex?CKEDITOR.POSITION_PRECEDING:CKEDITOR.POSITION_FOLLOWING}for(var e=this.getAddress(),t=t.getAddress(),n=Math.min(e.length,t.length),i=0;n-1>=i;i++)if(e[i]!=t[i]){if(n>i)return e[i]<t[i]?CKEDITOR.POSITION_PRECEDING:CKEDITOR.POSITION_FOLLOWING;break}return e.length<t.length?CKEDITOR.POSITION_CONTAINS+CKEDITOR.POSITION_PRECEDING:CKEDITOR.POSITION_IS_CONTAINED+CKEDITOR.POSITION_FOLLOWING},getAscendant:function(t,e){var n,i=this.$;for(e||(i=i.parentNode);i;){if(i.nodeName&&(n=i.nodeName.toLowerCase(),"string"==typeof t?n==t:n in t))return new CKEDITOR.dom.node(i);try{i=i.parentNode}catch(o){i=null}}return null},hasAscendant:function(t,e){var n=this.$;for(e||(n=n.parentNode);n;){if(n.nodeName&&n.nodeName.toLowerCase()==t)return!0;n=n.parentNode}return!1},move:function(t,e){t.append(this.remove(),e)},remove:function(t){var e=this.$,n=e.parentNode;if(n){if(t)for(;t=e.firstChild;)n.insertBefore(e.removeChild(t),e);n.removeChild(e)}return this},replace:function(t){this.insertBefore(t),t.remove()},trim:function(){this.ltrim(),this.rtrim()},ltrim:function(){for(var t;this.getFirst&&(t=this.getFirst());){if(t.type==CKEDITOR.NODE_TEXT){var e=CKEDITOR.tools.ltrim(t.getText()),n=t.getLength();if(!e){t.remove();continue}e.length<n&&(t.split(n-e.length),this.$.removeChild(this.$.firstChild))}break}},rtrim:function(){for(var t;this.getLast&&(t=this.getLast());){if(t.type==CKEDITOR.NODE_TEXT){var e=CKEDITOR.tools.rtrim(t.getText()),n=t.getLength();if(!e){t.remove();continue}e.length<n&&(t.split(e.length),this.$.lastChild.parentNode.removeChild(this.$.lastChild))}break}CKEDITOR.env.needsBrFiller&&(t=this.$.lastChild)&&1==t.type&&"br"==t.nodeName.toLowerCase()&&t.parentNode.removeChild(t)},isReadOnly:function(){var t=this;if(this.type!=CKEDITOR.NODE_ELEMENT&&(t=this.getParent()),t&&"undefined"!=typeof t.$.isContentEditable)return!(t.$.isContentEditable||t.data("cke-editable"));for(;t&&!t.data("cke-editable");){if("false"==t.getAttribute("contentEditable"))return!0;if("true"==t.getAttribute("contentEditable"))break;t=t.getParent()}return!t}}),CKEDITOR.dom.window=function(t){CKEDITOR.dom.domObject.call(this,t)},CKEDITOR.dom.window.prototype=new CKEDITOR.dom.domObject,CKEDITOR.tools.extend(CKEDITOR.dom.window.prototype,{focus:function(){this.$.focus()},getViewPaneSize:function(){var t=this.$.document,e="CSS1Compat"==t.compatMode;return{width:(e?t.documentElement.clientWidth:t.body.clientWidth)||0,height:(e?t.documentElement.clientHeight:t.body.clientHeight)||0}},getScrollPosition:function(){var t=this.$;return"pageXOffset"in t?{x:t.pageXOffset||0,y:t.pageYOffset||0}:(t=t.document,{x:t.documentElement.scrollLeft||t.body.scrollLeft||0,y:t.documentElement.scrollTop||t.body.scrollTop||0})},getFrame:function(){var t=this.$.frameElement;return t?new CKEDITOR.dom.element.get(t):null}}),CKEDITOR.dom.document=function(t){CKEDITOR.dom.domObject.call(this,t)},CKEDITOR.dom.document.prototype=new CKEDITOR.dom.domObject,CKEDITOR.tools.extend(CKEDITOR.dom.document.prototype,{type:CKEDITOR.NODE_DOCUMENT,appendStyleSheet:function(t){if(this.$.createStyleSheet)this.$.createStyleSheet(t);else{var e=new CKEDITOR.dom.element("link");e.setAttributes({rel:"stylesheet",type:"text/css",href:t}),this.getHead().append(e)}},appendStyleText:function(t){if(this.$.createStyleSheet){var e=this.$.createStyleSheet("");e.cssText=t}else{var n=new CKEDITOR.dom.element("style",this);n.append(new CKEDITOR.dom.text(t,this)),this.getHead().append(n)}return e||n.$.sheet},createElement:function(t,e){var n=new CKEDITOR.dom.element(t,this);return e&&(e.attributes&&n.setAttributes(e.attributes),e.styles&&n.setStyles(e.styles)),n},createText:function(t){return new CKEDITOR.dom.text(t,this)},focus:function(){this.getWindow().focus()},getActive:function(){return new CKEDITOR.dom.element(this.$.activeElement)},getById:function(t){return(t=this.$.getElementById(t))?new CKEDITOR.dom.element(t):null},getByAddress:function(t,e){for(var n=this.$.documentElement,i=0;n&&i<t.length;i++){var o=t[i];if(e)for(var r=-1,s=0;s<n.childNodes.length;s++){var l=n.childNodes[s];if((e!==!0||3!=l.nodeType||!l.previousSibling||3!=l.previousSibling.nodeType)&&(r++,r==o)){n=l;break}}else n=n.childNodes[o]}return n?new CKEDITOR.dom.node(n):null},getElementsByTag:function(t,e){return(!CKEDITOR.env.ie||document.documentMode>8)&&e&&(t=e+":"+t),new CKEDITOR.dom.nodeList(this.$.getElementsByTagName(t))},getHead:function(){var t=this.$.getElementsByTagName("head")[0];return t=t?new CKEDITOR.dom.element(t):this.getDocumentElement().append(new CKEDITOR.dom.element("head"),!0)},getBody:function(){return new CKEDITOR.dom.element(this.$.body)},getDocumentElement:function(){return new CKEDITOR.dom.element(this.$.documentElement)},getWindow:function(){return new CKEDITOR.dom.window(this.$.parentWindow||this.$.defaultView)},write:function(t){this.$.open("text/html","replace"),CKEDITOR.env.ie&&(t=t.replace(/(?:^\s*<!DOCTYPE[^>]*?>)|^/i,'$&\n<script data-cke-temp="1">('+CKEDITOR.tools.fixDomain+")();</script>")),this.$.write(t),this.$.close()},find:function(t){return new CKEDITOR.dom.nodeList(this.$.querySelectorAll(t))},findOne:function(t){return(t=this.$.querySelector(t))?new CKEDITOR.dom.element(t):null},_getHtml5ShivFrag:function(){var t=this.getCustomData("html5ShivFrag");return t||(t=this.$.createDocumentFragment(),CKEDITOR.tools.enableHtml5Elements(t,!0),this.setCustomData("html5ShivFrag",t)),t}}),CKEDITOR.dom.nodeList=function(t){this.$=t},CKEDITOR.dom.nodeList.prototype={count:function(){return this.$.length},getItem:function(t){return 0>t||t>=this.$.length?null:(t=this.$[t])?new CKEDITOR.dom.node(t):null}},CKEDITOR.dom.element=function(t,e){"string"==typeof t&&(t=(e?e.$:document).createElement(t)),CKEDITOR.dom.domObject.call(this,t)},CKEDITOR.dom.element.get=function(t){return(t="string"==typeof t?document.getElementById(t)||document.getElementsByName(t)[0]:t)&&(t.$?t:new CKEDITOR.dom.element(t))},CKEDITOR.dom.element.prototype=new CKEDITOR.dom.node,CKEDITOR.dom.element.createFromHtml=function(t,e){var n=new CKEDITOR.dom.element("div",e);return n.setHtml(t),n.getFirst().remove()},CKEDITOR.dom.element.setMarker=function(t,e,n,i){var o=e.getCustomData("list_marker_id")||e.setCustomData("list_marker_id",CKEDITOR.tools.getNextNumber()).getCustomData("list_marker_id"),r=e.getCustomData("list_marker_names")||e.setCustomData("list_marker_names",{}).getCustomData("list_marker_names");return t[o]=e,r[n]=1,e.setCustomData(n,i)},CKEDITOR.dom.element.clearAllMarkers=function(t){for(var e in t)CKEDITOR.dom.element.clearMarkers(t,t[e],1)},CKEDITOR.dom.element.clearMarkers=function(t,e,n){var i,o=e.getCustomData("list_marker_names"),r=e.getCustomData("list_marker_id");for(i in o)e.removeCustomData(i);e.removeCustomData("list_marker_names"),n&&(e.removeCustomData("list_marker_id"),delete t[r])},function(){function t(t){var e=!0;return t.$.id||(t.$.id="cke_tmp_"+CKEDITOR.tools.getNextNumber(),e=!1),function(){e||t.removeAttribute("id")}}function e(t,e){return"#"+t.$.id+" "+e.split(/,\s*/).join(", #"+t.$.id+" ")}function n(t){for(var e=0,n=0,o=i[t].length;o>n;n++)e+=parseInt(this.getComputedStyle(i[t][n])||0,10)||0;return e}CKEDITOR.tools.extend(CKEDITOR.dom.element.prototype,{type:CKEDITOR.NODE_ELEMENT,addClass:function(t){var e=this.$.className;e&&(RegExp("(?:^|\\s)"+t+"(?:\\s|$)","").test(e)||(e+=" "+t)),this.$.className=e||t},removeClass:function(t){var e=this.getAttribute("class");return e&&(t=RegExp("(?:^|\\s+)"+t+"(?=\\s|$)","i"),t.test(e)&&((e=e.replace(t,"").replace(/^\s+/,""))?this.setAttribute("class",e):this.removeAttribute("class"))),this},hasClass:function(t){return RegExp("(?:^|\\s+)"+t+"(?=\\s|$)","").test(this.getAttribute("class"))},append:function(t,e){return"string"==typeof t&&(t=this.getDocument().createElement(t)),e?this.$.insertBefore(t.$,this.$.firstChild):this.$.appendChild(t.$),t},appendHtml:function(t){if(this.$.childNodes.length){var e=new CKEDITOR.dom.element("div",this.getDocument());e.setHtml(t),e.moveChildren(this)
}else this.setHtml(t)},appendText:function(t){void 0!=this.$.text?this.$.text=this.$.text+t:this.append(new CKEDITOR.dom.text(t))},appendBogus:function(t){if(t||CKEDITOR.env.needsBrFiller||CKEDITOR.env.opera){for(t=this.getLast();t&&t.type==CKEDITOR.NODE_TEXT&&!CKEDITOR.tools.rtrim(t.getText());)t=t.getPrevious();t&&t.is&&t.is("br")||(t=CKEDITOR.env.opera?this.getDocument().createText(""):this.getDocument().createElement("br"),CKEDITOR.env.gecko&&t.setAttribute("type","_moz"),this.append(t))}},breakParent:function(t){var e=new CKEDITOR.dom.range(this.getDocument());e.setStartAfter(this),e.setEndAfter(t),t=e.extractContents(),e.insertNode(this.remove()),t.insertAfterNode(this)},contains:CKEDITOR.env.ie||CKEDITOR.env.webkit?function(t){var e=this.$;return t.type!=CKEDITOR.NODE_ELEMENT?e.contains(t.getParent().$):e!=t.$&&e.contains(t.$)}:function(t){return!!(16&this.$.compareDocumentPosition(t.$))},focus:function(){function t(){try{this.$.focus()}catch(t){}}return function(e){e?CKEDITOR.tools.setTimeout(t,100,this):t.call(this)}}(),getHtml:function(){var t=this.$.innerHTML;return CKEDITOR.env.ie?t.replace(/<\?[^>]*>/g,""):t},getOuterHtml:function(){if(this.$.outerHTML)return this.$.outerHTML.replace(/<\?[^>]*>/,"");var t=this.$.ownerDocument.createElement("div");return t.appendChild(this.$.cloneNode(!0)),t.innerHTML},getClientRect:function(){var t=CKEDITOR.tools.extend({},this.$.getBoundingClientRect());return!t.width&&(t.width=t.right-t.left),!t.height&&(t.height=t.bottom-t.top),t},setHtml:CKEDITOR.env.ie&&CKEDITOR.env.version<9?function(t){try{var e=this.$;if(this.getParent())return e.innerHTML=t;var n=this.getDocument()._getHtml5ShivFrag();return n.appendChild(e),e.innerHTML=t,n.removeChild(e),t}catch(i){for(this.$.innerHTML="",e=new CKEDITOR.dom.element("body",this.getDocument()),e.$.innerHTML=t,e=e.getChildren();e.count();)this.append(e.getItem(0));return t}}:function(t){return this.$.innerHTML=t},setText:function(t){return CKEDITOR.dom.element.prototype.setText=void 0!=this.$.innerText?function(t){return this.$.innerText=t}:function(t){return this.$.textContent=t},this.setText(t)},getAttribute:function(){var t=function(t){return this.$.getAttribute(t,2)};return CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.ie6Compat)?function(t){switch(t){case"class":t="className";break;case"http-equiv":t="httpEquiv";break;case"name":return this.$.name;case"tabindex":return t=this.$.getAttribute(t,2),0!==t&&0===this.$.tabIndex&&(t=null),t;case"checked":return t=this.$.attributes.getNamedItem(t),(t.specified?t.nodeValue:this.$.checked)?"checked":null;case"hspace":case"value":return this.$[t];case"style":return this.$.style.cssText;case"contenteditable":case"contentEditable":return this.$.attributes.getNamedItem("contentEditable").specified?this.$.getAttribute("contentEditable"):null}return this.$.getAttribute(t,2)}:t}(),getChildren:function(){return new CKEDITOR.dom.nodeList(this.$.childNodes)},getComputedStyle:CKEDITOR.env.ie?function(t){return this.$.currentStyle[CKEDITOR.tools.cssStyleToDomStyle(t)]}:function(t){var e=this.getWindow().$.getComputedStyle(this.$,null);return e?e.getPropertyValue(t):""},getDtd:function(){var t=CKEDITOR.dtd[this.getName()];return this.getDtd=function(){return t},t},getElementsByTag:CKEDITOR.dom.document.prototype.getElementsByTag,getTabIndex:CKEDITOR.env.ie?function(){var t=this.$.tabIndex;return 0===t&&!CKEDITOR.dtd.$tabIndex[this.getName()]&&0!==parseInt(this.getAttribute("tabindex"),10)&&(t=-1),t}:CKEDITOR.env.webkit?function(){var t=this.$.tabIndex;return void 0==t&&(t=parseInt(this.getAttribute("tabindex"),10),isNaN(t)&&(t=-1)),t}:function(){return this.$.tabIndex},getText:function(){return this.$.textContent||this.$.innerText||""},getWindow:function(){return this.getDocument().getWindow()},getId:function(){return this.$.id||null},getNameAtt:function(){return this.$.name||null},getName:function(){var t=this.$.nodeName.toLowerCase();if(CKEDITOR.env.ie&&!(document.documentMode>8)){var e=this.$.scopeName;"HTML"!=e&&(t=e.toLowerCase()+":"+t)}return(this.getName=function(){return t})()},getValue:function(){return this.$.value},getFirst:function(t){var e=this.$.firstChild;return(e=e&&new CKEDITOR.dom.node(e))&&t&&!t(e)&&(e=e.getNext(t)),e},getLast:function(t){var e=this.$.lastChild;return(e=e&&new CKEDITOR.dom.node(e))&&t&&!t(e)&&(e=e.getPrevious(t)),e},getStyle:function(t){return this.$.style[CKEDITOR.tools.cssStyleToDomStyle(t)]},is:function(){var t=this.getName();if("object"==typeof arguments[0])return!!arguments[0][t];for(var e=0;e<arguments.length;e++)if(arguments[e]==t)return!0;return!1},isEditable:function(t){var e=this.getName();return this.isReadOnly()||"none"==this.getComputedStyle("display")||"hidden"==this.getComputedStyle("visibility")||CKEDITOR.dtd.$nonEditable[e]||CKEDITOR.dtd.$empty[e]||this.is("a")&&(this.data("cke-saved-name")||this.hasAttribute("name"))&&!this.getChildCount()?!1:t!==!1?(t=CKEDITOR.dtd[e]||CKEDITOR.dtd.span,!(!t||!t["#"])):!0},isIdentical:function(t){var e=this.clone(0,1),t=t.clone(0,1);if(e.removeAttributes(["_moz_dirty","data-cke-expando","data-cke-saved-href","data-cke-saved-name"]),t.removeAttributes(["_moz_dirty","data-cke-expando","data-cke-saved-href","data-cke-saved-name"]),e.$.isEqualNode)return e.$.style.cssText=CKEDITOR.tools.normalizeCssText(e.$.style.cssText),t.$.style.cssText=CKEDITOR.tools.normalizeCssText(t.$.style.cssText),e.$.isEqualNode(t.$);if(e=e.getOuterHtml(),t=t.getOuterHtml(),CKEDITOR.env.ie&&CKEDITOR.env.version<9&&this.is("a")){var n=this.getParent();n.type==CKEDITOR.NODE_ELEMENT&&(n=n.clone(),n.setHtml(e),e=n.getHtml(),n.setHtml(t),t=n.getHtml())}return e==t},isVisible:function(){var t,e,n=(this.$.offsetHeight||this.$.offsetWidth)&&"hidden"!=this.getComputedStyle("visibility");return n&&(CKEDITOR.env.webkit||CKEDITOR.env.opera)&&(t=this.getWindow(),!t.equals(CKEDITOR.document.getWindow())&&(e=t.$.frameElement)&&(n=new CKEDITOR.dom.element(e).isVisible())),!!n},isEmptyInlineRemoveable:function(){if(!CKEDITOR.dtd.$removeEmpty[this.getName()])return!1;for(var t=this.getChildren(),e=0,n=t.count();n>e;e++){var i=t.getItem(e);if((i.type!=CKEDITOR.NODE_ELEMENT||!i.data("cke-bookmark"))&&(i.type==CKEDITOR.NODE_ELEMENT&&!i.isEmptyInlineRemoveable()||i.type==CKEDITOR.NODE_TEXT&&CKEDITOR.tools.trim(i.getText())))return!1}return!0},hasAttributes:CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.ie6Compat)?function(){for(var t=this.$.attributes,e=0;e<t.length;e++){var n=t[e];switch(n.nodeName){case"class":if(this.getAttribute("class"))return!0;case"data-cke-expando":continue;default:if(n.specified)return!0}}return!1}:function(){var t=this.$.attributes,e=t.length,n={"data-cke-expando":1,_moz_dirty:1};return e>0&&(e>2||!n[t[0].nodeName]||2==e&&!n[t[1].nodeName])},hasAttribute:function(){function t(t){return t=this.$.attributes.getNamedItem(t),!(!t||!t.specified)}return CKEDITOR.env.ie&&CKEDITOR.env.version<8?function(e){return"name"==e?!!this.$.name:t.call(this,e)}:t}(),hide:function(){this.setStyle("display","none")},moveChildren:function(t,e){var n=this.$,t=t.$;if(n!=t){var i;if(e)for(;i=n.lastChild;)t.insertBefore(n.removeChild(i),t.firstChild);else for(;i=n.firstChild;)t.appendChild(n.removeChild(i))}},mergeSiblings:function(){function t(t,e,n){if(e&&e.type==CKEDITOR.NODE_ELEMENT){for(var i=[];e.data("cke-bookmark")||e.isEmptyInlineRemoveable();)if(i.push(e),e=n?e.getNext():e.getPrevious(),!e||e.type!=CKEDITOR.NODE_ELEMENT)return;if(t.isIdentical(e)){for(var o=n?t.getLast():t.getFirst();i.length;)i.shift().move(t,!n);e.moveChildren(t,!n),e.remove(),o&&o.type==CKEDITOR.NODE_ELEMENT&&o.mergeSiblings()}}}return function(e){(e===!1||CKEDITOR.dtd.$removeEmpty[this.getName()]||this.is("a"))&&(t(this,this.getNext(),!0),t(this,this.getPrevious()))}}(),show:function(){this.setStyles({display:"",visibility:""})},setAttribute:function(){var t=function(t,e){return this.$.setAttribute(t,e),this};return CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.ie6Compat)?function(e,n){return"class"==e?this.$.className=n:"style"==e?this.$.style.cssText=n:"tabindex"==e?this.$.tabIndex=n:"checked"==e?this.$.checked=n:"contenteditable"==e?t.call(this,"contentEditable",n):t.apply(this,arguments),this}:CKEDITOR.env.ie8Compat&&CKEDITOR.env.secure?function(e,n){if("src"==e&&n.match(/^http:\/\//))try{t.apply(this,arguments)}catch(i){}else t.apply(this,arguments);return this}:t}(),setAttributes:function(t){for(var e in t)this.setAttribute(e,t[e]);return this},setValue:function(t){return this.$.value=t,this},removeAttribute:function(){var t=function(t){this.$.removeAttribute(t)};return CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.ie6Compat)?function(t){"class"==t?t="className":"tabindex"==t?t="tabIndex":"contenteditable"==t&&(t="contentEditable"),this.$.removeAttribute(t)}:t}(),removeAttributes:function(t){if(CKEDITOR.tools.isArray(t))for(var e=0;e<t.length;e++)this.removeAttribute(t[e]);else for(e in t)t.hasOwnProperty(e)&&this.removeAttribute(e)},removeStyle:function(t){var e=this.$.style;if(e.removeProperty||"border"!=t&&"margin"!=t&&"padding"!=t)e.removeProperty?e.removeProperty(t):e.removeAttribute(CKEDITOR.tools.cssStyleToDomStyle(t)),this.$.style.cssText||this.removeAttribute("style");else{var n,i=["top","left","right","bottom"];"border"==t&&(n=["color","style","width"]);for(var e=[],o=0;o<i.length;o++)if(n)for(var r=0;r<n.length;r++)e.push([t,i[o],n[r]].join("-"));else e.push([t,i[o]].join("-"));for(t=0;t<e.length;t++)this.removeStyle(e[t])}},setStyle:function(t,e){return this.$.style[CKEDITOR.tools.cssStyleToDomStyle(t)]=e,this},setStyles:function(t){for(var e in t)this.setStyle(e,t[e]);return this},setOpacity:function(t){CKEDITOR.env.ie&&CKEDITOR.env.version<9?(t=Math.round(100*t),this.setStyle("filter",t>=100?"":"progid:DXImageTransform.Microsoft.Alpha(opacity="+t+")")):this.setStyle("opacity",t)},unselectable:function(){if(this.setStyles(CKEDITOR.tools.cssVendorPrefix("user-select","none")),CKEDITOR.env.ie||CKEDITOR.env.opera){this.setAttribute("unselectable","on");for(var t,e=this.getElementsByTag("*"),n=0,i=e.count();i>n;n++)t=e.getItem(n),t.setAttribute("unselectable","on")}},getPositionedAncestor:function(){for(var t=this;"html"!=t.getName();){if("static"!=t.getComputedStyle("position"))return t;t=t.getParent()}return null},getDocumentPosition:function(t){var e=0,n=0,i=this.getDocument(),o=i.getBody(),r="BackCompat"==i.$.compatMode;if(document.documentElement.getBoundingClientRect){var s=this.$.getBoundingClientRect(),l=i.$.documentElement,a=l.clientTop||o.$.clientTop||0,h=l.clientLeft||o.$.clientLeft||0,d=!0;CKEDITOR.env.ie&&(d=i.getDocumentElement().contains(this),i=i.getBody().contains(this),d=r&&i||!r&&d),d&&(e=s.left+(!r&&l.scrollLeft||o.$.scrollLeft),e-=h,n=s.top+(!r&&l.scrollTop||o.$.scrollTop),n-=a)}else for(o=this,i=null;o&&"body"!=o.getName()&&"html"!=o.getName();){for(e+=o.$.offsetLeft-o.$.scrollLeft,n+=o.$.offsetTop-o.$.scrollTop,o.equals(this)||(e+=o.$.clientLeft||0,n+=o.$.clientTop||0);i&&!i.equals(o);)e-=i.$.scrollLeft,n-=i.$.scrollTop,i=i.getParent();i=o,o=(s=o.$.offsetParent)?new CKEDITOR.dom.element(s):null}return t&&(o=this.getWindow(),i=t.getWindow(),!o.equals(i)&&o.$.frameElement&&(t=new CKEDITOR.dom.element(o.$.frameElement).getDocumentPosition(t),e+=t.x,n+=t.y)),document.documentElement.getBoundingClientRect||!CKEDITOR.env.gecko||r||(e+=this.$.clientLeft?1:0,n+=this.$.clientTop?1:0),{x:e,y:n}},scrollIntoView:function(t){var e=this.getParent();if(e)do if((e.$.clientWidth&&e.$.clientWidth<e.$.scrollWidth||e.$.clientHeight&&e.$.clientHeight<e.$.scrollHeight)&&!e.is("body")&&this.scrollIntoParent(e,t,1),e.is("html")){var n=e.getWindow();try{var i=n.$.frameElement;i&&(e=new CKEDITOR.dom.element(i))}catch(o){}}while(e=e.getParent())},scrollIntoParent:function(t,e,n){function i(e,n){/body|html/.test(t.getName())?t.getWindow().$.scrollBy(e,n):(t.$.scrollLeft=t.$.scrollLeft+e,t.$.scrollTop=t.$.scrollTop+n)}function o(t,e){var n={x:0,y:0};if(!t.is(d?"body":"html")){var i=t.$.getBoundingClientRect();n.x=i.left,n.y=i.top}return i=t.getWindow(),i.equals(e)||(i=o(CKEDITOR.dom.element.get(i.$.frameElement),e),n.x=n.x+i.x,n.y=n.y+i.y),n}function r(t,e){return parseInt(t.getComputedStyle("margin-"+e)||0,10)||0}var s,l,a,h;!t&&(t=this.getWindow()),a=t.getDocument();var d="BackCompat"==a.$.compatMode;t instanceof CKEDITOR.dom.window&&(t=d?a.getBody():a.getDocumentElement()),a=t.getWindow(),l=o(this,a);var u=o(t,a),c=this.$.offsetHeight;s=this.$.offsetWidth;var p=t.$.clientHeight,m=t.$.clientWidth;a=l.x-r(this,"left")-u.x||0,h=l.y-r(this,"top")-u.y||0,s=l.x+s+r(this,"right")-(u.x+m)||0,l=l.y+c+r(this,"bottom")-(u.y+p)||0,(0>h||l>0)&&i(0,e===!0?h:e===!1?l:0>h?h:l),n&&(0>a||s>0)&&i(0>a?a:s,0)},setState:function(t,e,n){switch(e=e||"cke",t){case CKEDITOR.TRISTATE_ON:this.addClass(e+"_on"),this.removeClass(e+"_off"),this.removeClass(e+"_disabled"),n&&this.setAttribute("aria-pressed",!0),n&&this.removeAttribute("aria-disabled");break;case CKEDITOR.TRISTATE_DISABLED:this.addClass(e+"_disabled"),this.removeClass(e+"_off"),this.removeClass(e+"_on"),n&&this.setAttribute("aria-disabled",!0),n&&this.removeAttribute("aria-pressed");break;default:this.addClass(e+"_off"),this.removeClass(e+"_on"),this.removeClass(e+"_disabled"),n&&this.removeAttribute("aria-pressed"),n&&this.removeAttribute("aria-disabled")}},getFrameDocument:function(){var t=this.$;try{t.contentWindow.document}catch(e){t.src=t.src}return t&&new CKEDITOR.dom.document(t.contentWindow.document)},copyAttributes:function(t,e){for(var n=this.$.attributes,e=e||{},i=0;i<n.length;i++){var o,r=n[i],s=r.nodeName.toLowerCase();s in e||("checked"==s&&(o=this.getAttribute(s))?t.setAttribute(s,o):(r.specified||CKEDITOR.env.ie&&r.nodeValue&&"value"==s)&&(o=this.getAttribute(s),null===o&&(o=r.nodeValue),t.setAttribute(s,o)))}""!==this.$.style.cssText&&(t.$.style.cssText=this.$.style.cssText)},renameNode:function(t){if(this.getName()!=t){var e=this.getDocument(),t=new CKEDITOR.dom.element(t,e);this.copyAttributes(t),this.moveChildren(t),this.getParent()&&this.$.parentNode.replaceChild(t.$,this.$),t.$["data-cke-expando"]=this.$["data-cke-expando"],this.$=t.$}},getChild:function(){function t(t,e){var n=t.childNodes;return e>=0&&e<n.length?n[e]:void 0}return function(e){var n=this.$;if(e.slice)for(;e.length>0&&n;)n=t(n,e.shift());else n=t(n,e);return n?new CKEDITOR.dom.node(n):null}}(),getChildCount:function(){return this.$.childNodes.length},disableContextMenu:function(){this.on("contextmenu",function(t){t.data.getTarget().hasClass("cke_enable_context_menu")||t.data.preventDefault()})},getDirection:function(t){return t?this.getComputedStyle("direction")||this.getDirection()||this.getParent()&&this.getParent().getDirection(1)||this.getDocument().$.dir||"ltr":this.getStyle("direction")||this.getAttribute("dir")},data:function(t,e){return t="data-"+t,void 0===e?this.getAttribute(t):(e===!1?this.removeAttribute(t):this.setAttribute(t,e),null)},getEditor:function(){var t,e,n=CKEDITOR.instances;for(t in n)if(e=n[t],e.element.equals(this)&&e.elementMode!=CKEDITOR.ELEMENT_MODE_APPENDTO)return e;return null},find:function(n){var i=t(this),n=new CKEDITOR.dom.nodeList(this.$.querySelectorAll(e(this,n)));return i(),n},findOne:function(n){var i=t(this),n=this.$.querySelector(e(this,n));return i(),n?new CKEDITOR.dom.element(n):null},forEach:function(t,e,n){if(!(n||e&&this.type!=e))var i=t(this);if(i!==!1)for(var n=this.getChildren(),o=0;o<n.count();o++)i=n.getItem(o),i.type==CKEDITOR.NODE_ELEMENT?i.forEach(t,e):(!e||i.type==e)&&t(i)}});var i={width:["border-left-width","border-right-width","padding-left","padding-right"],height:["border-top-width","border-bottom-width","padding-top","padding-bottom"]};CKEDITOR.dom.element.prototype.setSize=function(t,e,i){"number"==typeof e&&(!i||CKEDITOR.env.ie&&CKEDITOR.env.quirks||(e-=n.call(this,t)),this.setStyle(t,e+"px"))},CKEDITOR.dom.element.prototype.getSize=function(t,e){var i=Math.max(this.$["offset"+CKEDITOR.tools.capitalize(t)],this.$["client"+CKEDITOR.tools.capitalize(t)])||0;return e&&(i-=n.call(this,t)),i}}(),CKEDITOR.dom.documentFragment=function(t){t=t||CKEDITOR.document,this.$=t.type==CKEDITOR.NODE_DOCUMENT?t.$.createDocumentFragment():t},CKEDITOR.tools.extend(CKEDITOR.dom.documentFragment.prototype,CKEDITOR.dom.element.prototype,{type:CKEDITOR.NODE_DOCUMENT_FRAGMENT,insertAfterNode:function(t){t=t.$,t.parentNode.insertBefore(this.$,t.nextSibling)}},!0,{append:1,appendBogus:1,getFirst:1,getLast:1,getParent:1,getNext:1,getPrevious:1,appendTo:1,moveChildren:1,insertBefore:1,insertAfterNode:1,replace:1,trim:1,type:1,ltrim:1,rtrim:1,getDocument:1,getChildCount:1,getChild:1,getChildren:1}),function(){function t(t,e){var n=this.range;if(this._.end)return null;if(!this._.start){if(this._.start=1,n.collapsed)return this.end(),null;n.optimize()}var i,o=n.startContainer;i=n.endContainer;var r,s=n.startOffset,l=n.endOffset,a=this.guard,h=this.type,d=t?"getPreviousSourceNode":"getNextSourceNode";if(!t&&!this._.guardLTR){var u=i.type==CKEDITOR.NODE_ELEMENT?i:i.getParent(),c=i.type==CKEDITOR.NODE_ELEMENT?i.getChild(l):i.getNext();this._.guardLTR=function(t,e){return!(e&&u.equals(t)||c&&t.equals(c)||t.type==CKEDITOR.NODE_ELEMENT&&e&&t.equals(n.root))}}if(t&&!this._.guardRTL){var p=o.type==CKEDITOR.NODE_ELEMENT?o:o.getParent(),m=o.type==CKEDITOR.NODE_ELEMENT?s?o.getChild(s-1):null:o.getPrevious();this._.guardRTL=function(t,e){return!(e&&p.equals(t)||m&&t.equals(m)||t.type==CKEDITOR.NODE_ELEMENT&&e&&t.equals(n.root))}}var g=t?this._.guardRTL:this._.guardLTR;for(r=a?function(t,e){return g(t,e)===!1?!1:a(t,e)}:g,this.current?i=this.current[d](!1,h,r):(t?i.type==CKEDITOR.NODE_ELEMENT&&(i=l>0?i.getChild(l-1):r(i,!0)===!1?null:i.getPreviousSourceNode(!0,h,r)):(i=o,i.type!=CKEDITOR.NODE_ELEMENT||(i=i.getChild(s))||(i=r(o,!0)===!1?null:o.getNextSourceNode(!0,h,r))),i&&r(i)===!1&&(i=null));i&&!this._.end;){if(this.current=i,this.evaluator&&this.evaluator(i)===!1){if(e&&this.evaluator)return!1}else if(!e)return i;i=i[d](!1,h,r)}return this.end(),this.current=null}function e(e){for(var n,i=null;n=t.call(this,e);)i=n;return i}function n(t){if(h(t))return!1;if(t.type==CKEDITOR.NODE_TEXT)return!0;if(t.type==CKEDITOR.NODE_ELEMENT){if(t.is(CKEDITOR.dtd.$inline)||"false"==t.getAttribute("contenteditable"))return!0;var e;if((e=!CKEDITOR.env.needsBrFiller)&&(e=t.is(d)))t:{e=0;for(var n=t.getChildCount();n>e;++e)if(!h(t.getChild(e))){e=!1;break t}e=!0}if(e)return!0}return!1}CKEDITOR.dom.walker=CKEDITOR.tools.createClass({$:function(t){this.range=t,this._={}},proto:{end:function(){this._.end=1},next:function(){return t.call(this)},previous:function(){return t.call(this,1)},checkForward:function(){return t.call(this,0,1)!==!1},checkBackward:function(){return t.call(this,1,1)!==!1},lastForward:function(){return e.call(this)},lastBackward:function(){return e.call(this,1)},reset:function(){delete this.current,this._={}}}});var i={block:1,"list-item":1,table:1,"table-row-group":1,"table-header-group":1,"table-footer-group":1,"table-row":1,"table-column-group":1,"table-column":1,"table-cell":1,"table-caption":1},o={absolute:1,fixed:1};CKEDITOR.dom.element.prototype.isBlockBoundary=function(t){return"none"!=this.getComputedStyle("float")||this.getComputedStyle("position")in o||!i[this.getComputedStyle("display")]?!!(this.is(CKEDITOR.dtd.$block)||t&&this.is(t)):!0},CKEDITOR.dom.walker.blockBoundary=function(t){return function(e){return!(e.type==CKEDITOR.NODE_ELEMENT&&e.isBlockBoundary(t))}},CKEDITOR.dom.walker.listItemBoundary=function(){return this.blockBoundary({br:1})},CKEDITOR.dom.walker.bookmark=function(t,e){function n(t){return t&&t.getName&&"span"==t.getName()&&t.data("cke-bookmark")}return function(i){var o,r;return o=i&&i.type!=CKEDITOR.NODE_ELEMENT&&(r=i.getParent())&&n(r),o=t?o:o||n(i),!!(e^o)}},CKEDITOR.dom.walker.whitespaces=function(t){return function(e){var n;return e&&e.type==CKEDITOR.NODE_TEXT&&(n=!CKEDITOR.tools.trim(e.getText())||CKEDITOR.env.webkit&&""==e.getText()),!!(t^n)}},CKEDITOR.dom.walker.invisible=function(t){var e=CKEDITOR.dom.walker.whitespaces();return function(n){return e(n)?n=1:(n.type==CKEDITOR.NODE_TEXT&&(n=n.getParent()),n=!n.$.offsetHeight),!!(t^n)}},CKEDITOR.dom.walker.nodeType=function(t,e){return function(n){return!!(e^n.type==t)}},CKEDITOR.dom.walker.bogus=function(t){function e(t){return!s(t)&&!l(t)}return function(n){var i=CKEDITOR.env.needsBrFiller?n.is&&n.is("br"):n.getText&&r.test(n.getText());return i&&(i=n.getParent(),n=n.getNext(e),i=i.isBlockBoundary()&&(!n||n.type==CKEDITOR.NODE_ELEMENT&&n.isBlockBoundary())),!!(t^i)}},CKEDITOR.dom.walker.temp=function(t){return function(e){return e.type!=CKEDITOR.NODE_ELEMENT&&(e=e.getParent()),e=e&&e.hasAttribute("data-cke-temp"),!!(t^e)}};var r=/^[\t\r\n ]*(?:&nbsp;|\xa0)$/,s=CKEDITOR.dom.walker.whitespaces(),l=CKEDITOR.dom.walker.bookmark(),a=CKEDITOR.dom.walker.temp();CKEDITOR.dom.walker.ignored=function(t){return function(e){return e=s(e)||l(e)||a(e),!!(t^e)}};var h=CKEDITOR.dom.walker.ignored(),d=function(t){var e,n={};for(e in t)CKEDITOR.dtd[e]["#"]&&(n[e]=1);return n}(CKEDITOR.dtd.$block);CKEDITOR.dom.walker.editable=function(t){return function(e){return!!(t^n(e))}},CKEDITOR.dom.element.prototype.getBogus=function(){var t=this;do t=t.getPreviousSourceNode();while(l(t)||s(t)||t.type==CKEDITOR.NODE_ELEMENT&&t.is(CKEDITOR.dtd.$inline)&&!t.is(CKEDITOR.dtd.$empty));return t&&(CKEDITOR.env.needsBrFiller?t.is&&t.is("br"):t.getText&&r.test(t.getText()))?t:!1}}(),CKEDITOR.dom.range=function(t){this.endOffset=this.endContainer=this.startOffset=this.startContainer=null,this.collapsed=!0;var e=t instanceof CKEDITOR.dom.document;this.document=e?t:t.getDocument(),this.root=e?t.getBody():t},function(){function t(){var t=!1,e=CKEDITOR.dom.walker.whitespaces(),n=CKEDITOR.dom.walker.bookmark(!0),i=CKEDITOR.dom.walker.bogus();return function(o){return n(o)||e(o)?!0:i(o)&&!t?t=!0:o.type==CKEDITOR.NODE_TEXT&&(o.hasAscendant("pre")||CKEDITOR.tools.trim(o.getText()).length)||o.type==CKEDITOR.NODE_ELEMENT&&!o.is(r)?!1:!0}}function e(t){var e=CKEDITOR.dom.walker.whitespaces(),n=CKEDITOR.dom.walker.bookmark(1);return function(i){return n(i)||e(i)?!0:!t&&s(i)||i.type==CKEDITOR.NODE_ELEMENT&&i.is(CKEDITOR.dtd.$removeEmpty)}}function n(t){return function(){var e;return this[t?"getPreviousNode":"getNextNode"](function(t){return!e&&h(t)&&(e=t),a(t)&&!(s(t)&&t.equals(e))})}}var i=function(t){t.collapsed=t.startContainer&&t.endContainer&&t.startContainer.equals(t.endContainer)&&t.startOffset==t.endOffset},o=function(t,e,n,i){t.optimizeBookmark();var o,r,s=t.startContainer,l=t.endContainer,a=t.startOffset,h=t.endOffset;l.type==CKEDITOR.NODE_TEXT?l=l.split(h):l.getChildCount()>0&&(h>=l.getChildCount()?(l=l.append(t.document.createText("")),r=!0):l=l.getChild(h)),s.type==CKEDITOR.NODE_TEXT?(s.split(a),s.equals(l)&&(l=s.getNext())):a?a>=s.getChildCount()?(s=s.append(t.document.createText("")),o=!0):s=s.getChild(a).getPrevious():(s=s.append(t.document.createText(""),1),o=!0);var d,u,c,a=s.getParents(),h=l.getParents();for(d=0;d<a.length&&(u=a[d],c=h[d],u.equals(c));d++);for(var p,m,g,f=n,x=d;x<a.length;x++){for(p=a[x],f&&!p.equals(s)&&(m=f.append(p.clone())),p=p.getNext();p&&(!p.equals(h[x])&&!p.equals(l));)g=p.getNext(),2==e?f.append(p.clone(!0)):(p.remove(),1==e&&f.append(p)),p=g;f&&(f=m)}for(f=n,n=d;n<h.length;n++){if(p=h[n],e>0&&!p.equals(l)&&(m=f.append(p.clone())),!a[n]||p.$.parentNode!=a[n].$.parentNode)for(p=p.getPrevious();p&&(!p.equals(a[n])&&!p.equals(s));)g=p.getPrevious(),2==e?f.$.insertBefore(p.$.cloneNode(!0),f.$.firstChild):(p.remove(),1==e&&f.$.insertBefore(p.$,f.$.firstChild)),p=g;f&&(f=m)}2==e?(u=t.startContainer,u.type==CKEDITOR.NODE_TEXT&&(u.$.data=u.$.data+u.$.nextSibling.data,u.$.parentNode.removeChild(u.$.nextSibling)),t=t.endContainer,t.type==CKEDITOR.NODE_TEXT&&t.$.nextSibling&&(t.$.data=t.$.data+t.$.nextSibling.data,t.$.parentNode.removeChild(t.$.nextSibling))):(u&&c&&(s.$.parentNode!=u.$.parentNode||l.$.parentNode!=c.$.parentNode)&&(e=c.getIndex(),o&&c.$.parentNode==s.$.parentNode&&e--,i&&u.type==CKEDITOR.NODE_ELEMENT?(i=CKEDITOR.dom.element.createFromHtml('<span data-cke-bookmark="1" style="display:none">&nbsp;</span>',t.document),i.insertAfter(u),u.mergeSiblings(!1),t.moveToBookmark({startNode:i})):t.setStart(c.getParent(),e)),t.collapse(!0)),o&&s.remove(),r&&l.$.parentNode&&l.remove()},r={abbr:1,acronym:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1},s=CKEDITOR.dom.walker.bogus(),l=/^[\t\r\n ]*(?:&nbsp;|\xa0)$/,a=CKEDITOR.dom.walker.editable(),h=CKEDITOR.dom.walker.ignored(!0);CKEDITOR.dom.range.prototype={clone:function(){var t=new CKEDITOR.dom.range(this.root);return t.startContainer=this.startContainer,t.startOffset=this.startOffset,t.endContainer=this.endContainer,t.endOffset=this.endOffset,t.collapsed=this.collapsed,t},collapse:function(t){t?(this.endContainer=this.startContainer,this.endOffset=this.startOffset):(this.startContainer=this.endContainer,this.startOffset=this.endOffset),this.collapsed=!0},cloneContents:function(){var t=new CKEDITOR.dom.documentFragment(this.document);return this.collapsed||o(this,2,t),t},deleteContents:function(t){this.collapsed||o(this,0,null,t)},extractContents:function(t){var e=new CKEDITOR.dom.documentFragment(this.document);return this.collapsed||o(this,1,e,t),e},createBookmark:function(t){var e,n,i,o,r=this.collapsed;return e=this.document.createElement("span"),e.data("cke-bookmark",1),e.setStyle("display","none"),e.setHtml("&nbsp;"),t&&(i="cke_bm_"+CKEDITOR.tools.getNextNumber(),e.setAttribute("id",i+(r?"C":"S"))),r||(n=e.clone(),n.setHtml("&nbsp;"),t&&n.setAttribute("id",i+"E"),o=this.clone(),o.collapse(),o.insertNode(n)),o=this.clone(),o.collapse(!0),o.insertNode(e),n?(this.setStartAfter(e),this.setEndBefore(n)):this.moveToPosition(e,CKEDITOR.POSITION_AFTER_END),{startNode:t?i+(r?"C":"S"):e,endNode:t?i+"E":n,serializable:t,collapsed:r}},createBookmark2:function(){function t(t){var e,n=t.container,i=t.offset;e=n;var o=i;if(e=e.type!=CKEDITOR.NODE_ELEMENT||0===o||o==e.getChildCount()?0:e.getChild(o-1).type==CKEDITOR.NODE_TEXT&&e.getChild(o).type==CKEDITOR.NODE_TEXT,e&&(n=n.getChild(i-1),i=n.getLength()),n.type==CKEDITOR.NODE_ELEMENT&&i>1&&(i=n.getChild(i-1).getIndex(!0)+1),n.type==CKEDITOR.NODE_TEXT){for(e=n,o=0;(e=e.getPrevious())&&e.type==CKEDITOR.NODE_TEXT;)o+=e.getLength();i+=o}t.container=n,t.offset=i}return function(e){var n=this.collapsed,i={container:this.startContainer,offset:this.startOffset},o={container:this.endContainer,offset:this.endOffset};return e&&(t(i),n||t(o)),{start:i.container.getAddress(e),end:n?null:o.container.getAddress(e),startOffset:i.offset,endOffset:o.offset,normalized:e,collapsed:n,is2:!0}}}(),moveToBookmark:function(t){if(t.is2){var e=this.document.getByAddress(t.start,t.normalized),n=t.startOffset,i=t.end&&this.document.getByAddress(t.end,t.normalized),t=t.endOffset;this.setStart(e,n),i?this.setEnd(i,t):this.collapse(!0)}else e=(n=t.serializable)?this.document.getById(t.startNode):t.startNode,t=n?this.document.getById(t.endNode):t.endNode,this.setStartBefore(e),e.remove(),t?(this.setEndBefore(t),t.remove()):this.collapse(!0)},getBoundaryNodes:function(){var t,e=this.startContainer,n=this.endContainer,i=this.startOffset,o=this.endOffset;if(e.type==CKEDITOR.NODE_ELEMENT)if(t=e.getChildCount(),t>i)e=e.getChild(i);else if(1>t)e=e.getPreviousSourceNode();else{for(e=e.$;e.lastChild;)e=e.lastChild;e=new CKEDITOR.dom.node(e),e=e.getNextSourceNode()||e}if(n.type==CKEDITOR.NODE_ELEMENT)if(t=n.getChildCount(),t>o)n=n.getChild(o).getPreviousSourceNode(!0);else if(1>t)n=n.getPreviousSourceNode();else{for(n=n.$;n.lastChild;)n=n.lastChild;n=new CKEDITOR.dom.node(n)}return e.getPosition(n)&CKEDITOR.POSITION_FOLLOWING&&(e=n),{startNode:e,endNode:n}},getCommonAncestor:function(t,e){var n=this.startContainer,i=this.endContainer,n=n.equals(i)?t&&n.type==CKEDITOR.NODE_ELEMENT&&this.startOffset==this.endOffset-1?n.getChild(this.startOffset):n:n.getCommonAncestor(i);return e&&!n.is?n.getParent():n},optimize:function(){var t=this.startContainer,e=this.startOffset;t.type!=CKEDITOR.NODE_ELEMENT&&(e?e>=t.getLength()&&this.setStartAfter(t):this.setStartBefore(t)),t=this.endContainer,e=this.endOffset,t.type!=CKEDITOR.NODE_ELEMENT&&(e?e>=t.getLength()&&this.setEndAfter(t):this.setEndBefore(t))},optimizeBookmark:function(){var t=this.startContainer,e=this.endContainer;t.is&&t.is("span")&&t.data("cke-bookmark")&&this.setStartAt(t,CKEDITOR.POSITION_BEFORE_START),e&&e.is&&e.is("span")&&e.data("cke-bookmark")&&this.setEndAt(e,CKEDITOR.POSITION_AFTER_END)},trim:function(t,e){var n=this.startContainer,i=this.startOffset,o=this.collapsed;if((!t||o)&&n&&n.type==CKEDITOR.NODE_TEXT){if(i)if(i>=n.getLength())i=n.getIndex()+1,n=n.getParent();else{var r=n.split(i),i=n.getIndex()+1,n=n.getParent();this.startContainer.equals(this.endContainer)?this.setEnd(r,this.endOffset-this.startOffset):n.equals(this.endContainer)&&(this.endOffset=this.endOffset+1)}else i=n.getIndex(),n=n.getParent();if(this.setStart(n,i),o)return this.collapse(!0),void 0}n=this.endContainer,i=this.endOffset,e||o||!n||n.type!=CKEDITOR.NODE_TEXT||(i?(i>=n.getLength()||n.split(i),i=n.getIndex()+1):i=n.getIndex(),n=n.getParent(),this.setEnd(n,i))},enlarge:function(t,e){function n(t){return t&&t.type==CKEDITOR.NODE_ELEMENT&&t.hasAttribute("contenteditable")?null:t}var i=RegExp(/[^\s\ufeff]/);switch(t){case CKEDITOR.ENLARGE_INLINE:var o=1;case CKEDITOR.ENLARGE_ELEMENT:if(this.collapsed)break;var r,s,l,a,h,d,u,c=this.getCommonAncestor(),p=this.root,m=!1;d=this.startContainer;var g=this.startOffset;for(d.type==CKEDITOR.NODE_TEXT?(g&&(d=!CKEDITOR.tools.trim(d.substring(0,g)).length&&d,m=!!d),d&&!(a=d.getPrevious())&&(l=d.getParent())):(g&&(a=d.getChild(g-1)||d.getLast()),a||(l=d)),l=n(l);l||a;){if(l&&!a){if(!h&&l.equals(c)&&(h=!0),o?l.isBlockBoundary():!p.contains(l))break;m&&"inline"==l.getComputedStyle("display")||(m=!1,h?r=l:this.setStartBefore(l)),a=l.getPrevious()}for(;a;)if(d=!1,a.type==CKEDITOR.NODE_COMMENT)a=a.getPrevious();else{if(a.type==CKEDITOR.NODE_TEXT)u=a.getText(),i.test(u)&&(a=null),d=/[\s\ufeff]$/.test(u);else if((a.$.offsetWidth>0||e&&a.is("br"))&&!a.data("cke-bookmark"))if(m&&CKEDITOR.dtd.$removeEmpty[a.getName()]){if(u=a.getText(),i.test(u))a=null;else for(var f,g=a.$.getElementsByTagName("*"),x=0;f=g[x++];)if(!CKEDITOR.dtd.$removeEmpty[f.nodeName.toLowerCase()]){a=null;break}a&&(d=!!u.length)}else a=null;if(d&&(m?h?r=l:l&&this.setStartBefore(l):m=!0),a){if(d=a.getPrevious(),!l&&!d){l=a,a=null;break}a=d}else l=null}l&&(l=n(l.getParent()))}d=this.endContainer,g=this.endOffset,l=a=null,h=m=!1;var C=function(t,e){var n=new CKEDITOR.dom.range(p);n.setStart(t,e),n.setEndAt(p,CKEDITOR.POSITION_BEFORE_END);var o,n=new CKEDITOR.dom.walker(n);for(n.guard=function(t){return!(t.type==CKEDITOR.NODE_ELEMENT&&t.isBlockBoundary())};o=n.next();){if(o.type!=CKEDITOR.NODE_TEXT)return!1;if(u=o!=t?o.getText():o.substring(e),i.test(u))return!1}return!0};for(d.type==CKEDITOR.NODE_TEXT?CKEDITOR.tools.trim(d.substring(g)).length?m=!0:(m=!d.getLength(),g==d.getLength()?(a=d.getNext())||(l=d.getParent()):C(d,g)&&(l=d.getParent())):(a=d.getChild(g))||(l=d);l||a;){if(l&&!a){if(!h&&l.equals(c)&&(h=!0),o?l.isBlockBoundary():!p.contains(l))break;m&&"inline"==l.getComputedStyle("display")||(m=!1,h?s=l:l&&this.setEndAfter(l)),a=l.getNext()}for(;a;){if(d=!1,a.type==CKEDITOR.NODE_TEXT)u=a.getText(),C(a,0)||(a=null),d=/^[\s\ufeff]/.test(u);else if(a.type==CKEDITOR.NODE_ELEMENT){if((a.$.offsetWidth>0||e&&a.is("br"))&&!a.data("cke-bookmark"))if(m&&CKEDITOR.dtd.$removeEmpty[a.getName()]){if(u=a.getText(),i.test(u))a=null;else for(g=a.$.getElementsByTagName("*"),x=0;f=g[x++];)if(!CKEDITOR.dtd.$removeEmpty[f.nodeName.toLowerCase()]){a=null;break}a&&(d=!!u.length)}else a=null}else d=1;if(d&&m&&(h?s=l:this.setEndAfter(l)),a){if(d=a.getNext(),!l&&!d){l=a,a=null;break}a=d}else l=null}l&&(l=n(l.getParent()))}r&&s&&(c=r.contains(s)?s:r,this.setStartBefore(c),this.setEndAfter(c));break;case CKEDITOR.ENLARGE_BLOCK_CONTENTS:case CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS:l=new CKEDITOR.dom.range(this.root),p=this.root,l.setStartAt(p,CKEDITOR.POSITION_AFTER_START),l.setEnd(this.startContainer,this.startOffset),l=new CKEDITOR.dom.walker(l);var E,y,v=CKEDITOR.dom.walker.blockBoundary(t==CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS?{br:1}:null),T=null,b=function(t){if(t.type==CKEDITOR.NODE_ELEMENT&&"false"==t.getAttribute("contenteditable"))if(T){if(T.equals(t))return T=null,void 0}else T=t;else if(T)return;var e=v(t);return e||(E=t),e},o=function(t){var e=b(t);return!e&&t.is&&t.is("br")&&(y=t),e};if(l.guard=b,l=l.lastBackward(),E=E||p,this.setStartAt(E,!E.is("br")&&(!l&&this.checkStartOfBlock()||l&&E.contains(l))?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_AFTER_END),t==CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS){l=this.clone(),l=new CKEDITOR.dom.walker(l);
var I=CKEDITOR.dom.walker.whitespaces(),S=CKEDITOR.dom.walker.bookmark();if(l.evaluator=function(t){return!I(t)&&!S(t)},(l=l.previous())&&l.type==CKEDITOR.NODE_ELEMENT&&l.is("br"))break}l=this.clone(),l.collapse(),l.setEndAt(p,CKEDITOR.POSITION_BEFORE_END),l=new CKEDITOR.dom.walker(l),l.guard=t==CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS?o:b,E=null,l=l.lastForward(),E=E||p,this.setEndAt(E,!l&&this.checkEndOfBlock()||l&&E.contains(l)?CKEDITOR.POSITION_BEFORE_END:CKEDITOR.POSITION_BEFORE_START),y&&this.setEndAfter(y)}},shrink:function(t,e,n){if(!this.collapsed){var t=t||CKEDITOR.SHRINK_TEXT,i=this.clone(),o=this.startContainer,r=this.endContainer,s=this.startOffset,l=this.endOffset,a=1,h=1;o&&o.type==CKEDITOR.NODE_TEXT&&(s?s>=o.getLength()?i.setStartAfter(o):(i.setStartBefore(o),a=0):i.setStartBefore(o)),r&&r.type==CKEDITOR.NODE_TEXT&&(l?l>=r.getLength()?i.setEndAfter(r):(i.setEndAfter(r),h=0):i.setEndBefore(r));var i=new CKEDITOR.dom.walker(i),d=CKEDITOR.dom.walker.bookmark();i.evaluator=function(e){return e.type==(t==CKEDITOR.SHRINK_ELEMENT?CKEDITOR.NODE_ELEMENT:CKEDITOR.NODE_TEXT)};var u;return i.guard=function(e,i){return d(e)?!0:t==CKEDITOR.SHRINK_ELEMENT&&e.type==CKEDITOR.NODE_TEXT||i&&e.equals(u)||n===!1&&e.type==CKEDITOR.NODE_ELEMENT&&e.isBlockBoundary()||e.type==CKEDITOR.NODE_ELEMENT&&e.hasAttribute("contenteditable")?!1:(!i&&e.type==CKEDITOR.NODE_ELEMENT&&(u=e),!0)},a&&(o=i[t==CKEDITOR.SHRINK_ELEMENT?"lastForward":"next"]())&&this.setStartAt(o,e?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_BEFORE_START),h&&(i.reset(),(i=i[t==CKEDITOR.SHRINK_ELEMENT?"lastBackward":"previous"]())&&this.setEndAt(i,e?CKEDITOR.POSITION_BEFORE_END:CKEDITOR.POSITION_AFTER_END)),!(!a&&!h)}},insertNode:function(t){this.optimizeBookmark(),this.trim(!1,!0);var e=this.startContainer,n=e.getChild(this.startOffset);n?t.insertBefore(n):e.append(t),t.getParent()&&t.getParent().equals(this.endContainer)&&this.endOffset++,this.setStartBefore(t)},moveToPosition:function(t,e){this.setStartAt(t,e),this.collapse(!0)},moveToRange:function(t){this.setStart(t.startContainer,t.startOffset),this.setEnd(t.endContainer,t.endOffset)},selectNodeContents:function(t){this.setStart(t,0),this.setEnd(t,t.type==CKEDITOR.NODE_TEXT?t.getLength():t.getChildCount())},setStart:function(t,e){t.type==CKEDITOR.NODE_ELEMENT&&CKEDITOR.dtd.$empty[t.getName()]&&(e=t.getIndex(),t=t.getParent()),this.startContainer=t,this.startOffset=e,this.endContainer||(this.endContainer=t,this.endOffset=e),i(this)},setEnd:function(t,e){t.type==CKEDITOR.NODE_ELEMENT&&CKEDITOR.dtd.$empty[t.getName()]&&(e=t.getIndex()+1,t=t.getParent()),this.endContainer=t,this.endOffset=e,this.startContainer||(this.startContainer=t,this.startOffset=e),i(this)},setStartAfter:function(t){this.setStart(t.getParent(),t.getIndex()+1)},setStartBefore:function(t){this.setStart(t.getParent(),t.getIndex())},setEndAfter:function(t){this.setEnd(t.getParent(),t.getIndex()+1)},setEndBefore:function(t){this.setEnd(t.getParent(),t.getIndex())},setStartAt:function(t,e){switch(e){case CKEDITOR.POSITION_AFTER_START:this.setStart(t,0);break;case CKEDITOR.POSITION_BEFORE_END:t.type==CKEDITOR.NODE_TEXT?this.setStart(t,t.getLength()):this.setStart(t,t.getChildCount());break;case CKEDITOR.POSITION_BEFORE_START:this.setStartBefore(t);break;case CKEDITOR.POSITION_AFTER_END:this.setStartAfter(t)}i(this)},setEndAt:function(t,e){switch(e){case CKEDITOR.POSITION_AFTER_START:this.setEnd(t,0);break;case CKEDITOR.POSITION_BEFORE_END:t.type==CKEDITOR.NODE_TEXT?this.setEnd(t,t.getLength()):this.setEnd(t,t.getChildCount());break;case CKEDITOR.POSITION_BEFORE_START:this.setEndBefore(t);break;case CKEDITOR.POSITION_AFTER_END:this.setEndAfter(t)}i(this)},fixBlock:function(t,e){var n=this.createBookmark(),i=this.document.createElement(e);return this.collapse(t),this.enlarge(CKEDITOR.ENLARGE_BLOCK_CONTENTS),this.extractContents().appendTo(i),i.trim(),i.appendBogus(),this.insertNode(i),this.moveToBookmark(n),i},splitBlock:function(t){var e=new CKEDITOR.dom.elementPath(this.startContainer,this.root),n=new CKEDITOR.dom.elementPath(this.endContainer,this.root),i=e.block,o=n.block,r=null;return e.blockLimit.equals(n.blockLimit)?("br"!=t&&(i||(i=this.fixBlock(!0,t),o=new CKEDITOR.dom.elementPath(this.endContainer,this.root).block),o||(o=this.fixBlock(!1,t))),t=i&&this.checkStartOfBlock(),e=o&&this.checkEndOfBlock(),this.deleteContents(),i&&i.equals(o)&&(e?(r=new CKEDITOR.dom.elementPath(this.startContainer,this.root),this.moveToPosition(o,CKEDITOR.POSITION_AFTER_END),o=null):t?(r=new CKEDITOR.dom.elementPath(this.startContainer,this.root),this.moveToPosition(i,CKEDITOR.POSITION_BEFORE_START),i=null):(o=this.splitElement(i),i.is("ul","ol")||i.appendBogus())),{previousBlock:i,nextBlock:o,wasStartOfBlock:t,wasEndOfBlock:e,elementPath:r}):null},splitElement:function(t){if(!this.collapsed)return null;this.setEndAt(t,CKEDITOR.POSITION_BEFORE_END);var e=this.extractContents(),n=t.clone(!1);return e.appendTo(n),n.insertAfter(t),this.moveToPosition(t,CKEDITOR.POSITION_AFTER_END),n},removeEmptyBlocksAtEnd:function(){function t(t){return function(i){return e(i)||n(i)||i.type==CKEDITOR.NODE_ELEMENT&&i.isEmptyInlineRemoveable()||t.is("table")&&i.is("caption")?!1:!0}}var e=CKEDITOR.dom.walker.whitespaces(),n=CKEDITOR.dom.walker.bookmark(!1);return function(e){for(var n,i=this.createBookmark(),o=this[e?"endPath":"startPath"](),r=o.block||o.blockLimit;r&&!r.equals(o.root)&&!r.getFirst(t(r));)n=r.getParent(),this[e?"setEndAt":"setStartAt"](r,CKEDITOR.POSITION_AFTER_END),r.remove(1),r=n;this.moveToBookmark(i)}}(),startPath:function(){return new CKEDITOR.dom.elementPath(this.startContainer,this.root)},endPath:function(){return new CKEDITOR.dom.elementPath(this.endContainer,this.root)},checkBoundaryOfElement:function(t,n){var i=n==CKEDITOR.START,o=this.clone();return o.collapse(i),o[i?"setStartAt":"setEndAt"](t,i?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_BEFORE_END),o=new CKEDITOR.dom.walker(o),o.evaluator=e(i),o[i?"checkBackward":"checkForward"]()},checkStartOfBlock:function(){var e=this.startContainer,n=this.startOffset;return CKEDITOR.env.ie&&n&&e.type==CKEDITOR.NODE_TEXT&&(e=CKEDITOR.tools.ltrim(e.substring(0,n)),l.test(e)&&this.trim(0,1)),this.trim(),e=new CKEDITOR.dom.elementPath(this.startContainer,this.root),n=this.clone(),n.collapse(!0),n.setStartAt(e.block||e.blockLimit,CKEDITOR.POSITION_AFTER_START),e=new CKEDITOR.dom.walker(n),e.evaluator=t(),e.checkBackward()},checkEndOfBlock:function(){var e=this.endContainer,n=this.endOffset;return CKEDITOR.env.ie&&e.type==CKEDITOR.NODE_TEXT&&(e=CKEDITOR.tools.rtrim(e.substring(n)),l.test(e)&&this.trim(1,0)),this.trim(),e=new CKEDITOR.dom.elementPath(this.endContainer,this.root),n=this.clone(),n.collapse(!1),n.setEndAt(e.block||e.blockLimit,CKEDITOR.POSITION_BEFORE_END),e=new CKEDITOR.dom.walker(n),e.evaluator=t(),e.checkForward()},getPreviousNode:function(t,e,n){var i=this.clone();return i.collapse(1),i.setStartAt(n||this.root,CKEDITOR.POSITION_AFTER_START),n=new CKEDITOR.dom.walker(i),n.evaluator=t,n.guard=e,n.previous()},getNextNode:function(t,e,n){var i=this.clone();return i.collapse(),i.setEndAt(n||this.root,CKEDITOR.POSITION_BEFORE_END),n=new CKEDITOR.dom.walker(i),n.evaluator=t,n.guard=e,n.next()},checkReadOnly:function(){function t(t,e){for(;t;){if(t.type==CKEDITOR.NODE_ELEMENT){if("false"==t.getAttribute("contentEditable")&&!t.data("cke-editable"))return 0;if(t.is("html")||"true"==t.getAttribute("contentEditable")&&(t.contains(e)||t.equals(e)))break}t=t.getParent()}return 1}return function(){var e=this.startContainer,n=this.endContainer;return!(t(e,n)&&t(n,e))}}(),moveToElementEditablePosition:function(t,e){if(t.type==CKEDITOR.NODE_ELEMENT&&!t.isEditable(!1))return this.moveToPosition(t,e?CKEDITOR.POSITION_AFTER_END:CKEDITOR.POSITION_BEFORE_START),!0;for(var n=0;t;){if(t.type==CKEDITOR.NODE_TEXT){e&&this.endContainer&&this.checkEndOfBlock()&&l.test(t.getText())?this.moveToPosition(t,CKEDITOR.POSITION_BEFORE_START):this.moveToPosition(t,e?CKEDITOR.POSITION_AFTER_END:CKEDITOR.POSITION_BEFORE_START),n=1;break}if(t.type==CKEDITOR.NODE_ELEMENT)if(t.isEditable())this.moveToPosition(t,e?CKEDITOR.POSITION_BEFORE_END:CKEDITOR.POSITION_AFTER_START),n=1;else if(e&&t.is("br")&&this.endContainer&&this.checkEndOfBlock())this.moveToPosition(t,CKEDITOR.POSITION_BEFORE_START);else if("false"==t.getAttribute("contenteditable")&&t.is(CKEDITOR.dtd.$block))return this.setStartBefore(t),this.setEndAfter(t),!0;var i=t,o=n,r=void 0;i.type==CKEDITOR.NODE_ELEMENT&&i.isEditable(!1)&&(r=i[e?"getLast":"getFirst"](h)),!o&&!r&&(r=i[e?"getPrevious":"getNext"](h)),t=r}return!!n},moveToClosestEditablePosition:function(t,e){var n,i=new CKEDITOR.dom.range(this.root),o=0,r=[CKEDITOR.POSITION_AFTER_END,CKEDITOR.POSITION_BEFORE_START];return i.moveToPosition(t,r[e?0:1]),t.is(CKEDITOR.dtd.$block)?(n=i[e?"getNextEditableNode":"getPreviousEditableNode"]())&&(o=1,n.type==CKEDITOR.NODE_ELEMENT&&n.is(CKEDITOR.dtd.$block)&&"false"==n.getAttribute("contenteditable")?(i.setStartAt(n,CKEDITOR.POSITION_BEFORE_START),i.setEndAt(n,CKEDITOR.POSITION_AFTER_END)):i.moveToPosition(n,r[e?1:0])):o=1,o&&this.moveToRange(i),!!o},moveToElementEditStart:function(t){return this.moveToElementEditablePosition(t)},moveToElementEditEnd:function(t){return this.moveToElementEditablePosition(t,!0)},getEnclosedNode:function(){var t=this.clone();if(t.optimize(),t.startContainer.type!=CKEDITOR.NODE_ELEMENT||t.endContainer.type!=CKEDITOR.NODE_ELEMENT)return null;var t=new CKEDITOR.dom.walker(t),e=CKEDITOR.dom.walker.bookmark(!1,!0),n=CKEDITOR.dom.walker.whitespaces(!0);t.evaluator=function(t){return n(t)&&e(t)};var i=t.next();return t.reset(),i&&i.equals(t.previous())?i:null},getTouchedStartNode:function(){var t=this.startContainer;return this.collapsed||t.type!=CKEDITOR.NODE_ELEMENT?t:t.getChild(this.startOffset)||t},getTouchedEndNode:function(){var t=this.endContainer;return this.collapsed||t.type!=CKEDITOR.NODE_ELEMENT?t:t.getChild(this.endOffset-1)||t},getNextEditableNode:n(),getPreviousEditableNode:n(1),scrollIntoView:function(){var t,e,n,i=new CKEDITOR.dom.element.createFromHtml("<span>&nbsp;</span>",this.document),o=this.clone();o.optimize(),(n=o.startContainer.type==CKEDITOR.NODE_TEXT)?(e=o.startContainer.getText(),t=o.startContainer.split(o.startOffset),i.insertAfter(o.startContainer)):o.insertNode(i),i.scrollIntoView(),n&&(o.startContainer.setText(e),t.remove()),i.remove()}}}(),CKEDITOR.POSITION_AFTER_START=1,CKEDITOR.POSITION_BEFORE_END=2,CKEDITOR.POSITION_BEFORE_START=3,CKEDITOR.POSITION_AFTER_END=4,CKEDITOR.ENLARGE_ELEMENT=1,CKEDITOR.ENLARGE_BLOCK_CONTENTS=2,CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS=3,CKEDITOR.ENLARGE_INLINE=4,CKEDITOR.START=1,CKEDITOR.END=2,CKEDITOR.SHRINK_ELEMENT=1,CKEDITOR.SHRINK_TEXT=2,function(){function t(t){arguments.length<1||(this.range=t,this.forceBrBreak=0,this.enlargeBr=1,this.enforceRealBlocks=0,this._||(this._={}))}function e(t,e,n){for(t=t.getNextSourceNode(e,null,n);!r(t);)t=t.getNextSourceNode(e,null,n);return t}function n(t){var e=[];return t.forEach(function(t){return"true"==t.getAttribute("contenteditable")?(e.push(t),!1):void 0},CKEDITOR.NODE_ELEMENT,!0),e}function i(t,e,o,r){t:{void 0==r&&(r=n(o));for(var s;s=r.shift();)if(s.getDtd().p){r={element:s,remaining:r};break t}r=null}return r?(s=CKEDITOR.filter.instances[r.element.data("cke-filter")])&&!s.check(e)?i(t,e,o,r.remaining):(e=new CKEDITOR.dom.range(r.element),e.selectNodeContents(r.element),e=e.createIterator(),e.enlargeBr=t.enlargeBr,e.enforceRealBlocks=t.enforceRealBlocks,e.activeFilter=e.filter=s,t._.nestedEditable={element:r.element,container:o,remaining:r.remaining,iterator:e},1):0}var o=/^[\r\n\t ]+$/,r=CKEDITOR.dom.walker.bookmark(!1,!0),s=CKEDITOR.dom.walker.whitespaces(!0),l=function(t){return r(t)&&s(t)};t.prototype={getNextParagraph:function(t){var n,s,a,h,d,t=t||"p";if(this._.nestedEditable){if(n=this._.nestedEditable.iterator.getNextParagraph(t))return this.activeFilter=this._.nestedEditable.iterator.activeFilter,n;if(this.activeFilter=this.filter,i(this,t,this._.nestedEditable.container,this._.nestedEditable.remaining))return this.activeFilter=this._.nestedEditable.iterator.activeFilter,this._.nestedEditable.iterator.getNextParagraph(t);this._.nestedEditable=null}if(!this.range.root.getDtd()[t])return null;if(!this._.started){var u=this.range.clone();if(u.shrink(CKEDITOR.SHRINK_ELEMENT,!0),s=u.endContainer.hasAscendant("pre",!0)||u.startContainer.hasAscendant("pre",!0),u.enlarge(this.forceBrBreak&&!s||!this.enlargeBr?CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS:CKEDITOR.ENLARGE_BLOCK_CONTENTS),!u.collapsed){s=new CKEDITOR.dom.walker(u.clone());var c=CKEDITOR.dom.walker.bookmark(!0,!0);s.evaluator=c,this._.nextNode=s.next(),s=new CKEDITOR.dom.walker(u.clone()),s.evaluator=c,s=s.previous(),this._.lastNode=s.getNextSourceNode(!0),this._.lastNode&&this._.lastNode.type==CKEDITOR.NODE_TEXT&&!CKEDITOR.tools.trim(this._.lastNode.getText())&&this._.lastNode.getParent().isBlockBoundary()&&(c=this.range.clone(),c.moveToPosition(this._.lastNode,CKEDITOR.POSITION_AFTER_END),c.checkEndOfBlock()&&(c=new CKEDITOR.dom.elementPath(c.endContainer,c.root),this._.lastNode=(c.block||c.blockLimit).getNextSourceNode(!0))),this._.lastNode&&u.root.contains(this._.lastNode)||(this._.lastNode=this._.docEndMarker=u.document.createText(""),this._.lastNode.insertAfter(s)),u=null}this._.started=1,s=u}for(c=this._.nextNode,u=this._.lastNode,this._.nextNode=null;c;){var p=0,m=c.hasAscendant("pre"),g=c.type!=CKEDITOR.NODE_ELEMENT,f=0;if(g)c.type==CKEDITOR.NODE_TEXT&&o.test(c.getText())&&(g=0);else{var x=c.getName();if(CKEDITOR.dtd.$block[x]&&"false"==c.getAttribute("contenteditable")){n=c,i(this,t,n);break}if(c.isBlockBoundary(this.forceBrBreak&&!m&&{br:1})){if("br"==x)g=1;else if(!s&&!c.getChildCount()&&"hr"!=x){n=c,a=c.equals(u);break}s&&(s.setEndAt(c,CKEDITOR.POSITION_BEFORE_START),"br"!=x&&(this._.nextNode=c)),p=1}else{if(c.getFirst()){s||(s=this.range.clone(),s.setStartAt(c,CKEDITOR.POSITION_BEFORE_START)),c=c.getFirst();continue}g=1}}if(g&&!s&&(s=this.range.clone(),s.setStartAt(c,CKEDITOR.POSITION_BEFORE_START)),a=(!p||g)&&c.equals(u),s&&!p)for(;!c.getNext(l)&&!a;){if(x=c.getParent(),x.isBlockBoundary(this.forceBrBreak&&!m&&{br:1})){p=1,g=0,a||x.equals(u),s.setEndAt(x,CKEDITOR.POSITION_BEFORE_END);break}c=x,g=1,a=c.equals(u),f=1}if(g&&s.setEndAt(c,CKEDITOR.POSITION_AFTER_END),c=e(c,f,u),(a=!c)||p&&s)break}if(!n){if(!s)return this._.docEndMarker&&this._.docEndMarker.remove(),this._.nextNode=null;n=new CKEDITOR.dom.elementPath(s.startContainer,s.root),c=n.blockLimit,p={div:1,th:1,td:1},n=n.block,!n&&c&&!this.enforceRealBlocks&&p[c.getName()]&&s.checkStartOfBlock()&&s.checkEndOfBlock()&&!c.equals(s.root)?n=c:!n||this.enforceRealBlocks&&"li"==n.getName()?(n=this.range.document.createElement(t),s.extractContents().appendTo(n),n.trim(),s.insertNode(n),h=d=!0):"li"!=n.getName()?s.checkStartOfBlock()&&s.checkEndOfBlock()||(n=n.clone(!1),s.extractContents().appendTo(n),n.trim(),d=s.splitBlock(),h=!d.wasStartOfBlock,d=!d.wasEndOfBlock,s.insertNode(n)):a||(this._.nextNode=n.equals(u)?null:e(s.getBoundaryNodes().endNode,1,u))}return h&&(h=n.getPrevious())&&h.type==CKEDITOR.NODE_ELEMENT&&("br"==h.getName()?h.remove():h.getLast()&&"br"==h.getLast().$.nodeName.toLowerCase()&&h.getLast().remove()),d&&(h=n.getLast())&&h.type==CKEDITOR.NODE_ELEMENT&&"br"==h.getName()&&(!CKEDITOR.env.needsBrFiller||h.getPrevious(r)||h.getNext(r))&&h.remove(),this._.nextNode||(this._.nextNode=a||n.equals(u)||!u?null:e(n,1,u)),n}},CKEDITOR.dom.range.prototype.createIterator=function(){return new t(this)}}(),CKEDITOR.command=function(t,e){this.uiItems=[],this.exec=function(n){return this.state!=CKEDITOR.TRISTATE_DISABLED&&this.checkAllowed()?(this.editorFocus&&t.focus(),this.fire("exec")===!1?!0:e.exec.call(this,t,n)!==!1):!1},this.refresh=function(t,n){return!this.readOnly&&t.readOnly?!0:this.context&&!n.isContextFor(this.context)?(this.disable(),!0):this.checkAllowed(!0)?(this.startDisabled||this.enable(),this.modes&&!this.modes[t.mode]&&this.disable(),this.fire("refresh",{editor:t,path:n})===!1?!0:e.refresh&&e.refresh.apply(this,arguments)!==!1):(this.disable(),!0)};var n;this.checkAllowed=function(e){return e||"boolean"!=typeof n?n=t.activeFilter.checkFeature(this):n},CKEDITOR.tools.extend(this,e,{modes:{wysiwyg:1},editorFocus:1,contextSensitive:!!e.context,state:CKEDITOR.TRISTATE_DISABLED}),CKEDITOR.event.call(this)},CKEDITOR.command.prototype={enable:function(){this.state==CKEDITOR.TRISTATE_DISABLED&&this.checkAllowed()&&this.setState(this.preserveState&&"undefined"!=typeof this.previousState?this.previousState:CKEDITOR.TRISTATE_OFF)},disable:function(){this.setState(CKEDITOR.TRISTATE_DISABLED)},setState:function(t){return this.state==t||t!=CKEDITOR.TRISTATE_DISABLED&&!this.checkAllowed()?!1:(this.previousState=this.state,this.state=t,this.fire("state"),!0)},toggleState:function(){this.state==CKEDITOR.TRISTATE_OFF?this.setState(CKEDITOR.TRISTATE_ON):this.state==CKEDITOR.TRISTATE_ON&&this.setState(CKEDITOR.TRISTATE_OFF)}},CKEDITOR.event.implementOn(CKEDITOR.command.prototype),CKEDITOR.ENTER_P=1,CKEDITOR.ENTER_BR=2,CKEDITOR.ENTER_DIV=3,CKEDITOR.config={customConfig:"config.js",autoUpdateElement:!0,language:"",defaultLanguage:"en",contentsLangDirection:"",enterMode:CKEDITOR.ENTER_P,forceEnterMode:!1,shiftEnterMode:CKEDITOR.ENTER_BR,docType:"<!DOCTYPE html>",bodyId:"",bodyClass:"",fullPage:!1,height:200,extraPlugins:"",removePlugins:"",protectedSource:[],tabIndex:0,width:"",baseFloatZIndex:1e4,blockedKeystrokes:[CKEDITOR.CTRL+66,CKEDITOR.CTRL+73,CKEDITOR.CTRL+85,CKEDITOR.CTRL+89,CKEDITOR.CTRL+90,CKEDITOR.CTRL+CKEDITOR.SHIFT+90]},function(){function t(t,n,i,r,s){var l=n.name;if((r||"function"!=typeof t.elements||t.elements(l))&&(!t.match||t.match(n))){if(r=!s){t:if(t.nothingRequired)r=!0;else{if(s=t.requiredClasses)for(l=n.classes,r=0;r<s.length;++r)if(-1==CKEDITOR.tools.indexOf(l,s[r])){r=!1;break t}r=o(n.styles,t.requiredStyles)&&o(n.attributes,t.requiredAttributes)}r=!r}if(!r&&(t.propertiesOnly||(i.valid=!0),i.allAttributes||(i.allAttributes=e(t.attributes,n.attributes,i.validAttributes)),i.allStyles||(i.allStyles=e(t.styles,n.styles,i.validStyles)),!i.allClasses)){if(t=t.classes,n=n.classes,r=i.validClasses,t)if(t===!0)n=!0;else{for(var a,s=0,l=n.length;l>s;++s)a=n[s],r[a]||(r[a]=t(a));n=!1}else n=!1;i.allClasses=n}}}function e(t,e,n){if(!t)return!1;if(t===!0)return!0;for(var i in e)n[i]||(n[i]=t(i,e[i]));return!1}function n(t,e){if(!t)return!1;if(t===!0)return t;if("string"==typeof t)return t=T(t),"*"==t?!0:CKEDITOR.tools.convertArrayToObject(t.split(e));if(CKEDITOR.tools.isArray(t))return t.length?CKEDITOR.tools.convertArrayToObject(t):!1;var n,i={},o=0;for(n in t)i[n]=t[n],o++;return o?i:!1}function i(e){if(e._.filterFunction)return e._.filterFunction;var n=/^cke:(object|embed|param)$/,i=/^(object|embed|param)$/;return e._.filterFunction=function(o,r,s,l,u,c,p){var m,f=o.name,x=!1;if(u&&(o.name=f=f.replace(n,"$1")),s=s&&s[f]){for(a(o),f=0;f<s.length;++f)g(e,o,s[f]);h(o)}if(r){var f=o.name,s=r.elements[f],C=r.generic,r={valid:!1,validAttributes:{},validClasses:{},validStyles:{},allAttributes:!1,allClasses:!1,allStyles:!1};if(!s&&!C)return l.push(o),!0;if(a(o),s)for(f=0,m=s.length;m>f;++f)t(s[f],o,r,!0,c);if(C)for(f=0,m=C.length;m>f;++f)t(C[f],o,r,!1,c);if(!r.valid)return l.push(o),!0;c=r.validAttributes,f=r.validStyles,s=r.validClasses,m=o.attributes;var E,y,C=o.styles,v=m["class"],T=m.style,b=[],I=[],S=/^data-cke-/,O=!1;if(delete m.style,delete m["class"],!r.allAttributes)for(E in m)c[E]||(S.test(E)?E==(y=E.replace(/^data-cke-saved-/,""))||c[y]||(delete m[E],O=!0):(delete m[E],O=!0));if(r.allStyles)T&&(m.style=T);else{for(E in C)f[E]?b.push(E+":"+C[E]):O=!0;b.length&&(m.style=b.sort().join("; "))}if(r.allClasses)v&&(m["class"]=v);else{for(E in s)s[E]&&I.push(E);I.length&&(m["class"]=I.sort().join(" ")),v&&I.length<v.split(/\s+/).length&&(O=!0)}if(O&&(x=!0),!p&&!d(o))return l.push(o),!0}return u&&(o.name=o.name.replace(i,"cke:$1")),x}}function o(t,e){if(!e)return!0;for(var n=0;n<e.length;++n)if(!(e[n]in t))return!1;return!0}function r(t){if(!t)return{};for(var t=t.split(/\s*,\s*/).sort(),e={};t.length;)e[t.shift()]=b;return e}function s(t){for(var e,n,i,o,r={},s=1,t=T(t);e=t.match(R);)(n=e[2])?(i=l(n,"styles"),o=l(n,"attrs"),n=l(n,"classes")):i=o=n=null,r["$"+s++]={elements:e[1],classes:n,styles:i,attributes:o},t=t.slice(e[0].length);return r}function l(t,e){var n=t.match(w[e]);return n?T(n[1]):null}function a(t){t.styles||(t.styles=CKEDITOR.tools.parseCssText(t.attributes.style||"",1)),t.classes||(t.classes=t.attributes["class"]?t.attributes["class"].split(/\s+/):[])}function h(t){var e,n=t.attributes;delete n.style,delete n["class"],(e=CKEDITOR.tools.writeCssText(t.styles,!0))&&(n.style=e),t.classes.length&&(n["class"]=t.classes.sort().join(" "))}function d(t){switch(t.name){case"a":if(!t.children.length&&!t.attributes.name)return!1;break;case"img":if(!t.attributes.src)return!1}return!0}function u(t){return t?t===!0?!0:function(e){return e in t}:!1}function c(){return new CKEDITOR.htmlParser.element("br")}function p(t){return t.type==CKEDITOR.NODE_ELEMENT&&("br"==t.name||y.$block[t.name])}function m(t,e,n){var i=t.name;if(y.$empty[i]||!t.children.length)"hr"==i&&"br"==e?t.replaceWith(c()):(t.parent&&n.push({check:"it",el:t.parent}),t.remove());else if(y.$block[i]||"tr"==i)if("br"==e)t.previous&&!p(t.previous)&&(e=c(),e.insertBefore(t)),t.next&&!p(t.next)&&(e=c(),e.insertAfter(t)),t.replaceWithChildren();else{var o,i=t.children;t:{o=y[e];for(var r,s=0,l=i.length;l>s;++s)if(r=i[s],r.type==CKEDITOR.NODE_ELEMENT&&!o[r.name]){o=!1;break t}o=!0}if(o)t.name=e,t.attributes={},n.push({check:"parent-down",el:t});else{o=t.parent;for(var a,s=o.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT||"body"==o.name,l=i.length;l>0;)r=i[--l],s&&(r.type==CKEDITOR.NODE_TEXT||r.type==CKEDITOR.NODE_ELEMENT&&y.$inline[r.name])?(a||(a=new CKEDITOR.htmlParser.element(e),a.insertAfter(t),n.push({check:"parent-down",el:a})),a.add(r,0)):(a=null,r.insertAfter(t),o.type!=CKEDITOR.NODE_DOCUMENT_FRAGMENT&&r.type==CKEDITOR.NODE_ELEMENT&&!y[o.name][r.name]&&n.push({check:"el-up",el:r}));t.remove()}}else"style"==i?t.remove():(t.parent&&n.push({check:"it",el:t.parent}),t.replaceWithChildren())}function g(t,e,n){var i,o;for(i=0;i<n.length;++i)if(o=n[i],!(o.check&&!t.check(o.check,!1)||o.left&&!o.left(e))){o.right(e,D);break}}function f(t,e){var n,i,o,r,s=e.getDefinition(),l=s.attributes,a=s.styles;if(t.name!=s.element)return!1;for(n in l)if("class"==n){for(s=l[n].split(/\s+/),o=t.classes.join("|");r=s.pop();)if(-1==o.indexOf(r))return!1}else if(t.attributes[n]!=l[n])return!1;for(i in a)if(t.styles[i]!=a[i])return!1;return!0}function x(t,e){var n,i;return"string"==typeof t?n=t:t instanceof CKEDITOR.style?i=t:(n=t[0],i=t[1]),[{element:n,left:i,right:function(t,n){n.transform(t,e)}}]}function C(t){return function(e){return f(e,t)}}function E(t){return function(e,n){n[t](e)}}var y=CKEDITOR.dtd,v=CKEDITOR.tools.copy,T=CKEDITOR.tools.trim,b="cke-test",I=["","p","br","div"];CKEDITOR.filter=function(t){if(this.allowedContent=[],this.disabled=!1,this.editor=null,this.id=CKEDITOR.tools.getNextNumber(),this._={rules:{},transformations:{},cachedTests:{}},CKEDITOR.filter.instances[this.id]=this,t instanceof CKEDITOR.editor){t=this.editor=t,this.customConfig=!0;var e=t.config.allowedContent;e===!0?this.disabled=!0:(e||(this.customConfig=!1),this.allow(e,"config",1),this.allow(t.config.extraAllowedContent,"extra",1),this.allow(I[t.enterMode]+" "+I[t.shiftEnterMode],"default",1))}else this.customConfig=!1,this.allow(t,"default",1)},CKEDITOR.filter.instances={},CKEDITOR.filter.prototype={allow:function(t,e,i){if(this.disabled||this.customConfig&&!i||!t)return!1;this._.cachedChecks={};var o,r;if("string"==typeof t)t=s(t);else if(t instanceof CKEDITOR.style)r=t.getDefinition(),i={},t=r.attributes,i[r.element]=r={styles:r.styles,requiredStyles:r.styles&&CKEDITOR.tools.objectKeys(r.styles)},t&&(t=v(t),r.classes=t["class"]?t["class"].split(/\s+/):null,r.requiredClasses=r.classes,delete t["class"],r.attributes=t,r.requiredAttributes=t&&CKEDITOR.tools.objectKeys(t)),t=i;else if(CKEDITOR.tools.isArray(t)){for(o=0;o<t.length;++o)r=this.allow(t[o],e,i);return r}var l,i=[];for(l in t){r=t[l],r="boolean"==typeof r?{}:"function"==typeof r?{match:r}:v(r),"$"!=l.charAt(0)&&(r.elements=l),e&&(r.featureName=e.toLowerCase());var a=r;a.elements=n(a.elements,/\s+/)||null,a.propertiesOnly=a.propertiesOnly||a.elements===!0;var h=/\s*,\s*/,d=void 0;for(d in S){a[d]=n(a[d],h)||null;var c=a,p=O[d],m=n(a[O[d]],h),g=a[d],f=[],x=!0,C=void 0;m?x=!1:m={};for(C in g)"!"==C.charAt(0)&&(C=C.slice(1),f.push(C),m[C]=!0,x=!1);for(;C=f.pop();)g[C]=g["!"+C],delete g["!"+C];c[p]=(x?!1:m)||null}a.match=a.match||null,this.allowedContent.push(r),i.push(r)}for(e=this._.rules,l=e.elements||{},t=e.generic||[],r=0,a=i.length;a>r;++r){h=v(i[r]),d=h.classes===!0||h.styles===!0||h.attributes===!0,c=h,p=void 0;for(p in S)c[p]=u(c[p]);m=!0;for(p in O)p=O[p],c[p]=CKEDITOR.tools.objectKeys(c[p]),c[p]&&(m=!1);if(c.nothingRequired=m,h.elements===!0||null===h.elements)h.elements=u(h.elements),t[d?"unshift":"push"](h);else{c=h.elements,delete h.elements;for(o in c)l[o]?l[o][d?"unshift":"push"](h):l[o]=[h]}}return e.elements=l,e.generic=t.length?t:null,!0},applyTo:function(t,e,n,o){if(this.disabled)return!1;var r=[],s=!n&&this._.rules,l=this._.transformations,a=i(this),h=this.editor&&this.editor.config.protectedSource,u=!1;t.forEach(function(t){if(t.type==CKEDITOR.NODE_ELEMENT){if("off"==t.attributes["data-cke-filter"])return!1;e&&"span"==t.name&&~CKEDITOR.tools.objectKeys(t.attributes).join("|").indexOf("data-cke-")||a(t,s,l,r,e)&&(u=!0)}else if(t.type==CKEDITOR.NODE_COMMENT&&t.value.match(/^\{cke_protected\}(?!\{C\})/)){var n;t:{var i=decodeURIComponent(t.value.replace(/^\{cke_protected\}/,""));n=[];var o,d,c;if(h)for(d=0;d<h.length;++d)if((c=i.match(h[d]))&&c[0].length==i.length){n=!0;break t}i=CKEDITOR.htmlParser.fragment.fromHtml(i),1==i.children.length&&(o=i.children[0]).type==CKEDITOR.NODE_ELEMENT&&a(o,s,l,n,e),n=!n.length}n||r.push(t)}},null,!0),r.length&&(u=!0);for(var c,t=[],o=I[o||(this.editor?this.editor.enterMode:CKEDITOR.ENTER_P)];n=r.pop();)n.type==CKEDITOR.NODE_ELEMENT?m(n,o,t):n.remove();for(;c=t.pop();)if(n=c.el,n.parent)switch(c.check){case"it":y.$removeEmpty[n.name]&&!n.children.length?m(n,o,t):d(n)||m(n,o,t);break;case"el-up":n.parent.type!=CKEDITOR.NODE_DOCUMENT_FRAGMENT&&!y[n.parent.name][n.name]&&m(n,o,t);break;case"parent-down":n.parent.type!=CKEDITOR.NODE_DOCUMENT_FRAGMENT&&!y[n.parent.name][n.name]&&m(n.parent,o,t)}return u},checkFeature:function(t){return this.disabled||!t?!0:(t.toFeature&&(t=t.toFeature(this.editor)),!t.requiredContent||this.check(t.requiredContent))},disable:function(){this.disabled=!0},addContentForms:function(t){if(!this.disabled&&t){var e,n,i,o=[];for(e=0;e<t.length&&!i;++e)n=t[e],("string"==typeof n||n instanceof CKEDITOR.style)&&this.check(n)&&(i=n);if(i){for(e=0;e<t.length;++e)o.push(x(t[e],i));this.addTransformations(o)}}},addFeature:function(t){return this.disabled||!t?!0:(t.toFeature&&(t=t.toFeature(this.editor)),this.allow(t.allowedContent,t.name),this.addTransformations(t.contentTransformations),this.addContentForms(t.contentForms),this.customConfig&&t.requiredContent?this.check(t.requiredContent):!0)},addTransformations:function(t){var e,n;if(!this.disabled&&t){var i,o=this._.transformations;for(i=0;i<t.length;++i){e=t[i];var r=void 0,s=void 0,l=void 0,a=void 0,h=void 0,d=void 0;for(n=[],s=0;s<e.length;++s)l=e[s],"string"==typeof l?(l=l.split(/\s*:\s*/),a=l[0],h=null,d=l[1]):(a=l.check,h=l.left,d=l.right),r||(r=l,r=r.element?r.element:a?a.match(/^([a-z0-9]+)/i)[0]:r.left.getDefinition().element),h instanceof CKEDITOR.style&&(h=C(h)),n.push({check:a==r?null:a,left:h,right:"string"==typeof d?E(d):d});e=r,o[e]||(o[e]=[]),o[e].push(n)}}},check:function(t,e,n){if(this.disabled)return!0;if(CKEDITOR.tools.isArray(t)){for(var o=t.length;o--;)if(this.check(t[o],e,n))return!0;return!1}var l,a;if("string"==typeof t){if(a=t+"<"+(e===!1?"0":"1")+(n?"1":"0")+">",a in this._.cachedChecks)return this._.cachedChecks[a];o=s(t).$1,l=o.styles;var d=o.classes;o.name=o.elements,o.classes=d=d?d.split(/\s*,\s*/):[],o.styles=r(l),o.attributes=r(o.attributes),o.children=[],d.length&&(o.attributes["class"]=d.join(" ")),l&&(o.attributes.style=CKEDITOR.tools.writeCssText(o.styles)),l=o}else o=t.getDefinition(),l=o.styles,d=o.attributes||{},l?(l=v(l),d.style=CKEDITOR.tools.writeCssText(l,!0)):l={},l={name:o.element,attributes:d,classes:d["class"]?d["class"].split(/\s+/):[],styles:l,children:[]};var u,d=CKEDITOR.tools.clone(l),c=[];if(e!==!1&&(u=this._.transformations[l.name])){for(o=0;o<u.length;++o)g(this,l,u[o]);h(l)}return i(this)(d,this._.rules,e===!1?!1:this._.transformations,c,!1,!n,!n),e=c.length>0?!1:CKEDITOR.tools.objectCompare(l.attributes,d.attributes,!0)?!0:!1,"string"==typeof t&&(this._.cachedChecks[a]=e),e},getAllowedEnterMode:function(){var t=["p","div","br"],e={p:CKEDITOR.ENTER_P,div:CKEDITOR.ENTER_DIV,br:CKEDITOR.ENTER_BR};return function(n,i){var o,r=t.slice();if(this.check(I[n]))return n;for(i||(r=r.reverse());o=r.pop();)if(this.check(o))return e[o];return CKEDITOR.ENTER_BR}}()};var S={styles:1,attributes:1,classes:1},O={styles:"requiredStyles",attributes:"requiredAttributes",classes:"requiredClasses"},R=/^([a-z0-9*\s]+)((?:\s*\{[!\w\-,\s\*]+\}\s*|\s*\[[!\w\-,\s\*]+\]\s*|\s*\([!\w\-,\s\*]+\)\s*){0,3})(?:;\s*|$)/i,w={styles:/{([^}]+)}/,attrs:/\[([^\]]+)\]/,classes:/\(([^\)]+)\)/},D=CKEDITOR.filter.transformationsTools={sizeToStyle:function(t){this.lengthToStyle(t,"width"),this.lengthToStyle(t,"height")},sizeToAttribute:function(t){this.lengthToAttribute(t,"width"),this.lengthToAttribute(t,"height")},lengthToStyle:function(t,e,n){if(n=n||e,!(n in t.styles)){var i=t.attributes[e];i&&(/^\d+$/.test(i)&&(i+="px"),t.styles[n]=i)}delete t.attributes[e]},lengthToAttribute:function(t,e,n){if(n=n||e,!(n in t.attributes)){var i=t.styles[e],o=i&&i.match(/^(\d+)(?:\.\d*)?px$/);o?t.attributes[n]=o[1]:i==b&&(t.attributes[n]=b)}delete t.styles[e]},alignmentToStyle:function(t){if(!("float"in t.styles)){var e=t.attributes.align;("left"==e||"right"==e)&&(t.styles["float"]=e)}delete t.attributes.align},alignmentToAttribute:function(t){if(!("align"in t.attributes)){var e=t.styles["float"];("left"==e||"right"==e)&&(t.attributes.align=e)}delete t.styles["float"]},matchesStyle:f,transform:function(t,e){if("string"==typeof e)t.name=e;else{var n,i,o,r,s=e.getDefinition(),l=s.styles,a=s.attributes;t.name=s.element;for(n in a)if("class"==n)for(s=t.classes.join("|"),o=a[n].split(/\s+/);r=o.pop();)-1==s.indexOf(r)&&t.classes.push(r);else t.attributes[n]=a[n];for(i in l)t.styles[i]=l[i]}}}}(),function(){CKEDITOR.focusManager=function(t){return t.focusManager?t.focusManager:(this.hasFocus=!1,this.currentActive=null,this._={editor:t},this)},CKEDITOR.focusManager._={blurDelay:200},CKEDITOR.focusManager.prototype={focus:function(t){this._.timer&&clearTimeout(this._.timer),t&&(this.currentActive=t),this.hasFocus||this._.locked||((t=CKEDITOR.currentInstance)&&t.focusManager.blur(1),this.hasFocus=!0,(t=this._.editor.container)&&t.addClass("cke_focus"),this._.editor.fire("focus"))},lock:function(){this._.locked=1},unlock:function(){delete this._.locked},blur:function(t){function e(){if(this.hasFocus){this.hasFocus=!1;var t=this._.editor.container;t&&t.removeClass("cke_focus"),this._.editor.fire("blur")}}if(!this._.locked){this._.timer&&clearTimeout(this._.timer);var n=CKEDITOR.focusManager._.blurDelay;t||!n?e.call(this):this._.timer=CKEDITOR.tools.setTimeout(function(){delete this._.timer,e.call(this)},n,this)}},add:function(t,e){var n=t.getCustomData("focusmanager");if(!n||n!=this){n&&n.remove(t);var n="focus",i="blur";e&&(CKEDITOR.env.ie?(n="focusin",i="focusout"):CKEDITOR.event.useCapture=1);var o={blur:function(){t.equals(this.currentActive)&&this.blur()},focus:function(){this.focus(t)}};t.on(n,o.focus,this),t.on(i,o.blur,this),e&&(CKEDITOR.event.useCapture=0),t.setCustomData("focusmanager",this),t.setCustomData("focusmanager_handlers",o)}},remove:function(t){t.removeCustomData("focusmanager");var e=t.removeCustomData("focusmanager_handlers");t.removeListener("blur",e.blur),t.removeListener("focus",e.focus)}}}(),CKEDITOR.keystrokeHandler=function(t){return t.keystrokeHandler?t.keystrokeHandler:(this.keystrokes={},this.blockedKeystrokes={},this._={editor:t},this)},function(){var t,e=function(e){var e=e.data,n=e.getKeystroke(),i=this.keystrokes[n],o=this._.editor;return t=o.fire("key",{keyCode:n})===!1,t||(i&&(t=o.execCommand(i,{from:"keystrokeHandler"})!==!1),t||(t=!!this.blockedKeystrokes[n])),t&&e.preventDefault(!0),!t},n=function(e){t&&(t=!1,e.data.preventDefault(!0))
};CKEDITOR.keystrokeHandler.prototype={attach:function(t){t.on("keydown",e,this),(CKEDITOR.env.opera||CKEDITOR.env.gecko&&CKEDITOR.env.mac)&&t.on("keypress",n,this)}}}(),function(){CKEDITOR.lang={languages:{af:1,ar:1,bg:1,bn:1,bs:1,ca:1,cs:1,cy:1,da:1,de:1,el:1,"en-au":1,"en-ca":1,"en-gb":1,en:1,eo:1,es:1,et:1,eu:1,fa:1,fi:1,fo:1,"fr-ca":1,fr:1,gl:1,gu:1,he:1,hi:1,hr:1,hu:1,id:1,is:1,it:1,ja:1,ka:1,km:1,ko:1,ku:1,lt:1,lv:1,mk:1,mn:1,ms:1,nb:1,nl:1,no:1,pl:1,"pt-br":1,pt:1,ro:1,ru:1,si:1,sk:1,sl:1,sq:1,"sr-latn":1,sr:1,sv:1,th:1,tr:1,ug:1,uk:1,vi:1,"zh-cn":1,zh:1},rtl:{ar:1,fa:1,he:1,ku:1,ug:1},load:function(t,e,n){t&&CKEDITOR.lang.languages[t]||(t=this.detect(e,t)),this[t]?n(t,this[t]):CKEDITOR.scriptLoader.load(CKEDITOR.getUrl("lang/"+t+".js"),function(){this[t].dir=this.rtl[t]?"rtl":"ltr",n(t,this[t])},this)},detect:function(t,e){var n=this.languages,e=e||navigator.userLanguage||navigator.language||t,i=e.toLowerCase().match(/([a-z]+)(?:-([a-z]+))?/),o=i[1],i=i[2];return n[o+"-"+i]?o=o+"-"+i:n[o]||(o=null),CKEDITOR.lang.detect=o?function(){return o}:function(t){return t},o||t}}}(),CKEDITOR.scriptLoader=function(){var t={},e={};return{load:function(n,i,o,r){var s="string"==typeof n;s&&(n=[n]),o||(o=CKEDITOR);var l=n.length,a=[],h=[],d=function(t){i&&(s?i.call(o,t):i.call(o,a,h))};if(0===l)d(!0);else{var u=function(t,e){(e?a:h).push(t),--l<=0&&(r&&CKEDITOR.document.getDocumentElement().removeStyle("cursor"),d(e))},c=function(n,i){t[n]=1;var o=e[n];delete e[n];for(var r=0;r<o.length;r++)o[r](n,i)},p=function(n){if(t[n])u(n,!0);else{var o=e[n]||(e[n]=[]);if(o.push(u),!(o.length>1)){var r=new CKEDITOR.dom.element("script");r.setAttributes({type:"text/javascript",src:n}),i&&(CKEDITOR.env.ie&&CKEDITOR.env.version<11?r.$.onreadystatechange=function(){("loaded"==r.$.readyState||"complete"==r.$.readyState)&&(r.$.onreadystatechange=null,c(n,!0))}:(r.$.onload=function(){setTimeout(function(){c(n,!0)},0)},r.$.onerror=function(){c(n,!1)})),r.appendTo(CKEDITOR.document.getHead())}}};r&&CKEDITOR.document.getDocumentElement().setStyle("cursor","wait");for(var m=0;l>m;m++)p(n[m])}},queue:function(){function t(){var t;(t=e[0])&&this.load(t.scriptUrl,t.callback,CKEDITOR,0)}var e=[];return function(n,i){var o=this;e.push({scriptUrl:n,callback:function(){i&&i.apply(this,arguments),e.shift(),t.call(o)}}),1==e.length&&t.call(this)}}()}}(),CKEDITOR.resourceManager=function(t,e){this.basePath=t,this.fileName=e,this.registered={},this.loaded={},this.externals={},this._={waitingList:{}}},CKEDITOR.resourceManager.prototype={add:function(t,e){if(this.registered[t])throw'[CKEDITOR.resourceManager.add] The resource name "'+t+'" is already registered.';var n=this.registered[t]=e||{};return n.name=t,n.path=this.getPath(t),CKEDITOR.fire(t+CKEDITOR.tools.capitalize(this.fileName)+"Ready",n),this.get(t)},get:function(t){return this.registered[t]||null},getPath:function(t){var e=this.externals[t];return CKEDITOR.getUrl(e&&e.dir||this.basePath+t+"/")},getFilePath:function(t){var e=this.externals[t];return CKEDITOR.getUrl(this.getPath(t)+(e?e.file:this.fileName+".js"))},addExternal:function(t,e,n){for(var t=t.split(","),i=0;i<t.length;i++){var o=t[i];n||(e=e.replace(/[^\/]+$/,function(t){return n=t,""})),this.externals[o]={dir:e,file:n||this.fileName+".js"}}},load:function(t,e,n){CKEDITOR.tools.isArray(t)||(t=t?[t]:[]);for(var i=this.loaded,o=this.registered,r=[],s={},l={},a=0;a<t.length;a++){var h=t[a];if(h)if(i[h]||o[h])l[h]=this.get(h);else{var d=this.getFilePath(h);r.push(d),d in s||(s[d]=[]),s[d].push(h)}}CKEDITOR.scriptLoader.load(r,function(t,o){if(o.length)throw'[CKEDITOR.resourceManager.load] Resource name "'+s[o[0]].join(",")+'" was not found at "'+o[0]+'".';for(var r=0;r<t.length;r++)for(var a=s[t[r]],h=0;h<a.length;h++){var d=a[h];l[d]=this.get(d),i[d]=1}e.call(n,l)},this)}},CKEDITOR.plugins=new CKEDITOR.resourceManager("plugins/","plugin"),CKEDITOR.plugins.load=CKEDITOR.tools.override(CKEDITOR.plugins.load,function(t){var e={};return function(n,i,o){var r={},s=function(n){t.call(this,n,function(t){CKEDITOR.tools.extend(r,t);var n,l=[];for(n in t){var a=t[n],h=a&&a.requires;if(!e[n]){if(a.icons)for(var d=a.icons.split(","),u=d.length;u--;)CKEDITOR.skin.addIcon(d[u],a.path+"icons/"+(CKEDITOR.env.hidpi&&a.hidpi?"hidpi/":"")+d[u]+".png");e[n]=1}if(h)for(h.split&&(h=h.split(",")),a=0;a<h.length;a++)r[h[a]]||l.push(h[a])}if(l.length)s.call(this,l);else{for(n in r)a=r[n],a.onLoad&&!a.onLoad._called&&(a.onLoad()===!1&&delete r[n],a.onLoad._called=1);i&&i.call(o||window,r)}},this)};s.call(this,n)}}),CKEDITOR.plugins.setLang=function(t,e,n){var i=this.get(t),t=i.langEntries||(i.langEntries={}),i=i.lang||(i.lang=[]);i.split&&(i=i.split(",")),-1==CKEDITOR.tools.indexOf(i,e)&&i.push(e),t[e]=n},CKEDITOR.ui=function(t){return t.ui?t.ui:(this.items={},this.instances={},this.editor=t,this._={handlers:{}},this)},CKEDITOR.ui.prototype={add:function(t,e,n){n.name=t.toLowerCase();var i=this.items[t]={type:e,command:n.command||null,args:Array.prototype.slice.call(arguments,2)};CKEDITOR.tools.extend(i,n)},get:function(t){return this.instances[t]},create:function(t){var e=this.items[t],n=e&&this._.handlers[e.type],i=e&&e.command&&this.editor.getCommand(e.command),n=n&&n.create.apply(this,e.args);return this.instances[t]=n,i&&i.uiItems.push(n),n&&!n.type&&(n.type=e.type),n},addHandler:function(t,e){this._.handlers[t]=e},space:function(t){return CKEDITOR.document.getById(this.spaceId(t))},spaceId:function(t){return this.editor.id+"_"+t}},CKEDITOR.event.implementOn(CKEDITOR.ui),function(){function t(t,i,r){if(CKEDITOR.event.call(this),t=t&&CKEDITOR.tools.clone(t),void 0!==i){if(!(i instanceof CKEDITOR.dom.element))throw Error("Expect element of type CKEDITOR.dom.element.");if(!r)throw Error("One of the element modes must be specified.");if(CKEDITOR.env.ie&&CKEDITOR.env.quirks&&r==CKEDITOR.ELEMENT_MODE_INLINE)throw Error("Inline element mode is not supported on IE quirks.");if(!(r==CKEDITOR.ELEMENT_MODE_INLINE?i.is(CKEDITOR.dtd.$editable)||i.is("textarea"):r==CKEDITOR.ELEMENT_MODE_REPLACE?!i.is(CKEDITOR.dtd.$nonBodyContent):1))throw Error('The specified element mode is not supported on element: "'+i.getName()+'".');this.element=i,this.elementMode=r,this.name=this.elementMode!=CKEDITOR.ELEMENT_MODE_APPENDTO&&(i.getId()||i.getNameAtt())}else this.elementMode=CKEDITOR.ELEMENT_MODE_NONE;this._={},this.commands={},this.templates={},this.name=this.name||e(),this.id=CKEDITOR.tools.getNextId(),this.status="unloaded",this.config=CKEDITOR.tools.prototypedCopy(CKEDITOR.config),this.ui=new CKEDITOR.ui(this),this.focusManager=new CKEDITOR.focusManager(this),this.keystrokeHandler=new CKEDITOR.keystrokeHandler(this),this.on("readOnly",n),this.on("selectionChange",function(t){o(this,t.data.path)}),this.on("activeFilterChange",function(){o(this,this.elementPath(),!0)}),this.on("mode",n),this.on("instanceReady",function(){this.config.startupFocus&&this.focus()}),CKEDITOR.fire("instanceCreated",null,this),CKEDITOR.add(this),CKEDITOR.tools.setTimeout(function(){s(this,t)},0,this)}function e(){do var t="editor"+ ++c;while(CKEDITOR.instances[t]);return t}function n(){var t,e=this.commands;for(t in e)i(this,e[t])}function i(t,e){e[e.startDisabled?"disable":t.readOnly&&!e.readOnly?"disable":e.modes[t.mode]?"enable":"disable"]()}function o(t,e,n){if(e){var i,o,r=t.commands;for(o in r)i=r[o],(n||i.contextSensitive)&&i.refresh(t,e)}}function r(t){var e=t.config.customConfig;if(!e)return!1;var e=CKEDITOR.getUrl(e),n=p[e]||(p[e]={});return n.fn?(n.fn.call(t,t.config),(CKEDITOR.getUrl(t.config.customConfig)==e||!r(t))&&t.fireOnce("customConfigLoaded")):CKEDITOR.scriptLoader.queue(e,function(){n.fn=CKEDITOR.editorConfig?CKEDITOR.editorConfig:function(){},r(t)}),!0}function s(t,e){t.on("customConfigLoaded",function(){if(e){if(e.on)for(var n in e.on)t.on(n,e.on[n]);CKEDITOR.tools.extend(t.config,e,!0),delete t.config.on}n=t.config,t.readOnly=!(!n.readOnly&&!(t.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?t.element.is("textarea")?t.element.hasAttribute("disabled"):t.element.isReadOnly():t.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE&&t.element.hasAttribute("disabled"))),t.blockless=t.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?!(t.element.is("textarea")||CKEDITOR.dtd[t.element.getName()].p):!1,t.tabIndex=n.tabIndex||t.element&&t.element.getAttribute("tabindex")||0,t.activeEnterMode=t.enterMode=t.blockless?CKEDITOR.ENTER_BR:n.enterMode,t.activeShiftEnterMode=t.shiftEnterMode=t.blockless?CKEDITOR.ENTER_BR:n.shiftEnterMode,n.skin&&(CKEDITOR.skinName=n.skin),t.fireOnce("configLoaded"),t.dataProcessor=new CKEDITOR.htmlDataProcessor(t),t.filter=t.activeFilter=new CKEDITOR.filter(t),l(t)}),e&&void 0!=e.customConfig&&(t.config.customConfig=e.customConfig),r(t)||t.fireOnce("customConfigLoaded")}function l(t){CKEDITOR.skin.loadPart("editor",function(){a(t)})}function a(t){CKEDITOR.lang.load(t.config.language,t.config.defaultLanguage,function(e,n){var i=t.config.title;t.langCode=e,t.lang=CKEDITOR.tools.prototypedCopy(n),t.title="string"==typeof i||i===!1?i:[t.lang.editor,t.name].join(", "),CKEDITOR.env.gecko&&CKEDITOR.env.version<10900&&"rtl"==t.lang.dir&&(t.lang.dir="ltr"),t.config.contentsLangDirection||(t.config.contentsLangDirection=t.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?t.element.getDirection(1):t.lang.dir),t.fire("langLoaded"),h(t)})}function h(t){t.getStylesSet(function(e){t.once("loaded",function(){t.fire("stylesSet",{styles:e})},null,null,1),d(t)})}function d(t){var e=t.config,n=e.plugins,i=e.extraPlugins,o=e.removePlugins;if(i)var r=RegExp("(?:^|,)(?:"+i.replace(/\s*,\s*/g,"|")+")(?=,|$)","g"),n=n.replace(r,""),n=n+(","+i);if(o)var s=RegExp("(?:^|,)(?:"+o.replace(/\s*,\s*/g,"|")+")(?=,|$)","g"),n=n.replace(s,"");CKEDITOR.env.air&&(n+=",adobeair"),CKEDITOR.plugins.load(n.split(","),function(n){var i=[],o=[],r=[];t.plugins=n;for(var l in n){var a,h=n[l],d=h.lang,u=null,c=h.requires;if(CKEDITOR.tools.isArray(c)&&(c=c.join(",")),c&&(a=c.match(s)))for(;c=a.pop();)CKEDITOR.tools.setTimeout(function(t,e){throw Error('Plugin "'+t.replace(",","")+'" cannot be removed from the plugins list, because it\'s required by "'+e+'" plugin.')},0,null,[c,l]);d&&!t.lang[l]&&(d.split&&(d=d.split(",")),CKEDITOR.tools.indexOf(d,t.langCode)>=0?u=t.langCode:(u=t.langCode.replace(/-.*/,""),u=u!=t.langCode&&CKEDITOR.tools.indexOf(d,u)>=0?u:CKEDITOR.tools.indexOf(d,"en")>=0?"en":d[0]),h.langEntries&&h.langEntries[u]?(t.lang[l]=h.langEntries[u],u=null):r.push(CKEDITOR.getUrl(h.path+"lang/"+u+".js"))),o.push(u),i.push(h)}CKEDITOR.scriptLoader.load(r,function(){for(var n=["beforeInit","init","afterInit"],r=0;r<n.length;r++)for(var s=0;s<i.length;s++){var l=i[s];0===r&&o[s]&&l.lang&&l.langEntries&&(t.lang[l.name]=l.langEntries[o[s]]),l[n[r]]&&l[n[r]](t)}for(t.fireOnce("pluginsLoaded"),e.keystrokes&&t.setKeystroke(t.config.keystrokes),s=0;s<t.config.blockedKeystrokes.length;s++)t.keystrokeHandler.blockedKeystrokes[t.config.blockedKeystrokes[s]]=1;t.status="loaded",t.fireOnce("loaded"),CKEDITOR.fire("instanceLoaded",null,t)})})}function u(){var t=this.element;if(t&&this.elementMode!=CKEDITOR.ELEMENT_MODE_APPENDTO){var e=this.getData();return this.config.htmlEncodeOutput&&(e=CKEDITOR.tools.htmlEncode(e)),t.is("textarea")?t.setValue(e):t.setHtml(e),!0}return!1}t.prototype=CKEDITOR.editor.prototype,CKEDITOR.editor=t;var c=0,p={};CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{addCommand:function(t,e){e.name=t.toLowerCase();var n=new CKEDITOR.command(this,e);return this.mode&&i(this,n),this.commands[t]=n},_attachToForm:function(){var t=this,e=t.element,n=new CKEDITOR.dom.element(e.$.form);if(e.is("textarea")&&n){var i=function(n){t.updateElement(),t._.required&&!e.getValue()&&t.fire("required")===!1&&n.data.preventDefault()};n.on("submit",i),n.$.submit&&n.$.submit.call&&n.$.submit.apply&&(n.$.submit=CKEDITOR.tools.override(n.$.submit,function(t){return function(){i(),t.apply?t.apply(this):t()}})),t.on("destroy",function(){n.removeListener("submit",i)})}},destroy:function(t){this.fire("beforeDestroy"),!t&&u.call(this),this.editable(null),this.status="destroyed",this.fire("destroy"),this.removeAllListeners(),CKEDITOR.remove(this),CKEDITOR.fire("instanceDestroyed",null,this)},elementPath:function(t){return(t=t||this.getSelection().getStartElement())?new CKEDITOR.dom.elementPath(t,this.editable()):null},createRange:function(){var t=this.editable();return t?new CKEDITOR.dom.range(t):null},execCommand:function(t,e){var n=this.getCommand(t),i={name:t,commandData:e,command:n};return n&&n.state!=CKEDITOR.TRISTATE_DISABLED&&this.fire("beforeCommandExec",i)!==!0&&(i.returnValue=n.exec(i.commandData),!n.async&&this.fire("afterCommandExec",i)!==!0)?i.returnValue:!1},getCommand:function(t){return this.commands[t]},getData:function(t){!t&&this.fire("beforeGetData");var e=this._.data;return"string"!=typeof e&&(e=(e=this.element)&&this.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE?e.is("textarea")?e.getValue():e.getHtml():""),e={dataValue:e},!t&&this.fire("getData",e),e.dataValue},getSnapshot:function(){var t=this.fire("getSnapshot");if("string"!=typeof t){var e=this.element;e&&this.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE&&(t=e.is("textarea")?e.getValue():e.getHtml())}return t},loadSnapshot:function(t){this.fire("loadSnapshot",t)},setData:function(t,e,n){e&&this.on("dataReady",function(t){t.removeListener(),e.call(t.editor)}),t={dataValue:t},!n&&this.fire("setData",t),this._.data=t.dataValue,!n&&this.fire("afterSetData",t)},setReadOnly:function(t){t=void 0==t||t,this.readOnly!=t&&(this.readOnly=t,this.keystrokeHandler.blockedKeystrokes[8]=+t,this.editable().setReadOnly(t),this.fire("readOnly"))},insertHtml:function(t,e){this.fire("insertHtml",{dataValue:t,mode:e})},insertText:function(t){this.fire("insertText",t)},insertElement:function(t){this.fire("insertElement",t)},focus:function(){this.fire("beforeFocus")},checkDirty:function(){return"ready"==this.status&&this._.previousValue!==this.getSnapshot()},resetDirty:function(){this._.previousValue=this.getSnapshot()},updateElement:function(){return u.call(this)},setKeystroke:function(){for(var t,e,n=this.keystrokeHandler.keystrokes,i=CKEDITOR.tools.isArray(arguments[0])?arguments[0]:[[].slice.call(arguments,0)],o=i.length;o--;)t=i[o],e=0,CKEDITOR.tools.isArray(t)&&(e=t[1],t=t[0]),e?n[t]=e:delete n[t]},addFeature:function(t){return this.filter.addFeature(t)},setActiveFilter:function(t){t||(t=this.filter),this.activeFilter!==t&&(this.activeFilter=t,this.fire("activeFilterChange"),t===this.filter?this.setActiveEnterMode(null,null):this.setActiveEnterMode(t.getAllowedEnterMode(this.enterMode),t.getAllowedEnterMode(this.shiftEnterMode,!0)))},setActiveEnterMode:function(t,e){t=t?this.blockless?CKEDITOR.ENTER_BR:t:this.enterMode,e=e?this.blockless?CKEDITOR.ENTER_BR:e:this.shiftEnterMode,(this.activeEnterMode!=t||this.activeShiftEnterMode!=e)&&(this.activeEnterMode=t,this.activeShiftEnterMode=e,this.fire("activeEnterModeChange"))}})}(),CKEDITOR.ELEMENT_MODE_NONE=0,CKEDITOR.ELEMENT_MODE_REPLACE=1,CKEDITOR.ELEMENT_MODE_APPENDTO=2,CKEDITOR.ELEMENT_MODE_INLINE=3,CKEDITOR.htmlParser=function(){this._={htmlPartsRegex:RegExp("<(?:(?:\\/([^>]+)>)|(?:!--([\\S|\\s]*?)-->)|(?:([^\\s>]+)\\s*((?:(?:\"[^\"]*\")|(?:'[^']*')|[^\"'>])*)\\/?>))","g")}},function(){var t=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,e={checked:1,compact:1,declare:1,defer:1,disabled:1,ismap:1,multiple:1,nohref:1,noresize:1,noshade:1,nowrap:1,readonly:1,selected:1};CKEDITOR.htmlParser.prototype={onTagOpen:function(){},onTagClose:function(){},onText:function(){},onCDATA:function(){},onComment:function(){},parse:function(n){for(var i,o,r,s=0;i=this._.htmlPartsRegex.exec(n);)if(o=i.index,o>s&&(s=n.substring(s,o),r?r.push(s):this.onText(s)),s=this._.htmlPartsRegex.lastIndex,!(o=i[1])||(o=o.toLowerCase(),r&&CKEDITOR.dtd.$cdata[o]&&(this.onCDATA(r.join("")),r=null),r))if(r)r.push(i[0]);else if(o=i[3]){if(o=o.toLowerCase(),!/="/.test(o)){var l,a={};i=i[4];var h=!(!i||"/"!=i.charAt(i.length-1));if(i)for(;l=t.exec(i);){var d=l[1].toLowerCase();l=l[2]||l[3]||l[4]||"",a[d]=!l&&e[d]?d:CKEDITOR.tools.htmlDecodeAttr(l)}this.onTagOpen(o,a,h),!r&&CKEDITOR.dtd.$cdata[o]&&(r=[])}}else(o=i[2])&&this.onComment(o);else this.onTagClose(o);n.length>s&&this.onText(n.substring(s,n.length))}}}(),CKEDITOR.htmlParser.basicWriter=CKEDITOR.tools.createClass({$:function(){this._={output:[]}},proto:{openTag:function(t){this._.output.push("<",t)},openTagClose:function(t,e){e?this._.output.push(" />"):this._.output.push(">")},attribute:function(t,e){"string"==typeof e&&(e=CKEDITOR.tools.htmlEncodeAttr(e)),this._.output.push(" ",t,'="',e,'"')},closeTag:function(t){this._.output.push("</",t,">")},text:function(t){this._.output.push(t)},comment:function(t){this._.output.push("<!--",t,"-->")},write:function(t){this._.output.push(t)},reset:function(){this._.output=[],this._.indent=!1},getHtml:function(t){var e=this._.output.join("");return t&&this.reset(),e}}}),function(){CKEDITOR.htmlParser.node=function(){},CKEDITOR.htmlParser.node.prototype={remove:function(){var t=this.parent.children,e=CKEDITOR.tools.indexOf(t,this),n=this.previous,i=this.next;n&&(n.next=i),i&&(i.previous=n),t.splice(e,1),this.parent=null},replaceWith:function(t){var e=this.parent.children,n=CKEDITOR.tools.indexOf(e,this),i=t.previous=this.previous,o=t.next=this.next;i&&(i.next=t),o&&(o.previous=t),e[n]=t,t.parent=this.parent,this.parent=null},insertAfter:function(t){var e=t.parent.children,n=CKEDITOR.tools.indexOf(e,t),i=t.next;e.splice(n+1,0,this),this.next=t.next,this.previous=t,t.next=this,i&&(i.previous=this),this.parent=t.parent},insertBefore:function(t){var e=t.parent.children,n=CKEDITOR.tools.indexOf(e,t);e.splice(n,0,this),this.next=t,(this.previous=t.previous)&&(t.previous.next=this),t.previous=this,this.parent=t.parent},getAscendant:function(t){for(var e=("function"==typeof t?t:"string"==typeof t?function(e){return e.name==t}:function(e){return e.name in t}),n=this.parent;n&&n.type==CKEDITOR.NODE_ELEMENT;){if(e(n))return n;n=n.parent}return null},wrapWith:function(t){return this.replaceWith(t),t.add(this),t},getIndex:function(){return CKEDITOR.tools.indexOf(this.parent.children,this)},getFilterContext:function(t){return t||{}}}}(),CKEDITOR.htmlParser.comment=function(t){this.value=t,this._={isBlockLike:!1}},CKEDITOR.htmlParser.comment.prototype=CKEDITOR.tools.extend(new CKEDITOR.htmlParser.node,{type:CKEDITOR.NODE_COMMENT,filter:function(t,e){var n=this.value;return(n=t.onComment(e,n,this))?"string"!=typeof n?(this.replaceWith(n),!1):(this.value=n,!0):(this.remove(),!1)},writeHtml:function(t,e){e&&this.filter(e),t.comment(this.value)}}),function(){CKEDITOR.htmlParser.text=function(t){this.value=t,this._={isBlockLike:!1}},CKEDITOR.htmlParser.text.prototype=CKEDITOR.tools.extend(new CKEDITOR.htmlParser.node,{type:CKEDITOR.NODE_TEXT,filter:function(t,e){return(this.value=t.onText(e,this.value,this))?void 0:(this.remove(),!1)},writeHtml:function(t,e){e&&this.filter(e),t.text(this.value)}})}(),function(){CKEDITOR.htmlParser.cdata=function(t){this.value=t},CKEDITOR.htmlParser.cdata.prototype=CKEDITOR.tools.extend(new CKEDITOR.htmlParser.node,{type:CKEDITOR.NODE_TEXT,filter:function(){},writeHtml:function(t){t.write(this.value)}})}(),CKEDITOR.htmlParser.fragment=function(){this.children=[],this.parent=null,this._={isBlockLike:!0,hasInlineStarted:!1}},function(){function t(t){return t.attributes["data-cke-survive"]?!1:"a"==t.name&&t.attributes.href||CKEDITOR.dtd.$removeEmpty[t.name]}var e=CKEDITOR.tools.extend({table:1,ul:1,ol:1,dl:1},CKEDITOR.dtd.table,CKEDITOR.dtd.ul,CKEDITOR.dtd.ol,CKEDITOR.dtd.dl),n={ol:1,ul:1},i=CKEDITOR.tools.extend({},{html:1},CKEDITOR.dtd.html,CKEDITOR.dtd.body,CKEDITOR.dtd.head,{style:1,script:1});CKEDITOR.htmlParser.fragment.fromHtml=function(o,r,s){function l(t){var e;if(g.length>0)for(var n=0;n<g.length;n++){var i=g[n],o=i.name,r=CKEDITOR.dtd[o],s=x.name&&CKEDITOR.dtd[x.name];s&&!s[o]||t&&r&&!r[t]&&CKEDITOR.dtd[t]?o==x.name&&(d(x,x.parent,1),n--):(e||(a(),e=1),i=i.clone(),i.parent=x,x=i,g.splice(n,1),n--)}}function a(){for(;f.length;)d(f.shift(),x)}function h(t){if(t._.isBlockLike&&"pre"!=t.name&&"textarea"!=t.name){var e,n=t.children.length,i=t.children[n-1];i&&i.type==CKEDITOR.NODE_TEXT&&((e=CKEDITOR.tools.rtrim(i.value))?i.value=e:t.children.length=n-1)}}function d(e,n,i){var n=n||x||m,o=x;void 0===e.previous&&(u(n,e)&&(x=n,p.onTagOpen(s,{}),e.returnPoint=n=x),h(e),(!t(e)||e.children.length)&&n.add(e),"pre"==e.name&&(E=!1),"textarea"==e.name&&(C=!1)),e.returnPoint?(x=e.returnPoint,delete e.returnPoint):x=i?n:o}function u(t,e){if((t==m||"body"==t.name)&&s&&(!t.name||CKEDITOR.dtd[t.name][s])){var n,i;return(n=e.attributes&&(i=e.attributes["data-cke-real-element-type"])?i:e.name)&&n in CKEDITOR.dtd.$inline&&!(n in CKEDITOR.dtd.head)&&!e.isOrphan||e.type==CKEDITOR.NODE_TEXT}}function c(t,e){return t in CKEDITOR.dtd.$listItem||t in CKEDITOR.dtd.$tableContent?t==e||"dt"==t&&"dd"==e||"dd"==t&&"dt"==e:!1}var p=new CKEDITOR.htmlParser,m=r instanceof CKEDITOR.htmlParser.element?r:"string"==typeof r?new CKEDITOR.htmlParser.element(r):new CKEDITOR.htmlParser.fragment,g=[],f=[],x=m,C="textarea"==m.name,E="pre"==m.name;p.onTagOpen=function(o,r,s,h){if(r=new CKEDITOR.htmlParser.element(o,r),r.isUnknown&&s&&(r.isEmpty=!0),r.isOptionalClose=h,t(r))g.push(r);else{if("pre"==o)E=!0;else{if("br"==o&&E)return x.add(new CKEDITOR.htmlParser.text("\n")),void 0;"textarea"==o&&(C=!0)}if("br"==o)f.push(r);else{for(;h=(s=x.name)?CKEDITOR.dtd[s]||(x._.isBlockLike?CKEDITOR.dtd.div:CKEDITOR.dtd.span):i,!(r.isUnknown||x.isUnknown||h[o]);)if(x.isOptionalClose)p.onTagClose(s);else if(o in n&&s in n)s=x.children,(s=s[s.length-1])&&"li"==s.name||d(s=new CKEDITOR.htmlParser.element("li"),x),!r.returnPoint&&(r.returnPoint=x),x=s;else if(o in CKEDITOR.dtd.$listItem&&!c(o,s))p.onTagOpen("li"==o?"ul":"dl",{},0,1);else if(s in e&&!c(o,s))!r.returnPoint&&(r.returnPoint=x),x=x.parent;else{if(s in CKEDITOR.dtd.$inline&&g.unshift(x),!x.parent){r.isOrphan=1;break}d(x,x.parent,1)}l(o),a(),r.parent=x,r.isEmpty?d(r):x=r}}},p.onTagClose=function(t){for(var e=g.length-1;e>=0;e--)if(t==g[e].name)return g.splice(e,1),void 0;for(var n=[],i=[],o=x;o!=m&&o.name!=t;)o._.isBlockLike||i.unshift(o),n.push(o),o=o.returnPoint||o.parent;if(o!=m){for(e=0;e<n.length;e++){var r=n[e];d(r,r.parent)}x=o,o._.isBlockLike&&a(),d(o,o.parent),o==x&&(x=x.parent),g=g.concat(i)}"body"==t&&(s=!1)},p.onText=function(t){if(x._.hasInlineStarted&&!f.length||E||C||(t=CKEDITOR.tools.ltrim(t),0!==t.length)){var o=x.name,r=o?CKEDITOR.dtd[o]||(x._.isBlockLike?CKEDITOR.dtd.div:CKEDITOR.dtd.span):i;!C&&!r["#"]&&o in e?(p.onTagOpen(o in n?"li":"dl"==o?"dd":"table"==o?"tr":"tr"==o?"td":""),p.onText(t)):(a(),l(),!E&&!C&&(t=t.replace(/[\t\r\n ]{2,}|[\t\r\n]/g," ")),t=new CKEDITOR.htmlParser.text(t),u(x,t)&&this.onTagOpen(s,{},0,1),x.add(t))}},p.onCDATA=function(t){x.add(new CKEDITOR.htmlParser.cdata(t))},p.onComment=function(t){a(),l(),x.add(new CKEDITOR.htmlParser.comment(t))},p.parse(o);for(a();x!=m;)d(x,x.parent,1);return h(m),m},CKEDITOR.htmlParser.fragment.prototype={type:CKEDITOR.NODE_DOCUMENT_FRAGMENT,add:function(t,e){isNaN(e)&&(e=this.children.length);var n=e>0?this.children[e-1]:null;if(n){if(t._.isBlockLike&&n.type==CKEDITOR.NODE_TEXT&&(n.value=CKEDITOR.tools.rtrim(n.value),0===n.value.length))return this.children.pop(),this.add(t),void 0;n.next=t}t.previous=n,t.parent=this,this.children.splice(e,0,t),this._.hasInlineStarted||(this._.hasInlineStarted=t.type==CKEDITOR.NODE_TEXT||t.type==CKEDITOR.NODE_ELEMENT&&!t._.isBlockLike)},filter:function(t,e){e=this.getFilterContext(e),t.onRoot(e,this),this.filterChildren(t,!1,e)},filterChildren:function(t,e,n){if(this.childrenFilteredBy!=t.id)for(n=this.getFilterContext(n),e&&!this.parent&&t.onRoot(n,this),this.childrenFilteredBy=t.id,e=0;e<this.children.length;e++)this.children[e].filter(t,n)===!1&&e--},writeHtml:function(t,e){e&&this.filter(e),this.writeChildrenHtml(t)},writeChildrenHtml:function(t,e,n){var i=this.getFilterContext();for(n&&!this.parent&&e&&e.onRoot(i,this),e&&this.filterChildren(e,!1,i),e=0,n=this.children,i=n.length;i>e;e++)n[e].writeHtml(t)},forEach:function(t,e,n){if(!(n||e&&this.type!=e))var i=t(this);if(i!==!1)for(var n=this.children,o=0;o<n.length;o++)i=n[o],i.type==CKEDITOR.NODE_ELEMENT?i.forEach(t,e):(!e||i.type==e)&&t(i)},getFilterContext:function(t){return t||{}}}}(),function(){function t(){this.rules=[]}function e(e,n,i,o){var r,s;for(r in n)(s=e[r])||(s=e[r]=new t),s.add(n[r],i,o)}CKEDITOR.htmlParser.filter=CKEDITOR.tools.createClass({$:function(e){this.id=CKEDITOR.tools.getNextNumber(),this.elementNameRules=new t,this.attributeNameRules=new t,this.elementsRules={},this.attributesRules={},this.textRules=new t,this.commentRules=new t,this.rootRules=new t,e&&this.addRules(e,10)},proto:{addRules:function(t,n){var i;"number"==typeof n?i=n:n&&"priority"in n&&(i=n.priority),"number"!=typeof i&&(i=10),"object"!=typeof n&&(n={}),t.elementNames&&this.elementNameRules.addMany(t.elementNames,i,n),t.attributeNames&&this.attributeNameRules.addMany(t.attributeNames,i,n),t.elements&&e(this.elementsRules,t.elements,i,n),t.attributes&&e(this.attributesRules,t.attributes,i,n),t.text&&this.textRules.add(t.text,i,n),t.comment&&this.commentRules.add(t.comment,i,n),t.root&&this.rootRules.add(t.root,i,n)},applyTo:function(t){t.filter(this)},onElementName:function(t,e){return this.elementNameRules.execOnName(t,e)},onAttributeName:function(t,e){return this.attributeNameRules.execOnName(t,e)},onText:function(t,e){return this.textRules.exec(t,e)},onComment:function(t,e,n){return this.commentRules.exec(t,e,n)},onRoot:function(t,e){return this.rootRules.exec(t,e)},onElement:function(t,e){for(var n,i=[this.elementsRules["^"],this.elementsRules[e.name],this.elementsRules.$],o=0;3>o;o++)if(n=i[o]){if(n=n.exec(t,e,this),n===!1)return null;if(n&&n!=e)return this.onNode(t,n);if(e.parent&&!e.name)break}return e},onNode:function(t,e){var n=e.type;return n==CKEDITOR.NODE_ELEMENT?this.onElement(t,e):n==CKEDITOR.NODE_TEXT?new CKEDITOR.htmlParser.text(this.onText(t,e.value)):n==CKEDITOR.NODE_COMMENT?new CKEDITOR.htmlParser.comment(this.onComment(t,e.value)):null},onAttribute:function(t,e,n,i){return(n=this.attributesRules[n])?n.exec(t,i,e,this):i}}}),CKEDITOR.htmlParser.filterRulesGroup=t,t.prototype={add:function(t,e,n){this.rules.splice(this.findIndex(e),0,{value:t,priority:e,options:n})},addMany:function(t,e,n){for(var i=[this.findIndex(e),0],o=0,r=t.length;r>o;o++)i.push({value:t[o],priority:e,options:n});this.rules.splice.apply(this.rules,i)},findIndex:function(t){for(var e=this.rules,n=e.length-1;n>=0&&t<e[n].priority;)n--;return n+1},exec:function(t,e){var n,i,o,r,s=e instanceof CKEDITOR.htmlParser.node||e instanceof CKEDITOR.htmlParser.fragment,l=Array.prototype.slice.call(arguments,1),a=this.rules,h=a.length;for(r=0;h>r;r++)if(s&&(n=e.type,i=e.name),o=a[r],!(t.nonEditable&&!o.options.applyToAll||t.nestedEditable&&o.options.excludeNestedEditable)){if(o=o.value.apply(null,l),o===!1||s&&o&&(o.name!=i||o.type!=n))return o;void 0!=o&&(l[0]=e=o)}return e},execOnName:function(t,e){for(var n,i=0,o=this.rules,r=o.length;e&&r>i;i++)n=o[i],!(t.nonEditable&&!n.options.applyToAll||t.nestedEditable&&n.options.excludeNestedEditable)&&(e=e.replace(n.value[0],n.value[1]));return e}}}(),function(){function t(t,e){function l(t){return t||CKEDITOR.env.needsNbspFiller?new CKEDITOR.htmlParser.text(""):new CKEDITOR.htmlParser.element("br",{"data-cke-bogus":1})}function a(t,e){return function(o){if(o.type!=CKEDITOR.NODE_DOCUMENT_FRAGMENT){var s,a,d=[],u=n(o);if(u)for(h(u,1)&&d.push(u);u;)r(u)&&(s=i(u))&&h(s)&&((a=i(s))&&!r(a)?d.push(s):(l(c).insertAfter(s),s.remove())),u=u.previous;for(u=0;u<d.length;u++)d[u].remove();(d=CKEDITOR.env.opera&&!t||("function"==typeof e?e(o)!==!1:e))&&(c||CKEDITOR.env.needsBrFiller||o.type!=CKEDITOR.NODE_DOCUMENT_FRAGMENT?c||CKEDITOR.env.needsBrFiller||!(document.documentMode>7||o.name in CKEDITOR.dtd.tr||o.name in CKEDITOR.dtd.$listItem)?(d=n(o),d=!d||"form"==o.name&&"input"==d.name):d=!1:d=!1),d&&o.add(l(t))}}}function h(t,e){if((!c||CKEDITOR.env.needsBrFiller)&&t.type==CKEDITOR.NODE_ELEMENT&&"br"==t.name&&!t.attributes["data-cke-eol"])return!0;var n;if(t.type==CKEDITOR.NODE_TEXT&&(n=t.value.match(f))){if(n.index&&(new CKEDITOR.htmlParser.text(t.value.substring(0,n.index)).insertBefore(t),t.value=n[0]),!CKEDITOR.env.needsBrFiller&&c&&(!e||t.parent.name in p))return!0;if(!c&&((n=t.previous)&&"br"==n.name||!n||r(n)))return!0}return!1}var d,u={elements:{}},c="html"==e,p=CKEDITOR.tools.extend({},y);for(d in p)"#"in C[d]||delete p[d];for(d in p)u.elements[d]=a(c,t.config.fillEmptyBlocks!==!1);return u.root=a(c),u.elements.br=function(t){return function(e){if(e.parent.type!=CKEDITOR.NODE_DOCUMENT_FRAGMENT){var n=e.attributes;if("data-cke-bogus"in n||"data-cke-eol"in n)delete n["data-cke-bogus"];else{for(n=e.next;n&&o(n);)n=n.next;var a=i(e);!n&&r(e.parent)?s(e.parent,l(t)):r(n)&&a&&!r(a)&&l(t).insertBefore(n)}}}}(c),u}function e(t,e){return t!=CKEDITOR.ENTER_BR&&e!==!1?t==CKEDITOR.ENTER_DIV?"div":"p":!1}function n(t){for(t=t.children[t.children.length-1];t&&o(t);)t=t.previous;return t}function i(t){for(t=t.previous;t&&o(t);)t=t.previous;return t}function o(t){return t.type==CKEDITOR.NODE_TEXT&&!CKEDITOR.tools.trim(t.value)||t.type==CKEDITOR.NODE_ELEMENT&&t.attributes["data-cke-bookmark"]}function r(t){return t&&(t.type==CKEDITOR.NODE_ELEMENT&&t.name in y||t.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT)}function s(t,e){var n=t.children[t.children.length-1];t.children.push(e),e.parent=t,n&&(n.next=e,e.previous=n)}function l(t){t=t.attributes,"false"!=t.contenteditable&&(t["data-cke-editable"]=t.contenteditable?"true":1),t.contenteditable="false"}function a(t){switch(t=t.attributes,t["data-cke-editable"]){case"true":t.contenteditable="true";break;case"1":delete t.contenteditable}}function h(t){return t.replace(S,function(t,e,n){return"<"+e+n.replace(O,function(t,e){return/^on/.test(e)||-1!=n.indexOf("data-cke-saved-"+e)?t:(t=t.slice(1)," data-cke-saved-"+t+" data-cke-"+CKEDITOR.rnd+"-"+t)})+">"})}function d(t,e){return t.replace(e,function(t,e,n){return 0===t.indexOf("<textarea")&&(t=e+p(n).replace(/</g,"&lt;").replace(/>/g,"&gt;")+"</textarea>"),"<cke:encoded>"+encodeURIComponent(t)+"</cke:encoded>"})}function u(t){return t.replace(D,function(t,e){return decodeURIComponent(e)})}function c(t){return t.replace(/<\!--(?!{cke_protected})[\s\S]+?--\>/g,function(t){return"<!--"+x+"{C}"+encodeURIComponent(t).replace(/--/g,"%2D%2D")+"-->"})}function p(t){return t.replace(/<\!--\{cke_protected\}\{C\}([\s\S]+?)--\>/g,function(t,e){return decodeURIComponent(e)})}function m(t,e){var n=e._.dataStore;return t.replace(/<\!--\{cke_protected\}([\s\S]+?)--\>/g,function(t,e){return decodeURIComponent(e)}).replace(/\{cke_protected_(\d+)\}/g,function(t,e){return n&&n[e]||""})}function g(t,e){for(var n=[],i=e.config.protectedSource,o=e._.dataStore||(e._.dataStore={id:1}),r=/<\!--\{cke_temp(comment)?\}(\d*?)--\>/g,i=[/<script[\s\S]*?<\/script>/gi,/<noscript[\s\S]*?<\/noscript>/gi].concat(i),t=t.replace(/<\!--[\s\S]*?--\>/g,function(t){return"<!--{cke_tempcomment}"+(n.push(t)-1)+"-->"}),s=0;s<i.length;s++)t=t.replace(i[s],function(t){return t=t.replace(r,function(t,e,i){return n[i]}),/cke_temp(comment)?/.test(t)?t:"<!--{cke_temp}"+(n.push(t)-1)+"-->"});return t=t.replace(r,function(t,e,i){return"<!--"+x+(e?"{C}":"")+encodeURIComponent(n[i]).replace(/--/g,"%2D%2D")+"-->"}),t.replace(/(['"]).*?\1/g,function(t){return t.replace(/<\!--\{cke_protected\}([\s\S]+?)--\>/g,function(t,e){return o[o.id]=decodeURIComponent(e),"{cke_protected_"+o.id++ +"}"})})}CKEDITOR.htmlDataProcessor=function(n){var i,o,r=this;this.editor=n,this.dataFilter=i=new CKEDITOR.htmlParser.filter,this.htmlFilter=o=new CKEDITOR.htmlParser.filter,this.writer=new CKEDITOR.htmlParser.basicWriter,i.addRules(v),i.addRules(T,{applyToAll:!0}),i.addRules(t(n,"data"),{applyToAll:!0}),o.addRules(b),o.addRules(I,{applyToAll:!0}),o.addRules(t(n,"html"),{applyToAll:!0}),n.on("toHtml",function(t){var i,t=t.data,o=t.dataValue,o=g(o,n),o=d(o,w),o=h(o),o=d(o,R),o=o.replace(_,"$1cke:$2"),o=o.replace(L,"<cke:$1$2></cke:$1>"),o=CKEDITOR.env.opera?o:o.replace(/(<pre\b[^>]*>)(\r\n|\n)/g,"$1$2$2"),r=t.context||n.editable().getName();CKEDITOR.env.ie&&CKEDITOR.env.version<9&&"pre"==r&&(r="div",o="<pre>"+o+"</pre>",i=1),r=n.document.createElement(r),r.setHtml("a"+o),o=r.getHtml().substr(1),o=o.replace(RegExp(" data-cke-"+CKEDITOR.rnd+"-","ig")," "),i&&(o=o.replace(/^<pre>|<\/pre>$/gi,"")),o=o.replace(A,"$1$2"),o=u(o),o=p(o),t.dataValue=CKEDITOR.htmlParser.fragment.fromHtml(o,t.context,t.fixForBody===!1?!1:e(t.enterMode,n.config.autoParagraph))},null,null,5),n.on("toHtml",function(t){t.data.filter.applyTo(t.data.dataValue,!0,t.data.dontFilter,t.data.enterMode)&&n.fire("dataFiltered")
},null,null,6),n.on("toHtml",function(t){t.data.dataValue.filterChildren(r.dataFilter,!0)},null,null,10),n.on("toHtml",function(t){var t=t.data,e=t.dataValue,n=new CKEDITOR.htmlParser.basicWriter;e.writeChildrenHtml(n),e=n.getHtml(!0),t.dataValue=c(e)},null,null,15),n.on("toDataFormat",function(t){var i=t.data.dataValue;t.data.enterMode!=CKEDITOR.ENTER_BR&&(i=i.replace(/^<br *\/?>/i,"")),t.data.dataValue=CKEDITOR.htmlParser.fragment.fromHtml(i,t.data.context,e(t.data.enterMode,n.config.autoParagraph))},null,null,5),n.on("toDataFormat",function(t){t.data.dataValue.filterChildren(r.htmlFilter,!0)},null,null,10),n.on("toDataFormat",function(t){t.data.filter.applyTo(t.data.dataValue,!1,!0)},null,null,11),n.on("toDataFormat",function(t){var e=t.data.dataValue,i=r.writer;i.reset(),e.writeChildrenHtml(i),e=i.getHtml(!0),e=p(e),e=m(e,n),t.data.dataValue=e},null,null,15)},CKEDITOR.htmlDataProcessor.prototype={toHtml:function(t,e,n,i){var o,r,s,l=this.editor;return e&&"object"==typeof e?(o=e.context,n=e.fixForBody,i=e.dontFilter,r=e.filter,s=e.enterMode):o=e,!o&&null!==o&&(o=l.editable().getName()),l.fire("toHtml",{dataValue:t,context:o,fixForBody:n,dontFilter:i,filter:r||l.filter,enterMode:s||l.enterMode}).dataValue},toDataFormat:function(t,e){var n,i,o;return e&&(n=e.context,i=e.filter,o=e.enterMode),!n&&null!==n&&(n=this.editor.editable().getName()),this.editor.fire("toDataFormat",{dataValue:t,filter:i||this.editor.filter,context:n,enterMode:o||this.editor.enterMode}).dataValue}};var f=/(?:&nbsp;|\xa0)$/,x="{cke_protected}",C=CKEDITOR.dtd,E=["caption","colgroup","col","thead","tfoot","tbody"],y=CKEDITOR.tools.extend({},C.$blockLimit,C.$block),v={elements:{input:l,textarea:l}},T={attributeNames:[[/^on/,"data-cke-pa-on"],[/^data-cke-expando$/,""]]},b={elements:{embed:function(t){var e=t.parent;if(e&&"object"==e.name){var n=e.attributes.width,e=e.attributes.height;n&&(t.attributes.width=n),e&&(t.attributes.height=e)}},a:function(t){return t.children.length||t.attributes.name||t.attributes["data-cke-saved-name"]?void 0:!1}}},I={elementNames:[[/^cke:/,""],[/^\?xml:namespace$/,""]],attributeNames:[[/^data-cke-(saved|pa)-/,""],[/^data-cke-.*/,""],["hidefocus",""]],elements:{$:function(t){var e=t.attributes;if(e){if(e["data-cke-temp"])return!1;for(var n,i=["name","href","src"],o=0;o<i.length;o++)n="data-cke-saved-"+i[o],n in e&&delete e[i[o]]}return t},table:function(t){t.children.slice(0).sort(function(t,e){var n,i;return t.type==CKEDITOR.NODE_ELEMENT&&e.type==t.type&&(n=CKEDITOR.tools.indexOf(E,t.name),i=CKEDITOR.tools.indexOf(E,e.name)),n>-1&&i>-1&&n!=i||(n=t.parent?t.getIndex():-1,i=e.parent?e.getIndex():-1),n>i?1:-1})},param:function(t){return t.children=[],t.isEmpty=!0,t},span:function(t){"Apple-style-span"==t.attributes["class"]&&delete t.name},html:function(t){delete t.attributes.contenteditable,delete t.attributes["class"]},body:function(t){delete t.attributes.spellcheck,delete t.attributes.contenteditable},style:function(t){var e=t.children[0];e&&e.value&&(e.value=CKEDITOR.tools.trim(e.value)),t.attributes.type||(t.attributes.type="text/css")},title:function(t){var e=t.children[0];!e&&s(t,e=new CKEDITOR.htmlParser.text),e.value=t.attributes["data-cke-title"]||""},input:a,textarea:a},attributes:{"class":function(t){return CKEDITOR.tools.ltrim(t.replace(/(?:^|\s+)cke_[^\s]*/g,""))||!1}}};CKEDITOR.env.ie&&(I.attributes.style=function(t){return t.replace(/(^|;)([^\:]+)/g,function(t){return t.toLowerCase()})});var S=/<(a|area|img|input|source)\b([^>]*)>/gi,O=/\s(on\w+|href|src|name)\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|(?:[^ "'>]+))/gi,R=/(?:<style(?=[ >])[^>]*>[\s\S]*?<\/style>)|(?:<(:?link|meta|base)[^>]*>)/gi,w=/(<textarea(?=[ >])[^>]*>)([\s\S]*?)(?:<\/textarea>)/gi,D=/<cke:encoded>([^<]*)<\/cke:encoded>/gi,_=/(<\/?)((?:object|embed|param|html|body|head|title)[^>]*>)/gi,A=/(<\/?)cke:((?:html|body|head|title)[^>]*>)/gi,L=/<cke:(param|embed)([^>]*?)\/?>(?!\s*<\/cke:\1)/gi}(),CKEDITOR.htmlParser.element=function(t,e){this.name=t,this.attributes=e||{},this.children=[];var n=t||"",i=n.match(/^cke:(.*)/);i&&(n=i[1]),n=!!(CKEDITOR.dtd.$nonBodyContent[n]||CKEDITOR.dtd.$block[n]||CKEDITOR.dtd.$listItem[n]||CKEDITOR.dtd.$tableContent[n]||CKEDITOR.dtd.$nonEditable[n]||"br"==n),this.isEmpty=!!CKEDITOR.dtd.$empty[t],this.isUnknown=!CKEDITOR.dtd[t],this._={isBlockLike:n,hasInlineStarted:this.isEmpty||!n}},CKEDITOR.htmlParser.cssStyle=function(t){var e={};return((t instanceof CKEDITOR.htmlParser.element?t.attributes.style:t)||"").replace(/&quot;/g,'"').replace(/\s*([^ :;]+)\s*:\s*([^;]+)\s*(?=;|$)/g,function(t,n,i){"font-family"==n&&(i=i.replace(/["']/g,"")),e[n.toLowerCase()]=i}),{rules:e,populate:function(t){var e=this.toString();e&&(t instanceof CKEDITOR.dom.element?t.setAttribute("style",e):t instanceof CKEDITOR.htmlParser.element?t.attributes.style=e:t.style=e)},toString:function(){var t,n=[];for(t in e)e[t]&&n.push(t,":",e[t],";");return n.join("")}}},function(){function t(t){return function(e){return e.type==CKEDITOR.NODE_ELEMENT&&("string"==typeof t?e.name==t:e.name in t)}}var e=function(t,e){return t=t[0],e=e[0],e>t?-1:t>e?1:0},n=CKEDITOR.htmlParser.fragment.prototype;CKEDITOR.htmlParser.element.prototype=CKEDITOR.tools.extend(new CKEDITOR.htmlParser.node,{type:CKEDITOR.NODE_ELEMENT,add:n.add,clone:function(){return new CKEDITOR.htmlParser.element(this.name,this.attributes)},filter:function(t,e){var n,i,o=this,e=o.getFilterContext(e);if(e.off)return!0;for(o.parent||t.onRoot(e,o);;){if(n=o.name,!(i=t.onElementName(e,n)))return this.remove(),!1;if(o.name=i,!(o=t.onElement(e,o)))return this.remove(),!1;if(o!==this)return this.replaceWith(o),!1;if(o.name==n)break;if(o.type!=CKEDITOR.NODE_ELEMENT)return this.replaceWith(o),!1;if(!o.name)return this.replaceWithChildren(),!1}n=o.attributes;var r,s;for(r in n){for(s=r,i=n[r];;){if(!(s=t.onAttributeName(e,r))){delete n[r];break}if(s==r)break;delete n[r],r=s}s&&((i=t.onAttribute(e,o,s,i))===!1?delete n[s]:n[s]=i)}return o.isEmpty||this.filterChildren(t,!1,e),!0},filterChildren:n.filterChildren,writeHtml:function(t,n){n&&this.filter(n);var i,o,r=this.name,s=[],l=this.attributes;t.openTag(r,l);for(i in l)s.push([i,l[i]]);for(t.sortAttributes&&s.sort(e),i=0,o=s.length;o>i;i++)l=s[i],t.attribute(l[0],l[1]);t.openTagClose(r,this.isEmpty),this.writeChildrenHtml(t),this.isEmpty||t.closeTag(r)},writeChildrenHtml:n.writeChildrenHtml,replaceWithChildren:function(){for(var t=this.children,e=t.length;e;)t[--e].insertAfter(this);this.remove()},forEach:n.forEach,getFirst:function(e){if(!e)return this.children.length?this.children[0]:null;"function"!=typeof e&&(e=t(e));for(var n=0,i=this.children.length;i>n;++n)if(e(this.children[n]))return this.children[n];return null},getHtml:function(){var t=new CKEDITOR.htmlParser.basicWriter;return this.writeChildrenHtml(t),t.getHtml()},setHtml:function(t){for(var t=this.children=CKEDITOR.htmlParser.fragment.fromHtml(t).children,e=0,n=t.length;n>e;++e)t[e].parent=this},getOuterHtml:function(){var t=new CKEDITOR.htmlParser.basicWriter;return this.writeHtml(t),t.getHtml()},split:function(t){for(var e=this.children.splice(t,this.children.length-t),n=this.clone(),i=0;i<e.length;++i)e[i].parent=n;return n.children=e,e[0]&&(e[0].previous=null),t>0&&(this.children[t-1].next=null),this.parent.add(n,this.getIndex()+1),n},removeClass:function(t){var e=this.attributes["class"];e&&((e=CKEDITOR.tools.trim(e.replace(RegExp("(?:\\s+|^)"+t+"(?:\\s+|$)")," ")))?this.attributes["class"]=e:delete this.attributes["class"])},hasClass:function(t){var e=this.attributes["class"];return e?RegExp("(?:^|\\s)"+t+"(?=\\s|$)").test(e):!1},getFilterContext:function(t){var e=[];if(t||(t={off:!1,nonEditable:!1,nestedEditable:!1}),!t.off&&"off"==this.attributes["data-cke-processor"]&&e.push("off",!0),t.nonEditable||"false"!=this.attributes.contenteditable?!t.nestedEditable&&"true"==this.attributes.contenteditable&&e.push("nestedEditable",!0):e.push("nonEditable",!0),e.length)for(var t=CKEDITOR.tools.copy(t),n=0;n<e.length;n+=2)t[e[n]]=e[n+1];return t}},!0)}(),function(){var t={},e=/{([^}]+)}/g,n=/([\\'])/g,i=/\n/g,o=/\r/g;CKEDITOR.template=function(r){if(t[r])this.output=t[r];else{var s=r.replace(n,"\\$1").replace(i,"\\n").replace(o,"\\r").replace(e,function(t,e){return"',data['"+e+"']==undefined?'{"+e+"}':data['"+e+"'],'"});this.output=t[r]=Function("data","buffer","return buffer?buffer.push('"+s+"'):['"+s+"'].join('');")}}}(),delete CKEDITOR.loadFullCore,CKEDITOR.instances={},CKEDITOR.document=new CKEDITOR.dom.document(document),CKEDITOR.add=function(t){CKEDITOR.instances[t.name]=t,t.on("focus",function(){CKEDITOR.currentInstance!=t&&(CKEDITOR.currentInstance=t,CKEDITOR.fire("currentInstance"))}),t.on("blur",function(){CKEDITOR.currentInstance==t&&(CKEDITOR.currentInstance=null,CKEDITOR.fire("currentInstance"))}),CKEDITOR.fire("instance",null,t)},CKEDITOR.remove=function(t){delete CKEDITOR.instances[t.name]},function(){var t={};CKEDITOR.addTemplate=function(e,n){var i=t[e];return i?i:(i={name:e,source:n},CKEDITOR.fire("template",i),t[e]=new CKEDITOR.template(i.source))},CKEDITOR.getTemplate=function(e){return t[e]}}(),function(){var t=[];CKEDITOR.addCss=function(e){t.push(e)},CKEDITOR.getCss=function(){return t.join("\n")}}(),CKEDITOR.on("instanceDestroyed",function(){CKEDITOR.tools.isEmpty(this.instances)&&CKEDITOR.fire("reset")}),CKEDITOR.TRISTATE_ON=1,CKEDITOR.TRISTATE_OFF=2,CKEDITOR.TRISTATE_DISABLED=0,function(){CKEDITOR.inline=function(t,e){if(!CKEDITOR.env.isCompatible)return null;if(t=CKEDITOR.dom.element.get(t),t.getEditor())throw'The editor instance "'+t.getEditor().name+'" is already attached to the provided element.';var n=new CKEDITOR.editor(e,t,CKEDITOR.ELEMENT_MODE_INLINE),i=t.is("textarea")?t:null;return i?(n.setData(i.getValue(),null,!0),t=CKEDITOR.dom.element.createFromHtml('<div contenteditable="'+!!n.readOnly+'" class="cke_textarea_inline">'+i.getValue()+"</div>",CKEDITOR.document),t.insertAfter(i),i.hide(),i.$.form&&n._attachToForm()):n.setData(t.getHtml(),null,!0),n.on("loaded",function(){n.fire("uiReady"),n.editable(t),n.container=t,n.setData(n.getData(1)),n.resetDirty(),n.fire("contentDom"),n.mode="wysiwyg",n.fire("mode"),n.status="ready",n.fireOnce("instanceReady"),CKEDITOR.fire("instanceReady",null,n)},null,null,1e4),n.on("destroy",function(){i&&(n.container.clearCustomData(),n.container.remove(),i.show()),n.element.clearCustomData(),delete n.element}),n},CKEDITOR.inlineAll=function(){var t,e,n;for(n in CKEDITOR.dtd.$editable)for(var i=CKEDITOR.document.getElementsByTag(n),o=0,r=i.count();r>o;o++)t=i.getItem(o),"true"==t.getAttribute("contenteditable")&&(e={element:t,config:{}},CKEDITOR.fire("inline",e)!==!1&&CKEDITOR.inline(t,e.config))},CKEDITOR.domReady(function(){!CKEDITOR.disableAutoInline&&CKEDITOR.inlineAll()})}(),CKEDITOR.replaceClass="ckeditor",function(){function t(t,i,o,r){if(!CKEDITOR.env.isCompatible)return null;if(t=CKEDITOR.dom.element.get(t),t.getEditor())throw'The editor instance "'+t.getEditor().name+'" is already attached to the provided element.';var s=new CKEDITOR.editor(i,t,r);return r==CKEDITOR.ELEMENT_MODE_REPLACE&&(t.setStyle("visibility","hidden"),s._.required=t.hasAttribute("required"),t.removeAttribute("required")),o&&s.setData(o,null,!0),s.on("loaded",function(){n(s),r==CKEDITOR.ELEMENT_MODE_REPLACE&&s.config.autoUpdateElement&&t.$.form&&s._attachToForm(),s.setMode(s.config.startupMode,function(){s.resetDirty(),s.status="ready",s.fireOnce("instanceReady"),CKEDITOR.fire("instanceReady",null,s)})}),s.on("destroy",e),s}function e(){var t=this.container,e=this.element;t&&(t.clearCustomData(),t.remove()),e&&(e.clearCustomData(),this.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE&&(e.show(),this._.required&&e.setAttribute("required","required")),delete this.element)}function n(t){var e=t.name,n=t.element,o=t.elementMode,r=t.fire("uiSpace",{space:"top",html:""}).html,s=t.fire("uiSpace",{space:"bottom",html:""}).html;i||(i=CKEDITOR.addTemplate("maincontainer",'<{outerEl} id="cke_{name}" class="{id} cke cke_reset cke_chrome cke_editor_{name} cke_{langDir} '+CKEDITOR.env.cssClass+'"  dir="{langDir}" lang="{langCode}" role="application" aria-labelledby="cke_{name}_arialbl"><span id="cke_{name}_arialbl" class="cke_voice_label">{voiceLabel}</span><{outerEl} class="cke_inner cke_reset" role="presentation">{topHtml}<{outerEl} id="{contentId}" class="cke_contents cke_reset" role="presentation"></{outerEl}>{bottomHtml}</{outerEl}></{outerEl}>')),e=CKEDITOR.dom.element.createFromHtml(i.output({id:t.id,name:e,langDir:t.lang.dir,langCode:t.langCode,voiceLabel:[t.lang.editor,t.name].join(", "),topHtml:r?'<span id="'+t.ui.spaceId("top")+'" class="cke_top cke_reset_all" role="presentation" style="height:auto">'+r+"</span>":"",contentId:t.ui.spaceId("contents"),bottomHtml:s?'<span id="'+t.ui.spaceId("bottom")+'" class="cke_bottom cke_reset_all" role="presentation">'+s+"</span>":"",outerEl:CKEDITOR.env.ie?"span":"div"})),o==CKEDITOR.ELEMENT_MODE_REPLACE?(n.hide(),e.insertAfter(n)):n.append(e),t.container=e,r&&t.ui.space("top").unselectable(),s&&t.ui.space("bottom").unselectable(),n=t.config.width,o=t.config.height,n&&e.setStyle("width",CKEDITOR.tools.cssLength(n)),o&&t.ui.space("contents").setStyle("height",CKEDITOR.tools.cssLength(o)),e.disableContextMenu(),CKEDITOR.env.webkit&&e.on("focus",function(){t.focus()}),t.fireOnce("uiReady")}CKEDITOR.replace=function(e,n){return t(e,n,null,CKEDITOR.ELEMENT_MODE_REPLACE)},CKEDITOR.appendTo=function(e,n,i){return t(e,n,i,CKEDITOR.ELEMENT_MODE_APPENDTO)},CKEDITOR.replaceAll=function(){for(var t=document.getElementsByTagName("textarea"),e=0;e<t.length;e++){var n=null,i=t[e];if(i.name||i.id){if("string"==typeof arguments[0]){if(!RegExp("(?:^|\\s)"+arguments[0]+"(?:$|\\s)").test(i.className))continue}else if("function"==typeof arguments[0]&&(n={},arguments[0](i,n)===!1))continue;this.replace(i,n)}}},CKEDITOR.editor.prototype.addMode=function(t,e){(this._.modes||(this._.modes={}))[t]=e},CKEDITOR.editor.prototype.setMode=function(t,e){var n=this,i=this._.modes;if(t!=n.mode&&i&&i[t]){if(n.fire("beforeSetMode",t),n.mode){var o=n.checkDirty();n._.previousMode=n.mode,n.fire("beforeModeUnload"),n.editable(0),n.ui.space("contents").setHtml(""),n.mode=""}this._.modes[t](function(){n.mode=t,void 0!==o&&!o&&n.resetDirty(),setTimeout(function(){n.fire("mode"),e&&e.call(n)},0)})}},CKEDITOR.editor.prototype.resize=function(t,e,n,i){var o=this.container,r=this.ui.space("contents"),s=CKEDITOR.env.webkit&&this.document&&this.document.getWindow().$.frameElement,i=i?o.getChild(1):o;i.setSize("width",t,!0),s&&(s.style.width="1%"),r.setStyle("height",Math.max(e-(n?0:(i.$.offsetHeight||0)-(r.$.clientHeight||0)),0)+"px"),s&&(s.style.width="100%"),this.fire("resize")},CKEDITOR.editor.prototype.getResizable=function(t){return t?this.ui.space("contents"):this.container};var i;CKEDITOR.domReady(function(){CKEDITOR.replaceClass&&CKEDITOR.replaceAll(CKEDITOR.replaceClass)})}(),CKEDITOR.config.startupMode="wysiwyg",function(){function t(t){var n,o=t.editor,r=t.data.path,s=r.blockLimit,l=t.data.selection,a=l.getRanges()[0];(CKEDITOR.env.gecko||CKEDITOR.env.ie&&CKEDITOR.env.needsBrFiller)&&(l=e(l,r))&&(l.appendBogus(),n=CKEDITOR.env.ie),o.config.autoParagraph!==!1&&o.activeEnterMode!=CKEDITOR.ENTER_BR&&o.editable().equals(s)&&!r.block&&a.collapsed&&!a.getCommonAncestor().isReadOnly()&&(r=a.clone(),r.enlarge(CKEDITOR.ENLARGE_BLOCK_CONTENTS),s=new CKEDITOR.dom.walker(r),s.guard=function(t){return!i(t)||t.type==CKEDITOR.NODE_COMMENT||t.isReadOnly()},(!s.checkForward()||r.checkStartOfBlock()&&r.checkEndOfBlock())&&(o=a.fixBlock(!0,o.activeEnterMode==CKEDITOR.ENTER_DIV?"div":"p"),CKEDITOR.env.needsBrFiller||(o=o.getFirst(i))&&o.type==CKEDITOR.NODE_TEXT&&CKEDITOR.tools.trim(o.getText()).match(/^(?:&nbsp;|\xa0)$/)&&o.remove(),n=1,t.cancel())),n&&a.select()}function e(t,e){if(t.isFake)return 0;var n=e.block||e.blockLimit,o=n&&n.getLast(i);return!n||!n.isBlockBoundary()||o&&o.type==CKEDITOR.NODE_ELEMENT&&o.isBlockBoundary()||n.is("pre")||n.getBogus()?void 0:n}function n(t){var e=t.data.getTarget();e.is("input")&&(e=e.getAttribute("type"),("submit"==e||"reset"==e)&&t.data.preventDefault())}function i(t){return d(t)&&u(t)}function o(t,e){return function(n){var i=CKEDITOR.dom.element.get(n.data.$.toElement||n.data.$.fromElement||n.data.$.relatedTarget);(!i||!e.equals(i)&&!e.contains(i))&&t.call(this,n)}}function r(t){var e,n=t.getRanges()[0],o=t.root,r={table:1,ul:1,ol:1,dl:1};if(n.startPath().contains(r)){var t=function(t){return function(n,o){return o&&n.type==CKEDITOR.NODE_ELEMENT&&n.is(r)&&(e=n),o||!i(n)||t&&a(n)?void 0:!1}},s=n.clone();if(s.collapse(1),s.setStartAt(o,CKEDITOR.POSITION_AFTER_START),o=new CKEDITOR.dom.walker(s),o.guard=t(),o.checkBackward(),e)return s=n.clone(),s.collapse(),s.setEndAt(e,CKEDITOR.POSITION_AFTER_END),o=new CKEDITOR.dom.walker(s),o.guard=t(!0),e=!1,o.checkForward(),e}return null}function s(t){t.editor.focus(),t.editor.fire("saveSnapshot")}function l(t,e){var n=t.editor;!e&&n.getSelection().scrollIntoView(),setTimeout(function(){n.fire("saveSnapshot")},0)}CKEDITOR.editable=CKEDITOR.tools.createClass({base:CKEDITOR.dom.element,$:function(t,e){this.base(e.$||e),this.editor=t,this.hasFocus=!1,this.setup()},proto:{focus:function(){var t;if(CKEDITOR.env.webkit&&!this.hasFocus&&(t=this.editor._.previousActive||this.getDocument().getActive(),this.contains(t)))return t.focus(),void 0;try{this.$[CKEDITOR.env.ie&&this.getDocument().equals(CKEDITOR.document)?"setActive":"focus"]()}catch(e){if(!CKEDITOR.env.ie)throw e}CKEDITOR.env.safari&&!this.isInline()&&(t=CKEDITOR.document.getActive(),t.equals(this.getWindow().getFrame())||this.getWindow().focus())},on:function(t,e){var n=Array.prototype.slice.call(arguments,0);return CKEDITOR.env.ie&&/^focus|blur$/.exec(t)&&(t="focus"==t?"focusin":"focusout",e=o(e,this),n[0]=t,n[1]=e),CKEDITOR.dom.element.prototype.on.apply(this,n)},attachListener:function(t){!this._.listeners&&(this._.listeners=[]);var e=Array.prototype.slice.call(arguments,1),e=t.on.apply(t,e);return this._.listeners.push(e),e},clearListeners:function(){var t=this._.listeners;try{for(;t.length;)t.pop().removeListener()}catch(e){}},restoreAttrs:function(){var t,e,n=this._.attrChanges;for(e in n)n.hasOwnProperty(e)&&(t=n[e],null!==t?this.setAttribute(e,t):this.removeAttribute(e))},attachClass:function(t){var e=this.getCustomData("classes");this.hasClass(t)||(!e&&(e=[]),e.push(t),this.setCustomData("classes",e),this.addClass(t))},changeAttr:function(t,e){var n=this.getAttribute(t);e!==n&&(!this._.attrChanges&&(this._.attrChanges={}),t in this._.attrChanges||(this._.attrChanges[t]=n),this.setAttribute(t,e))},insertHtml:function(t,e){s(this),c(this,e||"html",t)},insertText:function(t){s(this);var e=this.editor,n=e.getSelection().getStartElement().hasAscendant("pre",!0)?CKEDITOR.ENTER_BR:e.activeEnterMode,e=n==CKEDITOR.ENTER_BR,i=CKEDITOR.tools,t=i.htmlEncode(t.replace(/\r\n/g,"\n")),t=t.replace(/\t/g,"&nbsp;&nbsp; &nbsp;"),n=n==CKEDITOR.ENTER_P?"p":"div";if(!e){var o=/\n{2}/g;if(o.test(t))var r="<"+n+">",l="</"+n+">",t=r+t.replace(o,function(){return l+r})+l}t=t.replace(/\n/g,"<br>"),e||(t=t.replace(RegExp("<br>(?=</"+n+">)"),function(t){return i.repeat(t,2)})),t=t.replace(/^ | $/g,"&nbsp;"),t=t.replace(/(>|\s) /g,function(t,e){return e+"&nbsp;"}).replace(/ (?=<)/g,"&nbsp;"),c(this,"text",t)},insertElement:function(t,e){e?this.insertElementIntoRange(t,e):this.insertElementIntoSelection(t)},insertElementIntoRange:function(t,e){var n=this.editor,i=n.config.enterMode,o=t.getName(),r=CKEDITOR.dtd.$block[o];if(e.checkReadOnly())return!1;e.deleteContents(1),e.startContainer.type==CKEDITOR.NODE_ELEMENT&&e.startContainer.is({tr:1,table:1,tbody:1,thead:1,tfoot:1})&&p(e);var s,l;if(r)for(;(s=e.getCommonAncestor(0,1))&&(l=CKEDITOR.dtd[s.getName()])&&(!l||!l[o]);)s.getName()in CKEDITOR.dtd.span?e.splitElement(s):e.checkStartOfBlock()&&e.checkEndOfBlock()?(e.setStartBefore(s),e.collapse(!0),s.remove()):e.splitBlock(i==CKEDITOR.ENTER_DIV?"div":"p",n.editable());return e.insertNode(t),!0},insertElementIntoSelection:function(t){var e=this.editor,n=e.activeEnterMode,e=e.getSelection(),o=e.getRanges()[0],r=t.getName(),r=CKEDITOR.dtd.$block[r];s(this),this.insertElementIntoRange(t,o)&&(o.moveToPosition(t,CKEDITOR.POSITION_AFTER_END),r&&((r=t.getNext(function(t){return i(t)&&!a(t)}))&&r.type==CKEDITOR.NODE_ELEMENT&&r.is(CKEDITOR.dtd.$block)?r.getDtd()["#"]?o.moveToElementEditStart(r):o.moveToElementEditEnd(t):r||n==CKEDITOR.ENTER_BR||(r=o.fixBlock(!0,n==CKEDITOR.ENTER_DIV?"div":"p"),o.moveToElementEditStart(r)))),e.selectRanges([o]),l(this,CKEDITOR.env.opera)},setData:function(t,e){e||(t=this.editor.dataProcessor.toHtml(t)),this.setHtml(t),this.editor.fire("dataReady")},getData:function(t){var e=this.getHtml();return t||(e=this.editor.dataProcessor.toDataFormat(e)),e},setReadOnly:function(t){this.setAttribute("contenteditable",!t)},detach:function(){this.removeClass("cke_editable");var t=this.editor;this._.detach(),delete t.document,delete t.window},isInline:function(){return this.getDocument().equals(CKEDITOR.document)},setup:function(){var t=this.editor;if(this.attachListener(t,"beforeGetData",function(){var e=this.getData();this.is("textarea")||t.config.ignoreEmptyParagraph!==!1&&(e=e.replace(h,function(t,e){return e})),t.setData(e,null,1)},this),this.attachListener(t,"getSnapshot",function(t){t.data=this.getData(1)},this),this.attachListener(t,"afterSetData",function(){this.setData(t.getData(1))},this),this.attachListener(t,"loadSnapshot",function(t){this.setData(t.data,1)},this),this.attachListener(t,"beforeFocus",function(){var e=t.getSelection();(e=e&&e.getNative())&&"Control"==e.type||this.focus()},this),this.attachListener(t,"insertHtml",function(t){this.insertHtml(t.data.dataValue,t.data.mode)},this),this.attachListener(t,"insertElement",function(t){this.insertElement(t.data)},this),this.attachListener(t,"insertText",function(t){this.insertText(t.data)},this),this.setReadOnly(t.readOnly),this.attachClass("cke_editable"),this.attachClass(t.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?"cke_editable_inline":t.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE||t.elementMode==CKEDITOR.ELEMENT_MODE_APPENDTO?"cke_editable_themed":""),this.attachClass("cke_contents_"+t.config.contentsLangDirection),t.keystrokeHandler.blockedKeystrokes[8]=+t.readOnly,t.keystrokeHandler.attach(this),this.on("blur",function(t){CKEDITOR.env.opera&&CKEDITOR.document.getActive().equals(this.isInline()?this:this.getWindow().getFrame())?t.cancel():this.hasFocus=!1},null,null,-1),this.on("focus",function(){this.hasFocus=!0},null,null,-1),t.focusManager.add(this),this.equals(CKEDITOR.document.getActive())&&(this.hasFocus=!0,t.once("contentDom",function(){t.focusManager.focus()})),this.isInline()&&this.changeAttr("tabindex",t.tabIndex),!this.is("textarea")){t.document=this.getDocument(),t.window=this.getWindow();var e=t.document;this.changeAttr("spellcheck",!t.config.disableNativeSpellChecker);var o=t.config.contentsLangDirection;this.getDirection(1)!=o&&this.changeAttr("dir",o);var s=CKEDITOR.getCss();s&&(o=e.getHead(),o.getCustomData("stylesheet")||(s=e.appendStyleText(s),s=new CKEDITOR.dom.element(s.ownerNode||s.owningElement),o.setCustomData("stylesheet",s),s.data("cke-temp",1))),o=e.getCustomData("stylesheet_ref")||0,e.setCustomData("stylesheet_ref",o+1),this.setCustomData("cke_includeReadonly",!t.config.disableReadonlyStyling),this.attachListener(this,"click",function(t){var t=t.data,e=new CKEDITOR.dom.elementPath(t.getTarget(),this).contains("a");e&&2!=t.$.button&&e.isReadOnly()&&t.preventDefault()});var l={8:1,46:1};this.attachListener(t,"key",function(e){if(t.readOnly)return!0;var n,i=e.data.keyCode;if(i in l){var o,s,a,h,e=t.getSelection(),u=e.getRanges()[0],c=u.startPath(),i=8==i;CKEDITOR.env.ie&&CKEDITOR.env.version<11&&(o=e.getSelectedElement())||(o=r(e))?(t.fire("saveSnapshot"),u.moveToPosition(o,CKEDITOR.POSITION_BEFORE_START),o.remove(),u.select(),t.fire("saveSnapshot"),n=1):u.collapsed&&((s=c.block)&&(h=s[i?"getPrevious":"getNext"](d))&&h.type==CKEDITOR.NODE_ELEMENT&&h.is("table")&&u[i?"checkStartOfBlock":"checkEndOfBlock"]()?(t.fire("saveSnapshot"),u[i?"checkEndOfBlock":"checkStartOfBlock"]()&&s.remove(),u["moveToElementEdit"+(i?"End":"Start")](h),u.select(),t.fire("saveSnapshot"),n=1):c.blockLimit&&c.blockLimit.is("td")&&(a=c.blockLimit.getAscendant("table"))&&u.checkBoundaryOfElement(a,i?CKEDITOR.START:CKEDITOR.END)&&(h=a[i?"getPrevious":"getNext"](d))?(t.fire("saveSnapshot"),u["moveToElementEdit"+(i?"End":"Start")](h),u.checkStartOfBlock()&&u.checkEndOfBlock()?h.remove():u.select(),t.fire("saveSnapshot"),n=1):(a=c.contains(["td","th","caption"]))&&u.checkBoundaryOfElement(a,i?CKEDITOR.START:CKEDITOR.END)&&(n=1))}return!n}),t.blockless&&CKEDITOR.env.ie&&CKEDITOR.env.needsBrFiller&&this.attachListener(this,"keyup",function(e){e.data.getKeystroke()in l&&!this.getFirst(i)&&(this.appendBogus(),e=t.createRange(),e.moveToPosition(this,CKEDITOR.POSITION_AFTER_START),e.select())}),this.attachListener(this,"dblclick",function(e){return t.readOnly?!1:(e={element:e.data.getTarget()},t.fire("doubleclick",e),void 0)}),CKEDITOR.env.ie&&this.attachListener(this,"click",n),!CKEDITOR.env.ie&&!CKEDITOR.env.opera&&this.attachListener(this,"mousedown",function(e){var n=e.data.getTarget();n.is("img","hr","input","textarea","select")&&(t.getSelection().selectElement(n),n.is("input","textarea","select")&&e.data.preventDefault())}),CKEDITOR.env.gecko&&this.attachListener(this,"mouseup",function(e){if(2==e.data.$.button&&(e=e.data.getTarget(),!e.getOuterHtml().replace(h,""))){var n=t.createRange();n.moveToElementEditStart(e),n.select(!0)}}),CKEDITOR.env.webkit&&(this.attachListener(this,"click",function(t){t.data.getTarget().is("input","select")&&t.data.preventDefault()}),this.attachListener(this,"mouseup",function(t){t.data.getTarget().is("input","textarea")&&t.data.preventDefault()}))}}},_:{detach:function(){this.editor.setData(this.editor.getData(),0,1),this.clearListeners(),this.restoreAttrs();var t;if(t=this.removeCustomData("classes"))for(;t.length;)this.removeClass(t.pop());t=this.getDocument();var e=t.getHead();if(e.getCustomData("stylesheet")){var n=t.getCustomData("stylesheet_ref");--n?t.setCustomData("stylesheet_ref",n):(t.removeCustomData("stylesheet_ref"),e.removeCustomData("stylesheet").remove())}this.editor.fire("contentDomUnload"),delete this.editor}}}),CKEDITOR.editor.prototype.editable=function(t){var e=this._.editable;return e&&t?0:(arguments.length&&(e=this._.editable=t?t instanceof CKEDITOR.editable?t:new CKEDITOR.editable(this,t):(e&&e.detach(),null)),e)};var a=CKEDITOR.dom.walker.bogus(),h=/(^|<body\b[^>]*>)\s*<(p|div|address|h\d|center|pre)[^>]*>\s*(?:<br[^>]*>|&nbsp;|\u00A0|&#160;)?\s*(:?<\/\2>)?\s*(?=$|<\/body>)/gi,d=CKEDITOR.dom.walker.whitespaces(!0),u=CKEDITOR.dom.walker.bookmark(!1,!0);CKEDITOR.on("instanceLoaded",function(e){var n=e.editor;n.on("insertElement",function(t){t=t.data,t.type==CKEDITOR.NODE_ELEMENT&&(t.is("input")||t.is("textarea"))&&("false"!=t.getAttribute("contentEditable")&&t.data("cke-editable",t.hasAttribute("contenteditable")?"true":"1"),t.setAttribute("contentEditable",!1))}),n.on("selectionChange",function(e){if(!n.readOnly){var i=n.getSelection();i&&!i.isLocked&&(i=n.checkDirty(),n.fire("lockSnapshot"),t(e),n.fire("unlockSnapshot"),!i&&n.resetDirty())}})}),CKEDITOR.on("instanceCreated",function(t){var e=t.editor;e.on("mode",function(){var t=e.editable();if(t&&t.isInline()){var n=e.title;if(t.changeAttr("role","textbox"),t.changeAttr("aria-label",n),n&&t.changeAttr("title",n),n=this.ui.space(this.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?"top":"contents")){var i=CKEDITOR.tools.getNextId(),o=CKEDITOR.dom.element.createFromHtml('<span id="'+i+'" class="cke_voice_label">'+this.lang.common.editorHelp+"</span>");n.append(o),t.changeAttr("aria-describedby",i)}}})}),CKEDITOR.addCss(".cke_editable{cursor:text}.cke_editable img,.cke_editable input,.cke_editable textarea{cursor:default}");var c=function(){function t(t){return t.type==CKEDITOR.NODE_ELEMENT}function e(n,i){var o,r,s,l,h=[],d=i.range.startContainer;o=i.range.startPath();for(var d=a[d.getName()],u=0,c=n.getChildren(),p=c.count(),m=-1,g=-1,f=0,x=o.contains(a.$list);p>u;++u)o=c.getItem(u),t(o)?(s=o.getName(),x&&s in CKEDITOR.dtd.$list?h=h.concat(e(o,i)):(l=!!d[s],"br"!=s||!o.data("cke-eol")||u&&u!=p-1||(f=(r=u?h[u-1].node:c.getItem(u+1))&&(!t(r)||!r.is("br")),r=r&&t(r)&&a.$block[r.getName()]),-1==m&&!l&&(m=u),l||(g=u),h.push({isElement:1,isLineBreak:f,isBlock:o.isBlockBoundary(),hasBlockSibling:r,node:o,name:s,allowed:l}),r=f=0)):h.push({isElement:0,node:o,allowed:1});return m>-1&&(h[m].firstNotAllowed=1),g>-1&&(h[g].lastNotAllowed=1),h}function n(e,i){var o,r=[],s=e.getChildren(),l=s.count(),h=0,d=a[i],u=!e.is(a.$inline)||e.is("br");for(u&&r.push(" ");l>h;h++)o=s.getItem(h),t(o)&&!o.is(d)?r=r.concat(n(o,i)):r.push(o);return u&&r.push(" "),r}function o(e){return e&&t(e)&&(e.is(a.$removeEmpty)||e.is("a")&&!e.isBlockBoundary())}function r(e,n,i,o){var s,l,a=e.clone();a.setEndAt(n,CKEDITOR.POSITION_BEFORE_END),(s=new CKEDITOR.dom.walker(a).next())&&t(s)&&h[s.getName()]&&(l=s.getPrevious())&&t(l)&&!l.getParent().equals(e.startContainer)&&i.contains(l)&&o.contains(s)&&s.isIdentical(l)&&(s.moveChildren(l),s.remove(),r(e,n,i,o))}function s(e,n){function i(e,n){return n.isBlock&&n.isElement&&!n.node.is("br")&&t(e)&&e.is("br")?(e.remove(),1):void 0}var o=n.endContainer.getChild(n.endOffset),r=n.endContainer.getChild(n.endOffset-1);o&&i(o,e[e.length-1]),r&&i(r,e[0])&&(n.setEnd(n.endContainer,n.endOffset-1),n.collapse())}var a=CKEDITOR.dtd,h={p:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,ul:1,ol:1,li:1,pre:1,dl:1,blockquote:1},d={p:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1},u=CKEDITOR.tools.extend({},a.$inline);return delete u.br,function(h,c,p){var m=h.editor;h.getDocument();var g=m.getSelection().getRanges()[0],f=!1;if("unfiltered_html"==c&&(c="html",f=!0),!g.checkReadOnly()){var x,C,E,y,v=new CKEDITOR.dom.elementPath(g.startContainer,g.root).blockLimit||g.root,c={type:c,dontFilter:f,editable:h,editor:m,range:g,blockLimit:v,mergeCandidates:[],zombies:[]},m=c.range,f=c.mergeCandidates;if("text"==c.type&&m.shrink(CKEDITOR.SHRINK_ELEMENT,!0,!1)&&(x=CKEDITOR.dom.element.createFromHtml("<span>&nbsp;</span>",m.document),m.insertNode(x),m.setStartAfter(x)),C=new CKEDITOR.dom.elementPath(m.startContainer),c.endPath=E=new CKEDITOR.dom.elementPath(m.endContainer),!m.collapsed){var v=E.block||E.blockLimit,T=m.getCommonAncestor();v&&!v.equals(T)&&!v.contains(T)&&m.checkEndOfBlock()&&c.zombies.push(v),m.deleteContents()}for(;(y=t(m.startContainer)&&m.startContainer.getChild(m.startOffset-1))&&t(y)&&y.isBlockBoundary()&&C.contains(y);)m.moveToPosition(y,CKEDITOR.POSITION_BEFORE_END);for(r(m,c.blockLimit,C,E),x&&(m.setEndBefore(x),m.collapse(),x.remove()),x=m.startPath(),(v=x.contains(o,!1,1))&&(m.splitElement(v),c.inlineStylesRoot=v,c.inlineStylesPeak=x.lastElement),x=m.createBookmark(),(v=x.startNode.getPrevious(i))&&t(v)&&o(v)&&f.push(v),(v=x.startNode.getNext(i))&&t(v)&&o(v)&&f.push(v),v=x.startNode;(v=v.getParent())&&o(v);)f.push(v);if(m.moveToBookmark(x),x=p){if(x=c.range,"text"==c.type&&c.inlineStylesRoot){for(y=c.inlineStylesPeak,m=y.getDocument().createText("{cke-peak}"),f=c.inlineStylesRoot.getParent();!y.equals(f);)m=m.appendTo(y.clone()),y=y.getParent();p=m.getOuterHtml().split("{cke-peak}").join(p)}if(y=c.blockLimit.getName(),/^\s+|\s+$/.test(p)&&"span"in CKEDITOR.dtd[y])var b='<span data-cke-marker="1">&nbsp;</span>',p=b+p+b;if(p=c.editor.dataProcessor.toHtml(p,{context:null,fixForBody:!1,dontFilter:c.dontFilter,filter:c.editor.activeFilter,enterMode:c.editor.activeEnterMode}),y=x.document.createElement("body"),y.setHtml(p),b&&(y.getFirst().remove(),y.getLast().remove()),(b=x.startPath().block)&&(1!=b.getChildCount()||!b.getBogus()))t:{var I;if(1==y.getChildCount()&&t(I=y.getFirst())&&I.is(d)){for(b=I.getElementsByTag("*"),x=0,f=b.count();f>x;x++)if(m=b.getItem(x),!m.is(u))break t;I.moveChildren(I.getParent(1)),I.remove()}}c.dataWrapper=y,x=p}if(x){I=c.range;var S,b=I.document,p=c.blockLimit;x=0;var O;y=[];var R,w,D,_,f=m=0;C=I.startContainer;var A,v=c.endPath.elements[0];for(E=v.getPosition(C),T=!(!v.getCommonAncestor(C)||E==CKEDITOR.POSITION_IDENTICAL||E&CKEDITOR.POSITION_CONTAINS+CKEDITOR.POSITION_IS_CONTAINED),C=e(c.dataWrapper,c),s(C,I);x<C.length;x++){if(E=C[x],S=E.isLineBreak){S=I,D=p;var L=void 0,k=void 0;E.hasBlockSibling?S=1:(L=S.startContainer.getAscendant(a.$block,1),L&&L.is({div:1,p:1})?(k=L.getPosition(D),k==CKEDITOR.POSITION_IDENTICAL||k==CKEDITOR.POSITION_CONTAINS?S=0:(D=S.splitElement(L),S.moveToPosition(D,CKEDITOR.POSITION_AFTER_START),S=1)):S=0)}if(S)f=x>0;else{if(S=I.startPath(),!E.isBlock&&c.editor.config.autoParagraph!==!1&&c.editor.activeEnterMode!=CKEDITOR.ENTER_BR&&c.editor.editable().equals(S.blockLimit)&&!S.block&&(w=c.editor.activeEnterMode!=CKEDITOR.ENTER_BR&&c.editor.config.autoParagraph!==!1?c.editor.activeEnterMode==CKEDITOR.ENTER_DIV?"div":"p":!1)&&(w=b.createElement(w),w.appendBogus(),I.insertNode(w),CKEDITOR.env.needsBrFiller&&(O=w.getBogus())&&O.remove(),I.moveToPosition(w,CKEDITOR.POSITION_BEFORE_END)),(S=I.startPath().block)&&!S.equals(R)&&((O=S.getBogus())&&(O.remove(),y.push(S)),R=S),E.firstNotAllowed&&(m=1),m&&E.isElement){for(S=I.startContainer,D=null;S&&!a[S.getName()][E.name];){if(S.equals(p)){S=null;
break}D=S,S=S.getParent()}if(S)D&&(_=I.splitElement(D),c.zombies.push(_),c.zombies.push(D));else{D=p.getName(),A=!x,S=x==C.length-1,D=n(E.node,D);for(var L=[],k=D.length,N=0,P=void 0,M=0,K=-1;k>N;N++)P=D[N]," "==P?(M||A&&!N||(L.push(new CKEDITOR.dom.text(" ")),K=L.length),M=1):(L.push(P),M=0);S&&K==L.length&&L.pop(),A=L}}if(A){for(;S=A.pop();)I.insertNode(S);A=0}else I.insertNode(E.node);E.lastNotAllowed&&x<C.length-1&&((_=T?v:_)&&I.setEndAt(_,CKEDITOR.POSITION_AFTER_START),m=0),I.collapse()}}c.dontMoveCaret=f,c.bogusNeededBlocks=y}O=c.range;var H;for(_=c.bogusNeededBlocks,A=O.createBookmark();R=c.zombies.pop();)R.getParent()&&(w=O.clone(),w.moveToElementEditStart(R),w.removeEmptyBlocksAtEnd());if(_)for(;R=_.pop();)CKEDITOR.env.needsBrFiller?R.appendBogus():R.append(O.document.createText(""));for(;R=c.mergeCandidates.pop();)R.mergeSiblings();if(O.moveToBookmark(A),!c.dontMoveCaret){for(R=t(O.startContainer)&&O.startContainer.getChild(O.startOffset-1);R&&t(R)&&!R.is(a.$empty);){if(R.isBlockBoundary())O.moveToPosition(R,CKEDITOR.POSITION_BEFORE_END);else{if(o(R)&&R.getHtml().match(/(\s|&nbsp;)$/g)){H=null;break}H=O.clone(),H.moveToPosition(R,CKEDITOR.POSITION_BEFORE_END)}R=R.getLast(i)}H&&O.moveToRange(H)}g.select(),l(h)}}}(),p=function(){function t(t){return t=new CKEDITOR.dom.walker(t),t.guard=function(t,e){return e?!1:t.type==CKEDITOR.NODE_ELEMENT?t.is(CKEDITOR.dtd.$tableContent):void 0},t.evaluator=function(t){return t.type==CKEDITOR.NODE_ELEMENT},t}function e(t,e,n){return e=t.getDocument().createElement(e),t.append(e,n),e}function n(t){var e,n=t.count();for(n;n-->0;)e=t.getItem(n),CKEDITOR.tools.trim(e.getHtml())||(e.appendBogus(),CKEDITOR.env.ie&&CKEDITOR.env.version<9&&e.getChildCount()&&e.getFirst().remove())}return function(i){var o=i.startContainer,r=o.getAscendant("table",1),s=!1;n(r.getElementsByTag("td")),n(r.getElementsByTag("th")),r=i.clone(),r.setStart(o,0),r=t(r).lastBackward(),r||(r=i.clone(),r.setEndAt(o,CKEDITOR.POSITION_BEFORE_END),r=t(r).lastForward(),s=!0),r||(r=o),r.is("table")?(i.setStartAt(r,CKEDITOR.POSITION_BEFORE_START),i.collapse(!0),r.remove()):(r.is({tbody:1,thead:1,tfoot:1})&&(r=e(r,"tr",s)),r.is("tr")&&(r=e(r,r.getParent().is("thead")?"th":"td",s)),(o=r.getBogus())&&o.remove(),i.moveToPosition(r,s?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_BEFORE_END))}}()}(),function(){function t(){var t,e=this._.fakeSelection;e&&(t=this.getSelection(1),t&&t.isHidden()||(e.reset(),e=0)),(e||(e=t||this.getSelection(1),e&&e.getType()!=CKEDITOR.SELECTION_NONE))&&(this.fire("selectionCheck",e),t=this.elementPath(),t.compare(this._.selectionPreviousPath)||(CKEDITOR.env.webkit&&(this._.previousActive=this.document.getActive()),this._.selectionPreviousPath=t,this.fire("selectionChange",{selection:e,path:t})))}function e(){u=!0,d||(n.call(this),d=CKEDITOR.tools.setTimeout(n,200,this))}function n(){d=null,u&&(CKEDITOR.tools.setTimeout(t,0,this),u=!1)}function i(t){function e(e,n){return e&&e.type!=CKEDITOR.NODE_TEXT?t.clone()["moveToElementEdit"+(n?"End":"Start")](e):!1}if(!(t.root instanceof CKEDITOR.editable))return!1;var n=t.startContainer,i=t.getPreviousNode(c,null,n),o=t.getNextNode(c,null,n);return!e(i)&&!e(o,1)&&(i||o||n.type==CKEDITOR.NODE_ELEMENT&&n.isBlockBoundary()&&n.getBogus())?!1:!0}function o(t){return t.getCustomData("cke-fillingChar")}function r(t,e){var n=t&&t.removeCustomData("cke-fillingChar");if(n){if(e!==!1){var i,o=t.getDocument().getSelection().getNative(),r=o&&"None"!=o.type&&o.getRangeAt(0);if(n.getLength()>1&&r&&r.intersectsNode(n.$)){i=[o.anchorOffset,o.focusOffset],r=o.focusNode==n.$&&o.focusOffset>0,o.anchorNode==n.$&&o.anchorOffset>0&&i[0]--,r&&i[1]--;var l;r=o,r.isCollapsed||(l=r.getRangeAt(0),l.setStart(r.anchorNode,r.anchorOffset),l.setEnd(r.focusNode,r.focusOffset),l=l.collapsed),l&&i.unshift(i.pop())}}n.setText(s(n.getText())),i&&(n=o.getRangeAt(0),n.setStart(n.startContainer,i[0]),n.setEnd(n.startContainer,i[1]),o.removeAllRanges(),o.addRange(n))}}function s(t){return t.replace(/\u200B( )?/g,function(t){return t[1]?"":""})}function l(t,e,n){var i=t.on("focus",function(t){t.cancel()},null,null,-100);if(CKEDITOR.env.ie)var o=t.getDocument().on("selectionchange",function(t){t.cancel()},null,null,-100);else{var r=new CKEDITOR.dom.range(t);r.moveToElementEditStart(t);var s=t.getDocument().$.createRange();s.setStart(r.startContainer.$,r.startOffset),s.collapse(1),e.removeAllRanges(),e.addRange(s)}n&&t.focus(),i.removeListener(),o&&o.removeListener()}function a(t){var e=CKEDITOR.dom.element.createFromHtml('<div data-cke-hidden-sel="1" data-cke-temp="1" style="'+(CKEDITOR.env.ie?"display:none":"position:fixed;top:0;left:-1000px")+'">&nbsp;</div>',t.document);t.fire("lockSnapshot"),t.editable().append(e);var n=t.getSelection(),i=t.createRange(),o=n.root.on("selectionchange",function(t){t.cancel()},null,null,0);i.setStartAt(e,CKEDITOR.POSITION_AFTER_START),i.setEndAt(e,CKEDITOR.POSITION_BEFORE_END),n.selectRanges([i]),o.removeListener(),t.fire("unlockSnapshot"),t._.hiddenSelectionContainer=e}function h(t){var e={37:1,39:1,8:1,46:1};return function(n){var i=n.data.getKeystroke();if(e[i]){var o=t.getSelection().getRanges(),r=o[0];1==o.length&&r.collapsed&&(i=r[38>i?"getPreviousEditableNode":"getNextEditableNode"]())&&i.type==CKEDITOR.NODE_ELEMENT&&"false"==i.getAttribute("contenteditable")&&(t.getSelection().fake(i),n.data.preventDefault(),n.cancel())}}}var d,u,c=CKEDITOR.dom.walker.invisible(1),p=function(){function t(t){return function(e){var n=e.editor.createRange();return n.moveToClosestEditablePosition(e.selected,t)&&e.editor.getSelection().selectRanges([n]),!1}}function e(t){return function(e){var n,i=e.editor,o=i.createRange();return(n=o.moveToClosestEditablePosition(e.selected,t))||(n=o.moveToClosestEditablePosition(e.selected,!t)),n&&i.getSelection().selectRanges([o]),i.fire("saveSnapshot"),e.selected.remove(),n||(o.moveToElementEditablePosition(i.editable()),i.getSelection().selectRanges([o])),i.fire("saveSnapshot"),!1}}var n=t(),i=t(1);return{37:n,38:n,39:i,40:i,8:e(),46:e(1)}}();CKEDITOR.on("instanceCreated",function(n){function i(){var t=o.getSelection();t&&t.removeAllRanges()}var o=n.editor;o.on("contentDom",function(){var n,i,s=o.document,l=CKEDITOR.document,a=o.editable(),d=s.getBody(),u=s.getDocumentElement(),c=a.isInline();if(CKEDITOR.env.gecko&&a.attachListener(a,"focus",function(t){t.removeListener(),0!==n&&(t=o.getSelection().getNative())&&t.isCollapsed&&t.anchorNode==a.$&&(t=o.createRange(),t.moveToElementEditStart(a),t.select())},null,null,-2),a.attachListener(a,CKEDITOR.env.webkit?"DOMFocusIn":"focus",function(){n&&CKEDITOR.env.webkit&&(n=o._.previousActive&&o._.previousActive.equals(s.getActive())),o.unlockSelection(n),n=0},null,null,-1),a.attachListener(a,"mousedown",function(){n=0}),CKEDITOR.env.ie||CKEDITOR.env.opera||c){var p=function(){i=new CKEDITOR.dom.selection(o.getSelection()),i.lock()};m?a.attachListener(a,"beforedeactivate",p,null,null,-1):a.attachListener(o,"selectionCheck",p,null,null,-1),a.attachListener(a,CKEDITOR.env.webkit?"DOMFocusOut":"blur",function(){o.lockSelection(i),n=1},null,null,-1),a.attachListener(a,"mousedown",function(){n=0})}if(CKEDITOR.env.ie&&!c){var g;if(a.attachListener(a,"mousedown",function(t){2==t.data.$.button&&(t=o.document.getSelection(),t&&t.getType()!=CKEDITOR.SELECTION_NONE||(g=o.window.getScrollPosition()))}),a.attachListener(a,"mouseup",function(t){2==t.data.$.button&&g&&(o.document.$.documentElement.scrollLeft=g.x,o.document.$.documentElement.scrollTop=g.y),g=null}),"BackCompat"!=s.$.compatMode&&((CKEDITOR.env.ie7Compat||CKEDITOR.env.ie6Compat)&&u.on("mousedown",function(t){function e(t){if(t=t.data.$,i){var e=d.$.createTextRange();try{e.moveToPoint(t.x,t.y)}catch(n){}i.setEndPoint(r.compareEndPoints("StartToStart",e)<0?"EndToEnd":"StartToStart",e),i.select()}}function n(){u.removeListener("mousemove",e),l.removeListener("mouseup",n),u.removeListener("mouseup",n),i.select()}if(t=t.data,t.getTarget().is("html")&&t.$.y<u.$.clientHeight&&t.$.x<u.$.clientWidth){var i=d.$.createTextRange();try{i.moveToPoint(t.$.x,t.$.y)}catch(o){}var r=i.duplicate();u.on("mousemove",e),l.on("mouseup",n),u.on("mouseup",n)}}),CKEDITOR.env.version>7&&CKEDITOR.env.version<11)){u.on("mousedown",function(t){t.data.getTarget().is("html")&&(l.on("mouseup",f),u.on("mouseup",f))});var f=function(){l.removeListener("mouseup",f),u.removeListener("mouseup",f);var t=CKEDITOR.document.$.selection,e=t.createRange();"None"!=t.type&&e.parentElement().ownerDocument==s.$&&e.select()}}}if(a.attachListener(a,"selectionchange",t,o),a.attachListener(a,"keyup",e,o),a.attachListener(a,CKEDITOR.env.webkit?"DOMFocusIn":"focus",function(){o.forceNextSelectionCheck(),o.selectionChange(1)}),c?CKEDITOR.env.webkit||CKEDITOR.env.gecko:CKEDITOR.env.opera){var x;a.attachListener(a,"mousedown",function(){x=1}),a.attachListener(s.getDocumentElement(),"mouseup",function(){x&&e.call(o),x=0})}else a.attachListener(CKEDITOR.env.ie?a:s.getDocumentElement(),"mouseup",e,o);CKEDITOR.env.webkit&&a.attachListener(s,"keydown",function(t){switch(t.data.getKey()){case 13:case 33:case 34:case 35:case 36:case 37:case 39:case 8:case 45:case 46:r(a)}},null,null,-1),a.attachListener(a,"keydown",h(o),null,null,-1)}),o.on("contentDomUnload",o.forceNextSelectionCheck,o),o.on("dataReady",function(){delete o._.fakeSelection,delete o._.hiddenSelectionContainer,o.selectionChange(1)}),o.on("loadSnapshot",function(){var t=o.editable().getLast(function(t){return t.type==CKEDITOR.NODE_ELEMENT});t&&t.hasAttribute("data-cke-hidden-sel")&&t.remove()},null,null,100),CKEDITOR.env.ie9Compat&&o.on("beforeDestroy",i,null,null,9),CKEDITOR.env.webkit&&o.on("setData",i),o.on("contentDomUnload",function(){o.unlockSelection()}),o.on("key",function(t){if("wysiwyg"==o.mode){var e=o.getSelection();if(e.isFake){var n=p[t.data.keyCode];if(n)return n({editor:o,selected:e.getSelectedElement(),selection:e,keyEvent:t})}}})}),CKEDITOR.on("instanceReady",function(t){var e=t.editor;if(CKEDITOR.env.webkit){e.on("selectionChange",function(){var t=e.editable(),n=o(t);n&&(n.getCustomData("ready")?r(t):n.setCustomData("ready",1))},null,null,-1),e.on("beforeSetMode",function(){r(e.editable())},null,null,-1);var n,i,t=function(){var t=e.editable();if(t&&(t=o(t))){var r=e.document.$.defaultView.getSelection();"Caret"==r.type&&r.anchorNode==t.$&&(i=1),n=t.getText(),t.setText(s(n))}},l=function(){var t=e.editable();t&&(t=o(t))&&(t.setText(n),i&&(e.document.$.defaultView.getSelection().setPosition(t.$,t.getLength()),i=0))};e.on("beforeUndoImage",t),e.on("afterUndoImage",l),e.on("beforeGetData",t,null,null,0),e.on("getData",l)}}),CKEDITOR.editor.prototype.selectionChange=function(n){(n?t:e).call(this)},CKEDITOR.editor.prototype.getSelection=function(t){return!this._.savedSelection&&!this._.fakeSelection||t?(t=this.editable())&&"wysiwyg"==this.mode?new CKEDITOR.dom.selection(t):null:this._.savedSelection||this._.fakeSelection},CKEDITOR.editor.prototype.lockSelection=function(t){return t=t||this.getSelection(1),t.getType()!=CKEDITOR.SELECTION_NONE?(!t.isLocked&&t.lock(),this._.savedSelection=t,!0):!1},CKEDITOR.editor.prototype.unlockSelection=function(t){var e=this._.savedSelection;return e?(e.unlock(t),delete this._.savedSelection,!0):!1},CKEDITOR.editor.prototype.forceNextSelectionCheck=function(){delete this._.selectionPreviousPath},CKEDITOR.dom.document.prototype.getSelection=function(){return new CKEDITOR.dom.selection(this)},CKEDITOR.dom.range.prototype.select=function(){var t=this.root instanceof CKEDITOR.editable?this.root.editor.getSelection():new CKEDITOR.dom.selection(this.root);return t.selectRanges([this]),t},CKEDITOR.SELECTION_NONE=1,CKEDITOR.SELECTION_TEXT=2,CKEDITOR.SELECTION_ELEMENT=3;var m="function"!=typeof window.getSelection,g=1;CKEDITOR.dom.selection=function(t){if(t instanceof CKEDITOR.dom.selection)var e=t,t=t.root;var n=t instanceof CKEDITOR.dom.element;if(this.rev=e?e.rev:g++,this.document=t instanceof CKEDITOR.dom.document?t:t.getDocument(),this.root=t=n?t:this.document.getBody(),this.isLocked=0,this._={cache:{}},e)return CKEDITOR.tools.extend(this._.cache,e._.cache),this.isFake=e.isFake,this.isLocked=e.isLocked,this;if(e=m?this.document.$.selection:this.document.getWindow().$.getSelection(),CKEDITOR.env.webkit)("None"==e.type&&this.document.getActive().equals(t)||"Caret"==e.type&&e.anchorNode.nodeType==CKEDITOR.NODE_DOCUMENT)&&l(t,e);else if(CKEDITOR.env.gecko)e&&this.document.getActive().equals(t)&&e.anchorNode&&e.anchorNode.nodeType==CKEDITOR.NODE_DOCUMENT&&l(t,e,!0);else if(CKEDITOR.env.ie){var i;try{i=this.document.getActive()}catch(o){}m?"None"==e.type&&i&&i.equals(this.document.getDocumentElement())&&l(t,null,!0):((e=e&&e.anchorNode)&&(e=new CKEDITOR.dom.node(e)),i&&i.equals(this.document.getDocumentElement())&&e&&(t.equals(e)||t.contains(e))&&l(t,null,!0))}i=this.getNative();var r,s;if(i)if(i.getRangeAt)r=(s=i.rangeCount&&i.getRangeAt(0))&&new CKEDITOR.dom.node(s.commonAncestorContainer);else{try{s=i.createRange()}catch(a){}r=s&&CKEDITOR.dom.element.get(s.item&&s.item(0)||s.parentElement())}return(!r||r.type!=CKEDITOR.NODE_ELEMENT&&r.type!=CKEDITOR.NODE_TEXT||!this.root.equals(r)&&!this.root.contains(r))&&(this._.cache.type=CKEDITOR.SELECTION_NONE,this._.cache.startElement=null,this._.cache.selectedElement=null,this._.cache.selectedText="",this._.cache.ranges=new CKEDITOR.dom.rangeList),this};var f={img:1,hr:1,li:1,table:1,tr:1,td:1,th:1,embed:1,object:1,ol:1,ul:1,a:1,input:1,form:1,select:1,textarea:1,button:1,fieldset:1,thead:1,tfoot:1};CKEDITOR.dom.selection.prototype={getNative:function(){return void 0!==this._.cache.nativeSel?this._.cache.nativeSel:this._.cache.nativeSel=m?this.document.$.selection:this.document.getWindow().$.getSelection()},getType:m?function(){var t=this._.cache;if(t.type)return t.type;var e=CKEDITOR.SELECTION_NONE;try{var n=this.getNative(),i=n.type;"Text"==i&&(e=CKEDITOR.SELECTION_TEXT),"Control"==i&&(e=CKEDITOR.SELECTION_ELEMENT),n.createRange().parentElement()&&(e=CKEDITOR.SELECTION_TEXT)}catch(o){}return t.type=e}:function(){var t=this._.cache;if(t.type)return t.type;var e=CKEDITOR.SELECTION_TEXT,n=this.getNative();if(n&&n.rangeCount){if(1==n.rangeCount){var n=n.getRangeAt(0),i=n.startContainer;i==n.endContainer&&1==i.nodeType&&n.endOffset-n.startOffset==1&&f[i.childNodes[n.startOffset].nodeName.toLowerCase()]&&(e=CKEDITOR.SELECTION_ELEMENT)}}else e=CKEDITOR.SELECTION_NONE;return t.type=e},getRanges:function(){var t=m?function(){function t(t){return new CKEDITOR.dom.node(t).getIndex()}var e=function(e,n){e=e.duplicate(),e.collapse(n);var i=e.parentElement();if(!i.hasChildNodes())return{container:i,offset:0};for(var o,r,s,l,a=i.children,h=e.duplicate(),d=0,u=a.length-1,c=-1;u>=d;)if(c=Math.floor((d+u)/2),o=a[c],h.moveToElementText(o),s=h.compareEndPoints("StartToStart",e),s>0)u=c-1;else{if(!(0>s))return{container:i,offset:t(o)};d=c+1}if(-1==c||c==a.length-1&&0>s){if(h.moveToElementText(i),h.setEndPoint("StartToStart",e),h=h.text.replace(/(\r\n|\r)/g,"\n").length,a=i.childNodes,!h)return o=a[a.length-1],o.nodeType!=CKEDITOR.NODE_TEXT?{container:i,offset:a.length}:{container:o,offset:o.nodeValue.length};for(i=a.length;h>0&&i>0;)r=a[--i],r.nodeType==CKEDITOR.NODE_TEXT&&(l=r,h-=r.nodeValue.length);return{container:l,offset:-h}}if(h.collapse(s>0?!0:!1),h.setEndPoint(s>0?"StartToStart":"EndToStart",e),h=h.text.replace(/(\r\n|\r)/g,"\n").length,!h)return{container:i,offset:t(o)+(s>0?0:1)};for(;h>0;)try{r=o[s>0?"previousSibling":"nextSibling"],r.nodeType==CKEDITOR.NODE_TEXT&&(h-=r.nodeValue.length,l=r),o=r}catch(p){return{container:i,offset:t(o)}}return{container:l,offset:s>0?-h:l.nodeValue.length+h}};return function(){var t=this.getNative(),n=t&&t.createRange(),i=this.getType();if(!t)return[];if(i==CKEDITOR.SELECTION_TEXT)return t=new CKEDITOR.dom.range(this.root),i=e(n,!0),t.setStart(new CKEDITOR.dom.node(i.container),i.offset),i=e(n),t.setEnd(new CKEDITOR.dom.node(i.container),i.offset),t.endContainer.getPosition(t.startContainer)&CKEDITOR.POSITION_PRECEDING&&t.endOffset<=t.startContainer.getIndex()&&t.collapse(),[t];if(i==CKEDITOR.SELECTION_ELEMENT){for(var i=[],o=0;o<n.length;o++){for(var r=n.item(o),s=r.parentNode,l=0,t=new CKEDITOR.dom.range(this.root);l<s.childNodes.length&&s.childNodes[l]!=r;l++);t.setStart(new CKEDITOR.dom.node(s),l),t.setEnd(new CKEDITOR.dom.node(s),l+1),i.push(t)}return i}return[]}}():function(){var t,e=[],n=this.getNative();if(!n)return e;for(var i=0;i<n.rangeCount;i++){var o=n.getRangeAt(i);t=new CKEDITOR.dom.range(this.root),t.setStart(new CKEDITOR.dom.node(o.startContainer),o.startOffset),t.setEnd(new CKEDITOR.dom.node(o.endContainer),o.endOffset),e.push(t)}return e};return function(e){var n=this._.cache;if(n.ranges&&!e)return n.ranges;if(n.ranges||(n.ranges=new CKEDITOR.dom.rangeList(t.call(this))),e)for(var i=n.ranges,o=0;o<i.length;o++){var r=i[o];if(r.getCommonAncestor().isReadOnly()&&i.splice(o,1),!r.collapsed){if(r.startContainer.isReadOnly())for(var s,e=r.startContainer;e&&!((s=e.type==CKEDITOR.NODE_ELEMENT)&&e.is("body")||!e.isReadOnly());)s&&"false"==e.getAttribute("contentEditable")&&r.setStartAfter(e),e=e.getParent();e=r.startContainer,s=r.endContainer;var l=r.startOffset,a=r.endOffset,h=r.clone();e&&e.type==CKEDITOR.NODE_TEXT&&(l>=e.getLength()?h.setStartAfter(e):h.setStartBefore(e)),s&&s.type==CKEDITOR.NODE_TEXT&&(a?h.setEndAfter(s):h.setEndBefore(s)),e=new CKEDITOR.dom.walker(h),e.evaluator=function(t){if(t.type==CKEDITOR.NODE_ELEMENT&&t.isReadOnly()){var e=r.clone();return r.setEndBefore(t),r.collapsed&&i.splice(o--,1),t.getPosition(h.endContainer)&CKEDITOR.POSITION_CONTAINS||(e.setStartAfter(t),e.collapsed||i.splice(o+1,0,e)),!0}return!1},e.next()}}return n.ranges}}(),getStartElement:function(){var t=this._.cache;if(void 0!==t.startElement)return t.startElement;var e;switch(this.getType()){case CKEDITOR.SELECTION_ELEMENT:return this.getSelectedElement();case CKEDITOR.SELECTION_TEXT:var n=this.getRanges()[0];if(n){if(n.collapsed)e=n.startContainer,e.type!=CKEDITOR.NODE_ELEMENT&&(e=e.getParent());else{for(n.optimize();e=n.startContainer,n.startOffset==(e.getChildCount?e.getChildCount():e.getLength())&&!e.isBlockBoundary();)n.setStartAfter(e);if(e=n.startContainer,e.type!=CKEDITOR.NODE_ELEMENT)return e.getParent();if(e=e.getChild(n.startOffset),e&&e.type==CKEDITOR.NODE_ELEMENT)for(n=e.getFirst();n&&n.type==CKEDITOR.NODE_ELEMENT;)e=n,n=n.getFirst();else e=n.startContainer}e=e.$}}return t.startElement=e?new CKEDITOR.dom.element(e):null},getSelectedElement:function(){var t=this._.cache;if(void 0!==t.selectedElement)return t.selectedElement;var e=this,n=CKEDITOR.tools.tryThese(function(){return e.getNative().createRange().item(0)},function(){for(var t,n,i=e.getRanges()[0].clone(),o=2;!(!o||(t=i.getEnclosedNode())&&t.type==CKEDITOR.NODE_ELEMENT&&f[t.getName()]&&(n=t));o--)i.shrink(CKEDITOR.SHRINK_ELEMENT);return n&&n.$});return t.selectedElement=n?new CKEDITOR.dom.element(n):null},getSelectedText:function(){var t=this._.cache;if(void 0!==t.selectedText)return t.selectedText;var e=this.getNative(),e=m?"Control"==e.type?"":e.createRange().text:e.toString();return t.selectedText=e},lock:function(){this.getRanges(),this.getStartElement(),this.getSelectedElement(),this.getSelectedText(),this._.cache.nativeSel=null,this.isLocked=1},unlock:function(t){if(this.isLocked){if(t)var e=this.getSelectedElement(),n=!e&&this.getRanges(),i=this.isFake;this.isLocked=0,this.reset(),t&&(t=e||n[0]&&n[0].getCommonAncestor())&&t.getAscendant("body",1)&&(i?this.fake(e):e?this.selectElement(e):this.selectRanges(n))}},reset:function(){this._.cache={},this.isFake=0;var t=this.root.editor;if(t&&t._.fakeSelection&&this.rev==t._.fakeSelection.rev){delete t._.fakeSelection;var e=t._.hiddenSelectionContainer;e&&(t.fire("lockSnapshot"),e.remove(),t.fire("unlockSnapshot")),delete t._.hiddenSelectionContainer}this.rev=g++},selectElement:function(t){var e=new CKEDITOR.dom.range(this.root);e.setStartBefore(t),e.setEndAfter(t),this.selectRanges([e])},selectRanges:function(t){var e=this.root.editor,e=e&&e._.hiddenSelectionContainer;if(this.reset(),e)for(var n,e=this.root,o=0;o<t.length;++o)n=t[o],n.endContainer.equals(e)&&(n.endOffset=Math.min(n.endOffset,e.getChildCount()));if(t.length)if(this.isLocked){var s=CKEDITOR.document.getActive();this.unlock(),this.selectRanges(t),this.lock(),!s.equals(this.root)&&s.focus()}else{var l,a,h;if((1!=t.length||(h=t[0]).collapsed||!(l=h.getEnclosedNode())||l.type!=CKEDITOR.NODE_ELEMENT||(h=h.clone(),h.shrink(CKEDITOR.SHRINK_ELEMENT,!0),(a=h.getEnclosedNode())&&a.type==CKEDITOR.NODE_ELEMENT&&(l=a),"false"!=l.getAttribute("contenteditable")))&&(l=void 0),l)this.fake(l);else{if(m){h=CKEDITOR.dom.walker.whitespaces(!0),a=/\ufeff|\u00a0/,e={table:1,tbody:1,tr:1},t.length>1&&(l=t[t.length-1],t[0].setEnd(l.endContainer,l.endOffset)),l=t[0];var d,u,c,t=l.collapsed;if((n=l.getEnclosedNode())&&n.type==CKEDITOR.NODE_ELEMENT&&n.getName()in f&&(!n.is("a")||!n.getText()))try{return c=n.$.createControlRange(),c.addElement(n.$),c.select(),void 0}catch(p){}(l.startContainer.type==CKEDITOR.NODE_ELEMENT&&l.startContainer.getName()in e||l.endContainer.type==CKEDITOR.NODE_ELEMENT&&l.endContainer.getName()in e)&&l.shrink(CKEDITOR.NODE_ELEMENT,!0),c=l.createBookmark(),e=c.startNode,t||(s=c.endNode),c=l.document.$.body.createTextRange(),c.moveToElementText(e.$),c.moveStart("character",1),s?(a=l.document.$.body.createTextRange(),a.moveToElementText(s.$),c.setEndPoint("EndToEnd",a),c.moveEnd("character",-1)):(d=e.getNext(h),u=e.hasAscendant("pre"),d=!(d&&d.getText&&d.getText().match(a))&&(u||!e.hasPrevious()||e.getPrevious().is&&e.getPrevious().is("br")),u=l.document.createElement("span"),u.setHtml("&#65279;"),u.insertBefore(e),d&&l.document.createText("").insertBefore(e)),l.setStartBefore(e),e.remove(),t?(d?(c.moveStart("character",-1),c.select(),l.document.$.selection.clear()):c.select(),l.moveToPosition(u,CKEDITOR.POSITION_BEFORE_START),u.remove()):(l.setEndBefore(s),s.remove(),c.select())}else{if(s=this.getNative(),!s)return;for(CKEDITOR.env.opera&&(c=this.document.$.createRange(),c.selectNodeContents(this.root.$),s.addRange(c)),this.removeAllRanges(),c=0;c<t.length;c++)if(c<t.length-1&&(l=t[c],d=t[c+1],a=l.clone(),a.setStart(l.endContainer,l.endOffset),a.setEnd(d.startContainer,d.startOffset),!a.collapsed&&(a.shrink(CKEDITOR.NODE_ELEMENT,!0),u=a.getCommonAncestor(),a=a.getEnclosedNode(),u.isReadOnly()||a&&a.isReadOnly())))d.setStart(l.startContainer,l.startOffset),t.splice(c--,1);else{l=t[c],u=this.document.$.createRange(),d=l.startContainer,CKEDITOR.env.opera&&l.collapsed&&d.type==CKEDITOR.NODE_ELEMENT&&(a=d.getChild(l.startOffset-1),h=d.getChild(l.startOffset),(!a&&!h&&d.is(CKEDITOR.dtd.$removeEmpty)||a&&a.type==CKEDITOR.NODE_ELEMENT||h&&h.type==CKEDITOR.NODE_ELEMENT)&&(l.insertNode(this.document.createText("")),l.collapse(1))),l.collapsed&&CKEDITOR.env.webkit&&i(l)&&(d=this.root,r(d,!1),a=d.getDocument().createText(""),d.setCustomData("cke-fillingChar",a),l.insertNode(a),(d=a.getNext())&&!a.getPrevious()&&d.type==CKEDITOR.NODE_ELEMENT&&"br"==d.getName()?(r(this.root),l.moveToPosition(d,CKEDITOR.POSITION_BEFORE_START)):l.moveToPosition(a,CKEDITOR.POSITION_AFTER_END)),u.setStart(l.startContainer.$,l.startOffset);try{u.setEnd(l.endContainer.$,l.endOffset)}catch(g){if(!(g.toString().indexOf("NS_ERROR_ILLEGAL_VALUE")>=0))throw g;l.collapse(1),u.setEnd(l.endContainer.$,l.endOffset)}s.addRange(u)}}this.reset(),this.root.fire("selectionchange")}}},fake:function(t){var e=this.root.editor;this.reset(),a(e);var n=this._.cache,i=new CKEDITOR.dom.range(this.root);i.setStartBefore(t),i.setEndAfter(t),n.ranges=new CKEDITOR.dom.rangeList(i),n.selectedElement=n.startElement=t,n.type=CKEDITOR.SELECTION_ELEMENT,n.selectedText=n.nativeSel=null,this.isFake=1,this.rev=g++,e._.fakeSelection=this,this.root.fire("selectionchange")},isHidden:function(){var t=this.getCommonAncestor();return t&&t.type==CKEDITOR.NODE_TEXT&&(t=t.getParent()),!(!t||!t.data("cke-hidden-sel"))},createBookmarks:function(t){return t=this.getRanges().createBookmarks(t),this.isFake&&(t.isFake=1),t},createBookmarks2:function(t){return t=this.getRanges().createBookmarks2(t),this.isFake&&(t.isFake=1),t},selectBookmarks:function(t){for(var e=[],n=0;n<t.length;n++){var i=new CKEDITOR.dom.range(this.root);i.moveToBookmark(t[n]),e.push(i)}return t.isFake?this.fake(e[0].getEnclosedNode()):this.selectRanges(e),this},getCommonAncestor:function(){var t=this.getRanges();return t.length?t[0].startContainer.getCommonAncestor(t[t.length-1].endContainer):null},scrollIntoView:function(){this.type!=CKEDITOR.SELECTION_NONE&&this.getRanges()[0].scrollIntoView()},removeAllRanges:function(){var t=this.getNative();try{t&&t[m?"empty":"removeAllRanges"]()}catch(e){}this.reset()}}}(),CKEDITOR.editor.prototype.attachStyleStateChange=function(t,e){var n=this._.styleStateChangeCallbacks;n||(n=this._.styleStateChangeCallbacks=[],this.on("selectionChange",function(t){for(var e=0;e<n.length;e++){var i=n[e],o=i.style.checkActive(t.data.path)?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF;i.fn.call(this,o)}})),n.push({style:t,fn:e})},CKEDITOR.STYLE_BLOCK=1,CKEDITOR.STYLE_INLINE=2,CKEDITOR.STYLE_OBJECT=3,function(){function t(t,e){for(var n,i;(t=t.getParent())&&!t.equals(e);)if(t.getAttribute("data-nostyle"))n=t;else if(!i){var o=t.getAttribute("contentEditable");"false"==o?n=t:"true"==o&&(i=1)}return n}function e(n){var o=n.document;if(n.collapsed)o=f(this,o),n.insertNode(o),n.moveToPosition(o,CKEDITOR.POSITION_BEFORE_END);else{var r,s=this.element,l=this._.definition,a=l.ignoreReadonly,h=a||l.includeReadonly;void 0==h&&(h=n.root.getCustomData("cke_includeReadonly"));var d=CKEDITOR.dtd[s];d||(r=!0,d=CKEDITOR.dtd.span),n.enlarge(CKEDITOR.ENLARGE_INLINE,1),n.trim();var u,c=n.createBookmark(),m=c.startNode,g=c.endNode,x=m;if(!a){var C=n.getCommonAncestor(),a=t(m,C),C=t(g,C);a&&(x=a.getNextSourceNode(!0)),C&&(g=C)}for(x.getPosition(g)==CKEDITOR.POSITION_FOLLOWING&&(x=0);x;){if(a=!1,x.equals(g))x=null,a=!0;else{var E=x.type==CKEDITOR.NODE_ELEMENT?x.getName():null,C=E&&"false"==x.getAttribute("contentEditable"),y=E&&x.getAttribute("data-nostyle");if(E&&x.data("cke-bookmark")){x=x.getNextSourceNode(!0);continue}if(C&&h&&CKEDITOR.dtd.$block[E])for(var v=x,T=i(v),b=void 0,I=T.length,S=0,v=I&&new CKEDITOR.dom.range(v.getDocument());I>S;++S){var b=T[S],R=CKEDITOR.filter.instances[b.data("cke-filter")];(R?R.check(this):1)&&(v.selectNodeContents(b),e.call(this,v))}if(T=E?!d[E]||y?0:C&&!h?0:(x.getPosition(g)|w)==w&&(!l.childRule||l.childRule(x)):1){if(!(T=x.getParent())||!(T.getDtd()||CKEDITOR.dtd.span)[s]&&!r||l.parentRule&&!l.parentRule(T))a=!0;else if(u||E&&CKEDITOR.dtd.$removeEmpty[E]&&(x.getPosition(g)|w)!=w||(u=n.clone(),u.setStartBefore(x)),E=x.type,E==CKEDITOR.NODE_TEXT||C||E==CKEDITOR.NODE_ELEMENT&&!x.getChildCount()){for(var _,E=x;(a=!E.getNext(O))&&(_=E.getParent(),d[_.getName()])&&(_.getPosition(m)|D)==D&&(!l.childRule||l.childRule(_));)E=_;u.setEndAfter(E)}}else a=!0;x=x.getNextSourceNode(y||C)}if(a&&u&&!u.collapsed){for(var A,L,k,a=f(this,o),C=a.hasAttributes(),y=u.getCommonAncestor(),E={},T={},b={},I={};a&&y;){if(y.getName()==s){for(A in l.attributes)!I[A]&&(k=y.getAttribute(L))&&(a.getAttribute(A)==k?T[A]=1:I[A]=1);for(L in l.styles)!b[L]&&(k=y.getStyle(L))&&(a.getStyle(L)==k?E[L]=1:b[L]=1)}y=y.getParent()}for(A in T)a.removeAttribute(A);for(L in E)a.removeStyle(L);C&&!a.hasAttributes()&&(a=null),a?(u.extractContents().appendTo(a),u.insertNode(a),p.call(this,a),a.mergeSiblings(),CKEDITOR.env.ie||a.$.normalize()):(a=new CKEDITOR.dom.element("span"),u.extractContents().appendTo(a),u.insertNode(a),p.call(this,a),a.remove(!0)),u=null}}n.moveToBookmark(c),n.shrink(CKEDITOR.SHRINK_TEXT),n.shrink(CKEDITOR.NODE_ELEMENT,!0)}}function n(t){function e(){for(var t=new CKEDITOR.dom.elementPath(i.getParent()),e=new CKEDITOR.dom.elementPath(h.getParent()),n=null,o=null,r=0;r<t.elements.length;r++){var s=t.elements[r];if(s==t.block||s==t.blockLimit)break;d.checkElementRemovable(s)&&(n=s)}for(r=0;r<e.elements.length&&(s=e.elements[r],s!=e.block&&s!=e.blockLimit);r++)d.checkElementRemovable(s)&&(o=s);o&&h.breakParent(o),n&&i.breakParent(n)}t.enlarge(CKEDITOR.ENLARGE_INLINE,1);var n=t.createBookmark(),i=n.startNode;if(t.collapsed){for(var o,r,s=new CKEDITOR.dom.elementPath(i.getParent(),t.root),l=0;l<s.elements.length&&(r=s.elements[l])&&(r!=s.block&&r!=s.blockLimit);l++)if(this.checkElementRemovable(r)){var a;t.collapsed&&(t.checkBoundaryOfElement(r,CKEDITOR.END)||(a=t.checkBoundaryOfElement(r,CKEDITOR.START)))?(o=r,o.match=a?"start":"end"):(r.mergeSiblings(),r.is(this.element)?c.call(this,r):m(r,E(this)[r.getName()]))}if(o){for(r=i,l=0;a=s.elements[l],!a.equals(o);l++)a.match||(a=a.clone(),a.append(r),r=a);r["start"==o.match?"insertBefore":"insertAfter"](o)}}else{var h=n.endNode,d=this;for(e(),s=i;!s.equals(h);)o=s.getNextSourceNode(),s.type==CKEDITOR.NODE_ELEMENT&&this.checkElementRemovable(s)&&(s.getName()==this.element?c.call(this,s):m(s,E(this)[s.getName()]),o.type==CKEDITOR.NODE_ELEMENT&&o.contains(i)&&(e(),o=i.getNext())),s=o}t.moveToBookmark(n),t.shrink(CKEDITOR.NODE_ELEMENT,!0)}function i(t){var e=[];return t.forEach(function(t){return"true"==t.getAttribute("contenteditable")?(e.push(t),!1):void 0},CKEDITOR.NODE_ELEMENT,!0),e}function o(t){var e=t.getEnclosedNode()||t.getCommonAncestor(!1,!0);(t=new CKEDITOR.dom.elementPath(e,t.root).contains(this.element,1))&&!t.isReadOnly()&&x(t,this)}function r(t){var e=t.getCommonAncestor(!0,!0);if(t=new CKEDITOR.dom.elementPath(e,t.root).contains(this.element,1)){var e=this._.definition,n=e.attributes;if(n)for(var i in n)t.removeAttribute(i,n[i]);if(e.styles)for(var o in e.styles)e.styles.hasOwnProperty(o)&&t.removeStyle(o)}}function s(t){var e=t.createBookmark(!0),n=t.createIterator();n.enforceRealBlocks=!0,this._.enterMode&&(n.enlargeBr=this._.enterMode!=CKEDITOR.ENTER_BR);for(var i,o,r=t.document;i=n.getNextParagraph();)!i.isReadOnly()&&(n.activeFilter?n.activeFilter.check(this):1)&&(o=f(this,r,i),a(i,o));t.moveToBookmark(e)}function l(t){var e=t.createBookmark(1),n=t.createIterator();n.enforceRealBlocks=!0,n.enlargeBr=this._.enterMode!=CKEDITOR.ENTER_BR;for(var i,o;i=n.getNextParagraph();)this.checkElementRemovable(i)&&(i.is("pre")?((o=this._.enterMode==CKEDITOR.ENTER_BR?null:t.document.createElement(this._.enterMode==CKEDITOR.ENTER_P?"p":"div"))&&i.copyAttributes(o),a(i,o)):c.call(this,i));t.moveToBookmark(e)}function a(t,e){var n=!e;n&&(e=t.getDocument().createElement("div"),t.copyAttributes(e));var i=e&&e.is("pre"),o=t.is("pre"),r=!i&&o;if(i&&!o){if(o=e,(r=t.getBogus())&&r.remove(),r=t.getHtml(),r=d(r,/(?:^[ \t\n\r]+)|(?:[ \t\n\r]+$)/g,""),r=r.replace(/[ \t\r\n]*(<br[^>]*>)[ \t\r\n]*/gi,"$1"),r=r.replace(/([ \t\n\r]+|&nbsp;)/g," "),r=r.replace(/<br\b[^>]*>/gi,"\n"),CKEDITOR.env.ie){var s=t.getDocument().createElement("div");s.append(o),o.$.outerHTML="<pre>"+r+"</pre>",o.copyAttributes(s.getFirst()),o=s.getFirst().remove()}else o.setHtml(r);e=o}else r?e=u(n?[t.getHtml()]:h(t),e):t.moveChildren(e);if(e.replace(t),i){var l,n=e;(l=n.getPrevious(R))&&l.type==CKEDITOR.NODE_ELEMENT&&l.is("pre")&&(i=d(l.getHtml(),/\n$/,"")+"\n\n"+d(n.getHtml(),/^\n/,""),CKEDITOR.env.ie?n.$.outerHTML="<pre>"+i+"</pre>":n.setHtml(i),l.remove())}else n&&g(e)}function h(t){t.getName();var e=[];return d(t.getOuterHtml(),/(\S\s*)\n(?:\s|(<span[^>]+data-cke-bookmark.*?\/span>))*\n(?!$)/gi,function(t,e,n){return e+"</pre>"+n+"<pre>"}).replace(/<pre\b.*?>([\s\S]*?)<\/pre>/gi,function(t,n){e.push(n)}),e}function d(t,e,n){var i="",o="",t=t.replace(/(^<span[^>]+data-cke-bookmark.*?\/span>)|(<span[^>]+data-cke-bookmark.*?\/span>$)/gi,function(t,e,n){return e&&(i=e),n&&(o=n),""});return i+t.replace(e,n)+o}function u(t,e){var n;t.length>1&&(n=new CKEDITOR.dom.documentFragment(e.getDocument()));for(var i=0;i<t.length;i++){var o=t[i],o=o.replace(/(\r\n|\r)/g,"\n"),o=d(o,/^[ \t]*\n/,""),o=d(o,/\n$/,""),o=d(o,/^[ \t]+|[ \t]+$/g,function(t,e){return 1==t.length?"&nbsp;":e?" "+CKEDITOR.tools.repeat("&nbsp;",t.length-1):CKEDITOR.tools.repeat("&nbsp;",t.length-1)+" "}),o=o.replace(/\n/g,"<br>"),o=o.replace(/[ \t]{2,}/g,function(t){return CKEDITOR.tools.repeat("&nbsp;",t.length-1)+" "});if(n){var r=e.clone();r.setHtml(o),n.append(r)}else e.setHtml(o)}return n||e}function c(t,e){var n,i=this._.definition,o=i.attributes,i=i.styles,r=E(this)[t.getName()],s=CKEDITOR.tools.isEmpty(o)&&CKEDITOR.tools.isEmpty(i);for(n in o)("class"==n||this._.definition.fullMatch)&&t.getAttribute(n)!=y(n,o[n])||e&&"data-"==n.slice(0,5)||(s=t.hasAttribute(n),t.removeAttribute(n));for(var l in i)this._.definition.fullMatch&&t.getStyle(l)!=y(l,i[l],!0)||(s=s||!!t.getStyle(l),t.removeStyle(l));m(t,r,T[t.getName()]),s&&(this._.definition.alwaysRemoveElement?g(t,1):!CKEDITOR.dtd.$block[t.getName()]||this._.enterMode==CKEDITOR.ENTER_BR&&!t.hasAttributes()?g(t):t.renameNode(this._.enterMode==CKEDITOR.ENTER_P?"p":"div"))
}function p(t){for(var e,n=E(this),i=t.getElementsByTag(this.element),o=i.count();--o>=0;)e=i.getItem(o),e.isReadOnly()||c.call(this,e,!0);for(var r in n)if(r!=this.element)for(i=t.getElementsByTag(r),o=i.count()-1;o>=0;o--)e=i.getItem(o),e.isReadOnly()||m(e,n[r])}function m(t,e,n){if(e=e&&e.attributes)for(var i=0;i<e.length;i++){var o,r=e[i][0];if(o=t.getAttribute(r)){var s=e[i][1];(null===s||s.test&&s.test(o)||"string"==typeof s&&o==s)&&t.removeAttribute(r)}}n||g(t)}function g(t,e){if(!t.hasAttributes()||e)if(CKEDITOR.dtd.$block[t.getName()]){var n=t.getPrevious(R),i=t.getNext(R);n&&(n.type==CKEDITOR.NODE_TEXT||!n.isBlockBoundary({br:1}))&&t.append("br",1),i&&(i.type==CKEDITOR.NODE_TEXT||!i.isBlockBoundary({br:1}))&&t.append("br"),t.remove(!0)}else n=t.getFirst(),i=t.getLast(),t.remove(!0),n&&(n.type==CKEDITOR.NODE_ELEMENT&&n.mergeSiblings(),i&&!n.equals(i)&&i.type==CKEDITOR.NODE_ELEMENT&&i.mergeSiblings())}function f(t,e,n){var i;return i=t.element,"*"==i&&(i="span"),i=new CKEDITOR.dom.element(i,e),n&&n.copyAttributes(i),i=x(i,t),e.getCustomData("doc_processing_style")&&i.hasAttribute("id")?i.removeAttribute("id"):e.setCustomData("doc_processing_style",1),i}function x(t,e){var n=e._.definition,i=n.attributes,n=CKEDITOR.style.getStyleText(n);if(i)for(var o in i)t.setAttribute(o,i[o]);return n&&t.setAttribute("style",n),t}function C(t,e){for(var n in t)t[n]=t[n].replace(S,function(t,n){return e[n]})}function E(t){if(t._.overrides)return t._.overrides;var e=t._.overrides={},n=t._.definition.overrides;if(n){CKEDITOR.tools.isArray(n)||(n=[n]);for(var i=0;i<n.length;i++){var o,r,s=n[i];if("string"==typeof s?o=s.toLowerCase():(o=s.element?s.element.toLowerCase():t.element,r=s.attributes),s=e[o]||(e[o]={}),r){var l,s=s.attributes=s.attributes||[];for(l in r)s.push([l.toLowerCase(),r[l]])}}}return e}function y(t,e,n){var i=new CKEDITOR.dom.element("span");return i[n?"setStyle":"setAttribute"](t,e),i[n?"getStyle":"getAttribute"](t)}function v(t,e){for(var n,i=t.document,o=t.getRanges(),r=e?this.removeFromRange:this.applyToRange,s=o.createIterator();n=s.getNextRange();)r.call(this,n);t.selectRanges(o),i.removeCustomData("doc_processing_style")}var T={address:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,p:1,pre:1,section:1,header:1,footer:1,nav:1,article:1,aside:1,figure:1,dialog:1,hgroup:1,time:1,meter:1,menu:1,command:1,keygen:1,output:1,progress:1,details:1,datagrid:1,datalist:1},b={a:1,embed:1,hr:1,img:1,li:1,object:1,ol:1,table:1,td:1,tr:1,th:1,ul:1,dl:1,dt:1,dd:1,form:1,audio:1,video:1},I=/\s*(?:;\s*|$)/,S=/#\((.+?)\)/g,O=CKEDITOR.dom.walker.bookmark(0,1),R=CKEDITOR.dom.walker.whitespaces(1);CKEDITOR.style=function(t,e){var n=t.attributes;n&&n.style&&(t.styles=CKEDITOR.tools.extend({},t.styles,CKEDITOR.tools.parseCssText(n.style)),delete n.style),e&&(t=CKEDITOR.tools.clone(t),C(t.attributes,e),C(t.styles,e)),n=this.element=t.element?"string"==typeof t.element?t.element.toLowerCase():t.element:"*",this.type=t.type||(T[n]?CKEDITOR.STYLE_BLOCK:b[n]?CKEDITOR.STYLE_OBJECT:CKEDITOR.STYLE_INLINE),"object"==typeof this.element&&(this.type=CKEDITOR.STYLE_OBJECT),this._={definition:t}},CKEDITOR.editor.prototype.applyStyle=function(t){t.checkApplicable(this.elementPath())&&v.call(t,this.getSelection())},CKEDITOR.editor.prototype.removeStyle=function(t){t.checkApplicable(this.elementPath())&&v.call(t,this.getSelection(),1)},CKEDITOR.style.prototype={apply:function(t){v.call(this,t.getSelection())},remove:function(t){v.call(this,t.getSelection(),1)},applyToRange:function(t){return(this.applyToRange=this.type==CKEDITOR.STYLE_INLINE?e:this.type==CKEDITOR.STYLE_BLOCK?s:this.type==CKEDITOR.STYLE_OBJECT?o:null).call(this,t)},removeFromRange:function(t){return(this.removeFromRange=this.type==CKEDITOR.STYLE_INLINE?n:this.type==CKEDITOR.STYLE_BLOCK?l:this.type==CKEDITOR.STYLE_OBJECT?r:null).call(this,t)},applyToObject:function(t){x(t,this)},checkActive:function(t){switch(this.type){case CKEDITOR.STYLE_BLOCK:return this.checkElementRemovable(t.block||t.blockLimit,!0);case CKEDITOR.STYLE_OBJECT:case CKEDITOR.STYLE_INLINE:for(var e,n=t.elements,i=0;i<n.length;i++)if(e=n[i],this.type!=CKEDITOR.STYLE_INLINE||e!=t.block&&e!=t.blockLimit){if(this.type==CKEDITOR.STYLE_OBJECT){var o=e.getName();if(!("string"==typeof this.element?o==this.element:o in this.element))continue}if(this.checkElementRemovable(e,!0))return!0}}return!1},checkApplicable:function(t,e){if(e&&!e.check(this))return!1;switch(this.type){case CKEDITOR.STYLE_OBJECT:return!!t.contains(this.element);case CKEDITOR.STYLE_BLOCK:return!!t.blockLimit.getDtd()[this.element]}return!0},checkElementMatch:function(t,e){var n=this._.definition;if(!t||!n.ignoreReadonly&&t.isReadOnly())return!1;var i=t.getName();if("string"==typeof this.element?i==this.element:i in this.element){if(!e&&!t.hasAttributes())return!0;if(i=n._AC)n=i;else{var i={},o=0,r=n.attributes;if(r)for(var s in r)o++,i[s]=r[s];(s=CKEDITOR.style.getStyleText(n))&&(i.style||o++,i.style=s),i._length=o,n=n._AC=i}if(!n._length)return!0;for(var l in n)if("_length"!=l){if(o=t.getAttribute(l)||"","style"==l)t:{i=n[l],"string"==typeof i&&(i=CKEDITOR.tools.parseCssText(i)),"string"==typeof o&&(o=CKEDITOR.tools.parseCssText(o,!0)),s=void 0;for(s in i)if(!(s in o)||o[s]!=i[s]&&"inherit"!=i[s]&&"inherit"!=o[s]){i=!1;break t}i=!0}else i=n[l]==o;if(i){if(!e)return!0}else if(e)return!1}if(e)return!0}return!1},checkElementRemovable:function(t,e){if(this.checkElementMatch(t,e))return!0;var n=E(this)[t.getName()];if(n){var i;if(!(n=n.attributes))return!0;for(var o=0;o<n.length;o++)if(i=n[o][0],i=t.getAttribute(i)){var r=n[o][1];if(null===r||"string"==typeof r&&i==r||r.test(i))return!0}}return!1},buildPreview:function(t){var e=this._.definition,n=[],i=e.element;"bdo"==i&&(i="span");var n=["<",i],o=e.attributes;if(o)for(var r in o)n.push(" ",r,'="',o[r],'"');return(o=CKEDITOR.style.getStyleText(e))&&n.push(' style="',o,'"'),n.push(">",t||e.name,"</",i,">"),n.join("")},getDefinition:function(){return this._.definition}},CKEDITOR.style.getStyleText=function(t){var e=t._ST;if(e)return e;var e=t.styles,n=t.attributes&&t.attributes.style||"",i="";n.length&&(n=n.replace(I,";"));for(var o in e){var r=e[o],s=(o+":"+r).replace(I,";");"inherit"==r?i+=s:n+=s}return n.length&&(n=CKEDITOR.tools.normalizeCssText(n,!0)),t._ST=n+i};var w=CKEDITOR.POSITION_PRECEDING|CKEDITOR.POSITION_IDENTICAL|CKEDITOR.POSITION_IS_CONTAINED,D=CKEDITOR.POSITION_FOLLOWING|CKEDITOR.POSITION_IDENTICAL|CKEDITOR.POSITION_IS_CONTAINED}(),CKEDITOR.styleCommand=function(t,e){this.requiredContent=this.allowedContent=this.style=t,CKEDITOR.tools.extend(this,e,!0)},CKEDITOR.styleCommand.prototype.exec=function(t){t.focus(),this.state==CKEDITOR.TRISTATE_OFF?t.applyStyle(this.style):this.state==CKEDITOR.TRISTATE_ON&&t.removeStyle(this.style)},CKEDITOR.stylesSet=new CKEDITOR.resourceManager("","stylesSet"),CKEDITOR.addStylesSet=CKEDITOR.tools.bind(CKEDITOR.stylesSet.add,CKEDITOR.stylesSet),CKEDITOR.loadStylesSet=function(t,e,n){CKEDITOR.stylesSet.addExternal(t,e,""),CKEDITOR.stylesSet.load(t,n)},CKEDITOR.editor.prototype.getStylesSet=function(t){if(this._.stylesDefinitions)t(this._.stylesDefinitions);else{var e=this,n=e.config.stylesCombo_stylesSet||e.config.stylesSet;if(n===!1)t(null);else if(n instanceof Array)e._.stylesDefinitions=n,t(n);else{n||(n="default");var n=n.split(":"),i=n[0];CKEDITOR.stylesSet.addExternal(i,n[1]?n.slice(1).join(":"):CKEDITOR.getUrl("styles.js"),""),CKEDITOR.stylesSet.load(i,function(n){e._.stylesDefinitions=n[i],t(e._.stylesDefinitions)})}}},CKEDITOR.dom.comment=function(t,e){"string"==typeof t&&(t=(e?e.$:document).createComment(t)),CKEDITOR.dom.domObject.call(this,t)},CKEDITOR.dom.comment.prototype=new CKEDITOR.dom.node,CKEDITOR.tools.extend(CKEDITOR.dom.comment.prototype,{type:CKEDITOR.NODE_COMMENT,getOuterHtml:function(){return"<!--"+this.$.nodeValue+"-->"}}),function(){var t,e={},n={};for(t in CKEDITOR.dtd.$blockLimit)t in CKEDITOR.dtd.$list||(e[t]=1);for(t in CKEDITOR.dtd.$block)t in CKEDITOR.dtd.$blockLimit||t in CKEDITOR.dtd.$empty||(n[t]=1);CKEDITOR.dom.elementPath=function(t,i){var o,r=null,s=null,l=[],a=t,i=i||t.getDocument().getBody();do if(a.type==CKEDITOR.NODE_ELEMENT){if(l.push(a),!this.lastElement&&(this.lastElement=a,a.is(CKEDITOR.dtd.$object)||"false"==a.getAttribute("contenteditable")))continue;if(a.equals(i))break;if(!s&&(o=a.getName(),"true"==a.getAttribute("contenteditable")?s=a:!r&&n[o]&&(r=a),e[o])){var h;if(h=!r){if(o="div"==o){t:{o=a.getChildren(),h=0;for(var d=o.count();d>h;h++){var u=o.getItem(h);if(u.type==CKEDITOR.NODE_ELEMENT&&CKEDITOR.dtd.$block[u.getName()]){o=!0;break t}}o=!1}o=!o}h=o}h?r=a:s=a}}while(a=a.getParent());s||(s=i),this.block=r,this.blockLimit=s,this.root=i,this.elements=l}}(),CKEDITOR.dom.elementPath.prototype={compare:function(t){var e=this.elements,t=t&&t.elements;if(!t||e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(!e[n].equals(t[n]))return!1;return!0},contains:function(t,e,n){var i;"string"==typeof t&&(i=function(e){return e.getName()==t}),t instanceof CKEDITOR.dom.element?i=function(e){return e.equals(t)}:CKEDITOR.tools.isArray(t)?i=function(e){return CKEDITOR.tools.indexOf(t,e.getName())>-1}:"function"==typeof t?i=t:"object"==typeof t&&(i=function(e){return e.getName()in t});var o=this.elements,r=o.length;for(e&&r--,n&&(o=Array.prototype.slice.call(o,0),o.reverse()),e=0;r>e;e++)if(i(o[e]))return o[e];return null},isContextFor:function(t){var e;return t in CKEDITOR.dtd.$block?(e=this.contains(CKEDITOR.dtd.$intermediate)||this.root.equals(this.block)&&this.block||this.blockLimit,!!e.getDtd()[t]):!0},direction:function(){return(this.block||this.blockLimit||this.root).getDirection(1)}},CKEDITOR.dom.text=function(t,e){"string"==typeof t&&(t=(e?e.$:document).createTextNode(t)),this.$=t},CKEDITOR.dom.text.prototype=new CKEDITOR.dom.node,CKEDITOR.tools.extend(CKEDITOR.dom.text.prototype,{type:CKEDITOR.NODE_TEXT,getLength:function(){return this.$.nodeValue.length},getText:function(){return this.$.nodeValue},setText:function(t){this.$.nodeValue=t},split:function(t){var e=this.$.parentNode,n=e.childNodes.length,i=this.getLength(),o=this.getDocument(),r=new CKEDITOR.dom.text(this.$.splitText(t),o);return e.childNodes.length==n&&(t>=i?(r=o.createText(""),r.insertAfter(this)):(t=o.createText(""),t.insertAfter(r),t.remove())),r},substring:function(t,e){return"number"!=typeof e?this.$.nodeValue.substr(t):this.$.nodeValue.substring(t,e)}}),function(){function t(t,e,n){var i=t.serializable,o=e[n?"endContainer":"startContainer"],r=n?"endOffset":"startOffset",s=i?e.document.getById(t.startNode):t.startNode,t=i?e.document.getById(t.endNode):t.endNode;return o.equals(s.getPrevious())?(e.startOffset=e.startOffset-o.getLength()-t.getPrevious().getLength(),o=t.getNext()):o.equals(t.getPrevious())&&(e.startOffset=e.startOffset-o.getLength(),o=t.getNext()),o.equals(s.getParent())&&e[r]++,o.equals(t.getParent())&&e[r]++,e[n?"endContainer":"startContainer"]=o,e}CKEDITOR.dom.rangeList=function(t){return t instanceof CKEDITOR.dom.rangeList?t:(t?t instanceof CKEDITOR.dom.range&&(t=[t]):t=[],CKEDITOR.tools.extend(t,e))};var e={createIterator:function(){var t,e=this,n=CKEDITOR.dom.walker.bookmark(),i=[];return{getNextRange:function(o){t=void 0==t?0:t+1;var r=e[t];if(r&&e.length>1){if(!t)for(var s=e.length-1;s>=0;s--)i.unshift(e[s].createBookmark(!0));if(o)for(var l=0;e[t+l+1];){for(var a=r.document,o=0,s=a.getById(i[l].endNode),a=a.getById(i[l+1].startNode);;){if(s=s.getNextSourceNode(!1),a.equals(s))o=1;else if(n(s)||s.type==CKEDITOR.NODE_ELEMENT&&s.isBlockBoundary())continue;break}if(!o)break;l++}for(r.moveToBookmark(i.shift());l--;)s=e[++t],s.moveToBookmark(i.shift()),r.setEnd(s.endContainer,s.endOffset)}return r}}},createBookmarks:function(e){for(var n,i=[],o=0;o<this.length;o++){i.push(n=this[o].createBookmark(e,!0));for(var r=o+1;r<this.length;r++)this[r]=t(n,this[r]),this[r]=t(n,this[r],!0)}return i},createBookmarks2:function(t){for(var e=[],n=0;n<this.length;n++)e.push(this[n].createBookmark2(t));return e},moveToBookmarks:function(t){for(var e=0;e<this.length;e++)this[e].moveToBookmark(t[e])}}}(),function(){function t(){return CKEDITOR.getUrl(CKEDITOR.skinName.split(",")[1]||"skins/"+CKEDITOR.skinName.split(",")[0]+"/")}function e(e){var n=CKEDITOR.skin["ua_"+e],i=CKEDITOR.env;if(n)for(var o,n=n.split(",").sort(function(t,e){return t>e?-1:1}),r=0;r<n.length;r++)if(o=n[r],i.ie&&(o.replace(/^ie/,"")==i.version||i.quirks&&"iequirks"==o)&&(o="ie"),i[o]){e+="_"+n[r];break}return CKEDITOR.getUrl(t()+e+".css")}function n(t,n){r[t]||(CKEDITOR.document.appendStyleSheet(e(t)),r[t]=1),n&&n()}function i(t){var e=t.getById(s);return e||(e=t.getHead().append("style"),e.setAttribute("id",s),e.setAttribute("type","text/css")),e}function o(t,e,n){var i,o,r;if(CKEDITOR.env.webkit)for(e=e.split("}").slice(0,-1),o=0;o<e.length;o++)e[o]=e[o].split("{");for(var s=0;s<t.length;s++)if(CKEDITOR.env.webkit)for(o=0;o<e.length;o++){for(r=e[o][1],i=0;i<n.length;i++)r=r.replace(n[i][0],n[i][1]);t[s].$.sheet.addRule(e[o][0],r)}else{for(r=e,i=0;i<n.length;i++)r=r.replace(n[i][0],n[i][1]);CKEDITOR.env.ie&&CKEDITOR.env.version<11?t[s].$.styleSheet.cssText=t[s].$.styleSheet.cssText+r:t[s].$.innerHTML=t[s].$.innerHTML+r}}var r={};CKEDITOR.skin={path:t,loadPart:function(e,i){CKEDITOR.skin.name!=CKEDITOR.skinName.split(",")[0]?CKEDITOR.scriptLoader.load(CKEDITOR.getUrl(t()+"skin.js"),function(){n(e,i)}):n(e,i)},getPath:function(t){return CKEDITOR.getUrl(e(t))},icons:{},addIcon:function(t,e,n,i){t=t.toLowerCase(),this.icons[t]||(this.icons[t]={path:e,offset:n||0,bgsize:i||"16px"})},getIconStyle:function(t,e,n,i,o){var r;return t&&(t=t.toLowerCase(),e&&(r=this.icons[t+"-rtl"]),r||(r=this.icons[t])),t=n||r&&r.path||"",i=i||r&&r.offset,o=o||r&&r.bgsize||"16px",t&&"background-image:url("+CKEDITOR.getUrl(t)+");background-position:0 "+i+"px;background-size:"+o+";"}},CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{getUiColor:function(){return this.uiColor},setUiColor:function(t){var e=i(CKEDITOR.document);return(this.setUiColor=function(t){var n=CKEDITOR.skin.chameleon,i=[[a,t]];this.uiColor=t,o([e],n(this,"editor"),i),o(l,n(this,"panel"),i)}).call(this,t)}});var s="cke_ui_color",l=[],a=/\$color/g;CKEDITOR.on("instanceLoaded",function(t){if(!CKEDITOR.env.ie||!CKEDITOR.env.quirks){var e=t.editor,t=function(t){if(t=(t.data[0]||t.data).element.getElementsByTag("iframe").getItem(0).getFrameDocument(),!t.getById("cke_ui_color")){t=i(t),l.push(t);var n=e.getUiColor();n&&o([t],CKEDITOR.skin.chameleon(e,"panel"),[[a,n]])}};e.on("panelShow",t),e.on("menuShow",t),e.config.uiColor&&e.setUiColor(e.config.uiColor)}})}(),function(){if(CKEDITOR.env.webkit)CKEDITOR.env.hc=!1;else{var t=CKEDITOR.dom.element.createFromHtml('<div style="width:0;height:0;position:absolute;left:-10000px;border:1px solid;border-color:red blue"></div>',CKEDITOR.document);t.appendTo(CKEDITOR.document.getHead());try{var e=t.getComputedStyle("border-top-color"),n=t.getComputedStyle("border-right-color");CKEDITOR.env.hc=!(!e||e!=n)}catch(i){CKEDITOR.env.hc=!1}t.remove()}if(CKEDITOR.env.hc&&(CKEDITOR.env.cssClass=CKEDITOR.env.cssClass+" cke_hc"),CKEDITOR.document.appendStyleText(".cke{visibility:hidden;}"),CKEDITOR.status="loaded",CKEDITOR.fireOnce("loaded"),t=CKEDITOR._.pending)for(delete CKEDITOR._.pending,e=0;e<t.length;e++)CKEDITOR.editor.prototype.constructor.apply(t[e][0],t[e][1]),CKEDITOR.add(t[e][0])}(),CKEDITOR.skin.name="moono",CKEDITOR.skin.ua_editor="ie,iequirks,ie7,ie8,gecko",CKEDITOR.skin.ua_dialog="ie,iequirks,ie7,ie8,opera",CKEDITOR.skin.chameleon=function(){var t=function(){return function(t,e){for(var n=t.match(/[^#]./g),i=0;3>i;i++){var o,r=n,s=i;o=parseInt(n[i],16),o=("0"+(0>e?0|o*(1+e):0|o+(255-o)*e).toString(16)).slice(-2),r[s]=o}return"#"+n.join("")}}(),e=function(){var t=new CKEDITOR.template("background:#{to};background-image:-webkit-gradient(linear,lefttop,leftbottom,from({from}),to({to}));background-image:-moz-linear-gradient(top,{from},{to});background-image:-webkit-linear-gradient(top,{from},{to});background-image:-o-linear-gradient(top,{from},{to});background-image:-ms-linear-gradient(top,{from},{to});background-image:linear-gradient(top,{from},{to});filter:progid:DXImageTransform.Microsoft.gradient(gradientType=0,startColorstr='{from}',endColorstr='{to}');");return function(e,n){return t.output({from:e,to:n})}}(),n={editor:new CKEDITOR.template("{id}.cke_chrome [border-color:{defaultBorder};] {id} .cke_top [ {defaultGradient}border-bottom-color:{defaultBorder};] {id} .cke_bottom [{defaultGradient}border-top-color:{defaultBorder};] {id} .cke_resizer [border-right-color:{ckeResizer}] {id} .cke_dialog_title [{defaultGradient}border-bottom-color:{defaultBorder};] {id} .cke_dialog_footer [{defaultGradient}outline-color:{defaultBorder};border-top-color:{defaultBorder};] {id} .cke_dialog_tab [{lightGradient}border-color:{defaultBorder};] {id} .cke_dialog_tab:hover [{mediumGradient}] {id} .cke_dialog_contents [border-top-color:{defaultBorder};] {id} .cke_dialog_tab_selected, {id} .cke_dialog_tab_selected:hover [background:{dialogTabSelected};border-bottom-color:{dialogTabSelectedBorder};] {id} .cke_dialog_body [background:{dialogBody};border-color:{defaultBorder};] {id} .cke_toolgroup [{lightGradient}border-color:{defaultBorder};] {id} a.cke_button_off:hover, {id} a.cke_button_off:focus, {id} a.cke_button_off:active [{mediumGradient}] {id} .cke_button_on [{ckeButtonOn}] {id} .cke_toolbar_separator [background-color: {ckeToolbarSeparator};] {id} .cke_combo_button [border-color:{defaultBorder};{lightGradient}] {id} a.cke_combo_button:hover, {id} a.cke_combo_button:focus, {id} .cke_combo_on a.cke_combo_button [border-color:{defaultBorder};{mediumGradient}] {id} .cke_path_item [color:{elementsPathColor};] {id} a.cke_path_item:hover, {id} a.cke_path_item:focus, {id} a.cke_path_item:active [background-color:{elementsPathBg};] {id}.cke_panel [border-color:{defaultBorder};] "),panel:new CKEDITOR.template(".cke_panel_grouptitle [{lightGradient}border-color:{defaultBorder};] .cke_menubutton_icon [background-color:{menubuttonIcon};] .cke_menubutton:hover .cke_menubutton_icon, .cke_menubutton:focus .cke_menubutton_icon, .cke_menubutton:active .cke_menubutton_icon [background-color:{menubuttonIconHover};] .cke_menuseparator [background-color:{menubuttonIcon};] a:hover.cke_colorbox, a:focus.cke_colorbox, a:active.cke_colorbox [border-color:{defaultBorder};] a:hover.cke_colorauto, a:hover.cke_colormore, a:focus.cke_colorauto, a:focus.cke_colormore, a:active.cke_colorauto, a:active.cke_colormore [background-color:{ckeColorauto};border-color:{defaultBorder};] ")};return function(i,o){var r=i.uiColor,r={id:"."+i.id,defaultBorder:t(r,-.1),defaultGradient:e(t(r,.9),r),lightGradient:e(t(r,1),t(r,.7)),mediumGradient:e(t(r,.8),t(r,.5)),ckeButtonOn:e(t(r,.6),t(r,.7)),ckeResizer:t(r,-.4),ckeToolbarSeparator:t(r,.5),ckeColorauto:t(r,.8),dialogBody:t(r,.7),dialogTabSelected:e("#FFFFFF","#FFFFFF"),dialogTabSelectedBorder:"#FFF",elementsPathColor:t(r,-.6),elementsPathBg:r,menubuttonIcon:t(r,.5),menubuttonIconHover:t(r,.3)};return n[o].output(r).replace(/\[/g,"{").replace(/\]/g,"}")}}(),CKEDITOR.plugins.add("dialogui",{onLoad:function(){var t=function(t){this._||(this._={}),this._["default"]=this._.initValue=t["default"]||"",this._.required=t.required||!1;for(var e=[this._],n=1;n<arguments.length;n++)e.push(arguments[n]);return e.push(!0),CKEDITOR.tools.extend.apply(CKEDITOR.tools,e),this._},e={build:function(t,e,n){return new CKEDITOR.ui.dialog.textInput(t,e,n)}},n={build:function(t,e,n){return new CKEDITOR.ui.dialog[e.type](t,e,n)}},i={isChanged:function(){return this.getValue()!=this.getInitValue()},reset:function(t){this.setValue(this.getInitValue(),t)},setInitValue:function(){this._.initValue=this.getValue()},resetInitValue:function(){this._.initValue=this._["default"]},getInitValue:function(){return this._.initValue}},o=CKEDITOR.tools.extend({},CKEDITOR.ui.dialog.uiElement.prototype.eventProcessors,{onChange:function(t,e){this._.domOnChangeRegistered||(t.on("load",function(){this.getInputElement().on("change",function(){t.parts.dialog.isVisible()&&this.fire("change",{value:this.getValue()})},this)},this),this._.domOnChangeRegistered=!0),this.on("change",e)}},!0),r=/^on([A-Z]\w+)/,s=function(t){for(var e in t)(r.test(e)||"title"==e||"type"==e)&&delete t[e];return t};CKEDITOR.tools.extend(CKEDITOR.ui.dialog,{labeledElement:function(e,n,i,o){if(!(arguments.length<4)){var r=t.call(this,n);r.labelId=CKEDITOR.tools.getNextId()+"_label",this._.children=[],CKEDITOR.ui.dialog.uiElement.call(this,e,n,i,"div",null,{role:"presentation"},function(){var t=[],i=n.required?" cke_required":"";return"horizontal"!=n.labelLayout?t.push('<label class="cke_dialog_ui_labeled_label'+i+'" ',' id="'+r.labelId+'"',r.inputId?' for="'+r.inputId+'"':"",(n.labelStyle?' style="'+n.labelStyle+'"':"")+">",n.label,"</label>",'<div class="cke_dialog_ui_labeled_content"',n.controlStyle?' style="'+n.controlStyle+'"':"",' role="radiogroup" aria-labelledby="'+r.labelId+'">',o.call(this,e,n),"</div>"):(i={type:"hbox",widths:n.widths,padding:0,children:[{type:"html",html:'<label class="cke_dialog_ui_labeled_label'+i+'" id="'+r.labelId+'" for="'+r.inputId+'"'+(n.labelStyle?' style="'+n.labelStyle+'"':"")+">"+CKEDITOR.tools.htmlEncode(n.label)+"</span>"},{type:"html",html:'<span class="cke_dialog_ui_labeled_content"'+(n.controlStyle?' style="'+n.controlStyle+'"':"")+">"+o.call(this,e,n)+"</span>"}]},CKEDITOR.dialog._.uiElementBuilders.hbox.build(e,i,t)),t.join("")})}},textInput:function(e,n,i){if(!(arguments.length<3)){t.call(this,n);var o=this._.inputId=CKEDITOR.tools.getNextId()+"_textInput",r={"class":"cke_dialog_ui_input_"+n.type,id:o,type:n.type};n.validate&&(this.validate=n.validate),n.maxLength&&(r.maxlength=n.maxLength),n.size&&(r.size=n.size),n.inputStyle&&(r.style=n.inputStyle);var s=this,l=!1;e.on("load",function(){s.getInputElement().on("keydown",function(t){13==t.data.getKeystroke()&&(l=!0)}),s.getInputElement().on("keyup",function(t){13==t.data.getKeystroke()&&l&&(e.getButton("ok")&&setTimeout(function(){e.getButton("ok").click()},0),l=!1)},null,null,1e3)}),CKEDITOR.ui.dialog.labeledElement.call(this,e,n,i,function(){var t=['<div class="cke_dialog_ui_input_',n.type,'" role="presentation"'];n.width&&t.push('style="width:'+n.width+'" '),t.push("><input "),r["aria-labelledby"]=this._.labelId,this._.required&&(r["aria-required"]=this._.required);for(var e in r)t.push(e+'="'+r[e]+'" ');return t.push(" /></div>"),t.join("")})}},textarea:function(e,n,i){if(!(arguments.length<3)){t.call(this,n);var o=this,r=this._.inputId=CKEDITOR.tools.getNextId()+"_textarea",s={};n.validate&&(this.validate=n.validate),s.rows=n.rows||5,s.cols=n.cols||20,s["class"]="cke_dialog_ui_input_textarea "+(n["class"]||""),"undefined"!=typeof n.inputStyle&&(s.style=n.inputStyle),n.dir&&(s.dir=n.dir),CKEDITOR.ui.dialog.labeledElement.call(this,e,n,i,function(){s["aria-labelledby"]=this._.labelId,this._.required&&(s["aria-required"]=this._.required);var t,e=['<div class="cke_dialog_ui_input_textarea" role="presentation"><textarea id="',r,'" '];for(t in s)e.push(t+'="'+CKEDITOR.tools.htmlEncode(s[t])+'" ');return e.push(">",CKEDITOR.tools.htmlEncode(o._["default"]),"</textarea></div>"),e.join("")})}},checkbox:function(e,n,i){if(!(arguments.length<3)){var o=t.call(this,n,{"default":!!n["default"]});n.validate&&(this.validate=n.validate),CKEDITOR.ui.dialog.uiElement.call(this,e,n,i,"span",null,null,function(){var t=CKEDITOR.tools.extend({},n,{id:n.id?n.id+"_checkbox":CKEDITOR.tools.getNextId()+"_checkbox"},!0),i=[],r=CKEDITOR.tools.getNextId()+"_label",l={"class":"cke_dialog_ui_checkbox_input",type:"checkbox","aria-labelledby":r};return s(t),n["default"]&&(l.checked="checked"),"undefined"!=typeof t.inputStyle&&(t.style=t.inputStyle),o.checkbox=new CKEDITOR.ui.dialog.uiElement(e,t,i,"input",null,l),i.push(' <label id="',r,'" for="',l.id,'"'+(n.labelStyle?' style="'+n.labelStyle+'"':"")+">",CKEDITOR.tools.htmlEncode(n.label),"</label>"),i.join("")})}},radio:function(e,n,i){if(!(arguments.length<3)){t.call(this,n),this._["default"]||(this._["default"]=this._.initValue=n.items[0][1]),n.validate&&(this.validate=n.valdiate);var o=[],r=this;CKEDITOR.ui.dialog.labeledElement.call(this,e,n,i,function(){for(var t=[],i=[],l=(n.id?n.id:CKEDITOR.tools.getNextId())+"_radio",a=0;a<n.items.length;a++){var h=n.items[a],d=void 0!==h[2]?h[2]:h[0],u=void 0!==h[1]?h[1]:h[0],c=CKEDITOR.tools.getNextId()+"_radio_input",p=c+"_label",c=CKEDITOR.tools.extend({},n,{id:c,title:null,type:null},!0),d=CKEDITOR.tools.extend({},c,{title:d},!0),m={type:"radio","class":"cke_dialog_ui_radio_input",name:l,value:u,"aria-labelledby":p},g=[];r._["default"]==u&&(m.checked="checked"),s(c),s(d),"undefined"!=typeof c.inputStyle&&(c.style=c.inputStyle),c.keyboardFocusable=!0,o.push(new CKEDITOR.ui.dialog.uiElement(e,c,g,"input",null,m)),g.push(" "),new CKEDITOR.ui.dialog.uiElement(e,d,g,"label",null,{id:p,"for":m.id},h[0]),t.push(g.join(""))}return new CKEDITOR.ui.dialog.hbox(e,o,t,i),i.join("")}),this._.children=o}},button:function(e,n,i){if(arguments.length){"function"==typeof n&&(n=n(e.getParentEditor())),t.call(this,n,{disabled:n.disabled||!1}),CKEDITOR.event.implementOn(this);var o=this;e.on("load",function(){var t=this.getElement();!function(){t.on("click",function(t){o.click(),t.data.preventDefault()}),t.on("keydown",function(t){t.data.getKeystroke()in{32:1}&&(o.click(),t.data.preventDefault())})}(),t.unselectable()},this);var r=CKEDITOR.tools.extend({},n);delete r.style;var s=CKEDITOR.tools.getNextId()+"_label";CKEDITOR.ui.dialog.uiElement.call(this,e,r,i,"a",null,{style:n.style,href:"javascript:void(0)",title:n.label,hidefocus:"true","class":n["class"],role:"button","aria-labelledby":s},'<span id="'+s+'" class="cke_dialog_ui_button">'+CKEDITOR.tools.htmlEncode(n.label)+"</span>")}},select:function(e,n,i){if(!(arguments.length<3)){var o=t.call(this,n);n.validate&&(this.validate=n.validate),o.inputId=CKEDITOR.tools.getNextId()+"_select",CKEDITOR.ui.dialog.labeledElement.call(this,e,n,i,function(){var t=CKEDITOR.tools.extend({},n,{id:n.id?n.id+"_select":CKEDITOR.tools.getNextId()+"_select"},!0),i=[],r=[],l={id:o.inputId,"class":"cke_dialog_ui_input_select","aria-labelledby":this._.labelId};i.push('<div class="cke_dialog_ui_input_',n.type,'" role="presentation"'),n.width&&i.push('style="width:'+n.width+'" '),i.push(">"),void 0!=n.size&&(l.size=n.size),void 0!=n.multiple&&(l.multiple=n.multiple),s(t);for(var a,h=0;h<n.items.length&&(a=n.items[h]);h++)r.push('<option value="',CKEDITOR.tools.htmlEncode(void 0!==a[1]?a[1]:a[0]).replace(/"/g,"&quot;"),'" /> ',CKEDITOR.tools.htmlEncode(a[0]));return"undefined"!=typeof t.inputStyle&&(t.style=t.inputStyle),o.select=new CKEDITOR.ui.dialog.uiElement(e,t,i,"select",null,l,r.join("")),i.push("</div>"),i.join("")})}},file:function(e,n,i){if(!(arguments.length<3)){void 0===n["default"]&&(n["default"]="");var o=CKEDITOR.tools.extend(t.call(this,n),{definition:n,buttons:[]});n.validate&&(this.validate=n.validate),e.on("load",function(){CKEDITOR.document.getById(o.frameId).getParent().addClass("cke_dialog_ui_input_file")}),CKEDITOR.ui.dialog.labeledElement.call(this,e,n,i,function(){o.frameId=CKEDITOR.tools.getNextId()+"_fileInput";var t=['<iframe frameborder="0" allowtransparency="0" class="cke_dialog_ui_input_file" role="presentation" id="',o.frameId,'" title="',n.label,'" src="javascript:void('];return t.push(CKEDITOR.env.ie?"(function(){"+encodeURIComponent("document.open();("+CKEDITOR.tools.fixDomain+")();document.close();")+"})()":"0"),t.push(')"></iframe>'),t.join("")})}},fileButton:function(e,n,i){if(!(arguments.length<3)){t.call(this,n);var o=this;n.validate&&(this.validate=n.validate);var r=CKEDITOR.tools.extend({},n),s=r.onClick;r.className=(r.className?r.className+" ":"")+"cke_dialog_ui_button",r.onClick=function(t){var i=n["for"];s&&s.call(this,t)===!1||(e.getContentElement(i[0],i[1]).submit(),this.disable())},e.on("load",function(){e.getContentElement(n["for"][0],n["for"][1])._.buttons.push(o)}),CKEDITOR.ui.dialog.button.call(this,e,r,i)}},html:function(){var t=/^\s*<[\w:]+\s+([^>]*)?>/,e=/^(\s*<[\w:]+(?:\s+[^>]*)?)((?:.|\r|\n)+)$/,n=/\/$/;return function(i,o,r){if(!(arguments.length<3)){var s=[],l=o.html;"<"!=l.charAt(0)&&(l="<span>"+l+"</span>");var a=o.focus;if(a){var h=this.focus;this.focus=function(){("function"==typeof a?a:h).call(this),this.fire("focus")},o.isFocusable&&(this.isFocusable=this.isFocusable),this.keyboardFocusable=!0}CKEDITOR.ui.dialog.uiElement.call(this,i,o,s,"span",null,null,""),s=s.join("").match(t),l=l.match(e)||["","",""],n.test(l[1])&&(l[1]=l[1].slice(0,-1),l[2]="/"+l[2]),r.push([l[1]," ",s[1]||"",l[2]].join(""))}}}(),fieldset:function(t,e,n,i,o){var r=o.label;this._={children:e},CKEDITOR.ui.dialog.uiElement.call(this,t,o,i,"fieldset",null,null,function(){var t=[];r&&t.push("<legend"+(o.labelStyle?' style="'+o.labelStyle+'"':"")+">"+r+"</legend>");for(var e=0;e<n.length;e++)t.push(n[e]);return t.join("")})}},!0),CKEDITOR.ui.dialog.html.prototype=new CKEDITOR.ui.dialog.uiElement,CKEDITOR.ui.dialog.labeledElement.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{setLabel:function(t){var e=CKEDITOR.document.getById(this._.labelId);return e.getChildCount()<1?new CKEDITOR.dom.text(t,CKEDITOR.document).appendTo(e):e.getChild(0).$.nodeValue=t,this},getLabel:function(){var t=CKEDITOR.document.getById(this._.labelId);return!t||t.getChildCount()<1?"":t.getChild(0).getText()},eventProcessors:o},!0),CKEDITOR.ui.dialog.button.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{click:function(){return this._.disabled?!1:this.fire("click",{dialog:this._.dialog})},enable:function(){this._.disabled=!1;var t=this.getElement();t&&t.removeClass("cke_disabled")},disable:function(){this._.disabled=!0,this.getElement().addClass("cke_disabled")},isVisible:function(){return this.getElement().getFirst().isVisible()},isEnabled:function(){return!this._.disabled},eventProcessors:CKEDITOR.tools.extend({},CKEDITOR.ui.dialog.uiElement.prototype.eventProcessors,{onClick:function(t,e){this.on("click",function(){e.apply(this,arguments)})}},!0),accessKeyUp:function(){this.click()},accessKeyDown:function(){this.focus()},keyboardFocusable:!0},!0),CKEDITOR.ui.dialog.textInput.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.labeledElement,{getInputElement:function(){return CKEDITOR.document.getById(this._.inputId)},focus:function(){var t=this.selectParentTab();setTimeout(function(){var e=t.getInputElement();e&&e.$.focus()},0)},select:function(){var t=this.selectParentTab();setTimeout(function(){var e=t.getInputElement();e&&(e.$.focus(),e.$.select())},0)},accessKeyUp:function(){this.select()},setValue:function(t){return!t&&(t=""),CKEDITOR.ui.dialog.uiElement.prototype.setValue.apply(this,arguments)},keyboardFocusable:!0},i,!0),CKEDITOR.ui.dialog.textarea.prototype=new CKEDITOR.ui.dialog.textInput,CKEDITOR.ui.dialog.select.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.labeledElement,{getInputElement:function(){return this._.select.getElement()},add:function(t,e,n){var i=new CKEDITOR.dom.element("option",this.getDialog().getParentEditor().document),o=this.getInputElement().$;return i.$.text=t,i.$.value=void 0===e||null===e?t:e,void 0===n||null===n?CKEDITOR.env.ie?o.add(i.$):o.add(i.$,null):o.add(i.$,n),this},remove:function(t){return this.getInputElement().$.remove(t),this},clear:function(){for(var t=this.getInputElement().$;t.length>0;)t.remove(0);return this},keyboardFocusable:!0},i,!0),CKEDITOR.ui.dialog.checkbox.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{getInputElement:function(){return this._.checkbox.getElement()},setValue:function(t,e){this.getInputElement().$.checked=t,!e&&this.fire("change",{value:t})},getValue:function(){return this.getInputElement().$.checked},accessKeyUp:function(){this.setValue(!this.getValue())},eventProcessors:{onChange:function(t,e){return!CKEDITOR.env.ie||CKEDITOR.env.version>8?o.onChange.apply(this,arguments):(t.on("load",function(){var t=this._.checkbox.getElement();t.on("propertychange",function(e){e=e.data.$,"checked"==e.propertyName&&this.fire("change",{value:t.$.checked})},this)},this),this.on("change",e),null)}},keyboardFocusable:!0},i,!0),CKEDITOR.ui.dialog.radio.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{setValue:function(t,e){for(var n,i=this._.children,o=0;o<i.length&&(n=i[o]);o++)n.getElement().$.checked=n.getValue()==t;!e&&this.fire("change",{value:t})},getValue:function(){for(var t=this._.children,e=0;e<t.length;e++)if(t[e].getElement().$.checked)return t[e].getValue();return null},accessKeyUp:function(){var t,e=this._.children;for(t=0;t<e.length;t++)if(e[t].getElement().$.checked)return e[t].getElement().focus(),void 0;
e[0].getElement().focus()},eventProcessors:{onChange:function(t,e){return CKEDITOR.env.ie?(t.on("load",function(){for(var t=this._.children,e=this,n=0;n<t.length;n++)t[n].getElement().on("propertychange",function(t){t=t.data.$,"checked"==t.propertyName&&this.$.checked&&e.fire("change",{value:this.getAttribute("value")})})},this),this.on("change",e),null):o.onChange.apply(this,arguments)}}},i,!0),CKEDITOR.ui.dialog.file.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.labeledElement,i,{getInputElement:function(){var t=CKEDITOR.document.getById(this._.frameId).getFrameDocument();return t.$.forms.length>0?new CKEDITOR.dom.element(t.$.forms[0].elements[0]):this.getElement()},submit:function(){return this.getInputElement().getParent().$.submit(),this},getAction:function(){return this.getInputElement().getParent().$.action},registerEvents:function(t){var e,n,i=/^on([A-Z]\w+)/,o=function(t,e,n,i){t.on("formLoaded",function(){t.getInputElement().on(n,i,t)})};for(n in t)(e=n.match(i))&&(this.eventProcessors[n]?this.eventProcessors[n].call(this,this._.dialog,t[n]):o(this,this._.dialog,e[1].toLowerCase(),t[n]));return this},reset:function(){function t(){n.$.open();var t="";i.size&&(t=i.size-(CKEDITOR.env.ie?7:0));var h=e.frameId+"_input";for(n.$.write(['<html dir="'+l+'" lang="'+a+'"><head><title></title></head><body style="margin: 0; overflow: hidden; background: transparent;">','<form enctype="multipart/form-data" method="POST" dir="'+l+'" lang="'+a+'" action="',CKEDITOR.tools.htmlEncode(i.action),'"><label id="',e.labelId,'" for="',h,'" style="display:none">',CKEDITOR.tools.htmlEncode(i.label),'</label><input id="',h,'" aria-labelledby="',e.labelId,'" type="file" name="',CKEDITOR.tools.htmlEncode(i.id||"cke_upload"),'" size="',CKEDITOR.tools.htmlEncode(t>0?t:""),'" /></form></body></html><script>',CKEDITOR.env.ie?"("+CKEDITOR.tools.fixDomain+")();":"","window.parent.CKEDITOR.tools.callFunction("+r+");","window.onbeforeunload = function() {window.parent.CKEDITOR.tools.callFunction("+s+")}","</script>"].join("")),n.$.close(),t=0;t<o.length;t++)o[t].enable()}var e=this._,n=CKEDITOR.document.getById(e.frameId).getFrameDocument(),i=e.definition,o=e.buttons,r=this.formLoadedNumber,s=this.formUnloadNumber,l=e.dialog._.editor.lang.dir,a=e.dialog._.editor.langCode;r||(r=this.formLoadedNumber=CKEDITOR.tools.addFunction(function(){this.fire("formLoaded")},this),s=this.formUnloadNumber=CKEDITOR.tools.addFunction(function(){this.getInputElement().clearCustomData()},this),this.getDialog()._.editor.on("destroy",function(){CKEDITOR.tools.removeFunction(r),CKEDITOR.tools.removeFunction(s)})),CKEDITOR.env.gecko?setTimeout(t,500):t()},getValue:function(){return this.getInputElement().$.value||""},setInitValue:function(){this._.initValue=""},eventProcessors:{onChange:function(t,e){this._.domOnChangeRegistered||(this.on("formLoaded",function(){this.getInputElement().on("change",function(){this.fire("change",{value:this.getValue()})},this)},this),this._.domOnChangeRegistered=!0),this.on("change",e)}},keyboardFocusable:!0},!0),CKEDITOR.ui.dialog.fileButton.prototype=new CKEDITOR.ui.dialog.button,CKEDITOR.ui.dialog.fieldset.prototype=CKEDITOR.tools.clone(CKEDITOR.ui.dialog.hbox.prototype),CKEDITOR.dialog.addUIElement("text",e),CKEDITOR.dialog.addUIElement("password",e),CKEDITOR.dialog.addUIElement("textarea",n),CKEDITOR.dialog.addUIElement("checkbox",n),CKEDITOR.dialog.addUIElement("radio",n),CKEDITOR.dialog.addUIElement("button",n),CKEDITOR.dialog.addUIElement("select",n),CKEDITOR.dialog.addUIElement("file",n),CKEDITOR.dialog.addUIElement("fileButton",n),CKEDITOR.dialog.addUIElement("html",n),CKEDITOR.dialog.addUIElement("fieldset",{build:function(t,e,n){for(var i,o=e.children,r=[],s=[],l=0;l<o.length&&(i=o[l]);l++){var a=[];r.push(a),s.push(CKEDITOR.dialog._.uiElementBuilders[i.type].build(t,i,a))}return new CKEDITOR.ui.dialog[e.type](t,s,r,n,e)}})}}),CKEDITOR.DIALOG_RESIZE_NONE=0,CKEDITOR.DIALOG_RESIZE_WIDTH=1,CKEDITOR.DIALOG_RESIZE_HEIGHT=2,CKEDITOR.DIALOG_RESIZE_BOTH=3,function(){function t(){for(var t=this._.tabIdList.length,e=CKEDITOR.tools.indexOf(this._.tabIdList,this._.currentTabId)+t,n=e-1;n>e-t;n--)if(this._.tabs[this._.tabIdList[n%t]][0].$.offsetHeight)return this._.tabIdList[n%t];return null}function e(){for(var t=this._.tabIdList.length,e=CKEDITOR.tools.indexOf(this._.tabIdList,this._.currentTabId),n=e+1;e+t>n;n++)if(this._.tabs[this._.tabIdList[n%t]][0].$.offsetHeight)return this._.tabIdList[n%t];return null}function n(t,e){for(var n=t.$.getElementsByTagName("input"),i=0,o=n.length;o>i;i++){var r=new CKEDITOR.dom.element(n[i]);"text"==r.getAttribute("type").toLowerCase()&&(e?(r.setAttribute("value",r.getCustomData("fake_value")||""),r.removeCustomData("fake_value")):(r.setCustomData("fake_value",r.getAttribute("value")),r.setAttribute("value","")))}}function i(t,e){var n=this.getInputElement();n&&(t?n.removeAttribute("aria-invalid"):n.setAttribute("aria-invalid",!0)),t||(this.select?this.select():this.focus()),e&&alert(e),this.fire("validated",{valid:t,msg:e})}function o(){var t=this.getInputElement();t&&t.removeAttribute("aria-invalid")}function r(t){var t=CKEDITOR.dom.element.createFromHtml(CKEDITOR.addTemplate("dialog",g).output({id:CKEDITOR.tools.getNextNumber(),editorId:t.id,langDir:t.lang.dir,langCode:t.langCode,editorDialogClass:"cke_editor_"+t.name.replace(/\./g,"\\.")+"_dialog",closeTitle:t.lang.common.close,hidpi:CKEDITOR.env.hidpi?"cke_hidpi":""})),e=t.getChild([0,0,0,0,0]),n=e.getChild(0),i=e.getChild(1);if(CKEDITOR.env.ie&&!CKEDITOR.env.ie6Compat){var o="javascript:void(function(){"+encodeURIComponent("document.open();("+CKEDITOR.tools.fixDomain+")();document.close();")+"}())";CKEDITOR.dom.element.createFromHtml('<iframe frameBorder="0" class="cke_iframe_shim" src="'+o+'" tabIndex="-1"></iframe>').appendTo(e.getParent())}return n.unselectable(),i.unselectable(),{element:t,parts:{dialog:t.getChild(0),title:n,close:i,tabs:e.getChild(2),contents:e.getChild([3,0,0,0]),footer:e.getChild([3,0,1,0])}}}function s(t,e,n){this.element=e,this.focusIndex=n,this.tabIndex=0,this.isFocusable=function(){return!e.getAttribute("disabled")&&e.isVisible()},this.focus=function(){t._.currentFocusIndex=this.focusIndex,this.element.focus()},e.on("keydown",function(t){t.data.getKeystroke()in{32:1,13:1}&&this.fire("click")}),e.on("focus",function(){this.fire("mouseover")}),e.on("blur",function(){this.fire("mouseout")})}function l(t){function e(){t.layout()}var n=CKEDITOR.document.getWindow();n.on("resize",e),t.on("hide",function(){n.removeListener("resize",e)})}function a(t,e){this._={dialog:t},CKEDITOR.tools.extend(this,e)}function h(t){function e(e){var n=t.getSize(),a=CKEDITOR.document.getWindow().getViewPaneSize(),h=e.data.$.screenX,d=e.data.$.screenY,u=h-i.x,c=d-i.y;i={x:h,y:d},o.x=o.x+u,o.y=o.y+c,t.move(o.x+l[3]<s?-l[3]:o.x-l[1]>a.width-n.width-s?a.width-n.width+("rtl"==r.lang.dir?0:l[1]):o.x,o.y+l[0]<s?-l[0]:o.y-l[2]>a.height-n.height-s?a.height-n.height+l[2]:o.y,1),e.data.preventDefault()}function n(){if(CKEDITOR.document.removeListener("mousemove",e),CKEDITOR.document.removeListener("mouseup",n),CKEDITOR.env.ie6Compat){var t=T.getChild(0).getFrameDocument();t.removeListener("mousemove",e),t.removeListener("mouseup",n)}}var i=null,o=null;t.getElement().getFirst();var r=t.getParentEditor(),s=r.config.dialog_magnetDistance,l=CKEDITOR.skin.margins||[0,0,0,0];"undefined"==typeof s&&(s=20),t.parts.title.on("mousedown",function(r){if(i={x:r.data.$.screenX,y:r.data.$.screenY},CKEDITOR.document.on("mousemove",e),CKEDITOR.document.on("mouseup",n),o=t.getPosition(),CKEDITOR.env.ie6Compat){var s=T.getChild(0).getFrameDocument();s.on("mousemove",e),s.on("mouseup",n)}r.data.preventDefault()},t)}function d(t){function e(e){var n="rtl"==c.lang.dir,u=d.width,p=d.height,m=u+(e.data.$.screenX-i)*(n?-1:1)*(t._.moved?1:2),g=p+(e.data.$.screenY-o)*(t._.moved?1:2),f=t._.element.getFirst(),f=n&&f.getComputedStyle("right"),x=t.getPosition();x.y+g>h.height&&(g=h.height-x.y),(n?f:x.x)+m>h.width&&(m=h.width-(n?f:x.x)),(s==CKEDITOR.DIALOG_RESIZE_WIDTH||s==CKEDITOR.DIALOG_RESIZE_BOTH)&&(u=Math.max(r.minWidth||0,m-l)),(s==CKEDITOR.DIALOG_RESIZE_HEIGHT||s==CKEDITOR.DIALOG_RESIZE_BOTH)&&(p=Math.max(r.minHeight||0,g-a)),t.resize(u,p),t._.moved||t.layout(),e.data.preventDefault()}function n(){if(CKEDITOR.document.removeListener("mouseup",n),CKEDITOR.document.removeListener("mousemove",e),u&&(u.remove(),u=null),CKEDITOR.env.ie6Compat){var t=T.getChild(0).getFrameDocument();t.removeListener("mouseup",n),t.removeListener("mousemove",e)}}var i,o,r=t.definition,s=r.resizable;if(s!=CKEDITOR.DIALOG_RESIZE_NONE){var l,a,h,d,u,c=t.getParentEditor(),p=CKEDITOR.tools.addFunction(function(r){d=t.getSize();var s=t.parts.contents;s.$.getElementsByTagName("iframe").length&&(u=CKEDITOR.dom.element.createFromHtml('<div class="cke_dialog_resize_cover" style="height: 100%; position: absolute; width: 100%;"></div>'),s.append(u)),a=d.height-t.parts.contents.getSize("height",!(CKEDITOR.env.gecko||CKEDITOR.env.opera||CKEDITOR.env.ie&&CKEDITOR.env.quirks)),l=d.width-t.parts.contents.getSize("width",1),i=r.screenX,o=r.screenY,h=CKEDITOR.document.getWindow().getViewPaneSize(),CKEDITOR.document.on("mousemove",e),CKEDITOR.document.on("mouseup",n),CKEDITOR.env.ie6Compat&&(s=T.getChild(0).getFrameDocument(),s.on("mousemove",e),s.on("mouseup",n)),r.preventDefault&&r.preventDefault()});t.on("load",function(){var e="";s==CKEDITOR.DIALOG_RESIZE_WIDTH?e=" cke_resizer_horizontal":s==CKEDITOR.DIALOG_RESIZE_HEIGHT&&(e=" cke_resizer_vertical"),e=CKEDITOR.dom.element.createFromHtml('<div class="cke_resizer'+e+" cke_resizer_"+c.lang.dir+'" title="'+CKEDITOR.tools.htmlEncode(c.lang.common.resize)+'" onmousedown="CKEDITOR.tools.callFunction('+p+', event )">'+("ltr"==c.lang.dir?"":"")+"</div>"),t.parts.footer.append(e,1)}),c.on("destroy",function(){CKEDITOR.tools.removeFunction(p)})}}function u(t){t.data.preventDefault(1)}function c(t){var e=CKEDITOR.document.getWindow(),n=t.config,i=n.dialog_backgroundCoverColor||"white",o=n.dialog_backgroundCoverOpacity,r=n.baseFloatZIndex,n=CKEDITOR.tools.genKey(i,o,r),s=b[n];s?s.show():(r=['<div tabIndex="-1" style="position: ',CKEDITOR.env.ie6Compat?"absolute":"fixed","; z-index: ",r,"; top: 0px; left: 0px; ",CKEDITOR.env.ie6Compat?"":"background-color: "+i,'" class="cke_dialog_background_cover">'],CKEDITOR.env.ie6Compat&&(i="<html><body style=\\'background-color:"+i+";\\'></body></html>",r.push('<iframe hidefocus="true" frameborder="0" id="cke_dialog_background_iframe" src="javascript:'),r.push("void((function(){"+encodeURIComponent("document.open();("+CKEDITOR.tools.fixDomain+")();document.write( '"+i+"' );document.close();")+"})())"),r.push('" style="position:absolute;left:0;top:0;width:100%;height: 100%;filter: progid:DXImageTransform.Microsoft.Alpha(opacity=0)"></iframe>')),r.push("</div>"),s=CKEDITOR.dom.element.createFromHtml(r.join("")),s.setOpacity(void 0!=o?o:.5),s.on("keydown",u),s.on("keypress",u),s.on("keyup",u),s.appendTo(CKEDITOR.document.getBody()),b[n]=s),t.focusManager.add(s),T=s;var t=function(){var t=e.getViewPaneSize();s.setStyles({width:t.width+"px",height:t.height+"px"})},l=function(){var t=e.getScrollPosition(),n=CKEDITOR.dialog._.currentTop;if(s.setStyles({left:t.x+"px",top:t.y+"px"}),n)do t=n.getPosition(),n.move(t.x,t.y);while(n=n._.parentDialog)};if(v=t,e.on("resize",t),t(),(!CKEDITOR.env.mac||!CKEDITOR.env.webkit)&&s.focus(),CKEDITOR.env.ie6Compat){var a=function(){l(),arguments.callee.prevScrollHandler.apply(this,arguments)};e.$.setTimeout(function(){a.prevScrollHandler=window.onscroll||function(){},window.onscroll=a},0),l()}}function p(t){T&&(t.focusManager.remove(T),t=CKEDITOR.document.getWindow(),T.hide(),t.removeListener("resize",v),CKEDITOR.env.ie6Compat&&t.$.setTimeout(function(){window.onscroll=window.onscroll&&window.onscroll.prevScrollHandler||null},0),v=null)}var m=CKEDITOR.tools.cssLength,g='<div class="cke_reset_all {editorId} {editorDialogClass} {hidpi}" dir="{langDir}" lang="{langCode}" role="dialog" aria-labelledby="cke_dialog_title_{id}"><table class="cke_dialog '+CKEDITOR.env.cssClass+' cke_{langDir}" style="position:absolute" role="presentation"><tr><td role="presentation"><div class="cke_dialog_body" role="presentation"><div id="cke_dialog_title_{id}" class="cke_dialog_title" role="presentation"></div><a id="cke_dialog_close_button_{id}" class="cke_dialog_close_button" href="javascript:void(0)" title="{closeTitle}" role="button"><span class="cke_label">X</span></a><div id="cke_dialog_tabs_{id}" class="cke_dialog_tabs" role="tablist"></div><table class="cke_dialog_contents" role="presentation"><tr><td id="cke_dialog_contents_{id}" class="cke_dialog_contents_body" role="presentation"></td></tr><tr><td id="cke_dialog_footer_{id}" class="cke_dialog_footer" role="presentation"></td></tr></table></div></td></tr></table></div>';CKEDITOR.dialog=function(n,s){function l(){var t=b._.focusList;t.sort(function(t,e){return t.tabIndex!=e.tabIndex?e.tabIndex-t.tabIndex:t.focusIndex-e.focusIndex});for(var e=t.length,n=0;e>n;n++)t[n].focusIndex=n}function a(t){var e=b._.focusList,t=t||0;if(!(e.length<1)){var n=b._.currentFocusIndex;try{e[n].getInputElement().$.blur()}catch(i){}for(var o=n=(n+t+e.length)%e.length;t&&!e[o].isFocusable()&&(o=(o+t+e.length)%e.length,o!=n););e[o].focus(),"text"==e[o].type&&e[o].select()}}function u(i){if(b==CKEDITOR.dialog._.currentTop){var o=i.data.getKeystroke(),r="rtl"==n.lang.dir;if(p=m=0,9==o||o==CKEDITOR.SHIFT+9)o=o==CKEDITOR.SHIFT+9,b._.tabBarMode?(o=o?t.call(b):e.call(b),b.selectPage(o),b._.tabs[o][0].focus()):a(o?-1:1),p=1;else if(o==CKEDITOR.ALT+121&&!b._.tabBarMode&&b.getPageCount()>1)b._.tabBarMode=!0,b._.tabs[b._.currentTabId][0].focus(),p=1;else if(37!=o&&39!=o||!b._.tabBarMode)if(13!=o&&32!=o||!b._.tabBarMode)if(13==o)o=i.data.getTarget(),o.is("a","button","select","textarea")||o.is("input")&&"button"==o.$.type||((o=this.getButton("ok"))&&CKEDITOR.tools.setTimeout(o.click,0,o),p=1),m=1;else{if(27!=o)return;(o=this.getButton("cancel"))?CKEDITOR.tools.setTimeout(o.click,0,o):this.fire("cancel",{hide:!0}).hide!==!1&&this.hide(),m=1}else this.selectPage(this._.currentTabId),this._.tabBarMode=!1,this._.currentFocusIndex=-1,a(1),p=1;else o=o==(r?39:37)?t.call(b):e.call(b),b.selectPage(o),b._.tabs[o][0].focus(),p=1;c(i)}}function c(t){p?t.data.preventDefault(1):m&&t.data.stopPropagation()}var p,m,g=CKEDITOR.dialog._.dialogDefinitions[s],x=CKEDITOR.tools.clone(f),C=n.config.dialog_buttonsOrder||"OS",E=n.lang.dir,v={};if(("OS"==C&&CKEDITOR.env.mac||"rtl"==C&&"ltr"==E||"ltr"==C&&"rtl"==E)&&x.buttons.reverse(),g=CKEDITOR.tools.extend(g(n),x),g=CKEDITOR.tools.clone(g),g=new y(this,g),x=r(n),this._={editor:n,element:x.element,name:s,contentSize:{width:0,height:0},size:{width:0,height:0},contents:{},buttons:{},accessKeyMap:{},tabs:{},tabIdList:[],currentTabId:null,currentTabIndex:null,pageCount:0,lastTab:null,tabBarMode:!1,focusList:[],currentFocusIndex:0,hasFocus:!1},this.parts=x.parts,CKEDITOR.tools.setTimeout(function(){n.fire("ariaWidget",this.parts.contents)},0,this),x={position:CKEDITOR.env.ie6Compat?"absolute":"fixed",top:0,visibility:"hidden"},x["rtl"==E?"right":"left"]=0,this.parts.dialog.setStyles(x),CKEDITOR.event.call(this),this.definition=g=CKEDITOR.fire("dialogDefinition",{name:s,definition:g},n).definition,!("removeDialogTabs"in n._)&&n.config.removeDialogTabs){for(x=n.config.removeDialogTabs.split(";"),E=0;E<x.length;E++)if(C=x[E].split(":"),2==C.length){var T=C[0];v[T]||(v[T]=[]),v[T].push(C[1])}n._.removeDialogTabs=v}if(n._.removeDialogTabs&&(v=n._.removeDialogTabs[s]))for(E=0;E<v.length;E++)g.removeContents(v[E]);g.onLoad&&this.on("load",g.onLoad),g.onShow&&this.on("show",g.onShow),g.onHide&&this.on("hide",g.onHide),g.onOk&&this.on("ok",function(t){n.fire("saveSnapshot"),setTimeout(function(){n.fire("saveSnapshot")},0),g.onOk.call(this,t)===!1&&(t.data.hide=!1)}),g.onCancel&&this.on("cancel",function(t){g.onCancel.call(this,t)===!1&&(t.data.hide=!1)});var b=this,I=function(t){var e,n=b._.contents,i=!1;for(e in n)for(var o in n[e])if(i=t.call(this,n[e][o]))return};this.on("ok",function(t){I(function(e){if(e.validate){var n=e.validate(this),o="string"==typeof n||n===!1;return o&&(t.data.hide=!1,t.stop()),i.call(e,!o,"string"==typeof n?n:void 0),o}})},this,null,0),this.on("cancel",function(t){I(function(e){return e.isChanged()?(n.config.dialog_noConfirmCancel||confirm(n.lang.common.confirmCancel)||(t.data.hide=!1),!0):void 0})},this,null,0),this.parts.close.on("click",function(t){this.fire("cancel",{hide:!0}).hide!==!1&&this.hide(),t.data.preventDefault()},this),this.changeFocus=a;var S=this._.element;for(n.focusManager.add(S,1),this.on("show",function(){S.on("keydown",u,this),(CKEDITOR.env.opera||CKEDITOR.env.gecko)&&S.on("keypress",c,this)}),this.on("hide",function(){S.removeListener("keydown",u),(CKEDITOR.env.opera||CKEDITOR.env.gecko)&&S.removeListener("keypress",c),I(function(t){o.apply(t)})}),this.on("iframeAdded",function(t){new CKEDITOR.dom.document(t.data.iframe.$.contentWindow.document).on("keydown",u,this,null,0)}),this.on("show",function(){if(l(),n.config.dialog_startupFocusTab&&b._.pageCount>1)b._.tabBarMode=!0,b._.tabs[b._.currentTabId][0].focus();else if(!this._.hasFocus)if(this._.currentFocusIndex=-1,g.onFocus){var t=g.onFocus.call(this);t&&t.focus()}else a(1)},this,null,4294967295),CKEDITOR.env.ie6Compat&&this.on("load",function(){var t=this.getElement(),e=t.getFirst();e.remove(),e.appendTo(t)},this),h(this),d(this),new CKEDITOR.dom.text(g.title,CKEDITOR.document).appendTo(this.parts.title),E=0;E<g.contents.length;E++)(v=g.contents[E])&&this.addPage(v);for(this.parts.tabs.on("click",function(t){var e=t.data.getTarget();e.hasClass("cke_dialog_tab")&&(e=e.$.id,this.selectPage(e.substring(4,e.lastIndexOf("_"))),this._.tabBarMode&&(this._.tabBarMode=!1,this._.currentFocusIndex=-1,a(1)),t.data.preventDefault())},this),E=[],v=CKEDITOR.dialog._.uiElementBuilders.hbox.build(this,{type:"hbox",className:"cke_dialog_footer_buttons",widths:[],children:g.buttons},E).getChild(),this.parts.footer.setHtml(E.join("")),E=0;E<v.length;E++)this._.buttons[v[E].id]=v[E]},CKEDITOR.dialog.prototype={destroy:function(){this.hide(),this._.element.remove()},resize:function(){return function(t,e){this._.contentSize&&this._.contentSize.width==t&&this._.contentSize.height==e||(CKEDITOR.dialog.fire("resize",{dialog:this,width:t,height:e},this._.editor),this.fire("resize",{width:t,height:e},this._.editor),this.parts.contents.setStyles({width:t+"px",height:e+"px"}),"rtl"==this._.editor.lang.dir&&this._.position&&(this._.position.x=CKEDITOR.document.getWindow().getViewPaneSize().width-this._.contentSize.width-parseInt(this._.element.getFirst().getStyle("right"),10)),this._.contentSize={width:t,height:e})}}(),getSize:function(){var t=this._.element.getFirst();return{width:t.$.offsetWidth||0,height:t.$.offsetHeight||0}},move:function(t,e,n){var i=this._.element.getFirst(),o="rtl"==this._.editor.lang.dir,r="fixed"==i.getComputedStyle("position");CKEDITOR.env.ie&&i.setStyle("zoom","100%"),r&&this._.position&&this._.position.x==t&&this._.position.y==e||(this._.position={x:t,y:e},r||(r=CKEDITOR.document.getWindow().getScrollPosition(),t+=r.x,e+=r.y),o&&(r=this.getSize(),t=CKEDITOR.document.getWindow().getViewPaneSize().width-r.width-t),e={top:(e>0?e:0)+"px"},e[o?"right":"left"]=(t>0?t:0)+"px",i.setStyles(e),n&&(this._.moved=1))},getPosition:function(){return CKEDITOR.tools.extend({},this._.position)},show:function(){var t=this._.element,e=this.definition;if(t.getParent()&&t.getParent().equals(CKEDITOR.document.getBody())?t.setStyle("display","block"):t.appendTo(CKEDITOR.document.getBody()),CKEDITOR.env.gecko&&CKEDITOR.env.version<10900){var n=this.parts.dialog;n.setStyle("position","absolute"),setTimeout(function(){n.setStyle("position","fixed")},0)}this.resize(this._.contentSize&&this._.contentSize.width||e.width||e.minWidth,this._.contentSize&&this._.contentSize.height||e.height||e.minHeight),this.reset(),this.selectPage(this.definition.contents[0].id),null===CKEDITOR.dialog._.currentZIndex&&(CKEDITOR.dialog._.currentZIndex=this._.editor.config.baseFloatZIndex),this._.element.getFirst().setStyle("z-index",CKEDITOR.dialog._.currentZIndex=CKEDITOR.dialog._.currentZIndex+10),null===CKEDITOR.dialog._.currentTop?(CKEDITOR.dialog._.currentTop=this,this._.parentDialog=null,c(this._.editor)):(this._.parentDialog=CKEDITOR.dialog._.currentTop,this._.parentDialog.getElement().getFirst().$.style.zIndex-=Math.floor(this._.editor.config.baseFloatZIndex/2),CKEDITOR.dialog._.currentTop=this),t.on("keydown",S),t.on(CKEDITOR.env.opera?"keypress":"keyup",O),this._.hasFocus=!1;for(var i in e.contents)if(e.contents[i]){var t=e.contents[i],o=this._.tabs[t.id],r=t.requiredContent,s=0;if(o){for(var a in this._.contents[t.id]){var h=this._.contents[t.id][a];"hbox"!=h.type&&"vbox"!=h.type&&h.getInputElement()&&(h.requiredContent&&!this._.editor.activeFilter.check(h.requiredContent)?h.disable():(h.enable(),s++))}!s||r&&!this._.editor.activeFilter.check(r)?o[0].addClass("cke_dialog_tab_disabled"):o[0].removeClass("cke_dialog_tab_disabled")}}CKEDITOR.tools.setTimeout(function(){this.layout(),l(this),this.parts.dialog.setStyle("visibility",""),this.fireOnce("load",{}),CKEDITOR.ui.fire("ready",this),this.fire("show",{}),this._.editor.fire("dialogShow",this),this._.parentDialog||this._.editor.focusManager.lock(),this.foreach(function(t){t.setInitValue&&t.setInitValue()})},100,this)},layout:function(){var t=this.parts.dialog,e=this.getSize(),n=CKEDITOR.document.getWindow().getViewPaneSize(),i=(n.width-e.width)/2,o=(n.height-e.height)/2;CKEDITOR.env.ie6Compat||(e.height+(o>0?o:0)>n.height||e.width+(i>0?i:0)>n.width?t.setStyle("position","absolute"):t.setStyle("position","fixed")),this.move(this._.moved?this._.position.x:i,this._.moved?this._.position.y:o)},foreach:function(t){for(var e in this._.contents)for(var n in this._.contents[e])t.call(this,this._.contents[e][n]);return this},reset:function(){var t=function(t){t.reset&&t.reset(1)};return function(){return this.foreach(t),this}}(),setupContent:function(){var t=arguments;this.foreach(function(e){e.setup&&e.setup.apply(e,t)})},commitContent:function(){var t=arguments;this.foreach(function(e){CKEDITOR.env.ie&&this._.currentFocusIndex==e.focusIndex&&e.getInputElement().$.blur(),e.commit&&e.commit.apply(e,t)})},hide:function(){if(this.parts.dialog.isVisible()){this.fire("hide",{}),this._.editor.fire("dialogHide",this),this.selectPage(this._.tabIdList[0]);var t=this._.element;for(t.setStyle("display","none"),this.parts.dialog.setStyle("visibility","hidden"),w(this);CKEDITOR.dialog._.currentTop!=this;)CKEDITOR.dialog._.currentTop.hide();if(this._.parentDialog){var e=this._.parentDialog.getElement().getFirst();e.setStyle("z-index",parseInt(e.$.style.zIndex,10)+Math.floor(this._.editor.config.baseFloatZIndex/2))}else p(this._.editor);if(CKEDITOR.dialog._.currentTop=this._.parentDialog)CKEDITOR.dialog._.currentZIndex=CKEDITOR.dialog._.currentZIndex-10;else{CKEDITOR.dialog._.currentZIndex=null,t.removeListener("keydown",S),t.removeListener(CKEDITOR.env.opera?"keypress":"keyup",O);var n=this._.editor;n.focus(),setTimeout(function(){n.focusManager.unlock()},0)}delete this._.parentDialog,this.foreach(function(t){t.resetInitValue&&t.resetInitValue()})}},addPage:function(t){if(!t.requiredContent||this._.editor.filter.check(t.requiredContent)){for(var e=[],n=t.label?' title="'+CKEDITOR.tools.htmlEncode(t.label)+'"':"",i=CKEDITOR.dialog._.uiElementBuilders.vbox.build(this,{type:"vbox",className:"cke_dialog_page_contents",children:t.elements,expand:!!t.expand,padding:t.padding,style:t.style||"width: 100%;"},e),o=this._.contents[t.id]={},r=i.getChild(),s=0;i=r.shift();)!i.notAllowed&&"hbox"!=i.type&&"vbox"!=i.type&&s++,o[i.id]=i,"function"==typeof i.getChild&&r.push.apply(r,i.getChild());s||(t.hidden=!0),e=CKEDITOR.dom.element.createFromHtml(e.join("")),e.setAttribute("role","tabpanel"),i=CKEDITOR.env,o="cke_"+t.id+"_"+CKEDITOR.tools.getNextNumber(),n=CKEDITOR.dom.element.createFromHtml(['<a class="cke_dialog_tab"',this._.pageCount>0?" cke_last":"cke_first",n,t.hidden?' style="display:none"':"",' id="',o,'"',i.gecko&&i.version>=10900&&!i.hc?"":' href="javascript:void(0)"',' tabIndex="-1" hidefocus="true" role="tab">',t.label,"</a>"].join("")),e.setAttribute("aria-labelledby",o),this._.tabs[t.id]=[n,e],this._.tabIdList.push(t.id),!t.hidden&&this._.pageCount++,this._.lastTab=n,this.updateStyle(),e.setAttribute("name",t.id),e.appendTo(this.parts.contents),n.unselectable(),this.parts.tabs.append(n),t.accessKey&&(R(this,this,"CTRL+"+t.accessKey,_,D),this._.accessKeyMap["CTRL+"+t.accessKey]=t.id)}},selectPage:function(t){if(this._.currentTabId!=t&&!this._.tabs[t][0].hasClass("cke_dialog_tab_disabled")&&this.fire("selectPage",{page:t,currentPage:this._.currentTabId})!==!0){for(var e in this._.tabs){var i=this._.tabs[e][0],o=this._.tabs[e][1];e!=t&&(i.removeClass("cke_dialog_tab_selected"),o.hide()),o.setAttribute("aria-hidden",e!=t)}var r=this._.tabs[t];r[0].addClass("cke_dialog_tab_selected"),CKEDITOR.env.ie6Compat||CKEDITOR.env.ie7Compat?(n(r[1]),r[1].show(),setTimeout(function(){n(r[1],1)},0)):r[1].show(),this._.currentTabId=t,this._.currentTabIndex=CKEDITOR.tools.indexOf(this._.tabIdList,t)}},updateStyle:function(){this.parts.dialog[(1===this._.pageCount?"add":"remove")+"Class"]("cke_single_page")},hidePage:function(e){var n=this._.tabs[e]&&this._.tabs[e][0];n&&1!=this._.pageCount&&n.isVisible()&&(e==this._.currentTabId&&this.selectPage(t.call(this)),n.hide(),this._.pageCount--,this.updateStyle())},showPage:function(t){(t=this._.tabs[t]&&this._.tabs[t][0])&&(t.show(),this._.pageCount++,this.updateStyle())},getElement:function(){return this._.element},getName:function(){return this._.name},getContentElement:function(t,e){var n=this._.contents[t];return n&&n[e]},getValueOf:function(t,e){return this.getContentElement(t,e).getValue()},setValueOf:function(t,e,n){return this.getContentElement(t,e).setValue(n)},getButton:function(t){return this._.buttons[t]},click:function(t){return this._.buttons[t].click()},disableButton:function(t){return this._.buttons[t].disable()},enableButton:function(t){return this._.buttons[t].enable()},getPageCount:function(){return this._.pageCount},getParentEditor:function(){return this._.editor},getSelectedElement:function(){return this.getParentEditor().getSelection().getSelectedElement()},addFocusable:function(t,e){if("undefined"==typeof e)e=this._.focusList.length,this._.focusList.push(new s(this,t,e));else{this._.focusList.splice(e,0,new s(this,t,e));for(var n=e+1;n<this._.focusList.length;n++)this._.focusList[n].focusIndex++}}},CKEDITOR.tools.extend(CKEDITOR.dialog,{add:function(t,e){this._.dialogDefinitions[t]&&"function"!=typeof e||(this._.dialogDefinitions[t]=e)},exists:function(t){return!!this._.dialogDefinitions[t]},getCurrent:function(){return CKEDITOR.dialog._.currentTop},isTabEnabled:function(t,e,n){return t=t.config.removeDialogTabs,!(t&&t.match(RegExp("(?:^|;)"+e+":"+n+"(?:$|;)","i")))},okButton:function(){var t=function(t,e){return e=e||{},CKEDITOR.tools.extend({id:"ok",type:"button",label:t.lang.common.ok,"class":"cke_dialog_ui_button_ok",onClick:function(t){t=t.data.dialog,t.fire("ok",{hide:!0}).hide!==!1&&t.hide()}},e,!0)};return t.type="button",t.override=function(e){return CKEDITOR.tools.extend(function(n){return t(n,e)},{type:"button"},!0)},t}(),cancelButton:function(){var t=function(t,e){return e=e||{},CKEDITOR.tools.extend({id:"cancel",type:"button",label:t.lang.common.cancel,"class":"cke_dialog_ui_button_cancel",onClick:function(t){t=t.data.dialog,t.fire("cancel",{hide:!0}).hide!==!1&&t.hide()}},e,!0)};return t.type="button",t.override=function(e){return CKEDITOR.tools.extend(function(n){return t(n,e)},{type:"button"},!0)},t}(),addUIElement:function(t,e){this._.uiElementBuilders[t]=e}}),CKEDITOR.dialog._={uiElementBuilders:{},dialogDefinitions:{},currentTop:null,currentZIndex:null},CKEDITOR.event.implementOn(CKEDITOR.dialog),CKEDITOR.event.implementOn(CKEDITOR.dialog.prototype);var f={resizable:CKEDITOR.DIALOG_RESIZE_BOTH,minWidth:600,minHeight:400,buttons:[CKEDITOR.dialog.okButton,CKEDITOR.dialog.cancelButton]},x=function(t,e,n){for(var i,o=0;i=t[o];o++){if(i.id==e)return i;if(n&&i[n]&&(i=x(i[n],e,n)))return i}return null},C=function(t,e,n,i,o){if(n){for(var r,s=0;r=t[s];s++){if(r.id==n)return t.splice(s,0,e),e;if(i&&r[i]&&(r=C(r[i],e,n,i,!0)))return r}if(o)return null}return t.push(e),e},E=function(t,e,n){for(var i,o=0;i=t[o];o++){if(i.id==e)return t.splice(o,1);if(n&&i[n]&&(i=E(i[n],e,n)))return i}return null},y=function(t,e){this.dialog=t;for(var n,i=e.contents,o=0;n=i[o];o++)i[o]=n&&new a(t,n);CKEDITOR.tools.extend(this,e)};y.prototype={getContents:function(t){return x(this.contents,t)},getButton:function(t){return x(this.buttons,t)},addContents:function(t,e){return C(this.contents,t,e)},addButton:function(t,e){return C(this.buttons,t,e)},removeContents:function(t){E(this.contents,t)},removeButton:function(t){E(this.buttons,t)}},a.prototype={get:function(t){return x(this.elements,t,"children")},add:function(t,e){return C(this.elements,t,e,"children")},remove:function(t){E(this.elements,t,"children")}};var v,T,b={},I={},S=function(t){var e=t.data.$.ctrlKey||t.data.$.metaKey,n=t.data.$.altKey,i=t.data.$.shiftKey,o=String.fromCharCode(t.data.$.keyCode);(e=I[(e?"CTRL+":"")+(n?"ALT+":"")+(i?"SHIFT+":"")+o])&&e.length&&(e=e[e.length-1],e.keydown&&e.keydown.call(e.uiElement,e.dialog,e.key),t.data.preventDefault())},O=function(t){var e=t.data.$.ctrlKey||t.data.$.metaKey,n=t.data.$.altKey,i=t.data.$.shiftKey,o=String.fromCharCode(t.data.$.keyCode);(e=I[(e?"CTRL+":"")+(n?"ALT+":"")+(i?"SHIFT+":"")+o])&&e.length&&(e=e[e.length-1],e.keyup&&(e.keyup.call(e.uiElement,e.dialog,e.key),t.data.preventDefault()))},R=function(t,e,n,i,o){(I[n]||(I[n]=[])).push({uiElement:t,dialog:e,key:n,keyup:o||t.accessKeyUp,keydown:i||t.accessKeyDown})},w=function(t){for(var e in I){for(var n=I[e],i=n.length-1;i>=0;i--)(n[i].dialog==t||n[i].uiElement==t)&&n.splice(i,1);0===n.length&&delete I[e]}},D=function(t,e){t._.accessKeyMap[e]&&t.selectPage(t._.accessKeyMap[e])},_=function(){};!function(){CKEDITOR.ui.dialog={uiElement:function(t,e,n,i,o,r,s){if(!(arguments.length<4)){var l=(i.call?i(e):i)||"div",a=["<",l," "],h=(o&&o.call?o(e):o)||{},d=(r&&r.call?r(e):r)||{},u=(s&&s.call?s.call(this,t,e):s)||"",c=this.domId=d.id||CKEDITOR.tools.getNextId()+"_uiElement";this.id=e.id,e.requiredContent&&!t.getParentEditor().filter.check(e.requiredContent)&&(h.display="none",this.notAllowed=!0),d.id=c;var p={};e.type&&(p["cke_dialog_ui_"+e.type]=1),e.className&&(p[e.className]=1),e.disabled&&(p.cke_disabled=1);for(var m=d["class"]&&d["class"].split?d["class"].split(" "):[],c=0;c<m.length;c++)m[c]&&(p[m[c]]=1);m=[];for(c in p)m.push(c);d["class"]=m.join(" "),e.title&&(d.title=e.title),p=(e.style||"").split(";"),e.align&&(m=e.align,h["margin-left"]="left"==m?0:"auto",h["margin-right"]="right"==m?0:"auto");for(c in h)p.push(c+":"+h[c]);for(e.hidden&&p.push("display:none"),c=p.length-1;c>=0;c--)""===p[c]&&p.splice(c,1);p.length>0&&(d.style=(d.style?d.style+"; ":"")+p.join("; "));for(c in d)a.push(c+'="'+CKEDITOR.tools.htmlEncode(d[c])+'" ');a.push(">",u,"</",l,">"),n.push(a.join("")),(this._||(this._={})).dialog=t,"boolean"==typeof e.isChanged&&(this.isChanged=function(){return e.isChanged}),"function"==typeof e.isChanged&&(this.isChanged=e.isChanged),"function"==typeof e.setValue&&(this.setValue=CKEDITOR.tools.override(this.setValue,function(t){return function(n){t.call(this,e.setValue.call(this,n))}})),"function"==typeof e.getValue&&(this.getValue=CKEDITOR.tools.override(this.getValue,function(t){return function(){return e.getValue.call(this,t.call(this))}})),CKEDITOR.event.implementOn(this),this.registerEvents(e),this.accessKeyUp&&this.accessKeyDown&&e.accessKey&&R(this,t,"CTRL+"+e.accessKey);var g=this;t.on("load",function(){var e=g.getInputElement();if(e){var n=g.type in{checkbox:1,ratio:1}&&CKEDITOR.env.ie&&CKEDITOR.env.version<8?"cke_dialog_ui_focused":"";e.on("focus",function(){t._.tabBarMode=!1,t._.hasFocus=!0,g.fire("focus"),n&&this.addClass(n)}),e.on("blur",function(){g.fire("blur"),n&&this.removeClass(n)})}}),CKEDITOR.tools.extend(this,e),this.keyboardFocusable&&(this.tabIndex=e.tabIndex||0,this.focusIndex=t._.focusList.push(this)-1,this.on("focus",function(){t._.currentFocusIndex=g.focusIndex}))}},hbox:function(t,e,n,i,o){if(!(arguments.length<4)){this._||(this._={});var r,s=this._.children=e,l=o&&o.widths||null,a=o&&o.height||null,h={role:"presentation"};o&&o.align&&(h.align=o.align),CKEDITOR.ui.dialog.uiElement.call(this,t,o||{type:"hbox"},i,"table",{},h,function(){var t=['<tbody><tr class="cke_dialog_ui_hbox">'];
for(r=0;r<n.length;r++){var e="cke_dialog_ui_hbox_child",i=[];0===r&&(e="cke_dialog_ui_hbox_first"),r==n.length-1&&(e="cke_dialog_ui_hbox_last"),t.push('<td class="',e,'" role="presentation" '),l?l[r]&&i.push("width:"+m(l[r])):i.push("width:"+Math.floor(100/n.length)+"%"),a&&i.push("height:"+m(a)),o&&void 0!=o.padding&&i.push("padding:"+m(o.padding)),CKEDITOR.env.ie&&CKEDITOR.env.quirks&&s[r].align&&i.push("text-align:"+s[r].align),i.length>0&&t.push('style="'+i.join("; ")+'" '),t.push(">",n[r],"</td>")}return t.push("</tr></tbody>"),t.join("")})}},vbox:function(t,e,n,i,o){if(!(arguments.length<3)){this._||(this._={});var r=this._.children=e,s=o&&o.width||null,l=o&&o.heights||null;CKEDITOR.ui.dialog.uiElement.call(this,t,o||{type:"vbox"},i,"div",null,{role:"presentation"},function(){var e=['<table role="presentation" cellspacing="0" border="0" '];e.push('style="'),o&&o.expand&&e.push("height:100%;"),e.push("width:"+m(s||"100%"),";"),CKEDITOR.env.webkit&&e.push("float:none;"),e.push('"'),e.push('align="',CKEDITOR.tools.htmlEncode(o&&o.align||("ltr"==t.getParentEditor().lang.dir?"left":"right")),'" '),e.push("><tbody>");for(var i=0;i<n.length;i++){var a=[];e.push('<tr><td role="presentation" '),s&&a.push("width:"+m(s||"100%")),l?a.push("height:"+m(l[i])):o&&o.expand&&a.push("height:"+Math.floor(100/n.length)+"%"),o&&void 0!=o.padding&&a.push("padding:"+m(o.padding)),CKEDITOR.env.ie&&CKEDITOR.env.quirks&&r[i].align&&a.push("text-align:"+r[i].align),a.length>0&&e.push('style="',a.join("; "),'" '),e.push(' class="cke_dialog_ui_vbox_child">',n[i],"</td></tr>")}return e.push("</tbody></table>"),e.join("")})}}}}(),CKEDITOR.ui.dialog.uiElement.prototype={getElement:function(){return CKEDITOR.document.getById(this.domId)},getInputElement:function(){return this.getElement()},getDialog:function(){return this._.dialog},setValue:function(t,e){return this.getInputElement().setValue(t),!e&&this.fire("change",{value:t}),this},getValue:function(){return this.getInputElement().getValue()},isChanged:function(){return!1},selectParentTab:function(){for(var t=this.getInputElement();(t=t.getParent())&&-1==t.$.className.search("cke_dialog_page_contents"););return t?(t=t.getAttribute("name"),this._.dialog._.currentTabId!=t&&this._.dialog.selectPage(t),this):this},focus:function(){return this.selectParentTab().getInputElement().focus(),this},registerEvents:function(t){var e,n,i=/^on([A-Z]\w+)/,o=function(t,e,n,i){e.on("load",function(){t.getInputElement().on(n,i,t)})};for(n in t)(e=n.match(i))&&(this.eventProcessors[n]?this.eventProcessors[n].call(this,this._.dialog,t[n]):o(this,this._.dialog,e[1].toLowerCase(),t[n]));return this},eventProcessors:{onLoad:function(t,e){t.on("load",e,this)},onShow:function(t,e){t.on("show",e,this)},onHide:function(t,e){t.on("hide",e,this)}},accessKeyDown:function(){this.focus()},accessKeyUp:function(){},disable:function(){var t=this.getElement();this.getInputElement().setAttribute("disabled","true"),t.addClass("cke_disabled")},enable:function(){var t=this.getElement();this.getInputElement().removeAttribute("disabled"),t.removeClass("cke_disabled")},isEnabled:function(){return!this.getElement().hasClass("cke_disabled")},isVisible:function(){return this.getInputElement().isVisible()},isFocusable:function(){return this.isEnabled()&&this.isVisible()?!0:!1}},CKEDITOR.ui.dialog.hbox.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{getChild:function(t){return arguments.length<1?this._.children.concat():(t.splice||(t=[t]),t.length<2?this._.children[t[0]]:this._.children[t[0]]&&this._.children[t[0]].getChild?this._.children[t[0]].getChild(t.slice(1,t.length)):null)}},!0),CKEDITOR.ui.dialog.vbox.prototype=new CKEDITOR.ui.dialog.hbox,function(){var t={build:function(t,e,n){for(var i,o=e.children,r=[],s=[],l=0;l<o.length&&(i=o[l]);l++){var a=[];r.push(a),s.push(CKEDITOR.dialog._.uiElementBuilders[i.type].build(t,i,a))}return new CKEDITOR.ui.dialog[e.type](t,s,r,n,e)}};CKEDITOR.dialog.addUIElement("hbox",t),CKEDITOR.dialog.addUIElement("vbox",t)}(),CKEDITOR.dialogCommand=function(t,e){this.dialogName=t,CKEDITOR.tools.extend(this,e,!0)},CKEDITOR.dialogCommand.prototype={exec:function(t){CKEDITOR.env.opera?CKEDITOR.tools.setTimeout(function(){t.openDialog(this.dialogName)},0,this):t.openDialog(this.dialogName)},canUndo:!1,editorFocus:1},function(){var t=/^([a]|[^a])+$/,e=/^\d*$/,n=/^\d*(?:\.\d+)?$/,i=/^(((\d*(\.\d+))|(\d*))(px|\%)?)?$/,o=/^(((\d*(\.\d+))|(\d*))(px|em|ex|in|cm|mm|pt|pc|\%)?)?$/i,r=/^(\s*[\w-]+\s*:\s*[^:;]+(?:;|$))*$/;CKEDITOR.VALIDATE_OR=1,CKEDITOR.VALIDATE_AND=2,CKEDITOR.dialog.validate={functions:function(){var t=arguments;return function(){var e,n=this&&this.getValue?this.getValue():t[0],i=void 0,o=CKEDITOR.VALIDATE_AND,r=[];for(e=0;e<t.length&&"function"==typeof t[e];e++)r.push(t[e]);e<t.length&&"string"==typeof t[e]&&(i=t[e],e++),e<t.length&&"number"==typeof t[e]&&(o=t[e]);var s=o==CKEDITOR.VALIDATE_AND?!0:!1;for(e=0;e<r.length;e++)s=o==CKEDITOR.VALIDATE_AND?s&&r[e](n):s||r[e](n);return s?!0:i}},regex:function(t,e){return function(n){return n=this&&this.getValue?this.getValue():n,t.test(n)?!0:e}},notEmpty:function(e){return this.regex(t,e)},integer:function(t){return this.regex(e,t)},number:function(t){return this.regex(n,t)},cssLength:function(t){return this.functions(function(t){return o.test(CKEDITOR.tools.trim(t))},t)},htmlLength:function(t){return this.functions(function(t){return i.test(CKEDITOR.tools.trim(t))},t)},inlineStyle:function(t){return this.functions(function(t){return r.test(CKEDITOR.tools.trim(t))},t)},equals:function(t,e){return this.functions(function(e){return e==t},e)},notEqual:function(t,e){return this.functions(function(e){return e!=t},e)}},CKEDITOR.on("instanceDestroyed",function(t){if(CKEDITOR.tools.isEmpty(CKEDITOR.instances)){for(var e;e=CKEDITOR.dialog._.currentTop;)e.hide();for(var n in b)b[n].remove();b={}}var i,t=t.editor._.storedDialogs;for(i in t)t[i].destroy()})}(),CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{openDialog:function(t,e){var n=null,i=CKEDITOR.dialog._.dialogDefinitions[t];if(null===CKEDITOR.dialog._.currentTop&&c(this),"function"==typeof i)n=this._.storedDialogs||(this._.storedDialogs={}),n=n[t]||(n[t]=new CKEDITOR.dialog(this,t)),e&&e.call(n,n),n.show();else{if("failed"==i)throw p(this),Error('[CKEDITOR.dialog.openDialog] Dialog "'+t+'" failed when loading definition.');"string"==typeof i&&CKEDITOR.scriptLoader.load(CKEDITOR.getUrl(i),function(){"function"!=typeof CKEDITOR.dialog._.dialogDefinitions[t]&&(CKEDITOR.dialog._.dialogDefinitions[t]="failed"),this.openDialog(t,e)},this,0,1)}return CKEDITOR.skin.loadPart("dialog"),n}})}(),CKEDITOR.plugins.add("dialog",{requires:"dialogui",init:function(t){t.on("doubleclick",function(e){e.data.dialog&&t.openDialog(e.data.dialog)},null,null,999)}}),function(){CKEDITOR.plugins.add("a11yhelp",{requires:"dialog",availableLangs:{ar:1,bg:1,ca:1,cs:1,cy:1,da:1,de:1,el:1,en:1,eo:1,es:1,et:1,fa:1,fi:1,fr:1,"fr-ca":1,gl:1,gu:1,he:1,hi:1,hr:1,hu:1,id:1,it:1,ja:1,km:1,ko:1,ku:1,lt:1,lv:1,mk:1,mn:1,nb:1,nl:1,no:1,pl:1,pt:1,"pt-br":1,ro:1,ru:1,si:1,sk:1,sl:1,sq:1,sr:1,"sr-latn":1,sv:1,th:1,tr:1,ug:1,uk:1,vi:1,zh:1,"zh-cn":1},init:function(t){var e=this;t.addCommand("a11yHelp",{exec:function(){var n=t.langCode,n=e.availableLangs[n]?n:e.availableLangs[n.replace(/-.*/,"")]?n.replace(/-.*/,""):"en";CKEDITOR.scriptLoader.load(CKEDITOR.getUrl(e.path+"dialogs/lang/"+n+".js"),function(){t.lang.a11yhelp=e.langEntries[n],t.openDialog("a11yHelp")})},modes:{wysiwyg:1,source:1},readOnly:1,canUndo:!1}),t.setKeystroke(CKEDITOR.ALT+48,"a11yHelp"),CKEDITOR.dialog.add("a11yHelp",this.path+"dialogs/a11yhelp.js")}})}(),CKEDITOR.plugins.add("about",{requires:"dialog",init:function(t){var e=t.addCommand("about",new CKEDITOR.dialogCommand("about"));e.modes={wysiwyg:1,source:1},e.canUndo=!1,e.readOnly=1,t.ui.addButton&&t.ui.addButton("About",{label:t.lang.about.title,command:"about",toolbar:"about"}),CKEDITOR.dialog.add("about",this.path+"dialogs/about.js")}}),CKEDITOR.plugins.add("basicstyles",{init:function(t){var e=0,n=function(n,o,r,s){if(s){var s=new CKEDITOR.style(s),l=i[r];l.unshift(s),t.attachStyleStateChange(s,function(e){!t.readOnly&&t.getCommand(r).setState(e)}),t.addCommand(r,new CKEDITOR.styleCommand(s,{contentForms:l})),t.ui.addButton&&t.ui.addButton(n,{label:o,command:r,toolbar:"basicstyles,"+(e+=10)})}},i={bold:["strong","b",["span",function(t){return t=t.styles["font-weight"],"bold"==t||+t>=700}]],italic:["em","i",["span",function(t){return"italic"==t.styles["font-style"]}]],underline:["u",["span",function(t){return"underline"==t.styles["text-decoration"]}]],strike:["s","strike",["span",function(t){return"line-through"==t.styles["text-decoration"]}]],subscript:["sub"],superscript:["sup"]},o=t.config,r=t.lang.basicstyles;n("Bold",r.bold,"bold",o.coreStyles_bold),n("Italic",r.italic,"italic",o.coreStyles_italic),n("Underline",r.underline,"underline",o.coreStyles_underline),n("Strike",r.strike,"strike",o.coreStyles_strike),n("Subscript",r.subscript,"subscript",o.coreStyles_subscript),n("Superscript",r.superscript,"superscript",o.coreStyles_superscript),t.setKeystroke([[CKEDITOR.CTRL+66,"bold"],[CKEDITOR.CTRL+73,"italic"],[CKEDITOR.CTRL+85,"underline"]])}}),CKEDITOR.config.coreStyles_bold={element:"strong",overrides:"b"},CKEDITOR.config.coreStyles_italic={element:"em",overrides:"i"},CKEDITOR.config.coreStyles_underline={element:"u"},CKEDITOR.config.coreStyles_strike={element:"s",overrides:"strike"},CKEDITOR.config.coreStyles_subscript={element:"sub"},CKEDITOR.config.coreStyles_superscript={element:"sup"},function(){var t={exec:function(t){var e=t.getCommand("blockquote").state,n=t.getSelection(),i=n&&n.getRanges()[0];if(i){var o=n.createBookmarks();if(CKEDITOR.env.ie){var r,s=o[0].startNode,l=o[0].endNode;if(s&&"blockquote"==s.getParent().getName())for(r=s;r=r.getNext();)if(r.type==CKEDITOR.NODE_ELEMENT&&r.isBlockBoundary()){s.move(r,!0);break}if(l&&"blockquote"==l.getParent().getName())for(r=l;r=r.getPrevious();)if(r.type==CKEDITOR.NODE_ELEMENT&&r.isBlockBoundary()){l.move(r);break}}var a=i.createIterator();if(a.enlargeBr=t.config.enterMode!=CKEDITOR.ENTER_BR,e==CKEDITOR.TRISTATE_OFF){for(s=[];e=a.getNextParagraph();)s.push(e);for(s.length<1&&(e=t.document.createElement(t.config.enterMode==CKEDITOR.ENTER_P?"p":"div"),l=o.shift(),i.insertNode(e),e.append(new CKEDITOR.dom.text("",t.document)),i.moveToBookmark(l),i.selectNodeContents(e),i.collapse(!0),l=i.createBookmark(),s.push(e),o.unshift(l)),r=s[0].getParent(),i=[],l=0;l<s.length;l++)e=s[l],r=r.getCommonAncestor(e.getParent());for(e={table:1,tbody:1,tr:1,ol:1,ul:1};e[r.getName()];)r=r.getParent();for(l=null;s.length>0;){for(e=s.shift();!e.getParent().equals(r);)e=e.getParent();e.equals(l)||i.push(e),l=e}for(;i.length>0;)if(e=i.shift(),"blockquote"==e.getName()){for(l=new CKEDITOR.dom.documentFragment(t.document);e.getFirst();)l.append(e.getFirst().remove()),s.push(l.getLast());l.replace(e)}else s.push(e);for(i=t.document.createElement("blockquote"),i.insertBefore(s[0]);s.length>0;)e=s.shift(),i.append(e)}else if(e==CKEDITOR.TRISTATE_ON){for(l=[],r={};e=a.getNextParagraph();){for(s=i=null;e.getParent();){if("blockquote"==e.getParent().getName()){i=e.getParent(),s=e;break}e=e.getParent()}i&&s&&!s.getCustomData("blockquote_moveout")&&(l.push(s),CKEDITOR.dom.element.setMarker(r,s,"blockquote_moveout",!0))}for(CKEDITOR.dom.element.clearAllMarkers(r),e=[],s=[],r={};l.length>0;)a=l.shift(),i=a.getParent(),a.getPrevious()?a.getNext()?(a.breakParent(a.getParent()),s.push(a.getNext())):a.remove().insertAfter(i):a.remove().insertBefore(i),i.getCustomData("blockquote_processed")||(s.push(i),CKEDITOR.dom.element.setMarker(r,i,"blockquote_processed",!0)),e.push(a);for(CKEDITOR.dom.element.clearAllMarkers(r),l=s.length-1;l>=0;l--){i=s[l];t:{r=i;for(var a=0,h=r.getChildCount(),d=void 0;h>a&&(d=r.getChild(a));a++)if(d.type==CKEDITOR.NODE_ELEMENT&&d.isBlockBoundary()){r=!1;break t}r=!0}r&&i.remove()}if(t.config.enterMode==CKEDITOR.ENTER_BR)for(i=!0;e.length;)if(a=e.shift(),"div"==a.getName()){for(l=new CKEDITOR.dom.documentFragment(t.document),i&&a.getPrevious()&&!(a.getPrevious().type==CKEDITOR.NODE_ELEMENT&&a.getPrevious().isBlockBoundary())&&l.append(t.document.createElement("br")),i=a.getNext()&&!(a.getNext().type==CKEDITOR.NODE_ELEMENT&&a.getNext().isBlockBoundary());a.getFirst();)a.getFirst().remove().appendTo(l);i&&l.append(t.document.createElement("br")),l.replace(a),i=!1}}n.selectBookmarks(o),t.focus()}},refresh:function(t,e){this.setState(t.elementPath(e.block||e.blockLimit).contains("blockquote",1)?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)},context:"blockquote",allowedContent:"blockquote",requiredContent:"blockquote"};CKEDITOR.plugins.add("blockquote",{init:function(e){e.blockless||(e.addCommand("blockquote",t),e.ui.addButton&&e.ui.addButton("Blockquote",{label:e.lang.blockquote.toolbar,command:"blockquote",toolbar:"blocks,10"}))}})}(),function(){function t(t){function e(){var e=t.editable();e.on(C,function(t){(!CKEDITOR.env.ie||!g)&&c(t)}),CKEDITOR.env.ie&&e.on("paste",function(e){f||(o(),e.data.preventDefault(),c(e),s("paste")||t.openDialog("paste"))}),CKEDITOR.env.ie&&(e.on("contextmenu",r,null,null,0),e.on("beforepaste",function(t){t.data&&!t.data.$.ctrlKey&&r()},null,null,0)),e.on("beforecut",function(){!g&&a(t)});var n;e.attachListener(CKEDITOR.env.ie?e:t.document.getDocumentElement(),"mouseup",function(){n=setTimeout(function(){p()},0)}),t.on("destroy",function(){clearTimeout(n)}),e.on("keyup",p)}function n(e){return{type:e,canUndo:"cut"==e,startDisabled:!0,exec:function(){"cut"==this.type&&a();var e,n=this.type;if(CKEDITOR.env.ie)e=s(n);else try{e=t.document.$.execCommand(n,!1,null)}catch(i){e=!1}return e||alert(t.lang.clipboard[this.type+"Error"]),e}}}function i(){return{canUndo:!1,async:!0,exec:function(t,e){var n=function(e,n){e&&l(e.type,e.dataValue,!!n),t.fire("afterCommandExec",{name:"paste",command:i,returnValue:!!e})},i=this;"string"==typeof e?n({type:"auto",dataValue:e},1):t.getClipboardData(n)}}}function o(){f=1,setTimeout(function(){f=0},100)}function r(){g=1,setTimeout(function(){g=0},10)}function s(e){var n=t.document,i=n.getBody(),o=!1,r=function(){o=!0};return i.on(e,r),(CKEDITOR.env.version>7?n.$:n.$.selection.createRange()).execCommand(e),i.removeListener(e,r),o}function l(e,n,i){return e={type:e},i&&!t.fire("beforePaste",e)||!n?!1:(e.dataValue=n,t.fire("paste",e))}function a(){if(CKEDITOR.env.ie&&!CKEDITOR.env.quirks){var e,n,i,o=t.getSelection();o.getType()==CKEDITOR.SELECTION_ELEMENT&&(e=o.getSelectedElement())&&(n=o.getRanges()[0],i=t.document.createText(""),i.insertBefore(e),n.setStartBefore(i),n.setEndAfter(e),o.selectRanges([n]),setTimeout(function(){e.getParent()&&(i.remove(),o.selectElement(e))},0))}}function h(e,n){var i,o=t.document,r=t.editable(),s=function(t){t.cancel()},l=CKEDITOR.env.gecko&&CKEDITOR.env.version<=10902;if(!o.getById("cke_pastebin")){var a=t.getSelection(),h=a.createBookmarks(),d=new CKEDITOR.dom.element(!CKEDITOR.env.webkit&&!r.is("body")||CKEDITOR.env.ie||CKEDITOR.env.opera?"div":"body",o);d.setAttributes({id:"cke_pastebin","data-cke-temp":"1"}),CKEDITOR.env.opera&&d.appendBogus();var u=0,o=o.getWindow();l?(d.insertAfter(h[0].startNode),d.setStyle("display","inline")):(CKEDITOR.env.webkit?(r.append(d),d.addClass("cke_editable"),r.is("body")||(l="static"!=r.getComputedStyle("position")?r:CKEDITOR.dom.element.get(r.$.offsetParent),u=l.getDocumentPosition().y)):r.getAscendant(CKEDITOR.env.ie||CKEDITOR.env.opera?"body":"html",1).append(d),d.setStyles({position:"absolute",top:o.getScrollPosition().y-u+10+"px",width:"1px",height:Math.max(1,o.getViewPaneSize().height-20)+"px",overflow:"hidden",margin:0,padding:0})),(l=d.getParent().isReadOnly())?(d.setOpacity(0),d.setAttribute("contenteditable",!0)):d.setStyle("ltr"==t.config.contentsLangDirection?"left":"right","-1000px"),t.on("selectionChange",s,null,null,0),(CKEDITOR.env.webkit||CKEDITOR.env.gecko)&&(i=r.once("blur",s,null,null,-100)),l&&d.focus(),l=new CKEDITOR.dom.range(d),l.selectNodeContents(d);var c=l.select();CKEDITOR.env.ie&&(i=r.once("blur",function(){t.lockSelection(c)}));var p=CKEDITOR.document.getWindow().getScrollPosition().y;setTimeout(function(){(CKEDITOR.env.webkit||CKEDITOR.env.opera)&&(CKEDITOR.document[CKEDITOR.env.webkit?"getBody":"getDocumentElement"]().$.scrollTop=p),i&&i.removeListener(),CKEDITOR.env.ie&&r.focus(),a.selectBookmarks(h),d.remove();var e;CKEDITOR.env.webkit&&(e=d.getFirst())&&e.is&&e.hasClass("Apple-style-span")&&(d=e),t.removeListener("selectionChange",s),n(d.getHtml())},0)}}function d(){if(CKEDITOR.env.ie){t.focus(),o();var e=t.focusManager;if(e.lock(),t.editable().fire(C)&&!s("paste"))return e.unlock(),!1;e.unlock()}else try{if(t.editable().fire(C)&&!t.document.$.execCommand("Paste",!1,null))throw 0}catch(n){return!1}return!0}function u(e){if("wysiwyg"==t.mode)switch(e.data.keyCode){case CKEDITOR.CTRL+86:case CKEDITOR.SHIFT+45:e=t.editable(),o(),!CKEDITOR.env.ie&&e.fire("beforepaste"),(CKEDITOR.env.opera||CKEDITOR.env.gecko&&CKEDITOR.env.version<10900)&&e.fire("paste");break;case CKEDITOR.CTRL+88:case CKEDITOR.SHIFT+46:t.fire("saveSnapshot"),setTimeout(function(){t.fire("saveSnapshot")},50)}}function c(e){var n={type:"auto"},i=t.fire("beforePaste",n);h(e,function(t){t=t.replace(/<span[^>]+data-cke-bookmark[^<]*?<\/span>/gi,""),i&&l(n.type,t,0,1)})}function p(){if("wysiwyg"==t.mode){var e=m("paste");t.getCommand("cut").setState(m("cut")),t.getCommand("copy").setState(m("copy")),t.getCommand("paste").setState(e),t.fire("pasteState",e)}}function m(e){if(x&&e in{paste:1,cut:1})return CKEDITOR.TRISTATE_DISABLED;if("paste"==e)return CKEDITOR.TRISTATE_OFF;var e=t.getSelection(),n=e.getRanges();return e.getType()==CKEDITOR.SELECTION_NONE||1==n.length&&n[0].collapsed?CKEDITOR.TRISTATE_DISABLED:CKEDITOR.TRISTATE_OFF}var g=0,f=0,x=0,C=CKEDITOR.env.ie?"beforepaste":"paste";!function(){t.on("key",u),t.on("contentDom",e),t.on("selectionChange",function(t){x=t.data.selection.getRanges()[0].checkReadOnly(),p()}),t.contextMenu&&t.contextMenu.addListener(function(t,e){return x=e.getRanges()[0].checkReadOnly(),{cut:m("cut"),copy:m("copy"),paste:m("paste")}})}(),function(){function e(e,n,i,o,r){var s=t.lang.clipboard[n];t.addCommand(n,i),t.ui.addButton&&t.ui.addButton(e,{label:s,command:n,toolbar:"clipboard,"+o}),t.addMenuItems&&t.addMenuItem(n,{label:s,command:n,group:"clipboard",order:r})}e("Cut","cut",n("cut"),10,1),e("Copy","copy",n("copy"),20,4),e("Paste","paste",i(),30,8)}(),t.getClipboardData=function(e,n){function i(t){t.removeListener(),t.cancel(),n(t.data)}function o(t){t.removeListener(),t.cancel(),a=!0,n({type:l,dataValue:t.data})}function r(){this.customTitle=e&&e.title}var s=!1,l="auto",a=!1;n||(n=e,e=null),t.on("paste",i,null,null,0),t.on("beforePaste",function(t){t.removeListener(),s=!0,l=t.data.type},null,null,1e3),d()===!1&&(t.removeListener("paste",i),s&&t.fire("pasteDialog",r)?(t.on("pasteDialogCommit",o),t.on("dialogHide",function(t){t.removeListener(),t.data.removeListener("pasteDialogCommit",o),setTimeout(function(){a||n(null)},10)})):n(null))}}function e(t){if(CKEDITOR.env.webkit){if(!t.match(/^[^<]*$/g)&&!t.match(/^(<div><br( ?\/)?><\/div>|<div>[^<]*<\/div>)*$/gi))return"html"}else if(CKEDITOR.env.ie){if(!t.match(/^([^<]|<br( ?\/)?>)*$/gi)&&!t.match(/^(<p>([^<]|<br( ?\/)?>)*<\/p>|(\r\n))*$/gi))return"html"}else{if(!CKEDITOR.env.gecko&&!CKEDITOR.env.opera)return"html";if(!t.match(/^([^<]|<br( ?\/)?>)*$/gi))return"html"}return"htmlifiedtext"}function n(t,e){function n(t){return CKEDITOR.tools.repeat("</p><p>",~~(t/2))+(t%2==1?"<br>":"")}return e=e.replace(/\s+/g," ").replace(/> +</g,"><").replace(/<br ?\/>/gi,"<br>"),e=e.replace(/<\/?[A-Z]+>/g,function(t){return t.toLowerCase()}),e.match(/^[^<]$/)?e:(CKEDITOR.env.webkit&&e.indexOf("<div>")>-1&&(e=e.replace(/^(<div>(<br>|)<\/div>)(?!$|(<div>(<br>|)<\/div>))/g,"<br>").replace(/^(<div>(<br>|)<\/div>){2}(?!$)/g,"<div></div>"),e.match(/<div>(<br>|)<\/div>/)&&(e="<p>"+e.replace(/(<div>(<br>|)<\/div>)+/g,function(t){return n(t.split("</div><div>").length+1)})+"</p>"),e=e.replace(/<\/div><div>/g,"<br>"),e=e.replace(/<\/?div>/g,"")),(CKEDITOR.env.gecko||CKEDITOR.env.opera)&&t.enterMode!=CKEDITOR.ENTER_BR&&(CKEDITOR.env.gecko&&(e=e.replace(/^<br><br>$/,"<br>")),e.indexOf("<br><br>")>-1&&(e="<p>"+e.replace(/(<br>){2,}/g,function(t){return n(t.length/4)})+"</p>")),r(t,e))}function i(){var t=new CKEDITOR.htmlParser.filter,e={blockquote:1,dl:1,fieldset:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,ol:1,p:1,table:1,ul:1},n=CKEDITOR.tools.extend({br:0},CKEDITOR.dtd.$inline),i={p:1,br:1,"cke:br":1},o=CKEDITOR.dtd,r=CKEDITOR.tools.extend({area:1,basefont:1,embed:1,iframe:1,map:1,object:1,param:1},CKEDITOR.dtd.$nonBodyContent,CKEDITOR.dtd.$cdata),s=function(t){delete t.name,t.add(new CKEDITOR.htmlParser.text(" "))},l=function(t){for(var e,n=t;(n=n.next)&&n.name&&n.name.match(/^h\d$/);)for(e=new CKEDITOR.htmlParser.element("cke:br"),e.isEmpty=!0,t.add(e);e=n.children.shift();)t.add(e)};return t.addRules({elements:{h1:l,h2:l,h3:l,h4:l,h5:l,h6:l,img:function(t){var t=CKEDITOR.tools.trim(t.attributes.alt||""),e=" ";return t&&!t.match(/(^http|\.(jpe?g|gif|png))/i)&&(e=" ["+t+"] "),new CKEDITOR.htmlParser.text(e)},td:s,th:s,$:function(t){var s,l=t.name;if(r[l])return!1;if(t.attributes={},"br"==l)return t;if(e[l])t.name="p";else if(n[l])delete t.name;else if(o[l]){if(s=new CKEDITOR.htmlParser.element("cke:br"),s.isEmpty=!0,CKEDITOR.dtd.$empty[l])return s;t.add(s,0),s=s.clone(),s.isEmpty=!0,t.add(s),delete t.name}return i[t.name]||delete t.name,t}}},{applyToAll:!0}),t}function o(t,e,n){var e=new CKEDITOR.htmlParser.fragment.fromHtml(e),i=new CKEDITOR.htmlParser.basicWriter;e.writeHtml(i,n);var e=i.getHtml(),e=e.replace(/\s*(<\/?[a-z:]+ ?\/?>)\s*/g,"$1").replace(/(<cke:br \/>){2,}/g,"<cke:br />").replace(/(<cke:br \/>)(<\/?p>|<br \/>)/g,"$2").replace(/(<\/?p>|<br \/>)(<cke:br \/>)/g,"$1").replace(/<(cke:)?br( \/)?>/g,"<br>").replace(/<p><\/p>/g,""),o=0,e=e.replace(/<\/?p>/g,function(t){if("<p>"==t){if(++o>1)return"</p><p>"}else if(--o>0)return"</p><p>";return t}).replace(/<p><\/p>/g,"");return r(t,e)}function r(t,e){return t.enterMode==CKEDITOR.ENTER_BR?e=e.replace(/(<\/p><p>)+/g,function(t){return CKEDITOR.tools.repeat("<br>",t.length/7*2)}).replace(/<\/?p>/g,""):t.enterMode==CKEDITOR.ENTER_DIV&&(e=e.replace(/<(\/)?p>/g,"<$1div>")),e}CKEDITOR.plugins.add("clipboard",{requires:"dialog",init:function(r){var s;t(r),CKEDITOR.dialog.add("paste",CKEDITOR.getUrl(this.path+"dialogs/paste.js")),r.on("paste",function(t){var e=t.data.dataValue,n=CKEDITOR.dtd.$block;if(e.indexOf("Apple-")>-1&&(e=e.replace(/<span class="Apple-converted-space">&nbsp;<\/span>/gi," "),"html"!=t.data.type&&(e=e.replace(/<span class="Apple-tab-span"[^>]*>([^<]*)<\/span>/gi,function(t,e){return e.replace(/\t/g,"&nbsp;&nbsp; &nbsp;")})),e.indexOf('<br class="Apple-interchange-newline">')>-1&&(t.data.startsWithEOL=1,t.data.preSniffing="html",e=e.replace(/<br class="Apple-interchange-newline">/,"")),e=e.replace(/(<[^>]+) class="Apple-[^"]*"/gi,"$1")),e.match(/^<[^<]+cke_(editable|contents)/i)){var i,o,r=new CKEDITOR.dom.element("div");for(r.setHtml(e);1==r.getChildCount()&&(i=r.getFirst())&&i.type==CKEDITOR.NODE_ELEMENT&&(i.hasClass("cke_editable")||i.hasClass("cke_contents"));)r=o=i;o&&(e=o.getHtml().replace(/<br>$/i,""))}CKEDITOR.env.ie?e=e.replace(/^&nbsp;(?: |\r\n)?<(\w+)/g,function(e,i){return i.toLowerCase()in n?(t.data.preSniffing="html","<"+i):e}):CKEDITOR.env.webkit?e=e.replace(/<\/(\w+)><div><br><\/div>$/,function(e,i){return i in n?(t.data.endsWithEOL=1,"</"+i+">"):e}):CKEDITOR.env.gecko&&(e=e.replace(/(\s)<br>$/,"$1")),t.data.dataValue=e},null,null,3),r.on("paste",function(t){var l,t=t.data,a=t.type,h=t.dataValue,d=r.config.clipboard_defaultContentType||"html";l="html"==a||"html"==t.preSniffing?"html":e(h),"htmlifiedtext"==l?h=n(r.config,h):"text"==a&&"html"==l&&(h=o(r.config,h,s||(s=i(r)))),t.startsWithEOL&&(h='<br data-cke-eol="1">'+h),t.endsWithEOL&&(h+='<br data-cke-eol="1">'),"auto"==a&&(a="html"==l||"html"==d?"html":"text"),t.type=a,t.dataValue=h,delete t.preSniffing,delete t.startsWithEOL,delete t.endsWithEOL},null,null,6),r.on("paste",function(t){t=t.data,r.insertHtml(t.dataValue,t.type),setTimeout(function(){r.fire("afterPaste")},0)},null,null,1e3),r.on("pasteDialog",function(t){setTimeout(function(){r.openDialog("paste",t.data)},0)})}})}(),function(){CKEDITOR.plugins.add("panel",{beforeInit:function(t){t.ui.addHandler(CKEDITOR.UI_PANEL,CKEDITOR.ui.panel.handler)}}),CKEDITOR.UI_PANEL="panel",CKEDITOR.ui.panel=function(t,e){e&&CKEDITOR.tools.extend(this,e),CKEDITOR.tools.extend(this,{className:"",css:[]}),this.id=CKEDITOR.tools.getNextId(),this.document=t,this.isFramed=this.forceIFrame||this.css.length,this._={blocks:{}}},CKEDITOR.ui.panel.handler={create:function(t){return new CKEDITOR.ui.panel(t)}};var t=CKEDITOR.addTemplate("panel",'<div lang="{langCode}" id="{id}" dir={dir} class="cke cke_reset_all {editorId} cke_panel cke_panel {cls} cke_{dir}" style="z-index:{z-index}" role="presentation">{frame}</div>'),e=CKEDITOR.addTemplate("panel-frame",'<iframe id="{id}" class="cke_panel_frame" role="presentation" frameborder="0" src="{src}"></iframe>'),n=CKEDITOR.addTemplate("panel-frame-inner",'<!DOCTYPE html><html class="cke_panel_container {env}" dir="{dir}" lang="{langCode}"><head>{css}</head><body class="cke_{dir}" style="margin:0;padding:0" onload="{onload}"></body></html>');CKEDITOR.ui.panel.prototype={render:function(i,o){this.getHolderElement=function(){var t=this._.holder;if(!t){if(this.isFramed){var t=this.document.getById(this.id+"_frame"),e=t.getParent(),t=t.getFrameDocument();CKEDITOR.env.iOS&&e.setStyles({overflow:"scroll","-webkit-overflow-scrolling":"touch"}),e=CKEDITOR.tools.addFunction(CKEDITOR.tools.bind(function(){this.isLoaded=!0,this.onLoad&&this.onLoad()},this)),t.write(n.output(CKEDITOR.tools.extend({css:CKEDITOR.tools.buildStyleHtml(this.css),onload:"window.parent.CKEDITOR.tools.callFunction("+e+");"},r))),t.getWindow().$.CKEDITOR=CKEDITOR,t.on("key"+(CKEDITOR.env.opera?"press":"down"),function(t){var e=t.data.getKeystroke(),n=this.document.getById(this.id).getAttribute("dir");this._.onKeyDown&&this._.onKeyDown(e)===!1?t.data.preventDefault():(27==e||e==("rtl"==n?39:37))&&this.onEscape&&this.onEscape(e)===!1&&t.data.preventDefault()},this),t=t.getBody(),t.unselectable(),CKEDITOR.env.air&&CKEDITOR.tools.callFunction(e)}else t=this.document.getById(this.id);this._.holder=t}return t};var r={editorId:i.id,id:this.id,langCode:i.langCode,dir:i.lang.dir,cls:this.className,frame:"",env:CKEDITOR.env.cssClass,"z-index":i.config.baseFloatZIndex+1};if(this.isFramed){var s=CKEDITOR.env.air?"javascript:void(0)":CKEDITOR.env.ie?"javascript:void(function(){"+encodeURIComponent("document.open();("+CKEDITOR.tools.fixDomain+")();document.close();")+"}())":"";r.frame=e.output({id:this.id+"_frame",src:s})}return s=t.output(r),o&&o.push(s),s},addBlock:function(t,e){return e=this._.blocks[t]=e instanceof CKEDITOR.ui.panel.block?e:new CKEDITOR.ui.panel.block(this.getHolderElement(),e),this._.currentBlock||this.showBlock(t),e},getBlock:function(t){return this._.blocks[t]},showBlock:function(t){var t=this._.blocks[t],e=this._.currentBlock,n=!this.forceIFrame||CKEDITOR.env.ie?this._.holder:this.document.getById(this.id+"_frame");return e&&e.hide(),this._.currentBlock=t,CKEDITOR.fire("ariaWidget",n),t._.focusIndex=-1,this._.onKeyDown=t.onKeyDown&&CKEDITOR.tools.bind(t.onKeyDown,t),t.show(),t},destroy:function(){this.element&&this.element.remove()}},CKEDITOR.ui.panel.block=CKEDITOR.tools.createClass({$:function(t,e){this.element=t.append(t.getDocument().createElement("div",{attributes:{tabindex:-1,"class":"cke_panel_block"},styles:{display:"none"}})),e&&CKEDITOR.tools.extend(this,e),this.element.setAttributes({role:this.attributes.role||"presentation","aria-label":this.attributes["aria-label"],title:this.attributes.title||this.attributes["aria-label"]}),this.keys={},this._.focusIndex=-1,this.element.disableContextMenu()},_:{markItem:function(t){-1!=t&&(t=this.element.getElementsByTag("a").getItem(this._.focusIndex=t),(CKEDITOR.env.webkit||CKEDITOR.env.opera)&&t.getDocument().getWindow().focus(),t.focus(),this.onMark&&this.onMark(t))}},proto:{show:function(){this.element.setStyle("display","")},hide:function(){(!this.onHide||this.onHide.call(this)!==!0)&&this.element.setStyle("display","none")},onKeyDown:function(t,e){var n=this.keys[t];switch(n){case"next":for(var i,o=this._.focusIndex,n=this.element.getElementsByTag("a");i=n.getItem(++o);)if(i.getAttribute("_cke_focus")&&i.$.offsetWidth){this._.focusIndex=o,i.focus();break}return i||e?!1:(this._.focusIndex=-1,this.onKeyDown(t,1));case"prev":for(o=this._.focusIndex,n=this.element.getElementsByTag("a");o>0&&(i=n.getItem(--o));){if(i.getAttribute("_cke_focus")&&i.$.offsetWidth){this._.focusIndex=o,i.focus();break}i=null}return i||e?!1:(this._.focusIndex=n.count(),this.onKeyDown(t,1));case"click":case"mouseup":return o=this._.focusIndex,(i=o>=0&&this.element.getElementsByTag("a").getItem(o))&&(i.$[n]?i.$[n]():i.$["on"+n]()),!1}return!0}}})}(),CKEDITOR.plugins.add("floatpanel",{requires:"panel"}),function(){function t(t,n,i,o,r){var r=CKEDITOR.tools.genKey(n.getUniqueId(),i.getUniqueId(),t.lang.dir,t.uiColor||"",o.css||"",r||""),s=e[r];return s||(s=e[r]=new CKEDITOR.ui.panel(n,o),s.element=i.append(CKEDITOR.dom.element.createFromHtml(s.render(t),n)),s.element.setStyles({display:"none",position:"absolute"})),s}var e={};CKEDITOR.ui.floatPanel=CKEDITOR.tools.createClass({$:function(e,n,i,o){function r(){h.hide()}i.forceIFrame=1,i.toolbarRelated&&e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE&&(n=CKEDITOR.document.getById("cke_"+e.name));var s=n.getDocument(),o=t(e,s,n,i,o||0),l=o.element,a=l.getFirst(),h=this;l.disableContextMenu(),this.element=l,this._={editor:e,panel:o,parentElement:n,definition:i,document:s,iframe:a,children:[],dir:e.lang.dir},e.on("mode",r),e.on("resize",r),s.getWindow().on("resize",r)},proto:{addBlock:function(t,e){return this._.panel.addBlock(t,e)},addListBlock:function(t,e){return this._.panel.addListBlock(t,e)},getBlock:function(t){return this._.panel.getBlock(t)},showBlock:function(t,e,n,i,o,r){var s=this._.panel,l=s.showBlock(t);this.allowBlur(!1),t=this._.editor.editable(),this._.returnFocus=t.hasFocus?t:new CKEDITOR.dom.element(CKEDITOR.document.$.activeElement);var a=this.element,t=this._.iframe,t=CKEDITOR.env.ie?t:new CKEDITOR.dom.window(t.$.contentWindow),h=a.getDocument(),d=this._.parentElement.getPositionedAncestor(),u=e.getDocumentPosition(h),h=d?d.getDocumentPosition(h):{x:0,y:0},c="rtl"==this._.dir,p=u.x+(i||0)-h.x,m=u.y+(o||0)-h.y;!c||1!=n&&4!=n?c||2!=n&&3!=n||(p+=e.$.offsetWidth-1):p+=e.$.offsetWidth,(3==n||4==n)&&(m+=e.$.offsetHeight-1),this._.panel._.offsetParentId=e.getId(),a.setStyles({top:m+"px",left:0,display:""}),a.setOpacity(0),a.getFirst().removeStyle("width"),this._.editor.focusManager.add(t),this._.blurSet||(CKEDITOR.event.useCapture=!0,t.on("blur",function(t){this.allowBlur()&&t.data.getPhase()==CKEDITOR.EVENT_PHASE_AT_TARGET&&this.visible&&!this._.activeChild&&(delete this._.returnFocus,this.hide())},this),t.on("focus",function(){this._.focused=!0,this.hideChild(),this.allowBlur(!0)},this),CKEDITOR.event.useCapture=!1,this._.blurSet=1),s.onEscape=CKEDITOR.tools.bind(function(t){return this.onEscape&&this.onEscape(t)===!1?!1:void 0},this),CKEDITOR.tools.setTimeout(function(){var t=CKEDITOR.tools.bind(function(){if(a.removeStyle("width"),l.autoSize){var t=l.element.getDocument(),t=(CKEDITOR.env.webkit?l.element:t.getBody()).$.scrollWidth;CKEDITOR.env.ie&&CKEDITOR.env.quirks&&t>0&&(t+=(a.$.offsetWidth||0)-(a.$.clientWidth||0)+3),a.setStyle("width",t+10+"px"),t=l.element.$.scrollHeight,CKEDITOR.env.ie&&CKEDITOR.env.quirks&&t>0&&(t+=(a.$.offsetHeight||0)-(a.$.clientHeight||0)+3),a.setStyle("height",t+"px"),s._.currentBlock.element.setStyle("display","none").removeStyle("display")}else a.removeStyle("height");c&&(p-=a.$.offsetWidth),a.setStyle("left",p+"px");var e=s.element.getWindow(),t=a.$.getBoundingClientRect(),e=e.getViewPaneSize(),n=t.width||t.right-t.left,i=t.height||t.bottom-t.top,o=c?t.right:e.width-t.left,h=c?e.width-t.right:t.left;c?n>o&&(p=h>n?p+n:e.width>n?p-t.left:p-t.right+e.width):n>o&&(p=h>n?p-n:e.width>n?p-t.right+e.width:p-t.left),n=t.top,e.height-t.top<i&&(m=n>i?m-i:e.height>i?m-t.bottom+e.height:m-t.top),CKEDITOR.env.ie&&(e=t=new CKEDITOR.dom.element(a.$.offsetParent),"html"==e.getName()&&(e=e.getDocument().getBody()),"rtl"==e.getComputedStyle("direction")&&(p=CKEDITOR.env.ie8Compat?p-2*a.getDocument().getDocumentElement().$.scrollLeft:p-(t.$.scrollWidth-t.$.clientWidth)));var d,t=a.getFirst();(d=t.getCustomData("activePanel"))&&d.onHide&&d.onHide.call(this,1),t.setCustomData("activePanel",this),a.setStyles({top:m+"px",left:p+"px"}),a.setOpacity(1),r&&r()
},this);s.isLoaded?t():s.onLoad=t,CKEDITOR.tools.setTimeout(function(){var t=CKEDITOR.env.webkit&&CKEDITOR.document.getWindow().getScrollPosition().y;this.focus(),l.element.focus(),CKEDITOR.env.webkit&&(CKEDITOR.document.getBody().$.scrollTop=t),this.allowBlur(!0),this._.editor.fire("panelShow",this)},0,this)},CKEDITOR.env.air?200:0,this),this.visible=1,this.onShow&&this.onShow.call(this)},focus:function(){if(CKEDITOR.env.webkit){var t=CKEDITOR.document.getActive();!t.equals(this._.iframe)&&t.$.blur()}(this._.lastFocused||this._.iframe.getFrameDocument().getWindow()).focus()},blur:function(){var t=this._.iframe.getFrameDocument().getActive();t.is("a")&&(this._.lastFocused=t)},hide:function(t){!this.visible||this.onHide&&this.onHide.call(this)===!0||(this.hideChild(),CKEDITOR.env.gecko&&this._.iframe.getFrameDocument().$.activeElement.blur(),this.element.setStyle("display","none"),this.visible=0,this.element.getFirst().removeCustomData("activePanel"),(t=t&&this._.returnFocus)&&(CKEDITOR.env.webkit&&t.type&&t.getWindow().$.focus(),t.focus()),delete this._.lastFocused,this._.editor.fire("panelHide",this))},allowBlur:function(t){var e=this._.panel;return void 0!=t&&(e.allowBlur=t),e.allowBlur},showAsChild:function(t,e,n,i,o,r){(this._.activeChild!=t||t._.panel._.offsetParentId!=n.getId())&&(this.hideChild(),t.onHide=CKEDITOR.tools.bind(function(){CKEDITOR.tools.setTimeout(function(){this._.focused||this.hide()},0,this)},this),this._.activeChild=t,this._.focused=!1,t.showBlock(e,n,i,o,r),this.blur(),(CKEDITOR.env.ie7Compat||CKEDITOR.env.ie6Compat)&&setTimeout(function(){t.element.getChild(0).$.style.cssText+=""},100))},hideChild:function(t){var e=this._.activeChild;e&&(delete e.onHide,delete this._.activeChild,e.hide(),t&&this.focus())}}}),CKEDITOR.on("instanceDestroyed",function(){var t,n=CKEDITOR.tools.isEmpty(CKEDITOR.instances);for(t in e){var i=e[t];n?i.destroy():i.element.hide()}n&&(e={})})}(),CKEDITOR.plugins.add("menu",{requires:"floatpanel",beforeInit:function(t){for(var e=t.config.menu_groups.split(","),n=t._.menuGroups={},i=t._.menuItems={},o=0;o<e.length;o++)n[e[o]]=o+1;t.addMenuGroup=function(t,e){n[t]=e||100},t.addMenuItem=function(t,e){n[e.group]&&(i[t]=new CKEDITOR.menuItem(this,t,e))},t.addMenuItems=function(t){for(var e in t)this.addMenuItem(e,t[e])},t.getMenuItem=function(t){return i[t]},t.removeMenuItem=function(t){delete i[t]}}}),function(){function t(t){t.sort(function(t,e){return t.group<e.group?-1:t.group>e.group?1:t.order<e.order?-1:t.order>e.order?1:0})}var e='<span class="cke_menuitem"><a id="{id}" class="cke_menubutton cke_menubutton__{name} cke_menubutton_{state} {cls}" href="{href}" title="{title}" tabindex="-1"_cke_focus=1 hidefocus="true" role="{role}" aria-haspopup="{hasPopup}" aria-disabled="{disabled}" {ariaChecked}';(CKEDITOR.env.opera||CKEDITOR.env.gecko&&CKEDITOR.env.mac)&&(e+=' onkeypress="return false;"'),CKEDITOR.env.gecko&&(e+=' onblur="this.style.cssText = this.style.cssText;"');var e=e+(' onmouseover="CKEDITOR.tools.callFunction({hoverFn},{index});" onmouseout="CKEDITOR.tools.callFunction({moveOutFn},{index});" '+(CKEDITOR.env.ie?'onclick="return false;" onmouseup':"onclick")+'="CKEDITOR.tools.callFunction({clickFn},{index}); return false;">'),n=CKEDITOR.addTemplate("menuItem",e+'<span class="cke_menubutton_inner"><span class="cke_menubutton_icon"><span class="cke_button_icon cke_button__{iconName}_icon" style="{iconStyle}"></span></span><span class="cke_menubutton_label">{label}</span>{arrowHtml}</span></a></span>'),i=CKEDITOR.addTemplate("menuArrow",'<span class="cke_menuarrow"><span>{label}</span></span>');CKEDITOR.menu=CKEDITOR.tools.createClass({$:function(t,e){e=this._.definition=e||{},this.id=CKEDITOR.tools.getNextId(),this.editor=t,this.items=[],this._.listeners=[],this._.level=e.level||1;var n=CKEDITOR.tools.extend({},e.panel,{css:[CKEDITOR.skin.getPath("editor")],level:this._.level-1,block:{}}),i=n.block.attributes=n.attributes||{};!i.role&&(i.role="menu"),this._.panelDefinition=n},_:{onShow:function(){var t=this.editor.getSelection(),e=t&&t.getStartElement(),n=this.editor.elementPath(),i=this._.listeners;this.removeAll();for(var o=0;o<i.length;o++){var r=i[o](e,t,n);if(r)for(var s in r){var l=this.editor.getMenuItem(s);!l||l.command&&!this.editor.getCommand(l.command).state||(l.state=r[s],this.add(l))}}},onClick:function(t){this.hide(),t.onClick?t.onClick():t.command&&this.editor.execCommand(t.command)},onEscape:function(t){var e=this.parent;return e?e._.panel.hideChild(1):27==t&&this.hide(1),!1},onHide:function(){this.onHide&&this.onHide()},showSubMenu:function(t){var e=this._.subMenu,n=this.items[t];if(n=n.getItems&&n.getItems()){e?e.removeAll():(e=this._.subMenu=new CKEDITOR.menu(this.editor,CKEDITOR.tools.extend({},this._.definition,{level:this._.level+1},!0)),e.parent=this,e._.onClick=CKEDITOR.tools.bind(this._.onClick,this));for(var i in n){var o=this.editor.getMenuItem(i);o&&(o.state=n[i],e.add(o))}var r=this._.panel.getBlock(this.id).element.getDocument().getById(this.id+(""+t));setTimeout(function(){e.show(r,2)},0)}else this._.panel.hideChild(1)}},proto:{add:function(t){t.order||(t.order=this.items.length),this.items.push(t)},removeAll:function(){this.items=[]},show:function(e,n,i,o){if(this.parent||(this._.onShow(),this.items.length)){var n=n||("rtl"==this.editor.lang.dir?2:1),r=this.items,s=this.editor,l=this._.panel,a=this._.element;if(!l){l=this._.panel=new CKEDITOR.ui.floatPanel(this.editor,CKEDITOR.document.getBody(),this._.panelDefinition,this._.level),l.onEscape=CKEDITOR.tools.bind(function(t){return this._.onEscape(t)===!1?!1:void 0},this),l.onShow=function(){l._.panel.getHolderElement().getParent().addClass("cke cke_reset_all")},l.onHide=CKEDITOR.tools.bind(function(){this._.onHide&&this._.onHide()},this),a=l.addBlock(this.id,this._.panelDefinition.block),a.autoSize=!0;var h=a.keys;h[40]="next",h[9]="next",h[38]="prev",h[CKEDITOR.SHIFT+9]="prev",h["rtl"==s.lang.dir?37:39]=CKEDITOR.env.ie?"mouseup":"click",h[32]=CKEDITOR.env.ie?"mouseup":"click",CKEDITOR.env.ie&&(h[13]="mouseup"),a=this._.element=a.element,h=a.getDocument(),h.getBody().setStyle("overflow","hidden"),h.getElementsByTag("html").getItem(0).setStyle("overflow","hidden"),this._.itemOverFn=CKEDITOR.tools.addFunction(function(t){clearTimeout(this._.showSubTimeout),this._.showSubTimeout=CKEDITOR.tools.setTimeout(this._.showSubMenu,s.config.menu_subMenuDelay||400,this,[t])},this),this._.itemOutFn=CKEDITOR.tools.addFunction(function(){clearTimeout(this._.showSubTimeout)},this),this._.itemClickFn=CKEDITOR.tools.addFunction(function(t){var e=this.items[t];e.state==CKEDITOR.TRISTATE_DISABLED?this.hide(1):e.getItems?this._.showSubMenu(t):this._.onClick(e)},this)}t(r);for(var h=s.elementPath(),h=['<div class="cke_menu'+(h&&h.direction()!=s.lang.dir?" cke_mixed_dir_content":"")+'" role="presentation">'],d=r.length,u=d&&r[0].group,c=0;d>c;c++){var p=r[c];u!=p.group&&(h.push('<div class="cke_menuseparator" role="separator"></div>'),u=p.group),p.render(this,c,h)}h.push("</div>"),a.setHtml(h.join("")),CKEDITOR.ui.fire("ready",this),this.parent?this.parent._.panel.showAsChild(l,this.id,e,n,i,o):l.showBlock(this.id,e,n,i,o),s.fire("menuShow",[l])}},addListener:function(t){this._.listeners.push(t)},hide:function(t){this._.onHide&&this._.onHide(),this._.panel&&this._.panel.hide(t)}}}),CKEDITOR.menuItem=CKEDITOR.tools.createClass({$:function(t,e,n){CKEDITOR.tools.extend(this,n,{order:0,className:"cke_menubutton__"+e}),this.group=t._.menuGroups[this.group],this.editor=t,this.name=e},proto:{render:function(t,e,o){var r=t.id+(""+e),s="undefined"==typeof this.state?CKEDITOR.TRISTATE_OFF:this.state,l="",a=s==CKEDITOR.TRISTATE_ON?"on":s==CKEDITOR.TRISTATE_DISABLED?"disabled":"off";this.role in{menuitemcheckbox:1,menuitemradio:1}&&(l=' aria-checked="'+(s==CKEDITOR.TRISTATE_ON?"true":"false")+'"');var h=this.getItems,d="&#"+("rtl"==this.editor.lang.dir?"9668":"9658")+";",u=this.name;this.icon&&!/\./.test(this.icon)&&(u=this.icon),t={id:r,name:this.name,iconName:u,label:this.label,cls:this.className||"",state:a,hasPopup:h?"true":"false",disabled:s==CKEDITOR.TRISTATE_DISABLED,title:this.label,href:"javascript:void('"+(this.label||"").replace("'")+"')",hoverFn:t._.itemOverFn,moveOutFn:t._.itemOutFn,clickFn:t._.itemClickFn,index:e,iconStyle:CKEDITOR.skin.getIconStyle(u,"rtl"==this.editor.lang.dir,u==this.icon?null:this.icon,this.iconOffset),arrowHtml:h?i.output({label:d}):"",role:this.role?this.role:"menuitem",ariaChecked:l},n.output(t,o)}}})}(),CKEDITOR.config.menu_groups="clipboard,form,tablecell,tablecellproperties,tablerow,tablecolumn,table,anchor,link,image,flash,checkbox,radio,textfield,hiddenfield,imagebutton,button,select,textarea,div",CKEDITOR.plugins.add("contextmenu",{requires:"menu",onLoad:function(){CKEDITOR.plugins.contextMenu=CKEDITOR.tools.createClass({base:CKEDITOR.menu,$:function(t){this.base.call(this,t,{panel:{className:"cke_menu_panel",attributes:{"aria-label":t.lang.contextmenu.options}}})},proto:{addTarget:function(t,e){if(t.on("contextmenu",function(t){var t=t.data,i=CKEDITOR.env.webkit?n:CKEDITOR.env.mac?t.$.metaKey:t.$.ctrlKey;if(!e||!i){t.preventDefault();var o=t.getTarget().getDocument(),r=t.getTarget().getDocument().getDocumentElement(),i=!o.equals(CKEDITOR.document),o=o.getWindow().getScrollPosition(),s=i?t.$.clientX:t.$.pageX||o.x+t.$.clientX,l=i?t.$.clientY:t.$.pageY||o.y+t.$.clientY;CKEDITOR.tools.setTimeout(function(){this.open(r,null,s,l)},CKEDITOR.env.ie?200:0,this)}},this),CKEDITOR.env.webkit){var n,i=function(){n=0};t.on("keydown",function(t){n=CKEDITOR.env.mac?t.data.$.metaKey:t.data.$.ctrlKey}),t.on("keyup",i),t.on("contextmenu",i)}},open:function(t,e,n,i){this.editor.focus(),t=t||CKEDITOR.document.getDocumentElement(),this.editor.selectionChange(1),this.show(t,e,n,i)}}})},beforeInit:function(t){var e=t.contextMenu=new CKEDITOR.plugins.contextMenu(t);t.on("contentDom",function(){e.addTarget(t.editable(),t.config.browserContextMenuOnCtrl!==!1)}),t.addCommand("contextMenu",{exec:function(){t.contextMenu.open(t.document.getBody())}}),t.setKeystroke(CKEDITOR.SHIFT+121,"contextMenu"),t.setKeystroke(CKEDITOR.CTRL+CKEDITOR.SHIFT+121,"contextMenu")}}),function(){function t(t){var e=this.att,t=t&&t.hasAttribute(e)&&t.getAttribute(e)||"";void 0!==t&&this.setValue(t)}function e(){for(var t,e=0;e<arguments.length;e++)if(arguments[e]instanceof CKEDITOR.dom.element){t=arguments[e];break}if(t){var e=this.att,n=this.getValue();n?t.setAttribute(e,n):t.removeAttribute(e,n)}}var n={id:1,dir:1,classes:1,styles:1};CKEDITOR.plugins.add("dialogadvtab",{requires:"dialog",allowedContent:function(t){t||(t=n);var e=[];t.id&&e.push("id"),t.dir&&e.push("dir");var i="";return e.length&&(i+="["+e.join(",")+"]"),t.classes&&(i+="(*)"),t.styles&&(i+="{*}"),i},createAdvancedTab:function(i,o,r){o||(o=n);var s=i.lang.common,l={id:"advanced",label:s.advancedTab,title:s.advancedTab,elements:[{type:"vbox",padding:1,children:[]}]},a=[];return(o.id||o.dir)&&(o.id&&a.push({id:"advId",att:"id",type:"text",requiredContent:r?r+"[id]":null,label:s.id,setup:t,commit:e}),o.dir&&a.push({id:"advLangDir",att:"dir",type:"select",requiredContent:r?r+"[dir]":null,label:s.langDir,"default":"",style:"width:100%",items:[[s.notSet,""],[s.langDirLTR,"ltr"],[s.langDirRTL,"rtl"]],setup:t,commit:e}),l.elements[0].children.push({type:"hbox",widths:["50%","50%"],children:[].concat(a)})),(o.styles||o.classes)&&(a=[],o.styles&&a.push({id:"advStyles",att:"style",type:"text",requiredContent:r?r+"{cke-xyz}":null,label:s.styles,"default":"",validate:CKEDITOR.dialog.validate.inlineStyle(s.invalidInlineStyle),onChange:function(){},getStyle:function(t,e){var n=this.getValue().match(RegExp("(?:^|;)\\s*"+t+"\\s*:\\s*([^;]*)","i"));return n?n[1]:e},updateStyle:function(t,e){var n=this.getValue(),o=i.document.createElement("span");o.setAttribute("style",n),o.setStyle(t,e),n=CKEDITOR.tools.normalizeCssText(o.getAttribute("style")),this.setValue(n,1)},setup:t,commit:e}),o.classes&&a.push({type:"hbox",widths:["45%","55%"],children:[{id:"advCSSClasses",att:"class",type:"text",requiredContent:r?r+"(cke-xyz)":null,label:s.cssClasses,"default":"",setup:t,commit:e}]}),l.elements[0].children.push({type:"hbox",widths:["50%","50%"],children:[].concat(a)})),l}})}(),function(){CKEDITOR.plugins.add("div",{requires:"dialog",init:function(t){if(!t.blockless){var e=t.lang.div,n="div(*)";CKEDITOR.dialog.isTabEnabled(t,"editdiv","advanced")&&(n+=";div[dir,id,lang,title]{*}"),t.addCommand("creatediv",new CKEDITOR.dialogCommand("creatediv",{allowedContent:n,requiredContent:"div",contextSensitive:!0,refresh:function(t,e){this.setState("div"in(t.config.div_wrapTable?e.root:e.blockLimit).getDtd()?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED)}})),t.addCommand("editdiv",new CKEDITOR.dialogCommand("editdiv",{requiredContent:"div"})),t.addCommand("removediv",{requiredContent:"div",exec:function(t){function e(e){(e=CKEDITOR.plugins.div.getSurroundDiv(t,e))&&!e.data("cke-div-added")&&(s.push(e),e.data("cke-div-added"))}for(var n,i=t.getSelection(),o=i&&i.getRanges(),r=i.createBookmarks(),s=[],l=0;l<o.length;l++)n=o[l],n.collapsed?e(i.getStartElement()):(n=new CKEDITOR.dom.walker(n),n.evaluator=e,n.lastForward());for(l=0;l<s.length;l++)s[l].remove(!0);i.selectBookmarks(r)}}),t.ui.addButton&&t.ui.addButton("CreateDiv",{label:e.toolbar,command:"creatediv",toolbar:"blocks,50"}),t.addMenuItems&&(t.addMenuItems({editdiv:{label:e.edit,command:"editdiv",group:"div",order:1},removediv:{label:e.remove,command:"removediv",group:"div",order:5}}),t.contextMenu&&t.contextMenu.addListener(function(e){return!e||e.isReadOnly()?null:CKEDITOR.plugins.div.getSurroundDiv(t)?{editdiv:CKEDITOR.TRISTATE_OFF,removediv:CKEDITOR.TRISTATE_OFF}:null})),CKEDITOR.dialog.add("creatediv",this.path+"dialogs/div.js"),CKEDITOR.dialog.add("editdiv",this.path+"dialogs/div.js")}}}),CKEDITOR.plugins.div={getSurroundDiv:function(t,e){var n=t.elementPath(e);return t.elementPath(n.blockLimit).contains(function(t){return t.is("div")&&!t.isReadOnly()},1)}}}(),function(){function t(t,i){function r(e){if(e=h.list[e],e.equals(t.editable())||"true"==e.getAttribute("contenteditable")){var n=t.createRange();n.selectNodeContents(e),n.select()}else t.getSelection().selectElement(e);t.focus()}function s(){l&&l.setHtml(n),delete h.list}var l,a=t.ui.spaceId("path"),h=t._.elementsPath,d=h.idBase;i.html=i.html+('<span id="'+a+'_label" class="cke_voice_label">'+t.lang.elementspath.eleLabel+'</span><span id="'+a+'" class="cke_path" role="group" aria-labelledby="'+a+'_label">'+n+"</span>"),t.on("uiReady",function(){var e=t.ui.space("path");e&&t.focusManager.add(e,1)}),h.onClick=r;var u=CKEDITOR.tools.addFunction(r),c=CKEDITOR.tools.addFunction(function(e,n){var i,o=h.idBase,n=new CKEDITOR.dom.event(n);switch(i="rtl"==t.lang.dir,n.getKeystroke()){case i?39:37:case 9:return(i=CKEDITOR.document.getById(o+(e+1)))||(i=CKEDITOR.document.getById(o+"0")),i.focus(),!1;case i?37:39:case CKEDITOR.SHIFT+9:return(i=CKEDITOR.document.getById(o+(e-1)))||(i=CKEDITOR.document.getById(o+(h.list.length-1))),i.focus(),!1;case 27:return t.focus(),!1;case 13:case 32:return r(e),!1}return!0});t.on("selectionChange",function(){t.editable();for(var e,i=[],r=h.list=[],s=[],p=h.filters,m=!0,g=t.elementPath().elements,f=g.length;f--;){var x=g[f],C=0;e=x.data("cke-display-name")?x.data("cke-display-name"):x.data("cke-real-element-type")?x.data("cke-real-element-type"):x.getName(),m=x.hasAttribute("contenteditable")?"true"==x.getAttribute("contenteditable"):m,!m&&!x.hasAttribute("contenteditable")&&(C=1);for(var E=0;E<p.length;E++){var y=p[E](x,e);if(y===!1){C=1;break}e=y||e}C||(r.unshift(x),s.unshift(e))}for(r=r.length,p=0;r>p;p++)e=s[p],m=t.lang.elementspath.eleTitle.replace(/%1/,e),e=o.output({id:d+p,label:m,text:e,jsTitle:"javascript:void('"+e+"')",index:p,keyDownFn:c,clickFn:u}),i.unshift(e);l||(l=CKEDITOR.document.getById(a)),s=l,s.setHtml(i.join("")+n),t.fire("elementsPathUpdate",{space:s})}),t.on("readOnly",s),t.on("contentDomUnload",s),t.addCommand("elementsPathFocus",e),t.setKeystroke(CKEDITOR.ALT+122,"elementsPathFocus")}var e;e={editorFocus:!1,readOnly:1,exec:function(t){(t=CKEDITOR.document.getById(t._.elementsPath.idBase+"0"))&&t.focus(CKEDITOR.env.ie||CKEDITOR.env.air)}};var n='<span class="cke_path_empty">&nbsp;</span>',i="";(CKEDITOR.env.opera||CKEDITOR.env.gecko&&CKEDITOR.env.mac)&&(i+=' onkeypress="return false;"'),CKEDITOR.env.gecko&&(i+=' onblur="this.style.cssText = this.style.cssText;"');var o=CKEDITOR.addTemplate("pathItem",'<a id="{id}" href="{jsTitle}" tabindex="-1" class="cke_path_item" title="{label}"'+(CKEDITOR.env.gecko&&CKEDITOR.env.version<10900?' onfocus="event.preventBubble();"':"")+i+' hidefocus="true"  onkeydown="return CKEDITOR.tools.callFunction({keyDownFn},{index}, event );" onclick="CKEDITOR.tools.callFunction({clickFn},{index}); return false;" role="button" aria-label="{label}">{text}</a>');CKEDITOR.plugins.add("elementspath",{init:function(e){e._.elementsPath={idBase:"cke_elementspath_"+CKEDITOR.tools.getNextNumber()+"_",filters:[]},e.on("uiSpace",function(n){"bottom"==n.data.space&&t(e,n.data)})}})}(),function(){function t(t,e,n){n=t.config.forceEnterMode||n,"wysiwyg"==t.mode&&(e||(e=t.activeEnterMode),t.elementPath().isContextFor("p")||(e=CKEDITOR.ENTER_BR,n=1),t.fire("saveSnapshot"),e==CKEDITOR.ENTER_BR?r(t,e,null,n):s(t,e,null,n),t.fire("saveSnapshot"))}function e(t){for(var t=t.getSelection().getRanges(!0),e=t.length-1;e>0;e--)t[e].deleteContents();return t[0]}CKEDITOR.plugins.add("enterkey",{init:function(e){e.addCommand("enter",{modes:{wysiwyg:1},editorFocus:!1,exec:function(e){t(e)}}),e.addCommand("shiftEnter",{modes:{wysiwyg:1},editorFocus:!1,exec:function(e){t(e,e.activeShiftEnterMode,1)}}),e.setKeystroke([[13,"enter"],[CKEDITOR.SHIFT+13,"shiftEnter"]])}});var n=CKEDITOR.dom.walker.whitespaces(),i=CKEDITOR.dom.walker.bookmark();CKEDITOR.plugins.enterkey={enterBlock:function(t,o,s,a){if(s=s||e(t)){var h,d=s.document,u=s.checkStartOfBlock(),c=s.checkEndOfBlock(),p=t.elementPath(s.startContainer).block,m=o==CKEDITOR.ENTER_DIV?"div":"p";if(u&&c){if(p&&(p.is("li")||p.getParent().is("li"))){s=p.getParent(),h=s.getParent();var a=!p.hasPrevious(),g=!p.hasNext(),m=t.getSelection(),f=m.createBookmarks(),u=p.getDirection(1),c=p.getAttribute("class"),x=p.getAttribute("style"),C=h.getDirection(1)!=u,t=t.enterMode!=CKEDITOR.ENTER_BR||C||x||c;if(h.is("li"))a||g?p[a?"insertBefore":"insertAfter"](h):p.breakParent(h);else{if(t)h=d.createElement(o==CKEDITOR.ENTER_P?"p":"div"),C&&h.setAttribute("dir",u),x&&h.setAttribute("style",x),c&&h.setAttribute("class",c),p.moveChildren(h),a||g?h[a?"insertBefore":"insertAfter"](s):(p.breakParent(s),h.insertAfter(s));else if(p.appendBogus(!0),a||g)for(;d=p[a?"getFirst":"getLast"]();)d[a?"insertBefore":"insertAfter"](s);else for(p.breakParent(s);d=p.getLast();)d.insertAfter(s);p.remove()}return m.selectBookmarks(f),void 0}if(p&&p.getParent().is("blockquote"))return p.breakParent(p.getParent()),p.getPrevious().getFirst(CKEDITOR.dom.walker.invisible(1))||p.getPrevious().remove(),p.getNext().getFirst(CKEDITOR.dom.walker.invisible(1))||p.getNext().remove(),s.moveToElementEditStart(p),s.select(),void 0}else if(p&&p.is("pre")&&!c)return r(t,o,s,a),void 0;if(c=s.splitBlock(m)){if(o=c.previousBlock,p=c.nextBlock,t=c.wasStartOfBlock,u=c.wasEndOfBlock,p?(f=p.getParent(),f.is("li")&&(p.breakParent(f),p.move(p.getNext(),1))):o&&(f=o.getParent())&&f.is("li")&&(o.breakParent(f),f=o.getNext(),s.moveToElementEditStart(f),o.move(o.getPrevious())),t||u){if(o?(o.is("li")||!l.test(o.getName())&&!o.is("pre"))&&(h=o.clone()):p&&(h=p.clone()),h?a&&!h.is("li")&&h.renameNode(m):f&&f.is("li")?h=f:(h=d.createElement(m),o&&(g=o.getDirection())&&h.setAttribute("dir",g)),d=c.elementPath)for(a=0,m=d.elements.length;m>a&&(f=d.elements[a],!f.equals(d.block)&&!f.equals(d.blockLimit));a++)CKEDITOR.dtd.$removeEmpty[f.getName()]&&(f=f.clone(),h.moveChildren(f),h.append(f));h.appendBogus(),h.getParent()||s.insertNode(h),h.is("li")&&h.removeAttribute("value"),!CKEDITOR.env.ie||!t||u&&o.getChildCount()||(s.moveToElementEditStart(u?o:h),s.select()),s.moveToElementEditStart(t&&!u?p:h)}else p.is("li")&&(h=s.clone(),h.selectNodeContents(p),h=new CKEDITOR.dom.walker(h),h.evaluator=function(t){return!(i(t)||n(t)||t.type==CKEDITOR.NODE_ELEMENT&&t.getName()in CKEDITOR.dtd.$inline&&!(t.getName()in CKEDITOR.dtd.$empty))},(f=h.next())&&f.type==CKEDITOR.NODE_ELEMENT&&f.is("ul","ol")&&(CKEDITOR.env.needsBrFiller?d.createElement("br"):d.createText("")).insertBefore(f)),p&&s.moveToElementEditStart(p);s.select(),s.scrollIntoView()}}},enterBr:function(t,n,i,o){if(i=i||e(t)){var r=i.document,a=i.checkEndOfBlock(),h=new CKEDITOR.dom.elementPath(t.getSelection().getStartElement()),d=h.block,h=d&&h.block.getName();o||"li"!=h?(!o&&a&&l.test(h)?(a=d.getDirection())?(r=r.createElement("div"),r.setAttribute("dir",a),r.insertAfter(d),i.setStart(r,0)):(r.createElement("br").insertAfter(d),CKEDITOR.env.gecko&&r.createText("").insertAfter(d),i.setStartAt(d.getNext(),CKEDITOR.env.ie?CKEDITOR.POSITION_BEFORE_START:CKEDITOR.POSITION_AFTER_START)):(d="pre"==h&&CKEDITOR.env.ie&&CKEDITOR.env.version<8?r.createText("\r"):r.createElement("br"),i.deleteContents(),i.insertNode(d),CKEDITOR.env.needsBrFiller?(r.createText("").insertAfter(d),a&&d.getParent().appendBogus(),d.getNext().$.nodeValue="",i.setStartAt(d.getNext(),CKEDITOR.POSITION_AFTER_START)):i.setStartAt(d,CKEDITOR.POSITION_AFTER_END)),i.collapse(!0),i.select(),i.scrollIntoView()):s(t,n,i,o)}}};var o=CKEDITOR.plugins.enterkey,r=o.enterBr,s=o.enterBlock,l=/^h[1-6]$/}(),function(){function t(t,e){var n={},i=[],o={nbsp:"",shy:"",gt:">",lt:"<",amp:"&",apos:"'",quot:'"'},t=t.replace(/\b(nbsp|shy|gt|lt|amp|apos|quot)(?:,|$)/g,function(t,r){var s=e?"&"+r+";":o[r];return n[s]=e?o[r]:"&"+r+";",i.push(s),""});if(!e&&t){var r,t=t.split(","),s=document.createElement("div");for(s.innerHTML="&"+t.join(";&")+";",r=s.innerHTML,s=null,s=0;s<r.length;s++){var l=r.charAt(s);n[l]="&"+t[s]+";",i.push(l)}}return n.regex=i.join(e?"|":""),n}CKEDITOR.plugins.add("entities",{afterInit:function(e){var n=e.config;if(e=(e=e.dataProcessor)&&e.htmlFilter){var i=[];n.basicEntities!==!1&&i.push("nbsp,gt,lt,amp"),n.entities&&(i.length&&i.push("quot,iexcl,cent,pound,curren,yen,brvbar,sect,uml,copy,ordf,laquo,not,shy,reg,macr,deg,plusmn,sup2,sup3,acute,micro,para,middot,cedil,sup1,ordm,raquo,frac14,frac12,frac34,iquest,times,divide,fnof,bull,hellip,prime,Prime,oline,frasl,weierp,image,real,trade,alefsym,larr,uarr,rarr,darr,harr,crarr,lArr,uArr,rArr,dArr,hArr,forall,part,exist,empty,nabla,isin,notin,ni,prod,sum,minus,lowast,radic,prop,infin,ang,and,or,cap,cup,int,there4,sim,cong,asymp,ne,equiv,le,ge,sub,sup,nsub,sube,supe,oplus,otimes,perp,sdot,lceil,rceil,lfloor,rfloor,lang,rang,loz,spades,clubs,hearts,diams,circ,tilde,ensp,emsp,thinsp,zwnj,zwj,lrm,rlm,ndash,mdash,lsquo,rsquo,sbquo,ldquo,rdquo,bdquo,dagger,Dagger,permil,lsaquo,rsaquo,euro"),n.entities_latin&&i.push("Agrave,Aacute,Acirc,Atilde,Auml,Aring,AElig,Ccedil,Egrave,Eacute,Ecirc,Euml,Igrave,Iacute,Icirc,Iuml,ETH,Ntilde,Ograve,Oacute,Ocirc,Otilde,Ouml,Oslash,Ugrave,Uacute,Ucirc,Uuml,Yacute,THORN,szlig,agrave,aacute,acirc,atilde,auml,aring,aelig,ccedil,egrave,eacute,ecirc,euml,igrave,iacute,icirc,iuml,eth,ntilde,ograve,oacute,ocirc,otilde,ouml,oslash,ugrave,uacute,ucirc,uuml,yacute,thorn,yuml,OElig,oelig,Scaron,scaron,Yuml"),n.entities_greek&&i.push("Alpha,Beta,Gamma,Delta,Epsilon,Zeta,Eta,Theta,Iota,Kappa,Lambda,Mu,Nu,Xi,Omicron,Pi,Rho,Sigma,Tau,Upsilon,Phi,Chi,Psi,Omega,alpha,beta,gamma,delta,epsilon,zeta,eta,theta,iota,kappa,lambda,mu,nu,xi,omicron,pi,rho,sigmaf,sigma,tau,upsilon,phi,chi,psi,omega,thetasym,upsih,piv"),n.entities_additional&&i.push(n.entities_additional));var o=t(i.join(",")),r=o.regex?"["+o.regex+"]":"a^";delete o.regex,n.entities&&n.entities_processNumerical&&(r="[^ -~]|"+r);var r=RegExp(r,"g"),s=function(t){return"force"!=n.entities_processNumerical&&o[t]?o[t]:"&#"+t.charCodeAt(0)+";"},l=t("nbsp,gt,lt,amp,shy",!0),a=RegExp(l.regex,"g"),h=function(t){return l[t]};e.addRules({text:function(t){return t.replace(a,h).replace(r,s)}},{applyToAll:!0,excludeNestedEditable:!0})}}})}(),CKEDITOR.config.basicEntities=!0,CKEDITOR.config.entities=!0,CKEDITOR.config.entities_latin=!0,CKEDITOR.config.entities_greek=!0,CKEDITOR.config.entities_additional="#39",CKEDITOR.plugins.add("popup"),CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{popup:function(t,e,n,i){e=e||"80%",n=n||"70%","string"==typeof e&&e.length>1&&"%"==e.substr(e.length-1,1)&&(e=parseInt(window.screen.width*parseInt(e,10)/100,10)),"string"==typeof n&&n.length>1&&"%"==n.substr(n.length-1,1)&&(n=parseInt(window.screen.height*parseInt(n,10)/100,10)),640>e&&(e=640),420>n&&(n=420);var o=parseInt((window.screen.height-n)/2,10),r=parseInt((window.screen.width-e)/2,10),i=(i||"location=no,menubar=no,toolbar=no,dependent=yes,minimizable=no,modal=yes,alwaysRaised=yes,resizable=yes,scrollbars=yes")+",width="+e+",height="+n+",top="+o+",left="+r,s=window.open("",null,i,!0);if(!s)return!1;try{-1==navigator.userAgent.toLowerCase().indexOf(" chrome/")&&(s.moveTo(r,o),s.resizeTo(e,n)),s.focus(),s.location.href=t}catch(l){window.open(t,null,i,!0)}return!0}}),function(){function t(t,e){var n=[];if(!e)return t;for(var i in e)n.push(i+"="+encodeURIComponent(e[i]));return t+(-1!=t.indexOf("?")?"&":"?")+n.join("&")}function e(t){return t+="",t.charAt(0).toUpperCase()+t.substr(1)}function n(){var n=this.getDialog(),i=n.getParentEditor();i._.filebrowserSe=this;var o=i.config["filebrowser"+e(n.getName())+"WindowWidth"]||i.config.filebrowserWindowWidth||"80%",n=i.config["filebrowser"+e(n.getName())+"WindowHeight"]||i.config.filebrowserWindowHeight||"70%",r=this.filebrowser.params||{};r.CKEditor=i.name,r.CKEditorFuncNum=i._.filebrowserFn,r.langCode||(r.langCode=i.langCode),r=t(this.filebrowser.url,r),i.popup(r,o,n,i.config.filebrowserWindowFeatures||i.config.fileBrowserWindowFeatures)}function i(){var t=this.getDialog();return t.getParentEditor()._.filebrowserSe=this,t.getContentElement(this["for"][0],this["for"][1]).getInputElement().$.value&&t.getContentElement(this["for"][0],this["for"][1]).getAction()?!0:!1}function o(e,n,i){var o=i.params||{};o.CKEditor=e.name,o.CKEditorFuncNum=e._.filebrowserFn,o.langCode||(o.langCode=e.langCode),n.action=t(i.url,o),n.filebrowser=i}function r(t,s,l,a){if(a&&a.length)for(var h,d=a.length;d--;)if(h=a[d],("hbox"==h.type||"vbox"==h.type||"fieldset"==h.type)&&r(t,s,l,h.children),h.filebrowser)if("string"==typeof h.filebrowser&&(h.filebrowser={action:"fileButton"==h.type?"QuickUpload":"Browse",target:h.filebrowser}),"Browse"==h.filebrowser.action){var u=h.filebrowser.url;void 0===u&&(u=t.config["filebrowser"+e(s)+"BrowseUrl"],void 0===u&&(u=t.config.filebrowserBrowseUrl)),u&&(h.onClick=n,h.filebrowser.url=u,h.hidden=!1)}else if("QuickUpload"==h.filebrowser.action&&h["for"]&&(u=h.filebrowser.url,void 0===u&&(u=t.config["filebrowser"+e(s)+"UploadUrl"],void 0===u&&(u=t.config.filebrowserUploadUrl)),u)){var c=h.onClick;h.onClick=function(t){var e=t.sender;return c&&c.call(e,t)===!1?!1:i.call(e,t)},h.filebrowser.url=u,h.hidden=!1,o(t,l.getContents(h["for"][0]).get(h["for"][1]),h.filebrowser)}}function s(t,e,n){if(-1!==n.indexOf(";")){for(var n=n.split(";"),i=0;i<n.length;i++)if(s(t,e,n[i]))return!0;return!1}return(t=t.getContents(e).get(n).filebrowser)&&t.url}function l(t,e){var n=this._.filebrowserSe.getDialog(),i=this._.filebrowserSe["for"],o=this._.filebrowserSe.filebrowser.onSelect;i&&n.getContentElement(i[0],i[1]).reset(),"function"==typeof e&&e.call(this._.filebrowserSe)===!1||o&&o.call(this._.filebrowserSe,t,e)===!1||("string"==typeof e&&e&&alert(e),t&&(i=this._.filebrowserSe,n=i.getDialog(),(i=i.filebrowser.target||null)&&(i=i.split(":"),(o=n.getContentElement(i[0],i[1]))&&(o.setValue(t),n.selectPage(i[0])))))}CKEDITOR.plugins.add("filebrowser",{requires:"popup",init:function(t){t._.filebrowserFn=CKEDITOR.tools.addFunction(l,t),t.on("destroy",function(){CKEDITOR.tools.removeFunction(this._.filebrowserFn)})}}),CKEDITOR.on("dialogDefinition",function(t){if(t.editor.plugins.filebrowser)for(var e,n=t.data.definition,i=0;i<n.contents.length;++i)(e=n.contents[i])&&(r(t.editor,t.data.name,n,e.elements),e.hidden&&e.filebrowser&&(e.hidden=!s(n,e.id,e.filebrowser)))})}(),CKEDITOR.plugins.add("find",{requires:"dialog",init:function(t){var e=t.addCommand("find",new CKEDITOR.dialogCommand("find"));e.canUndo=!1,e.readOnly=1,t.addCommand("replace",new CKEDITOR.dialogCommand("replace")).canUndo=!1,t.ui.addButton&&(t.ui.addButton("Find",{label:t.lang.find.find,command:"find",toolbar:"find,10"}),t.ui.addButton("Replace",{label:t.lang.find.replace,command:"replace",toolbar:"find,20"})),CKEDITOR.dialog.add("find",this.path+"dialogs/find.js"),CKEDITOR.dialog.add("replace",this.path+"dialogs/find.js")}}),CKEDITOR.config.find_highlight={element:"span",styles:{"background-color":"#004",color:"#fff"}},function(){function t(t,e){var n=i.exec(t),o=i.exec(e);if(n){if(!n[2]&&"px"==o[2])return o[1];if("px"==n[2]&&!o[2])return o[1]+"px"}return e}var e=CKEDITOR.htmlParser.cssStyle,n=CKEDITOR.tools.cssLength,i=/^((?:\d*(?:\.\d+))|(?:\d+))(.*)?$/i,o={elements:{$:function(n){var i=n.attributes;if((i=(i=(i=i&&i["data-cke-realelement"])&&new CKEDITOR.htmlParser.fragment.fromHtml(decodeURIComponent(i)))&&i.children[0])&&n.attributes["data-cke-resizable"]){var o=new e(n).rules,n=i.attributes,r=o.width,o=o.height;r&&(n.width=t(n.width,r)),o&&(n.height=t(n.height,o))}return i}}},r=CKEDITOR.plugins.add("fakeobjects",{init:function(t){t.filter.allow("img[!data-cke-realelement,src,alt,title](*){*}","fakeobjects")},afterInit:function(t){(t=(t=t.dataProcessor)&&t.htmlFilter)&&t.addRules(o)}});CKEDITOR.editor.prototype.createFakeElement=function(t,i,o,s){var l=this.lang.fakeobjects,l=l[o]||l.unknown,i={"class":i,"data-cke-realelement":encodeURIComponent(t.getOuterHtml()),"data-cke-real-node-type":t.type,alt:l,title:l,align:t.getAttribute("align")||""};return CKEDITOR.env.hc||(i.src=CKEDITOR.getUrl(r.path+"images/spacer.gif")),o&&(i["data-cke-real-element-type"]=o),s&&(i["data-cke-resizable"]=s,o=new e,s=t.getAttribute("width"),t=t.getAttribute("height"),s&&(o.rules.width=n(s)),t&&(o.rules.height=n(t)),o.populate(i)),this.document.createElement("img",{attributes:i})},CKEDITOR.editor.prototype.createFakeParserElement=function(t,i,o,s){var l,a=this.lang.fakeobjects,a=a[o]||a.unknown;return l=new CKEDITOR.htmlParser.basicWriter,t.writeHtml(l),l=l.getHtml(),i={"class":i,"data-cke-realelement":encodeURIComponent(l),"data-cke-real-node-type":t.type,alt:a,title:a,align:t.attributes.align||""},CKEDITOR.env.hc||(i.src=CKEDITOR.getUrl(r.path+"images/spacer.gif")),o&&(i["data-cke-real-element-type"]=o),s&&(i["data-cke-resizable"]=s,s=t.attributes,t=new e,o=s.width,s=s.height,void 0!=o&&(t.rules.width=n(o)),void 0!=s&&(t.rules.height=n(s)),t.populate(i)),new CKEDITOR.htmlParser.element("img",i)},CKEDITOR.editor.prototype.restoreRealElement=function(e){if(e.data("cke-real-node-type")!=CKEDITOR.NODE_ELEMENT)return null;var n=CKEDITOR.dom.element.createFromHtml(decodeURIComponent(e.data("cke-realelement")),this.document);if(e.data("cke-resizable")){var i=e.getStyle("width"),e=e.getStyle("height");i&&n.setAttribute("width",t(n.getAttribute("width"),i)),e&&n.setAttribute("height",t(n.getAttribute("height"),e))}return n}}(),function(){function t(t){return t=t.attributes,"application/x-shockwave-flash"==t.type||n.test(t.src||"")}function e(t,e){return t.createFakeParserElement(e,"cke_flash","flash",!0)}var n=/\.swf(?:$|\?)/i;CKEDITOR.plugins.add("flash",{requires:"dialog,fakeobjects",onLoad:function(){CKEDITOR.addCss("img.cke_flash{background-image: url("+CKEDITOR.getUrl(this.path+"images/placeholder.png")+");background-position: center center;background-repeat: no-repeat;border: 1px solid #a9a9a9;width: 80px;height: 80px;}")},init:function(t){var e="object[classid,codebase,height,hspace,vspace,width];param[name,value];embed[height,hspace,pluginspage,src,type,vspace,width]";CKEDITOR.dialog.isTabEnabled(t,"flash","properties")&&(e+=";object[align]; embed[allowscriptaccess,quality,scale,wmode]"),CKEDITOR.dialog.isTabEnabled(t,"flash","advanced")&&(e+=";object[id]{*}; embed[bgcolor]{*}(*)"),t.addCommand("flash",new CKEDITOR.dialogCommand("flash",{allowedContent:e,requiredContent:"embed"})),t.ui.addButton&&t.ui.addButton("Flash",{label:t.lang.common.flash,command:"flash",toolbar:"insert,20"}),CKEDITOR.dialog.add("flash",this.path+"dialogs/flash.js"),t.addMenuItems&&t.addMenuItems({flash:{label:t.lang.flash.properties,command:"flash",group:"flash"}}),t.on("doubleclick",function(t){var e=t.data.element;e.is("img")&&"flash"==e.data("cke-real-element-type")&&(t.data.dialog="flash")}),t.contextMenu&&t.contextMenu.addListener(function(t){return t&&t.is("img")&&!t.isReadOnly()&&"flash"==t.data("cke-real-element-type")?{flash:CKEDITOR.TRISTATE_OFF}:void 0
})},afterInit:function(n){var i=n.dataProcessor;(i=i&&i.dataFilter)&&i.addRules({elements:{"cke:object":function(i){var o=i.attributes;if(!(o.classid&&(""+o.classid).toLowerCase()||t(i))){for(o=0;o<i.children.length;o++)if("cke:embed"==i.children[o].name){if(!t(i.children[o]))break;return e(n,i)}return null}return e(n,i)},"cke:embed":function(i){return t(i)?e(n,i):null}}},5)}})}(),CKEDITOR.tools.extend(CKEDITOR.config,{flashEmbedTagOnly:!1,flashAddEmbedTag:!0,flashConvertOnEdit:!1}),function(){function t(t){var o=t.config,r=t.fire("uiSpace",{space:"top",html:""}).html,s=function(){function e(t,e,n){l.setStyle(e,i(n)),l.setStyle("position",t)}function r(t){var n=h.getDocumentPosition();switch(t){case"top":e("absolute","top",n.y-p-f);break;case"pin":e("fixed","top",C);break;case"bottom":e("absolute","top",n.y+(u.height||u.bottom-u.top)+f)}a=t}var a,h,d,u,c,p,m,g=o.floatSpaceDockedOffsetX||0,f=o.floatSpaceDockedOffsetY||0,x=o.floatSpacePinnedOffsetX||0,C=o.floatSpacePinnedOffsetY||0;return function(e){if(h=t.editable())if(e&&"focus"==e.name&&l.show(),l.removeStyle("left"),l.removeStyle("right"),d=l.getClientRect(),u=h.getClientRect(),c=n.getViewPaneSize(),p=d.height,m="pageXOffset"in n.$?n.$.pageXOffset:CKEDITOR.document.$.documentElement.scrollLeft,a){p+f<=u.top?r("top"):p+f>c.height-u.bottom?r("pin"):r("bottom");var o,e=c.width/2,e=u.left>0&&u.right<c.width&&u.width>d.width?"rtl"==t.config.contentsLangDirection?"right":"left":e-u.left>u.right-e?"left":"right";d.width>c.width?(e="left",o=0):(o="left"==e?u.left>0?u.left:0:u.right<c.width?c.width-u.right:0,o+d.width>c.width&&(e="left"==e?"right":"left",o=0)),l.setStyle(e,i(("pin"==a?x:g)+o+("pin"==a?0:"left"==e?m:-m)))}else a="pin",r("pin"),s(e)}}();if(r){var l=CKEDITOR.document.getBody().append(CKEDITOR.dom.element.createFromHtml(e.output({content:r,id:t.id,langDir:t.lang.dir,langCode:t.langCode,name:t.name,style:"display:none;z-index:"+(o.baseFloatZIndex-1),topId:t.ui.spaceId("top"),voiceLabel:t.lang.editorPanel+", "+t.name}))),a=CKEDITOR.tools.eventsBuffer(500,s),h=CKEDITOR.tools.eventsBuffer(100,s);l.unselectable(),l.on("mousedown",function(t){t=t.data,t.getTarget().hasAscendant("a",1)||t.preventDefault()}),t.on("focus",function(e){s(e),t.on("change",a.input),n.on("scroll",h.input),n.on("resize",h.input)}),t.on("blur",function(){l.hide(),t.removeListener("change",a.input),n.removeListener("scroll",h.input),n.removeListener("resize",h.input)}),t.on("destroy",function(){n.removeListener("scroll",h.input),n.removeListener("resize",h.input),l.clearCustomData(),l.remove()}),t.focusManager.hasFocus&&l.show(),t.focusManager.add(l,1)}}var e=CKEDITOR.addTemplate("floatcontainer",'<div id="cke_{name}" class="cke {id} cke_reset_all cke_chrome cke_editor_{name} cke_float cke_{langDir} '+CKEDITOR.env.cssClass+'" dir="{langDir}" title="'+(CKEDITOR.env.gecko?" ":"")+'" lang="{langCode}" role="application" style="{style}" aria-labelledby="cke_{name}_arialbl"><span id="cke_{name}_arialbl" class="cke_voice_label">{voiceLabel}</span><div class="cke_inner"><div id="{topId}" class="cke_top" role="presentation">{content}</div></div></div>'),n=CKEDITOR.document.getWindow(),i=CKEDITOR.tools.cssLength;CKEDITOR.plugins.add("floatingspace",{init:function(e){e.on("loaded",function(){t(this)},null,null,20)}})}(),CKEDITOR.plugins.add("listblock",{requires:"panel",onLoad:function(){var t=CKEDITOR.addTemplate("panel-list",'<ul role="presentation" class="cke_panel_list">{items}</ul>'),e=CKEDITOR.addTemplate("panel-list-item",'<li id="{id}" class="cke_panel_listItem" role=presentation><a id="{id}_option" _cke_focus=1 hidefocus=true title="{title}" href="javascript:void(\'{val}\')"  {onclick}="CKEDITOR.tools.callFunction({clickFn},\'{val}\'); return false;" role="option">{text}</a></li>'),n=CKEDITOR.addTemplate("panel-list-group",'<h1 id="{id}" class="cke_panel_grouptitle" role="presentation" >{label}</h1>'),i=/\'/g;CKEDITOR.ui.panel.prototype.addListBlock=function(t,e){return this.addBlock(t,new CKEDITOR.ui.listBlock(this.getHolderElement(),e))},CKEDITOR.ui.listBlock=CKEDITOR.tools.createClass({base:CKEDITOR.ui.panel.block,$:function(t,e){var e=e||{},n=e.attributes||(e.attributes={});(this.multiSelect=!!e.multiSelect)&&(n["aria-multiselectable"]=!0),!n.role&&(n.role="listbox"),this.base.apply(this,arguments),this.element.setAttribute("role",n.role),n=this.keys,n[40]="next",n[9]="next",n[38]="prev",n[CKEDITOR.SHIFT+9]="prev",n[32]=CKEDITOR.env.ie?"mouseup":"click",CKEDITOR.env.ie&&(n[13]="mouseup"),this._.pendingHtml=[],this._.pendingList=[],this._.items={},this._.groups={}},_:{close:function(){if(this._.started){var e=t.output({items:this._.pendingList.join("")});this._.pendingList=[],this._.pendingHtml.push(e),delete this._.started}},getClick:function(){return this._.click||(this._.click=CKEDITOR.tools.addFunction(function(t){var e=this.toggle(t);this.onClick&&this.onClick(t,e)},this)),this._.click}},proto:{add:function(t,n,o){var r=CKEDITOR.tools.getNextId();this._.started||(this._.started=1,this._.size=this._.size||0),this._.items[t]=r;var s;s=CKEDITOR.tools.htmlEncodeAttr(t).replace(i,"\\'"),t={id:r,val:s,onclick:CKEDITOR.env.ie?'onclick="return false;" onmouseup':"onclick",clickFn:this._.getClick(),title:CKEDITOR.tools.htmlEncodeAttr(o||t),text:n||t},this._.pendingList.push(e.output(t))},startGroup:function(t){this._.close();var e=CKEDITOR.tools.getNextId();this._.groups[t]=e,this._.pendingHtml.push(n.output({id:e,label:t}))},commit:function(){this._.close(),this.element.appendHtml(this._.pendingHtml.join("")),delete this._.size,this._.pendingHtml=[]},toggle:function(t){var e=this.isMarked(t);return e?this.unmark(t):this.mark(t),!e},hideGroup:function(t){var e=(t=this.element.getDocument().getById(this._.groups[t]))&&t.getNext();t&&(t.setStyle("display","none"),e&&"ul"==e.getName()&&e.setStyle("display","none"))},hideItem:function(t){this.element.getDocument().getById(this._.items[t]).setStyle("display","none")},showAll:function(){var t,e=this._.items,n=this._.groups,i=this.element.getDocument();for(t in e)i.getById(e[t]).setStyle("display","");for(var o in n)e=i.getById(n[o]),t=e.getNext(),e.setStyle("display",""),t&&"ul"==t.getName()&&t.setStyle("display","")},mark:function(t){this.multiSelect||this.unmarkAll();var t=this._.items[t],e=this.element.getDocument().getById(t);e.addClass("cke_selected"),this.element.getDocument().getById(t+"_option").setAttribute("aria-selected",!0),this.onMark&&this.onMark(e)},unmark:function(t){var e=this.element.getDocument(),t=this._.items[t],n=e.getById(t);n.removeClass("cke_selected"),e.getById(t+"_option").removeAttribute("aria-selected"),this.onUnmark&&this.onUnmark(n)},unmarkAll:function(){var t,e=this._.items,n=this.element.getDocument();for(t in e){var i=e[t];n.getById(i).removeClass("cke_selected"),n.getById(i+"_option").removeAttribute("aria-selected")}this.onUnmark&&this.onUnmark()},isMarked:function(t){return this.element.getDocument().getById(this._.items[t]).hasClass("cke_selected")},focus:function(t){this._.focusIndex=-1;var e,n=this.element.getElementsByTag("a"),i=-1;if(t){for(e=this.element.getDocument().getById(this._.items[t]).getFirst();t=n.getItem(++i);)if(t.equals(e)){this._.focusIndex=i;break}}else this.element.focus();e&&setTimeout(function(){e.focus()},0)}}})}}),function(){var t='<a id="{id}" class="cke_button cke_button__{name} cke_button_{state} {cls}"'+(CKEDITOR.env.gecko&&CKEDITOR.env.version>=10900&&!CKEDITOR.env.hc?"":" href=\"javascript:void('{titleJs}')\"")+' title="{title}" tabindex="-1" hidefocus="true" role="button" aria-labelledby="{id}_label" aria-haspopup="{hasArrow}" aria-disabled="{ariaDisabled}"';(CKEDITOR.env.opera||CKEDITOR.env.gecko&&CKEDITOR.env.mac)&&(t+=' onkeypress="return false;"'),CKEDITOR.env.gecko&&(t+=' onblur="this.style.cssText = this.style.cssText;"');var t=t+(' onkeydown="return CKEDITOR.tools.callFunction({keydownFn},event);" onfocus="return CKEDITOR.tools.callFunction({focusFn},event);"  onmousedown="return CKEDITOR.tools.callFunction({mousedownFn},event);" '+(CKEDITOR.env.ie?'onclick="return false;" onmouseup':"onclick")+'="CKEDITOR.tools.callFunction({clickFn},this);return false;"><span class="cke_button_icon cke_button__{iconName}_icon" style="{style}"'),t=t+'>&nbsp;</span><span id="{id}_label" class="cke_button_label cke_button__{name}_label" aria-hidden="false">{label}</span>{arrowHtml}</a>',e=CKEDITOR.addTemplate("buttonArrow",'<span class="cke_button_arrow">'+(CKEDITOR.env.hc?"&#9660;":"")+"</span>"),n=CKEDITOR.addTemplate("button",t);CKEDITOR.plugins.add("button",{beforeInit:function(t){t.ui.addHandler(CKEDITOR.UI_BUTTON,CKEDITOR.ui.button.handler)}}),CKEDITOR.UI_BUTTON="button",CKEDITOR.ui.button=function(t){CKEDITOR.tools.extend(this,t,{title:t.label,click:t.click||function(e){e.execCommand(t.command)}}),this._={}},CKEDITOR.ui.button.handler={create:function(t){return new CKEDITOR.ui.button(t)}},CKEDITOR.ui.button.prototype={render:function(t,i){var o,r=CKEDITOR.env,s=this._.id=CKEDITOR.tools.getNextId(),l="",a=this.command;this._.editor=t;var h={id:s,button:this,editor:t,focus:function(){CKEDITOR.document.getById(s).focus()},execute:function(){this.button.click(t)},attach:function(t){this.button.attach(t)}},d=CKEDITOR.tools.addFunction(function(t){return h.onkey?(t=new CKEDITOR.dom.event(t),h.onkey(h,t.getKeystroke())!==!1):void 0}),u=CKEDITOR.tools.addFunction(function(t){var e;return h.onfocus&&(e=h.onfocus(h,new CKEDITOR.dom.event(t))!==!1),CKEDITOR.env.gecko&&CKEDITOR.env.version<10900&&t.preventBubble(),e}),c=0,p=CKEDITOR.tools.addFunction(function(){if(CKEDITOR.env.opera){var e=t.editable();e.isInline()&&e.hasFocus&&(t.lockSelection(),c=1)}});if(h.clickFn=o=CKEDITOR.tools.addFunction(function(){c&&(t.unlockSelection(1),c=0),h.execute()}),this.modes){var m={},g=function(){var e=t.mode;e&&(e=this.modes[e]?void 0!=m[e]?m[e]:CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,e=t.readOnly&&!this.readOnly?CKEDITOR.TRISTATE_DISABLED:e,this.setState(e),this.refresh&&this.refresh())};t.on("beforeModeUnload",function(){t.mode&&this._.state!=CKEDITOR.TRISTATE_DISABLED&&(m[t.mode]=this._.state)},this),t.on("activeFilterChange",g,this),t.on("mode",g,this),!this.readOnly&&t.on("readOnly",g,this)}else a&&(a=t.getCommand(a))&&(a.on("state",function(){this.setState(a.state)},this),l+=a.state==CKEDITOR.TRISTATE_ON?"on":a.state==CKEDITOR.TRISTATE_DISABLED?"disabled":"off");this.directional&&t.on("contentDirChanged",function(e){var n=CKEDITOR.document.getById(this._.id),i=n.getFirst(),e=e.data;e!=t.lang.dir?n.addClass("cke_"+e):n.removeClass("cke_ltr").removeClass("cke_rtl"),i.setAttribute("style",CKEDITOR.skin.getIconStyle(f,"rtl"==e,this.icon,this.iconOffset))},this),a||(l+="off");var f=g=this.name||this.command;return this.icon&&!/\./.test(this.icon)&&(f=this.icon,this.icon=null),r={id:s,name:g,iconName:f,label:this.label,cls:this.className||"",state:l,ariaDisabled:"disabled"==l?"true":"false",title:this.title,titleJs:r.gecko&&r.version>=10900&&!r.hc?"":(this.title||"").replace("'",""),hasArrow:this.hasArrow?"true":"false",keydownFn:d,mousedownFn:p,focusFn:u,clickFn:o,style:CKEDITOR.skin.getIconStyle(f,"rtl"==t.lang.dir,this.icon,this.iconOffset),arrowHtml:this.hasArrow?e.output():""},n.output(r,i),this.onRender&&this.onRender(),h},setState:function(t){if(this._.state==t)return!1;this._.state=t;var e=CKEDITOR.document.getById(this._.id);return e?(e.setState(t,"cke_button"),t==CKEDITOR.TRISTATE_DISABLED?e.setAttribute("aria-disabled",!0):e.removeAttribute("aria-disabled"),this.hasArrow?(t=t==CKEDITOR.TRISTATE_ON?this._.editor.lang.button.selectedLabel.replace(/%1/g,this.label):this.label,CKEDITOR.document.getById(this._.id+"_label").setText(t)):t==CKEDITOR.TRISTATE_ON?e.setAttribute("aria-pressed",!0):e.removeAttribute("aria-pressed"),!0):!1},getState:function(){return this._.state},toFeature:function(t){if(this._.feature)return this._.feature;var e=this;return!this.allowedContent&&!this.requiredContent&&this.command&&(e=t.getCommand(this.command)||e),this._.feature=e}},CKEDITOR.ui.prototype.addButton=function(t,e){this.add(t,CKEDITOR.UI_BUTTON,e)}}(),CKEDITOR.plugins.add("richcombo",{requires:"floatpanel,listblock,button",beforeInit:function(t){t.ui.addHandler(CKEDITOR.UI_RICHCOMBO,CKEDITOR.ui.richCombo.handler)}}),function(){var t='<span id="{id}" class="cke_combo cke_combo__{name} {cls}" role="presentation"><span id="{id}_label" class="cke_combo_label">{label}</span><a class="cke_combo_button" hidefocus=true title="{title}" tabindex="-1"'+(CKEDITOR.env.gecko&&CKEDITOR.env.version>=10900&&!CKEDITOR.env.hc?"":'" href="javascript:void(\'{titleJs}\')"')+' hidefocus="true" role="button" aria-labelledby="{id}_label" aria-haspopup="true"';(CKEDITOR.env.opera||CKEDITOR.env.gecko&&CKEDITOR.env.mac)&&(t+=' onkeypress="return false;"'),CKEDITOR.env.gecko&&(t+=' onblur="this.style.cssText = this.style.cssText;"');var t=t+(' onkeydown="return CKEDITOR.tools.callFunction({keydownFn},event,this);" onmousedown="return CKEDITOR.tools.callFunction({mousedownFn},event);"  onfocus="return CKEDITOR.tools.callFunction({focusFn},event);" '+(CKEDITOR.env.ie?'onclick="return false;" onmouseup':"onclick")+'="CKEDITOR.tools.callFunction({clickFn},this);return false;"><span id="{id}_text" class="cke_combo_text cke_combo_inlinelabel">{label}</span><span class="cke_combo_open"><span class="cke_combo_arrow">'+(CKEDITOR.env.hc?"&#9660;":CKEDITOR.env.air?"&nbsp;":"")+"</span></span></a></span>"),e=CKEDITOR.addTemplate("combo",t);CKEDITOR.UI_RICHCOMBO="richcombo",CKEDITOR.ui.richCombo=CKEDITOR.tools.createClass({$:function(t){CKEDITOR.tools.extend(this,t,{canGroup:!1,title:t.label,modes:{wysiwyg:1},editorFocus:1}),t=this.panel||{},delete this.panel,this.id=CKEDITOR.tools.getNextNumber(),this.document=t.parent&&t.parent.getDocument()||CKEDITOR.document,t.className="cke_combopanel",t.block={multiSelect:t.multiSelect,attributes:t.attributes},t.toolbarRelated=!0,this._={panelDefinition:t,items:{}}},proto:{renderHtml:function(t){var e=[];return this.render(t,e),e.join("")},render:function(t,n){function i(){var e=this.modes[t.mode]?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED;t.readOnly&&!this.readOnly&&(e=CKEDITOR.TRISTATE_DISABLED),this.setState(e),this.setValue(""),e!=CKEDITOR.TRISTATE_DISABLED&&this.refresh&&this.refresh()}var o=CKEDITOR.env,r="cke_"+this.id,s=CKEDITOR.tools.addFunction(function(e){u&&(t.unlockSelection(1),u=0),a.execute(e)},this),l=this,a={id:r,combo:this,focus:function(){CKEDITOR.document.getById(r).getChild(1).focus()},execute:function(e){var n=l._;if(n.state!=CKEDITOR.TRISTATE_DISABLED)if(l.createPanel(t),n.on)n.panel.hide();else{l.commit();var i=l.getValue();i?n.list.mark(i):n.list.unmarkAll(),n.panel.showBlock(l.id,new CKEDITOR.dom.element(e),4)}},clickFn:s};t.on("activeFilterChange",i,this),t.on("mode",i,this),!this.readOnly&&t.on("readOnly",i,this);var h=CKEDITOR.tools.addFunction(function(e,n){var e=new CKEDITOR.dom.event(e),i=e.getKeystroke();switch(40==i&&t.once("panelShow",function(t){t.data._.panel._.currentBlock.onKeyDown(40)}),i){case 13:case 32:case 40:CKEDITOR.tools.callFunction(s,n);break;default:a.onkey(a,i)}e.preventDefault()}),d=CKEDITOR.tools.addFunction(function(){a.onfocus&&a.onfocus()}),u=0,c=CKEDITOR.tools.addFunction(function(){if(CKEDITOR.env.opera){var e=t.editable();e.isInline()&&e.hasFocus&&(t.lockSelection(),u=1)}});return a.keyDownFn=h,o={id:r,name:this.name||this.command,label:this.label,title:this.title,cls:this.className||"",titleJs:o.gecko&&o.version>=10900&&!o.hc?"":(this.title||"").replace("'",""),keydownFn:h,mousedownFn:c,focusFn:d,clickFn:s},e.output(o,n),this.onRender&&this.onRender(),a},createPanel:function(t){if(!this._.panel){var e=this._.panelDefinition,n=this._.panelDefinition.block,i=e.parent||CKEDITOR.document.getBody(),o="cke_combopanel__"+this.name,r=new CKEDITOR.ui.floatPanel(t,i,e),s=r.addListBlock(this.id,n),l=this;r.onShow=function(){this.element.addClass(o),l.setState(CKEDITOR.TRISTATE_ON),l._.on=1,l.editorFocus&&!t.focusManager.hasFocus&&t.focus(),l.onOpen&&l.onOpen(),t.once("panelShow",function(){s.focus(!s.multiSelect&&l.getValue())})},r.onHide=function(e){this.element.removeClass(o),l.setState(l.modes&&l.modes[t.mode]?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED),l._.on=0,!e&&l.onClose&&l.onClose()},r.onEscape=function(){r.hide(1)},s.onClick=function(t,e){l.onClick&&l.onClick.call(l,t,e),r.hide()},this._.panel=r,this._.list=s,r.getBlock(this.id).onHide=function(){l._.on=0,l.setState(CKEDITOR.TRISTATE_OFF)},this.init&&this.init()}},setValue:function(t,e){this._.value=t;var n=this.document.getById("cke_"+this.id+"_text");n&&(t||e?n.removeClass("cke_combo_inlinelabel"):(e=this.label,n.addClass("cke_combo_inlinelabel")),n.setText("undefined"!=typeof e?e:t))},getValue:function(){return this._.value||""},unmarkAll:function(){this._.list.unmarkAll()},mark:function(t){this._.list.mark(t)},hideItem:function(t){this._.list.hideItem(t)},hideGroup:function(t){this._.list.hideGroup(t)},showAll:function(){this._.list.showAll()},add:function(t,e,n){this._.items[t]=n||t,this._.list.add(t,e,n)},startGroup:function(t){this._.list.startGroup(t)},commit:function(){this._.committed||(this._.list.commit(),this._.committed=1,CKEDITOR.ui.fire("ready",this)),this._.committed=1},setState:function(t){if(this._.state!=t){var e=this.document.getById("cke_"+this.id);e.setState(t,"cke_combo"),t==CKEDITOR.TRISTATE_DISABLED?e.setAttribute("aria-disabled",!0):e.removeAttribute("aria-disabled"),this._.state=t}},getState:function(){return this._.state},enable:function(){this._.state==CKEDITOR.TRISTATE_DISABLED&&this.setState(this._.lastState)},disable:function(){this._.state!=CKEDITOR.TRISTATE_DISABLED&&(this._.lastState=this._.state,this.setState(CKEDITOR.TRISTATE_DISABLED))}},statics:{handler:{create:function(t){return new CKEDITOR.ui.richCombo(t)}}}}),CKEDITOR.ui.prototype.addRichCombo=function(t,e){this.add(t,CKEDITOR.UI_RICHCOMBO,e)}}(),function(){function t(t,e,n,i,o,r,s,l){for(var a=t.config,h=new CKEDITOR.style(s),d=o.split(";"),o=[],u={},c=0;c<d.length;c++){var p=d[c];if(p){var p=p.split("/"),m={},g=d[c]=p[0];m[n]=o[c]=p[1]||g,u[g]=new CKEDITOR.style(s,m),u[g]._.definition.name=g}else d.splice(c--,1)}t.ui.addRichCombo(e,{label:i.label,title:i.panelTitle,toolbar:"styles,"+l,allowedContent:h,requiredContent:h,panel:{css:[CKEDITOR.skin.getPath("editor")].concat(a.contentsCss),multiSelect:!1,attributes:{"aria-label":i.panelTitle}},init:function(){this.startGroup(i.panelTitle);for(var t=0;t<d.length;t++){var e=d[t];this.add(e,u[e].buildPreview(),e)}},onClick:function(e){t.focus(),t.fire("saveSnapshot");var n=u[e];t[this.getValue()==e?"removeStyle":"applyStyle"](n),t.fire("saveSnapshot")},onRender:function(){t.on("selectionChange",function(t){for(var e,n=this.getValue(),t=t.data.path.elements,i=0;i<t.length;i++){e=t[i];for(var o in u)if(u[o].checkElementMatch(e,!0))return o!=n&&this.setValue(o),void 0}this.setValue("",r)},this)},refresh:function(){t.activeFilter.check(h)||this.setState(CKEDITOR.TRISTATE_DISABLED)}})}CKEDITOR.plugins.add("font",{requires:"richcombo",init:function(e){var n=e.config;t(e,"Font","family",e.lang.font,n.font_names,n.font_defaultLabel,n.font_style,30),t(e,"FontSize","size",e.lang.font.fontSize,n.fontSize_sizes,n.fontSize_defaultLabel,n.fontSize_style,40)}})}(),CKEDITOR.config.font_names="Arial/Arial, Helvetica, sans-serif;Comic Sans MS/Comic Sans MS, cursive;Courier New/Courier New, Courier, monospace;Georgia/Georgia, serif;Lucida Sans Unicode/Lucida Sans Unicode, Lucida Grande, sans-serif;Tahoma/Tahoma, Geneva, sans-serif;Times New Roman/Times New Roman, Times, serif;Trebuchet MS/Trebuchet MS, Helvetica, sans-serif;Verdana/Verdana, Geneva, sans-serif",CKEDITOR.config.font_defaultLabel="",CKEDITOR.config.font_style={element:"span",styles:{"font-family":"#(family)"},overrides:[{element:"font",attributes:{face:null}}]},CKEDITOR.config.fontSize_sizes="8/8px;9/9px;10/10px;11/11px;12/12px;14/14px;16/16px;18/18px;20/20px;22/22px;24/24px;26/26px;28/28px;36/36px;48/48px;72/72px",CKEDITOR.config.fontSize_defaultLabel="",CKEDITOR.config.fontSize_style={element:"span",styles:{"font-size":"#(size)"},overrides:[{element:"font",attributes:{size:null}}]},CKEDITOR.plugins.add("format",{requires:"richcombo",init:function(t){if(!t.blockless){for(var e=t.config,n=t.lang.format,i=e.format_tags.split(";"),o={},r=0,s=[],l=0;l<i.length;l++){var a=i[l],h=new CKEDITOR.style(e["format_"+a]);(!t.filter.customConfig||t.filter.check(h))&&(r++,o[a]=h,o[a]._.enterMode=t.config.enterMode,s.push(h))}0!==r&&t.ui.addRichCombo("Format",{label:n.label,title:n.panelTitle,toolbar:"styles,20",allowedContent:s,panel:{css:[CKEDITOR.skin.getPath("editor")].concat(e.contentsCss),multiSelect:!1,attributes:{"aria-label":n.panelTitle}},init:function(){this.startGroup(n.panelTitle);for(var t in o){var e=n["tag_"+t];this.add(t,o[t].buildPreview(e),e)}},onClick:function(e){t.focus(),t.fire("saveSnapshot");var e=o[e],n=t.elementPath();t[e.checkActive(n)?"removeStyle":"applyStyle"](e),setTimeout(function(){t.fire("saveSnapshot")},0)},onRender:function(){t.on("selectionChange",function(e){var n=this.getValue(),e=e.data.path;this.refresh();for(var i in o)if(o[i].checkActive(e))return i!=n&&this.setValue(i,t.lang.format["tag_"+i]),void 0;this.setValue("")},this)},onOpen:function(){this.showAll();for(var e in o)t.activeFilter.check(o[e])||this.hideItem(e)},refresh:function(){var e=t.elementPath();if(e){if(e.isContextFor("p"))for(var n in o)if(t.activeFilter.check(o[n]))return;this.setState(CKEDITOR.TRISTATE_DISABLED)}}})}}}),CKEDITOR.config.format_tags="p;h1;h2;h3;h4;h5;h6;pre;address;div",CKEDITOR.config.format_p={element:"p"},CKEDITOR.config.format_div={element:"div"},CKEDITOR.config.format_pre={element:"pre"},CKEDITOR.config.format_address={element:"address"},CKEDITOR.config.format_h1={element:"h1"},CKEDITOR.config.format_h2={element:"h2"},CKEDITOR.config.format_h3={element:"h3"},CKEDITOR.config.format_h4={element:"h4"},CKEDITOR.config.format_h5={element:"h5"},CKEDITOR.config.format_h6={element:"h6"},CKEDITOR.plugins.add("forms",{requires:"dialog,fakeobjects",onLoad:function(){CKEDITOR.addCss(".cke_editable form{border: 1px dotted #FF0000;padding: 2px;}\n"),CKEDITOR.addCss("img.cke_hidden{background-image: url("+CKEDITOR.getUrl(this.path+"images/hiddenfield.gif")+");background-position: center center;background-repeat: no-repeat;border: 1px solid #a9a9a9;width: 16px !important;height: 16px !important;}")},init:function(t){var e=t.lang,n=0,i={email:1,password:1,search:1,tel:1,text:1,url:1},o={checkbox:"input[type,name,checked]",radio:"input[type,name,checked]",textfield:"input[type,name,value,size,maxlength]",textarea:"textarea[cols,rows,name]",select:"select[name,size,multiple]; option[value,selected]",button:"input[type,name,value]",form:"form[action,name,id,enctype,target,method]",hiddenfield:"input[type,name,value]",imagebutton:"input[type,alt,src]{width,height,border,border-width,border-style,margin,float}"},r={checkbox:"input",radio:"input",textfield:"input",textarea:"textarea",select:"select",button:"input",form:"form",hiddenfield:"input",imagebutton:"input"},s=function(i,s,l){var a={allowedContent:o[s],requiredContent:r[s]};"form"==s&&(a.context="form"),t.addCommand(s,new CKEDITOR.dialogCommand(s,a)),t.ui.addButton&&t.ui.addButton(i,{label:e.common[i.charAt(0).toLowerCase()+i.slice(1)],command:s,toolbar:"forms,"+(n+=10)}),CKEDITOR.dialog.add(s,l)},l=this.path+"dialogs/";!t.blockless&&s("Form","form",l+"form.js"),s("Checkbox","checkbox",l+"checkbox.js"),s("Radio","radio",l+"radio.js"),s("TextField","textfield",l+"textfield.js"),s("Textarea","textarea",l+"textarea.js"),s("Select","select",l+"select.js"),s("Button","button",l+"button.js");var a=t.plugins.image;a&&!t.plugins.image2&&s("ImageButton","imagebutton",CKEDITOR.plugins.getPath("image")+"dialogs/image.js"),s("HiddenField","hiddenfield",l+"hiddenfield.js"),t.addMenuItems&&(s={checkbox:{label:e.forms.checkboxAndRadio.checkboxTitle,command:"checkbox",group:"checkbox"},radio:{label:e.forms.checkboxAndRadio.radioTitle,command:"radio",group:"radio"},textfield:{label:e.forms.textfield.title,command:"textfield",group:"textfield"},hiddenfield:{label:e.forms.hidden.title,command:"hiddenfield",group:"hiddenfield"},button:{label:e.forms.button.title,command:"button",group:"button"},select:{label:e.forms.select.title,command:"select",group:"select"},textarea:{label:e.forms.textarea.title,command:"textarea",group:"textarea"}},a&&(s.imagebutton={label:e.image.titleButton,command:"imagebutton",group:"imagebutton"}),!t.blockless&&(s.form={label:e.forms.form.menu,command:"form",group:"form"}),t.addMenuItems(s)),t.contextMenu&&(!t.blockless&&t.contextMenu.addListener(function(t,e,n){return(t=n.contains("form",1))&&!t.isReadOnly()?{form:CKEDITOR.TRISTATE_OFF}:void 0}),t.contextMenu.addListener(function(t){if(t&&!t.isReadOnly()){var e=t.getName();if("select"==e)return{select:CKEDITOR.TRISTATE_OFF};if("textarea"==e)return{textarea:CKEDITOR.TRISTATE_OFF};if("input"==e){var n=t.getAttribute("type")||"text";switch(n){case"button":case"submit":case"reset":return{button:CKEDITOR.TRISTATE_OFF};case"checkbox":return{checkbox:CKEDITOR.TRISTATE_OFF};case"radio":return{radio:CKEDITOR.TRISTATE_OFF};case"image":return a?{imagebutton:CKEDITOR.TRISTATE_OFF}:null}if(i[n])return{textfield:CKEDITOR.TRISTATE_OFF}}if("img"==e&&"hiddenfield"==t.data("cke-real-element-type"))return{hiddenfield:CKEDITOR.TRISTATE_OFF}}})),t.on("doubleclick",function(e){var n=e.data.element;if(!t.blockless&&n.is("form"))e.data.dialog="form";else if(n.is("select"))e.data.dialog="select";else if(n.is("textarea"))e.data.dialog="textarea";else if(n.is("img")&&"hiddenfield"==n.data("cke-real-element-type"))e.data.dialog="hiddenfield";else if(n.is("input")){switch(n=n.getAttribute("type")||"text"){case"button":case"submit":case"reset":e.data.dialog="button";break;case"checkbox":e.data.dialog="checkbox";break;case"radio":e.data.dialog="radio";break;case"image":e.data.dialog="imagebutton"}i[n]&&(e.data.dialog="textfield")}})},afterInit:function(t){var e=t.dataProcessor,n=e&&e.htmlFilter,e=e&&e.dataFilter;CKEDITOR.env.ie&&n&&n.addRules({elements:{input:function(t){var t=t.attributes,e=t.type;e||(t.type="text"),("checkbox"==e||"radio"==e)&&"on"==t.value&&delete t.value}}},{applyToAll:!0}),e&&e.addRules({elements:{input:function(e){return"hidden"==e.attributes.type?t.createFakeParserElement(e,"cke_hidden","hiddenfield"):void 0}}},{applyToAll:!0})}}),CKEDITOR.env.ie&&(CKEDITOR.dom.element.prototype.hasAttribute=CKEDITOR.tools.override(CKEDITOR.dom.element.prototype.hasAttribute,function(t){return function(e){if(this.$.attributes.getNamedItem(e),"input"==this.getName())switch(e){case"class":return this.$.className.length>0;case"checked":return!!this.$.checked;case"value":var n=this.getAttribute("type");return"checkbox"==n||"radio"==n?"on"!=this.$.value:this.$.value}return t.apply(this,arguments)}})),function(){var t={canUndo:!1,exec:function(t){var e=t.document.createElement("hr");t.insertElement(e)},allowedContent:"hr",requiredContent:"hr"};CKEDITOR.plugins.add("horizontalrule",{init:function(e){e.blockless||(e.addCommand("horizontalrule",t),e.ui.addButton&&e.ui.addButton("HorizontalRule",{label:e.lang.horizontalrule.toolbar,command:"horizontalrule",toolbar:"insert,40"}))}})}(),CKEDITOR.plugins.add("htmlwriter",{init:function(t){var e=new CKEDITOR.htmlWriter;e.forceSimpleAmpersand=t.config.forceSimpleAmpersand,e.indentationChars=t.config.dataIndentationChars||"	",t.dataProcessor.writer=e}}),CKEDITOR.htmlWriter=CKEDITOR.tools.createClass({base:CKEDITOR.htmlParser.basicWriter,$:function(){this.base(),this.indentationChars="	",this.selfClosingEnd=" />",this.lineBreakChars="\n",this.sortAttributes=1,this._.indent=0,this._.indentation="",this._.inPre=0,this._.rules={};var t,e=CKEDITOR.dtd;for(t in CKEDITOR.tools.extend({},e.$nonBodyContent,e.$block,e.$listItem,e.$tableContent))this.setRules(t,{indent:!e[t]["#"],breakBeforeOpen:1,breakBeforeClose:!e[t]["#"],breakAfterClose:1,needsSpace:t in e.$block&&!(t in{li:1,dt:1,dd:1})});this.setRules("br",{breakAfterOpen:1}),this.setRules("title",{indent:0,breakAfterOpen:0}),this.setRules("style",{indent:0,breakBeforeClose:1}),this.setRules("pre",{breakAfterOpen:1,indent:0})},proto:{openTag:function(t){var e=this._.rules[t];this._.afterCloser&&e&&e.needsSpace&&this._.needsSpace&&this._.output.push("\n"),this._.indent?this.indentation():e&&e.breakBeforeOpen&&(this.lineBreak(),this.indentation()),this._.output.push("<",t),this._.afterCloser=0},openTagClose:function(t,e){var n=this._.rules[t];e?(this._.output.push(this.selfClosingEnd),n&&n.breakAfterClose&&(this._.needsSpace=n.needsSpace)):(this._.output.push(">"),n&&n.indent&&(this._.indentation=this._.indentation+this.indentationChars)),n&&n.breakAfterOpen&&this.lineBreak(),"pre"==t&&(this._.inPre=1)},attribute:function(t,e){"string"==typeof e&&(this.forceSimpleAmpersand&&(e=e.replace(/&amp;/g,"&")),e=CKEDITOR.tools.htmlEncodeAttr(e)),this._.output.push(" ",t,'="',e,'"')},closeTag:function(t){var e=this._.rules[t];e&&e.indent&&(this._.indentation=this._.indentation.substr(this.indentationChars.length)),this._.indent?this.indentation():e&&e.breakBeforeClose&&(this.lineBreak(),this.indentation()),this._.output.push("</",t,">"),"pre"==t&&(this._.inPre=0),e&&e.breakAfterClose&&(this.lineBreak(),this._.needsSpace=e.needsSpace),this._.afterCloser=1},text:function(t){this._.indent&&(this.indentation(),!this._.inPre&&(t=CKEDITOR.tools.ltrim(t))),this._.output.push(t)},comment:function(t){this._.indent&&this.indentation(),this._.output.push("<!--",t,"-->")},lineBreak:function(){!this._.inPre&&this._.output.length>0&&this._.output.push(this.lineBreakChars),this._.indent=1},indentation:function(){!this._.inPre&&this._.indentation&&this._.output.push(this._.indentation),this._.indent=0},reset:function(){this._.output=[],this._.indent=0,this._.indentation="",this._.afterCloser=0,this._.inPre=0},setRules:function(t,e){var n=this._.rules[t];n?CKEDITOR.tools.extend(n,e,!0):this._.rules[t]=e}}}),function(){CKEDITOR.plugins.add("iframe",{requires:"dialog,fakeobjects",onLoad:function(){CKEDITOR.addCss("img.cke_iframe{background-image: url("+CKEDITOR.getUrl(this.path+"images/placeholder.png")+");background-position: center center;background-repeat: no-repeat;border: 1px solid #a9a9a9;width: 80px;height: 80px;}")},init:function(t){var e=t.lang.iframe,n="iframe[align,longdesc,frameborder,height,name,scrolling,src,title,width]";t.plugins.dialogadvtab&&(n+=";iframe"+t.plugins.dialogadvtab.allowedContent({id:1,classes:1,styles:1})),CKEDITOR.dialog.add("iframe",this.path+"dialogs/iframe.js"),t.addCommand("iframe",new CKEDITOR.dialogCommand("iframe",{allowedContent:n,requiredContent:"iframe"})),t.ui.addButton&&t.ui.addButton("Iframe",{label:e.toolbar,command:"iframe",toolbar:"insert,80"}),t.on("doubleclick",function(t){var e=t.data.element;e.is("img")&&"iframe"==e.data("cke-real-element-type")&&(t.data.dialog="iframe")}),t.addMenuItems&&t.addMenuItems({iframe:{label:e.title,command:"iframe",group:"image"}}),t.contextMenu&&t.contextMenu.addListener(function(t){return t&&t.is("img")&&"iframe"==t.data("cke-real-element-type")?{iframe:CKEDITOR.TRISTATE_OFF}:void 0})},afterInit:function(t){var e=t.dataProcessor;(e=e&&e.dataFilter)&&e.addRules({elements:{iframe:function(e){return t.createFakeParserElement(e,"cke_iframe","iframe",!0)}}})}})}(),function(){function t(t,e){return e||(e=t.getSelection().getSelectedElement()),e&&e.is("img")&&!e.data("cke-realelement")&&!e.isReadOnly()?e:void 0}function e(t){var e=t.getStyle("float");return("inherit"==e||"none"==e)&&(e=0),e||(e=t.getAttribute("align")),e}CKEDITOR.plugins.add("image",{requires:"dialog",init:function(e){if(!e.plugins.image2){CKEDITOR.dialog.add("image",this.path+"dialogs/image.js");var n="img[alt,!src]{border-style,border-width,float,height,margin,margin-bottom,margin-left,margin-right,margin-top,width}";CKEDITOR.dialog.isTabEnabled(e,"image","advanced")&&(n="img[alt,dir,id,lang,longdesc,!src,title]{*}(*)"),e.addCommand("image",new CKEDITOR.dialogCommand("image",{allowedContent:n,requiredContent:"img[alt,src]",contentTransformations:[["img{width}: sizeToStyle","img[width]: sizeToAttribute"],["img{float}: alignmentToStyle","img[align]: alignmentToAttribute"]]})),e.ui.addButton&&e.ui.addButton("Image",{label:e.lang.common.image,command:"image",toolbar:"insert,10"}),e.on("doubleclick",function(t){var e=t.data.element;!e.is("img")||e.data("cke-realelement")||e.isReadOnly()||(t.data.dialog="image")}),e.addMenuItems&&e.addMenuItems({image:{label:e.lang.image.menu,command:"image",group:"image"}}),e.contextMenu&&e.contextMenu.addListener(function(n){return t(e,n)?{image:CKEDITOR.TRISTATE_OFF}:void 0})}},afterInit:function(n){function i(i){var o=n.getCommand("justify"+i);
o&&(("left"==i||"right"==i)&&o.on("exec",function(o){var r,s=t(n);s&&(r=e(s),r==i?(s.removeStyle("float"),i==e(s)&&s.removeAttribute("align")):s.setStyle("float",i),o.cancel())}),o.on("refresh",function(o){var r=t(n);r&&(r=e(r),this.setState(r==i?CKEDITOR.TRISTATE_ON:"right"==i||"left"==i?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED),o.cancel())}))}n.plugins.image2||(i("left"),i("right"),i("center"),i("block"))}})}(),CKEDITOR.config.image_removeLinkByEmptyURL=!0,function(){function t(t,i){var o,r;i.on("refresh",function(t){var i,o=[e];for(i in t.data.states)o.push(t.data.states[i]);this.setState(CKEDITOR.tools.search(o,n)?n:e)},i,null,100),i.on("exec",function(e){o=t.getSelection(),r=o.createBookmarks(1),e.data||(e.data={}),e.data.done=!1},i,null,0),i.on("exec",function(){t.forceNextSelectionCheck(),o.selectBookmarks(r)},i,null,100)}var e=CKEDITOR.TRISTATE_DISABLED,n=CKEDITOR.TRISTATE_OFF;CKEDITOR.plugins.add("indent",{init:function(e){var n=CKEDITOR.plugins.indent.genericDefinition;t(e,e.addCommand("indent",new n(!0))),t(e,e.addCommand("outdent",new n)),e.ui.addButton&&(e.ui.addButton("Indent",{label:e.lang.indent.indent,command:"indent",directional:!0,toolbar:"indent,20"}),e.ui.addButton("Outdent",{label:e.lang.indent.outdent,command:"outdent",directional:!0,toolbar:"indent,10"})),e.on("dirChanged",function(t){var n=e.createRange(),i=t.data.node;n.setStartBefore(i),n.setEndAfter(i);for(var o,r=new CKEDITOR.dom.walker(n);o=r.next();)if(o.type==CKEDITOR.NODE_ELEMENT)if(!o.equals(i)&&o.getDirection())n.setStartAfter(o),r=new CKEDITOR.dom.walker(n);else{var s=e.config.indentClasses;if(s)for(var l="ltr"==t.data.dir?["_rtl",""]:["","_rtl"],a=0;a<s.length;a++)o.hasClass(s[a]+l[0])&&(o.removeClass(s[a]+l[0]),o.addClass(s[a]+l[1]));s=o.getStyle("margin-right"),l=o.getStyle("margin-left"),s?o.setStyle("margin-left",s):o.removeStyle("margin-left"),l?o.setStyle("margin-right",l):o.removeStyle("margin-right")}})}}),CKEDITOR.plugins.indent={genericDefinition:function(t){this.isIndent=!!t,this.startDisabled=!this.isIndent},specificDefinition:function(t,e,n){this.name=e,this.editor=t,this.jobs={},this.enterBr=t.config.enterMode==CKEDITOR.ENTER_BR,this.isIndent=!!n,this.relatedGlobal=n?"indent":"outdent",this.indentKey=n?9:CKEDITOR.SHIFT+9,this.database={}},registerCommands:function(t,e){t.on("pluginsLoaded",function(){for(var t in e)(function(t,e){var n,i=t.getCommand(e.relatedGlobal);for(n in e.jobs)i.on("exec",function(i){i.data.done||(t.fire("lockSnapshot"),e.execJob(t,n)&&(i.data.done=!0),t.fire("unlockSnapshot"),CKEDITOR.dom.element.clearAllMarkers(e.database))},this,null,n),i.on("refresh",function(i){i.data.states||(i.data.states={}),i.data.states[e.name+"@"+n]=e.refreshJob(t,n,i.data.path)},this,null,n);t.addFeature(e)})(this,e[t])})}},CKEDITOR.plugins.indent.genericDefinition.prototype={context:"p",exec:function(){}},CKEDITOR.plugins.indent.specificDefinition.prototype={execJob:function(t,n){var i=this.jobs[n];return i.state!=e?i.exec.call(this,t):void 0},refreshJob:function(t,n,i){return n=this.jobs[n],n.state=t.activeFilter.checkFeature(this)?n.refresh.call(this,t,i):e,n.state},getContext:function(t){return t.contains(this.context)}}}(),function(){function t(t){function e(e){for(var n=o.startContainer,a=o.endContainer;n&&!n.getParent().equals(e);)n=n.getParent();for(;a&&!a.getParent().equals(e);)a=a.getParent();if(!n||!a)return!1;for(var h=n,n=[],d=!1;!d;)h.equals(a)&&(d=!0),n.push(h),h=h.getNext();if(n.length<1)return!1;for(h=e.getParents(!0),a=0;a<h.length;a++)if(h[a].getName&&l[h[a].getName()]){e=h[a];break}for(var h=r.isIndent?1:-1,a=n[0],n=n[n.length-1],d=CKEDITOR.plugins.list.listToArray(e,s),u=d[n.getCustomData("listarray_index")].indent,a=a.getCustomData("listarray_index");a<=n.getCustomData("listarray_index");a++)if(d[a].indent=d[a].indent+h,h>0){var c=d[a].parent;d[a].parent=new CKEDITOR.dom.element(c.getName(),c.getDocument())}for(a=n.getCustomData("listarray_index")+1;a<d.length&&d[a].indent>u;a++)d[a].indent=d[a].indent+h;if(n=CKEDITOR.plugins.list.arrayToList(d,s,null,t.config.enterMode,e.getDirection()),!r.isIndent){var p;if((p=e.getParent())&&p.is("li"))for(var m,h=n.listNode.getChildren(),g=[],a=h.count()-1;a>=0;a--)(m=h.getItem(a))&&m.is&&m.is("li")&&g.push(m)}if(n&&n.listNode.replace(e),g&&g.length)for(a=0;a<g.length;a++){for(m=e=g[a];(m=m.getNext())&&m.is&&m.getName()in l;)CKEDITOR.env.needsNbspFiller&&!e.getFirst(i)&&e.append(o.document.createText("")),e.append(m);e.insertAfter(p)}return n&&t.fire("contentDomInvalidated"),!0}for(var o,r=this,s=this.database,l=this.context,a=t.getSelection(),a=(a&&a.getRanges()).createIterator();o=a.getNextRange();){for(var h=o.getCommonAncestor();h&&(h.type!=CKEDITOR.NODE_ELEMENT||!l[h.getName()]);)h=h.getParent();if(h||(h=o.startPath().contains(l))&&o.setEndAt(h,CKEDITOR.POSITION_BEFORE_END),!h){var d=o.getEnclosedNode();d&&d.type==CKEDITOR.NODE_ELEMENT&&d.getName()in l&&(o.setStartAt(d,CKEDITOR.POSITION_AFTER_START),o.setEndAt(d,CKEDITOR.POSITION_BEFORE_END),h=d)}if(h&&o.startContainer.type==CKEDITOR.NODE_ELEMENT&&o.startContainer.getName()in l&&(d=new CKEDITOR.dom.walker(o),d.evaluator=n,o.startContainer=d.next()),h&&o.endContainer.type==CKEDITOR.NODE_ELEMENT&&o.endContainer.getName()in l&&(d=new CKEDITOR.dom.walker(o),d.evaluator=n,o.endContainer=d.previous()),h)return e(h)}return 0}function e(t,e){return e||(e=t.contains(this.context)),e&&t.block&&t.block.equals(e.getFirst(n))}function n(t){return t.type==CKEDITOR.NODE_ELEMENT&&t.is("li")}function i(t){return o(t)&&r(t)}var o=CKEDITOR.dom.walker.whitespaces(!0),r=CKEDITOR.dom.walker.bookmark(!1,!0),s=CKEDITOR.TRISTATE_DISABLED,l=CKEDITOR.TRISTATE_OFF;CKEDITOR.plugins.add("indentlist",{requires:"indent",init:function(n){function i(n){o.specificDefinition.apply(this,arguments),this.requiredContent=["ul","ol"],n.on("key",function(t){if("wysiwyg"==n.mode&&t.data.keyCode==this.indentKey){var i=this.getContext(n.elementPath());!i||this.isIndent&&e.call(this,n.elementPath(),i)||(n.execCommand(this.relatedGlobal),t.cancel())}},this),this.jobs[this.isIndent?10:30]={refresh:this.isIndent?function(t,n){var i=this.getContext(n),o=e.call(this,n,i);return i&&this.isIndent&&!o?l:s}:function(t,e){return!this.getContext(e)||this.isIndent?s:l},exec:CKEDITOR.tools.bind(t,this)}}var o=CKEDITOR.plugins.indent;o.registerCommands(n,{indentlist:new i(n,"indentlist",!0),outdentlist:new i(n,"outdentlist")}),CKEDITOR.tools.extend(i.prototype,o.specificDefinition.prototype,{context:{ol:1,ul:1}})}})}(),function(){function t(t,n,i){if(!t.getCustomData("indent_processed")){var o=this.editor,r=this.isIndent;if(n){if(o=t.$.className.match(this.classNameRegex),i=0,o&&(o=o[1],i=CKEDITOR.tools.indexOf(n,o)+1),(i+=r?1:-1)<0)return;i=Math.min(i,n.length),i=Math.max(i,0),t.$.className=CKEDITOR.tools.ltrim(t.$.className.replace(this.classNameRegex,"")),i>0&&t.addClass(n[i-1])}else{var n=e(t,i),i=parseInt(t.getStyle(n),10),s=o.config.indentOffset||40;if(isNaN(i)&&(i=0),i+=(r?1:-1)*s,0>i)return;i=Math.max(i,0),i=Math.ceil(i/s)*s,t.setStyle(n,i?i+(o.config.indentUnit||"px"):""),""===t.getAttribute("style")&&t.removeAttribute("style")}CKEDITOR.dom.element.setMarker(this.database,t,"indent_processed",1)}}function e(t,e){return"ltr"==(e||t.getComputedStyle("direction"))?"margin-left":"margin-right"}var n=CKEDITOR.dtd.$listItem,i=CKEDITOR.dtd.$list,o=CKEDITOR.TRISTATE_DISABLED,r=CKEDITOR.TRISTATE_OFF;CKEDITOR.plugins.add("indentblock",{requires:"indent",init:function(s){function l(){a.specificDefinition.apply(this,arguments),this.allowedContent={"div h1 h2 h3 h4 h5 h6 ol p pre ul":{propertiesOnly:!0,styles:h?null:"margin-left,margin-right",classes:h||null}},this.enterBr&&(this.allowedContent.div=!0),this.requiredContent=(this.enterBr?"div":"p")+(h?"("+h.join(",")+")":"{margin-left}"),this.jobs={20:{refresh:function(t,i){var s=i.block||i.blockLimit;if(s.is(n))s=s.getParent();else if(s.getAscendant(n))return o;if(!this.enterBr&&!this.getContext(i))return o;if(h){var l;l=h;var s=s.$.className.match(this.classNameRegex),a=this.isIndent;return l=s?a?s[1]!=l.slice(-1):!0:a,l?r:o}return this.isIndent?r:s?CKEDITOR[(parseInt(s.getStyle(e(s)),10)||0)<=0?"TRISTATE_DISABLED":"TRISTATE_OFF"]:o},exec:function(e){var n,o=e.getSelection(),o=o&&o.getRanges()[0];if(n=e.elementPath().contains(i))t.call(this,n,h);else for(o=o.createIterator(),e=e.config.enterMode,o.enforceRealBlocks=!0,o.enlargeBr=e!=CKEDITOR.ENTER_BR;n=o.getNextParagraph(e==CKEDITOR.ENTER_P?"p":"div");)n.isReadOnly()||t.call(this,n,h);return!0}}}}var a=CKEDITOR.plugins.indent,h=s.config.indentClasses;a.registerCommands(s,{indentblock:new l(s,"indentblock",!0),outdentblock:new l(s,"outdentblock")}),CKEDITOR.tools.extend(l.prototype,a.specificDefinition.prototype,{context:{div:1,dl:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,ul:1,ol:1,p:1,pre:1,table:1},classNameRegex:h?RegExp("(?:^|\\s+)("+h.join("|")+")(?=$|\\s)"):null})}})}(),function(){function t(t,e){var n,e=void 0===e||e;if(e)n=t.getComputedStyle("text-align");else{for(;(!t.hasAttribute||!t.hasAttribute("align")&&!t.getStyle("text-align"))&&(n=t.getParent(),n);)t=n;n=t.getStyle("text-align")||t.getAttribute("align")||""}return n&&(n=n.replace(/(?:-(?:moz|webkit)-)?(?:start|auto)/i,"")),!n&&e&&(n="rtl"==t.getComputedStyle("direction")?"right":"left"),n}function e(t,e,n){this.editor=t,this.name=e,this.value=n,this.context="p";var e=t.config.justifyClasses,i=t.config.enterMode==CKEDITOR.ENTER_P?"p":"div";if(e){switch(n){case"left":this.cssClassName=e[0];break;case"center":this.cssClassName=e[1];break;case"right":this.cssClassName=e[2];break;case"justify":this.cssClassName=e[3]}this.cssClassRegex=RegExp("(?:^|\\s+)(?:"+e.join("|")+")(?=$|\\s)"),this.requiredContent=i+"("+this.cssClassName+")"}else this.requiredContent=i+"{text-align}";this.allowedContent={"caption div h1 h2 h3 h4 h5 h6 p pre td th li":{propertiesOnly:!0,styles:this.cssClassName?null:"text-align",classes:this.cssClassName||null}},t.config.enterMode==CKEDITOR.ENTER_BR&&(this.allowedContent.div=!0)}function n(t){var e=t.editor,n=e.createRange();n.setStartBefore(t.data.node),n.setEndAfter(t.data.node);for(var i,o=new CKEDITOR.dom.walker(n);i=o.next();)if(i.type==CKEDITOR.NODE_ELEMENT)if(!i.equals(t.data.node)&&i.getDirection())n.setStartAfter(i),o=new CKEDITOR.dom.walker(n);else{var r=e.config.justifyClasses;r&&(i.hasClass(r[0])?(i.removeClass(r[0]),i.addClass(r[2])):i.hasClass(r[2])&&(i.removeClass(r[2]),i.addClass(r[0]))),r=i.getStyle("text-align"),"left"==r?i.setStyle("text-align","right"):"right"==r&&i.setStyle("text-align","left")}}e.prototype={exec:function(e){var n=e.getSelection(),i=e.config.enterMode;if(n){for(var o,r,s=n.createBookmarks(),l=n.getRanges(),a=this.cssClassName,h=e.config.useComputedState,h=void 0===h||h,d=l.length-1;d>=0;d--)for(o=l[d].createIterator(),o.enlargeBr=i!=CKEDITOR.ENTER_BR;r=o.getNextParagraph(i==CKEDITOR.ENTER_P?"p":"div");)if(!r.isReadOnly()){r.removeAttribute("align"),r.removeStyle("text-align");var u=a&&(r.$.className=CKEDITOR.tools.ltrim(r.$.className.replace(this.cssClassRegex,""))),c=this.state==CKEDITOR.TRISTATE_OFF&&(!h||t(r,!0)!=this.value);a?c?r.addClass(a):u||r.removeAttribute("class"):c&&r.setStyle("text-align",this.value)}e.focus(),e.forceNextSelectionCheck(),n.selectBookmarks(s)}},refresh:function(e,n){var i=n.block||n.blockLimit;this.setState("body"!=i.getName()&&t(i,this.editor.config.useComputedState)==this.value?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)}},CKEDITOR.plugins.add("justify",{init:function(t){if(!t.blockless){var i=new e(t,"justifyleft","left"),o=new e(t,"justifycenter","center"),r=new e(t,"justifyright","right"),s=new e(t,"justifyblock","justify");t.addCommand("justifyleft",i),t.addCommand("justifycenter",o),t.addCommand("justifyright",r),t.addCommand("justifyblock",s),t.ui.addButton&&(t.ui.addButton("JustifyLeft",{label:t.lang.justify.left,command:"justifyleft",toolbar:"align,10"}),t.ui.addButton("JustifyCenter",{label:t.lang.justify.center,command:"justifycenter",toolbar:"align,20"}),t.ui.addButton("JustifyRight",{label:t.lang.justify.right,command:"justifyright",toolbar:"align,30"}),t.ui.addButton("JustifyBlock",{label:t.lang.justify.block,command:"justifyblock",toolbar:"align,40"})),t.on("dirChanged",n)}}})}(),CKEDITOR.plugins.add("link",{requires:"dialog,fakeobjects",onLoad:function(){function t(t){return n.replace(/%1/g,"rtl"==t?"right":"left").replace(/%2/g,"cke_contents_"+t)}var e="background:url("+CKEDITOR.getUrl(this.path+"images"+(CKEDITOR.env.hidpi?"/hidpi":"")+"/anchor.png")+") no-repeat %1 center;border:1px dotted #00f;background-size:16px;",n=".%2 a.cke_anchor,.%2 a.cke_anchor_empty,.cke_editable.%2 a[name],.cke_editable.%2 a[data-cke-saved-name]{"+e+"padding-%1:18px;cursor:auto;}"+(CKEDITOR.plugins.link.synAnchorSelector?"a.cke_anchor_empty{display:inline-block;"+(CKEDITOR.env.ie&&CKEDITOR.env.version>10?"min-height:16px;vertical-align:middle":"")+"}":"")+".%2 img.cke_anchor{"+e+"width:16px;min-height:15px;height:1.15em;vertical-align:"+(CKEDITOR.env.opera?"middle":"text-bottom")+";}";CKEDITOR.addCss(t("ltr")+t("rtl"))},init:function(t){var e="a[!href]";CKEDITOR.dialog.isTabEnabled(t,"link","advanced")&&(e=e.replace("]",",accesskey,charset,dir,id,lang,name,rel,tabindex,title,type]{*}(*)")),CKEDITOR.dialog.isTabEnabled(t,"link","target")&&(e=e.replace("]",",target,onclick]")),t.addCommand("link",new CKEDITOR.dialogCommand("link",{allowedContent:e,requiredContent:"a[href]"})),t.addCommand("anchor",new CKEDITOR.dialogCommand("anchor",{allowedContent:"a[!name,id]",requiredContent:"a[name]"})),t.addCommand("unlink",new CKEDITOR.unlinkCommand),t.addCommand("removeAnchor",new CKEDITOR.removeAnchorCommand),t.setKeystroke(CKEDITOR.CTRL+76,"link"),t.ui.addButton&&(t.ui.addButton("Link",{label:t.lang.link.toolbar,command:"link",toolbar:"links,10"}),t.ui.addButton("Unlink",{label:t.lang.link.unlink,command:"unlink",toolbar:"links,20"}),t.ui.addButton("Anchor",{label:t.lang.link.anchor.toolbar,command:"anchor",toolbar:"links,30"})),CKEDITOR.dialog.add("link",this.path+"dialogs/link.js"),CKEDITOR.dialog.add("anchor",this.path+"dialogs/anchor.js"),t.on("doubleclick",function(e){var n=CKEDITOR.plugins.link.getSelectedLink(t)||e.data.element;n.isReadOnly()||(n.is("a")?(e.data.dialog=!n.getAttribute("name")||n.getAttribute("href")&&n.getChildCount()?"link":"anchor",t.getSelection().selectElement(n)):CKEDITOR.plugins.link.tryRestoreFakeAnchor(t,n)&&(e.data.dialog="anchor"))}),t.addMenuItems&&t.addMenuItems({anchor:{label:t.lang.link.anchor.menu,command:"anchor",group:"anchor",order:1},removeAnchor:{label:t.lang.link.anchor.remove,command:"removeAnchor",group:"anchor",order:5},link:{label:t.lang.link.menu,command:"link",group:"link",order:1},unlink:{label:t.lang.link.unlink,command:"unlink",group:"link",order:5}}),t.contextMenu&&t.contextMenu.addListener(function(e){if(!e||e.isReadOnly())return null;if(e=CKEDITOR.plugins.link.tryRestoreFakeAnchor(t,e),!e&&!(e=CKEDITOR.plugins.link.getSelectedLink(t)))return null;var n={};return e.getAttribute("href")&&e.getChildCount()&&(n={link:CKEDITOR.TRISTATE_OFF,unlink:CKEDITOR.TRISTATE_OFF}),e&&e.hasAttribute("name")&&(n.anchor=n.removeAnchor=CKEDITOR.TRISTATE_OFF),n})},afterInit:function(t){var e=t.dataProcessor,n=e&&e.dataFilter,e=e&&e.htmlFilter,i=t._.elementsPath&&t._.elementsPath.filters;n&&n.addRules({elements:{a:function(e){var n=e.attributes;if(!n.name)return null;var i=!e.children.length;if(CKEDITOR.plugins.link.synAnchorSelector){var e=i?"cke_anchor_empty":"cke_anchor",o=n["class"];n.name&&(!o||o.indexOf(e)<0)&&(n["class"]=(o||"")+" "+e),i&&CKEDITOR.plugins.link.emptyAnchorFix&&(n.contenteditable="false",n["data-cke-editable"]=1)}else if(CKEDITOR.plugins.link.fakeAnchor&&i)return t.createFakeParserElement(e,"cke_anchor","anchor");return null}}}),CKEDITOR.plugins.link.emptyAnchorFix&&e&&e.addRules({elements:{a:function(t){delete t.attributes.contenteditable}}}),i&&i.push(function(e,n){return"a"!=n||!CKEDITOR.plugins.link.tryRestoreFakeAnchor(t,e)&&(!e.getAttribute("name")||e.getAttribute("href")&&e.getChildCount())?void 0:"anchor"})}}),CKEDITOR.plugins.link={getSelectedLink:function(t){var e=t.getSelection(),n=e.getSelectedElement();return n&&n.is("a")?n:(e=e.getRanges()[0])?(e.shrink(CKEDITOR.SHRINK_TEXT),t.elementPath(e.getCommonAncestor()).contains("a",1)):null},fakeAnchor:CKEDITOR.env.opera||CKEDITOR.env.webkit,synAnchorSelector:CKEDITOR.env.ie,emptyAnchorFix:CKEDITOR.env.ie&&8>CKEDITOR.env.version,tryRestoreFakeAnchor:function(t,e){if(e&&e.data("cke-real-element-type")&&"anchor"==e.data("cke-real-element-type")){var n=t.restoreRealElement(e);if(n.data("cke-saved-name"))return n}}},CKEDITOR.unlinkCommand=function(){},CKEDITOR.unlinkCommand.prototype={exec:function(t){var e=new CKEDITOR.style({element:"a",type:CKEDITOR.STYLE_INLINE,alwaysRemoveElement:1});t.removeStyle(e)},refresh:function(t,e){var n=e.lastElement&&e.lastElement.getAscendant("a",!0);n&&"a"==n.getName()&&n.getAttribute("href")&&n.getChildCount()?this.setState(CKEDITOR.TRISTATE_OFF):this.setState(CKEDITOR.TRISTATE_DISABLED)},contextSensitive:1,startDisabled:1,requiredContent:"a[href]"},CKEDITOR.removeAnchorCommand=function(){},CKEDITOR.removeAnchorCommand.prototype={exec:function(t){var e,n=t.getSelection(),i=n.createBookmarks();n&&(e=n.getSelectedElement())&&(CKEDITOR.plugins.link.fakeAnchor&&!e.getChildCount()?CKEDITOR.plugins.link.tryRestoreFakeAnchor(t,e):e.is("a"))?e.remove(1):(e=CKEDITOR.plugins.link.getSelectedLink(t))&&(e.hasAttribute("href")?(e.removeAttributes({name:1,"data-cke-saved-name":1}),e.removeClass("cke_anchor")):e.remove(1)),n.selectBookmarks(i)},requiredContent:"a[name]"},CKEDITOR.tools.extend(CKEDITOR.config,{linkShowAdvancedTab:!0,linkShowTargetTab:!0}),function(){function t(t,e,n){function i(n){!(a=d[n?"getFirst":"getLast"]())||a.is&&a.isBlockBoundary()||!(h=e.root[n?"getPrevious":"getNext"](CKEDITOR.dom.walker.invisible(!0)))||h.is&&h.isBlockBoundary({br:1})||t.document.createElement("br")[n?"insertBefore":"insertAfter"](a)}for(var o=CKEDITOR.plugins.list.listToArray(e.root,n),r=[],s=0;s<e.contents.length;s++){var l=e.contents[s];(l=l.getAscendant("li",!0))&&!l.getCustomData("list_item_processed")&&(r.push(l),CKEDITOR.dom.element.setMarker(n,l,"list_item_processed",!0))}for(l=null,s=0;s<r.length;s++)l=r[s].getCustomData("listarray_index"),o[l].indent=-1;for(s=l+1;s<o.length;s++)if(o[s].indent>o[s-1].indent+1){for(r=o[s-1].indent+1-o[s].indent,l=o[s].indent;o[s]&&o[s].indent>=l;)o[s].indent=o[s].indent+r,s++;s--}var a,h,d=CKEDITOR.plugins.list.arrayToList(o,n,null,t.config.enterMode,e.root.getAttribute("dir")).listNode;i(!0),i(),d.replace(e.root),t.fire("contentDomInvalidated")}function e(t,e){this.name=t,this.context=this.type=e,this.allowedContent=e+" li",this.requiredContent=e}function n(t,e,n,i){for(var o,r;o=t[i?"getLast":"getFirst"](p);)(r=o.getDirection(1))!==e.getDirection(1)&&o.setAttribute("dir",r),o.remove(),n?o[i?"insertBefore":"insertAfter"](n):e.append(o,i)}function i(t){var e;(e=function(e){var i=t[e?"getPrevious":"getNext"](d);i&&i.type==CKEDITOR.NODE_ELEMENT&&i.is(t.getName())&&(n(t,i,null,!e),t.remove(),t=i)})(),e(1)}function o(t){return t.type==CKEDITOR.NODE_ELEMENT&&(t.getName()in CKEDITOR.dtd.$block||t.getName()in CKEDITOR.dtd.$listItem)&&CKEDITOR.dtd[t.getName()]["#"]}function r(t,e,o){t.fire("saveSnapshot"),o.enlarge(CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS);var r=o.extractContents();e.trim(!1,!0);var l=e.createBookmark(),a=new CKEDITOR.dom.elementPath(e.startContainer),h=a.block,a=a.lastElement.getAscendant("li",1)||h,c=new CKEDITOR.dom.elementPath(o.startContainer),p=c.contains(CKEDITOR.dtd.$listItem),c=c.contains(CKEDITOR.dtd.$list);for(h?(h=h.getBogus())&&h.remove():c&&(h=c.getPrevious(d))&&u(h)&&h.remove(),(h=r.getLast())&&h.type==CKEDITOR.NODE_ELEMENT&&h.is("br")&&h.remove(),(h=e.startContainer.getChild(e.startOffset))?r.insertBefore(h):e.startContainer.append(r),p&&(r=s(p))&&(a.contains(p)?(n(r,p.getParent(),p),r.remove()):a.append(r));o.checkStartOfBlock()&&o.checkEndOfBlock()&&(c=o.startPath(),r=c.block,r);)r.is("li")&&(a=r.getParent(),r.equals(a.getLast(d))&&r.equals(a.getFirst(d))&&(r=a)),o.moveToPosition(r,CKEDITOR.POSITION_BEFORE_START),r.remove();o=o.clone(),r=t.editable(),o.setEndAt(r,CKEDITOR.POSITION_BEFORE_END),o=new CKEDITOR.dom.walker(o),o.evaluator=function(t){return d(t)&&!u(t)},(o=o.next())&&o.type==CKEDITOR.NODE_ELEMENT&&o.getName()in CKEDITOR.dtd.$list&&i(o),e.moveToBookmark(l),e.select(),t.fire("saveSnapshot")}function s(t){return(t=t.getLast(d))&&t.type==CKEDITOR.NODE_ELEMENT&&t.getName()in l?t:null}var l={ol:1,ul:1},a=CKEDITOR.dom.walker.whitespaces(),h=CKEDITOR.dom.walker.bookmark(),d=function(t){return!(a(t)||h(t))},u=CKEDITOR.dom.walker.bogus();CKEDITOR.plugins.list={listToArray:function(t,e,n,i,o){if(!l[t.getName()])return[];i||(i=0),n||(n=[]);for(var r=0,s=t.getChildCount();s>r;r++){var a=t.getChild(r);if(a.type==CKEDITOR.NODE_ELEMENT&&a.getName()in CKEDITOR.dtd.$list&&CKEDITOR.plugins.list.listToArray(a,e,n,i+1),"li"==a.$.nodeName.toLowerCase()){var h={parent:t,indent:i,element:a,contents:[]};o?h.grandparent=o:(h.grandparent=t.getParent(),h.grandparent&&"li"==h.grandparent.$.nodeName.toLowerCase()&&(h.grandparent=h.grandparent.getParent())),e&&CKEDITOR.dom.element.setMarker(e,a,"listarray_index",n.length),n.push(h);for(var d,u=0,c=a.getChildCount();c>u;u++)d=a.getChild(u),d.type==CKEDITOR.NODE_ELEMENT&&l[d.getName()]?CKEDITOR.plugins.list.listToArray(d,e,n,i+1,h.grandparent):h.contents.push(d)}}return n},arrayToList:function(t,e,n,i,o){if(n||(n=0),!t||t.length<n+1)return null;for(var r,s,a,u=t[n].parent.getDocument(),c=new CKEDITOR.dom.documentFragment(u),p=null,m=n,g=Math.max(t[n].indent,0),f=null,x=i==CKEDITOR.ENTER_P?"p":"div";;){var C=t[m];if(r=C.grandparent,s=C.element.getDirection(1),C.indent==g){for(p&&t[m].parent.getName()==p.getName()||(p=t[m].parent.clone(!1,1),o&&p.setAttribute("dir",o),c.append(p)),f=p.append(C.element.clone(0,1)),s!=p.getDirection(1)&&f.setAttribute("dir",s),r=0;r<C.contents.length;r++)f.append(C.contents[r].clone(1,1));m++}else if(C.indent==Math.max(g,0)+1)C=t[m-1].element.getDirection(1),m=CKEDITOR.plugins.list.arrayToList(t,null,m,i,C!=s?s:null),!f.getChildCount()&&CKEDITOR.env.needsNbspFiller&&!(u.$.documentMode>7)&&f.append(u.createText("")),f.append(m.listNode),m=m.nextIndex;else{if(-1!=C.indent||n||!r)return null;l[r.getName()]?(f=C.element.clone(!1,!0),s!=r.getDirection(1)&&f.setAttribute("dir",s)):f=new CKEDITOR.dom.documentFragment(u);var E,y,p=r.getDirection(1)!=s,v=C.element,T=v.getAttribute("class"),b=v.getAttribute("style"),I=f.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT&&(i!=CKEDITOR.ENTER_BR||p||b||T),S=C.contents.length;for(r=0;S>r;r++)if(E=C.contents[r],h(E)&&S>1)I?y=E.clone(1,1):f.append(E.clone(1,1));else if(E.type==CKEDITOR.NODE_ELEMENT&&E.isBlockBoundary()){p&&!E.getDirection()&&E.setAttribute("dir",s),a=E;var O=v.getAttribute("style");O&&a.setAttribute("style",O.replace(/([^;])$/,"$1;")+(a.getAttribute("style")||"")),T&&E.addClass(T),a=null,y&&(f.append(y),y=null),f.append(E.clone(1,1))}else I?(a||(a=u.createElement(x),f.append(a),p&&a.setAttribute("dir",s)),b&&a.setAttribute("style",b),T&&a.setAttribute("class",T),y&&(a.append(y),y=null),a.append(E.clone(1,1))):f.append(E.clone(1,1));y&&((a||f).append(y),y=null),f.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT&&m!=t.length-1&&(CKEDITOR.env.needsBrFiller&&(s=f.getLast())&&s.type==CKEDITOR.NODE_ELEMENT&&s.is("br")&&s.remove(),s=f.getLast(d),(!s||!(s.type==CKEDITOR.NODE_ELEMENT&&s.is(CKEDITOR.dtd.$block)))&&f.append(u.createElement("br"))),s=f.$.nodeName.toLowerCase(),("div"==s||"p"==s)&&f.appendBogus(),c.append(f),p=null,m++}if(a=null,t.length<=m||Math.max(t[m].indent,0)<g)break}if(e)for(t=c.getFirst();t;){if(t.type==CKEDITOR.NODE_ELEMENT&&(CKEDITOR.dom.element.clearMarkers(e,t),t.getName()in CKEDITOR.dtd.$listItem&&(n=t,u=o=i=void 0,i=n.getDirection()))){for(o=n.getParent();o&&!(u=o.getDirection());)o=o.getParent();i==u&&n.removeAttribute("dir")}t=t.getNextSourceNode()}return{listNode:c,nextIndex:m}}};var c=/^h[1-6]$/,p=CKEDITOR.dom.walker.nodeType(CKEDITOR.NODE_ELEMENT);e.prototype={exec:function(e){this.refresh(e,e.elementPath());var n=e.config,o=e.getSelection(),r=o&&o.getRanges();if(this.state==CKEDITOR.TRISTATE_OFF){var s=e.editable();if(s.getFirst(d)){var a=1==r.length&&r[0];(n=a&&a.getEnclosedNode())&&n.is&&this.type==n.getName()&&this.setState(CKEDITOR.TRISTATE_ON)}else n.enterMode==CKEDITOR.ENTER_BR?s.appendBogus():r[0].fixBlock(1,n.enterMode==CKEDITOR.ENTER_P?"p":"div"),o.selectRanges(r)}for(var n=o.createBookmarks(!0),s=[],h={},r=r.createIterator(),u=0;(a=r.getNextRange())&&++u;){var p=a.getBoundaryNodes(),m=p.startNode,g=p.endNode;for(m.type==CKEDITOR.NODE_ELEMENT&&"td"==m.getName()&&a.setStartAt(p.startNode,CKEDITOR.POSITION_AFTER_START),g.type==CKEDITOR.NODE_ELEMENT&&"td"==g.getName()&&a.setEndAt(p.endNode,CKEDITOR.POSITION_BEFORE_END),a=a.createIterator(),a.forceBrBreak=this.state==CKEDITOR.TRISTATE_OFF;p=a.getNextParagraph();)if(!p.getCustomData("list_block")){CKEDITOR.dom.element.setMarker(h,p,"list_block",1);for(var f,x=e.elementPath(p),m=x.elements,g=0,x=x.blockLimit,C=m.length-1;C>=0&&(f=m[C]);C--)if(l[f.getName()]&&x.contains(f)){x.removeCustomData("list_group_object_"+u),(m=f.getCustomData("list_group_object"))?m.contents.push(p):(m={root:f,contents:[p]},s.push(m),CKEDITOR.dom.element.setMarker(h,f,"list_group_object",m)),g=1;break}g||(g=x,g.getCustomData("list_group_object_"+u)?g.getCustomData("list_group_object_"+u).contents.push(p):(m={root:g,contents:[p]},CKEDITOR.dom.element.setMarker(h,g,"list_group_object_"+u,m),s.push(m)))}}for(f=[];s.length>0;)if(m=s.shift(),this.state==CKEDITOR.TRISTATE_OFF)if(l[m.root.getName()]){for(r=e,u=m,m=h,a=f,g=CKEDITOR.plugins.list.listToArray(u.root,m),x=[],p=0;p<u.contents.length;p++)C=u.contents[p],(C=C.getAscendant("li",!0))&&!C.getCustomData("list_item_processed")&&(x.push(C),CKEDITOR.dom.element.setMarker(m,C,"list_item_processed",!0));for(var C=u.root.getDocument(),E=void 0,y=void 0,p=0;p<x.length;p++){var v=x[p].getCustomData("listarray_index"),E=g[v].parent;E.is(this.type)||(y=C.createElement(this.type),E.copyAttributes(y,{start:1,type:1}),y.removeStyle("list-style-type"),g[v].parent=y)}for(m=CKEDITOR.plugins.list.arrayToList(g,m,null,r.config.enterMode),g=void 0,x=m.listNode.getChildCount(),p=0;x>p&&(g=m.listNode.getChild(p));p++)g.getName()==this.type&&a.push(g);m.listNode.replace(u.root),r.fire("contentDomInvalidated")}else{for(g=e,p=m,a=f,x=p.contents,r=p.root.getDocument(),u=[],1==x.length&&x[0].equals(p.root)&&(m=r.createElement("div"),x[0].moveChildren&&x[0].moveChildren(m),x[0].append(m),x[0]=m),p=p.contents[0].getParent(),C=0;C<x.length;C++)p=p.getCommonAncestor(x[C].getParent());for(E=g.config.useComputedState,g=m=void 0,E=void 0===E||E,C=0;C<x.length;C++)for(y=x[C];v=y.getParent();){if(v.equals(p)){u.push(y),!g&&y.getDirection()&&(g=1),y=y.getDirection(E),null!==m&&(m=m&&m!=y?null:y);break}y=v}if(!(u.length<1)){for(x=u[u.length-1].getNext(),C=r.createElement(this.type),a.push(C),E=a=void 0;u.length;)a=u.shift(),E=r.createElement("li"),a.is("pre")||c.test(a.getName())||"false"==a.getAttribute("contenteditable")?a.appendTo(E):(a.copyAttributes(E),m&&a.getDirection()&&(E.removeStyle("direction"),E.removeAttribute("dir")),a.moveChildren(E),a.remove()),E.appendTo(C);m&&g&&C.setAttribute("dir",m),x?C.insertBefore(x):C.appendTo(p)}}else this.state==CKEDITOR.TRISTATE_ON&&l[m.root.getName()]&&t.call(this,e,m,h);for(C=0;C<f.length;C++)i(f[C]);CKEDITOR.dom.element.clearAllMarkers(h),o.selectBookmarks(n),e.focus()},refresh:function(t,e){var n=e.contains(l,1),i=e.blockLimit||e.root;n&&i.contains(n)?this.setState(n.is(this.type)?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF):this.setState(CKEDITOR.TRISTATE_OFF)}},CKEDITOR.plugins.add("list",{requires:"indentlist",init:function(t){t.blockless||(t.addCommand("numberedlist",new e("numberedlist","ol")),t.addCommand("bulletedlist",new e("bulletedlist","ul")),t.ui.addButton&&(t.ui.addButton("NumberedList",{label:t.lang.list.numberedlist,command:"numberedlist",directional:!0,toolbar:"list,10"}),t.ui.addButton("BulletedList",{label:t.lang.list.bulletedlist,command:"bulletedlist",directional:!0,toolbar:"list,20"})),t.on("key",function(e){var n=e.data.keyCode;if("wysiwyg"==t.mode&&n in{8:1,46:1}){var i=t.getSelection().getRanges()[0],a=i&&i.startPath();if(i&&i.collapsed){var a=new CKEDITOR.dom.elementPath(i.startContainer),h=8==n,c=t.editable(),p=new CKEDITOR.dom.walker(i.clone());if(p.evaluator=function(t){return d(t)&&!u(t)},p.guard=function(t,e){return!(e&&t.type==CKEDITOR.NODE_ELEMENT&&t.is("table"))},n=i.clone(),h){var m,g;(m=a.contains(l))&&i.checkBoundaryOfElement(m,CKEDITOR.START)&&(m=m.getParent())&&m.is("li")&&(m=s(m))?(g=m,m=m.getPrevious(d),n.moveToPosition(m&&u(m)?m:g,CKEDITOR.POSITION_BEFORE_START)):(p.range.setStartAt(c,CKEDITOR.POSITION_AFTER_START),p.range.setEnd(i.startContainer,i.startOffset),(m=p.previous())&&m.type==CKEDITOR.NODE_ELEMENT&&(m.getName()in l||m.is("li"))&&(m.is("li")||(p.range.selectNodeContents(m),p.reset(),p.evaluator=o,m=p.previous()),g=m,n.moveToElementEditEnd(g))),g?(r(t,n,i),e.cancel()):(n=a.contains(l))&&i.checkBoundaryOfElement(n,CKEDITOR.START)&&(g=n.getFirst(d),i.checkBoundaryOfElement(g,CKEDITOR.START)&&(m=n.getPrevious(d),s(g)?m&&(i.moveToElementEditEnd(m),i.select()):t.execCommand("outdent"),e.cancel()))}else(g=a.contains("li"))?(p.range.setEndAt(c,CKEDITOR.POSITION_BEFORE_END),c=(a=g.getLast(d))&&o(a)?a:g,g=0,(m=p.next())&&m.type==CKEDITOR.NODE_ELEMENT&&m.getName()in l&&m.equals(a)?(g=1,m=p.next()):i.checkBoundaryOfElement(c,CKEDITOR.END)&&(g=1),g&&m&&(i=i.clone(),i.moveToElementEditStart(m),r(t,n,i),e.cancel())):(p.range.setEndAt(c,CKEDITOR.POSITION_BEFORE_END),(m=p.next())&&m.type==CKEDITOR.NODE_ELEMENT&&m.is(l)&&(m=m.getFirst(d),a.block&&i.checkStartOfBlock()&&i.checkEndOfBlock()?(a.block.remove(),i.moveToElementEditStart(m),i.select()):s(m)?(i.moveToElementEditStart(m),i.select()):(i=i.clone(),i.moveToElementEditStart(m),r(t,n,i)),e.cancel()));setTimeout(function(){t.selectionChange(1)})}}}))}})}(),function(){CKEDITOR.plugins.liststyle={requires:"dialog,contextmenu",init:function(t){if(!t.blockless){var e;e=new CKEDITOR.dialogCommand("numberedListStyle",{requiredContent:"ol",allowedContent:"ol{list-style-type}[start]"}),e=t.addCommand("numberedListStyle",e),t.addFeature(e),CKEDITOR.dialog.add("numberedListStyle",this.path+"dialogs/liststyle.js"),e=new CKEDITOR.dialogCommand("bulletedListStyle",{requiredContent:"ul",allowedContent:"ul{list-style-type}"}),e=t.addCommand("bulletedListStyle",e),t.addFeature(e),CKEDITOR.dialog.add("bulletedListStyle",this.path+"dialogs/liststyle.js"),t.addMenuGroup("list",108),t.addMenuItems({numberedlist:{label:t.lang.liststyle.numberedTitle,group:"list",command:"numberedListStyle"},bulletedlist:{label:t.lang.liststyle.bulletedTitle,group:"list",command:"bulletedListStyle"}}),t.contextMenu.addListener(function(t){if(!t||t.isReadOnly())return null;for(;t;){var e=t.getName();if("ol"==e)return{numberedlist:CKEDITOR.TRISTATE_OFF};if("ul"==e)return{bulletedlist:CKEDITOR.TRISTATE_OFF};t=t.getParent()}return null})}}},CKEDITOR.plugins.add("liststyle",CKEDITOR.plugins.liststyle)}(),function(){function t(t,e,n){return d(e)&&d(n)&&n.equals(e.getNext(function(t){return!(j(t)||X(t)||u(t))}))}function e(t){this.upper=t[0],this.lower=t[1],this.set.apply(this,t.slice(2))}function n(t){var e=t.element;if(e&&d(e)&&(e=e.getAscendant(t.triggers,!0))&&t.editable.contains(e)){var n=r(e,!0);if("true"==n.getAttribute("contenteditable"))return e;if(n.is(t.triggers))return n}return null}function i(t,e,n){return E(t,e),E(t,n),t=e.size.bottom,n=n.size.top,t&&n?0|(t+n)/2:t||n}function o(t,e,n){return e=e[n?"getPrevious":"getNext"](function(e){return e&&e.type==CKEDITOR.NODE_TEXT&&!j(e)||d(e)&&!u(e)&&!h(t,e)})}function r(t,e){if(t.data("cke-editable"))return null;for(e||(t=t.getParent());t&&!t.data("cke-editable");){if(t.hasAttribute("contenteditable"))return t;t=t.getParent()}return null}function s(t){var e=t.doc,n=S('<span contenteditable="false" style="'+z+"position:absolute;border-top:1px dashed "+t.boxColor+'"></span>',e),i=this.path+"images/"+(O.hidpi?"hidpi/":"")+"icon.png";for(b(n,{attach:function(){return this.wrap.getParent()||this.wrap.appendTo(t.editable,!0),this},lineChildren:[b(S('<span title="'+t.editor.lang.magicline.title+'" contenteditable="false">&#8629;</span>',e),{base:z+"height:17px;width:17px;"+(t.rtl?"left":"right")+":17px;background:url("+i+") center no-repeat "+t.boxColor+";cursor:pointer;"+(O.hc?"font-size: 15px;line-height:14px;border:1px solid #fff;text-align:center;":"")+(O.hidpi?"background-size: 9px 10px;":""),looks:["top:-8px;"+CKEDITOR.tools.cssVendorPrefix("border-radius","2px",1),"top:-17px;"+CKEDITOR.tools.cssVendorPrefix("border-radius","2px 2px 0px 0px",1),"top:-1px;"+CKEDITOR.tools.cssVendorPrefix("border-radius","0px 0px 2px 2px",1)]}),b(S($,e),{base:Y+"left:0px;border-left-color:"+t.boxColor+";",looks:["border-width:8px 0 8px 8px;top:-8px","border-width:8px 0 0 8px;top:-8px","border-width:0 0 8px 8px;top:0px"]}),b(S($,e),{base:Y+"right:0px;border-right-color:"+t.boxColor+";",looks:["border-width:8px 8px 8px 0;top:-8px","border-width:8px 8px 0 0;top:-8px","border-width:0 8px 8px 0;top:0px"]})],detach:function(){return this.wrap.getParent()&&this.wrap.remove(),this
},mouseNear:function(){E(t,this);var e=t.holdDistance,n=this.size;return n&&t.mouse.y>n.top-e&&t.mouse.y<n.bottom+e&&t.mouse.x>n.left-e&&t.mouse.x<n.right+e?!0:!1},place:function(){var e=t.view,n=t.editable,i=t.trigger,o=i.upper,r=i.lower,s=o||r,l=s.getParent(),a={};this.trigger=i,o&&E(t,o,!0),r&&E(t,r,!0),E(t,l,!0),t.inInlineMode&&y(t,!0),l.equals(n)?(a.left=e.scroll.x,a.right=-e.scroll.x,a.width=""):(a.left=s.size.left-s.size.margin.left+e.scroll.x-(t.inInlineMode?e.editable.left+e.editable.border.left:0),a.width=s.size.outerWidth+s.size.margin.left+s.size.margin.right+e.scroll.x,a.right=""),o&&r?a.top=o.size.margin.bottom===r.size.margin.top?0|o.size.bottom+o.size.margin.bottom/2:o.size.margin.bottom<r.size.margin.top?o.size.bottom+o.size.margin.bottom:o.size.bottom+o.size.margin.bottom-r.size.margin.top:o?r||(a.top=o.size.bottom+o.size.margin.bottom):a.top=r.size.top-r.size.margin.top,i.is(P)||a.top>e.scroll.y-15&&a.top<e.scroll.y+5?(a.top=t.inInlineMode?0:e.scroll.y,this.look(P)):i.is(M)||a.top>e.pane.bottom-5&&a.top<e.pane.bottom+15?(a.top=t.inInlineMode?e.editable.height+e.editable.padding.top+e.editable.padding.bottom:e.pane.bottom-1,this.look(M)):(t.inInlineMode&&(a.top=a.top-(e.editable.top+e.editable.border.top)),this.look(K)),t.inInlineMode&&(a.top--,a.top=a.top+e.editable.scroll.top,a.left=a.left+e.editable.scroll.left);for(var h in a)a[h]=CKEDITOR.tools.cssLength(a[h]);this.setStyles(a)},look:function(t){if(this.oldLook!=t){for(var e,n=this.lineChildren.length;n--;)(e=this.lineChildren[n]).setAttribute("style",e.base+e.looks[0|t/2]);this.oldLook=t}},wrap:new I("span",t.doc)}),e=n.lineChildren.length;e--;)n.lineChildren[e].appendTo(n);n.look(K),n.appendTo(n.wrap),n.unselectable(),n.lineChildren[0].on("mouseup",function(e){n.detach(),l(t,function(e){var n=t.line.trigger;e[n.is(_)?"insertBefore":"insertAfter"](n.is(_)?n.lower:n.upper)},!0),t.editor.focus(),!O.ie&&t.enterMode!=CKEDITOR.ENTER_BR&&t.hotNode.scrollIntoView(),e.data.preventDefault(!0)}),n.on("mousedown",function(t){t.data.preventDefault(!0)}),t.line=n}function l(t,e,n){var i,o=new CKEDITOR.dom.range(t.doc),s=t.editor;O.ie&&t.enterMode==CKEDITOR.ENTER_BR?i=t.doc.createText(H):(i=(i=r(t.element,!0))&&i.data("cke-enter-mode")||t.enterMode,i=new I(D[i],t.doc),i.is("br")||t.doc.createText(H).appendTo(i)),n&&s.fire("saveSnapshot"),e(i),o.moveToPosition(i,CKEDITOR.POSITION_AFTER_START),s.getSelection().selectRanges([o]),t.hotNode=i,n&&s.fire("saveSnapshot")}function a(t,e){return{canUndo:!0,modes:{wysiwyg:1},exec:function(){function i(n){var i=O.ie&&O.version<9?" ":H,o=t.hotNode&&t.hotNode.getText()==i&&t.element.equals(t.hotNode)&&t.lastCmdDirection===!!e;l(t,function(i){o&&t.hotNode&&t.hotNode.remove(),i[e?"insertAfter":"insertBefore"](n),i.setAttributes({"data-cke-magicline-hot":1,"data-cke-magicline-dir":!!e}),t.lastCmdDirection=!!e}),!O.ie&&t.enterMode!=CKEDITOR.ENTER_BR&&t.hotNode.scrollIntoView(),t.line.detach()}return function(s){var l,s=s.getSelection().getStartElement(),s=s.getAscendant(U,1);if(!m(t,s)&&s&&!s.equals(t.editable)&&!s.contains(t.editable)){(l=r(s))&&"false"==l.getAttribute("contenteditable")&&(s=l),t.element=s,l=o(t,s,!e);var a;d(l)&&l.is(t.triggers)&&l.is(B)&&(!o(t,l,!e)||(a=o(t,l,!e))&&d(a)&&a.is(t.triggers))?i(l):(a=n(t,s),d(a)&&(o(t,a,!e)?(s=o(t,a,!e))&&d(s)&&s.is(t.triggers)&&i(a):i(a)))}}}()}}function h(t,e){if(!e||e.type!=CKEDITOR.NODE_ELEMENT||!e.$)return!1;var n=t.line;return n.wrap.equals(e)||n.wrap.contains(e)}function d(t){return t&&t.type==CKEDITOR.NODE_ELEMENT&&t.$}function u(t){if(!d(t))return!1;var e;return(e=c(t))||(d(t)?(e={left:1,right:1,center:1},e=!(!e[t.getComputedStyle("float")]&&!e[t.getAttribute("align")])):e=!1),e}function c(t){return!!{absolute:1,fixed:1}[t.getComputedStyle("position")]}function p(t,e){return d(e)?e.is(t.triggers):null}function m(t,e){if(!e)return!1;for(var n=e.getParents(1),i=n.length;i--;)for(var o=t.tabuList.length;o--;)if(n[i].hasAttribute(t.tabuList[o]))return!0;return!1}function g(t,e,n){return(e=e[n?"getLast":"getFirst"](function(e){return t.isRelevant(e)&&!e.is(F)}))?(E(t,e),n?e.size.top>t.mouse.y:e.size.bottom<t.mouse.y):!1}function f(t){var n=t.editable,i=t.mouse,o=t.view,r=t.triggerOffset;y(t);var s=i.y>(t.inInlineMode?o.editable.top+o.editable.height/2:Math.min(o.editable.height,o.pane.height)/2),n=n[s?"getLast":"getFirst"](function(t){return!(j(t)||X(t))});return n?(h(t,n)&&(n=t.line.wrap[s?"getPrevious":"getNext"](function(t){return!(j(t)||X(t))})),d(n)&&!u(n)&&p(t,n)?(E(t,n),!s&&n.size.top>=0&&i.y>0&&i.y<n.size.top+r?(t=t.inInlineMode||0===o.scroll.y?P:K,new e([null,n,_,k,t])):s&&n.size.bottom<=o.pane.height&&i.y>n.size.bottom-r&&i.y<o.pane.height?(t=t.inInlineMode||n.size.bottom>o.pane.height-r&&n.size.bottom<o.pane.height?M:K,new e([n,null,A,k,t])):null):null):null}function x(t){var i=t.mouse,r=t.view,s=t.triggerOffset,l=n(t);if(!l)return null;E(t,l);var a,h,s=Math.min(s,0|l.size.outerHeight/2),c=[];if(i.y>l.size.top-1&&i.y<l.size.top+s)h=!1;else{if(!(i.y>l.size.bottom-s&&i.y<l.size.bottom+1))return null;h=!0}if(u(l)||g(t,l,h)||l.getParent().is(G))return null;var m=o(t,l,!h);if(m){if(m&&m.type==CKEDITOR.NODE_TEXT)return null;if(d(m)){if(u(m)||!p(t,m)||m.getParent().is(G))return null;c=[m,l][h?"reverse":"concat"]().concat([L,k])}}else l.equals(t.editable[h?"getLast":"getFirst"](t.isRelevant))?(y(t),h&&i.y>l.size.bottom-s&&i.y<r.pane.height&&l.size.bottom>r.pane.height-s&&l.size.bottom<r.pane.height?a=M:i.y>0&&i.y<l.size.top+s&&(a=P)):a=K,c=[null,l][h?"reverse":"concat"]().concat([h?A:_,k,a,l.equals(t.editable[h?"getLast":"getFirst"](t.isRelevant))?h?M:P:K]);return 0 in c?new e(c):null}function C(t,e,n,i){for(var o=function(){var n=O.ie?e.$.currentStyle:t.win.$.getComputedStyle(e.$,"");return O.ie?function(t){return n[CKEDITOR.tools.cssStyleToDomStyle(t)]}:function(t){return n.getPropertyValue(t)}}(),r=e.getDocumentPosition(),s={},l={},a={},h={},d=Z.length;d--;)s[Z[d]]=parseInt(o("border-"+Z[d]+"-width"),10)||0,a[Z[d]]=parseInt(o("padding-"+Z[d]),10)||0,l[Z[d]]=parseInt(o("margin-"+Z[d]),10)||0;return(!n||i)&&v(t,i),h.top=r.y-(n?0:t.view.scroll.y),h.left=r.x-(n?0:t.view.scroll.x),h.outerWidth=e.$.offsetWidth,h.outerHeight=e.$.offsetHeight,h.height=h.outerHeight-(a.top+a.bottom+s.top+s.bottom),h.width=h.outerWidth-(a.left+a.right+s.left+s.right),h.bottom=h.top+h.outerHeight,h.right=h.left+h.outerWidth,t.inInlineMode&&(h.scroll={top:e.$.scrollTop,left:e.$.scrollLeft}),b({border:s,padding:a,margin:l,ignoreScroll:n},h,!0)}function E(t,e,n){if(!d(e))return e.size=null;if(e.size){if(e.size.ignoreScroll==n&&e.size.date>new Date-V)return null}else e.size={};return b(e.size,C(t,e,n),{date:+new Date},!0)}function y(t,e){t.view.editable=C(t,t.editable,e,!0)}function v(t,e){t.view||(t.view={});var n=t.view;if(e||!(n&&n.date>new Date-V)){var i=t.win,n=i.getScrollPosition(),i=i.getViewPaneSize();b(t.view,{scroll:{x:n.x,y:n.y,width:t.doc.$.documentElement.scrollWidth-i.width,height:t.doc.$.documentElement.scrollHeight-i.height},pane:{width:i.width,height:i.height,bottom:i.height+n.y},date:+new Date},!0)}}function T(t,n,i,o){for(var r=o,s=o,l=0,a=!1,h=!1,d=t.view.pane.height,u=t.mouse;u.y+l<d&&u.y-l>0&&(a||(a=n(r,o)),h||(h=n(s,o)),!a&&u.y-l>0&&(r=i(t,{x:u.x,y:u.y-l})),!h&&u.y+l<d&&(s=i(t,{x:u.x,y:u.y+l})),!a||!h);)l+=2;return new e([r,s,null,null])}CKEDITOR.plugins.add("magicline",{init:function(t){var i,r,p,g=t.config,E=g.magicline_triggerOffset||30,T={editor:t,enterMode:g.enterMode,triggerOffset:E,holdDistance:0|E*(g.magicline_holdDistance||.5),boxColor:g.magicline_color||"#ff0000",rtl:"rtl"==g.contentsLangDirection,tabuList:["data-cke-hidden-sel"].concat(g.magicline_tabuList||[]),triggers:g.magicline_everywhere?U:{table:1,hr:1,div:1,ul:1,ol:1,dl:1,form:1,blockquote:1}};T.isRelevant=function(t){return d(t)&&!h(T,t)&&!u(t)},t.on("contentDom",function(){var d=t.editable(),u=t.document,E=t.window;b(T,{editable:d,inInlineMode:d.isInline(),doc:u,win:E,hotNode:null},!0),T.boundary=T.inInlineMode?T.editable:T.doc.getDocumentElement(),d.is(w.$inline)||(T.inInlineMode&&!c(d)&&d.setStyles({position:"relative",top:null,left:null}),s.call(this,T),v(T),d.attachListener(t,"beforeUndoImage",function(){T.line.detach()}),d.attachListener(t,"beforeGetData",function(){T.line.wrap.getParent()&&(T.line.detach(),t.once("getData",function(){T.line.attach()},null,null,1e3))},null,null,0),d.attachListener(T.inInlineMode?u:u.getWindow().getFrame(),"mouseout",function(e){if("wysiwyg"==t.mode)if(T.inInlineMode){var n=e.data.$.clientX,e=e.data.$.clientY;v(T),y(T,!0);var i=T.view.editable,o=T.view.scroll;n>i.left-o.x&&n<i.right-o.x&&e>i.top-o.y&&e<i.bottom-o.y||(clearTimeout(p),p=null,T.line.detach())}else clearTimeout(p),p=null,T.line.detach()}),d.attachListener(d,"keyup",function(){T.hiddenMode=0}),d.attachListener(d,"keydown",function(e){if("wysiwyg"==t.mode)switch(e=e.data.getKeystroke(),t.getSelection().getStartElement(),e){case 2228240:case 16:T.hiddenMode=1,T.line.detach()}}),d.attachListener(T.inInlineMode?d:u,"mousemove",function(e){if(r=!0,"wysiwyg"==t.mode&&!t.readOnly&&!p){var n={x:e.data.$.clientX,y:e.data.$.clientY};p=setTimeout(function(){T.mouse=n,p=T.trigger=null,v(T),r&&!T.hiddenMode&&t.focusManager.hasFocus&&!T.line.mouseNear()&&(T.element=W(T,!0))&&((T.trigger=f(T)||x(T)||q(T))&&!m(T,T.trigger.upper||T.trigger.lower)?T.line.attach().place():(T.trigger=null,T.line.detach()),r=!1)},30)}}),d.attachListener(E,"scroll",function(){"wysiwyg"==t.mode&&(T.line.detach(),O.webkit&&(T.hiddenMode=1,clearTimeout(i),i=setTimeout(function(){T.mouseDown||(T.hiddenMode=0)},50)))}),d.attachListener(R?u:E,"mousedown",function(){"wysiwyg"==t.mode&&(T.line.detach(),T.hiddenMode=1,T.mouseDown=1)}),d.attachListener(R?u:E,"mouseup",function(){T.hiddenMode=0,T.mouseDown=0}),t.addCommand("accessPreviousSpace",a(T)),t.addCommand("accessNextSpace",a(T,!0)),t.setKeystroke([[g.magicline_keystrokePrevious,"accessPreviousSpace"],[g.magicline_keystrokeNext,"accessNextSpace"]]),t.on("loadSnapshot",function(){var e,n,i,o;for(o in{p:1,br:1,div:1})for(e=t.document.getElementsByTag(o),i=e.count();i--;)if((n=e.getItem(i)).data("cke-magicline-hot"))return T.hotNode=n,T.lastCmdDirection="true"===n.data("cke-magicline-dir")?!0:!1,void 0}),this.backdoor={accessFocusSpace:l,boxTrigger:e,isLine:h,getAscendantTrigger:n,getNonEmptyNeighbour:o,getSize:C,that:T,triggerEdge:x,triggerEditable:f,triggerExpand:q})},this)}});var b=CKEDITOR.tools.extend,I=CKEDITOR.dom.element,S=I.createFromHtml,O=CKEDITOR.env,R=CKEDITOR.env.ie&&CKEDITOR.env.version<9,w=CKEDITOR.dtd,D={},_=128,A=64,L=32,k=16,N=8,P=4,M=2,K=1,H="",G=w.$listItem,F=w.$tableContent,B=b({},w.$nonEditable,w.$empty),U=w.$block,V=100,z="width:0px;height:0px;padding:0px;margin:0px;display:block;z-index:9999;color:#fff;position:absolute;font-size: 0px;line-height:0px;",Y=z+"border-color:transparent;display:block;border-style:solid;",$="<span>"+H+"</span>";D[CKEDITOR.ENTER_BR]="br",D[CKEDITOR.ENTER_P]="p",D[CKEDITOR.ENTER_DIV]="div",e.prototype={set:function(t,e,n){return this.properties=t+e+(n||K),this},is:function(t){return(this.properties&t)==t}};var W=function(){return function(t,e,n){if(!t.mouse)return null;var i=t.doc,o=t.line.wrap,n=n||t.mouse,r=new CKEDITOR.dom.element(i.$.elementFromPoint(n.x,n.y));return e&&h(t,r)&&(o.hide(),r=new CKEDITOR.dom.element(i.$.elementFromPoint(n.x,n.y)),o.show()),!r||r.type!=CKEDITOR.NODE_ELEMENT||!r.$||O.ie&&O.version<9&&!t.boundary.equals(r)&&!t.boundary.contains(r)?null:r}}(),j=CKEDITOR.dom.walker.whitespaces(),X=CKEDITOR.dom.walker.nodeType(CKEDITOR.NODE_COMMENT),q=function(){function e(e){var o,r,s,l=e.element;if(!d(l)||l.contains(e.editable)||l.isReadOnly())return null;if(s=T(e,function(t,e){return!e.equals(t)},function(t,e){return W(t,!0,e)},l),o=s.upper,r=s.lower,t(e,o,r))return s.set(L,N);if(o&&l.contains(o))for(;!o.getParent().equals(l);)o=o.getParent();else o=l.getFirst(function(t){return n(e,t)});if(r&&l.contains(r))for(;!r.getParent().equals(l);)r=r.getParent();else r=l.getLast(function(t){return n(e,t)});if(!o||!r)return null;if(E(e,o),E(e,r),!(e.mouse.y>o.size.top&&e.mouse.y<r.size.bottom))return null;for(var a,h,u,c,l=Number.MAX_VALUE;r&&!r.equals(o)&&(h=o.getNext(e.isRelevant));)a=Math.abs(i(e,o,h)-e.mouse.y),l>a&&(l=a,u=o,c=h),o=h,E(e,o);return u&&c&&e.mouse.y>u.size.top&&e.mouse.y<c.size.bottom?(s.upper=u,s.lower=c,s.set(L,N)):null}function n(t,e){return!(e&&e.type==CKEDITOR.NODE_TEXT||X(e)||u(e)||h(t,e)||e.type==CKEDITOR.NODE_ELEMENT&&e.$&&e.is("br"))}return function(n){var i,o=e(n);if(i=o){i=o.upper;var r=o.lower;i=!i||!r||u(r)||u(i)||r.equals(i)||i.equals(r)||r.contains(i)||i.contains(r)?!1:p(n,i)&&p(n,r)&&t(n,i,r)?!0:!1}return i?o:null}}(),Z=["top","left","right","bottom"]}(),CKEDITOR.config.magicline_keystrokePrevious=CKEDITOR.CTRL+CKEDITOR.SHIFT+51,CKEDITOR.config.magicline_keystrokeNext=CKEDITOR.CTRL+CKEDITOR.SHIFT+52,function(){function t(t){if(!t||t.type!=CKEDITOR.NODE_ELEMENT||"form"!=t.getName())return[];for(var e=[],n=["style","className"],i=0;i<n.length;i++){var o=t.$.elements.namedItem(n[i]);o&&(o=new CKEDITOR.dom.element(o),e.push([o,o.nextSibling]),o.remove())}return e}function e(t,e){if(t&&t.type==CKEDITOR.NODE_ELEMENT&&"form"==t.getName()&&e.length>0)for(var n=e.length-1;n>=0;n--){var i=e[n][0],o=e[n][1];o?i.insertBefore(o):i.appendTo(t)}}function n(n,i){var o=t(n),r={},s=n.$;return i||(r["class"]=s.className||"",s.className=""),r.inline=s.style.cssText||"",i||(s.style.cssText="position: static; overflow: visible"),e(o),r}function i(n,i){var o=t(n),r=n.$;"class"in i&&(r.className=i["class"]),"inline"in i&&(r.style.cssText=i.inline),e(o)}function o(t){if(!t.editable().isInline()){var e,n=CKEDITOR.instances;for(e in n){var i=n[e];"wysiwyg"!=i.mode||i.readOnly||(i=i.document.getBody(),i.setAttribute("contentEditable",!1),i.setAttribute("contentEditable",!0))}t.editable().hasFocus&&(t.toolbox.focus(),t.focus())}}CKEDITOR.plugins.add("maximize",{init:function(t){function e(){var e=d.getViewPaneSize();t.resize(e.width,e.height,null,!0)}if(t.elementMode!=CKEDITOR.ELEMENT_MODE_INLINE){var r,s,l,a=t.lang,h=CKEDITOR.document,d=h.getWindow(),u=CKEDITOR.TRISTATE_OFF;t.addCommand("maximize",{modes:{wysiwyg:!CKEDITOR.env.iOS,source:!CKEDITOR.env.iOS},readOnly:1,editorFocus:!1,exec:function(){var c=t.container.getChild(1),p=t.ui.space("contents");if("wysiwyg"==t.mode){var m=t.getSelection();r=m&&m.getRanges(),s=d.getScrollPosition()}else{var g=t.editable().$;r=!CKEDITOR.env.ie&&[g.selectionStart,g.selectionEnd],s=[g.scrollLeft,g.scrollTop]}if(this.state==CKEDITOR.TRISTATE_OFF){for(d.on("resize",e),l=d.getScrollPosition(),m=t.container;m=m.getParent();)m.setCustomData("maximize_saved_styles",n(m)),m.setStyle("z-index",t.config.baseFloatZIndex-5);p.setCustomData("maximize_saved_styles",n(p,!0)),c.setCustomData("maximize_saved_styles",n(c,!0)),p={overflow:CKEDITOR.env.webkit?"":"hidden",width:0,height:0},h.getDocumentElement().setStyles(p),!CKEDITOR.env.gecko&&h.getDocumentElement().setStyle("position","fixed"),(!CKEDITOR.env.gecko||!CKEDITOR.env.quirks)&&h.getBody().setStyles(p),CKEDITOR.env.ie?setTimeout(function(){d.$.scrollTo(0,0)},0):d.$.scrollTo(0,0),c.setStyle("position",CKEDITOR.env.gecko&&CKEDITOR.env.quirks?"fixed":"absolute"),c.$.offsetLeft,c.setStyles({"z-index":t.config.baseFloatZIndex-5,left:"0px",top:"0px"}),c.addClass("cke_maximized"),e(),p=c.getDocumentPosition(),c.setStyles({left:-1*p.x+"px",top:-1*p.y+"px"}),CKEDITOR.env.gecko&&o(t)}else if(this.state==CKEDITOR.TRISTATE_ON){for(d.removeListener("resize",e),p=[p,c],m=0;m<p.length;m++)i(p[m],p[m].getCustomData("maximize_saved_styles")),p[m].removeCustomData("maximize_saved_styles");for(m=t.container;m=m.getParent();)i(m,m.getCustomData("maximize_saved_styles")),m.removeCustomData("maximize_saved_styles");CKEDITOR.env.ie?setTimeout(function(){d.$.scrollTo(l.x,l.y)},0):d.$.scrollTo(l.x,l.y),c.removeClass("cke_maximized"),CKEDITOR.env.webkit&&(c.setStyle("display","inline"),setTimeout(function(){c.setStyle("display","block")},0)),t.fire("resize")}this.toggleState(),(m=this.uiItems[0])&&(p=this.state==CKEDITOR.TRISTATE_OFF?a.maximize.maximize:a.maximize.minimize,m=CKEDITOR.document.getById(m._.id),m.getChild(1).setHtml(p),m.setAttribute("title",p),m.setAttribute("href",'javascript:void("'+p+'");')),"wysiwyg"==t.mode?r?(CKEDITOR.env.gecko&&o(t),t.getSelection().selectRanges(r),(g=t.getSelection().getStartElement())&&g.scrollIntoView(!0)):d.$.scrollTo(s.x,s.y):(r&&(g.selectionStart=r[0],g.selectionEnd=r[1]),g.scrollLeft=s[0],g.scrollTop=s[1]),r=s=null,u=this.state,t.fire("maximize",this.state)},canUndo:!1}),t.ui.addButton&&t.ui.addButton("Maximize",{label:a.maximize.maximize,command:"maximize",toolbar:"tools,10"}),t.on("mode",function(){var e=t.getCommand("maximize");e.setState(e.state==CKEDITOR.TRISTATE_DISABLED?CKEDITOR.TRISTATE_DISABLED:u)},null,null,100)}}})}(),CKEDITOR.plugins.add("newpage",{init:function(t){t.addCommand("newpage",{modes:{wysiwyg:1,source:1},exec:function(t){var e=this;t.setData(t.config.newpage_html||"",function(){t.focus(),setTimeout(function(){t.fire("afterCommandExec",{name:"newpage",command:e}),t.selectionChange()},200)})},async:!0}),t.ui.addButton&&t.ui.addButton("NewPage",{label:t.lang.newpage.toolbar,command:"newpage",toolbar:"document,20"})}}),function(){function t(t){return{"aria-label":t,"class":"cke_pagebreak",contenteditable:"false","data-cke-display-name":"pagebreak","data-cke-pagebreak":1,style:"page-break-after: always",title:t}}CKEDITOR.plugins.add("pagebreak",{requires:"fakeobjects",onLoad:function(){var t=("background:url("+CKEDITOR.getUrl(this.path+"images/pagebreak.gif")+") no-repeat center center;clear:both;width:100%;border-top:#999 1px dotted;border-bottom:#999 1px dotted;padding:0;height:5px;cursor:default;").replace(/;/g," !important;");CKEDITOR.addCss("div.cke_pagebreak{"+t+"}")},init:function(t){t.blockless||(t.addCommand("pagebreak",CKEDITOR.plugins.pagebreakCmd),t.ui.addButton&&t.ui.addButton("PageBreak",{label:t.lang.pagebreak.toolbar,command:"pagebreak",toolbar:"insert,70"}),CKEDITOR.env.opera&&t.on("contentDom",function(){t.document.on("click",function(e){e=e.data.getTarget(),e.is("div")&&e.hasClass("cke_pagebreak")&&t.getSelection().selectElement(e)})}))},afterInit:function(e){function n(n){CKEDITOR.tools.extend(n.attributes,t(e.lang.pagebreak.alt),!0),n.children.length=0}var i=e.dataProcessor,o=i&&i.dataFilter,i=i&&i.htmlFilter,r=/page-break-after\s*:\s*always/i,s=/display\s*:\s*none/i;i&&i.addRules({attributes:{"class":function(t,e){var n=t.replace("cke_pagebreak","");if(n!=t){var i=CKEDITOR.htmlParser.fragment.fromHtml('<span style="display: none;">&nbsp;</span>').children[0];e.children.length=0,e.add(i),i=e.attributes,delete i["aria-label"],delete i.contenteditable,delete i.title}return n}}},{applyToAll:!0,priority:5}),o&&o.addRules({elements:{div:function(t){if(t.attributes["data-cke-pagebreak"])n(t);else if(r.test(t.attributes.style)){var e=t.children[0];e&&"span"==e.name&&s.test(e.attributes.style)&&n(t)}}}})}}),CKEDITOR.plugins.pagebreakCmd={exec:function(e){var n=e.document.createElement("div",{attributes:t(e.lang.pagebreak.alt)});e.insertElement(n)},context:"div",allowedContent:{div:{styles:"!page-break-after"},span:{match:function(t){return(t=t.parent)&&"div"==t.name&&t.styles["page-break-after"]},styles:"display"}},requiredContent:"div{page-break-after}"}}(),function(){function t(t,e,n){var i=CKEDITOR.cleanWord;return i?n():(t=CKEDITOR.getUrl(t.config.pasteFromWordCleanupFile||e+"filter/default.js"),CKEDITOR.scriptLoader.load(t,n,null,!0)),!i}function e(t){t.data.type="html"}CKEDITOR.plugins.add("pastefromword",{requires:"clipboard",init:function(n){var i=0,o=this.path;n.addCommand("pastefromword",{canUndo:!1,async:!0,exec:function(t){var n=this;i=1,t.once("beforePaste",e),t.getClipboardData({title:t.lang.pastefromword.title},function(e){e&&t.fire("paste",{type:"html",dataValue:e.dataValue}),t.fire("afterCommandExec",{name:"pastefromword",command:n,returnValue:!!e})})}}),n.ui.addButton&&n.ui.addButton("PasteFromWord",{label:n.lang.pastefromword.toolbar,command:"pastefromword",toolbar:"clipboard,50"}),n.on("pasteState",function(t){n.getCommand("pastefromword").setState(t.data)}),n.on("paste",function(e){var r=e.data,s=r.dataValue;if(s&&(i||/(class=\"?Mso|style=\"[^\"]*\bmso\-|w:WordDocument)/.test(s))){var l=t(n,o,function(){l?n.fire("paste",r):(!n.config.pasteFromWordPromptCleanup||i||confirm(n.lang.pastefromword.confirmCleanup))&&(r.dataValue=CKEDITOR.cleanWord(s,n))});l&&e.cancel()}},null,null,3)}})}(),function(){var t={canUndo:!1,async:!0,exec:function(e){e.getClipboardData({title:e.lang.pastetext.title},function(n){n&&e.fire("paste",{type:"text",dataValue:n.dataValue}),e.fire("afterCommandExec",{name:"pastetext",command:t,returnValue:!!n})})}};CKEDITOR.plugins.add("pastetext",{requires:"clipboard",init:function(e){e.addCommand("pastetext",t),e.ui.addButton&&e.ui.addButton("PasteText",{label:e.lang.pastetext.button,command:"pastetext",toolbar:"clipboard,40"}),e.config.forcePasteAsPlainText&&e.on("beforePaste",function(t){"html"!=t.data.type&&(t.data.type="text")}),e.on("pasteState",function(t){e.getCommand("pastetext").setState(t.data)})}})}(),function(){var t,e={modes:{wysiwyg:1,source:1},canUndo:!1,readOnly:1,exec:function(e){var n,i=e.config,o=i.baseHref?'<base href="'+i.baseHref+'"/>':"";if(i.fullPage)n=e.getData().replace(/<head>/,"$&"+o).replace(/[^>]*(?=<\/title>)/,"$& &mdash; "+e.lang.preview.preview);else{var i="<body ",r=e.document&&e.document.getBody();r&&(r.getAttribute("id")&&(i+='id="'+r.getAttribute("id")+'" '),r.getAttribute("class")&&(i+='class="'+r.getAttribute("class")+'" ')),n=e.config.docType+'<html dir="'+e.config.contentsLangDirection+'"><head>'+o+"<title>"+e.lang.preview.preview+"</title>"+CKEDITOR.tools.buildStyleHtml(e.config.contentsCss)+"</head>"+(i+">")+e.getData()+"</body></html>"}o=640,i=420,r=80;try{var s=window.screen,o=Math.round(.8*s.width),i=Math.round(.7*s.height),r=Math.round(.1*s.width)}catch(l){}if(!e.fire("contentPreview",e={dataValue:n}))return!1;var a,s="";return CKEDITOR.env.ie&&(window._cke_htmlToLoad=e.dataValue,a="javascript:void( (function(){document.open();"+("("+CKEDITOR.tools.fixDomain+")();").replace(/\/\/.*?\n/g,"").replace(/parent\./g,"window.opener.")+"document.write( window.opener._cke_htmlToLoad );document.close();window.opener._cke_htmlToLoad = null;})() )",s=""),CKEDITOR.env.gecko&&(window._cke_htmlToLoad=e.dataValue,s=t+"preview.html"),s=window.open(s,null,"toolbar=yes,location=no,status=yes,menubar=yes,scrollbars=yes,resizable=yes,width="+o+",height="+i+",left="+r),CKEDITOR.env.ie&&(s.location=a),CKEDITOR.env.ie||CKEDITOR.env.gecko||(a=s.document,a.open(),a.write(e.dataValue),a.close()),!0}};CKEDITOR.plugins.add("preview",{init:function(n){n.elementMode!=CKEDITOR.ELEMENT_MODE_INLINE&&(t=this.path,n.addCommand("preview",e),n.ui.addButton&&n.ui.addButton("Preview",{label:n.lang.preview.preview,command:"preview",toolbar:"document,40"}))}})}(),CKEDITOR.plugins.add("print",{init:function(t){t.elementMode!=CKEDITOR.ELEMENT_MODE_INLINE&&(t.addCommand("print",CKEDITOR.plugins.print),t.ui.addButton&&t.ui.addButton("Print",{label:t.lang.print.toolbar,command:"print",toolbar:"document,50"}))}}),CKEDITOR.plugins.print={exec:function(t){CKEDITOR.env.opera||(CKEDITOR.env.gecko?t.window.$.print():t.document.$.execCommand("Print"))},canUndo:!1,readOnly:1,modes:{wysiwyg:!CKEDITOR.env.opera}},CKEDITOR.plugins.add("removeformat",{init:function(t){t.addCommand("removeFormat",CKEDITOR.plugins.removeformat.commands.removeformat),t.ui.addButton&&t.ui.addButton("RemoveFormat",{label:t.lang.removeformat.toolbar,command:"removeFormat",toolbar:"cleanup,10"})}}),CKEDITOR.plugins.removeformat={commands:{removeformat:{exec:function(t){for(var e,n=t._.removeFormatRegex||(t._.removeFormatRegex=RegExp("^(?:"+t.config.removeFormatTags.replace(/,/g,"|")+")$","i")),i=t._.removeAttributes||(t._.removeAttributes=t.config.removeFormatAttributes.split(",")),o=CKEDITOR.plugins.removeformat.filter,r=t.getSelection().getRanges(1),s=r.createIterator();e=s.getNextRange();){e.collapsed||e.enlarge(CKEDITOR.ENLARGE_ELEMENT);var l=e.createBookmark(),a=l.startNode,h=l.endNode,d=function(e){for(var i,r=t.elementPath(e),s=r.elements,l=1;(i=s[l])&&(!i.equals(r.block)&&!i.equals(r.blockLimit));l++)n.test(i.getName())&&o(t,i)&&e.breakParent(i)};if(d(a),h)for(d(h),a=a.getNextSourceNode(!0,CKEDITOR.NODE_ELEMENT);a&&!a.equals(h);)d=a.getNextSourceNode(!1,CKEDITOR.NODE_ELEMENT),"img"==a.getName()&&a.data("cke-realelement")||!o(t,a)||(n.test(a.getName())?a.remove(1):(a.removeAttributes(i),t.fire("removeFormatCleanup",a))),a=d;e.moveToBookmark(l)}t.forceNextSelectionCheck(),t.getSelection().selectRanges(r)}}},filter:function(t,e){for(var n=t._.removeFormatFilters||[],i=0;i<n.length;i++)if(n[i](e)===!1)return!1;return!0}},CKEDITOR.editor.prototype.addRemoveFormatFilter=function(t){this._.removeFormatFilters||(this._.removeFormatFilters=[]),this._.removeFormatFilters.push(t)},CKEDITOR.config.removeFormatTags="b,big,code,del,dfn,em,font,i,ins,kbd,q,s,samp,small,span,strike,strong,sub,sup,tt,u,var",CKEDITOR.config.removeFormatAttributes="class,style,lang,width,height,align,hspace,valign",CKEDITOR.plugins.add("resize",{init:function(t){var e,n,i,o,r=t.config,s=t.ui.spaceId("resizer"),l=t.element?t.element.getDirection(1):"ltr";if(!r.resize_dir&&(r.resize_dir="vertical"),void 0==r.resize_maxWidth&&(r.resize_maxWidth=3e3),void 0==r.resize_maxHeight&&(r.resize_maxHeight=3e3),void 0==r.resize_minWidth&&(r.resize_minWidth=750),void 0==r.resize_minHeight&&(r.resize_minHeight=250),r.resize_enabled!==!1){var a=null,h=("both"==r.resize_dir||"horizontal"==r.resize_dir)&&r.resize_minWidth!=r.resize_maxWidth,d=("both"==r.resize_dir||"vertical"==r.resize_dir)&&r.resize_minHeight!=r.resize_maxHeight,u=function(s){var a=e,u=n,c=a+(s.data.$.screenX-i)*("rtl"==l?-1:1),s=u+(s.data.$.screenY-o);h&&(a=Math.max(r.resize_minWidth,Math.min(c,r.resize_maxWidth))),d&&(u=Math.max(r.resize_minHeight,Math.min(s,r.resize_maxHeight))),t.resize(h?a:null,u)},c=function(){CKEDITOR.document.removeListener("mousemove",u),CKEDITOR.document.removeListener("mouseup",c),t.document&&(t.document.removeListener("mousemove",u),t.document.removeListener("mouseup",c))},p=CKEDITOR.tools.addFunction(function(s){a||(a=t.getResizable()),e=a.$.offsetWidth||0,n=a.$.offsetHeight||0,i=s.screenX,o=s.screenY,r.resize_minWidth>e&&(r.resize_minWidth=e),r.resize_minHeight>n&&(r.resize_minHeight=n),CKEDITOR.document.on("mousemove",u),CKEDITOR.document.on("mouseup",c),t.document&&(t.document.on("mousemove",u),t.document.on("mouseup",c)),s.preventDefault&&s.preventDefault()});t.on("destroy",function(){CKEDITOR.tools.removeFunction(p)}),t.on("uiSpace",function(e){if("bottom"==e.data.space){var n="";h&&!d&&(n=" cke_resizer_horizontal"),!h&&d&&(n=" cke_resizer_vertical");var i='<span id="'+s+'" class="cke_resizer'+n+" cke_resizer_"+l+'" title="'+CKEDITOR.tools.htmlEncode(t.lang.common.resize)+'" onmousedown="CKEDITOR.tools.callFunction('+p+', event)">'+("ltr"==l?"":"")+"</span>";e.data.html="ltr"==l&&"ltr"==n?e.data.html+i:i+e.data.html}},t,null,100),t.on("maximize",function(e){t.ui.space("resizer")[e.data==CKEDITOR.TRISTATE_ON?"hide":"show"]()})}}}),function(){var t={readOnly:1,exec:function(t){if(t.fire("save")&&(t=t.element.$.form))try{t.submit()}catch(e){t.submit.click&&t.submit.click()}}};CKEDITOR.plugins.add("save",{init:function(e){e.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE&&(e.addCommand("save",t).modes={wysiwyg:!!e.element.$.form},e.ui.addButton&&e.ui.addButton("Save",{label:e.lang.save.toolbar,command:"save",toolbar:"document,10"}))}})}(),function(){CKEDITOR.plugins.add("selectall",{init:function(t){t.addCommand("selectAll",{modes:{wysiwyg:1,source:1},exec:function(t){var e=t.editable();if(e.is("textarea"))t=e.$,CKEDITOR.env.ie?t.createTextRange().execCommand("SelectAll"):(t.selectionStart=0,t.selectionEnd=t.value.length),t.focus();else{if(e.is("body"))t.document.$.execCommand("SelectAll",!1,null);else{var n=t.createRange();n.selectNodeContents(e),n.select()}t.forceNextSelectionCheck(),t.selectionChange()}},canUndo:!1}),t.ui.addButton&&t.ui.addButton("SelectAll",{label:t.lang.selectall.toolbar,command:"selectAll",toolbar:"selection,10"})}})}(),function(){var t={readOnly:1,preserveState:!0,editorFocus:!1,exec:function(t){this.toggleState(),this.refresh(t)},refresh:function(t){if(t.document){var e=this.state!=CKEDITOR.TRISTATE_ON||t.elementMode==CKEDITOR.ELEMENT_MODE_INLINE&&!t.focusManager.hasFocus?"removeClass":"attachClass";t.editable()[e]("cke_show_blocks")}}};CKEDITOR.plugins.add("showblocks",{onLoad:function(){var t,e,n,i,o,r,s=["p","div","pre","address","blockquote","h1","h2","h3","h4","h5","h6"],l=CKEDITOR.getUrl(this.path),a=!(CKEDITOR.env.ie&&CKEDITOR.env.version<9),h=a?":not([contenteditable=false]):not(.cke_show_blocks_off)":"";for(t=e=n=i="";o=s.pop();)r=s.length?",":"",t+=".cke_show_blocks "+o+h+r,n+=".cke_show_blocks.cke_contents_ltr "+o+h+r,i+=".cke_show_blocks.cke_contents_rtl "+o+h+r,e+=".cke_show_blocks "+o+h+"{background-image:url("+l+"images/block_"+o+".png)}";CKEDITOR.addCss((t+"{background-repeat:no-repeat;border:1px dotted gray;padding-top:8px}").concat(e,n+"{background-position:top left;padding-left:8px}",i+"{background-position:top right;padding-right:8px}")),a||CKEDITOR.addCss(".cke_show_blocks [contenteditable=false],.cke_show_blocks .cke_show_blocks_off{border:none;padding-top:0;background-image:none}.cke_show_blocks.cke_contents_rtl [contenteditable=false],.cke_show_blocks.cke_contents_rtl .cke_show_blocks_off{padding-right:0}.cke_show_blocks.cke_contents_ltr [contenteditable=false],.cke_show_blocks.cke_contents_ltr .cke_show_blocks_off{padding-left:0}")},init:function(e){function n(){i.refresh(e)}if(!e.blockless){var i=e.addCommand("showblocks",t);i.canUndo=!1,e.config.startupOutlineBlocks&&i.setState(CKEDITOR.TRISTATE_ON),e.ui.addButton&&e.ui.addButton("ShowBlocks",{label:e.lang.showblocks.toolbar,command:"showblocks",toolbar:"tools,20"}),e.on("mode",function(){i.state!=CKEDITOR.TRISTATE_DISABLED&&i.refresh(e)}),e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE&&(e.on("focus",n),e.on("blur",n)),e.on("contentDom",function(){i.state!=CKEDITOR.TRISTATE_DISABLED&&i.refresh(e)})}}})}(),function(){var t={preserveState:!0,editorFocus:!1,readOnly:1,exec:function(t){this.toggleState(),this.refresh(t)},refresh:function(t){if(t.document){var e=this.state==CKEDITOR.TRISTATE_ON?"attachClass":"removeClass";t.editable()[e]("cke_show_borders")}}};CKEDITOR.plugins.add("showborders",{modes:{wysiwyg:1},onLoad:function(){var t;t=(CKEDITOR.env.ie6Compat?[".%1 table.%2,",".%1 table.%2 td, .%1 table.%2 th","{","border : #d3d3d3 1px dotted","}"]:[".%1 table.%2,",".%1 table.%2 > tr > td, .%1 table.%2 > tr > th,",".%1 table.%2 > tbody > tr > td, .%1 table.%2 > tbody > tr > th,",".%1 table.%2 > thead > tr > td, .%1 table.%2 > thead > tr > th,",".%1 table.%2 > tfoot > tr > td, .%1 table.%2 > tfoot > tr > th","{","border : #d3d3d3 1px dotted","}"]).join("").replace(/%2/g,"cke_show_border").replace(/%1/g,"cke_show_borders "),CKEDITOR.addCss(t)},init:function(e){var n=e.addCommand("showborders",t);n.canUndo=!1,e.config.startupShowBorders!==!1&&n.setState(CKEDITOR.TRISTATE_ON),e.on("mode",function(){n.state!=CKEDITOR.TRISTATE_DISABLED&&n.refresh(e)},null,null,100),e.on("contentDom",function(){n.state!=CKEDITOR.TRISTATE_DISABLED&&n.refresh(e)}),e.on("removeFormatCleanup",function(t){t=t.data,e.getCommand("showborders").state==CKEDITOR.TRISTATE_ON&&t.is("table")&&(!t.hasAttribute("border")||parseInt(t.getAttribute("border"),10)<=0)&&t.addClass("cke_show_border")})},afterInit:function(t){var e=t.dataProcessor,t=e&&e.dataFilter,e=e&&e.htmlFilter;t&&t.addRules({elements:{table:function(t){var t=t.attributes,e=t["class"],n=parseInt(t.border,10);n&&!(0>=n)||e&&-1!=e.indexOf("cke_show_border")||(t["class"]=(e||"")+" cke_show_border")}}}),e&&e.addRules({elements:{table:function(t){var t=t.attributes,e=t["class"];e&&(t["class"]=e.replace("cke_show_border","").replace(/\s{2}/," ").replace(/^\s+|\s+$/,""))}}})}}),CKEDITOR.on("dialogDefinition",function(t){var e=t.data.name;("table"==e||"tableProperties"==e)&&(t=t.data.definition,e=t.getContents("info").get("txtBorder"),e.commit=CKEDITOR.tools.override(e.commit,function(t){return function(e,n){t.apply(this,arguments);var i=parseInt(this.getValue(),10);n[!i||0>=i?"addClass":"removeClass"]("cke_show_border")}}),(t=(t=t.getContents("advanced"))&&t.get("advCSSClasses"))&&(t.setup=CKEDITOR.tools.override(t.setup,function(t){return function(){t.apply(this,arguments),this.setValue(this.getValue().replace(/cke_show_border/,""))}}),t.commit=CKEDITOR.tools.override(t.commit,function(t){return function(e,n){t.apply(this,arguments),parseInt(n.getAttribute("border"),10)||n.addClass("cke_show_border")
}})))})}(),CKEDITOR.plugins.add("smiley",{requires:"dialog",init:function(t){t.config.smiley_path=t.config.smiley_path||this.path+"images/",t.addCommand("smiley",new CKEDITOR.dialogCommand("smiley",{allowedContent:"img[alt,height,!src,title,width]",requiredContent:"img"})),t.ui.addButton&&t.ui.addButton("Smiley",{label:t.lang.smiley.toolbar,command:"smiley",toolbar:"insert,50"}),CKEDITOR.dialog.add("smiley",this.path+"dialogs/smiley.js")}}),CKEDITOR.config.smiley_images="regular_smile.png sad_smile.png wink_smile.png teeth_smile.png confused_smile.png tongue_smile.png embarrassed_smile.png omg_smile.png whatchutalkingabout_smile.png angry_smile.png angel_smile.png shades_smile.png devil_smile.png cry_smile.png lightbulb.png thumbs_down.png thumbs_up.png heart.png broken_heart.png kiss.png envelope.png".split(" "),CKEDITOR.config.smiley_descriptions="smiley;sad;wink;laugh;frown;cheeky;blush;surprise;indecision;angry;angel;cool;devil;crying;enlightened;no;yes;heart;broken heart;kiss;mail".split(";"),function(){CKEDITOR.plugins.add("sourcearea",{init:function(e){function n(){this.hide(),this.setStyle("height",this.getParent().$.clientHeight+"px"),this.setStyle("width",this.getParent().$.clientWidth+"px"),this.show()}if(e.elementMode!=CKEDITOR.ELEMENT_MODE_INLINE){var i=CKEDITOR.plugins.sourcearea;e.addMode("source",function(i){var o=e.ui.space("contents").getDocument().createElement("textarea");o.setStyles(CKEDITOR.tools.extend({width:CKEDITOR.env.ie7Compat?"99%":"100%",height:"100%",resize:"none",outline:"none","text-align":"left"},CKEDITOR.tools.cssVendorPrefix("tab-size",e.config.sourceAreaTabSize||4))),o.setAttribute("dir","ltr"),o.addClass("cke_source cke_reset cke_enable_context_menu"),e.ui.space("contents").append(o),o=e.editable(new t(e,o)),o.setData(e.getData(1)),CKEDITOR.env.ie&&(o.attachListener(e,"resize",n,o),o.attachListener(CKEDITOR.document.getWindow(),"resize",n,o),CKEDITOR.tools.setTimeout(n,0,o)),e.fire("ariaWidget",this),i()}),e.addCommand("source",i.commands.source),e.ui.addButton&&e.ui.addButton("Source",{label:e.lang.sourcearea.toolbar,command:"source",toolbar:"mode,10"}),e.on("mode",function(){e.getCommand("source").setState("source"==e.mode?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)})}}});var t=CKEDITOR.tools.createClass({base:CKEDITOR.editable,proto:{setData:function(t){this.setValue(t),this.editor.fire("dataReady")},getData:function(){return this.getValue()},insertHtml:function(){},insertElement:function(){},insertText:function(){},setReadOnly:function(t){this[(t?"set":"remove")+"Attribute"]("readOnly","readonly")},detach:function(){t.baseProto.detach.call(this),this.clearCustomData(),this.remove()}}})}(),CKEDITOR.plugins.sourcearea={commands:{source:{modes:{wysiwyg:1,source:1},editorFocus:!1,readOnly:1,exec:function(t){"wysiwyg"==t.mode&&t.fire("saveSnapshot"),t.getCommand("source").setState(CKEDITOR.TRISTATE_DISABLED),t.setMode("source"==t.mode?"wysiwyg":"source")},canUndo:!1}}},CKEDITOR.plugins.add("specialchar",{availableLangs:{ar:1,bg:1,ca:1,cs:1,cy:1,de:1,el:1,en:1,eo:1,es:1,et:1,fa:1,fi:1,fr:1,"fr-ca":1,gl:1,he:1,hr:1,hu:1,id:1,it:1,ja:1,km:1,ku:1,lv:1,nb:1,nl:1,no:1,pl:1,pt:1,"pt-br":1,ru:1,si:1,sk:1,sl:1,sq:1,sv:1,th:1,tr:1,ug:1,uk:1,vi:1,zh:1,"zh-cn":1},requires:"dialog",init:function(t){var e=this;CKEDITOR.dialog.add("specialchar",this.path+"dialogs/specialchar.js"),t.addCommand("specialchar",{exec:function(){var n=t.langCode,n=e.availableLangs[n]?n:e.availableLangs[n.replace(/-.*/,"")]?n.replace(/-.*/,""):"en";CKEDITOR.scriptLoader.load(CKEDITOR.getUrl(e.path+"dialogs/lang/"+n+".js"),function(){CKEDITOR.tools.extend(t.lang.specialchar,e.langEntries[n]),t.openDialog("specialchar")})},modes:{wysiwyg:1},canUndo:!1}),t.ui.addButton&&t.ui.addButton("SpecialChar",{label:t.lang.specialchar.toolbar,command:"specialchar",toolbar:"insert,50"})}}),CKEDITOR.config.specialChars="! &quot; # $ % &amp; ' ( ) * + - . / 0 1 2 3 4 5 6 7 8 9 : ; &lt; = &gt; ? @ A B C D E F G H I J K L M N O P Q R S T U V W X Y Z [ ] ^ _ ` a b c d e f g h i j k l m n o p q r s t u v w x y z { | } ~ &euro; &lsquo; &rsquo; &ldquo; &rdquo; &ndash; &mdash; &iexcl; &cent; &pound; &curren; &yen; &brvbar; &sect; &uml; &copy; &ordf; &laquo; &not; &reg; &macr; &deg; &sup2; &sup3; &acute; &micro; &para; &middot; &cedil; &sup1; &ordm; &raquo; &frac14; &frac12; &frac34; &iquest; &Agrave; &Aacute; &Acirc; &Atilde; &Auml; &Aring; &AElig; &Ccedil; &Egrave; &Eacute; &Ecirc; &Euml; &Igrave; &Iacute; &Icirc; &Iuml; &ETH; &Ntilde; &Ograve; &Oacute; &Ocirc; &Otilde; &Ouml; &times; &Oslash; &Ugrave; &Uacute; &Ucirc; &Uuml; &Yacute; &THORN; &szlig; &agrave; &aacute; &acirc; &atilde; &auml; &aring; &aelig; &ccedil; &egrave; &eacute; &ecirc; &euml; &igrave; &iacute; &icirc; &iuml; &eth; &ntilde; &ograve; &oacute; &ocirc; &otilde; &ouml; &divide; &oslash; &ugrave; &uacute; &ucirc; &uuml; &yacute; &thorn; &yuml; &OElig; &oelig; &#372; &#374 &#373 &#375; &sbquo; &#8219; &bdquo; &hellip; &trade; &#9658; &bull; &rarr; &rArr; &hArr; &diams; &asymp;".split(" "),function(){CKEDITOR.plugins.add("stylescombo",{requires:"richcombo",init:function(t){var e=t.config,n=t.lang.stylescombo,i={},o=[],r=[];t.on("stylesSet",function(n){if(n=n.data.styles){for(var s,l,a=0,h=n.length;h>a;a++)s=n[a],t.blockless&&s.element in CKEDITOR.dtd.$block||(l=s.name,s=new CKEDITOR.style(s),(!t.filter.customConfig||t.filter.check(s))&&(s._name=l,s._.enterMode=e.enterMode,s._.weight=a+1e3*(s.type==CKEDITOR.STYLE_OBJECT?1:s.type==CKEDITOR.STYLE_BLOCK?2:3),i[l]=s,o.push(s),r.push(s)));o.sort(function(t,e){return t._.weight-e._.weight})}}),t.ui.addRichCombo("Styles",{label:n.label,title:n.panelTitle,toolbar:"styles,10",allowedContent:r,panel:{css:[CKEDITOR.skin.getPath("editor")].concat(e.contentsCss),multiSelect:!0,attributes:{"aria-label":n.panelTitle}},init:function(){var t,e,i,r,s,l;for(s=0,l=o.length;l>s;s++)t=o[s],e=t._name,r=t.type,r!=i&&(this.startGroup(n["panelTitle"+r]),i=r),this.add(e,t.type==CKEDITOR.STYLE_OBJECT?e:t.buildPreview(),e);this.commit()},onClick:function(e){t.focus(),t.fire("saveSnapshot");var e=i[e],n=t.elementPath();t[e.checkActive(n)?"removeStyle":"applyStyle"](e),t.fire("saveSnapshot")},onRender:function(){t.on("selectionChange",function(t){for(var e,n=this.getValue(),t=t.data.path.elements,o=0,r=t.length;r>o;o++){e=t[o];for(var s in i)if(i[s].checkElementRemovable(e,!0))return s!=n&&this.setValue(s),void 0}this.setValue("")},this)},onOpen:function(){var e=t.getSelection().getSelectedElement(),e=t.elementPath(e),o=[0,0,0,0];this.showAll(),this.unmarkAll();for(var r in i){var s=i[r],l=s.type;s.checkApplicable(e,t.activeFilter)?o[l]++:this.hideItem(r),s.checkActive(e)&&this.mark(r)}o[CKEDITOR.STYLE_BLOCK]||this.hideGroup(n["panelTitle"+CKEDITOR.STYLE_BLOCK]),o[CKEDITOR.STYLE_INLINE]||this.hideGroup(n["panelTitle"+CKEDITOR.STYLE_INLINE]),o[CKEDITOR.STYLE_OBJECT]||this.hideGroup(n["panelTitle"+CKEDITOR.STYLE_OBJECT])},refresh:function(){var e=t.elementPath();if(e){for(var n in i)if(i[n].checkApplicable(e,t.activeFilter))return;this.setState(CKEDITOR.TRISTATE_DISABLED)}},reset:function(){i={},o=[]}})}})}(),function(){function t(t){return{editorFocus:!1,canUndo:!1,modes:{wysiwyg:1},exec:function(e){if(e.editable().hasFocus){var n,i=e.getSelection();if(n=new CKEDITOR.dom.elementPath(i.getCommonAncestor(),i.root).contains({td:1,th:1},1)){var i=e.createRange(),o=CKEDITOR.tools.tryThese(function(){var e=n.getParent().$.cells[n.$.cellIndex+(t?-1:1)];return e.parentNode.parentNode,e},function(){var e=n.getParent(),e=e.getAscendant("table").$.rows[e.$.rowIndex+(t?-1:1)];return e.cells[t?e.cells.length-1:0]});if(o||t){if(!o)return!0;o=new CKEDITOR.dom.element(o),i.moveToElementEditStart(o),(!i.checkStartOfBlock()||!i.checkEndOfBlock())&&i.selectNodeContents(o)}else{for(var r=n.getAscendant("table").$,o=n.getParent().$.cells,r=new CKEDITOR.dom.element(r.insertRow(-1),e.document),s=0,l=o.length;l>s;s++)r.append(new CKEDITOR.dom.element(o[s],e.document).clone(!1,!1)).appendBogus();i.moveToElementEditStart(r)}return i.select(!0),!0}}return!1}}}var e={editorFocus:!1,modes:{wysiwyg:1,source:1}},n={exec:function(t){t.container.focusNext(!0,t.tabIndex)}},i={exec:function(t){t.container.focusPrevious(!0,t.tabIndex)}};CKEDITOR.plugins.add("tab",{init:function(o){for(var r=o.config.enableTabKeyTools!==!1,s=o.config.tabSpaces||0,l="";s--;)l+="";l&&o.on("key",function(t){9==t.data.keyCode&&(o.insertHtml(l),t.cancel())}),r&&o.on("key",function(t){(9==t.data.keyCode&&o.execCommand("selectNextCell")||t.data.keyCode==CKEDITOR.SHIFT+9&&o.execCommand("selectPreviousCell"))&&t.cancel()}),o.addCommand("blur",CKEDITOR.tools.extend(n,e)),o.addCommand("blurBack",CKEDITOR.tools.extend(i,e)),o.addCommand("selectNextCell",t()),o.addCommand("selectPreviousCell",t(!0))}})}(),CKEDITOR.dom.element.prototype.focusNext=function(t,e){var n,i,o,r,s,l,a=void 0===e?this.getTabIndex():e;if(0>=a)for(s=this.getNextSourceNode(t,CKEDITOR.NODE_ELEMENT);s;){if(s.isVisible()&&0===s.getTabIndex()){o=s;break}s=s.getNextSourceNode(!1,CKEDITOR.NODE_ELEMENT)}else for(s=this.getDocument().getBody().getFirst();s=s.getNextSourceNode(!1,CKEDITOR.NODE_ELEMENT);){if(!n)if(!i&&s.equals(this)){if(i=!0,t){if(!(s=s.getNextSourceNode(!0,CKEDITOR.NODE_ELEMENT)))break;n=1}}else i&&!this.contains(s)&&(n=1);if(s.isVisible()&&!((l=s.getTabIndex())<0)){if(n&&l==a){o=s;break}l>a&&(!o||!r||r>l)?(o=s,r=l):o||0!==l||(o=s,r=l)}}o&&o.focus()},CKEDITOR.dom.element.prototype.focusPrevious=function(t,e){for(var n,i,o,r,s=void 0===e?this.getTabIndex():e,l=0,a=this.getDocument().getBody().getLast();a=a.getPreviousSourceNode(!1,CKEDITOR.NODE_ELEMENT);){if(!n)if(!i&&a.equals(this)){if(i=!0,t){if(!(a=a.getPreviousSourceNode(!0,CKEDITOR.NODE_ELEMENT)))break;n=1}}else i&&!this.contains(a)&&(n=1);if(a.isVisible()&&!((r=a.getTabIndex())<0))if(0>=s){if(n&&0===r){o=a;break}r>l&&(o=a,l=r)}else{if(n&&r==s){o=a;break}s>r&&(!o||r>l)&&(o=a,l=r)}}o&&o.focus()},CKEDITOR.plugins.add("table",{requires:"dialog",init:function(t){function e(t){return CKEDITOR.tools.extend(t||{},{contextSensitive:1,refresh:function(t,e){this.setState(e.contains("table",1)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED)}})}if(!t.blockless){var n=t.lang.table;t.addCommand("table",new CKEDITOR.dialogCommand("table",{context:"table",allowedContent:"table{width,height}[align,border,cellpadding,cellspacing,summary];caption tbody thead tfoot;th td tr[scope];"+(t.plugins.dialogadvtab?"table"+t.plugins.dialogadvtab.allowedContent():""),requiredContent:"table",contentTransformations:[["table{width}: sizeToStyle","table[width]: sizeToAttribute"]]})),t.addCommand("tableProperties",new CKEDITOR.dialogCommand("tableProperties",e())),t.addCommand("tableDelete",e({exec:function(t){var e=t.elementPath().contains("table",1);if(e){var n=e.getParent();1==n.getChildCount()&&!n.is("body","td","th")&&(e=n),t=t.createRange(),t.moveToPosition(e,CKEDITOR.POSITION_BEFORE_START),e.remove(),t.select()}}})),t.ui.addButton&&t.ui.addButton("Table",{label:n.toolbar,command:"table",toolbar:"insert,30"}),CKEDITOR.dialog.add("table",this.path+"dialogs/table.js"),CKEDITOR.dialog.add("tableProperties",this.path+"dialogs/table.js"),t.addMenuItems&&t.addMenuItems({table:{label:n.menu,command:"tableProperties",group:"table",order:5},tabledelete:{label:n.deleteTable,command:"tableDelete",group:"table",order:1}}),t.on("doubleclick",function(t){t.data.element.is("table")&&(t.data.dialog="tableProperties")}),t.contextMenu&&t.contextMenu.addListener(function(){return{tabledelete:CKEDITOR.TRISTATE_OFF,table:CKEDITOR.TRISTATE_OFF}})}}}),function(){function t(t){function e(t){n.length>0||t.type!=CKEDITOR.NODE_ELEMENT||!c.test(t.getName())||t.getCustomData("selected_cell")||(CKEDITOR.dom.element.setMarker(i,t,"selected_cell",!0),n.push(t))}for(var t=t.getRanges(),n=[],i={},o=0;o<t.length;o++){var r=t[o];if(r.collapsed)r=r.getCommonAncestor(),(r=r.getAscendant("td",!0)||r.getAscendant("th",!0))&&n.push(r);else{var s,r=new CKEDITOR.dom.walker(r);for(r.guard=e;s=r.next();)s.type==CKEDITOR.NODE_ELEMENT&&s.is(CKEDITOR.dtd.table)||(s=s.getAscendant("td",!0)||s.getAscendant("th",!0))&&!s.getCustomData("selected_cell")&&(CKEDITOR.dom.element.setMarker(i,s,"selected_cell",!0),n.push(s))}}return CKEDITOR.dom.element.clearAllMarkers(i),n}function e(e,n){for(var i=t(e),o=i[0],r=o.getAscendant("table"),o=o.getDocument(),s=i[0].getParent(),l=s.$.rowIndex,i=i[i.length-1],a=i.getParent().$.rowIndex+i.$.rowSpan-1,i=new CKEDITOR.dom.element(r.$.rows[a]),l=n?l:a,s=n?s:i,i=CKEDITOR.tools.buildTableMap(r),r=i[l],l=n?i[l-1]:i[l+1],i=i[0].length,o=o.createElement("tr"),a=0;r[a]&&i>a;a++){var h;r[a].rowSpan>1&&l&&r[a]==l[a]?(h=r[a],h.rowSpan=h.rowSpan+1):(h=new CKEDITOR.dom.element(r[a]).clone(),h.removeAttribute("rowSpan"),h.appendBogus(),o.append(h),h=h.$),a+=h.colSpan-1}n?o.insertBefore(s):o.insertAfter(s)}function n(e){if(e instanceof CKEDITOR.dom.selection){for(var i=t(e),o=i[0].getAscendant("table"),r=CKEDITOR.tools.buildTableMap(o),e=i[0].getParent().$.rowIndex,i=i[i.length-1],s=i.getParent().$.rowIndex+i.$.rowSpan-1,i=[],l=e;s>=l;l++){for(var a=r[l],h=new CKEDITOR.dom.element(o.$.rows[l]),d=0;d<a.length;d++){var u=new CKEDITOR.dom.element(a[d]),c=u.getParent().$.rowIndex;1==u.$.rowSpan?u.remove():(u.$.rowSpan=u.$.rowSpan-1,c==l&&(c=r[l+1],c[d-1]?u.insertAfter(new CKEDITOR.dom.element(c[d-1])):new CKEDITOR.dom.element(o.$.rows[l+1]).append(u,1))),d+=u.$.colSpan-1}i.push(h)}for(r=o.$.rows,o=new CKEDITOR.dom.element(r[s+1]||(e>0?r[e-1]:null)||o.$.parentNode),l=i.length;l>=0;l--)n(i[l]);return o}return e instanceof CKEDITOR.dom.element&&(o=e.getAscendant("table"),1==o.$.rows.length?o.remove():e.remove()),null}function i(t,e){for(var n=e?1/0:0,i=0;i<t.length;i++){var o;o=t[i];for(var r=e,s=o.getParent().$.cells,l=0,a=0;a<s.length;a++){var h=s[a],l=l+(r?1:h.colSpan);if(h==o.$)break}o=l-1,(e?n>o:o>n)&&(n=o)}return n}function o(e,n){for(var o=t(e),r=o[0].getAscendant("table"),s=i(o,1),o=i(o),s=n?s:o,l=CKEDITOR.tools.buildTableMap(r),r=[],o=[],a=l.length,h=0;a>h;h++)r.push(l[h][s]),o.push(n?l[h][s-1]:l[h][s+1]);for(h=0;a>h;h++)r[h]&&(r[h].colSpan>1&&o[h]==r[h]?(s=r[h],s.colSpan=s.colSpan+1):(s=new CKEDITOR.dom.element(r[h]).clone(),s.removeAttribute("colSpan"),s.appendBogus(),s[n?"insertBefore":"insertAfter"].call(s,new CKEDITOR.dom.element(r[h])),s=s.$),h+=s.rowSpan-1)}function r(t,e){var n=t.getStartElement();if(n=n.getAscendant("td",1)||n.getAscendant("th",1)){var i=n.clone();i.appendBogus(),e?i.insertBefore(n):i.insertAfter(n)}}function s(e){if(e instanceof CKEDITOR.dom.selection){var n,e=t(e),i=e[0]&&e[0].getAscendant("table");t:{var o=0;n=e.length-1;for(var r,a,h={};r=e[o++];)CKEDITOR.dom.element.setMarker(h,r,"delete_cell",!0);for(o=0;r=e[o++];)if((a=r.getPrevious())&&!a.getCustomData("delete_cell")||(a=r.getNext())&&!a.getCustomData("delete_cell")){CKEDITOR.dom.element.clearAllMarkers(h),n=a;break t}CKEDITOR.dom.element.clearAllMarkers(h),a=e[0].getParent(),(a=a.getPrevious())?n=a.getLast():(a=e[n].getParent(),n=(a=a.getNext())?a.getChild(0):null)}for(a=e.length-1;a>=0;a--)s(e[a]);n?l(n,!0):i&&i.remove()}else e instanceof CKEDITOR.dom.element&&(i=e.getParent(),1==i.getChildCount()?i.remove():e.remove())}function l(t,e){var n=t.getDocument(),i=CKEDITOR.document;CKEDITOR.env.ie&&CKEDITOR.env.version<11&&(i.focus(),n.focus()),n=new CKEDITOR.dom.range(n),n["moveToElementEdit"+(e?"End":"Start")](t)||(n.selectNodeContents(t),n.collapse(e?!1:!0)),n.select(!0)}function a(t,e,n){if(t=t[e],"undefined"==typeof n)return t;for(e=0;t&&e<t.length;e++){if(n.is&&t[e]==n.$)return e;if(e==n)return new CKEDITOR.dom.element(t[e])}return n.is?-1:null}function h(e,n,i){var o,r=t(e);if((n?1!=r.length:r.length<2)||(o=e.getCommonAncestor())&&o.type==CKEDITOR.NODE_ELEMENT&&o.is("table"))return!1;var s,e=r[0];o=e.getAscendant("table");var l=CKEDITOR.tools.buildTableMap(o),h=l.length,d=l[0].length,u=e.getParent().$.rowIndex,c=a(l,u,e);if(n){var p;try{var m=parseInt(e.getAttribute("rowspan"),10)||1;s=parseInt(e.getAttribute("colspan"),10)||1,p=l["up"==n?u-m:"down"==n?u+m:u]["left"==n?c-s:"right"==n?c+s:c]}catch(g){return!1}if(!p||e.$==p)return!1;r["up"==n||"left"==n?"unshift":"push"](new CKEDITOR.dom.element(p))}for(var n=e.getDocument(),f=u,m=p=0,x=!i&&new CKEDITOR.dom.documentFragment(n),C=0,n=0;n<r.length;n++){s=r[n];var E=s.getParent(),y=s.getFirst(),v=s.$.colSpan,T=s.$.rowSpan,E=E.$.rowIndex,b=a(l,E,s),C=C+v*T,m=Math.max(m,b-c+v);p=Math.max(p,E-u+T),i||(v=s,(T=v.getBogus())&&T.remove(),v.trim(),s.getChildren().count()&&(E==f||!y||y.isBlockBoundary&&y.isBlockBoundary({br:1})||(f=x.getLast(CKEDITOR.dom.walker.whitespaces(!0)))&&(!f.is||!f.is("br"))&&x.append("br"),s.moveChildren(x)),n?s.remove():s.setHtml("")),f=E}if(i)return p*m==C;for(x.moveChildren(e),e.appendBogus(),m>=d?e.removeAttribute("rowSpan"):e.$.rowSpan=p,p>=h?e.removeAttribute("colSpan"):e.$.colSpan=m,i=new CKEDITOR.dom.nodeList(o.$.rows),r=i.count(),n=r-1;n>=0;n--)o=i.getItem(n),o.$.cells.length||(o.remove(),r++);return e}function d(e,n){var i=t(e);if(i.length>1)return!1;if(n)return!0;var o,i=i[0],r=i.getParent(),s=r.getAscendant("table"),l=CKEDITOR.tools.buildTableMap(s),h=r.$.rowIndex,d=a(l,h,i),u=i.$.rowSpan;if(u>1){o=Math.ceil(u/2);for(var c,u=Math.floor(u/2),r=h+o,s=new CKEDITOR.dom.element(s.$.rows[r]),l=a(l,r),r=i.clone(),h=0;h<l.length;h++){if(c=l[h],c.parentNode==s.$&&h>d){r.insertBefore(new CKEDITOR.dom.element(c));break}c=null}c||s.append(r,!0)}else for(u=o=1,s=r.clone(),s.insertAfter(r),s.append(r=i.clone()),c=a(l,h),d=0;d<c.length;d++)c[d].rowSpan++;return r.appendBogus(),i.$.rowSpan=o,r.$.rowSpan=u,1==o&&i.removeAttribute("rowSpan"),1==u&&r.removeAttribute("rowSpan"),r}function u(e,n){var i=t(e);if(i.length>1)return!1;if(n)return!0;var i=i[0],o=i.getParent(),r=o.getAscendant("table"),r=CKEDITOR.tools.buildTableMap(r),s=a(r,o.$.rowIndex,i),l=i.$.colSpan;if(l>1)o=Math.ceil(l/2),l=Math.floor(l/2);else{for(var l=o=1,h=[],d=0;d<r.length;d++){var u=r[d];h.push(u[s]),u[s].rowSpan>1&&(d+=u[s].rowSpan-1)}for(r=0;r<h.length;r++)h[r].colSpan++}return r=i.clone(),r.insertAfter(i),r.appendBogus(),i.$.colSpan=o,r.$.colSpan=l,1==o&&i.removeAttribute("colSpan"),1==l&&r.removeAttribute("colSpan"),r}var c=/^(?:td|th)$/;CKEDITOR.plugins.tabletools={requires:"table,dialog,contextmenu",init:function(i){function a(t){return CKEDITOR.tools.extend(t||{},{contextSensitive:1,refresh:function(t,e){this.setState(e.contains({td:1,th:1},1)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED)}})}function c(t,e){var n=i.addCommand(t,e);i.addFeature(n)}var p=i.lang.table;c("cellProperties",new CKEDITOR.dialogCommand("cellProperties",a({allowedContent:"td th{width,height,border-color,background-color,white-space,vertical-align,text-align}[colspan,rowspan]",requiredContent:"table"}))),CKEDITOR.dialog.add("cellProperties",this.path+"dialogs/tableCell.js"),c("rowDelete",a({requiredContent:"table",exec:function(t){t=t.getSelection(),l(n(t))}})),c("rowInsertBefore",a({requiredContent:"table",exec:function(t){t=t.getSelection(),e(t,!0)}})),c("rowInsertAfter",a({requiredContent:"table",exec:function(t){t=t.getSelection(),e(t)}})),c("columnDelete",a({requiredContent:"table",exec:function(e){for(var n,i,e=e.getSelection(),e=t(e),o=e[0],r=e[e.length-1],e=o.getAscendant("table"),s=CKEDITOR.tools.buildTableMap(e),a=[],h=0,d=s.length;d>h;h++)for(var u=0,c=s[h].length;c>u;u++)s[h][u]==o.$&&(n=u),s[h][u]==r.$&&(i=u);for(h=n;i>=h;h++)for(u=0;u<s.length;u++)r=s[u],o=new CKEDITOR.dom.element(e.$.rows[u]),r=new CKEDITOR.dom.element(r[h]),r.$&&(1==r.$.colSpan?r.remove():r.$.colSpan=r.$.colSpan-1,u+=r.$.rowSpan-1,o.$.cells.length||a.push(o));i=e.$.rows[0]&&e.$.rows[0].cells,n=new CKEDITOR.dom.element(i[n]||(n?i[n-1]:e.$.parentNode)),a.length==d&&e.remove(),n&&l(n,!0)}})),c("columnInsertBefore",a({requiredContent:"table",exec:function(t){t=t.getSelection(),o(t,!0)}})),c("columnInsertAfter",a({requiredContent:"table",exec:function(t){t=t.getSelection(),o(t)}})),c("cellDelete",a({requiredContent:"table",exec:function(t){t=t.getSelection(),s(t)}})),c("cellMerge",a({allowedContent:"td[colspan,rowspan]",requiredContent:"td[colspan,rowspan]",exec:function(t){l(h(t.getSelection()),!0)}})),c("cellMergeRight",a({allowedContent:"td[colspan]",requiredContent:"td[colspan]",exec:function(t){l(h(t.getSelection(),"right"),!0)}})),c("cellMergeDown",a({allowedContent:"td[rowspan]",requiredContent:"td[rowspan]",exec:function(t){l(h(t.getSelection(),"down"),!0)}})),c("cellVerticalSplit",a({allowedContent:"td[rowspan]",requiredContent:"td[rowspan]",exec:function(t){l(d(t.getSelection()))}})),c("cellHorizontalSplit",a({allowedContent:"td[colspan]",requiredContent:"td[colspan]",exec:function(t){l(u(t.getSelection()))}})),c("cellInsertBefore",a({requiredContent:"table",exec:function(t){t=t.getSelection(),r(t,!0)}})),c("cellInsertAfter",a({requiredContent:"table",exec:function(t){t=t.getSelection(),r(t)}})),i.addMenuItems&&i.addMenuItems({tablecell:{label:p.cell.menu,group:"tablecell",order:1,getItems:function(){var e=i.getSelection(),n=t(e);return{tablecell_insertBefore:CKEDITOR.TRISTATE_OFF,tablecell_insertAfter:CKEDITOR.TRISTATE_OFF,tablecell_delete:CKEDITOR.TRISTATE_OFF,tablecell_merge:h(e,null,!0)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,tablecell_merge_right:h(e,"right",!0)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,tablecell_merge_down:h(e,"down",!0)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,tablecell_split_vertical:d(e,!0)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,tablecell_split_horizontal:u(e,!0)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,tablecell_properties:n.length>0?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED}}},tablecell_insertBefore:{label:p.cell.insertBefore,group:"tablecell",command:"cellInsertBefore",order:5},tablecell_insertAfter:{label:p.cell.insertAfter,group:"tablecell",command:"cellInsertAfter",order:10},tablecell_delete:{label:p.cell.deleteCell,group:"tablecell",command:"cellDelete",order:15},tablecell_merge:{label:p.cell.merge,group:"tablecell",command:"cellMerge",order:16},tablecell_merge_right:{label:p.cell.mergeRight,group:"tablecell",command:"cellMergeRight",order:17},tablecell_merge_down:{label:p.cell.mergeDown,group:"tablecell",command:"cellMergeDown",order:18},tablecell_split_horizontal:{label:p.cell.splitHorizontal,group:"tablecell",command:"cellHorizontalSplit",order:19},tablecell_split_vertical:{label:p.cell.splitVertical,group:"tablecell",command:"cellVerticalSplit",order:20},tablecell_properties:{label:p.cell.title,group:"tablecellproperties",command:"cellProperties",order:21},tablerow:{label:p.row.menu,group:"tablerow",order:1,getItems:function(){return{tablerow_insertBefore:CKEDITOR.TRISTATE_OFF,tablerow_insertAfter:CKEDITOR.TRISTATE_OFF,tablerow_delete:CKEDITOR.TRISTATE_OFF}}},tablerow_insertBefore:{label:p.row.insertBefore,group:"tablerow",command:"rowInsertBefore",order:5},tablerow_insertAfter:{label:p.row.insertAfter,group:"tablerow",command:"rowInsertAfter",order:10},tablerow_delete:{label:p.row.deleteRow,group:"tablerow",command:"rowDelete",order:15},tablecolumn:{label:p.column.menu,group:"tablecolumn",order:1,getItems:function(){return{tablecolumn_insertBefore:CKEDITOR.TRISTATE_OFF,tablecolumn_insertAfter:CKEDITOR.TRISTATE_OFF,tablecolumn_delete:CKEDITOR.TRISTATE_OFF}}},tablecolumn_insertBefore:{label:p.column.insertBefore,group:"tablecolumn",command:"columnInsertBefore",order:5},tablecolumn_insertAfter:{label:p.column.insertAfter,group:"tablecolumn",command:"columnInsertAfter",order:10},tablecolumn_delete:{label:p.column.deleteColumn,group:"tablecolumn",command:"columnDelete",order:15}}),i.contextMenu&&i.contextMenu.addListener(function(t,e,n){return(t=n.contains({td:1,th:1},1))&&!t.isReadOnly()?{tablecell:CKEDITOR.TRISTATE_OFF,tablerow:CKEDITOR.TRISTATE_OFF,tablecolumn:CKEDITOR.TRISTATE_OFF}:null})},getSelectedCells:t},CKEDITOR.plugins.add("tabletools",CKEDITOR.plugins.tabletools)}(),CKEDITOR.tools.buildTableMap=function(t){for(var t=t.$.rows,e=-1,n=[],i=0;i<t.length;i++){e++,!n[e]&&(n[e]=[]);for(var o=-1,r=0;r<t[i].cells.length;r++){var s=t[i].cells[r];for(o++;n[e][o];)o++;for(var l=isNaN(s.colSpan)?1:s.colSpan,s=isNaN(s.rowSpan)?1:s.rowSpan,a=0;s>a;a++){n[e+a]||(n[e+a]=[]);for(var h=0;l>h;h++)n[e+a][o+h]=t[i].cells[r]}o+=l-1}}return n},function(){CKEDITOR.plugins.add("templates",{requires:"dialog",init:function(t){CKEDITOR.dialog.add("templates",CKEDITOR.getUrl(this.path+"dialogs/templates.js")),t.addCommand("templates",new CKEDITOR.dialogCommand("templates")),t.ui.addButton&&t.ui.addButton("Templates",{label:t.lang.templates.button,command:"templates",toolbar:"doctools,10"})}});var t={},e={};CKEDITOR.addTemplates=function(e,n){t[e]=n},CKEDITOR.getTemplates=function(e){return t[e]},CKEDITOR.loadTemplates=function(t,n){for(var i=[],o=0,r=t.length;r>o;o++)e[t[o]]||(i.push(t[o]),e[t[o]]=1);i.length?CKEDITOR.scriptLoader.load(i,n):setTimeout(n,0)}}(),CKEDITOR.config.templates_files=[CKEDITOR.getUrl("plugins/templates/templates/default.js")],CKEDITOR.config.templates_replaceContent=!0,function(){function t(t){function n(){for(var n=i(),r=CKEDITOR.tools.clone(t.config.toolbarGroups)||e(t),s=0;s<r.length;s++){var l=r[s];if("/"!=l){"string"==typeof l&&(l=r[s]={name:l});var a,h=l.groups;if(h)for(var d=0;d<h.length;d++)a=h[d],(a=n[a])&&o(l,a);(a=n[l.name])&&o(l,a)}}return r}function i(){var e,n,i,o={};for(e in t.ui.items)n=t.ui.items[e],i=n.toolbar||"others",i=i.split(","),n=i[0],i=parseInt(i[1]||-1,10),o[n]||(o[n]=[]),o[n].push({name:e,order:i});for(n in o)o[n]=o[n].sort(function(t,e){return t.order==e.order?0:e.order<0?-1:t.order<0?1:t.order<e.order?-1:1});return o}function o(e,n){if(n.length){e.items?e.items.push(t.ui.create("-")):e.items=[];for(var i;i=n.shift();)i="string"==typeof i?i:i.name,s&&-1!=CKEDITOR.tools.indexOf(s,i)||(i=t.ui.create(i))&&t.addFeature(i)&&e.items.push(i)}}function r(t){var e,n,i,r=[];for(e=0;e<t.length;++e)n=t[e],i={},"/"==n?r.push(n):CKEDITOR.tools.isArray(n)?(o(i,CKEDITOR.tools.clone(n)),r.push(i)):n.items&&(o(i,CKEDITOR.tools.clone(n.items)),i.name=n.name,r.push(i));return r}var s=t.config.removeButtons,s=s&&s.split(","),l=t.config.toolbar;return"string"==typeof l&&(l=t.config["toolbar_"+l]),t.toolbar=l?r(l):n()}function e(t){return t._.toolbarGroups||(t._.toolbarGroups=[{name:"document",groups:["mode","document","doctools"]},{name:"clipboard",groups:["clipboard","undo"]},{name:"editing",groups:["find","selection","spellchecker"]},{name:"forms"},"/",{name:"basicstyles",groups:["basicstyles","cleanup"]},{name:"paragraph",groups:["list","indent","blocks","align","bidi"]},{name:"links"},{name:"insert"},"/",{name:"styles"},{name:"colors"},{name:"tools"},{name:"others"},{name:"about"}])}var n=function(){this.toolbars=[],this.focusCommandExecuted=!1};n.prototype.focus=function(){for(var t,e=0;t=this.toolbars[e++];)for(var n,i=0;n=t.items[i++];)if(n.focus)return n.focus(),void 0};var i={modes:{wysiwyg:1,source:1},readOnly:1,exec:function(t){t.toolbox&&(t.toolbox.focusCommandExecuted=!0,CKEDITOR.env.ie||CKEDITOR.env.air?setTimeout(function(){t.toolbox.focus()},100):t.toolbox.focus())}};CKEDITOR.plugins.add("toolbar",{requires:"button",init:function(e){var o,r=function(t,n){var i,s="rtl"==e.lang.dir,l=e.config.toolbarGroupCycling,a=s?37:39,s=s?39:37,l=void 0===l||l;switch(n){case 9:case CKEDITOR.SHIFT+9:for(;!i||!i.items.length;)if(i=9==n?(i?i.next:t.toolbar.next)||e.toolbox.toolbars[0]:(i?i.previous:t.toolbar.previous)||e.toolbox.toolbars[e.toolbox.toolbars.length-1],i.items.length)for(t=i.items[o?i.items.length-1:0];t&&!t.focus;)(t=o?t.previous:t.next)||(i=0);return t&&t.focus(),!1;case a:i=t;do i=i.next,!i&&l&&(i=t.toolbar.items[0]);while(i&&!i.focus);return i?i.focus():r(t,9),!1;case 40:return t.button&&t.button.hasArrow?(e.once("panelShow",function(t){t.data._.panel._.currentBlock.onKeyDown(40)}),t.execute()):r(t,40==n?a:s),!1;case s:case 38:i=t;do i=i.previous,!i&&l&&(i=t.toolbar.items[t.toolbar.items.length-1]);while(i&&!i.focus);return i?i.focus():(o=1,r(t,CKEDITOR.SHIFT+9),o=0),!1;case 27:return e.focus(),!1;case 13:case 32:return t.execute(),!1}return!0};e.on("uiSpace",function(i){if(i.data.space==e.config.toolbarLocation){i.removeListener(),e.toolbox=new n;var o,s,l=CKEDITOR.tools.getNextId(),a=['<span id="',l,'" class="cke_voice_label">',e.lang.toolbar.toolbars,"</span>",'<span id="'+e.ui.spaceId("toolbox")+'" class="cke_toolbox" role="group" aria-labelledby="',l,'" onmousedown="return false;">'],l=e.config.toolbarStartupExpanded!==!1;e.config.toolbarCanCollapse&&e.elementMode!=CKEDITOR.ELEMENT_MODE_INLINE&&a.push('<span class="cke_toolbox_main"'+(l?">":' style="display:none">'));for(var h=e.toolbox.toolbars,d=t(e),u=0;u<d.length;u++){var c,p,m,g=0,f=d[u];if(f)if(o&&(a.push("</span>"),s=o=0),"/"===f)a.push('<span class="cke_toolbar_break"></span>');else{m=f.items||f;for(var x=0;x<m.length;x++){var C,E=m[x];if(E)if(E.type==CKEDITOR.UI_SEPARATOR)s=o&&E;else{if(C=E.canGroup!==!1,!g){c=CKEDITOR.tools.getNextId(),g={id:c,items:[]},p=f.name&&(e.lang.toolbar.toolbarGroups[f.name]||f.name),a.push('<span id="',c,'" class="cke_toolbar"',p?' aria-labelledby="'+c+'_label"':"",' role="toolbar">'),p&&a.push('<span id="',c,'_label" class="cke_voice_label">',p,"</span>"),a.push('<span class="cke_toolbar_start"></span>');var y=h.push(g)-1;y>0&&(g.previous=h[y-1],g.previous.next=g)}C?o||(a.push('<span class="cke_toolgroup" role="presentation">'),o=1):o&&(a.push("</span>"),o=0),c=function(t){t=t.render(e,a),y=g.items.push(t)-1,y>0&&(t.previous=g.items[y-1],t.previous.next=t),t.toolbar=g,t.onkey=r,t.onfocus=function(){e.toolbox.focusCommandExecuted||e.focus()}},s&&(c(s),s=0),c(E)}}o&&(a.push("</span>"),s=o=0),g&&a.push('<span class="cke_toolbar_end"></span></span>')}}if(e.config.toolbarCanCollapse&&a.push("</span>"),e.config.toolbarCanCollapse&&e.elementMode!=CKEDITOR.ELEMENT_MODE_INLINE){var v=CKEDITOR.tools.addFunction(function(){e.execCommand("toolbarCollapse")});e.on("destroy",function(){CKEDITOR.tools.removeFunction(v)}),e.addCommand("toolbarCollapse",{readOnly:1,exec:function(t){var e=t.ui.space("toolbar_collapser"),n=e.getPrevious(),i=t.ui.space("contents"),o=n.getParent(),r=parseInt(i.$.style.height,10),s=o.$.offsetHeight,l=e.hasClass("cke_toolbox_collapser_min");l?(n.show(),e.removeClass("cke_toolbox_collapser_min"),e.setAttribute("title",t.lang.toolbar.toolbarCollapse)):(n.hide(),e.addClass("cke_toolbox_collapser_min"),e.setAttribute("title",t.lang.toolbar.toolbarExpand)),e.getFirst().setText(l?"":""),i.setStyle("height",r-(o.$.offsetHeight-s)+"px"),t.fire("resize")},modes:{wysiwyg:1,source:1}}),e.setKeystroke(CKEDITOR.ALT+(CKEDITOR.env.ie||CKEDITOR.env.webkit?189:109),"toolbarCollapse"),a.push('<a title="'+(l?e.lang.toolbar.toolbarCollapse:e.lang.toolbar.toolbarExpand)+'" id="'+e.ui.spaceId("toolbar_collapser")+'" tabIndex="-1" class="cke_toolbox_collapser'),l||a.push(" cke_toolbox_collapser_min"),a.push('" onclick="CKEDITOR.tools.callFunction('+v+')">','<span class="cke_arrow">&#9650;</span>',"</a>")}a.push("</span>"),i.data.html=i.data.html+a.join("")}}),e.on("destroy",function(){if(this.toolbox){var t,e,n,i,o=0;for(t=this.toolbox.toolbars;o<t.length;o++)for(n=t[o].items,e=0;e<n.length;e++)i=n[e],i.clickFn&&CKEDITOR.tools.removeFunction(i.clickFn),i.keyDownFn&&CKEDITOR.tools.removeFunction(i.keyDownFn)}}),e.on("uiReady",function(){var t=e.ui.space("toolbox");t&&e.focusManager.add(t,1)}),e.addCommand("toolbarFocus",i),e.setKeystroke(CKEDITOR.ALT+121,"toolbarFocus"),e.ui.add("-",CKEDITOR.UI_SEPARATOR,{}),e.ui.addHandler(CKEDITOR.UI_SEPARATOR,{create:function(){return{render:function(t,e){return e.push('<span class="cke_toolbar_separator" role="separator"></span>'),{}}}}})}}),CKEDITOR.ui.prototype.addToolbarGroup=function(t,n,i){var o=e(this.editor),r=0===n,s={name:t};if(i){if(i=CKEDITOR.tools.search(o,function(t){return t.name==i}))return!i.groups&&(i.groups=[]),n&&(n=CKEDITOR.tools.indexOf(i.groups,n),n>=0)?(i.groups.splice(n+1,0,t),void 0):(r?i.groups.splice(0,0,t):i.groups.push(t),void 0);n=null}n&&(n=CKEDITOR.tools.indexOf(o,function(t){return t.name==n})),r?o.splice(0,0,t):"number"==typeof n?o.splice(n+1,0,s):o.push(t)}}(),CKEDITOR.UI_SEPARATOR="separator",CKEDITOR.config.toolbarLocation="top",function(){function t(t){this.editor=t,this.reset()}CKEDITOR.plugins.add("undo",{init:function(e){function n(t){o.enabled&&t.data.command.canUndo!==!1&&o.save()}function i(){o.enabled=e.readOnly?!1:"wysiwyg"==e.mode,o.onChange()}var o=e.undoManager=new t(e),r=e.addCommand("undo",{exec:function(){o.undo()&&(e.selectionChange(),this.fire("afterUndo"))},startDisabled:!0,canUndo:!1}),s=e.addCommand("redo",{exec:function(){o.redo()&&(e.selectionChange(),this.fire("afterRedo"))},startDisabled:!0,canUndo:!1});e.setKeystroke([[CKEDITOR.CTRL+90,"undo"],[CKEDITOR.CTRL+89,"redo"],[CKEDITOR.CTRL+CKEDITOR.SHIFT+90,"redo"]]),o.onChange=function(){r.setState(o.undoable()?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED),s.setState(o.redoable()?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED)
},e.on("beforeCommandExec",n),e.on("afterCommandExec",n),e.on("saveSnapshot",function(t){o.save(t.data&&t.data.contentOnly)}),e.on("contentDom",function(){e.editable().on("keydown",function(t){t=t.data.getKey(),(8==t||46==t)&&o.type(t,0)}),e.editable().on("keypress",function(t){o.type(t.data.getKey(),1)})}),e.on("beforeModeUnload",function(){"wysiwyg"==e.mode&&o.save(!0)}),e.on("mode",i),e.on("readOnly",i),e.ui.addButton&&(e.ui.addButton("Undo",{label:e.lang.undo.undo,command:"undo",toolbar:"undo,10"}),e.ui.addButton("Redo",{label:e.lang.undo.redo,command:"redo",toolbar:"undo,20"})),e.resetUndo=function(){o.reset(),e.fire("saveSnapshot")},e.on("updateSnapshot",function(){o.currentImage&&o.update()}),e.on("lockSnapshot",function(t){o.lock(t.data&&t.data.dontUpdate)}),e.on("unlockSnapshot",o.unlock,o)}}),CKEDITOR.plugins.undo={};var e=CKEDITOR.plugins.undo.Image=function(t,e){this.editor=t,t.fire("beforeUndoImage");var n=t.getSnapshot();CKEDITOR.env.ie&&n&&(n=n.replace(/\s+data-cke-expando=".*?"/g,"")),this.contents=n,e||(this.bookmarks=(n=n&&t.getSelection())&&n.createBookmarks2(!0)),t.fire("afterUndoImage")},n=/\b(?:href|src|name)="[^"]*?"/gi;e.prototype={equalsContent:function(t){var e=this.contents,t=t.contents;return CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.ie6Compat)&&(e=e.replace(n,""),t=t.replace(n,"")),e!=t?!1:!0},equalsSelection:function(t){var e=this.bookmarks,t=t.bookmarks;if(e||t){if(!e||!t||e.length!=t.length)return!1;for(var n=0;n<e.length;n++){var i=e[n],o=t[n];if(i.startOffset!=o.startOffset||i.endOffset!=o.endOffset||!CKEDITOR.tools.arrayCompare(i.start,o.start)||!CKEDITOR.tools.arrayCompare(i.end,o.end))return!1}}return!0}},t.prototype={type:function(t,n){var i=!n&&t!=this.lastKeystroke,o=this.editor;if(!this.typing||n&&!this.wasCharacter||i){var r=new e(o),s=this.snapshots.length;CKEDITOR.tools.setTimeout(function(){var t=o.getSnapshot();CKEDITOR.env.ie&&(t=t.replace(/\s+data-cke-expando=".*?"/g,"")),r.contents!=t&&s==this.snapshots.length&&(this.typing=!0,this.save(!1,r,!1)||this.snapshots.splice(this.index+1,this.snapshots.length-this.index-1),this.hasUndo=!0,this.hasRedo=!1,this.modifiersCount=this.typesCount=1,this.onChange())},0,this)}this.lastKeystroke=t,(this.wasCharacter=n)?(this.modifiersCount=0,this.typesCount++,this.typesCount>25?(this.save(!1,null,!1),this.typesCount=1):setTimeout(function(){o.fire("change")},0)):(this.typesCount=0,this.modifiersCount++,this.modifiersCount>25?(this.save(!1,null,!1),this.modifiersCount=1):setTimeout(function(){o.fire("change")},0))},reset:function(){this.lastKeystroke=0,this.snapshots=[],this.index=-1,this.limit=this.editor.config.undoStackSize||20,this.currentImage=null,this.hasRedo=this.hasUndo=!1,this.locked=null,this.resetType()},resetType:function(){this.typing=!1,delete this.lastKeystroke,this.modifiersCount=this.typesCount=0},fireChange:function(){this.hasUndo=!!this.getNextImage(!0),this.hasRedo=!!this.getNextImage(!1),this.resetType(),this.onChange()},save:function(t,n,i){if(this.locked)return!1;var o=this.snapshots;if(n||(n=new e(this.editor)),n.contents===!1)return!1;if(this.currentImage)if(n.equalsContent(this.currentImage)){if(t||n.equalsSelection(this.currentImage))return!1}else this.editor.fire("change");return o.splice(this.index+1,o.length-this.index-1),o.length==this.limit&&o.shift(),this.index=o.push(n)-1,this.currentImage=n,i!==!1&&this.fireChange(),!0},restoreImage:function(t){var e,n=this.editor;t.bookmarks&&(n.focus(),e=n.getSelection()),this.locked=1,this.editor.loadSnapshot(t.contents),t.bookmarks?e.selectBookmarks(t.bookmarks):CKEDITOR.env.ie&&(e=this.editor.document.getBody().$.createTextRange(),e.collapse(!0),e.select()),this.locked=0,this.index=t.index,this.currentImage=this.snapshots[this.index],this.update(),this.fireChange(),n.fire("change")},getNextImage:function(t){var e,n=this.snapshots,i=this.currentImage;if(i)if(t){for(e=this.index-1;e>=0;e--)if(t=n[e],!i.equalsContent(t))return t.index=e,t}else for(e=this.index+1;e<n.length;e++)if(t=n[e],!i.equalsContent(t))return t.index=e,t;return null},redoable:function(){return this.enabled&&this.hasRedo},undoable:function(){return this.enabled&&this.hasUndo},undo:function(){if(this.undoable()){this.save(!0);var t=this.getNextImage(!0);if(t)return this.restoreImage(t),!0}return!1},redo:function(){if(this.redoable()&&(this.save(!0),this.redoable())){var t=this.getNextImage(!1);if(t)return this.restoreImage(t),!0}return!1},update:function(t){if(!this.locked){t||(t=new e(this.editor));for(var n=this.index,i=this.snapshots;n>0&&this.currentImage.equalsContent(i[n-1]);)n-=1;i.splice(n,this.index-n+1,t),this.index=n,this.currentImage=t}},lock:function(t){this.locked?this.locked.level++:t?this.locked={level:1}:(t=new e(this.editor,!0),this.locked={update:this.currentImage&&this.currentImage.equalsContent(t)?t:null,level:1})},unlock:function(){if(this.locked&&!--this.locked.level){var t=this.locked.update,n=t&&new e(this.editor,!0);this.locked=null,t&&!t.equalsContent(n)&&this.update()}}}}(),function(){function t(t){var e=this.editor,n=t.document,i=n.body;(t=n.getElementById("cke_actscrpt"))&&t.parentNode.removeChild(t),(t=n.getElementById("cke_shimscrpt"))&&t.parentNode.removeChild(t),CKEDITOR.env.gecko&&(i.contentEditable=!1,CKEDITOR.env.version<2e4&&(i.innerHTML=i.innerHTML.replace(/^.*<\!-- cke-content-start --\>/,""),setTimeout(function(){var t=new CKEDITOR.dom.range(new CKEDITOR.dom.document(n));t.setStart(new CKEDITOR.dom.node(i),0),e.getSelection().selectRanges([t])},0))),i.contentEditable=!0,CKEDITOR.env.ie&&(i.hideFocus=!0,i.disabled=!0,i.removeAttribute("disabled")),delete this._.isLoadingData,this.$=i,n=new CKEDITOR.dom.document(n),this.setup(),CKEDITOR.env.ie&&(n.getDocumentElement().addClass(n.$.compatMode),e.config.enterMode!=CKEDITOR.ENTER_P&&this.attachListener(n,"selectionchange",function(){var t=n.getBody(),i=e.getSelection(),o=i&&i.getRanges()[0];o&&t.getHtml().match(/^<p>(?:&nbsp;|<br>)<\/p>$/i)&&o.startContainer.equals(t)&&setTimeout(function(){o=e.getSelection().getRanges()[0],o.startContainer.equals("body")||(t.getFirst().remove(1),o.moveToElementEditEnd(t),o.select())},0)})),(CKEDITOR.env.webkit||CKEDITOR.env.ie&&CKEDITOR.env.version>10)&&n.getDocumentElement().on("mousedown",function(t){t.data.getTarget().is("html")&&setTimeout(function(){e.editable().focus()})});try{e.document.$.execCommand("2D-position",!1,!0)}catch(o){}try{e.document.$.execCommand("enableInlineTableEditing",!1,!e.config.disableNativeTableHandles)}catch(r){}if(e.config.disableObjectResizing)try{this.getDocument().$.execCommand("enableObjectResizing",!1,!1)}catch(s){this.attachListener(this,CKEDITOR.env.ie?"resizestart":"resize",function(t){t.data.preventDefault()})}(CKEDITOR.env.gecko||CKEDITOR.env.ie&&"CSS1Compat"==e.document.$.compatMode)&&this.attachListener(this,"keydown",function(t){var n=t.data.getKeystroke();if(33==n||34==n)if(CKEDITOR.env.ie)setTimeout(function(){e.getSelection().scrollIntoView()},0);else if(e.window.$.innerHeight>this.$.offsetHeight){var i=e.createRange();i[33==n?"moveToElementEditStart":"moveToElementEditEnd"](this),i.select(),t.data.preventDefault()}}),CKEDITOR.env.ie&&this.attachListener(n,"blur",function(){try{n.$.selection.empty()}catch(t){}}),e.document.getElementsByTag("title").getItem(0).data("cke-title",e.document.$.title),CKEDITOR.env.ie&&(e.document.$.title=this._.docTitle),CKEDITOR.tools.setTimeout(function(){e.fire("contentDom"),this._.isPendingFocus&&(e.focus(),this._.isPendingFocus=!1),setTimeout(function(){e.fire("dataReady")},0),CKEDITOR.env.ie&&setTimeout(function(){if(e.document){var t=e.document.$.body;t.runtimeStyle.marginBottom="0px",t.runtimeStyle.marginBottom=""}},1e3)},0,this)}function e(){var t=[];if(CKEDITOR.document.$.documentMode>=8){t.push("html.CSS1Compat [contenteditable=false]{min-height:0 !important}");var e,n=[];for(e in CKEDITOR.dtd.$removeEmpty)n.push("html.CSS1Compat "+e+"[contenteditable=false]");t.push(n.join(",")+"{display:inline-block}")}else CKEDITOR.env.gecko&&(t.push("html{height:100% !important}"),t.push("img:-moz-broken{-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}"));return t.push("html{cursor:text;*cursor:auto}"),t.push("img,input,textarea{cursor:default}"),t.join("\n")}CKEDITOR.plugins.add("wysiwygarea",{init:function(t){t.config.fullPage&&t.addFeature({allowedContent:"html head title; style [media,type]; body (*)[id]; meta link [*]",requiredContent:"body"}),t.addMode("wysiwyg",function(e){function i(i){i&&i.removeListener(),t.editable(new n(t,r.$.contentWindow.document.body)),t.setData(t.getData(1),e)}var o="document.open();"+(CKEDITOR.env.ie?"("+CKEDITOR.tools.fixDomain+")();":"")+"document.close();",o=CKEDITOR.env.air?"javascript:void(0)":CKEDITOR.env.ie?"javascript:void(function(){"+encodeURIComponent(o)+"}())":"",r=CKEDITOR.dom.element.createFromHtml('<iframe src="'+o+'" frameBorder="0"></iframe>');r.setStyles({width:"100%",height:"100%"}),r.addClass("cke_wysiwyg_frame cke_reset");var s=t.ui.space("contents");s.append(r),(o=CKEDITOR.env.ie||CKEDITOR.env.gecko)&&r.on("load",i);var l=t.title,a=t.lang.common.editorHelp;l&&(CKEDITOR.env.ie&&(l+=", "+a),r.setAttribute("title",l));var l=CKEDITOR.tools.getNextId(),h=CKEDITOR.dom.element.createFromHtml('<span id="'+l+'" class="cke_voice_label">'+a+"</span>");s.append(h,1),t.on("beforeModeUnload",function(t){t.removeListener(),h.remove()}),r.setAttributes({"aria-describedby":l,tabIndex:t.tabIndex,allowTransparency:"true"}),!o&&i(),CKEDITOR.env.webkit&&(o=function(){s.setStyle("width","100%"),r.hide(),r.setSize("width",s.getSize("width")),s.removeStyle("width"),r.show()},r.setCustomData("onResize",o),CKEDITOR.document.getWindow().on("resize",o)),t.fire("ariaWidget",r)})}});var n=CKEDITOR.tools.createClass({$:function(){this.base.apply(this,arguments),this._.frameLoadedHandler=CKEDITOR.tools.addFunction(function(e){CKEDITOR.tools.setTimeout(t,0,this,e)},this),this._.docTitle=this.getWindow().getFrame().getAttribute("title")},base:CKEDITOR.editable,proto:{setData:function(t,n){var i=this.editor;if(n)this.setHtml(t),i.fire("dataReady");else{this._.isLoadingData=!0,i._.dataStore={id:1};var o=i.config,r=o.fullPage,s=o.docType,l=CKEDITOR.tools.buildStyleHtml(e()).replace(/<style>/,'<style data-cke-temp="1">');r||(l+=CKEDITOR.tools.buildStyleHtml(i.config.contentsCss));var a=o.baseHref?'<base href="'+o.baseHref+'" data-cke-temp="1" />':"";r&&(t=t.replace(/<!DOCTYPE[^>]*>/i,function(t){return i.docType=s=t,""}).replace(/<\?xml\s[^\?]*\?>/i,function(t){return i.xmlDeclaration=t,""})),t=i.dataProcessor.toHtml(t),r?(/<body[\s|>]/.test(t)||(t="<body>"+t),/<html[\s|>]/.test(t)||(t="<html>"+t+"</html>"),/<head[\s|>]/.test(t)?/<title[\s|>]/.test(t)||(t=t.replace(/<head[^>]*>/,"$&<title></title>")):t=t.replace(/<html[^>]*>/,"$&<head><title></title></head>"),a&&(t=t.replace(/<head>/,"$&"+a)),t=t.replace(/<\/head\s*>/,l+"$&"),t=s+t):t=o.docType+'<html dir="'+o.contentsLangDirection+'" lang="'+(o.contentsLanguage||i.langCode)+'"><head><title>'+this._.docTitle+"</title>"+a+l+"</head><body"+(o.bodyId?' id="'+o.bodyId+'"':"")+(o.bodyClass?' class="'+o.bodyClass+'"':"")+">"+t+"</body></html>",CKEDITOR.env.gecko&&(t=t.replace(/<body/,'<body contenteditable="true" '),CKEDITOR.env.version<2e4&&(t=t.replace(/<body[^>]*>/,"$&<!-- cke-content-start -->"))),o='<script id="cke_actscrpt" type="text/javascript"'+(CKEDITOR.env.ie?' defer="defer" ':"")+">var wasLoaded=0;function onload(){if(!wasLoaded)window.parent.CKEDITOR.tools.callFunction("+this._.frameLoadedHandler+",window);wasLoaded=1;}"+(CKEDITOR.env.ie?"onload();":'document.addEventListener("DOMContentLoaded", onload, false );')+"</script>",CKEDITOR.env.ie&&CKEDITOR.env.version<9&&(o+='<script id="cke_shimscrpt">window.parent.CKEDITOR.tools.enableHtml5Elements(document)</script>'),t=t.replace(/(?=\s*<\/(:?head)>)/,o),this.clearCustomData(),this.clearListeners(),i.fire("contentDomUnload");var h=this.getDocument();try{h.write(t)}catch(d){setTimeout(function(){h.write(t)},0)}}},getData:function(t){if(t)return this.getHtml();var t=this.editor,e=t.config,n=e.fullPage,i=n&&t.docType,o=n&&t.xmlDeclaration,r=this.getDocument(),n=n?r.getDocumentElement().getOuterHtml():r.getBody().getHtml();return CKEDITOR.env.gecko&&e.enterMode!=CKEDITOR.ENTER_BR&&(n=n.replace(/<br>(?=\s*(:?$|<\/body>))/,"")),n=t.dataProcessor.toDataFormat(n),o&&(n=o+"\n"+n),i&&(n=i+"\n"+n),n},focus:function(){this._.isLoadingData?this._.isPendingFocus=!0:n.baseProto.focus.call(this)},detach:function(){var t=this.editor,e=t.document,t=t.window.getFrame();n.baseProto.detach.call(this),this.clearCustomData(),e.getDocumentElement().clearCustomData(),t.clearCustomData(),CKEDITOR.tools.removeFunction(this._.frameLoadedHandler),(e=t.removeCustomData("onResize"))&&e.removeListener(),t.remove()}}})}(),CKEDITOR.config.disableObjectResizing=!1,CKEDITOR.config.disableNativeTableHandles=!0,CKEDITOR.config.disableNativeSpellChecker=!0,CKEDITOR.config.contentsCss=CKEDITOR.getUrl("contents.css"),CKEDITOR.config.plugins="dialogui,dialog,a11yhelp,about,basicstyles,blockquote,clipboard,panel,floatpanel,menu,contextmenu,dialogadvtab,div,elementspath,enterkey,entities,popup,filebrowser,find,fakeobjects,flash,floatingspace,listblock,button,richcombo,font,format,forms,horizontalrule,htmlwriter,iframe,image,indent,indentlist,indentblock,justify,link,list,liststyle,magicline,maximize,newpage,pagebreak,pastefromword,pastetext,preview,print,removeformat,resize,save,selectall,showblocks,showborders,smiley,sourcearea,specialchar,stylescombo,tab,table,tabletools,templates,toolbar,undo,wysiwygarea",CKEDITOR.config.skin="moono",function(){var t=function(t,e){for(var n=CKEDITOR.getUrl("plugins/"+e),t=t.split(","),i=0;i<t.length;i++)CKEDITOR.skin.icons[t[i]]={path:n,offset:-t[++i],bgsize:t[++i]}};CKEDITOR.env.hidpi?t("about,0,,bold,24,,italic,48,,strike,72,,subscript,96,,superscript,120,,underline,144,,bidiltr,168,,bidirtl,192,,blockquote,216,,copy-rtl,240,,copy,264,,cut-rtl,288,,cut,312,,paste-rtl,336,,paste,360,,bgcolor,384,,textcolor,408,,creatediv,432,,docprops-rtl,456,,docprops,480,,find-rtl,504,,find,528,,replace,552,,flash,576,,button,600,,checkbox,624,,form,648,,hiddenfield,672,,imagebutton,696,,radio,720,,select-rtl,744,,select,768,,textarea-rtl,792,,textarea,816,,textfield-rtl,840,,textfield,864,,horizontalrule,888,,iframe,912,,image,936,,indent-rtl,960,,indent,984,,outdent-rtl,1008,,outdent,1032,,justifyblock,1056,,justifycenter,1080,,justifyleft,1104,,justifyright,1128,,language,1152,,anchor-rtl,1176,,anchor,1200,,link,1224,,unlink,1248,,bulletedlist-rtl,1272,,bulletedlist,1296,,numberedlist-rtl,1320,,numberedlist,1344,,mathjax,1368,,maximize,1392,,newpage-rtl,1416,,newpage,1440,,pagebreak-rtl,1464,,pagebreak,1488,,pastefromword-rtl,1512,,pastefromword,1536,,pastetext-rtl,1560,,pastetext,1584,,placeholder,1608,,preview-rtl,1632,,preview,1656,,print,1680,,removeformat,1704,,save,1728,,selectall,1752,,showblocks-rtl,1776,,showblocks,1800,,smiley,1824,,source-rtl,1848,,source,1872,,sourcedialog-rtl,1896,,sourcedialog,1920,,specialchar,1944,,table,1968,,templates-rtl,1992,,templates,2016,,uicolor,2040,,redo-rtl,2064,,redo,2088,,undo-rtl,2112,,undo,2136,","icons_hidpi.png"):t("about,0,auto,bold,24,auto,italic,48,auto,strike,72,auto,subscript,96,auto,superscript,120,auto,underline,144,auto,bidiltr,168,auto,bidirtl,192,auto,blockquote,216,auto,copy-rtl,240,auto,copy,264,auto,cut-rtl,288,auto,cut,312,auto,paste-rtl,336,auto,paste,360,auto,bgcolor,384,auto,textcolor,408,auto,creatediv,432,auto,docprops-rtl,456,auto,docprops,480,auto,find-rtl,504,auto,find,528,auto,replace,552,auto,flash,576,auto,button,600,auto,checkbox,624,auto,form,648,auto,hiddenfield,672,auto,imagebutton,696,auto,radio,720,auto,select-rtl,744,auto,select,768,auto,textarea-rtl,792,auto,textarea,816,auto,textfield-rtl,840,auto,textfield,864,auto,horizontalrule,888,auto,iframe,912,auto,image,936,auto,indent-rtl,960,auto,indent,984,auto,outdent-rtl,1008,auto,outdent,1032,auto,justifyblock,1056,auto,justifycenter,1080,auto,justifyleft,1104,auto,justifyright,1128,auto,language,1152,auto,anchor-rtl,1176,auto,anchor,1200,auto,link,1224,auto,unlink,1248,auto,bulletedlist-rtl,1272,auto,bulletedlist,1296,auto,numberedlist-rtl,1320,auto,numberedlist,1344,auto,mathjax,1368,auto,maximize,1392,auto,newpage-rtl,1416,auto,newpage,1440,auto,pagebreak-rtl,1464,auto,pagebreak,1488,auto,pastefromword-rtl,1512,auto,pastefromword,1536,auto,pastetext-rtl,1560,auto,pastetext,1584,auto,placeholder,1608,auto,preview-rtl,1632,auto,preview,1656,auto,print,1680,auto,removeformat,1704,auto,save,1728,auto,selectall,1752,auto,showblocks-rtl,1776,auto,showblocks,1800,auto,smiley,1824,auto,source-rtl,1848,auto,source,1872,auto,sourcedialog-rtl,1896,auto,sourcedialog,1920,auto,specialchar,1944,auto,table,1968,auto,templates-rtl,1992,auto,templates,2016,auto,uicolor,2040,auto,redo-rtl,2064,auto,redo,2088,auto,undo-rtl,2112,auto,undo,2136,auto","icons.png")}())}(),/*
 Copyright (c) 2003-2014, CKSource - Frederico Knabben. All rights reserved.
 For licensing, see LICENSE.md or http://ckeditor.com/license
*/
function(t){CKEDITOR.config.jqueryOverrideVal="undefined"==typeof CKEDITOR.config.jqueryOverrideVal?!0:CKEDITOR.config.jqueryOverrideVal,"undefined"!=typeof t&&(t.extend(t.fn,{ckeditorGet:function(){var t=this.eq(0).data("ckeditorInstance");if(!t)throw"CKEditor is not initialized yet, use ckeditor() with a callback.";return t},ckeditor:function(e,n){if(!CKEDITOR.env.isCompatible)throw Error("The environment is incompatible.");if(!t.isFunction(e))var i=n,n=e,e=i;var o=[],n=n||{};this.each(function(){var i=t(this),r=i.data("ckeditorInstance"),s=i.data("_ckeditorInstanceLock"),l=this,a=new t.Deferred;o.push(a.promise()),r&&!s?(e&&e.apply(r,[this]),a.resolve()):s?r.once("instanceReady",function(){setTimeout(function(){r.element?(r.element.$==l&&e&&e.apply(r,[l]),a.resolve()):setTimeout(arguments.callee,100)},0)},null,null,9999):((n.autoUpdateElement||"undefined"==typeof n.autoUpdateElement&&CKEDITOR.config.autoUpdateElement)&&(n.autoUpdateElementJquery=!0),n.autoUpdateElement=!1,i.data("_ckeditorInstanceLock",!0),r=t(this).is("textarea")?CKEDITOR.replace(l,n):CKEDITOR.inline(l,n),i.data("ckeditorInstance",r),r.on("instanceReady",function(n){var o=n.editor;setTimeout(function(){if(o.element){if(n.removeListener(),o.on("dataReady",function(){i.trigger("dataReady.ckeditor",[o])}),o.on("setData",function(t){i.trigger("setData.ckeditor",[o,t.data])}),o.on("getData",function(t){i.trigger("getData.ckeditor",[o,t.data])},999),o.on("destroy",function(){i.trigger("destroy.ckeditor",[o])}),o.on("save",function(){return t(l.form).submit(),!1},null,null,20),o.config.autoUpdateElementJquery&&i.is("textarea")&&t(l.form).length){var r=function(){i.ckeditor(function(){o.updateElement()})};t(l.form).submit(r),t(l.form).bind("form-pre-serialize",r),i.bind("destroy.ckeditor",function(){t(l.form).unbind("submit",r),t(l.form).unbind("form-pre-serialize",r)})}o.on("destroy",function(){i.removeData("ckeditorInstance")}),i.removeData("_ckeditorInstanceLock"),i.trigger("instanceReady.ckeditor",[o]),e&&e.apply(o,[l]),a.resolve()}else setTimeout(arguments.callee,100)},0)},null,null,9999))});var r=new t.Deferred;return this.promise=r.promise(),t.when.apply(this,o).then(function(){r.resolve()}),this.editor=this.eq(0).data("ckeditorInstance"),this}}),CKEDITOR.config.jqueryOverrideVal&&(t.fn.val=CKEDITOR.tools.override(t.fn.val,function(e){return function(n){if(arguments.length){var i=this,o=[],r=this.each(function(){var i=t(this),r=i.data("ckeditorInstance");if(i.is("textarea")&&r){var s=new t.Deferred;return r.setData(n,function(){s.resolve()}),o.push(s.promise()),!0}return e.call(i,n)});if(o.length){var s=new t.Deferred;return t.when.apply(this,o).done(function(){s.resolveWith(i)}),s.promise()}return r}var r=t(this).eq(0),l=r.data("ckeditorInstance");return r.is("textarea")&&l?l.getData():e.call(r)}})))}(window.jQuery);var MAX_REQUEST_SIZE=10485760,MAX_AREA=1e8;window.remove_editor=0;var RESOURCES_PATH="/assets/mxGraph/resources",RESOURCE_BASE=RESOURCES_PATH+"/grapheditor",STENCIL_PATH="/assets/mxGraph/stencils",IMAGE_PATH="/assets/mxGraph/images",STYLE_PATH="/assets/mxGraph/styles",CSS_PATH="/assets/mxGraph/styles",tapAndHoldStartsConnection=!0,showConnectorImg=!0,urlParams=function(t){var e=new Object,n=t.lastIndexOf("?");if(n>0)for(var i=t.substring(n+1).split("&"),o=0;o<i.length;o++)n=i[o].indexOf("="),n>0&&(e[i[o].substring(0,n)]=i[o].substring(n+1));return e}(window.location.href);mxLoadResources=!1,mxBasePath="/assets/mxGraph/src",mxLanguage=urlParams.lang,mxLanguages=["de"];var mxClient={VERSION:"2.0.0.1",IS_IE:0<=navigator.userAgent.indexOf("MSIE"),IS_IE6:0<=navigator.userAgent.indexOf("MSIE 6"),IS_QUIRKS:0<=navigator.userAgent.indexOf("MSIE")&&(null==document.documentMode||5==document.documentMode),VML_PREFIX:"v",OFFICE_PREFIX:"o",IS_NS:0<=navigator.userAgent.indexOf("Mozilla/")&&0>navigator.userAgent.indexOf("MSIE"),IS_OP:0<=navigator.userAgent.indexOf("Opera/"),IS_OT:0>navigator.userAgent.indexOf("Presto/2.4.")&&0>navigator.userAgent.indexOf("Presto/2.3.")&&0>navigator.userAgent.indexOf("Presto/2.2.")&&0>navigator.userAgent.indexOf("Presto/2.1.")&&0>navigator.userAgent.indexOf("Presto/2.0.")&&0>navigator.userAgent.indexOf("Presto/1."),IS_SF:0<=navigator.userAgent.indexOf("AppleWebKit/")&&0>navigator.userAgent.indexOf("Chrome/"),IS_GC:0<=navigator.userAgent.indexOf("Chrome/"),IS_MT:0<=navigator.userAgent.indexOf("Firefox/")&&0>navigator.userAgent.indexOf("Firefox/1.")&&0>navigator.userAgent.indexOf("Firefox/2.")||0<=navigator.userAgent.indexOf("Iceweasel/")&&0>navigator.userAgent.indexOf("Iceweasel/1.")&&0>navigator.userAgent.indexOf("Iceweasel/2.")||0<=navigator.userAgent.indexOf("SeaMonkey/")&&0>navigator.userAgent.indexOf("SeaMonkey/1.")||0<=navigator.userAgent.indexOf("Iceape/")&&0>navigator.userAgent.indexOf("Iceape/1."),IS_SVG:0<=navigator.userAgent.indexOf("Firefox/")||0<=navigator.userAgent.indexOf("Iceweasel/")||0<=navigator.userAgent.indexOf("Seamonkey/")||0<=navigator.userAgent.indexOf("Iceape/")||0<=navigator.userAgent.indexOf("Galeon/")||0<=navigator.userAgent.indexOf("Epiphany/")||0<=navigator.userAgent.indexOf("AppleWebKit/")||0<=navigator.userAgent.indexOf("Gecko/")||0<=navigator.userAgent.indexOf("Opera/"),NO_FO:!document.createElementNS||"[object SVGForeignObjectElement]"!=document.createElementNS("http://www.w3.org/2000/svg","foreignObject")||0<=navigator.userAgent.indexOf("Opera/"),IS_VML:"MICROSOFT INTERNET EXPLORER"==navigator.appName.toUpperCase(),IS_MAC:0<navigator.userAgent.toUpperCase().indexOf("MACINTOSH"),IS_TOUCH:"ontouchstart"in document.documentElement,IS_POINTER:window.navigator.msPointerEnabled,IS_LOCAL:0>document.location.href.indexOf("http://")&&0>document.location.href.indexOf("https://"),isBrowserSupported:function(){return mxClient.IS_VML||mxClient.IS_SVG},link:function(t,e,n){if(n=n||document,mxClient.IS_IE6)n.write('<link rel="'+t+'" href="'+e+'" charset="ISO-8859-1" type="text/css"/>');else{var i=n.createElement("link");i.setAttribute("rel",t),i.setAttribute("href",e),i.setAttribute("charset","ISO-8859-1"),i.setAttribute("type","text/css"),n.getElementsByTagName("head")[0].appendChild(i)}},include:function(t){document.write('<script src="'+t+'"></script>')},dispose:function(){for(var t=0;t<mxEvent.objects.length;t++)null!=mxEvent.objects[t].mxListenerList&&mxEvent.removeAllListeners(mxEvent.objects[t])}};if(mxClient.IS_OP&&mxClient.IS_OT?mxClient.CSS_PREFIX="O":mxClient.IS_SF||mxClient.IS_GC?mxClient.CSS_PREFIX="Webkit":mxClient.IS_MT?mxClient.CSS_PREFIX="Moz":mxClient.IS_IE&&9<=document.documentMode&&(mxClient.CSS_PREFIX="ms"),"undefined"==typeof mxLoadResources&&(mxLoadResources=!0),"undefined"==typeof mxResourceExtension&&(mxResourceExtension=".txt"),"undefined"==typeof mxLoadStylesheets&&(mxLoadStylesheets=!0),"undefined"!=typeof mxBasePath&&0<mxBasePath.length?("/"==mxBasePath.substring(mxBasePath.length-1)&&(mxBasePath=mxBasePath.substring(0,mxBasePath.length-1)),mxClient.basePath=mxBasePath):mxClient.basePath=".","undefined"!=typeof mxImageBasePath&&0<mxImageBasePath.length?("/"==mxImageBasePath.substring(mxImageBasePath.length-1)&&(mxImageBasePath=mxImageBasePath.substring(0,mxImageBasePath.length-1)),mxClient.imageBasePath=mxImageBasePath):mxClient.imageBasePath=mxClient.basePath+"/images",mxClient.language="undefined"!=typeof mxLanguage&&null!=mxLanguage?mxLanguage:mxClient.IS_IE?navigator.userLanguage:navigator.language,mxClient.defaultLanguage="undefined"!=typeof mxDefaultLanguage&&null!=mxDefaultLanguage?mxDefaultLanguage:"en",mxLoadStylesheets&&mxClient.link("stylesheet",mxClient.basePath+"/css/common.css"),"undefined"!=typeof mxLanguages&&null!=mxLanguages&&(mxClient.languages=mxLanguages),mxClient.IS_IE){if(9<=document.documentMode)mxClient.IS_VML=!1,mxClient.IS_SVG=!0;else{8==document.documentMode?(document.namespaces.add(mxClient.VML_PREFIX,"urn:schemas-microsoft-com:vml","#default#VML"),document.namespaces.add(mxClient.OFFICE_PREFIX,"urn:schemas-microsoft-com:office:office","#default#VML")):(document.namespaces.add(mxClient.VML_PREFIX,"urn:schemas-microsoft-com:vml"),document.namespaces.add(mxClient.OFFICE_PREFIX,"urn:schemas-microsoft-com:office:office"));var ss=document.createStyleSheet();ss.cssText=mxClient.VML_PREFIX+"\\:*{behavior:url(#default#VML)}"+mxClient.OFFICE_PREFIX+"\\:*{behavior:url(#default#VML)}",mxLoadStylesheets&&mxClient.link("stylesheet",mxClient.basePath+"/css/explorer.css")}window.attachEvent("onunload",mxClient.dispose)}var mxLog={consoleName:"Console",TRACE:!1,DEBUG:!0,WARN:!0,buffer:"",init:function(){if(null==mxLog.window&&null!=document.body){var t=mxLog.consoleName+" - mxGraph "+mxClient.VERSION,e=document.createElement("table");e.setAttribute("width","100%"),e.setAttribute("height","100%");var n=document.createElement("tbody"),i=document.createElement("tr"),o=document.createElement("td");if(o.style.verticalAlign="top",mxLog.textarea=document.createElement("textarea"),mxLog.textarea.setAttribute("readOnly","true"),mxLog.textarea.style.height="100%",mxLog.textarea.style.resize="none",mxLog.textarea.value=mxLog.buffer,mxLog.textarea.style.width=mxClient.IS_NS&&"BackCompat"!=document.compatMode?"99%":"100%",o.appendChild(mxLog.textarea),i.appendChild(o),n.appendChild(i),i=document.createElement("tr"),mxLog.td=document.createElement("td"),mxLog.td.style.verticalAlign="top",mxLog.td.setAttribute("height","30px"),i.appendChild(mxLog.td),n.appendChild(i),e.appendChild(n),mxLog.addButton("Info",function(){mxLog.info()}),mxLog.addButton("DOM",function(t){t=mxUtils.getInnerHtml(document.body),mxLog.debug(t)}),mxLog.addButton("Trace",function(){mxLog.TRACE=!mxLog.TRACE,mxLog.TRACE?mxLog.debug("Tracing enabled"):mxLog.debug("Tracing disabled")}),mxLog.addButton("Copy",function(){try{mxUtils.copy(mxLog.textarea.value)}catch(t){mxUtils.alert(t)}}),mxLog.addButton("Show",function(){try{mxUtils.popup(mxLog.textarea.value)}catch(t){mxUtils.alert(t)}}),mxLog.addButton("Clear",function(){mxLog.textarea.value=""}),i=n=0,"number"==typeof window.innerWidth?(n=window.innerHeight,i=window.innerWidth):(n=document.documentElement.clientHeight||document.body.clientHeight,i=document.body.clientWidth),mxLog.window=new mxWindow(t,e,Math.max(0,i-320),Math.max(0,n-210),300,160),mxLog.window.setMaximizable(!0),mxLog.window.setScrollable(!1),mxLog.window.setResizable(!0),mxLog.window.setClosable(!0),mxLog.window.destroyOnClose=!1,(mxClient.IS_NS||mxClient.IS_IE)&&!mxClient.IS_GC&&!mxClient.IS_SF&&"BackCompat"!=document.compatMode){var r=mxLog.window.getElement(),t=function(){mxLog.textarea.style.height=Math.max(0,r.offsetHeight-70)+"px"};mxLog.window.addListener(mxEvent.RESIZE_END,t),mxLog.window.addListener(mxEvent.MAXIMIZE,t),mxLog.window.addListener(mxEvent.NORMALIZE,t),mxLog.textarea.style.height="92px"}}},info:function(){mxLog.writeln(mxUtils.toString(navigator))},addButton:function(t,e){var n=document.createElement("button");mxUtils.write(n,t),mxEvent.addListener(n,"click",e),mxLog.td.appendChild(n)},isVisible:function(){return null!=mxLog.window?mxLog.window.isVisible():!1},show:function(){mxLog.setVisible(!0)},setVisible:function(t){null==mxLog.window&&mxLog.init(),null!=mxLog.window&&mxLog.window.setVisible(t)},enter:function(t){return mxLog.TRACE?(mxLog.writeln("Entering "+t),(new Date).getTime()):void 0},leave:function(t,e){if(mxLog.TRACE){var n=0!=e?" ("+((new Date).getTime()-e)+" ms)":"";mxLog.writeln("Leaving "+t+n)}},debug:function(){mxLog.DEBUG&&mxLog.writeln.apply(this,arguments)},warn:function(){mxLog.WARN&&mxLog.writeln.apply(this,arguments)},write:function(){for(var t="",e=0;e<arguments.length;e++)t+=arguments[e],e<arguments.length-1&&(t+=" ");null!=mxLog.textarea?(mxLog.textarea.value+=t,0<=navigator.userAgent.indexOf("Presto/2.5")&&(mxLog.textarea.style.visibility="hidden",mxLog.textarea.style.visibility="visible"),mxLog.textarea.scrollTop=mxLog.textarea.scrollHeight):mxLog.buffer+=t},writeln:function(){for(var t="",e=0;e<arguments.length;e++)t+=arguments[e],e<arguments.length-1&&(t+=" ");mxLog.write(t+"\n")}},mxObjectIdentity={FIELD_NAME:"mxObjectId",counter:0,get:function(t){if("object"==typeof t&&null==t[mxObjectIdentity.FIELD_NAME]){var e=mxUtils.getFunctionName(t.constructor);t[mxObjectIdentity.FIELD_NAME]=e+"#"+mxObjectIdentity.counter++}return t[mxObjectIdentity.FIELD_NAME]},clear:function(t){"object"==typeof t&&delete t[mxObjectIdentity.FIELD_NAME]}};mxDictionary.prototype.map=null,mxDictionary.prototype.clear=function(){this.map={}},mxDictionary.prototype.get=function(t){return t=mxObjectIdentity.get(t),this.map[t]},mxDictionary.prototype.put=function(t,e){var n=mxObjectIdentity.get(t),i=this.map[n];return this.map[n]=e,i},mxDictionary.prototype.remove=function(t){t=mxObjectIdentity.get(t);var e=this.map[t];return delete this.map[t],e},mxDictionary.prototype.getKeys=function(){var t,e=[];for(t in this.map)e.push(t);return e},mxDictionary.prototype.getValues=function(){var t,e=[];for(t in this.map)e.push(this.map[t]);return e},mxDictionary.prototype.visit=function(t){for(var e in this.map)t(e,this.map[e])};var mxResources={resources:[],extension:mxResourceExtension,resourcesEncoded:!1,loadDefaultBundle:!0,loadSpecialBundle:!0,isLanguageSupported:function(t){return null!=mxClient.languages?0<=mxUtils.indexOf(mxClient.languages,t):!0},getDefaultBundle:function(t,e){return mxResources.loadDefaultBundle||!mxResources.isLanguageSupported(e)?t+mxResources.extension:null},getSpecialBundle:function(t,e){if(null==mxClient.languages||!this.isLanguageSupported(e)){var n=e.indexOf("-");n>0&&(e=e.substring(0,n))}return mxResources.loadSpecialBundle&&mxResources.isLanguageSupported(e)&&e!=mxClient.defaultLanguage?t+"_"+e+mxResources.extension:null},add:function(t,e){if(e=null!=e?e:mxClient.language.toLowerCase(),e!=mxConstants.NONE){var n=mxResources.getDefaultBundle(t,e);if(null!=n)try{var i=mxUtils.load(n);i.isReady()&&mxResources.parse(i.getText())}catch(o){}if(n=mxResources.getSpecialBundle(t,e),null!=n)try{i=mxUtils.load(n),i.isReady()&&mxResources.parse(i.getText())}catch(r){}}},parse:function(t){if(null!=t){t=t.split("\n");for(var e=0;e<t.length;e++)if("#"!=t[e].charAt(0)){var n=t[e].indexOf("=");if(n>0){var i=t[e].substring(0,n),o=t[e].length;13==t[e].charCodeAt(o-1)&&o--,n=t[e].substring(n+1,o),this.resourcesEncoded?(n=n.replace(/\\(?=u[a-fA-F\d]{4})/g,"%"),mxResources.resources[i]=unescape(n)):mxResources.resources[i]=n}}}},get:function(t,e,n){if(t=mxResources.resources[t],null==t&&(t=n),null!=t&&null!=e){n=[];for(var i=null,o=0;o<t.length;o++){var r=t.charAt(o);"{"==r?i="":null!=i&&"}"==r?(i=parseInt(i)-1,i>=0&&i<e.length&&n.push(e[i]),i=null):null!=i?i+=r:n.push(r)}t=n.join("")}return t}};mxPoint.prototype.x=null,mxPoint.prototype.y=null,mxPoint.prototype.equals=function(t){return t.x==this.x&&t.y==this.y},mxPoint.prototype.clone=function(){return mxUtils.clone(this)},mxRectangle.prototype=new mxPoint,mxRectangle.prototype.constructor=mxRectangle,mxRectangle.prototype.width=null,mxRectangle.prototype.height=null,mxRectangle.prototype.setRect=function(t,e,n,i){this.x=t,this.y=e,this.width=n,this.height=i},mxRectangle.prototype.getCenterX=function(){return this.x+this.width/2},mxRectangle.prototype.getCenterY=function(){return this.y+this.height/2},mxRectangle.prototype.add=function(t){if(null!=t){var e=Math.min(this.x,t.x),n=Math.min(this.y,t.y),i=Math.max(this.x+this.width,t.x+t.width);t=Math.max(this.y+this.height,t.y+t.height),this.x=e,this.y=n,this.width=i-e,this.height=t-n}},mxRectangle.prototype.grow=function(t){this.x-=t,this.y-=t,this.width+=2*t,this.height+=2*t},mxRectangle.prototype.getPoint=function(){return new mxPoint(this.x,this.y)},mxRectangle.prototype.equals=function(t){return t.x==this.x&&t.y==this.y&&t.width==this.width&&t.height==this.height};var mxEffects={animateChanges:function(t,e,n){var i=0,o=function(){for(var s=!1,l=0;l<e.length;l++){var a=e[l];if(a instanceof mxGeometryChange||a instanceof mxTerminalChange||a instanceof mxValueChange||a instanceof mxChildChange||a instanceof mxStyleChange){var h=t.getView().getState(a.cell||a.child,!1);if(null!=h)if(s=!0,a.constructor!=mxGeometryChange||t.model.isEdge(a.cell))mxUtils.setOpacity(h.shape.node,100*i/10);else{var d=t.getView().scale,u=(a.geometry.x-a.previous.x)*d,c=(a.geometry.y-a.previous.y)*d,p=(a.geometry.width-a.previous.width)*d,d=(a.geometry.height-a.previous.height)*d;0==i?(h.x-=u,h.y-=c,h.width-=p,h.height-=d):(h.x+=u/10,h.y+=c/10,h.width+=p/10,h.height+=d/10),t.cellRenderer.redraw(h),mxEffects.cascadeOpacity(t,a.cell,100*i/10)}}}10>i&&s?(i++,window.setTimeout(o,r)):null!=n&&n()},r=30;o()},cascadeOpacity:function(t,e,n){for(var i=t.model.getChildCount(e),o=0;i>o;o++){var r=t.model.getChildAt(e,o),s=t.getView().getState(r);null!=s&&(mxUtils.setOpacity(s.shape.node,n),mxEffects.cascadeOpacity(t,r,n))}if(e=t.model.getEdges(e),null!=e)for(o=0;o<e.length;o++)i=t.getView().getState(e[o]),null!=i&&mxUtils.setOpacity(i.shape.node,n)},fadeOut:function(t,e,n,i,o,r){i=i||40,o=o||30;var s=e||100;if(mxUtils.setOpacity(t,s),r||null==r){var l=function(){s=Math.max(s-i,0),mxUtils.setOpacity(t,s),s>0?window.setTimeout(l,o):(t.style.visibility="hidden",n&&t.parentNode&&t.parentNode.removeChild(t))};window.setTimeout(l,o)}else t.style.visibility="hidden",n&&t.parentNode&&t.parentNode.removeChild(t)}},mxUtils={errorResource:"none"!=mxClient.language?"error":"",closeResource:"none"!=mxClient.language?"close":"",errorImage:mxClient.imageBasePath+"/error.gif",removeCursors:function(t){if(null!=t.style&&(t.style.cursor=""),t=t.childNodes,null!=t)for(var e=t.length,n=0;e>n;n+=1)mxUtils.removeCursors(t[n])},getCurrentStyle:function(){return mxClient.IS_IE?function(t){return null!=t?t.currentStyle:null}:function(t){return null!=t?window.getComputedStyle(t,""):null}}(),hasScrollbars:function(t){return t=mxUtils.getCurrentStyle(t),null!=t&&("scroll"==t.overflow||"auto"==t.overflow)},bind:function(t,e){return function(){return e.apply(t,arguments)}},eval:function(a){var b=null;if(0<=a.indexOf("function"))try{eval("var _mxJavaScriptExpression="+a),b=_mxJavaScriptExpression,_mxJavaScriptExpression=null}catch(c){mxLog.warn(c.message+" while evaluating "+a)}else try{b=eval(a)}catch(d){mxLog.warn(d.message+" while evaluating "+a)}return b},findNode:function(t,e,n){var i=t.getAttribute(e);if(null!=i&&i==n)return t;for(t=t.firstChild;null!=t;){if(i=mxUtils.findNode(t,e,n),null!=i)return i;t=t.nextSibling}return null},findNodeByAttribute:function(){return 9<=document.documentMode?function(t,e,n){var i=null;if(null!=t)if(t.nodeType==mxConstants.NODETYPE_ELEMENT&&t.getAttribute(e)==n)i=t;else for(t=t.firstChild;null!=t&&null==i;)i=mxUtils.findNodeByAttribute(t,e,n),t=t.nextSibling;return i}:mxClient.IS_IE?function(t,e,n){return null==t?null:t.ownerDocument.selectSingleNode("//*[@"+e+"='"+n+"']")}:function(t,e,n){return null==t?null:t.ownerDocument.evaluate("//*[@"+e+"='"+n+"']",t.ownerDocument,null,XPathResult.ANY_TYPE,null).iterateNext()}}(),getFunctionName:function(t){var e=null;if(null!=t)if(null!=t.name)e=t.name;else{for(t=t.toString(),e=9;" "==t.charAt(e);)e++;var n=t.indexOf("(",e),e=t.substring(e,n)}return e},indexOf:function(t,e){if(null!=t&&null!=e)for(var n=0;n<t.length;n++)if(t[n]==e)return n;return-1},remove:function(t,e){var n=null;if("object"==typeof e)for(var i=mxUtils.indexOf(e,t);i>=0;)e.splice(i,1),n=t,i=mxUtils.indexOf(e,t);for(var o in e)e[o]==t&&(delete e[o],n=t);return n},isNode:function(t,e,n,i){return null==t||isNaN(t.nodeType)||null!=e&&t.nodeName.toLowerCase()!=e.toLowerCase()?!1:null==n||t.getAttribute(n)==i},getChildNodes:function(t,e){e=e||mxConstants.NODETYPE_ELEMENT;for(var n=[],i=t.firstChild;null!=i;)i.nodeType==e&&n.push(i),i=i.nextSibling;return n},createXmlDocument:function(){var t=null;return document.implementation&&document.implementation.createDocument?t=document.implementation.createDocument("","",null):window.ActiveXObject&&(t=new ActiveXObject("Microsoft.XMLDOM")),t},parseXml:function(){return mxClient.IS_IE&&("undefined"==typeof document.documentMode||9>document.documentMode)?function(t){var e=mxUtils.createXmlDocument();return e.async="false",e.loadXML(t),e}:function(t){return(new DOMParser).parseFromString(t,"text/xml")}}(),clearSelection:function(){return document.selection?function(){document.selection.empty()}:window.getSelection?function(){window.getSelection().removeAllRanges()}:void 0}(),getPrettyXml:function(t,e,n){var i=[];if(null!=t)if(e=e||"  ",n=n||"",t.nodeType==mxConstants.NODETYPE_TEXT)i.push(t.nodeValue);else{i.push(n+"<"+t.nodeName);var o=t.attributes;if(null!=o)for(var r=0;r<o.length;r++){var s=mxUtils.htmlEntities(o[r].nodeValue);i.push(" "+o[r].nodeName+'="'+s+'"')}if(o=t.firstChild,null!=o){for(i.push(">\n");null!=o;)i.push(mxUtils.getPrettyXml(o,e,n+e)),o=o.nextSibling;i.push(n+"</"+t.nodeName+">\n")}else i.push("/>\n")}return i.join("")},removeWhitespace:function(t,e){for(var n=e?t.previousSibling:t.nextSibling;null!=n&&n.nodeType==mxConstants.NODETYPE_TEXT;){var i=e?n.previousSibling:n.nextSibling,o=mxUtils.getTextContent(n);0==mxUtils.trim(o).length&&n.parentNode.removeChild(n),n=i}},htmlEntities:function(t,e){return t=(t||"").replace(/&/g,"&amp;"),t=t.replace(/"/g,"&quot;"),t=t.replace(/\'/g,"&#39;"),t=t.replace(/</g,"&lt;"),t=t.replace(/>/g,"&gt;"),(null==e||e)&&(t=t.replace(/\n/g,"&#xa;")),t},isVml:function(t){return null!=t&&"urn:schemas-microsoft-com:vml"==t.tagUrn},getXml:function(t,e){var n="";return null!=window.XMLSerializer?n=(new XMLSerializer).serializeToString(t):null!=t.xml&&(n=t.xml.replace(/\r\n\t[\t]*/g,"").replace(/>\r\n/g,">").replace(/\r\n/g,"\n")),n=n.replace(/\n/g,e||"&#xa;")},getTextContent:function(t){var e="";return null!=t&&(null!=t.firstChild&&(t=t.firstChild),e=t.nodeValue||""),e},getInnerHtml:function(){return mxClient.IS_IE?function(t){return null!=t?t.innerHTML:""}:function(t){return null!=t?(new XMLSerializer).serializeToString(t):""}}(),getOuterHtml:function(){return mxClient.IS_IE?function(t){if(null!=t){if(null!=t.outerHTML)return t.outerHTML;var e=[];e.push("<"+t.nodeName);var n=t.attributes;if(null!=n)for(var i=0;i<n.length;i++){var o=n[i].nodeValue;null!=o&&0<o.length&&(e.push(" "),e.push(n[i].nodeName),e.push('="'),e.push(o),e.push('"'))}return 0==t.innerHTML.length?e.push("/>"):(e.push(">"),e.push(t.innerHTML),e.push("</"+t.nodeName+">")),e.join("")}return""}:function(t){return null!=t?(new XMLSerializer).serializeToString(t):""}}(),write:function(t,e){var n=t.ownerDocument.createTextNode(e);return null!=t&&t.appendChild(n),n},writeln:function(t,e){var n=t.ownerDocument.createTextNode(e);return null!=t&&(t.appendChild(n),t.appendChild(document.createElement("br"))),n},br:function(t,e){e=e||1;for(var n=null,i=0;e>i;i++)null!=t&&(n=t.ownerDocument.createElement("br"),t.appendChild(n));return n},button:function(t,e,n){return n=null!=n?n:document,n=n.createElement("button"),mxUtils.write(n,t),mxEvent.addListener(n,"click",function(t){e(t)}),n},para:function(t,e){var n=document.createElement("p");return mxUtils.write(n,e),null!=t&&t.appendChild(n),n},addTransparentBackgroundFilter:function(t){t.style.filter+="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+mxClient.imageBasePath+"/transparent.gif', sizingMethod='scale')"},linkAction:function(t,e,n,i,o){return mxUtils.link(t,e,function(){n.execute(i)},o)},linkInvoke:function(t,e,n,i,o,r){return mxUtils.link(t,e,function(){n[i](o)},r)},link:function(t,e,n,i){var o=document.createElement("span");return o.style.color="blue",o.style.textDecoration="underline",o.style.cursor="pointer",null!=i&&(o.style.paddingLeft=i+"px"),mxEvent.addListener(o,"click",n),mxUtils.write(o,e),null!=t&&t.appendChild(o),o},fit:function(t){var e=parseInt(t.offsetLeft),n=parseInt(t.offsetWidth),i=document.body,o=document.documentElement,r=(i.scrollLeft||o.scrollLeft)+(i.clientWidth||o.clientWidth);e+n>r&&(t.style.left=Math.max(i.scrollLeft||o.scrollLeft,r-n)+"px"),e=parseInt(t.offsetTop),n=parseInt(t.offsetHeight),r=(i.scrollTop||o.scrollTop)+Math.max(i.clientHeight||0,o.clientHeight),e+n>r&&(t.style.top=Math.max(i.scrollTop||o.scrollTop,r-n)+"px")},open:function(t){if(mxClient.IS_NS){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(e){return mxUtils.alert("Permission to read file denied."),""}var n=Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);return n.initWithPath(t),n.exists()?(t=Components.classes["@mozilla.org/network/file-input-stream;1"].createInstance(Components.interfaces.nsIFileInputStream),t.init(n,1,4,null),n=Components.classes["@mozilla.org/scriptableinputstream;1"].createInstance(Components.interfaces.nsIScriptableInputStream),n.init(t),n.read(n.available())):(mxUtils.alert("File not found."),"")}return n=new ActiveXObject("Scripting.FileSystemObject").OpenTextFile(t,1),t=n.readAll(),n.close(),t},save:function(t,e){if(mxClient.IS_NS){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(n){return mxUtils.alert("Permission to write file denied."),void 0}var i=Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);i.initWithPath(t),i.exists()||i.create(0,420);var o=Components.classes["@mozilla.org/network/file-output-stream;1"].createInstance(Components.interfaces.nsIFileOutputStream);o.init(i,34,4,null),o.write(e,e.length),o.flush(),o.close()}else i=new ActiveXObject("Scripting.FileSystemObject").CreateTextFile(t,!0),i.Write(e),i.Close()},saveAs:function(t){var e=document.createElement("iframe");e.setAttribute("src",""),e.style.visibility="hidden",document.body.appendChild(e);try{if(mxClient.IS_NS){var n=e.contentDocument;n.open(),n.write(t),n.close();try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect"),e.focus(),saveDocument(n)}catch(i){mxUtils.alert("Permission to save document denied.")}}else n=e.contentWindow.document,n.write(t),n.execCommand("SaveAs",!1,document.location)}finally{document.body.removeChild(e)}},copy:function(t){if(window.clipboardData)window.clipboardData.setData("Text",t);else{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var e=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(e){var n=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(n){n.addDataFlavor("text/unicode");var i=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);i.data=t,n.setTransferData("text/unicode",i,2*t.length),e.setData(n,null,Components.interfaces.nsIClipboard.kGlobalClipboard)}}}},load:function(t){return t=new mxXmlRequest(t,null,"GET",!1),t.send(),t},get:function(t,e,n){return new mxXmlRequest(t,null,"GET").send(e,n)},post:function(t,e,n,i){return new mxXmlRequest(t,e).send(n,i)},submit:function(t,e,n,i){return new mxXmlRequest(t,e).simulate(n,i)},loadInto:function(t,e,n){mxClient.IS_IE?e.onreadystatechange=function(){4==e.readyState&&n()}:e.addEventListener("load",n,!1),e.load(t)},getValue:function(t,e,n){return t=null!=t?t[e]:null,null==t&&(t=n),t},getNumber:function(t,e,n){return t=null!=t?t[e]:null,null==t&&(t=n||0),Number(t)},getColor:function(t,e,n){return t=null!=t?t[e]:null,null==t?t=n:t==mxConstants.NONE&&(t=null),t},clone:function(t,e,n){n=null!=n?n:!1;var i=null;if(null!=t&&"function"==typeof t.constructor){var o,i=new t.constructor;for(o in t)o!=mxObjectIdentity.FIELD_NAME&&(null==e||0>mxUtils.indexOf(e,o))&&(i[o]=n||"object"!=typeof t[o]?t[o]:mxUtils.clone(t[o]))}return i},equalPoints:function(t,e){if(null==t&&null!=e||null!=t&&null==e||null!=t&&null!=e&&t.length!=e.length)return!1;if(null!=t&&null!=e)for(var n=0;n<t.length;n++)if(t[n]==e[n]||null!=t[n]&&!t[n].equals(e[n]))return!1;return!0},equalEntries:function(t,e){if(null==t&&null!=e||null!=t&&null==e||null!=t&&null!=e&&t.length!=e.length)return!1;if(null!=t&&null!=e)for(var n in t)if(t[n]!=e[n])return!1;return!0},extend:function(t,e){var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t},toString:function(t){var e,n="";for(e in t)try{if(null==t[e])n+=e+" = [null]\n";else if("function"==typeof t[e])n+=e+" => [Function]\n";else if("object"==typeof t[e])var i=mxUtils.getFunctionName(t[e].constructor),n=n+(e+" => ["+i+"]\n");else n+=e+" = "+t[e]+"\n"}catch(o){n+=e+"="+o.message}return n},toRadians:function(t){return Math.PI*t/180},arcToCurves:function(t,e,n,i,o,r,s,l,a){if(l-=t,a-=e,0===n||0===i)return c;n=Math.abs(n),i=Math.abs(i);var h=-l/2,d=-a/2,u=Math.cos(o*Math.PI/180),c=Math.sin(o*Math.PI/180);o=u*h+c*d;var h=-1*c*h+u*d,d=o*o,p=h*h,m=n*n,g=i*i,f=d/m+p/g;f>1?(n*=Math.sqrt(f),i*=Math.sqrt(f),r=0):(f=1,r===s&&(f=-1),r=f*Math.sqrt((m*g-m*p-g*d)/(m*p+g*d))),d=r*n*h/i,p=-1*r*i*o/n,l=u*d-c*p+l/2,a=c*d+u*p+a/2,m=Math.atan2((h-p)/i,(o-d)/n)-Math.atan2(0,1),r=m>=0?m:2*Math.PI+m,m=Math.atan2((-h-p)/i,(-o-d)/n)-Math.atan2((h-p)/i,(o-d)/n),o=m>=0?m:2*Math.PI+m,0==s&&o>0?o-=2*Math.PI:0!=s&&0>o&&(o+=2*Math.PI),s=2*o/Math.PI,s=Math.ceil(0>s?-1*s:s),o/=s,h=8/3*Math.sin(o/4)*Math.sin(o/4)/Math.sin(o/2),d=u*n,u*=i,n*=c,i*=c;for(var x=Math.cos(r),C=Math.sin(r),p=-h*(d*C+i*x),m=-h*(n*C-u*x),f=g=0,c=[],E=0;s>E;++E){r+=o;var x=Math.cos(r),C=Math.sin(r),g=d*x-i*C+l,f=n*x+u*C+a,y=-h*(d*C+i*x),x=-h*(n*C-u*x),C=6*E;c[C]=Number(p+t),c[C+1]=Number(m+e),c[C+2]=Number(g-y+t),c[C+3]=Number(f-x+e),c[C+4]=Number(g+t),c[C+5]=Number(f+e),p=g+y,m=f+x}return c},getBoundingBox:function(t,e){var n=null;if(null!=t&&null!=e&&0!=e){var i=mxUtils.toRadians(e),n=Math.cos(i),o=Math.sin(i),r=new mxPoint(t.x+t.width/2,t.y+t.height/2),s=new mxPoint(t.x,t.y),i=new mxPoint(t.x+t.width,t.y),l=new mxPoint(i.x,t.y+t.height),a=new mxPoint(t.x,l.y),s=mxUtils.getRotatedPoint(s,n,o,r),i=mxUtils.getRotatedPoint(i,n,o,r),l=mxUtils.getRotatedPoint(l,n,o,r),a=mxUtils.getRotatedPoint(a,n,o,r),n=new mxRectangle(s.x,s.y,0,0);n.add(new mxRectangle(i.x,i.y,0,0)),n.add(new mxRectangle(l.x,l.y,0,0)),n.add(new mxRectangle(a.x,a.y,0,0))}return n},getRotatedPoint:function(t,e,n,i){i=null!=i?i:new mxPoint;var o=t.x-i.x;return t=t.y-i.y,new mxPoint(o*e-t*n+i.x,t*e+o*n+i.y)},getPortConstraints:function(t,e,n,i){return t=mxUtils.getValue(t.style,mxConstants.STYLE_PORT_CONSTRAINT,null),null==t?i:(i=t.toString(),t=mxConstants.DIRECTION_MASK_NONE,0<=i.indexOf(mxConstants.DIRECTION_NORTH)&&(t|=mxConstants.DIRECTION_MASK_NORTH),0<=i.indexOf(mxConstants.DIRECTION_WEST)&&(t|=mxConstants.DIRECTION_MASK_WEST),0<=i.indexOf(mxConstants.DIRECTION_SOUTH)&&(t|=mxConstants.DIRECTION_MASK_SOUTH),0<=i.indexOf(mxConstants.DIRECTION_EAST)&&(t|=mxConstants.DIRECTION_MASK_EAST),t)},reversePortConstraints:function(t){var e=0,e=(t&mxConstants.DIRECTION_MASK_WEST)<<3,e=e|(t&mxConstants.DIRECTION_MASK_NORTH)<<1,e=e|(t&mxConstants.DIRECTION_MASK_SOUTH)>>1;return e|=(t&mxConstants.DIRECTION_MASK_EAST)>>3},findNearestSegment:function(t,e,n){var i=-1;if(0<t.absolutePoints.length)for(var o=t.absolutePoints[0],r=null,s=1;s<t.absolutePoints.length;s++){var l=t.absolutePoints[s],o=mxUtils.ptSegDistSq(o.x,o.y,l.x,l.y,e,n);(null==r||r>o)&&(r=o,i=s-1),o=l}return i},rectangleIntersectsSegment:function(t,e,n){var i=t.y,o=t.x,r=i+t.height,s=o+t.width;t=e.x;var l=n.x;if(e.x>n.x&&(t=n.x,l=e.x),l>s&&(l=s),o>t&&(t=o),t>l)return!1;var o=e.y,s=n.y,a=n.x-e.x;return 1e-7<Math.abs(a)&&(n=(n.y-e.y)/a,e=e.y-n*e.x,o=n*t+e,s=n*l+e),o>s&&(e=s,s=o,o=e),s>r&&(s=r),i>o&&(o=i),o>s?!1:!0},contains:function(t,e,n){return t.x<=e&&t.x+t.width>=e&&t.y<=n&&t.y+t.height>=n},intersects:function(t,e){var n=t.width,i=t.height,o=e.width,r=e.height;if(0>=o||0>=r||0>=n||0>=i)return!1;var s=t.x,l=t.y,a=e.x,h=e.y,o=o+a,r=r+h,n=n+s,i=i+l;return(a>o||o>s)&&(h>r||r>l)&&(s>n||n>a)&&(l>i||i>h)},intersectsHotspot:function(t,e,n,i,o,r){if(i=null!=i?i:1,o=null!=o?o:0,r=null!=r?r:0,i>0){var s=t.getCenterX(),l=t.getCenterY(),a=t.width,h=t.height,d=mxUtils.getValue(t.style,mxConstants.STYLE_STARTSIZE)*t.view.scale;return d>0&&(mxUtils.getValue(t.style,mxConstants.STYLE_HORIZONTAL,!0)?(l=t.y+d/2,h=d):(s=t.x+d/2,a=d)),a=Math.max(o,a*i),h=Math.max(o,h*i),r>0&&(a=Math.min(a,r),h=Math.min(h,r)),i=new mxRectangle(s-a/2,l-h/2,a,h),s=mxUtils.toRadians(mxUtils.getValue(t.style,mxConstants.STYLE_ROTATION)||0),0!=s&&(o=Math.cos(-s),r=Math.sin(-s),s=new mxPoint(t.getCenterX(),t.getCenterY()),t=mxUtils.getRotatedPoint(new mxPoint(e,n),o,r,s),e=t.x,n=t.y),mxUtils.contains(i,e,n)}return!0},getOffset:function(t,e){var n=0,i=0;if(null!=e&&e)var o=document.body,r=document.documentElement,n=n+(o.scrollLeft||r.scrollLeft),i=i+(o.scrollTop||r.scrollTop);for(;t.offsetParent;)n+=t.offsetLeft,i+=t.offsetTop,t=t.offsetParent;return new mxPoint(n,i)},getScrollOrigin:function(t){for(var e=document.body,n=document.documentElement,i=new mxPoint(e.scrollLeft||n.scrollLeft,e.scrollTop||n.scrollTop);null!=t&&t!=e&&t!=n;)!isNaN(t.scrollLeft)&&!isNaN(t.scrollTop)&&(i.x+=t.scrollLeft,i.y+=t.scrollTop),t=t.parentNode;
return i},convertPoint:function(t,e,n){var i=mxUtils.getScrollOrigin(t);return t=mxUtils.getOffset(t),t.x-=i.x,t.y-=i.y,new mxPoint(e-t.x,n-t.y)},ltrim:function(t,e){return t.replace(RegExp("^["+(e||"\\s")+"]+","g"),"")},rtrim:function(t,e){return t.replace(RegExp("["+(e||"\\s")+"]+$","g"),"")},trim:function(t,e){return mxUtils.ltrim(mxUtils.rtrim(t,e),e)},isNumeric:function(t){return null!=t&&(null==t.length||0<t.length&&0>t.indexOf("0x")&&0>t.indexOf("0X"))&&!isNaN(t)},mod:function(t,e){return(t%e+e)%e},intersection:function(t,e,n,i,o,r,s,l){var a=(l-r)*(n-t)-(s-o)*(i-e);return s=((s-o)*(e-r)-(l-r)*(t-o))/a,o=((n-t)*(e-r)-(i-e)*(t-o))/a,s>=0&&1>=s&&o>=0&&1>=o?new mxPoint(t+s*(n-t),e+s*(i-e)):null},ptSegDistSq:function(t,e,n,i,o,r){return n-=t,i-=e,o-=t,r-=e,0>=o*n+r*i?n=0:(o=n-o,r=i-r,t=o*n+r*i,n=0>=t?0:t*t/(n*n+i*i)),o=o*o+r*r-n,0>o&&(o=0),o},relativeCcw:function(t,e,n,i,o,r){return n-=t,i-=e,o-=t,r-=e,t=o*i-r*n,0==t&&(t=o*n+r*i,t>0&&(t=(o-n)*n+(r-i)*i,0>t&&(t=0))),0>t?-1:t>0?1:0},animateChanges:function(){mxEffects.animateChanges.apply(this,arguments)},cascadeOpacity:function(){mxEffects.cascadeOpacity.apply(this,arguments)},fadeOut:function(){mxEffects.fadeOut.apply(this,arguments)},setOpacity:function(t,e){mxUtils.isVml(t)?t.style.filter=e>=100?null:"alpha(opacity="+e/5+")":mxClient.IS_IE&&("undefined"==typeof document.documentMode||9>document.documentMode)?t.style.filter=e>=100?null:"alpha(opacity="+e+")":t.style.opacity=e/100},createImage:function(t){var e=null;return mxClient.IS_IE6&&"CSS1Compat"!=document.compatMode?(e=document.createElement(mxClient.VML_PREFIX+":image"),e.setAttribute("src",t),e.style.borderStyle="none"):(e=document.createElement("img"),e.setAttribute("src",t),e.setAttribute("border","0")),e},sortCells:function(t,e){e=null!=e?e:!0;var n=new mxDictionary;return t.sort(function(t,i){var o=n.get(t);null==o&&(o=mxCellPath.create(t).split(mxCellPath.PATH_SEPARATOR),n.put(t,o));var r=n.get(i);return null==r&&(r=mxCellPath.create(i).split(mxCellPath.PATH_SEPARATOR),n.put(i,r)),o=mxCellPath.compare(o,r),0==o?0:o>0==e?1:-1}),t},getStylename:function(t){return null!=t&&(t=t.split(";")[0],0>t.indexOf("="))?t:""},getStylenames:function(t){var e=[];if(null!=t){t=t.split(";");for(var n=0;n<t.length;n++)0>t[n].indexOf("=")&&e.push(t[n])}return e},indexOfStylename:function(t,e){if(null!=t&&null!=e)for(var n=t.split(";"),i=0,o=0;o<n.length;o++){if(n[o]==e)return i;i+=n[o].length+1}return-1},addStylename:function(t,e){return 0>mxUtils.indexOfStylename(t,e)&&(null==t?t="":0<t.length&&";"!=t.charAt(t.length-1)&&(t+=";"),t+=e),t},removeStylename:function(t,e){var n=[];if(null!=t)for(var i=t.split(";"),o=0;o<i.length;o++)i[o]!=e&&n.push(i[o]);return n.join(";")},removeAllStylenames:function(t){var e=[];if(null!=t){t=t.split(";");for(var n=0;n<t.length;n++)0<=t[n].indexOf("=")&&e.push(t[n])}return e.join(";")},setCellStyles:function(t,e,n,i){if(null!=e&&0<e.length){t.beginUpdate();try{for(var o=0;o<e.length;o++)if(null!=e[o]){var r=mxUtils.setStyle(t.getStyle(e[o]),n,i);t.setStyle(e[o],r)}}finally{t.endUpdate()}}},setStyle:function(t,e,n){var i=null!=n&&("undefined"==typeof n.length||0<n.length);if(null==t||0==t.length)i&&(t=e+"="+n);else{var o=t.indexOf(e+"=");0>o?i&&(i=";"==t.charAt(t.length-1)?"":";",t=t+i+e+"="+n):(e=i?e+"="+n:"",n=t.indexOf(";",o),i||n++,t=t.substring(0,o)+e+(n>o?t.substring(n):""))}return t},setCellStyleFlags:function(t,e,n,i,o){if(null!=e&&0<e.length){t.beginUpdate();try{for(var r=0;r<e.length;r++)if(null!=e[r]){var s=mxUtils.setStyleFlag(t.getStyle(e[r]),n,i,o);t.setStyle(e[r],s)}}finally{t.endUpdate()}}},setStyleFlag:function(t,e,n,i){if(null==t||0==t.length)t=i||null==i?e+"="+n:e+"=0";else{var o=t.indexOf(e+"=");if(0>o)o=";"==t.charAt(t.length-1)?"":";",t=i||null==i?t+o+e+"="+n:t+o+e+"=0";else{var r=t.indexOf(";",o),s="",s=0>r?t.substring(o+e.length+1):t.substring(o+e.length+1,r),s=null==i?parseInt(s)^n:i?parseInt(s)|n:parseInt(s)&~n;t=t.substring(0,o)+e+"="+s+(r>=0?t.substring(r):"")}}return t},getAlignmentAsPoint:function(t,e){var n=0,i=0;return t==mxConstants.ALIGN_CENTER?n=-.5:t==mxConstants.ALIGN_RIGHT&&(n=-1),e==mxConstants.ALIGN_MIDDLE?i=-.5:e==mxConstants.ALIGN_BOTTOM&&(i=-1),new mxPoint(n,i)},getSizeForString:function(t,e,n,i){e=null!=e?e:mxConstants.DEFAULT_FONTSIZE,n=null!=n?n:mxConstants.DEFAULT_FONTFAMILY;var o=document.createElement("div");return o.style.fontFamily=n,o.style.fontSize=Math.round(e)+"px",o.style.lineHeight=Math.round(e*mxConstants.LINE_HEIGHT)+"px",o.style.position="absolute",o.style.visibility="hidden",o.style.display=mxClient.IS_QUIRKS?"inline":"inline-block",o.style.zoom="1",null!=i?(o.style.width=i+"px",o.style.whiteSpace="normal"):o.style.whiteSpace="nowrap",o.innerHTML=t,document.body.appendChild(o),t=new mxRectangle(0,0,o.offsetWidth,o.offsetHeight),document.body.removeChild(o),t},getViewXml:function(t,e,n,i,o){i=null!=i?i:0,o=null!=o?o:0,e=null!=e?e:1,null==n&&(n=[t.getModel().getRoot()]);var r=t.getView(),s=null,l=r.isEventsEnabled();r.setEventsEnabled(!1);var a=r.drawPane,h=r.overlayPane;t.dialect==mxConstants.DIALECT_SVG?(r.drawPane=document.createElementNS(mxConstants.NS_SVG,"g"),r.canvas.appendChild(r.drawPane),r.overlayPane=document.createElementNS(mxConstants.NS_SVG,"g")):(r.drawPane=r.drawPane.cloneNode(!1),r.canvas.appendChild(r.drawPane),r.overlayPane=r.overlayPane.cloneNode(!1)),r.canvas.appendChild(r.overlayPane);var d=r.getTranslate();r.translate=new mxPoint(i,o),e=new mxTemporaryCellStates(t.getView(),e,n);try{s=(new mxCodec).encode(t.getView())}finally{e.destroy(),r.translate=d,r.canvas.removeChild(r.drawPane),r.canvas.removeChild(r.overlayPane),r.drawPane=a,r.overlayPane=h,r.setEventsEnabled(l)}return s},getScaleForPageCount:function(t,e,n,i){if(1>t)return 1;n=null!=n?n:mxConstants.PAGE_FORMAT_A4_PORTRAIT,i=null!=i?i:0;var o=n.width-2*i;n=n.height-2*i,i=e.getGraphBounds().clone(),e=e.getView().getScale(),i.width/=e,i.height/=e,e=i.width,n=e/i.height/(o/n),i=Math.sqrt(t);var r=Math.sqrt(n);if(n=i*r,i/=r,1>n&&i>t){var s=i/t;i=t,n/=s}for(1>i&&n>t&&(s=n/t,n=t,i/=s),s=Math.ceil(n)*Math.ceil(i),r=0;s>t;){var s=Math.floor(n)/n,l=Math.floor(i)/i;if(1==s&&(s=Math.floor(n-1)/n),1==l&&(l=Math.floor(i-1)/i),s=s>l?s:l,n*=s,i*=s,s=Math.ceil(n)*Math.ceil(i),r++,r>10)break}return.99999*(o*n/e)},show:function(t,e,n,i){n=null!=n?n:0,i=null!=i?i:0,null==e?e=window.open().document:e.open();var o=t.getGraphBounds();if(n=-o.x+n,i=-o.y+i,mxClient.IS_IE){for(var o="<html><head>",r=document.getElementsByTagName("base"),s=0;s<r.length;s++)o+=r[s].outerHTML;for(o+="<style>",s=0;s<document.styleSheets.length;s++)try{o+=document.styleSheets(s).cssText}catch(l){}o+="</style></head>",o+="<body>",o+=t.container.innerHTML,o+="</body>",o+="<html>",e.writeln(o),e.close(),t=e.body.getElementsByTagName("DIV")[0],null!=t&&(t.style.position="absolute",t.style.left=n+"px",t.style.top=i+"px")}else{for(e.writeln("<html"),e.writeln("<head>"),r=document.getElementsByTagName("base"),s=0;s<r.length;s++)e.writeln(mxUtils.getOuterHtml(r[s]));for(r=document.getElementsByTagName("link"),s=0;s<r.length;s++)e.writeln(mxUtils.getOuterHtml(r[s]));for(r=document.getElementsByTagName("style"),s=0;s<r.length;s++)e.writeln(mxUtils.getOuterHtml(r[s]));for(e.writeln("</head>"),e.writeln("</html>"),e.close(),null==e.body&&e.documentElement.appendChild(e.createElement("body")),e.body.style.overflow="auto",t=t.container.firstChild;null!=t;)s=t.cloneNode(!0),e.body.appendChild(s),t=t.nextSibling;t=e.getElementsByTagName("g")[0],null!=t&&(t.setAttribute("transform","translate("+n+","+i+")"),n=t.ownerSVGElement,n.setAttribute("width",o.width+Math.max(o.x,0)+3),n.setAttribute("height",o.height+Math.max(o.y,0)+3))}return mxUtils.removeCursors(e.body),e},printScreen:function(t){var e=window.open();mxUtils.show(t,e.document),t=function(){e.focus(),e.print(),e.close()},mxClient.IS_GC?e.setTimeout(t,500):t()},popup:function(t,e){if(e){var n=document.createElement("div");n.style.overflow="scroll",n.style.width="636px",n.style.height="460px";var i=document.createElement("pre");i.innerHTML=mxUtils.htmlEntities(t,!1).replace(/\n/g,"<br>").replace(/ /g,"&nbsp;"),n.appendChild(i),n=new mxWindow("Popup Window",n,document.body.clientWidth/2-320,(document.body.clientHeight||document.documentElement.clientHeight)/2-240,640,480,!1,!0),n.setClosable(!0),n.setVisible(!0)}else mxClient.IS_NS?(n=window.open(),n.document.writeln("<pre>"+mxUtils.htmlEntities(t)+"</pre"),n.document.close()):(n=window.open(),i=n.document.createElement("pre"),i.innerHTML=mxUtils.htmlEntities(t,!1).replace(/\n/g,"<br>").replace(/ /g,"&nbsp;"),n.document.body.appendChild(i))},alert:function(t){alert(t)},prompt:function(t,e){return prompt(t,e)},confirm:function(t){return confirm(t)},error:function(t,e,n,i){var o=document.createElement("div");o.style.padding="20px";var r=document.createElement("img");r.setAttribute("src",i||mxUtils.errorImage),r.setAttribute("valign","bottom"),r.style.verticalAlign="middle",o.appendChild(r),o.appendChild(document.createTextNode("")),o.appendChild(document.createTextNode("")),o.appendChild(document.createTextNode("")),mxUtils.write(o,t),t=document.body.clientWidth,i=document.body.clientHeight||document.documentElement.clientHeight;var s=new mxWindow(mxResources.get(mxUtils.errorResource)||mxUtils.errorResource,o,(t-e)/2,i/4,e,null,!1,!0);return n&&(mxUtils.br(o),e=document.createElement("p"),n=document.createElement("button"),mxClient.IS_IE?n.style.cssText="float:right":n.setAttribute("style","float:right"),mxEvent.addListener(n,"click",function(){s.destroy()}),mxUtils.write(n,mxResources.get(mxUtils.closeResource)||mxUtils.closeResource),e.appendChild(n),o.appendChild(e),mxUtils.br(o),s.setClosable(!0)),s.setVisible(!0),s},makeDraggable:function(t,e,n,i,o,r,s,l,a,h){return t=new mxDragSource(t,n),t.dragOffset=new mxPoint(null!=o?o:0,null!=r?r:mxConstants.TOOLTIP_VERTICAL_OFFSET),t.autoscroll=s,t.setGuidesEnabled(!1),null!=a&&(t.highlightDropTargets=a),null!=h&&(t.getDropTarget=h),t.getGraphForEvent=function(t){return"function"==typeof e?e(t):e},null!=i&&(t.createDragElement=function(){return i.cloneNode(!0)},l&&(t.createPreviewElement=function(t){var e=i.cloneNode(!0),n=parseInt(e.style.width),o=parseInt(e.style.height);return e.style.width=Math.round(n*t.view.scale)+"px",e.style.height=Math.round(o*t.view.scale)+"px",e})),t}},mxConstants={DEFAULT_HOTSPOT:.3,MIN_HOTSPOT_SIZE:8,MAX_HOTSPOT_SIZE:0,RENDERING_HINT_EXACT:"exact",RENDERING_HINT_FASTER:"faster",RENDERING_HINT_FASTEST:"fastest",DIALECT_SVG:"svg",DIALECT_VML:"vml",DIALECT_MIXEDHTML:"mixedHtml",DIALECT_PREFERHTML:"preferHtml",DIALECT_STRICTHTML:"strictHtml",NS_SVG:"http://www.w3.org/2000/svg",NS_XHTML:"http://www.w3.org/1999/xhtml",NS_XLINK:"http://www.w3.org/1999/xlink",SHADOWCOLOR:"gray",SHADOW_OFFSET_X:2,SHADOW_OFFSET_Y:3,SHADOW_OPACITY:1,NODETYPE_ELEMENT:1,NODETYPE_ATTRIBUTE:2,NODETYPE_TEXT:3,NODETYPE_CDATA:4,NODETYPE_ENTITY_REFERENCE:5,NODETYPE_ENTITY:6,NODETYPE_PROCESSING_INSTRUCTION:7,NODETYPE_COMMENT:8,NODETYPE_DOCUMENT:9,NODETYPE_DOCUMENTTYPE:10,NODETYPE_DOCUMENT_FRAGMENT:11,NODETYPE_NOTATION:12,TOOLTIP_VERTICAL_OFFSET:16,DEFAULT_VALID_COLOR:"#00FF00",DEFAULT_INVALID_COLOR:"#FF0000",HIGHLIGHT_STROKEWIDTH:3,CURSOR_MOVABLE_VERTEX:"move",CURSOR_MOVABLE_EDGE:"move",CURSOR_LABEL_HANDLE:"default",CURSOR_BEND_HANDLE:"pointer",CURSOR_CONNECT:"pointer",HIGHLIGHT_COLOR:"#00FF00",CONNECT_TARGET_COLOR:"#0000FF",INVALID_CONNECT_TARGET_COLOR:"#FF0000",DROP_TARGET_COLOR:"#0000FF",VALID_COLOR:"#00FF00",INVALID_COLOR:"#FF0000",EDGE_SELECTION_COLOR:"#00FF00",VERTEX_SELECTION_COLOR:"#00FF00",VERTEX_SELECTION_STROKEWIDTH:1,EDGE_SELECTION_STROKEWIDTH:1,VERTEX_SELECTION_DASHED:!0,EDGE_SELECTION_DASHED:!0,GUIDE_COLOR:"#FF0000",GUIDE_STROKEWIDTH:1,OUTLINE_COLOR:"#0099FF",OUTLINE_STROKEWIDTH:mxClient.IS_IE?2:3,HANDLE_SIZE:7,LABEL_HANDLE_SIZE:4,HANDLE_FILLCOLOR:"#00FF00",HANDLE_STROKECOLOR:"black",LABEL_HANDLE_FILLCOLOR:"yellow",CONNECT_HANDLE_FILLCOLOR:"#0000FF",LOCKED_HANDLE_FILLCOLOR:"#FF0000",OUTLINE_HANDLE_FILLCOLOR:"#00FFFF",OUTLINE_HANDLE_STROKECOLOR:"#0033FF",DEFAULT_FONTFAMILY:"Arial,Helvetica",DEFAULT_FONTSIZE:11,LINE_HEIGHT:1.2,DEFAULT_FONTSTYLE:0,DEFAULT_STARTSIZE:40,DEFAULT_MARKERSIZE:6,DEFAULT_IMAGESIZE:24,ENTITY_SEGMENT:30,RECTANGLE_ROUNDING_FACTOR:.15,LINE_ARCSIZE:20,ARROW_SPACING:10,ARROW_WIDTH:30,ARROW_SIZE:30,PAGE_FORMAT_A4_PORTRAIT:new mxRectangle(0,0,826,1169),PAGE_FORMAT_A4_LANDSCAPE:new mxRectangle(0,0,1169,826),PAGE_FORMAT_LETTER_PORTRAIT:new mxRectangle(0,0,850,1100),PAGE_FORMAT_LETTER_LANDSCAPE:new mxRectangle(0,0,1100,850),NONE:"none",STYLE_PERIMETER:"perimeter",STYLE_SOURCE_PORT:"sourcePort",STYLE_TARGET_PORT:"targetPort",STYLE_PORT_CONSTRAINT:"portConstraint",STYLE_OPACITY:"opacity",STYLE_TEXT_OPACITY:"textOpacity",STYLE_OVERFLOW:"overflow",STYLE_ORTHOGONAL:"orthogonal",STYLE_EXIT_X:"exitX",STYLE_EXIT_Y:"exitY",STYLE_EXIT_PERIMETER:"exitPerimeter",STYLE_ENTRY_X:"entryX",STYLE_ENTRY_Y:"entryY",STYLE_ENTRY_PERIMETER:"entryPerimeter",STYLE_WHITE_SPACE:"whiteSpace",STYLE_ROTATION:"rotation",STYLE_FILLCOLOR:"fillColor",STYLE_SWIMLANE_FILLCOLOR:"swimlaneFillColor",STYLE_GRADIENTCOLOR:"gradientColor",STYLE_GRADIENT_DIRECTION:"gradientDirection",STYLE_STROKECOLOR:"strokeColor",STYLE_SEPARATORCOLOR:"separatorColor",STYLE_STROKEWIDTH:"strokeWidth",STYLE_ALIGN:"align",STYLE_VERTICAL_ALIGN:"verticalAlign",STYLE_LABEL_POSITION:"labelPosition",STYLE_VERTICAL_LABEL_POSITION:"verticalLabelPosition",STYLE_IMAGE_ASPECT:"imageAspect",STYLE_IMAGE_ALIGN:"imageAlign",STYLE_IMAGE_VERTICAL_ALIGN:"imageVerticalAlign",STYLE_GLASS:"glass",STYLE_IMAGE:"image",STYLE_IMAGE_WIDTH:"imageWidth",STYLE_IMAGE_HEIGHT:"imageHeight",STYLE_IMAGE_BACKGROUND:"imageBackground",STYLE_IMAGE_BORDER:"imageBorder",STYLE_FLIPH:"flipH",STYLE_FLIPV:"flipV",STYLE_NOLABEL:"noLabel",STYLE_NOEDGESTYLE:"noEdgeStyle",STYLE_LABEL_BACKGROUNDCOLOR:"labelBackgroundColor",STYLE_LABEL_BORDERCOLOR:"labelBorderColor",STYLE_LABEL_PADDING:"labelPadding",STYLE_INDICATOR_SHAPE:"indicatorShape",STYLE_INDICATOR_IMAGE:"indicatorImage",STYLE_INDICATOR_COLOR:"indicatorColor",STYLE_INDICATOR_STROKECOLOR:"indicatorStrokeColor",STYLE_INDICATOR_GRADIENTCOLOR:"indicatorGradientColor",STYLE_INDICATOR_SPACING:"indicatorSpacing",STYLE_INDICATOR_WIDTH:"indicatorWidth",STYLE_INDICATOR_HEIGHT:"indicatorHeight",STYLE_INDICATOR_DIRECTION:"indicatorDirection",STYLE_SHADOW:"shadow",STYLE_SEGMENT:"segment",STYLE_ENDARROW:"endArrow",STYLE_STARTARROW:"startArrow",STYLE_ENDSIZE:"endSize",STYLE_STARTSIZE:"startSize",STYLE_SWIMLANE_LINE:"swimlaneLine",STYLE_ENDFILL:"endFill",STYLE_STARTFILL:"startFill",STYLE_DASHED:"dashed",STYLE_DASH_PATTERN:"dashPattern",STYLE_ROUNDED:"rounded",STYLE_CURVED:"curved",STYLE_ARCSIZE:"arcSize",STYLE_SMOOTH:"smooth",STYLE_SOURCE_PERIMETER_SPACING:"sourcePerimeterSpacing",STYLE_TARGET_PERIMETER_SPACING:"targetPerimeterSpacing",STYLE_PERIMETER_SPACING:"perimeterSpacing",STYLE_SPACING:"spacing",STYLE_SPACING_TOP:"spacingTop",STYLE_SPACING_LEFT:"spacingLeft",STYLE_SPACING_BOTTOM:"spacingBottom",STYLE_SPACING_RIGHT:"spacingRight",STYLE_HORIZONTAL:"horizontal",STYLE_DIRECTION:"direction",STYLE_ELBOW:"elbow",STYLE_FONTCOLOR:"fontColor",STYLE_FONTFAMILY:"fontFamily",STYLE_FONTSIZE:"fontSize",STYLE_FONTSTYLE:"fontStyle",STYLE_AUTOSIZE:"autosize",STYLE_FOLDABLE:"foldable",STYLE_EDITABLE:"editable",STYLE_BENDABLE:"bendable",STYLE_MOVABLE:"movable",STYLE_RESIZABLE:"resizable",STYLE_ROTATABLE:"rotatable",STYLE_CLONEABLE:"cloneable",STYLE_DELETABLE:"deletable",STYLE_SHAPE:"shape",STYLE_EDGE:"edgeStyle",STYLE_LOOP:"loopStyle",STYLE_ROUTING_CENTER_X:"routingCenterX",STYLE_ROUTING_CENTER_Y:"routingCenterY",FONT_BOLD:1,FONT_ITALIC:2,FONT_UNDERLINE:4,FONT_SHADOW:8,SHAPE_RECTANGLE:"rectangle",SHAPE_ELLIPSE:"ellipse",SHAPE_DOUBLE_ELLIPSE:"doubleEllipse",SHAPE_RHOMBUS:"rhombus",SHAPE_LINE:"line",SHAPE_IMAGE:"image",SHAPE_ARROW:"arrow",SHAPE_LABEL:"label",SHAPE_CYLINDER:"cylinder",SHAPE_SWIMLANE:"swimlane",SHAPE_CONNECTOR:"connector",SHAPE_ACTOR:"actor",SHAPE_CLOUD:"cloud",SHAPE_TRIANGLE:"triangle",SHAPE_HEXAGON:"hexagon",ARROW_CLASSIC:"classic",ARROW_BLOCK:"block",ARROW_OPEN:"open",ARROW_OVAL:"oval",ARROW_DIAMOND:"diamond",ARROW_DIAMOND_THIN:"diamondThin",ALIGN_LEFT:"left",ALIGN_CENTER:"center",ALIGN_RIGHT:"right",ALIGN_TOP:"top",ALIGN_MIDDLE:"middle",ALIGN_BOTTOM:"bottom",DIRECTION_NORTH:"north",DIRECTION_SOUTH:"south",DIRECTION_EAST:"east",DIRECTION_WEST:"west",DIRECTION_MASK_NONE:0,DIRECTION_MASK_WEST:1,DIRECTION_MASK_NORTH:2,DIRECTION_MASK_SOUTH:4,DIRECTION_MASK_EAST:8,DIRECTION_MASK_ALL:15,ELBOW_VERTICAL:"vertical",ELBOW_HORIZONTAL:"horizontal",EDGESTYLE_ELBOW:"elbowEdgeStyle",EDGESTYLE_ENTITY_RELATION:"entityRelationEdgeStyle",EDGESTYLE_LOOP:"loopEdgeStyle",EDGESTYLE_SIDETOSIDE:"sideToSideEdgeStyle",EDGESTYLE_TOPTOBOTTOM:"topToBottomEdgeStyle",EDGESTYLE_ORTHOGONAL:"orthogonalEdgeStyle",EDGESTYLE_SEGMENT:"segmentEdgeStyle",PERIMETER_ELLIPSE:"ellipsePerimeter",PERIMETER_RECTANGLE:"rectanglePerimeter",PERIMETER_RHOMBUS:"rhombusPerimeter",PERIMETER_TRIANGLE:"trianglePerimeter"};mxEventObject.prototype.name=null,mxEventObject.prototype.properties=null,mxEventObject.prototype.consumed=!1,mxEventObject.prototype.getName=function(){return this.name},mxEventObject.prototype.getProperties=function(){return this.properties},mxEventObject.prototype.getProperty=function(t){return this.properties[t]},mxEventObject.prototype.isConsumed=function(){return this.consumed},mxEventObject.prototype.consume=function(){this.consumed=!0},mxMouseEvent.prototype.consumed=!1,mxMouseEvent.prototype.evt=null,mxMouseEvent.prototype.graphX=null,mxMouseEvent.prototype.graphY=null,mxMouseEvent.prototype.state=null,mxMouseEvent.prototype.getEvent=function(){return this.evt},mxMouseEvent.prototype.getSource=function(){return mxEvent.getSource(this.evt)},mxMouseEvent.prototype.isSource=function(t){if(null!=t)for(var e=this.getSource();null!=e;){if(e==t.node)return!0;e=e.parentNode}return!1},mxMouseEvent.prototype.getX=function(){return mxEvent.getClientX(this.getEvent())},mxMouseEvent.prototype.getY=function(){return mxEvent.getClientY(this.getEvent())},mxMouseEvent.prototype.getGraphX=function(){return this.graphX},mxMouseEvent.prototype.getGraphY=function(){return this.graphY},mxMouseEvent.prototype.getState=function(){return this.state},mxMouseEvent.prototype.getCell=function(){var t=this.getState();return null!=t?t.cell:null},mxMouseEvent.prototype.isPopupTrigger=function(){return mxEvent.isPopupTrigger(this.getEvent())},mxMouseEvent.prototype.isConsumed=function(){return this.consumed},mxMouseEvent.prototype.consume=function(t){(null!=t?t:1)&&this.evt.preventDefault&&this.evt.preventDefault(),this.evt.returnValue=!1,this.consumed=!0},mxEventSource.prototype.eventListeners=null,mxEventSource.prototype.eventsEnabled=!0,mxEventSource.prototype.eventSource=null,mxEventSource.prototype.isEventsEnabled=function(){return this.eventsEnabled},mxEventSource.prototype.setEventsEnabled=function(t){this.eventsEnabled=t},mxEventSource.prototype.getEventSource=function(){return this.eventSource},mxEventSource.prototype.setEventSource=function(t){this.eventSource=t},mxEventSource.prototype.addListener=function(t,e){null==this.eventListeners&&(this.eventListeners=[]),this.eventListeners.push(t),this.eventListeners.push(e)},mxEventSource.prototype.removeListener=function(t){if(null!=this.eventListeners)for(var e=0;e<this.eventListeners.length;)this.eventListeners[e+1]==t?this.eventListeners.splice(e,2):e+=2},mxEventSource.prototype.fireEvent=function(t,e){if(null!=this.eventListeners&&this.isEventsEnabled()){null==t&&(t=new mxEventObject),null==e&&(e=this.getEventSource()),null==e&&(e=this);for(var n=[e,t],i=0;i<this.eventListeners.length;i+=2){var o=this.eventListeners[i];(null==o||o==t.getName())&&this.eventListeners[i+1].apply(this,n)}}};var mxEvent={objects:[],addListener:function(){var t=function(t,e,n){null==t.mxListenerList&&(t.mxListenerList=[],mxEvent.objects.push(t)),t.mxListenerList.push({name:e,f:n})};return window.addEventListener?function(e,n,i){e.addEventListener(n,i,!1),t(e,n,i)}:function(e,n,i){e.attachEvent("on"+n,i),t(e,n,i)}}(),removeListener:function(){var t=function(t,e,n){if(null!=t.mxListenerList){e=t.mxListenerList.length;for(var i=0;e>i;i++)if(t.mxListenerList[i].f==n){t.mxListenerList.splice(i,1);break}0==t.mxListenerList.length&&(t.mxListenerList=null)}};return window.removeEventListener?function(e,n,i){e.removeEventListener(n,i,!1),t(e,n,i)}:function(e,n,i){e.detachEvent("on"+n,i),t(e,n,i)}}(),removeAllListeners:function(t){var e=t.mxListenerList;if(null!=e)for(;0<e.length;){var n=e[0];mxEvent.removeListener(t,n.name,n.f)}},addGestureListeners:function(t,e,n,i){null!=e&&mxEvent.addListener(t,mxClient.IS_POINTER?"MSPointerDown":"mousedown",e),null!=n&&mxEvent.addListener(t,mxClient.IS_POINTER?"MSPointerMove":"mousemove",n),null!=i&&mxEvent.addListener(t,mxClient.IS_POINTER?"MSPointerUp":"mouseup",i),!mxClient.IS_POINTER&&mxClient.IS_TOUCH&&(null!=e&&mxEvent.addListener(t,"touchstart",e),null!=n&&mxEvent.addListener(t,"touchmove",n),null!=i&&mxEvent.addListener(t,"touchend",i))},removeGestureListeners:function(t,e,n,i){null!=e&&mxEvent.removeListener(t,mxClient.IS_POINTER?"MSPointerDown":"mousedown",e),null!=n&&mxEvent.removeListener(t,mxClient.IS_POINTER?"MSPointerMove":"mousemove",n),null!=i&&mxEvent.removeListener(t,mxClient.IS_POINTER?"MSPointerUp":"mouseup",i),!mxClient.IS_POINTER&&mxClient.IS_TOUCH&&(null!=e&&mxEvent.removeListener(t,"touchstart",e),null!=n&&mxEvent.removeListener(t,"touchmove",n),null!=i&&mxEvent.removeListener(t,"touchend",i))},redirectMouseEvents:function(t,e,n,i,o,r,s){var l=function(t){return"function"==typeof n?n(t):n};mxEvent.addGestureListeners(t,function(t){null!=i?i(t):mxEvent.isConsumed(t)||e.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(t,l(t)))},function(t){null!=o?o(t):mxEvent.isConsumed(t)||e.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(t,l(t)))},function(t){null!=r?r(t):mxEvent.isConsumed(t)||e.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(t,l(t)))}),mxEvent.addListener(t,"dblclick",function(t){if(null!=s)s(t);else if(!mxEvent.isConsumed(t)){var n=l(t);e.dblClick(t,null!=n?n.cell:null)}})},release:function(t){if(null!=t&&(mxEvent.removeAllListeners(t),t=t.childNodes,null!=t))for(var e=t.length,n=0;e>n;n+=1)mxEvent.release(t[n])},addMouseWheelListener:function(t){if(null!=t){var e=function(e){null==e&&(e=window.event);var n=0,n=!mxClient.IS_NS||mxClient.IS_SF||mxClient.IS_GC?e.wheelDelta/120:-e.detail/2;0!=n&&t(e,n>0)};mxClient.IS_NS?mxEvent.addListener(window,mxClient.IS_SF||mxClient.IS_GC?"mousewheel":"DOMMouseScroll",e):mxEvent.addListener(document,"mousewheel",e)}},disableContextMenu:function(){return mxClient.IS_IE&&("undefined"==typeof document.documentMode||9>document.documentMode)?function(t){mxEvent.addListener(t,"contextmenu",function(){return!1})}:function(t){t.setAttribute("oncontextmenu","return false;")}}(),getSource:function(t){return null!=t.srcElement?t.srcElement:t.target},isConsumed:function(t){return null!=t.isConsumed&&t.isConsumed},isLeftMouseButton:function(t){return t.button==(mxClient.IS_IE&&("undefined"==typeof document.documentMode||9>document.documentMode)?1:0)},isRightMouseButton:function(t){return 2==t.button},isPopupTrigger:function(t){return mxEvent.isRightMouseButton(t)||mxEvent.isShiftDown(t)&&!mxEvent.isControlDown(t)},isShiftDown:function(t){return null!=t?t.shiftKey:!1},isAltDown:function(t){return null!=t?t.altKey:!1},isControlDown:function(t){return null!=t?t.ctrlKey:!1},isMetaDown:function(t){return null!=t?t.metaKey:!1},getMainEvent:function(t){return"touchstart"!=t.type&&"touchmove"!=t.type||null==t.touches||null==t.touches[0]?"touchend"==t.type&&null!=t.changedTouches&&null!=t.changedTouches[0]&&(t=t.changedTouches[0]):t=t.touches[0],t},getClientX:function(t){return mxEvent.getMainEvent(t).clientX},getClientY:function(t){return mxEvent.getMainEvent(t).clientY},consume:function(t,e,n){n=null!=n?n:!0,(null!=e?e:1)&&(t.preventDefault?(n&&t.stopPropagation(),t.preventDefault()):n&&(t.cancelBubble=!0)),t.isConsumed=!0,t.returnValue=!1},LABEL_HANDLE:-1,ROTATION_HANDLE:-2,MOUSE_DOWN:"mouseDown",MOUSE_MOVE:"mouseMove",MOUSE_UP:"mouseUp",ACTIVATE:"activate",RESIZE_START:"resizeStart",RESIZE:"resize",RESIZE_END:"resizeEnd",MOVE_START:"moveStart",MOVE:"move",MOVE_END:"moveEnd",PAN_START:"panStart",PAN:"pan",PAN_END:"panEnd",MINIMIZE:"minimize",NORMALIZE:"normalize",MAXIMIZE:"maximize",HIDE:"hide",SHOW:"show",CLOSE:"close",DESTROY:"destroy",REFRESH:"refresh",SIZE:"size",SELECT:"select",FIRED:"fired",GET:"get",RECEIVE:"receive",CONNECT:"connect",DISCONNECT:"disconnect",SUSPEND:"suspend",RESUME:"resume",MARK:"mark",SESSION:"session",ROOT:"root",POST:"post",OPEN:"open",SAVE:"save",BEFORE_ADD_VERTEX:"beforeAddVertex",ADD_VERTEX:"addVertex",AFTER_ADD_VERTEX:"afterAddVertex",DONE:"done",EXECUTE:"execute",EXECUTED:"executed",BEGIN_UPDATE:"beginUpdate",START_EDIT:"startEdit",END_UPDATE:"endUpdate",END_EDIT:"endEdit",BEFORE_UNDO:"beforeUndo",UNDO:"undo",REDO:"redo",CHANGE:"change",NOTIFY:"notify",LAYOUT_CELLS:"layoutCells",CLICK:"click",SCALE:"scale",TRANSLATE:"translate",SCALE_AND_TRANSLATE:"scaleAndTranslate",UP:"up",DOWN:"down",ADD:"add",REMOVE:"remove",CLEAR:"clear",ADD_CELLS:"addCells",CELLS_ADDED:"cellsAdded",MOVE_CELLS:"moveCells",CELLS_MOVED:"cellsMoved",RESIZE_CELLS:"resizeCells",CELLS_RESIZED:"cellsResized",TOGGLE_CELLS:"toggleCells",CELLS_TOGGLED:"cellsToggled",ORDER_CELLS:"orderCells",CELLS_ORDERED:"cellsOrdered",REMOVE_CELLS:"removeCells",CELLS_REMOVED:"cellsRemoved",GROUP_CELLS:"groupCells",UNGROUP_CELLS:"ungroupCells",REMOVE_CELLS_FROM_PARENT:"removeCellsFromParent",FOLD_CELLS:"foldCells",CELLS_FOLDED:"cellsFolded",ALIGN_CELLS:"alignCells",LABEL_CHANGED:"labelChanged",CONNECT_CELL:"connectCell",CELL_CONNECTED:"cellConnected",SPLIT_EDGE:"splitEdge",FLIP_EDGE:"flipEdge",START_EDITING:"startEditing",ADD_OVERLAY:"addOverlay",REMOVE_OVERLAY:"removeOverlay",UPDATE_CELL_SIZE:"updateCellSize",ESCAPE:"escape",CLICK:"click",DOUBLE_CLICK:"doubleClick",START:"start",RESET:"reset"};mxXmlRequest.prototype.url=null,mxXmlRequest.prototype.params=null,mxXmlRequest.prototype.method=null,mxXmlRequest.prototype.async=null,mxXmlRequest.prototype.binary=!1,mxXmlRequest.prototype.username=null,mxXmlRequest.prototype.password=null,mxXmlRequest.prototype.request=null,mxXmlRequest.prototype.isBinary=function(){return this.binary},mxXmlRequest.prototype.setBinary=function(t){this.binary=t},mxXmlRequest.prototype.getText=function(){return this.request.responseText},mxXmlRequest.prototype.isReady=function(){return 4==this.request.readyState},mxXmlRequest.prototype.getDocumentElement=function(){var t=this.getXml();return null!=t?t.documentElement:null},mxXmlRequest.prototype.getXml=function(){var t=this.request.responseXML;return(9<=document.documentMode||null==t||null==t.documentElement)&&(t=mxUtils.parseXml(this.request.responseText)),t},mxXmlRequest.prototype.getText=function(){return this.request.responseText},mxXmlRequest.prototype.getStatus=function(){return this.request.status},mxXmlRequest.prototype.create=function(){return window.XMLHttpRequest?function(){var t=new XMLHttpRequest;return this.isBinary()&&t.overrideMimeType&&t.overrideMimeType("text/plain; charset=x-user-defined"),t}:"undefined"!=typeof ActiveXObject?function(){return new ActiveXObject("Microsoft.XMLHTTP")}:void 0}(),mxXmlRequest.prototype.send=function(t){this.request=this.create(),null!=this.request&&(null!=t&&(this.request.onreadystatechange=mxUtils.bind(this,function(){this.isReady()&&(t(this),this.onreadystatechaange=null)})),this.request.open(this.method,this.url,this.async,this.username,this.password),this.setRequestHeaders(this.request,this.params),this.request.send(this.params))},mxXmlRequest.prototype.setRequestHeaders=function(t,e){null!=e&&t.setRequestHeader("Content-Type","application/x-www-form-urlencoded")},mxXmlRequest.prototype.simulate=function(t,e){t=t||document;var n=null;t==document&&(n=window.onbeforeunload,window.onbeforeunload=null);var i=t.createElement("form");i.setAttribute("method",this.method),i.setAttribute("action",this.url),null!=e&&i.setAttribute("target",e),i.style.display="none",i.style.visibility="hidden";for(var o=0<this.params.indexOf("&")?this.params.split("&"):this.params.split(),r=0;r<o.length;r++){var s=o[r].indexOf("=");if(s>0){var l=o[r].substring(0,s),a=o[r].substring(s+1),s=t.createElement("textarea");s.setAttribute("name",l),a=a.replace(/\n/g,"&#xa;"),l=t.createTextNode(a),s.appendChild(l),i.appendChild(s)}}t.body.appendChild(i),i.submit(),t.body.removeChild(i),null!=n&&(window.onbeforeunload=n)};var mxClipboard={STEPSIZE:10,insertCount:1,cells:null,isEmpty:function(){return null==mxClipboard.cells},cut:function(t,e){return e=mxClipboard.copy(t,e),mxClipboard.insertCount=0,mxClipboard.removeCells(t,e),e},removeCells:function(t,e){t.removeCells(e)},copy:function(t,e){e=e||t.getSelectionCells();var n=t.getExportableCells(e);return mxClipboard.insertCount=1,mxClipboard.cells=t.cloneCells(n),n},paste:function(t){if(null!=mxClipboard.cells){var e=t.getImportableCells(mxClipboard.cells),n=mxClipboard.insertCount*mxClipboard.STEPSIZE,i=t.getDefaultParent(),e=t.importCells(e,n,n,i);mxClipboard.insertCount++,t.setSelectionCells(e)}}};mxWindow.prototype=new mxEventSource,mxWindow.prototype.constructor=mxWindow,mxWindow.prototype.closeImage=mxClient.imageBasePath+"/close.gif",mxWindow.prototype.minimizeImage=mxClient.imageBasePath+"/minimize.gif",mxWindow.prototype.normalizeImage=mxClient.imageBasePath+"/normalize.gif",mxWindow.prototype.maximizeImage=mxClient.imageBasePath+"/maximize.gif",mxWindow.prototype.resizeImage=mxClient.imageBasePath+"/resize.gif",mxWindow.prototype.visible=!1,mxWindow.prototype.content=!1,mxWindow.prototype.minimumSize=new mxRectangle(0,0,50,40),mxWindow.prototype.title=!1,mxWindow.prototype.content=!1,mxWindow.prototype.destroyOnClose=!0,mxWindow.prototype.init=function(t,e,n,i,o){o=null!=o?o:"mxWindow",this.div=document.createElement("div"),this.div.className=o,this.div.style.left=t+"px",this.div.style.top=e+"px",this.table=document.createElement("table"),this.table.className=o,null!=n&&(mxClient.IS_IE||(this.div.style.width=n+"px"),this.table.style.width=n+"px"),null!=i&&(mxClient.IS_IE||(this.div.style.height=i+"px"),this.table.style.height=i+"px"),t=document.createElement("tbody"),e=document.createElement("tr"),this.title=document.createElement("td"),this.title.className=o+"Title",e.appendChild(this.title),t.appendChild(e),e=document.createElement("tr"),this.td=document.createElement("td"),this.td.className=o+"Pane",this.contentWrapper=document.createElement("div"),this.contentWrapper.className=o+"Pane",this.contentWrapper.style.width="100%",this.contentWrapper.appendChild(this.content),(mxClient.IS_IE||"DIV"!=this.content.nodeName.toUpperCase())&&(this.contentWrapper.style.height="100%"),this.td.appendChild(this.contentWrapper),e.appendChild(this.td),t.appendChild(e),this.table.appendChild(t),this.div.appendChild(this.table),o=mxUtils.bind(this,function(){this.activate()}),mxEvent.addGestureListeners(this.title,o),mxEvent.addGestureListeners(this.table,o),this.hide()},mxWindow.prototype.setTitle=function(t){for(var e=this.title.firstChild;null!=e;){var n=e.nextSibling;e.nodeType==mxConstants.NODETYPE_TEXT&&e.parentNode.removeChild(e),e=n}mxUtils.write(this.title,t||"")},mxWindow.prototype.setScrollable=function(t){0>navigator.userAgent.indexOf("Presto/2.5")&&(this.contentWrapper.style.overflow=t?"auto":"hidden")},mxWindow.prototype.activate=function(){if(mxWindow.activeWindow!=this){var t=mxUtils.getCurrentStyle(this.getElement()),t=null!=t?t.zIndex:3;if(mxWindow.activeWindow){var e=mxWindow.activeWindow.getElement();null!=e&&null!=e.style&&(e.style.zIndex=t)}e=mxWindow.activeWindow,this.getElement().style.zIndex=parseInt(t)+1,mxWindow.activeWindow=this,this.fireEvent(new mxEventObject(mxEvent.ACTIVATE,"previousWindow",e))}},mxWindow.prototype.getElement=function(){return this.div},mxWindow.prototype.fit=function(){mxUtils.fit(this.div)},mxWindow.prototype.isResizable=function(){return null!=this.resize?"none"!=this.resize.style.display:!1},mxWindow.prototype.setResizable=function(t){t?null==this.resize?(this.resize=document.createElement("img"),this.resize.style.position="absolute",this.resize.style.bottom="2px",this.resize.style.right="2px",this.resize.setAttribute("src",mxClient.imageBasePath+"/resize.gif"),this.resize.style.cursor="nw-resize",mxEvent.addGestureListeners(this.resize,mxUtils.bind(this,function(t){this.activate();var e=mxEvent.getClientX(t),n=mxEvent.getClientY(t),i=this.div.offsetWidth,o=this.div.offsetHeight,r=mxUtils.bind(this,function(t){var r=mxEvent.getClientX(t)-e,s=mxEvent.getClientY(t)-n;this.setSize(i+r,o+s),this.fireEvent(new mxEventObject(mxEvent.RESIZE,"event",t)),mxEvent.consume(t)
}),s=mxUtils.bind(this,function(t){mxEvent.removeGestureListeners(document,null,r,s),this.fireEvent(new mxEventObject(mxEvent.RESIZE_END,"event",t)),mxEvent.consume(t)});mxEvent.addGestureListeners(document,null,r,s),this.fireEvent(new mxEventObject(mxEvent.RESIZE_START,"event",t)),mxEvent.consume(t)}),null,null),this.div.appendChild(this.resize),mxClient.IS_POINTER&&(this.resize.style.msTouchAction="none")):this.resize.style.display="inline":null!=this.resize&&(this.resize.style.display="none")},mxWindow.prototype.setSize=function(t,e){t=Math.max(this.minimumSize.width,t),e=Math.max(this.minimumSize.height,e),mxClient.IS_IE||(this.div.style.width=t+"px",this.div.style.height=e+"px"),this.table.style.width=t+"px",this.table.style.height=e+"px",mxClient.IS_IE||(this.contentWrapper.style.height=this.div.offsetHeight-this.title.offsetHeight-2+"px")},mxWindow.prototype.setMinimizable=function(t){this.minimize.style.display=t?"":"none"},mxWindow.prototype.getMinimumSize=function(){return new mxRectangle(0,0,0,this.title.offsetHeight)},mxWindow.prototype.installMinimizeHandler=function(){this.minimize=document.createElement("img"),this.minimize.setAttribute("src",this.minimizeImage),this.minimize.setAttribute("align","right"),this.minimize.setAttribute("title","Minimize"),this.minimize.style.cursor="pointer",this.minimize.style.marginRight="1px",this.minimize.style.display="none",this.title.appendChild(this.minimize);var t=!1,e=null,n=null,i=mxUtils.bind(this,function(i){if(this.activate(),t)t=!1,this.minimize.setAttribute("src",this.minimizeImage),this.minimize.setAttribute("title","Minimize"),this.contentWrapper.style.display="",this.maximize.style.display=e,mxClient.IS_IE||(this.div.style.height=n),this.table.style.height=n,null!=this.resize&&(this.resize.style.visibility=""),this.fireEvent(new mxEventObject(mxEvent.NORMALIZE,"event",i));else{t=!0,this.minimize.setAttribute("src",this.normalizeImage),this.minimize.setAttribute("title","Normalize"),this.contentWrapper.style.display="none",e=this.maximize.style.display,this.maximize.style.display="none",n=this.table.style.height;var o=this.getMinimumSize();0<o.height&&(mxClient.IS_IE||(this.div.style.height=o.height+"px"),this.table.style.height=o.height+"px"),0<o.width&&(mxClient.IS_IE||(this.div.style.width=o.width+"px"),this.table.style.width=o.width+"px"),null!=this.resize&&(this.resize.style.visibility="hidden"),this.fireEvent(new mxEventObject(mxEvent.MINIMIZE,"event",i))}mxEvent.consume(i)});mxEvent.addGestureListeners(this.minimize,i)},mxWindow.prototype.setMaximizable=function(t){this.maximize.style.display=t?"":"none"},mxWindow.prototype.installMaximizeHandler=function(){this.maximize=document.createElement("img"),this.maximize.setAttribute("src",this.maximizeImage),this.maximize.setAttribute("align","right"),this.maximize.setAttribute("title","Maximize"),this.maximize.style.cursor="default",this.maximize.style.marginLeft="1px",this.maximize.style.cursor="pointer",this.maximize.style.display="none",this.title.appendChild(this.maximize);var t=!1,e=null,n=null,i=null,o=null,r=mxUtils.bind(this,function(r){if(this.activate(),"none"!=this.maximize.style.display){if(t)t=!1,this.maximize.setAttribute("src",this.maximizeImage),this.maximize.setAttribute("title","Maximize"),this.contentWrapper.style.display="",this.minimize.style.visibility="",this.div.style.left=e+"px",this.div.style.top=n+"px",mxClient.IS_IE||(this.div.style.height=i,this.div.style.width=o,s=mxUtils.getCurrentStyle(this.contentWrapper),"auto"!=s.overflow&&null==this.resize)||(this.contentWrapper.style.height=this.div.offsetHeight-this.title.offsetHeight-2+"px"),this.table.style.height=i,this.table.style.width=o,null!=this.resize&&(this.resize.style.visibility=""),this.fireEvent(new mxEventObject(mxEvent.NORMALIZE,"event",r));else{if(t=!0,this.maximize.setAttribute("src",this.normalizeImage),this.maximize.setAttribute("title","Normalize"),this.contentWrapper.style.display="",this.minimize.style.visibility="hidden",e=parseInt(this.div.style.left),n=parseInt(this.div.style.top),i=this.table.style.height,o=this.table.style.width,this.div.style.left="0px",this.div.style.top="0px",mxClient.IS_IE||(this.div.style.height=document.body.clientHeight-2+"px",this.div.style.width=document.body.clientWidth-2+"px"),this.table.style.width=document.body.clientWidth-2+"px",this.table.style.height=document.body.clientHeight-2+"px",null!=this.resize&&(this.resize.style.visibility="hidden"),!mxClient.IS_IE){var s=mxUtils.getCurrentStyle(this.contentWrapper);("auto"==s.overflow||null!=this.resize)&&(this.contentWrapper.style.height=this.div.offsetHeight-this.title.offsetHeight-2+"px")}this.fireEvent(new mxEventObject(mxEvent.MAXIMIZE,"event",r))}mxEvent.consume(r)}});mxEvent.addGestureListeners(this.maximize,r),mxEvent.addListener(this.title,"dblclick",r)},mxWindow.prototype.installMoveHandler=function(){this.title.style.cursor="move",mxEvent.addGestureListeners(this.title,mxUtils.bind(this,function(t){var e=mxEvent.getClientX(t),n=mxEvent.getClientY(t),i=this.getX(),o=this.getY(),r=mxUtils.bind(this,function(t){var r=mxEvent.getClientX(t)-e,s=mxEvent.getClientY(t)-n;this.setLocation(i+r,o+s),this.fireEvent(new mxEventObject(mxEvent.MOVE,"event",t)),mxEvent.consume(t)}),s=mxUtils.bind(this,function(t){mxEvent.removeGestureListeners(document,null,r,s),this.fireEvent(new mxEventObject(mxEvent.MOVE_END,"event",t)),mxEvent.consume(t)});mxEvent.addGestureListeners(document,null,r,s),this.fireEvent(new mxEventObject(mxEvent.MOVE_START,"event",t)),mxEvent.consume(t)})),mxClient.IS_POINTER&&(this.title.style.msTouchAction="none")},mxWindow.prototype.setLocation=function(t,e){this.div.style.left=t+"px",this.div.style.top=e+"px"},mxWindow.prototype.getX=function(){return parseInt(this.div.style.left)},mxWindow.prototype.getY=function(){return parseInt(this.div.style.top)},mxWindow.prototype.installCloseHandler=function(){this.closeImg=document.createElement("img"),this.closeImg.setAttribute("src",this.closeImage),this.closeImg.setAttribute("align","right"),this.closeImg.setAttribute("title","Close"),this.closeImg.style.marginLeft="2px",this.closeImg.style.cursor="pointer",this.closeImg.style.display="none",this.title.insertBefore(this.closeImg,this.title.firstChild),mxEvent.addGestureListeners(this.closeImg,mxUtils.bind(this,function(t){this.fireEvent(new mxEventObject(mxEvent.CLOSE,"event",t)),this.destroyOnClose?this.destroy():this.setVisible(!1),mxEvent.consume(t)}))},mxWindow.prototype.setImage=function(t){this.image=document.createElement("img"),this.image.setAttribute("src",t),this.image.setAttribute("align","left"),this.image.style.marginRight="4px",this.image.style.marginLeft="0px",this.image.style.marginTop="-2px",this.title.insertBefore(this.image,this.title.firstChild)},mxWindow.prototype.setClosable=function(t){this.closeImg.style.display=t?"":"none"},mxWindow.prototype.isVisible=function(){return null!=this.div?"hidden"!=this.div.style.visibility:!1},mxWindow.prototype.setVisible=function(t){null!=this.div&&this.isVisible()!=t&&(t?this.show():this.hide())},mxWindow.prototype.show=function(){this.div.style.visibility="",this.activate();var t=mxUtils.getCurrentStyle(this.contentWrapper);mxClient.IS_IE||"auto"!=t.overflow&&null==this.resize||(this.contentWrapper.style.height=this.div.offsetHeight-this.title.offsetHeight-2+"px"),this.fireEvent(new mxEventObject(mxEvent.SHOW))},mxWindow.prototype.hide=function(){this.div.style.visibility="hidden",this.fireEvent(new mxEventObject(mxEvent.HIDE))},mxWindow.prototype.destroy=function(){this.fireEvent(new mxEventObject(mxEvent.DESTROY)),null!=this.div&&(mxEvent.release(this.div),this.div.parentNode.removeChild(this.div),this.div=null),this.contentWrapper=this.content=this.title=null},mxForm.prototype.table=null,mxForm.prototype.body=!1,mxForm.prototype.getTable=function(){return this.table},mxForm.prototype.addButtons=function(t,e){var n=document.createElement("tr"),i=document.createElement("td");n.appendChild(i);var i=document.createElement("td"),o=document.createElement("button");mxUtils.write(o,mxResources.get("ok")||"OK"),i.appendChild(o),mxEvent.addListener(o,"click",function(){t()}),o=document.createElement("button"),mxUtils.write(o,mxResources.get("cancel")||"Cancel"),i.appendChild(o),mxEvent.addListener(o,"click",function(){e()}),n.appendChild(i),this.body.appendChild(n)},mxForm.prototype.addText=function(t,e){var n=document.createElement("input");return n.setAttribute("type","text"),n.value=e,this.addField(t,n)},mxForm.prototype.addCheckbox=function(t,e){var n=document.createElement("input");return n.setAttribute("type","checkbox"),this.addField(t,n),e&&(n.checked=!0),n},mxForm.prototype.addTextarea=function(t,e,n){var i=document.createElement("textarea");return mxClient.IS_NS&&n--,i.setAttribute("rows",n||2),i.value=e,this.addField(t,i)},mxForm.prototype.addCombo=function(t,e,n){var i=document.createElement("select");return null!=n&&i.setAttribute("size",n),e&&i.setAttribute("multiple","true"),this.addField(t,i)},mxForm.prototype.addOption=function(t,e,n,i){var o=document.createElement("option");mxUtils.writeln(o,e),o.setAttribute("value",n),i&&o.setAttribute("selected",i),t.appendChild(o)},mxForm.prototype.addField=function(t,e){var n=document.createElement("tr"),i=document.createElement("td");return mxUtils.write(i,t),n.appendChild(i),i=document.createElement("td"),i.appendChild(e),n.appendChild(i),this.body.appendChild(n),e},mxImage.prototype.src=null,mxImage.prototype.width=null,mxImage.prototype.height=null,mxDivResizer.prototype.resizeWidth=!0,mxDivResizer.prototype.resizeHeight=!0,mxDivResizer.prototype.handlingResize=!1,mxDivResizer.prototype.resize=function(){var t=this.getDocumentWidth(),e=this.getDocumentHeight(),n=parseInt(this.div.style.left),i=parseInt(this.div.style.right),o=parseInt(this.div.style.top),r=parseInt(this.div.style.bottom);this.resizeWidth&&!isNaN(n)&&!isNaN(i)&&n>=0&&i>=0&&t-i-n>0&&(this.div.style.width=t-i-n+"px"),this.resizeHeight&&!isNaN(o)&&!isNaN(r)&&o>=0&&r>=0&&e-o-r>0&&(this.div.style.height=e-o-r+"px")},mxDivResizer.prototype.getDocumentWidth=function(){return document.body.clientWidth},mxDivResizer.prototype.getDocumentHeight=function(){return document.body.clientHeight},mxDragSource.prototype.element=null,mxDragSource.prototype.dropHandler=null,mxDragSource.prototype.dragOffset=null,mxDragSource.prototype.dragElement=null,mxDragSource.prototype.previewElement=null,mxDragSource.prototype.enabled=!0,mxDragSource.prototype.currentGraph=null,mxDragSource.prototype.currentDropTarget=null,mxDragSource.prototype.currentPoint=null,mxDragSource.prototype.currentGuide=null,mxDragSource.prototype.currentHighlight=null,mxDragSource.prototype.autoscroll=!0,mxDragSource.prototype.guidesEnabled=!0,mxDragSource.prototype.gridEnabled=!0,mxDragSource.prototype.highlightDropTargets=!0,mxDragSource.prototype.dragElementZIndex=100,mxDragSource.prototype.dragElementOpacity=70,mxDragSource.prototype.isEnabled=function(){return this.enabled},mxDragSource.prototype.setEnabled=function(t){this.enabled=t},mxDragSource.prototype.isGuidesEnabled=function(){return this.guidesEnabled},mxDragSource.prototype.setGuidesEnabled=function(t){this.guidesEnabled=t},mxDragSource.prototype.isGridEnabled=function(){return this.gridEnabled},mxDragSource.prototype.setGridEnabled=function(t){this.gridEnabled=t},mxDragSource.prototype.getGraphForEvent=function(){return null},mxDragSource.prototype.getDropTarget=function(t,e,n){return t.getCellAt(e,n)},mxDragSource.prototype.createDragElement=function(){return this.element.cloneNode(!0)},mxDragSource.prototype.createPreviewElement=function(){return null},mxDragSource.prototype.mouseDown=function(t){this.enabled&&!mxEvent.isConsumed(t)&&null==this.mouseMoveHandler&&(this.startDrag(t),this.mouseMoveHandler=mxUtils.bind(this,this.mouseMove),this.mouseUpHandler=mxUtils.bind(this,this.mouseUp),mxEvent.addGestureListeners(document,null,this.mouseMoveHandler,this.mouseUpHandler),mxEvent.consume(t,!0,!1))},mxDragSource.prototype.startDrag=function(t){this.dragElement=this.createDragElement(t),this.dragElement.style.position="absolute",this.dragElement.style.zIndex=this.dragElementZIndex,mxUtils.setOpacity(this.dragElement,this.dragElementOpacity)},mxDragSource.prototype.stopDrag=function(){null!=this.dragElement&&(null!=this.dragElement.parentNode&&this.dragElement.parentNode.removeChild(this.dragElement),this.dragElement=null)},mxDragSource.prototype.graphContainsEvent=function(t,e){var n=mxEvent.getClientX(e),i=mxEvent.getClientY(e),o=mxUtils.getOffset(t.container),r=mxUtils.getScrollOrigin();return n>=o.x-r.x&&i>=o.y-r.y&&n<=o.x-r.x+t.container.offsetWidth&&i<=o.y-r.y+t.container.offsetHeight},mxDragSource.prototype.mouseMove=function(t){var e=this.getGraphForEvent(t);if(null!=e&&!this.graphContainsEvent(e,t)&&(e=null),e!=this.currentGraph&&(null!=this.currentGraph&&this.dragExit(this.currentGraph),this.currentGraph=e,null!=this.currentGraph&&this.dragEnter(this.currentGraph)),null!=this.currentGraph&&this.dragOver(this.currentGraph,t),null==this.dragElement||null!=this.previewElement&&"visible"==this.previewElement.style.visibility)null!=this.dragElement&&(this.dragElement.style.visibility="hidden");else{var e=mxEvent.getClientX(t),n=mxEvent.getClientY(t);null==this.dragElement.parentNode&&document.body.appendChild(this.dragElement),this.dragElement.style.visibility="visible",null!=this.dragOffset&&(e+=this.dragOffset.x,n+=this.dragOffset.y),e+=document.body.scrollLeft||document.documentElement.scrollLeft,n+=document.body.scrollTop||document.documentElement.scrollTop,this.dragElement.style.left=e+"px",this.dragElement.style.top=n+"px"}mxEvent.consume(t)},mxDragSource.prototype.mouseUp=function(t){if(null!=this.currentGraph){if(null!=this.currentPoint&&(null==this.previewElement||"hidden"!=this.previewElement.style.visibility)){var e=this.currentGraph.view.scale,n=this.currentGraph.view.translate;this.drop(this.currentGraph,t,this.currentDropTarget,this.currentPoint.x/e-n.x,this.currentPoint.y/e-n.y)}this.dragExit(this.currentGraph)}this.stopDrag(t),mxEvent.removeGestureListeners(document,null,this.mouseMoveHandler,this.mouseUpHandler),this.currentGraph=this.mouseUpHandler=this.mouseMoveHandler=null,mxEvent.consume(t)},mxDragSource.prototype.dragEnter=function(t){t.isMouseDown=!0,this.previewElement=this.createPreviewElement(t),this.isGuidesEnabled()&&null!=this.previewElement&&(this.currentGuide=new mxGuide(t,t.graphHandler.getGuideStates())),this.highlightDropTargets&&(this.currentHighlight=new mxCellHighlight(t,mxConstants.DROP_TARGET_COLOR))},mxDragSource.prototype.dragExit=function(t){this.currentPoint=this.currentDropTarget=null,t.isMouseDown=!1,null!=this.previewElement&&(null!=this.previewElement.parentNode&&this.previewElement.parentNode.removeChild(this.previewElement),this.previewElement=null),null!=this.currentGuide&&(this.currentGuide.destroy(),this.currentGuide=null),null!=this.currentHighlight&&(this.currentHighlight.destroy(),this.currentHighlight=null)},mxDragSource.prototype.dragOver=function(t,e){var n=mxUtils.getOffset(t.container),i=mxUtils.getScrollOrigin(t.container),o=mxEvent.getClientX(e)-n.x+i.x,n=mxEvent.getClientY(e)-n.y+i.y;if(t.autoScroll&&(null==this.autoscroll||this.autoscroll)&&t.scrollPointToVisible(o,n,t.autoExtend),null!=this.currentHighlight&&t.isDropEnabled()&&(this.currentDropTarget=this.getDropTarget(t,o,n),i=t.getView().getState(this.currentDropTarget),this.currentHighlight.highlight(i)),null!=this.previewElement){null==this.previewElement.parentNode&&(t.container.appendChild(this.previewElement),this.previewElement.style.zIndex="3",this.previewElement.style.position="absolute");var i=this.isGridEnabled()&&t.isGridEnabledEvent(e),r=!0;if(null!=this.currentGuide&&this.currentGuide.isEnabledForEvent(e))var r=parseInt(this.previewElement.style.width),s=parseInt(this.previewElement.style.height),r=new mxRectangle(0,0,r,s),n=new mxPoint(o,n),n=this.currentGuide.move(r,n,i),r=!1,o=n.x,n=n.y;else if(i)var i=t.view.scale,s=t.view.translate,l=t.gridSize/2,o=(t.snap(o/i-s.x-l)+s.x)*i,n=(t.snap(n/i-s.y-l)+s.y)*i;null!=this.currentGuide&&r&&this.currentGuide.hide(),null!=this.previewOffset&&(o+=this.previewOffset.x,n+=this.previewOffset.y),this.previewElement.style.left=Math.round(o)+"px",this.previewElement.style.top=Math.round(n)+"px",this.previewElement.style.visibility="visible"}this.currentPoint=new mxPoint(o,n)},mxDragSource.prototype.drop=function(t,e,n,i,o){this.dropHandler(t,e,n,i,o),t.container.focus()},mxToolbar.prototype=new mxEventSource,mxToolbar.prototype.constructor=mxToolbar,mxToolbar.prototype.container=null,mxToolbar.prototype.enabled=!0,mxToolbar.prototype.noReset=!1,mxToolbar.prototype.updateDefaultMode=!0,mxToolbar.prototype.addItem=function(t,e,n,i,o,r){var s=document.createElement(null!=e?"img":"button"),l=o||(null!=r?"mxToolbarMode":"mxToolbarItem");return s.className=l,s.setAttribute("src",e),null!=t&&(null!=e?s.setAttribute("title",t):mxUtils.write(s,t)),this.container.appendChild(s),null!=n&&(mxEvent.addListener(s,"click",n),mxClient.IS_TOUCH&&mxEvent.addListener(s,"touchend",n)),t=mxUtils.bind(this,function(){null!=i?s.setAttribute("src",e):s.style.backgroundColor=""}),mxEvent.addGestureListeners(s,mxUtils.bind(this,function(t){if(null!=i?s.setAttribute("src",i):s.style.backgroundColor="gray",null!=r){null==this.menu&&(this.menu=new mxPopupMenu,this.menu.init());var e=this.currentImg;this.menu.isMenuShowing()&&this.menu.hideMenu(),e!=s&&(this.currentImg=s,this.menu.factoryMethod=r,e=new mxPoint(s.offsetLeft,s.offsetTop+s.offsetHeight),this.menu.popup(e.x,e.y,null,t),this.menu.isMenuShowing()&&(s.className=l+"Selected",this.menu.hideMenu=function(){mxPopupMenu.prototype.hideMenu.apply(this),s.className=l,this.currentImg=null}))}}),null,t),mxEvent.addListener(s,"mouseout",t),s},mxToolbar.prototype.addCombo=function(t){var e=document.createElement("div");e.style.display="inline",e.className="mxToolbarComboContainer";var n=document.createElement("select");return n.className=t||"mxToolbarCombo",e.appendChild(n),this.container.appendChild(e),n},mxToolbar.prototype.addActionCombo=function(t,e){var n=document.createElement("select");return n.className=e||"mxToolbarCombo",this.addOption(n,t,null),mxEvent.addListener(n,"change",function(t){var e=n.options[n.selectedIndex];n.selectedIndex=0,null!=e.funct&&e.funct(t)}),this.container.appendChild(n),n},mxToolbar.prototype.addOption=function(t,e,n){var i=document.createElement("option");return mxUtils.writeln(i,e),"function"==typeof n?i.funct=n:i.setAttribute("value",n),t.appendChild(i),i},mxToolbar.prototype.addSwitchMode=function(t,e,n,i,o){var r=document.createElement("img");return r.initialClassName=o||"mxToolbarMode",r.className=r.initialClassName,r.setAttribute("src",e),r.altIcon=i,null!=t&&r.setAttribute("title",t),mxEvent.addListener(r,"click",mxUtils.bind(this,function(t){t=this.selectedMode.altIcon,null!=t?(this.selectedMode.altIcon=this.selectedMode.getAttribute("src"),this.selectedMode.setAttribute("src",t)):this.selectedMode.className=this.selectedMode.initialClassName,this.updateDefaultMode&&(this.defaultMode=r),this.selectedMode=r,t=r.altIcon,null!=t?(r.altIcon=r.getAttribute("src"),r.setAttribute("src",t)):r.className=r.initialClassName+"Selected",this.fireEvent(new mxEventObject(mxEvent.SELECT)),n()})),this.container.appendChild(r),null==this.defaultMode&&(this.defaultMode=r,this.selectMode(r),n()),r},mxToolbar.prototype.addMode=function(t,e,n,i,o,r){r=null!=r?r:!0;var s=document.createElement(null!=e?"img":"button");return s.initialClassName=o||"mxToolbarMode",s.className=s.initialClassName,s.setAttribute("src",e),s.altIcon=i,null!=t&&s.setAttribute("title",t),this.enabled&&r&&(mxEvent.addListener(s,"click",mxUtils.bind(this,function(){this.selectMode(s,n),this.noReset=!1})),mxEvent.addListener(s,"dblclick",mxUtils.bind(this,function(){this.selectMode(s,n),this.noReset=!0})),null==this.defaultMode&&(this.defaultMode=s,this.defaultFunction=n,this.selectMode(s,n))),this.container.appendChild(s),s},mxToolbar.prototype.selectMode=function(t,e){if(this.selectedMode!=t){if(null!=this.selectedMode){var n=this.selectedMode.altIcon;null!=n?(this.selectedMode.altIcon=this.selectedMode.getAttribute("src"),this.selectedMode.setAttribute("src",n)):this.selectedMode.className=this.selectedMode.initialClassName}this.selectedMode=t,n=this.selectedMode.altIcon,null!=n?(this.selectedMode.altIcon=this.selectedMode.getAttribute("src"),this.selectedMode.setAttribute("src",n)):this.selectedMode.className=this.selectedMode.initialClassName+"Selected",this.fireEvent(new mxEventObject(mxEvent.SELECT,"function",e))}},mxToolbar.prototype.resetMode=function(t){(t||!this.noReset)&&this.selectedMode!=this.defaultMode&&this.selectMode(this.defaultMode,this.defaultFunction)},mxToolbar.prototype.addSeparator=function(t){return this.addItem(null,t,null)},mxToolbar.prototype.addBreak=function(){mxUtils.br(this.container)},mxToolbar.prototype.addLine=function(){var t=document.createElement("hr");t.style.marginRight="6px",t.setAttribute("size","1"),this.container.appendChild(t)},mxToolbar.prototype.destroy=function(){mxEvent.release(this.container),this.selectedMode=this.defaultFunction=this.defaultMode=this.container=null,null!=this.menu&&this.menu.destroy()},mxSession.prototype=new mxEventSource,mxSession.prototype.constructor=mxSession,mxSession.prototype.model=null,mxSession.prototype.urlInit=null,mxSession.prototype.urlPoll=null,mxSession.prototype.urlNotify=null,mxSession.prototype.codec=null,mxSession.prototype.linefeed="&#xa;",mxSession.prototype.escapePostData=!0,mxSession.prototype.significantRemoteChanges=!0,mxSession.prototype.sent=0,mxSession.prototype.received=0,mxSession.prototype.debug=!1,mxSession.prototype.connected=!1,mxSession.prototype.suspended=!1,mxSession.prototype.polling=!1,mxSession.prototype.start=function(){this.debug?(this.connected=!0,this.fireEvent(new mxEventObject(mxEvent.CONNECT))):this.connected||this.get(this.urlInit,mxUtils.bind(this,function(){this.connected=!0,this.fireEvent(new mxEventObject(mxEvent.CONNECT)),this.poll()}))},mxSession.prototype.suspend=function(){this.connected&&!this.suspended&&(this.suspended=!0,this.fireEvent(new mxEventObject(mxEvent.SUSPEND)))},mxSession.prototype.resume=function(){this.connected&&this.suspended&&(this.suspended=!1,this.fireEvent(new mxEventObject(mxEvent.RESUME)),this.polling||this.poll())},mxSession.prototype.stop=function(t){this.connected&&(this.connected=!1),this.fireEvent(new mxEventObject(mxEvent.DISCONNECT,"reason",t))},mxSession.prototype.poll=function(){this.connected&&!this.suspended&&null!=this.urlPoll?(this.polling=!0,this.get(this.urlPoll,mxUtils.bind(this,function(){this.poll()}))):this.polling=!1},mxSession.prototype.notify=function(t,e,n){null!=t&&0<t.length&&(null!=this.urlNotify&&(this.debug?(mxLog.show(),mxLog.debug("mxSession.notify: "+this.urlNotify+" xml="+t)):(t="<message><delta>"+t+"</delta></message>",this.escapePostData&&(t=encodeURIComponent(t)),mxUtils.post(this.urlNotify,"xml="+t,e,n))),this.sent+=t.length,this.fireEvent(new mxEventObject(mxEvent.NOTIFY,"url",this.urlNotify,"xml",t)))},mxSession.prototype.get=function(t,e,n){if("undefined"!=typeof mxUtils){var i=mxUtils.bind(this,function(t){null!=n?n(t):this.stop(t)});mxUtils.get(t,mxUtils.bind(this,function(n){if("undefined"!=typeof mxUtils)if(n.isReady()&&404!=n.getStatus()){if(this.received+=n.getText().length,this.fireEvent(new mxEventObject(mxEvent.GET,"url",t,"request",n)),this.isValidResponse(n)){if(0<n.getText().length){var o=n.getDocumentElement();null==o?i("Invalid response: "+n.getText()):this.receive(o)}null!=e&&e(n)}}else i("Response not ready")}),function(){i("Transmission error")})}},mxSession.prototype.isValidResponse=function(t){return 0>t.getText().indexOf("<?php")},mxSession.prototype.encodeChanges=function(t,e){for(var n="",i=e?-1:1,o=e?t.length-1:0;o>=0&&o<t.length;o+=i)var r=this.codec.encode(t[o]),n=n+mxUtils.getXml(r,this.linefeed);return n},mxSession.prototype.receive=function(t){if(null!=t&&t.nodeType==mxConstants.NODETYPE_ELEMENT){var e=t.getAttribute("namespace");for(null!=e&&(this.model.prefix=e+"-"),e=t.firstChild;null!=e;){var n=e.nodeName.toLowerCase();"state"==n?this.processState(e):"delta"==n&&this.processDelta(e),e=e.nextSibling}this.fireEvent(new mxEventObject(mxEvent.RECEIVE,"node",t))}},mxSession.prototype.processState=function(t){new mxCodec(t.ownerDocument).decode(t.firstChild,this.model)},mxSession.prototype.processDelta=function(t){for(t=t.firstChild;null!=t;)"edit"==t.nodeName&&this.processEdit(t),t=t.nextSibling},mxSession.prototype.processEdit=function(t){if(t=this.decodeChanges(t),0<t.length){var e=this.createUndoableEdit(t);this.model.fireEvent(new mxEventObject(mxEvent.CHANGE,"edit",e,"changes",t)),this.model.fireEvent(new mxEventObject(mxEvent.UNDO,"edit",e)),this.fireEvent(new mxEventObject(mxEvent.FIRED,"edit",e))}},mxSession.prototype.createUndoableEdit=function(t){var e=new mxUndoableEdit(this.model,this.significantRemoteChanges);return e.changes=t,e.notify=function(){e.source.fireEvent(new mxEventObject(mxEvent.CHANGE,"edit",e,"changes",e.changes)),e.source.fireEvent(new mxEventObject(mxEvent.NOTIFY,"edit",e,"changes",e.changes))},e},mxSession.prototype.decodeChanges=function(t){this.codec.document=t.ownerDocument;var e=[];for(t=t.firstChild;null!=t;){var n=this.decodeChange(t);null!=n&&e.push(n),t=t.nextSibling}return e},mxSession.prototype.decodeChange=function(t){var e=null;return t.nodeType==mxConstants.NODETYPE_ELEMENT&&(e="mxRootChange"==t.nodeName?new mxCodec(t.ownerDocument).decode(t):this.codec.decode(t),null!=e&&(e.model=this.model,e.execute(),"mxChildChange"==t.nodeName&&null==e.parent&&this.cellRemoved(e.child))),e},mxSession.prototype.cellRemoved=function(t){this.codec.putObject(t.getId(),t);for(var e=this.model.getChildCount(t),n=0;e>n;n++)this.cellRemoved(this.model.getChildAt(t,n))},mxUndoableEdit.prototype.source=null,mxUndoableEdit.prototype.changes=null,mxUndoableEdit.prototype.significant=null,mxUndoableEdit.prototype.undone=!1,mxUndoableEdit.prototype.redone=!1,mxUndoableEdit.prototype.isEmpty=function(){return 0==this.changes.length},mxUndoableEdit.prototype.isSignificant=function(){return this.significant},mxUndoableEdit.prototype.add=function(t){this.changes.push(t)},mxUndoableEdit.prototype.notify=function(){},mxUndoableEdit.prototype.die=function(){},mxUndoableEdit.prototype.undo=function(){if(!this.undone){this.source.fireEvent(new mxEventObject(mxEvent.START_EDIT));for(var t=this.changes.length-1;t>=0;t--){var e=this.changes[t];null!=e.execute?e.execute():null!=e.undo&&e.undo(),this.source.fireEvent(new mxEventObject(mxEvent.EXECUTED,"change",e))}this.undone=!0,this.redone=!1,this.source.fireEvent(new mxEventObject(mxEvent.END_EDIT))}this.notify()},mxUndoableEdit.prototype.redo=function(){if(!this.redone){this.source.fireEvent(new mxEventObject(mxEvent.START_EDIT));for(var t=this.changes.length,e=0;t>e;e++){var n=this.changes[e];null!=n.execute?n.execute():null!=n.redo&&n.redo(),this.source.fireEvent(new mxEventObject(mxEvent.EXECUTED,"change",n))}this.undone=!1,this.redone=!0,this.source.fireEvent(new mxEventObject(mxEvent.END_EDIT))}this.notify()},mxUndoManager.prototype=new mxEventSource,mxUndoManager.prototype.constructor=mxUndoManager,mxUndoManager.prototype.size=null,mxUndoManager.prototype.history=null,mxUndoManager.prototype.indexOfNextAdd=0,mxUndoManager.prototype.isEmpty=function(){return 0==this.history.length},mxUndoManager.prototype.clear=function(){this.history=[],this.indexOfNextAdd=0,this.fireEvent(new mxEventObject(mxEvent.CLEAR))},mxUndoManager.prototype.canUndo=function(){return 0<this.indexOfNextAdd},mxUndoManager.prototype.undo=function(){for(;0<this.indexOfNextAdd;){var t=this.history[--this.indexOfNextAdd];if(t.undo(),t.isSignificant()){this.fireEvent(new mxEventObject(mxEvent.UNDO,"edit",t));break}}},mxUndoManager.prototype.canRedo=function(){return this.indexOfNextAdd<this.history.length},mxUndoManager.prototype.redo=function(){for(var t=this.history.length;this.indexOfNextAdd<t;){var e=this.history[this.indexOfNextAdd++];if(e.redo(),e.isSignificant()){this.fireEvent(new mxEventObject(mxEvent.REDO,"edit",e));break}}},mxUndoManager.prototype.undoableEditHappened=function(t){this.trim(),0<this.size&&this.size==this.history.length&&this.history.shift(),this.history.push(t),this.indexOfNextAdd=this.history.length,this.fireEvent(new mxEventObject(mxEvent.ADD,"edit",t))},mxUndoManager.prototype.trim=function(){if(this.history.length>this.indexOfNextAdd)for(var t=this.history.splice(this.indexOfNextAdd,this.history.length-this.indexOfNextAdd),e=0;e<t.length;e++)t[e].die()};var mxUrlConverter=function(){var t=!0,e=null,n=null;return{isEnabled:function(){return t},setEnabled:function(e){t=e},getBaseUrl:function(){return e},setBaseUrl:function(t){e=t},getBaseDomain:function(){return e},setBaseDomain:function(t){e=t},isRelativeUrl:function(t){return"http://"!=t.substring(0,7)&&"https://"!=t.substring(0,8)&&"data:image"!=t.substring(0,10)},convert:function(i){if(t&&this.isRelativeUrl(i)){if(null==e){n=location.protocol+"//"+location.host,e=n+location.pathname;var o=e.lastIndexOf("/");o>0&&(e=e.substring(0,o+1))}i="/"==i.charAt(0)?n+i:e+i}return i}}};mxPanningManager.prototype.damper=1/6,mxPanningManager.prototype.delay=10,mxPanningManager.prototype.handleMouseOut=!0,mxPanningManager.prototype.border=0,mxPopupMenu.prototype=new mxEventSource,mxPopupMenu.prototype.constructor=mxPopupMenu,mxPopupMenu.prototype.submenuImage=mxClient.imageBasePath+"/submenu.gif",mxPopupMenu.prototype.zIndex=10006,mxPopupMenu.prototype.factoryMethod=null,mxPopupMenu.prototype.useLeftButtonForPopup=!1,mxPopupMenu.prototype.enabled=!0,mxPopupMenu.prototype.itemCount=0,mxPopupMenu.prototype.autoExpand=!1,mxPopupMenu.prototype.smartSeparators=!1,mxPopupMenu.prototype.labels=!0,mxPopupMenu.prototype.init=function(){this.table=document.createElement("table"),this.table.className="mxPopupMenu",this.tbody=document.createElement("tbody"),this.table.appendChild(this.tbody),this.div=document.createElement("div"),this.div.className="mxPopupMenu",this.div.style.display="inline",this.div.style.zIndex=this.zIndex,this.div.appendChild(this.table),mxEvent.disableContextMenu(this.div)},mxPopupMenu.prototype.isEnabled=function(){return this.enabled},mxPopupMenu.prototype.setEnabled=function(t){this.enabled=t},mxPopupMenu.prototype.isPopupTrigger=function(t){return t.isPopupTrigger()||this.useLeftButtonForPopup&&mxEvent.isLeftMouseButton(t.getEvent())},mxPopupMenu.prototype.addItem=function(t,e,n,i,o,r){i=i||this,this.itemCount++,i.willAddSeparator&&(i.containsItems&&this.addSeparator(i,!0),i.willAddSeparator=!1),i.containsItems=!0;var s=document.createElement("tr");s.className="mxPopupMenuItem";var l=document.createElement("td");return l.className="mxPopupMenuIcon",null!=e?(o=document.createElement("img"),o.src=e,l.appendChild(o)):null!=o&&(e=document.createElement("div"),e.className=o,l.appendChild(e)),s.appendChild(l),this.labels&&(l=document.createElement("td"),l.className="mxPopupMenuItem"+(null==r||r?"":" disabled"),mxUtils.write(l,t),l.align="left",s.appendChild(l),t=document.createElement("td"),t.className="mxPopupMenuItem"+(null==r||r?"":" disabled"),t.style.paddingRight="6px",t.style.textAlign="right",s.appendChild(t),null==i.div&&this.createSubmenu(i)),i.tbody.appendChild(s),(null==r||r)&&(mxEvent.addGestureListeners(s,mxUtils.bind(this,function(t){this.eventReceiver=s,i.activeRow!=s&&i.activeRow!=i&&(null!=i.activeRow&&null!=i.activeRow.div.parentNode&&this.hideSubmenu(i),null!=s.div&&(this.showSubmenu(i,s),i.activeRow=s)),mxEvent.consume(t)}),mxUtils.bind(this,function(){i.activeRow!=s&&i.activeRow!=i&&(null!=i.activeRow&&null!=i.activeRow.div.parentNode&&this.hideSubmenu(i),this.autoExpand&&null!=s.div&&(this.showSubmenu(i,s),i.activeRow=s)),s.className="mxPopupMenuItemHover"}),mxUtils.bind(this,function(t){this.eventReceiver==s&&(i.activeRow!=s&&this.hideMenu(),null!=n&&n(t)),this.eventReceiver=null,mxEvent.consume(t)})),mxEvent.addListener(s,"mouseout",mxUtils.bind(this,function(){s.className="mxPopupMenuItem"}))),s},mxPopupMenu.prototype.createSubmenu=function(t){t.table=document.createElement("table"),t.table.className="mxPopupMenu",t.tbody=document.createElement("tbody"),t.table.appendChild(t.tbody),t.div=document.createElement("div"),t.div.className="mxPopupMenu",t.div.style.position="absolute",t.div.style.display="inline",t.div.style.zIndex=this.zIndex,t.div.appendChild(t.table);var e=document.createElement("img");e.setAttribute("src",this.submenuImage),td=t.firstChild.nextSibling.nextSibling,td.appendChild(e)},mxPopupMenu.prototype.showSubmenu=function(t,e){if(null!=e.div){e.div.style.left=t.div.offsetLeft+e.offsetLeft+e.offsetWidth-1+"px",e.div.style.top=t.div.offsetTop+e.offsetTop+"px",document.body.appendChild(e.div);
var n=parseInt(e.div.offsetLeft),i=parseInt(e.div.offsetWidth),o=document.body,r=document.documentElement;n+i>(o.scrollLeft||r.scrollLeft)+(o.clientWidth||r.clientWidth)&&(e.div.style.left=t.div.offsetLeft-i+(mxClient.IS_IE?6:-6)+"px"),mxUtils.fit(e.div)}},mxPopupMenu.prototype.addSeparator=function(t,e){if(t=t||this,this.smartSeparators&&!e)t.willAddSeparator=!0;else if(null!=t.tbody){t.willAddSeparator=!1;var n=document.createElement("tr"),i=document.createElement("td");i.className="mxPopupMenuIcon",i.style.padding="0 0 0 0px",n.appendChild(i),i=document.createElement("td"),i.style.padding="0 0 0 0px",i.setAttribute("colSpan","2");var o=document.createElement("hr");o.setAttribute("size","1"),i.appendChild(o),n.appendChild(i),t.tbody.appendChild(n)}},mxPopupMenu.prototype.popup=function(t,e,n,i){if(null!=this.div&&null!=this.tbody&&null!=this.factoryMethod){for(this.div.style.left=t+"px",this.div.style.top=e+"px";null!=this.tbody.firstChild;)mxEvent.release(this.tbody.firstChild),this.tbody.removeChild(this.tbody.firstChild);this.itemCount=0,this.factoryMethod(this,n,i),0<this.itemCount&&(this.showMenu(),this.fireEvent(new mxEventObject(mxEvent.SHOW)))}},mxPopupMenu.prototype.isMenuShowing=function(){return null!=this.div&&this.div.parentNode==document.body},mxPopupMenu.prototype.showMenu=function(){9<=document.documentMode&&(this.div.style.filter="none"),document.body.appendChild(this.div),mxUtils.fit(this.div)},mxPopupMenu.prototype.hideMenu=function(){null!=this.div&&(null!=this.div.parentNode&&this.div.parentNode.removeChild(this.div),this.hideSubmenu(this),this.containsItems=!1)},mxPopupMenu.prototype.hideSubmenu=function(t){null!=t.activeRow&&(this.hideSubmenu(t.activeRow),null!=t.activeRow.div.parentNode&&t.activeRow.div.parentNode.removeChild(t.activeRow.div),t.activeRow=null)},mxPopupMenu.prototype.destroy=function(){null!=this.div&&(mxEvent.release(this.div),null!=this.div.parentNode&&this.div.parentNode.removeChild(this.div),this.div=null)},mxAutoSaveManager.prototype=new mxEventSource,mxAutoSaveManager.prototype.constructor=mxAutoSaveManager,mxAutoSaveManager.prototype.graph=null,mxAutoSaveManager.prototype.autoSaveDelay=10,mxAutoSaveManager.prototype.autoSaveThrottle=2,mxAutoSaveManager.prototype.autoSaveThreshold=5,mxAutoSaveManager.prototype.ignoredChanges=0,mxAutoSaveManager.prototype.lastSnapshot=0,mxAutoSaveManager.prototype.enabled=!0,mxAutoSaveManager.prototype.changeHandler=null,mxAutoSaveManager.prototype.isEnabled=function(){return this.enabled},mxAutoSaveManager.prototype.setEnabled=function(t){this.enabled=t},mxAutoSaveManager.prototype.setGraph=function(t){null!=this.graph&&this.graph.getModel().removeListener(this.changeHandler),this.graph=t,null!=this.graph&&this.graph.getModel().addListener(mxEvent.CHANGE,this.changeHandler)},mxAutoSaveManager.prototype.save=function(){},mxAutoSaveManager.prototype.graphModelChanged=function(t){t=((new Date).getTime()-this.lastSnapshot)/1e3,t>this.autoSaveDelay||this.ignoredChanges>=this.autoSaveThreshold&&t>this.autoSaveThrottle?(this.save(),this.reset()):this.ignoredChanges++},mxAutoSaveManager.prototype.reset=function(){this.lastSnapshot=(new Date).getTime(),this.ignoredChanges=0},mxAutoSaveManager.prototype.destroy=function(){this.setGraph(null)},mxAnimation.prototype=new mxEventSource,mxAnimation.prototype.constructor=mxAnimation,mxAnimation.prototype.delay=null,mxAnimation.prototype.thread=null,mxAnimation.prototype.startAnimation=function(){null==this.thread&&(this.thread=window.setInterval(mxUtils.bind(this,this.updateAnimation),this.delay))},mxAnimation.prototype.updateAnimation=function(){this.fireEvent(new mxEventObject(mxEvent.EXECUTE))},mxAnimation.prototype.stopAnimation=function(){null!=this.thread&&(window.clearInterval(this.thread),this.thread=null,this.fireEvent(new mxEventObject(mxEvent.DONE)))},mxMorphing.prototype=new mxAnimation,mxMorphing.prototype.constructor=mxMorphing,mxMorphing.prototype.graph=null,mxMorphing.prototype.steps=null,mxMorphing.prototype.step=0,mxMorphing.prototype.ease=null,mxMorphing.prototype.cells=null,mxMorphing.prototype.updateAnimation=function(){var t=new mxCellStatePreview(this.graph);if(null!=this.cells)for(var e=0;e<this.cells.length;e++)this.animateCell(cells[e],t,!1);else this.animateCell(this.graph.getModel().getRoot(),t,!0);this.show(t),(t.isEmpty()||this.step++>=this.steps)&&this.stopAnimation()},mxMorphing.prototype.show=function(t){t.show()},mxMorphing.prototype.animateCell=function(t,e,n){var i=this.graph.getView().getState(t),o=null;if(null!=i&&(o=this.getDelta(i),this.graph.getModel().isVertex(t)&&(0!=o.x||0!=o.y))){var r=this.graph.view.getTranslate(),s=this.graph.view.getScale();o.x+=r.x*s,o.y+=r.y*s,e.moveState(i,-o.x/this.ease,-o.y/this.ease)}if(n&&!this.stopRecursion(i,o))for(i=this.graph.getModel().getChildCount(t),o=0;i>o;o++)this.animateCell(this.graph.getModel().getChildAt(t,o),e,n)},mxMorphing.prototype.stopRecursion=function(t,e){return null!=e&&(0!=e.x||0!=e.y)},mxMorphing.prototype.getDelta=function(t){var e=this.getOriginForCell(t.cell),n=this.graph.getView().getTranslate(),i=this.graph.getView().getScale();return t=new mxPoint(t.x/i-n.x,t.y/i-n.y),new mxPoint((e.x-t.x)*i,(e.y-t.y)*i)},mxMorphing.prototype.getOriginForCell=function(t){var e=null;return null!=t&&(e=this.getOriginForCell(this.graph.getModel().getParent(t)),t=this.graph.getCellGeometry(t),null!=t&&(e.x+=t.x,e.y+=t.y)),null==e&&(e=this.graph.view.getTranslate(),e=new mxPoint(-e.x,-e.y)),e},mxImageBundle.prototype.images=null,mxImageBundle.prototype.images=null,mxImageBundle.prototype.putImage=function(t,e,n){this.images[t]={value:e,fallback:n}},mxImageBundle.prototype.getImage=function(t){var e=null;return null!=t&&(t=this.images[t],null!=t&&(e=this.alt?t.fallback:t.value)),e},mxImageExport.prototype.includeOverlays=!1,mxImageExport.prototype.drawState=function(t,e){null!=t&&(this.visitStatesRecursive(t,e,this.drawCellState),this.includeOverlays&&this.visitStatesRecursive(t,e,this.drawOverlays))},mxImageExport.prototype.visitStatesRecursive=function(t,e,n){if(null!=t){n(t,e);for(var i=t.view.graph,o=i.model.getChildCount(t.cell),r=0;o>r;r++){var s=i.view.getState(i.model.getChildAt(t.cell,r));this.visitStatesRecursive(s,e,n)}}},mxImageExport.prototype.drawCellState=function(t,e){t.shape instanceof mxShape&&(e.save(),t.shape.paint(e),e.restore()),null!=t.text&&(e.save(),t.text.paint(e),e.restore())},mxImageExport.prototype.drawOverlays=function(t,e){null!=t.overlays&&t.overlays.visit(function(t,n){n instanceof mxShape&&n.paint(e)})},mxAbstractCanvas2D.prototype.state=null,mxAbstractCanvas2D.prototype.states=null,mxAbstractCanvas2D.prototype.path=null,mxAbstractCanvas2D.prototype.rotateHtml=!0,mxAbstractCanvas2D.prototype.lastX=0,mxAbstractCanvas2D.prototype.lastY=0,mxAbstractCanvas2D.prototype.moveOp="M",mxAbstractCanvas2D.prototype.lineOp="L",mxAbstractCanvas2D.prototype.quadOp="Q",mxAbstractCanvas2D.prototype.curveOp="C",mxAbstractCanvas2D.prototype.closeOp="Z",mxAbstractCanvas2D.prototype.pointerEvents=!1,mxAbstractCanvas2D.prototype.createUrlConverter=function(){return new mxUrlConverter},mxAbstractCanvas2D.prototype.reset=function(){this.state=this.createState(),this.states=[]},mxAbstractCanvas2D.prototype.createState=function(){return{dx:0,dy:0,scale:1,alpha:1,fillColor:null,fillAlpha:1,gradientColor:null,gradientAlpha:1,gradientDirection:null,strokeColor:null,strokeWidth:1,dashed:!1,dashPattern:"3 3",lineCap:"flat",lineJoin:"miter",miterLimit:10,fontColor:"#000000",fontBackgroundColor:null,fontBorderColor:null,fontSize:mxConstants.DEFAULT_FONTSIZE,fontFamily:mxConstants.DEFAULT_FONTFAMILY,fontStyle:0,shadow:!1,shadowColor:mxConstants.SHADOWCOLOR,shadowAlpha:mxConstants.SHADOW_OPACITY,shadowDx:mxConstants.SHADOW_OFFSET_X,shadowDy:mxConstants.SHADOW_OFFSET_Y,rotation:0,rotationCx:0,rotationCy:0}},mxAbstractCanvas2D.prototype.format=function(t){return Math.round(parseFloat(t))},mxAbstractCanvas2D.prototype.addOp=function(){if(null!=this.path&&(this.path.push(arguments[0]),2<arguments.length))for(var t=this.state,e=2;e<arguments.length;e+=2)this.lastX=arguments[e-1],this.lastY=arguments[e],this.path.push(this.format((this.lastX+t.dx)*t.scale)),this.path.push(this.format((this.lastY+t.dy)*t.scale))},mxAbstractCanvas2D.prototype.rotatePoint=function(t,e,n,i,o){return n*=Math.PI/180,mxUtils.getRotatedPoint(new mxPoint(t,e),Math.cos(n),Math.sin(n),new mxPoint(i,o))},mxAbstractCanvas2D.prototype.save=function(){this.states.push(this.state),this.state=mxUtils.clone(this.state)},mxAbstractCanvas2D.prototype.restore=function(){this.state=this.states.pop()},mxAbstractCanvas2D.prototype.scale=function(t){this.state.scale*=t,this.state.strokeWidth*=t},mxAbstractCanvas2D.prototype.translate=function(t,e){this.state.dx+=t,this.state.dy+=e},mxAbstractCanvas2D.prototype.setAlpha=function(t){this.state.alpha=t},mxAbstractCanvas2D.prototype.setFillColor=function(t){t==mxConstants.NONE&&(t=null),this.state.fillColor=t,this.state.gradientColor=null},mxAbstractCanvas2D.prototype.setGradient=function(t,e,n,i,o,r,s,l,a){n=this.state,n.fillColor=t,n.fillAlpha=null!=l?l:1,n.gradientColor=e,n.gradientAlpha=null!=a?a:1,n.gradientDirection=s},mxAbstractCanvas2D.prototype.setStrokeColor=function(t){t==mxConstants.NONE&&(t=null),this.state.strokeColor=t},mxAbstractCanvas2D.prototype.setStrokeWidth=function(t){this.state.strokeWidth=t},mxAbstractCanvas2D.prototype.setDashed=function(t){this.state.dashed=t},mxAbstractCanvas2D.prototype.setDashPattern=function(t){this.state.dashPattern=t},mxAbstractCanvas2D.prototype.setLineCap=function(t){this.state.lineCap=t},mxAbstractCanvas2D.prototype.setLineJoin=function(t){this.state.lineJoin=t},mxAbstractCanvas2D.prototype.setMiterLimit=function(t){this.state.miterLimit=t},mxAbstractCanvas2D.prototype.setFontColor=function(t){t==mxConstants.NONE&&(t=null),this.state.fontColor=t},mxAbstractCanvas2D.prototype.setFontBackgroundColor=function(t){t==mxConstants.NONE&&(t=null),this.state.fontBackgroundColor=t},mxAbstractCanvas2D.prototype.setFontBorderColor=function(t){t==mxConstants.NONE&&(t=null),this.state.fontBorderColor=t},mxAbstractCanvas2D.prototype.setFontSize=function(t){this.state.fontSize=t},mxAbstractCanvas2D.prototype.setFontFamily=function(t){this.state.fontFamily=t},mxAbstractCanvas2D.prototype.setFontStyle=function(t){null==t&&(t=0),this.state.fontStyle=t},mxAbstractCanvas2D.prototype.setShadow=function(t){this.state.shadow=t},mxAbstractCanvas2D.prototype.setShadowColor=function(t){t==mxConstants.NONE&&(t=null),this.state.shadowColor=t},mxAbstractCanvas2D.prototype.setShadowAlpha=function(t){this.state.shadowAlpha=t},mxAbstractCanvas2D.prototype.setShadowOffset=function(t,e){this.state.shadowDx=t,this.state.shadowDy=e},mxAbstractCanvas2D.prototype.begin=function(){this.lastY=this.lastX=0,this.path=[]},mxAbstractCanvas2D.prototype.moveTo=function(t,e){this.addOp(this.moveOp,t,e)},mxAbstractCanvas2D.prototype.lineTo=function(t,e){this.addOp(this.lineOp,t,e)},mxAbstractCanvas2D.prototype.quadTo=function(t,e,n,i){this.addOp(this.quadOp,t,e,n,i)},mxAbstractCanvas2D.prototype.curveTo=function(t,e,n,i,o,r){this.addOp(this.curveOp,t,e,n,i,o,r)},mxAbstractCanvas2D.prototype.arcTo=function(t,e,n,i,o,r,s){for(t=mxUtils.arcToCurves(this.lastX,this.lastY,t,e,n,i,o,r,s),e=0;e<t.length;e+=6)this.curveTo(t[e],t[e+1],t[e+2],t[e+3],t[e+4],t[e+5])},mxAbstractCanvas2D.prototype.close=function(){this.addOp(this.closeOp)},mxAbstractCanvas2D.prototype.end=function(){},mxUtils.extend(mxXmlCanvas2D,mxAbstractCanvas2D),mxXmlCanvas2D.prototype.textEnabled=!0,mxXmlCanvas2D.prototype.compressed=!0,mxXmlCanvas2D.prototype.writeDefaults=function(){var t;t=this.createElement("fontfamily"),t.setAttribute("family",mxConstants.DEFAULT_FONTFAMILY),this.root.appendChild(t),t=this.createElement("fontsize"),t.setAttribute("size",mxConstants.DEFAULT_FONTSIZE),this.root.appendChild(t),t=this.createElement("shadowcolor"),t.setAttribute("color",mxConstants.SHADOWCOLOR),this.root.appendChild(t),t=this.createElement("shadowalpha"),t.setAttribute("alpha",mxConstants.SHADOW_OPACITY),this.root.appendChild(t),t=this.createElement("shadowoffset"),t.setAttribute("dx",mxConstants.SHADOW_OFFSET_X),t.setAttribute("dy",mxConstants.SHADOW_OFFSET_Y),this.root.appendChild(t)},mxXmlCanvas2D.prototype.format=function(t){return parseFloat(parseFloat(t).toFixed(2))},mxXmlCanvas2D.prototype.createElement=function(t){return this.root.ownerDocument.createElement(t)},mxXmlCanvas2D.prototype.save=function(){this.compressed&&mxAbstractCanvas2D.prototype.save.apply(this,arguments),this.root.appendChild(this.createElement("save"))},mxXmlCanvas2D.prototype.restore=function(){this.compressed&&mxAbstractCanvas2D.prototype.restore.apply(this,arguments),this.root.appendChild(this.createElement("restore"))},mxXmlCanvas2D.prototype.scale=function(t){if(this.compressed){if(this.state.scale==t)return;mxAbstractCanvas2D.prototype.setAlpha.apply(this,arguments)}var e=this.createElement("scale");e.setAttribute("scale",t),this.root.appendChild(e)},mxXmlCanvas2D.prototype.translate=function(t,e){var n=this.createElement("translate");n.setAttribute("dx",this.format(t)),n.setAttribute("dy",this.format(e)),this.root.appendChild(n)},mxXmlCanvas2D.prototype.rotate=function(t,e,n,i,o){var r=this.createElement("rotate");(0!=t||e||n)&&(r.setAttribute("theta",this.format(t)),r.setAttribute("flipH",e?"1":"0"),r.setAttribute("flipV",n?"1":"0"),r.setAttribute("cx",this.format(i)),r.setAttribute("cy",this.format(o)),this.root.appendChild(r))},mxXmlCanvas2D.prototype.setAlpha=function(t){if(this.compressed){if(this.state.alpha==t)return;mxAbstractCanvas2D.prototype.setAlpha.apply(this,arguments)}var e=this.createElement("alpha");e.setAttribute("alpha",this.format(t)),this.root.appendChild(e)},mxXmlCanvas2D.prototype.setFillColor=function(t){if(t==mxConstants.NONE&&(t=null),this.compressed){if(this.state.fillColor==t)return;mxAbstractCanvas2D.prototype.setFillColor.apply(this,arguments)}var e=this.createElement("fillcolor");e.setAttribute("color",null!=t?t:mxConstants.NONE),this.root.appendChild(e)},mxXmlCanvas2D.prototype.setGradient=function(t,e,n,i,o,r,s,l,a){if(null!=t&&null!=e){mxAbstractCanvas2D.prototype.setGradient.apply(this,arguments);var h=this.createElement("gradient");h.setAttribute("c1",t),h.setAttribute("c2",e),h.setAttribute("x",this.format(n)),h.setAttribute("y",this.format(i)),h.setAttribute("w",this.format(o)),h.setAttribute("h",this.format(r)),null!=s&&h.setAttribute("direction",s),null!=l&&h.setAttribute("alpha1",l),null!=a&&h.setAttribute("alpha2",a),this.root.appendChild(h)}},mxXmlCanvas2D.prototype.setStrokeColor=function(t){if(t==mxConstants.NONE&&(t=null),this.compressed){if(this.state.strokeColor==t)return;mxAbstractCanvas2D.prototype.setStrokeColor.apply(this,arguments)}var e=this.createElement("strokecolor");e.setAttribute("color",null!=t?t:mxConstants.NONE),this.root.appendChild(e)},mxXmlCanvas2D.prototype.setStrokeWidth=function(t){if(this.compressed){if(this.state.strokeWidth==t)return;mxAbstractCanvas2D.prototype.setStrokeWidth.apply(this,arguments)}var e=this.createElement("strokewidth");e.setAttribute("width",this.format(t)),this.root.appendChild(e)},mxXmlCanvas2D.prototype.setDashed=function(t){if(this.compressed){if(this.state.dashed==t)return;mxAbstractCanvas2D.prototype.setDashed.apply(this,arguments)}var e=this.createElement("dashed");e.setAttribute("dashed",t?"1":"0"),this.root.appendChild(e)},mxXmlCanvas2D.prototype.setDashPattern=function(t){if(this.compressed){if(this.state.dashPattern==t)return;mxAbstractCanvas2D.prototype.setDashPattern.apply(this,arguments)}var e=this.createElement("dashpattern");e.setAttribute("pattern",t),this.root.appendChild(e)},mxXmlCanvas2D.prototype.setLineCap=function(t){if(this.compressed){if(this.state.lineCap==t)return;mxAbstractCanvas2D.prototype.setLineCap.apply(this,arguments)}var e=this.createElement("linecap");e.setAttribute("cap",t),this.root.appendChild(e)},mxXmlCanvas2D.prototype.setLineJoin=function(t){if(this.compressed){if(this.state.lineJoin==t)return;mxAbstractCanvas2D.prototype.setLineJoin.apply(this,arguments)}var e=this.createElement("linejoin");e.setAttribute("join",t),this.root.appendChild(e)},mxXmlCanvas2D.prototype.setMiterLimit=function(t){if(this.compressed){if(this.state.miterLimit==t)return;mxAbstractCanvas2D.prototype.setMiterLimit.apply(this,arguments)}var e=this.createElement("miterlimit");e.setAttribute("limit",t),this.root.appendChild(e)},mxXmlCanvas2D.prototype.setFontColor=function(t){if(this.textEnabled){if(t==mxConstants.NONE&&(t=null),this.compressed){if(this.state.fontColor==t)return;mxAbstractCanvas2D.prototype.setFontColor.apply(this,arguments)}var e=this.createElement("fontcolor");e.setAttribute("color",null!=t?t:mxConstants.NONE),this.root.appendChild(e)}},mxXmlCanvas2D.prototype.setFontBackgroundColor=function(t){if(this.textEnabled){if(t==mxConstants.NONE&&(t=null),this.compressed){if(this.state.fontBackgroundColor==t)return;mxAbstractCanvas2D.prototype.setFontBackgroundColor.apply(this,arguments)}var e=this.createElement("fontbackgroundcolor");e.setAttribute("color",null!=t?t:mxConstants.NONE),this.root.appendChild(e)}},mxXmlCanvas2D.prototype.setFontBorderColor=function(t){if(this.textEnabled){if(t==mxConstants.NONE&&(t=null),this.compressed){if(this.state.fontBorderColor==t)return;mxAbstractCanvas2D.prototype.setFontBorderColor.apply(this,arguments)}var e=this.createElement("fontbordercolor");e.setAttribute("color",null!=t?t:mxConstants.NONE),this.root.appendChild(e)}},mxXmlCanvas2D.prototype.setFontSize=function(t){if(this.textEnabled){if(this.compressed){if(this.state.fontSize==t)return;mxAbstractCanvas2D.prototype.setFontSize.apply(this,arguments)}var e=this.createElement("fontsize");e.setAttribute("size",t),this.root.appendChild(e)}},mxXmlCanvas2D.prototype.setFontFamily=function(t){if(this.textEnabled){if(this.compressed){if(this.state.fontFamily==t)return;mxAbstractCanvas2D.prototype.setFontFamily.apply(this,arguments)}var e=this.createElement("fontfamily");e.setAttribute("family",t),this.root.appendChild(e)}},mxXmlCanvas2D.prototype.setFontStyle=function(t){if(this.textEnabled){if(null==t&&(t=0),this.compressed){if(this.state.fontStyle==t)return;mxAbstractCanvas2D.prototype.setFontStyle.apply(this,arguments)}var e=this.createElement("fontstyle");e.setAttribute("style",t),this.root.appendChild(e)}},mxXmlCanvas2D.prototype.setShadow=function(t){if(this.compressed){if(this.state.shadow==t)return;mxAbstractCanvas2D.prototype.setShadow.apply(this,arguments)}var e=this.createElement("shadow");e.setAttribute("enabled",t?"1":"0"),this.root.appendChild(e)},mxXmlCanvas2D.prototype.setShadowColor=function(t){if(this.compressed){if(t==mxConstants.NONE&&(t=null),this.state.shadowColor==t)return;mxAbstractCanvas2D.prototype.setShadowColor.apply(this,arguments)}var e=this.createElement("shadowcolor");e.setAttribute("color",null!=t?t:mxConstants.NONE),this.root.appendChild(e)},mxXmlCanvas2D.prototype.setShadowAlpha=function(t){if(this.compressed){if(this.state.shadowAlpha==t)return;mxAbstractCanvas2D.prototype.setShadowAlpha.apply(this,arguments)}var e=this.createElement("shadowalpha");e.setAttribute("alpha",t),this.root.appendChild(e)},mxXmlCanvas2D.prototype.setShadowOffset=function(t,e){if(this.compressed){if(this.state.shadowDx==t&&this.state.shadowDy==e)return;mxAbstractCanvas2D.prototype.setShadowOffset.apply(this,arguments)}var n=this.createElement("shadowoffset");n.setAttribute("dx",t),n.setAttribute("dy",e),this.root.appendChild(n)},mxXmlCanvas2D.prototype.rect=function(t,e,n,i){var o=this.createElement("rect");o.setAttribute("x",this.format(t)),o.setAttribute("y",this.format(e)),o.setAttribute("w",this.format(n)),o.setAttribute("h",this.format(i)),this.root.appendChild(o)},mxXmlCanvas2D.prototype.roundrect=function(t,e,n,i,o,r){var s=this.createElement("roundrect");s.setAttribute("x",this.format(t)),s.setAttribute("y",this.format(e)),s.setAttribute("w",this.format(n)),s.setAttribute("h",this.format(i)),s.setAttribute("dx",this.format(o)),s.setAttribute("dy",this.format(r)),this.root.appendChild(s)},mxXmlCanvas2D.prototype.ellipse=function(t,e,n,i){var o=this.createElement("ellipse");o.setAttribute("x",this.format(t)),o.setAttribute("y",this.format(e)),o.setAttribute("w",this.format(n)),o.setAttribute("h",this.format(i)),this.root.appendChild(o)},mxXmlCanvas2D.prototype.image=function(t,e,n,i,o,r,s,l){o=this.converter.convert(o);var a=this.createElement("image");a.setAttribute("x",this.format(t)),a.setAttribute("y",this.format(e)),a.setAttribute("w",this.format(n)),a.setAttribute("h",this.format(i)),a.setAttribute("src",o),a.setAttribute("aspect",r?"1":"0"),a.setAttribute("flipH",s?"1":"0"),a.setAttribute("flipV",l?"1":"0"),this.root.appendChild(a)},mxXmlCanvas2D.prototype.begin=function(){this.root.appendChild(this.createElement("begin")),this.lastY=this.lastX=0},mxXmlCanvas2D.prototype.moveTo=function(t,e){var n=this.createElement("move");n.setAttribute("x",this.format(t)),n.setAttribute("y",this.format(e)),this.root.appendChild(n),this.lastX=t,this.lastY=e},mxXmlCanvas2D.prototype.lineTo=function(t,e){var n=this.createElement("line");n.setAttribute("x",this.format(t)),n.setAttribute("y",this.format(e)),this.root.appendChild(n),this.lastX=t,this.lastY=e},mxXmlCanvas2D.prototype.quadTo=function(t,e,n,i){var o=this.createElement("quad");o.setAttribute("x1",this.format(t)),o.setAttribute("y1",this.format(e)),o.setAttribute("x2",this.format(n)),o.setAttribute("y2",this.format(i)),this.root.appendChild(o),this.lastX=n,this.lastY=i},mxXmlCanvas2D.prototype.curveTo=function(t,e,n,i,o,r){var s=this.createElement("curve");s.setAttribute("x1",this.format(t)),s.setAttribute("y1",this.format(e)),s.setAttribute("x2",this.format(n)),s.setAttribute("y2",this.format(i)),s.setAttribute("x3",this.format(o)),s.setAttribute("y3",this.format(r)),this.root.appendChild(s),this.lastX=o,this.lastY=r},mxXmlCanvas2D.prototype.close=function(){this.root.appendChild(this.createElement("close"))},mxXmlCanvas2D.prototype.text=function(t,e,n,i,o,r,s,l,a,h,d,u){if(this.textEnabled&&null!=o){mxUtils.isNode(o)&&(o=mxUtils.getOuterHtml(o));var c=this.createElement("text");c.setAttribute("x",this.format(t)),c.setAttribute("y",this.format(e)),c.setAttribute("w",this.format(n)),c.setAttribute("h",this.format(i)),c.setAttribute("str",o),null!=r&&c.setAttribute("align",r),null!=s&&c.setAttribute("valign",s),c.setAttribute("wrap",l?"1":"0"),null==a&&(a=""),c.setAttribute("format",a),null!=h&&c.setAttribute("overflow",h),null!=d&&c.setAttribute("clip",d?"1":"0"),null!=u&&c.setAttribute("rotation",u),this.root.appendChild(c)}},mxXmlCanvas2D.prototype.stroke=function(){this.root.appendChild(this.createElement("stroke"))},mxXmlCanvas2D.prototype.fill=function(){this.root.appendChild(this.createElement("fill"))},mxXmlCanvas2D.prototype.fillAndStroke=function(){this.root.appendChild(this.createElement("fillstroke"))},mxUtils.extend(mxSvgCanvas2D,mxAbstractCanvas2D),mxSvgCanvas2D.prototype.node=null,mxSvgCanvas2D.prototype.matchHtmlAlignment=!0,mxSvgCanvas2D.prototype.textEnabled=!0,mxSvgCanvas2D.prototype.foEnabled=!0,mxSvgCanvas2D.prototype.foAltText="[Object]",mxSvgCanvas2D.prototype.strokeTolerance=0,mxSvgCanvas2D.prototype.refCount=0,mxSvgCanvas2D.prototype.blockImagePointerEvents=!1,mxSvgCanvas2D.prototype.reset=function(){mxAbstractCanvas2D.prototype.reset.apply(this,arguments),this.gradients=[]},mxSvgCanvas2D.prototype.createStyle=function(t){return t=this.createElement("style"),t.setAttribute("type","text/css"),mxUtils.write(t,"svg{font-family:"+mxConstants.DEFAULT_FONTFAMILY+";font-size:"+mxConstants.DEFAULT_FONTSIZE+";fill:none;stroke-miterlimit:10}"),t},mxSvgCanvas2D.prototype.createElement=function(t,e){if(null!=this.root.ownerDocument.createElementNS)return this.root.ownerDocument.createElementNS(e||mxConstants.NS_SVG,t);var n=this.root.ownerDocument.createElement(t);return null!=e&&n.setAttribute("xmlns",e),n},mxSvgCanvas2D.prototype.createAlternateContent=function(t,e,n,i,o){return null!=this.foAltText?(t=this.state,e=this.createElement("text"),e.setAttribute("x",Math.round(i/2)),e.setAttribute("y",Math.round((o+t.fontSize)/2)),e.setAttribute("fill",t.fontColor||"black"),e.setAttribute("text-anchor","middle"),e.setAttribute("font-size",Math.round(t.fontSize)+"px"),e.setAttribute("font-family",t.fontFamily),(t.fontStyle&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD&&e.setAttribute("font-weight","bold"),(t.fontStyle&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC&&e.setAttribute("font-style","italic"),(t.fontStyle&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE&&e.setAttribute("text-decoration","underline"),mxUtils.write(e,this.foAltText),e):null},mxSvgCanvas2D.prototype.createGradientId=function(t,e,n,i,o){return"#"==t.charAt(0)&&(t=t.substring(1)),"#"==e.charAt(0)&&(e=e.substring(1)),t=t.toLowerCase()+"-"+n,e=e.toLowerCase()+"-"+i,n=null,null==o||o==mxConstants.DIRECTION_SOUTH?n="s":o==mxConstants.DIRECTION_EAST?n="e":(i=t,t=e,e=i,o==mxConstants.DIRECTION_NORTH?n="s":o==mxConstants.DIRECTION_WEST&&(n="e")),"mx-gradient-"+t+"-"+e+"-"+n},mxSvgCanvas2D.prototype.getSvgGradient=function(t,e,n,i,o){var r=this.createGradientId(t,e,n,i,o),s=this.gradients[r];if(null==s){var l=this.root.ownerSVGElement,a=0,h=r+"-"+a;if(null!=l)for(s=l.ownerDocument.getElementById(h);null!=s&&s.ownerSVGElement!=l;)h=r+"-"+a++,s=l.ownerDocument.getElementById(h);else h="id"+ ++this.refCount;null==s&&(s=this.createSvgGradient(t,e,n,i,o),s.setAttribute("id",h),null!=this.defs?this.defs.appendChild(s):l.appendChild(s)),this.gradients[r]=s}return s.getAttribute("id")},mxSvgCanvas2D.prototype.createSvgGradient=function(t,e,n,i,o){var r=this.createElement("linearGradient");return r.setAttribute("x1","0%"),r.setAttribute("y1","0%"),r.setAttribute("x2","0%"),r.setAttribute("y2","0%"),null==o||o==mxConstants.DIRECTION_SOUTH?r.setAttribute("y2","100%"):o==mxConstants.DIRECTION_EAST?r.setAttribute("x2","100%"):o==mxConstants.DIRECTION_NORTH?r.setAttribute("y1","100%"):o==mxConstants.DIRECTION_WEST&&r.setAttribute("x1","100%"),n=1>n?";stop-opacity:"+n:"",o=this.createElement("stop"),o.setAttribute("offset","0%"),o.setAttribute("style","stop-color:"+t+n),r.appendChild(o),n=1>i?";stop-opacity:"+i:"",o=this.createElement("stop"),o.setAttribute("offset","100%"),o.setAttribute("style","stop-color:"+e+n),r.appendChild(o),r},mxSvgCanvas2D.prototype.addNode=function(t,e){var n=this.node,i=this.state;if(null!=n){if("path"==n.nodeName){if(!(null!=this.path&&0<this.path.length))return;n.setAttribute("d",this.path.join(" "))}t&&null!=i.fillColor?this.updateFill():this.styleEnabled||("ellipse"!=n.nodeName||!mxClient.IS_NS||mxClient.IS_GC||mxClient.IS_SF?n.setAttribute("fill","none"):n.setAttribute("fill","transparent"),t=!1),e&&null!=i.strokeColor?this.updateStroke():this.styleEnabled||n.setAttribute("stroke","none"),null!=i.transform&&0<i.transform.length&&n.setAttribute("transform",i.transform),i.shadow&&this.root.appendChild(this.createShadow(n)),0<this.strokeTolerance&&!t&&this.root.appendChild(this.createTolerance(n)),this.pointerEvents&&("path"!=n.nodeName||this.path[this.path.length-1]==this.closeOp)&&n.setAttribute("pointer-events","all"),this.root.appendChild(n)}},mxSvgCanvas2D.prototype.updateFill=function(){var t=this.state;1>t.alpha&&this.node.setAttribute("fill-opacity",t.alpha),null!=t.fillColor&&(null!=t.gradientColor?(t=this.getSvgGradient(t.fillColor,t.gradientColor,t.fillAlpha,t.gradientAlpha,t.gradientDirection),this.node.setAttribute("fill","url(#"+t+")")):this.node.setAttribute("fill",t.fillColor.toLowerCase()))},mxSvgCanvas2D.prototype.updateStroke=function(){var t=this.state;this.node.setAttribute("stroke",t.strokeColor.toLowerCase()),1>t.alpha&&this.node.setAttribute("stroke-opacity",t.alpha);var e=Math.max(1,this.format(t.strokeWidth*t.scale));1!=e&&this.node.setAttribute("stroke-width",e),"path"==this.node.nodeName&&this.updateStrokeAttributes(),t.dashed&&this.node.setAttribute("stroke-dasharray",this.createDashPattern(e))},mxSvgCanvas2D.prototype.updateStrokeAttributes=function(){var t=this.state;if(null!=t.lineJoin&&"miter"!=t.lineJoin&&this.node.setAttribute("stroke-linejoin",t.lineJoin),null!=t.lineCap){var e=t.lineCap;"flat"==e&&(e="butt"),"butt"!=e&&this.node.setAttribute("stroke-linecap",e)}null!=t.miterLimit&&(!this.styleEnabled||10!=t.miterLimit)&&this.node.setAttribute("stroke-miterlimit",t.miterLimit)},mxSvgCanvas2D.prototype.createDashPattern=function(t){var e=this.state.dashPattern.split(" "),n=[];if(0<e.length)for(var i=0;i<e.length;i++)n[i]=Number(e[i])*t;return n.join(" ")},mxSvgCanvas2D.prototype.createTolerance=function(t){t=t.cloneNode(!0);var e=parseFloat(t.getAttribute("stroke-width")||1)+this.strokeTolerance;return t.setAttribute("pointer-events","stroke"),t.setAttribute("visibility","hidden"),t.removeAttribute("stroke-dasharray"),t.setAttribute("stroke-width",e),t.setAttribute("fill","none"),t.setAttribute("stroke",mxClient.IS_OP?"none":"white"),t},mxSvgCanvas2D.prototype.createShadow=function(t){t=t.cloneNode(!0);var e=this.state;return"none"!=t.getAttribute("fill")&&t.setAttribute("fill",e.shadowColor),"none"!=t.getAttribute("stroke")&&t.setAttribute("stroke",e.shadowColor),t.setAttribute("transform","translate("+this.format(e.shadowDx*e.scale)+","+this.format(e.shadowDy*e.scale)+")"+(e.transform||"")),t.setAttribute("opacity",e.shadowAlpha),t},mxSvgCanvas2D.prototype.rotate=function(t,e,n,i,o){if(0!=t||e||n){var r=this.state;if(i+=r.dx,o+=r.dy,i*=r.scale,o*=r.scale,r.transform=r.transform||"",e&&n)t+=180;else if(e^n){var s=e?i:0,l=e?-1:1,a=n?o:0,h=n?-1:1;r.transform+="translate("+this.format(s)+","+this.format(a)+")scale("+this.format(l)+","+this.format(h)+")translate("+this.format(-s)+","+this.format(-a)+")"}(e?!n:n)&&(t*=-1),0!=t&&(r.transform+="rotate("+this.format(t)+","+this.format(i)+","+this.format(o)+")"),r.rotation+=t,r.rotationCx=i,r.rotationCy=o}},mxSvgCanvas2D.prototype.begin=function(){mxAbstractCanvas2D.prototype.begin.apply(this,arguments),this.node=this.createElement("path")},mxSvgCanvas2D.prototype.rect=function(t,e,n,i){var o=this.state,r=this.createElement("rect");r.setAttribute("x",this.format((t+o.dx)*o.scale)),r.setAttribute("y",this.format((e+o.dy)*o.scale)),r.setAttribute("width",this.format(n*o.scale)),r.setAttribute("height",this.format(i*o.scale)),this.node=r},mxSvgCanvas2D.prototype.roundrect=function(t,e,n,i,o,r){this.rect(t,e,n,i),o>0&&this.node.setAttribute("rx",this.format(o*this.state.scale)),r>0&&this.node.setAttribute("ry",this.format(r*this.state.scale))},mxSvgCanvas2D.prototype.ellipse=function(t,e,n,i){var o=this.state,r=this.createElement("ellipse");r.setAttribute("cx",Math.round((t+n/2+o.dx)*o.scale)),r.setAttribute("cy",Math.round((e+i/2+o.dy)*o.scale)),r.setAttribute("rx",n/2*o.scale),r.setAttribute("ry",i/2*o.scale),this.node=r},mxSvgCanvas2D.prototype.image=function(t,e,n,i,o,r,s,l){o=this.converter.convert(o),r=null!=r?r:!0,s=null!=s?s:!1,l=null!=l?l:!1;var a=this.state;t+=a.dx,e+=a.dy;var h=this.createElement("image");if(h.setAttribute("x",this.format(t*a.scale)),h.setAttribute("y",this.format(e*a.scale)),h.setAttribute("width",this.format(n*a.scale)),h.setAttribute("height",this.format(i*a.scale)),null==h.setAttributeNS||this.root.ownerDocument!=document?h.setAttribute("xlink:href",o):h.setAttributeNS(mxConstants.NS_XLINK,"href",o),r||h.setAttribute("preserveAspectRatio","none"),1>a.alpha&&h.setAttribute("opacity",a.alpha),o=this.state.transform||"",s||l){var d=r=1,u=0,c=0;s&&(r=-1,u=-n-2*t),l&&(d=-1,c=-i-2*e),o+="scale("+r+","+d+")translate("+u+","+c+")"}0<o.length&&h.setAttribute("transform",o),this.root.appendChild(h),this.blockImagePointerEvents&&(h.setAttribute("style","pointer-events:none"),h=this.createElement("rect"),h.setAttribute("visibility","hidden"),h.setAttribute("pointer-events","fill"),h.setAttribute("x",this.format(t*a.scale)),h.setAttribute("y",this.format(e*a.scale)),h.setAttribute("width",this.format(n*a.scale)),h.setAttribute("height",this.format(i*a.scale)),this.root.appendChild(h))},mxSvgCanvas2D.prototype.createDiv=function(t,e,n,i,o){return n=this.state,i="display:inline-block;font-size:"+Math.round(n.fontSize)+"px;font-family:"+n.fontFamily+";color:"+n.fontColor+";line-height:"+Math.round(n.fontSize*mxConstants.LINE_HEIGHT)+"px;"+i,(n.fontStyle&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD&&(i+="font-weight:bold;"),(n.fontStyle&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC&&(i+="font-style:italic;"),(n.fontStyle&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE&&(i+="text-decoration:underline;"),e==mxConstants.ALIGN_CENTER?i+="text-align:center;":e==mxConstants.ALIGN_RIGHT&&(i+="text-align:right;"),e="",null!=n.fontBackgroundColor&&(e+="background-color:"+n.fontBackgroundColor+";"),null!=n.fontBorderColor&&(e+="border:1px solid "+n.fontBorderColor+";"),mxUtils.isNode(t)||(n=document.createElement("textarea"),n.innerHTML=t.replace(/&lt;/g,"&amp;lt;").replace(/&gt;/g,"&amp;gt;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),t=n.value,"fill"!=o&&"width"!=o?0<e.length&&(t='<div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;'+e+'">'+t+"</div>"):i+=e),!mxClient.IS_IE&&document.createElementNS?(o=document.createElementNS("http://www.w3.org/1999/xhtml","div"),o.setAttribute("style",i),mxUtils.isNode(t)?this.root.ownerDocument!=document?o.appendChild(t.cloneNode(!0)):o.appendChild(t):o.innerHTML=t,o):(mxUtils.isNode(t)&&this.root.ownerDocument!=document&&(t=t.outerHTML),t=t.replace(/<br>/g,"<br />").replace(/<hr>/g,"<hr />"),mxUtils.parseXml('<div xmlns="http://www.w3.org/1999/xhtml" style="'+i+'">'+t+"</div>").documentElement)
},mxSvgCanvas2D.prototype.text=function(t,e,n,i,o,r,s,l,a,h,d,u){if(this.textEnabled&&null!=o){u=null!=u?u:0;var c=this.state;if(t+=c.dx,e+=c.dy,this.foEnabled&&"html"==a){var p="vertical-align:top;";d?(p+="overflow:hidden;",i>0&&(p+="max-height:"+Math.round(i)+"px;"),n>0&&(p+="width:"+Math.round(n)+"px;")):"fill"==h?(p+="width:"+Math.round(n)+"px;",p+="height:"+Math.round(i)+"px;"):"width"==h&&(p+="width:"+Math.round(n)+"px;",i>0&&(p+="max-height:"+Math.round(i)+"px;")),l&&n>0?(d||(p+="width:"+Math.round(n)+"px;"),p+="white-space:normal;"):p+="white-space:nowrap;";var m=this.createElement("g");1>c.alpha&&m.setAttribute("opacity",c.alpha);var g=this.createElement("foreignObject");if(g.setAttribute("pointer-events","all"),p=this.createDiv(o,r,s,p,h),null!=p){m.appendChild(g),this.root.appendChild(m);var f=0,x=0;if(mxClient.IS_IE&&!mxClient.IS_SVG){var C=document.createElement("div");C.style.cssText=p.getAttribute("style"),C.style.display=mxClient.IS_QUIRKS?"inline":"inline-block",C.style.visibility="hidden",C.innerHTML=mxUtils.isNode(o)?o.outerHTML:o,document.body.appendChild(C),f=C.offsetWidth,x=mxClient.IS_QUIRKS&&i>0&&d?Math.min(i,C.offsetHeight+2):C.offsetHeight,C.parentNode.removeChild(C),g.appendChild(p)}else this.root.ownerDocument!=document||0<=navigator.userAgent.indexOf("Firefox/3.")?(p.style.visibility="hidden",document.body.appendChild(p),f=p.offsetWidth,x=p.offsetHeight,g.appendChild(p),p.style.visibility=""):(g.appendChild(p),f=p.offsetWidth,x=p.offsetHeight);"fill"==h?(n=Math.max(n,f),i=Math.max(i,x)):(n="width"==h?Math.max(n,f):f,i=x),1>c.alpha&&m.setAttribute("opacity",c.alpha),f=p=0,r==mxConstants.ALIGN_CENTER?p-=n/2:r==mxConstants.ALIGN_RIGHT&&(p-=n),t+=p,s==mxConstants.ALIGN_MIDDLE?f-=i/2:s==mxConstants.ALIGN_BOTTOM&&(f-=i),e+=f,x=1!=c.scale?"scale("+c.scale+")":"",0!=c.rotation&&this.rotateHtml?(x+="rotate("+c.rotation+","+n/2+","+i/2+")",e=this.rotatePoint((t+n/2)*c.scale,(e+i/2)*c.scale,c.rotation,c.rotationCx,c.rotationCy),t=e.x-n*c.scale/2,e=e.y-i*c.scale/2):(t*=c.scale,e*=c.scale),0!=u&&(x+="rotate("+u+","+-p+","+-f+")"),m.setAttribute("transform","translate("+Math.round(t)+","+Math.round(e)+")"+x),g.setAttribute("width",Math.round(Math.max(1,n))),g.setAttribute("height",Math.round(Math.max(1,i))),this.root.ownerDocument!=document&&(t=this.createAlternateContent(g,t,e,n,i,o,r,s,l,a,h,d,u),null!=t&&(g.setAttribute("requiredFeatures","http://www.w3.org/TR/SVG11/feature#Extensibility"),n=this.createElement("switch"),n.appendChild(g),n.appendChild(t),m.appendChild(n)))}}else this.plainText(t,e,n,i,o,r,s,l,h,d,u)}},mxSvgCanvas2D.prototype.createClip=function(t,e,n,i){t=Math.round(t),e=Math.round(e),n=Math.round(n),i=Math.round(i);for(var o="mx-clip-"+t+"-"+e+"-"+n+"-"+i,r=0,s=o+"-"+r;null!=document.getElementById(s);)s=o+"-"+ ++r;return clip=this.createElement("clipPath"),clip.setAttribute("id",s),o=this.createElement("rect"),o.setAttribute("x",t),o.setAttribute("y",e),o.setAttribute("width",n),o.setAttribute("height",i),clip.appendChild(o),clip},mxSvgCanvas2D.prototype.plainText=function(t,e,n,i,o,r,s,l,a,h,d){d=null!=d?d:0,l=this.state;var u=Math.round(l.fontSize),c=this.createElement("g"),p=l.transform||"";if(0!=d&&(p+="rotate("+d+","+this.format(t*l.scale)+","+this.format(e*l.scale)+")"),h&&n>0&&i>0){var m=t;d=e,r==mxConstants.ALIGN_CENTER?m-=n/2:r==mxConstants.ALIGN_RIGHT&&(m-=n),"fill"!=a&&(s==mxConstants.ALIGN_MIDDLE?d-=i/2:s==mxConstants.ALIGN_BOTTOM&&(d-=i)),d=this.createClip(m*l.scale-2,d*l.scale-2,n*l.scale+4,i*l.scale+4),null!=this.defs?this.defs.appendChild(d):this.root.appendChild(d),c.setAttribute("clip-path","url(#"+d.getAttribute("id")+")")}this.updateFont(c,r),d=r==mxConstants.ALIGN_RIGHT?"end":r==mxConstants.ALIGN_CENTER?"middle":"start","start"!=d&&c.setAttribute("text-anchor",d),(!this.styleEnabled||u!=mxConstants.DEFAULT_FONTSIZE)&&c.setAttribute("font-size",Math.round(u*l.scale)+"px"),0<p.length&&c.setAttribute("transform",p),1>l.alpha&&c.setAttribute("opacity",l.alpha);var p=o.split("\n"),m=Math.round(u*mxConstants.LINE_HEIGHT),g=u+(p.length-1)*m;for(d=e+u-1,s==mxConstants.ALIGN_MIDDLE?"fill"==a?d-=i/2:(h=(this.matchHtmlAlignment&&h&&i>0?Math.min(g,i):g)/2,d-=h+1):s==mxConstants.ALIGN_BOTTOM&&("fill"==a?d-=i:(h=this.matchHtmlAlignment&&h&&i>0?Math.min(g,i):g,d-=h+2)),h=0;h<p.length;h++)0<p[h].length&&0<mxUtils.trim(p[h]).length&&(u=this.createElement("text"),u.setAttribute("x",this.format(t*l.scale)),u.setAttribute("y",this.format(d*l.scale)),mxUtils.write(u,p[h]),c.appendChild(u)),d+=m;this.root.appendChild(c),this.addTextBackground(c,o,t,e,n,"fill"==a?i:g,r,s,a)},mxSvgCanvas2D.prototype.updateFont=function(t){var e=this.state;t.setAttribute("fill",e.fontColor),(!this.styleEnabled||e.fontFamily!=mxConstants.DEFAULT_FONTFAMILY)&&t.setAttribute("font-family",e.fontFamily),(e.fontStyle&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD&&t.setAttribute("font-weight","bold"),(e.fontStyle&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC&&t.setAttribute("font-style","italic"),(e.fontStyle&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE&&t.setAttribute("text-decoration","underline")},mxSvgCanvas2D.prototype.addTextBackground=function(t,e,n,i,o,r,s,l,a){var h=this.state;if(null!=h.fontBackgroundColor||null!=h.fontBorderColor){var d=null;"fill"==a||"width"==a?(s==mxConstants.ALIGN_CENTER?n-=o/2:s==mxConstants.ALIGN_RIGHT&&(n-=o),l==mxConstants.ALIGN_MIDDLE?i-=r/2:l==mxConstants.ALIGN_BOTTOM&&(i-=r),d=new mxRectangle((n+1)*h.scale,i*h.scale,(o-2)*h.scale,(r+2)*h.scale)):null!=t.getBBox&&this.root.ownerDocument==document?(d=t.getBBox(),e=mxClient.IS_IE&&mxClient.IS_SVG,d=new mxRectangle(d.x,d.y+(e?0:1),d.width,d.height+(e?1:0))):(d=document.createElement("div"),d.style.lineHeight=Math.round(h.fontSize*mxConstants.LINE_HEIGHT)+"px",d.style.fontSize=Math.round(h.fontSize)+"px",d.style.fontFamily=h.fontFamily,d.style.whiteSpace="nowrap",d.style.position="absolute",d.style.visibility="hidden",d.style.display=mxClient.IS_QUIRKS?"inline":"inline-block",d.style.zoom="1",(h.fontStyle&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD&&(d.style.fontWeight="bold"),(h.fontStyle&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC&&(d.style.fontStyle="italic"),e=mxUtils.htmlEntities(e,!1),d.innerHTML=e.replace(/\n/g,"<br/>"),document.body.appendChild(d),o=d.offsetWidth,r=d.offsetHeight,d.parentNode.removeChild(d),s==mxConstants.ALIGN_CENTER?n-=o/2:s==mxConstants.ALIGN_RIGHT&&(n-=o),l==mxConstants.ALIGN_MIDDLE?i-=r/2:l==mxConstants.ALIGN_BOTTOM&&(i-=r),d=new mxRectangle((n+1)*h.scale,(i+2)*h.scale,o*h.scale,(r+1)*h.scale)),null!=d&&(e=this.createElement("rect"),e.setAttribute("fill",h.fontBackgroundColor||"none"),e.setAttribute("stroke",h.fontBorderColor||"none"),e.setAttribute("x",Math.floor(d.x-1)),e.setAttribute("y",Math.floor(d.y-1)),e.setAttribute("width",Math.ceil(d.width+2)),e.setAttribute("height",Math.ceil(d.height)),h=null!=h.fontBorderColor?Math.max(1,this.format(h.scale)):0,e.setAttribute("stroke-width",h),this.root.ownerDocument==document&&1==mxUtils.mod(h,2)&&e.setAttribute("transform","translate(0.5, 0.5)"),t.insertBefore(e,t.firstChild))}},mxSvgCanvas2D.prototype.stroke=function(){this.addNode(!1,!0)},mxSvgCanvas2D.prototype.fill=function(){this.addNode(!0,!1)},mxSvgCanvas2D.prototype.fillAndStroke=function(){this.addNode(!0,!0)};var mxVmlCanvas2D=function(t){mxAbstractCanvas2D.call(this),this.root=t};mxUtils.extend(mxVmlCanvas2D,mxAbstractCanvas2D),mxVmlCanvas2D.prototype.node=null,mxVmlCanvas2D.prototype.textEnabled=!0,mxVmlCanvas2D.prototype.moveOp="m",mxVmlCanvas2D.prototype.lineOp="l",mxVmlCanvas2D.prototype.curveOp="c",mxVmlCanvas2D.prototype.closeOp="x",mxVmlCanvas2D.prototype.rotatedHtmlBackground="",mxVmlCanvas2D.prototype.vmlScale=1,mxVmlCanvas2D.prototype.addNode=function(t,e){var n=this.node,i=this.state;if(null!=n){if("shape"==n.nodeName){if(!(null!=this.path&&0<this.path.length))return;n.path=this.path.join(" ")+" e",n.style.width=this.root.style.width,n.style.height=this.root.style.height,n.coordsize=parseInt(n.style.width)+" "+parseInt(n.style.height)}n.strokeweight=this.format(Math.max(1,i.strokeWidth*i.scale/this.vmlScale))+"px",i.shadow&&this.root.appendChild(this.createShadow(n,t&&null!=i.fillColor,e&&null!=i.strokeColor)),e&&null!=i.strokeColor?(n.stroked="true",n.strokecolor=i.strokeColor):n.stroked="false",n.appendChild(this.createStroke()),t&&null!=i.fillColor?n.appendChild(this.createFill()):!this.pointerEvents||"shape"==n.nodeName&&this.path[this.path.length-1]!=this.closeOp?n.filled="false":n.appendChild(this.createTransparentFill()),this.root.appendChild(n)}},mxVmlCanvas2D.prototype.createTransparentFill=function(){var t=document.createElement(mxClient.VML_PREFIX+":fill");return t.src=mxClient.imageBasePath+"/transparent.gif",t.type="tile",t},mxVmlCanvas2D.prototype.createFill=function(){var t=this.state,e=document.createElement(mxClient.VML_PREFIX+":fill");if(e.color=t.fillColor,null!=t.gradientColor){e.type="gradient",e.method="none",e.color2=t.gradientColor;var n=180-t.rotation,n=t.gradientDirection==mxConstants.DIRECTION_WEST?n-(90+("x"==this.root.style.flip?180:0)):t.gradientDirection==mxConstants.DIRECTION_EAST?n+(90+("x"==this.root.style.flip?180:0)):t.gradientDirection==mxConstants.DIRECTION_NORTH?n-(180+("y"==this.root.style.flip?-180:0)):n+("y"==this.root.style.flip?-180:0);("x"==this.root.style.flip||"y"==this.root.style.flip)&&(n*=-1),e.angle=mxUtils.mod(n,360),e.opacity=100*t.alpha*t.fillAlpha+"%",e.setAttribute(mxClient.OFFICE_PREFIX+":opacity2",100*t.alpha*t.gradientAlpha+"%")}else 1>t.alpha&&(e.opacity=100*t.alpha+"%");return e},mxVmlCanvas2D.prototype.createStroke=function(){var t=this.state,e=document.createElement(mxClient.VML_PREFIX+":stroke");return e.endcap=t.lineCap||"flat",e.joinstyle=t.lineJoin||"miter",e.miterlimit=t.miterLimit||"10",1>t.alpha&&(e.opacity=100*t.alpha+"%"),t.dashed&&(e.dashstyle=this.getVmlDashStyle()),e},mxVmlCanvas2D.prototype.getVmlDashStyle=function(){var t="dash";if(null!=this.state.dashPattern){var e=this.state.dashPattern.split(" ");0<e.length&&1==e[0]&&(t="0 2")}return t},mxVmlCanvas2D.prototype.createShadow=function(t,e,n){var i=this.state,o=-i.rotation*(Math.PI/180),r=Math.cos(o),o=Math.sin(o),s=i.shadowDx*i.scale,l=i.shadowDy*i.scale;"x"==this.root.style.flip?s*=-1:"y"==this.root.style.flip&&(l*=-1);var a=t.cloneNode(!0);return a.style.marginLeft=Math.round(s*r-l*o)+"px",a.style.marginTop=Math.round(s*o+l*r)+"px",8==document.documentMode&&(a.strokeweight=t.strokeweight,"shape"==t.nodeName&&(a.path=this.path.join(" ")+" e",a.style.width=this.root.style.width,a.style.height=this.root.style.height,a.coordsize=parseInt(t.style.width)+" "+parseInt(t.style.height))),n?(a.strokecolor=i.shadowColor,a.appendChild(this.createShadowStroke())):a.stroked="false",e?a.appendChild(this.createShadowFill()):a.filled="false",a},mxVmlCanvas2D.prototype.createShadowFill=function(){var t=document.createElement(mxClient.VML_PREFIX+":fill");return t.color=this.state.shadowColor,t.opacity=100*this.state.alpha*this.state.shadowAlpha+"%",t},mxVmlCanvas2D.prototype.createShadowStroke=function(){var t=this.createStroke();return t.opacity=100*this.state.alpha*this.state.shadowAlpha+"%",t},mxVmlCanvas2D.prototype.rotate=function(t,e,n,i,o){e&&n?t+=180:e?this.root.style.flip="x":n&&(this.root.style.flip="y"),(e?!n:n)&&(t*=-1),this.root.style.rotation=t,this.state.rotation+=t,this.state.rotationCx=i,this.state.rotationCy=o},mxVmlCanvas2D.prototype.begin=function(){mxAbstractCanvas2D.prototype.begin.apply(this,arguments),this.node=document.createElement(mxClient.VML_PREFIX+":shape"),this.node.style.position="absolute"},mxVmlCanvas2D.prototype.quadTo=function(t,e,n,i){var o=this.state,r=(this.lastX+o.dx)*o.scale,s=(this.lastY+o.dy)*o.scale;t=(t+o.dx)*o.scale,e=(e+o.dy)*o.scale,n=(n+o.dx)*o.scale,i=(i+o.dy)*o.scale;var s=s+2/3*(e-s),l=n+2/3*(t-n);e=i+2/3*(e-i),this.path.push("c "+this.format(r+2/3*(t-r))+" "+this.format(s)+" "+this.format(l)+" "+this.format(e)+" "+this.format(n)+" "+this.format(i)),this.lastX=n/o.scale-o.dx,this.lastY=i/o.scale-o.dy},mxVmlCanvas2D.prototype.createRect=function(t,e,n,i,o){var r=this.state;return t=document.createElement(t),t.style.position="absolute",t.style.left=this.format((e+r.dx)*r.scale)+"px",t.style.top=this.format((n+r.dy)*r.scale)+"px",t.style.width=this.format(i*r.scale)+"px",t.style.height=this.format(o*r.scale)+"px",t},mxVmlCanvas2D.prototype.rect=function(t,e,n,i){this.node=this.createRect(mxClient.VML_PREFIX+":rect",t,e,n,i)},mxVmlCanvas2D.prototype.roundrect=function(t,e,n,i,o,r){this.node=this.createRect(mxClient.VML_PREFIX+":roundrect",t,e,n,i),this.node.setAttribute("arcsize",Math.max(100*o/n,100*r/i)+"%")},mxVmlCanvas2D.prototype.ellipse=function(t,e,n,i){this.node=this.createRect(mxClient.VML_PREFIX+":oval",t,e,n,i)},mxVmlCanvas2D.prototype.image=function(t,e,n,i,o,r,s,l){var a=null;r?(a=this.createRect(mxClient.VML_PREFIX+":rect",t,e,n,i),a.stroked="false",t=document.createElement(mxClient.VML_PREFIX+":fill"),t.aspect=r?"atmost":"ignore",t.rotate="true",t.type="frame",t.src=o,a.appendChild(t)):(a=this.createRect(mxClient.VML_PREFIX+":image",t,e,n,i),a.src=o),s&&l?a.style.rotation="180":s?a.style.flip="x":l&&(a.style.flip="y"),1>this.state.alpha&&(a.style.filter+="alpha(opacity="+100*this.state.alpha+")"),this.root.appendChild(a)},mxVmlCanvas2D.prototype.createDiv=function(t,e,n,i){n=document.createElement("div");var o=this.state,r="";return null!=o.fontBackgroundColor&&(r+="background-color:"+o.fontBackgroundColor+";"),null!=o.fontBorderColor&&(r+="border:1px solid "+o.fontBorderColor+";"),mxUtils.isNode(t)?n.appendChild(t):0<r.length&&"fill"!=i&&"width"!=i?(i=document.createElement("div"),i.style.cssText=r,i.style.display=mxClient.IS_QUIRKS?"inline":"inline-block",i.style.zoom="1",i.innerHTML=t,n.appendChild(i)):(n.style.cssText=r,n.innerHTML=t),t=n.style,t.fontSize=Math.round(o.fontSize/this.vmlScale)+"px",t.fontFamily=o.fontFamily,t.color=o.fontColor,t.verticalAlign="top",t.textAlign=e||"left",t.lineHeight=Math.round(o.fontSize*mxConstants.LINE_HEIGHT/this.vmlScale)+"px",(o.fontStyle&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD&&(t.fontWeight="bold"),(o.fontStyle&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC&&(t.fontStyle="italic"),(o.fontStyle&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE&&(t.textDecoration="underline"),n},mxVmlCanvas2D.prototype.text=function(t,e,n,i,o,r,s,l,a,h,d,u){if(this.textEnabled&&null!=o){var c=this.state;if("html"==a){null!=c.rotation&&(e=this.rotatePoint(t,e,c.rotation,c.rotationCx,c.rotationCy),t=e.x,e=e.y),8==document.documentMode?(t+=c.dx,e+=c.dy):(t*=c.scale,e*=c.scale),a=8==document.documentMode?document.createElement(mxClient.VML_PREFIX+":group"):document.createElement("div"),a.style.position="absolute",a.style.display="inline",a.style.left=this.format(t)+"px",a.style.top=this.format(e)+"px",a.style.zoom=c.scale;var p=document.createElement("div");p.style.position="relative",p.style.display="inline";var m=mxUtils.getAlignmentAsPoint(r,s),g=m.x,m=m.y;if(o=this.createDiv(o,r,s,h),r=document.createElement("div"),l&&n>0?(d||(o.style.width=Math.round(n)+"px"),o.style.whiteSpace="normal"):o.style.whiteSpace="nowrap",l=c.rotation+(u||0),this.rotateHtml&&0!=l?(r.style.display="inline",r.style.zoom="1",r.appendChild(o),8==document.documentMode&&"DIV"!=this.root.nodeName?(p.appendChild(r),a.appendChild(p)):a.appendChild(r)):8==document.documentMode?(p.appendChild(o),a.appendChild(p)):(o.style.display="inline",a.appendChild(o)),"DIV"!=this.root.nodeName?(u=document.createElement(mxClient.VML_PREFIX+":rect"),u.stroked="false",u.filled="false",u.appendChild(a),this.root.appendChild(u)):this.root.appendChild(a),d?(o.style.overflow="hidden",n>0&&(o.style.width=Math.round(n)+"px"),i>0&&8==document.documentMode&&(o.style.maxHeight=Math.round(i)+"px")):"fill"==h?(o.style.width=n+"px",o.style.height=i+"px"):"width"==h&&(o.style.width=n+"px",i>0&&(o.style.maxHeight=Math.round(i)+"px")),this.rotateHtml&&0!=l){n=l*(Math.PI/180),l=parseFloat(parseFloat(Math.cos(n)).toFixed(8)),u=parseFloat(parseFloat(Math.sin(-n)).toFixed(8)),n%=2*Math.PI,0>n&&(n+=2*Math.PI),n%=Math.PI,n>Math.PI/2&&(n=Math.PI-n),s=Math.cos(n);var f=Math.sin(n);8==document.documentMode&&(o.style.display="inline-block",r.style.display="inline-block",p.style.display="inline-block"),o.style.visibility="hidden",document.body.appendChild(o),n=o.offsetWidth,p=o.offsetHeight,mxClient.IS_QUIRKS&&(d||"width"==h)&&p>i&&(p=i,o.style.height=p+"px"),i=p,d=(i-i*s+n*-f)/2-u*n*(g+.5)+l*i*(m+.5),h=(n-n*s+i*-f)/2+l*n*(g+.5)+u*i*(m+.5),"group"==a.nodeName&&"DIV"==this.root.nodeName?(g=document.createElement("div"),g.style.display="inline-block",g.style.position="absolute",g.style.left=this.format(t+(h-n/2)*c.scale)+"px",g.style.top=this.format(e+(d-i/2)*c.scale)+"px",a.parentNode.appendChild(g),g.appendChild(a)):(c=8==document.documentMode?1:c.scale,a.style.left=this.format(t+(h-n/2)*c)+"px",a.style.top=this.format(e+(d-i/2)*c)+"px"),r.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11="+l+", M12="+u+", M21="+-u+", M22="+l+", sizingMethod='auto expand')",r.style.backgroundColor=this.rotatedHtmlBackground,1>this.state.alpha&&(r.style.filter+="alpha(opacity="+100*this.state.alpha+")"),o.style.visibility="",r.appendChild(o)}else 8!=document.documentMode?(o.style.verticalAlign="top",1>this.state.alpha&&(a.style.filter="alpha(opacity="+100*this.state.alpha+")"),c=o.parentNode,o.style.visibility="hidden",document.body.appendChild(o),n=o.offsetWidth,p=o.offsetHeight,mxClient.IS_QUIRKS&&d&&p>i&&(p=i,o.style.height=p+"px"),i=p,o.style.visibility="",c.appendChild(o),a.style.left=this.format(t+n*g*this.state.scale)+"px",a.style.top=this.format(e+i*m*this.state.scale)+"px"):(1>this.state.alpha&&(o.style.filter="alpha(opacity="+100*this.state.alpha+")"),p.style.left=100*g+"%",p.style.top=100*m+"%")}else this.plainText(t,e,n,i,mxUtils.htmlEntities(o,!1),r,s,l,a,h,d,u)}},mxVmlCanvas2D.prototype.plainText=function(t,e,n,i,o,r,s,l,a,h,d,u){l=this.state,t=(t+l.dx)*l.scale,e=(e+l.dy)*l.scale,n=document.createElement(mxClient.VML_PREFIX+":shape"),n.style.width="1px",n.style.height="1px",n.stroked="false",i=document.createElement(mxClient.VML_PREFIX+":fill"),i.color=l.fontColor,i.opacity=100*l.alpha+"%",n.appendChild(i),i=document.createElement(mxClient.VML_PREFIX+":path"),i.textpathok="true",i.v="m "+this.format(0)+" "+this.format(0)+" l "+this.format(1)+" "+this.format(0),n.appendChild(i),i=document.createElement(mxClient.VML_PREFIX+":textpath"),i.style.cssText="v-text-align:"+r,i.style.align=r,i.style.fontFamily=l.fontFamily,i.string=o,i.on="true",r=Math.round(l.fontSize*l.scale/this.vmlScale),i.style.fontSize=r+"px",(l.fontStyle&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD&&(i.style.fontWeight="bold"),(l.fontStyle&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC&&(i.style.fontStyle="italic"),(l.fontStyle&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE&&(i.style.textDecoration="underline"),o=o.split("\n"),l=r+(o.length-1)*r*mxConstants.LINE_HEIGHT,r=o=0,s==mxConstants.ALIGN_BOTTOM?r=-l/2:s!=mxConstants.ALIGN_MIDDLE&&(r=l/2),null!=u&&(n.style.rotation=u,s=u*(Math.PI/180),o=Math.sin(s)*r,r*=Math.cos(s)),n.appendChild(i),n.style.left=this.format(t-o)+"px",n.style.top=this.format(e+r)+"px",this.root.appendChild(n)},mxVmlCanvas2D.prototype.stroke=function(){this.addNode(!1,!0)},mxVmlCanvas2D.prototype.fill=function(){this.addNode(!0,!1)},mxVmlCanvas2D.prototype.fillAndStroke=function(){this.addNode(!0,!0)},mxGuide.prototype.graph=null,mxGuide.prototype.states=null,mxGuide.prototype.horizontal=!0,mxGuide.prototype.vertical=!0,mxGuide.prototype.guideX=null,mxGuide.prototype.guideY=null,mxGuide.prototype.setStates=function(t){this.states=t},mxGuide.prototype.isEnabledForEvent=function(){return!0},mxGuide.prototype.getGuideTolerance=function(){return this.graph.gridSize*this.graph.view.scale/2},mxGuide.prototype.createGuideShape=function(t){return t=new mxPolyline([],mxConstants.GUIDE_COLOR,mxConstants.GUIDE_STROKEWIDTH),t.isDashed=!0,t},mxGuide.prototype.move=function(t,e,n){if(null!=this.states&&(this.horizontal||this.vertical)&&null!=t&&null!=e){var i=this.graph.getView().translate,o=this.graph.getView().scale,r=e.x,s=e.y,l=!1,a=!1,h=this.getGuideTolerance(),d=h,u=h,h=t.clone();h.x+=e.x,h.y+=e.y;var c=h.x,p=h.x+h.width,m=h.getCenterX(),g=h.y,f=h.y+h.height,x=h.getCenterY();e=function(e){e+=this.graph.panDx;var n=!1;if(Math.abs(e-m)<d?(r=e-t.getCenterX(),d=Math.abs(e-m),n=!0):Math.abs(e-c)<d?(r=e-t.x,d=Math.abs(e-c),n=!0):Math.abs(e-p)<d&&(r=e-t.x-t.width,d=Math.abs(e-p),n=!0),n){null==this.guideX&&(this.guideX=this.createGuideShape(!0),this.guideX.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG,this.guideX.pointerEvents=!1,this.guideX.init(this.graph.getView().getOverlayPane()));var i=this.graph.container;e-=this.graph.panDx,this.guideX.points=[new mxPoint(e,-this.graph.panDy),new mxPoint(e,i.scrollHeight-3-this.graph.panDy)]}l=l||n};for(var h=function(e){e+=this.graph.panDy;var n=!1;if(Math.abs(e-x)<u?(s=e-t.getCenterY(),u=Math.abs(e-x),n=!0):Math.abs(e-g)<u?(s=e-t.y,u=Math.abs(e-g),n=!0):Math.abs(e-f)<u&&(s=e-t.y-t.height,u=Math.abs(e-f),n=!0),n){null==this.guideY&&(this.guideY=this.createGuideShape(!1),this.guideY.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG,this.guideY.pointerEvents=!1,this.guideY.init(this.graph.getView().getOverlayPane()));var i=this.graph.container;e-=this.graph.panDy,this.guideY.points=[new mxPoint(-this.graph.panDx,e),new mxPoint(i.scrollWidth-3-this.graph.panDx,e)]}a=a||n},C=0;C<this.states.length;C++){var E=this.states[C];null!=E&&(this.horizontal&&(e.call(this,E.getCenterX()),e.call(this,E.x),e.call(this,E.x+E.width)),this.vertical&&(h.call(this,E.getCenterY()),h.call(this,E.y),h.call(this,E.y+E.height)))}l||null==this.guideX?null!=this.guideX&&(this.guideX.node.style.visibility="visible",this.guideX.redraw()):this.guideX.node.style.visibility="hidden",a||null==this.guideY?null!=this.guideY&&(this.guideY.node.style.visibility="visible",this.guideY.redraw()):this.guideY.node.style.visibility="hidden",n&&(l||(n=t.x-(this.graph.snap(t.x/o-i.x)+i.x)*o,r=this.graph.snap(r/o)*o-n),a||(i=t.y-(this.graph.snap(t.y/o-i.y)+i.y)*o,s=this.graph.snap(s/o)*o-i)),e=new mxPoint(r,s)}return e},mxGuide.prototype.hide=function(){null!=this.guideX&&(this.guideX.node.style.visibility="hidden"),null!=this.guideY&&(this.guideY.node.style.visibility="hidden")},mxGuide.prototype.destroy=function(){null!=this.guideX&&(this.guideX.destroy(),this.guideX=null),null!=this.guideY&&(this.guideY.destroy(),this.guideY=null)},mxStencil.defaultLocalized=!1,mxStencil.prototype.desc=null,mxStencil.prototype.constraints=null,mxStencil.prototype.aspect=null,mxStencil.prototype.w0=null,mxStencil.prototype.h0=null,mxStencil.prototype.bgNode=null,mxStencil.prototype.fgNode=null,mxStencil.prototype.strokewidth=null,mxStencil.prototype.parseDescription=function(){this.fgNode=this.desc.getElementsByTagName("foreground")[0],this.bgNode=this.desc.getElementsByTagName("background")[0],this.w0=Number(this.desc.getAttribute("w")||100),this.h0=Number(this.desc.getAttribute("h")||100);var t=this.desc.getAttribute("aspect");this.aspect=null!=t?t:"variable",t=this.desc.getAttribute("strokewidth"),this.strokewidth=null!=t?t:"1"},mxStencil.prototype.parseConstraints=function(){var t=this.desc.getElementsByTagName("connections")[0];if(null!=t&&(t=mxUtils.getChildNodes(t),null!=t&&0<t.length)){this.constraints=[];for(var e=0;e<t.length;e++)this.constraints.push(this.parseConstraint(t[e]))}},mxStencil.prototype.parseConstraint=function(t){var e=Number(t.getAttribute("x")),n=Number(t.getAttribute("y"));return t="1"==t.getAttribute("perimeter"),new mxConnectionConstraint(new mxPoint(e,n),t)},mxStencil.prototype.evaluateTextAttribute=function(t,e,n){return e=this.evaluateAttribute(t,e,n),t=t.getAttribute("localized"),(mxStencil.defaultLocalized&&null==t||"1"==t)&&(e=mxResources.get(e)),e},mxStencil.prototype.evaluateAttribute=function(t,e,n){return e=t.getAttribute(e),null==e&&(t=mxUtils.getTextContent(t),null!=t&&(t=mxUtils.eval(t),"function"==typeof t&&(e=t(n)))),e},mxStencil.prototype.drawShape=function(t,e,n,i,o,r){this.drawChildren(t,e,n,i,o,r,this.bgNode,!1),this.drawChildren(t,e,n,i,o,r,this.fgNode,!0)},mxStencil.prototype.drawChildren=function(t,e,n,i,o,r,s,l){if(null!=s){var a=mxUtils.getValue(e.style,mxConstants.STYLE_DIRECTION,null);for(n=this.computeAspect(e.style,n,i,o,r,a),i=Math.min(n.width,n.height),i="inherit"==this.strokewidth?Number(mxUtils.getNumber(e.style,mxConstants.STYLE_STROKEWIDTH,1)):Number(this.strokewidth)*i,t.setStrokeWidth(i),s=s.firstChild;null!=s;)s.nodeType==mxConstants.NODETYPE_ELEMENT&&this.drawNode(t,e,s,n,l),s=s.nextSibling}},mxStencil.prototype.computeAspect=function(t,e,n,i,o,r){t=e,e=i/this.w0;var s=o/this.h0;if(r="north"==r||"south"==r){s=i/this.h0,e=o/this.w0;var l=(i-o)/2;t+=l,n-=l}return"fixed"==this.aspect&&(e=s=Math.min(e,s),r?(t+=(o-this.w0*e)/2,n+=(i-this.h0*s)/2):(t+=(i-this.w0*e)/2,n+=(o-this.h0*s)/2)),new mxRectangle(t,n,e,s)},mxStencil.prototype.drawNode=function(t,e,n,i,o){var r=n.nodeName,s=i.x,l=i.y,a=i.width,h=i.height,d=Math.min(a,h);if("save"==r)t.save();else if("restore"==r)t.restore();else if("path"==r)for(t.begin(),n=n.firstChild;null!=n;)n.nodeType==mxConstants.NODETYPE_ELEMENT&&this.drawNode(t,e,n,i,o),n=n.nextSibling;else if("close"==r)t.close();else if("move"==r)t.moveTo(s+Number(n.getAttribute("x"))*a,l+Number(n.getAttribute("y"))*h);else if("line"==r)t.lineTo(s+Number(n.getAttribute("x"))*a,l+Number(n.getAttribute("y"))*h);else if("quad"==r)t.quadTo(s+Number(n.getAttribute("x1"))*a,l+Number(n.getAttribute("y1"))*h,s+Number(n.getAttribute("x2"))*a,l+Number(n.getAttribute("y2"))*h);else if("curve"==r)t.curveTo(s+Number(n.getAttribute("x1"))*a,l+Number(n.getAttribute("y1"))*h,s+Number(n.getAttribute("x2"))*a,l+Number(n.getAttribute("y2"))*h,s+Number(n.getAttribute("x3"))*a,l+Number(n.getAttribute("y3"))*h);else if("arc"==r)t.arcTo(Number(n.getAttribute("rx"))*a,Number(n.getAttribute("ry"))*h,Number(n.getAttribute("x-axis-rotation")),Number(n.getAttribute("large-arc-flag")),Number(n.getAttribute("sweep-flag")),s+Number(n.getAttribute("x"))*a,l+Number(n.getAttribute("y"))*h);else if("rect"==r)t.rect(s+Number(n.getAttribute("x"))*a,l+Number(n.getAttribute("y"))*h,Number(n.getAttribute("w"))*a,Number(n.getAttribute("h"))*h);else if("roundrect"==r)e=n.getAttribute("arcsize"),0==e&&(e=100*mxConstants.RECTANGLE_ROUNDING_FACTOR),d=Number(n.getAttribute("w"))*a,i=Number(n.getAttribute("h"))*h,e=Number(e)/100,e=Math.min(d*e,i*e),t.roundrect(s+Number(n.getAttribute("x"))*a,l+Number(n.getAttribute("y"))*h,d,i,e,e);else if("ellipse"==r)t.ellipse(s+Number(n.getAttribute("x"))*a,l+Number(n.getAttribute("y"))*h,Number(n.getAttribute("w"))*a,Number(n.getAttribute("h"))*h);else if("image"==r)e=this.evaluateAttribute(n,"src",e),t.image(s+Number(n.getAttribute("x"))*a,l+Number(n.getAttribute("y"))*h,Number(n.getAttribute("w"))*a,Number(n.getAttribute("h"))*h,e,!1,"1"==n.getAttribute("flipH"),"1"==n.getAttribute("flipV"));else if("text"==r){if(d=this.evaluateTextAttribute(n,"str",e),i="1"==n.getAttribute("vertical")?-90:0,"0"==n.getAttribute("align-shape")){var u=e.rotation,c=1==mxUtils.getValue(e.style,mxConstants.STYLE_FLIPH,0);e=1==mxUtils.getValue(e.style,mxConstants.STYLE_FLIPV,0),i=c&&e?i-u:c||e?i+u:i-u}i-=n.getAttribute("rotation"),t.text(s+Number(n.getAttribute("x"))*a,l+Number(n.getAttribute("y"))*h,0,0,d,n.getAttribute("align")||"left",n.getAttribute("valign")||"top",!1,"",null,!1,i)}else if("include-shape"==r)u=mxStencilRegistry.getStencil(n.getAttribute("name")),null!=u&&(s+=Number(n.getAttribute("x"))*a,l+=Number(n.getAttribute("y"))*h,d=Number(n.getAttribute("w"))*a,i=Number(n.getAttribute("h"))*h,u.drawShape(t,e,s,l,d,i));else if("fillstroke"==r)t.fillAndStroke();else if("fill"==r)t.fill();else if("stroke"==r)t.stroke();else if("strokewidth"==r)a="1"==n.getAttribute("fixed")?1:d,t.setStrokeWidth(Number(n.getAttribute("width"))*a);else if("dashed"==r)t.setDashed("1"==n.getAttribute("dashed"));else if("dashpattern"==r){if(n=n.getAttribute("pattern"),null!=n){for(n=n.split(" "),a=[],h=0;h<n.length;h++)0<n[h].length&&a.push(Number(n[h])*d);n=a.join(" "),t.setDashPattern(n)}}else"strokecolor"==r?t.setStrokeColor(n.getAttribute("color")):"linecap"==r?t.setLineCap(n.getAttribute("cap")):"linejoin"==r?t.setLineJoin(n.getAttribute("join")):"miterlimit"==r?t.setMiterLimit(Number(n.getAttribute("limit"))):"fillcolor"==r?t.setFillColor(n.getAttribute("color")):"alpha"==r?t.setAlpha(n.getAttribute("alpha")):"fontcolor"==r?t.setFontColor(n.getAttribute("color")):"fontstyle"==r?t.setFontStyle(n.getAttribute("style")):"fontfamily"==r?t.setFontFamily(n.getAttribute("family")):"fontsize"==r&&t.setFontSize(Number(n.getAttribute("size"))*d);o&&("fillstroke"==r||"fill"==r||"stroke"==r)&&t.setShadow(!1)},mxShape.prototype.dialect=null,mxShape.prototype.scale=1,mxShape.prototype.bounds=null,mxShape.prototype.points=null,mxShape.prototype.node=null,mxShape.prototype.style=null,mxShape.prototype.style=null,mxShape.prototype.boundingBox=null,mxShape.prototype.stencil=null,mxShape.prototype.svgStrokeTolerance=6,mxShape.prototype.pointerEvents=!0,mxShape.prototype.stencilPointerEvents=!1,mxShape.prototype.vmlScale=1,mxShape.prototype.init=function(t){null==this.node&&(this.node=this.create(t),null!=t&&t.appendChild(this.node))},mxShape.prototype.isParseVml=function(){return!0},mxShape.prototype.isHtmlAllowed=function(){return!1},mxShape.prototype.getSvgScreenOffset=function(){return 1==mxUtils.mod(Math.max(1,Math.round(this.strokewidth*this.scale)),2)?.5:0},mxShape.prototype.create=function(t){var e=null;return e=null!=t.ownerSVGElement?this.createSvg(t):8==document.documentMode||this.dialect==mxConstants.DIALECT_SVG||this.dialect!=mxConstants.DIALECT_VML&&this.isHtmlAllowed()?this.createHtml(t):this.createVml(t)},mxShape.prototype.createSvg=function(){return document.createElementNS(mxConstants.NS_SVG,"g")},mxShape.prototype.createVml=function(){var t=document.createElement(mxClient.VML_PREFIX+":group");return t.style.position="absolute",t},mxShape.prototype.createHtml=function(){var t=document.createElement("div");return t.style.position="absolute",t},mxShape.prototype.reconfigure=function(){this.redraw()},mxShape.prototype.redraw=function(){this.updateBoundsFromPoints(),this.checkBounds()?(this.node.style.visibility="","DIV"==this.node.nodeName&&this.isHtmlAllowed()?this.redrawHtmlShape():this.redrawShape(),this.updateBoundingBox()):(this.node.style.visibility="hidden",this.boundingBox=null)},mxShape.prototype.updateBoundsFromPoints=function(){var t=this.points;if(null!=t&&0<t.length&&null!=t[0]){this.bounds=new mxRectangle(Number(t[0].x),Number(t[0].y),1,1);for(var e=1;e<this.points.length;e++)null!=t[e]&&this.bounds.add(new mxRectangle(Number(t[e].x),Number(t[e].y),1,1))}},mxShape.prototype.getLabelBounds=function(t){return t},mxShape.prototype.checkBounds=function(){return null!=this.bounds&&!isNaN(this.bounds.x)&&!isNaN(this.bounds.y)&&!isNaN(this.bounds.width)&&!isNaN(this.bounds.height)&&0<this.bounds.width&&0<this.bounds.height},mxShape.prototype.createVmlGroup=function(){var t=document.createElement(mxClient.VML_PREFIX+":group");return t.style.position="absolute",t.style.width=this.node.style.width,t.style.height=this.node.style.height,t},mxShape.prototype.redrawShape=function(){var t=this.createCanvas();for(t.pointerEvents=this.pointerEvents;this.node.hasChildNodes();)this.node.removeChild(this.node.lastChild);this.paint(t),this.node!=t.root&&this.node.insertAdjacentHTML("beforeend",t.root.outerHTML),"DIV"==this.node.nodeName&&8==document.documentMode&&(this.node.style.filter="",(null==this.stencil||!this.stencilPointerEvents)&&mxUtils.addTransparentBackgroundFilter(this.node)),this.destroyCanvas(t)},mxShape.prototype.createCanvas=function(){var t=null,e=null;if(null!=this.node.ownerSVGElement)t=new mxSvgCanvas2D(this.node,!1),t.strokeTolerance=this.svgStrokeTolerance,t.blockImagePointerEvents=mxClient.IS_NS&&!mxClient.IS_SF&&!mxClient.IS_GC,e=this.getSvgScreenOffset(),0!=e?this.node.setAttribute("transform","translate("+e+","+e+")"):this.node.removeAttribute("transform");else{this.updateVmlContainer();var n=Math.max(1,Math.round(this.bounds.width)),i=Math.max(1,Math.round(this.bounds.height)),e=8==document.documentMode&&this.isParseVml()?this.createVmlGroup():this.node,t=new mxVmlCanvas2D(e,!1);""!=e.tagUrn&&(e.coordsize=n*this.vmlScale+","+i*this.vmlScale,t.scale(this.vmlScale),t.vmlScale=this.vmlScale),e=this.scale,t.translate(-Math.round(this.bounds.x/e),-Math.round(this.bounds.y/e))}return t},mxShape.prototype.updateVmlContainer=function(){this.node.style.left=Math.round(this.bounds.x)+"px",this.node.style.top=Math.round(this.bounds.y)+"px";
var t=Math.max(1,Math.round(this.bounds.width)),e=Math.max(1,Math.round(this.bounds.height));this.node.style.width=t+"px",this.node.style.height=e+"px",this.node.style.overflow="visible"},mxShape.prototype.destroyCanvas=function(t){if(t instanceof mxSvgCanvas2D){for(var e in t.gradients){var n=t.gradients[e];n.mxRefCount=(n.mxRefCount||0)+1}this.releaseSvgGradients(this.oldGradients),this.oldGradients=t.gradients}},mxShape.prototype.paint=function(t){var e=this.scale,n=this.bounds.x/e,i=this.bounds.y/e,o=this.bounds.width/e,r=this.bounds.height/e;if(this.isPaintBoundsInverted())var s=(o-r)/2,n=n+s,i=i-s,s=o,o=r,r=s;if(this.updateTransform(t,n,i,o,r),this.configureCanvas(t,n,i,o,r),null!=this.stencil)this.paintStencilShape(t,n,i,o,r);else if(t.setStrokeWidth(this.strokewidth),null!=this.points){for(n=[],i=0;i<this.points.length;i++)n.push(new mxPoint(this.points[i].x/e,this.points[i].y/e));this.paintEdgeShape(t,n)}else this.paintVertexShape(t,n,i,o,r)},mxShape.prototype.configureCanvas=function(t,e,n,i,o){var r=null;null!=this.style&&(r=this.style.dashPattern),t.setAlpha(this.opacity/100),null!=this.isShadow&&t.setShadow(this.isShadow),null!=this.isDashed&&t.setDashed(this.isDashed),null!=r&&t.setDashPattern(r),null!=this.gradient?(e=this.getGradientBounds(t,e,n,i,o),t.setGradient(this.fill,this.gradient,e.x,e.y,e.width,e.height,this.gradientDirection)):t.setFillColor(this.fill),t.setStrokeColor(this.stroke)},mxShape.prototype.getGradientBounds=function(t,e,n,i,o){return new mxRectangle(e,n,i,o)},mxShape.prototype.updateTransform=function(t,e,n,i,o){t.scale(this.scale),t.rotate(this.getShapeRotation(),this.flipH,this.flipV,e+i/2,n+o/2)},mxShape.prototype.paintStencilShape=function(t,e,n,i,o){this.stencilPointerEvents&&(this.dialect==mxConstants.DIALECT_SVG?this.addTransparentBackgroundRectangle(this.node,e,n,i,o):8!=document.documentMode&&this.setTransparentBackgroundImage(this.node)),this.stencil.drawShape(t,this,e,n,i,o)},mxShape.prototype.paintVertexShape=function(t,e,n,i,o){this.paintBackground(t,e,n,i,o),t.setShadow(!1),this.paintForeground(t,e,n,i,o)},mxShape.prototype.paintBackground=function(){},mxShape.prototype.paintForeground=function(){},mxShape.prototype.paintEdgeShape=function(){},mxShape.prototype.getArcSize=function(t,e){var n=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,100*mxConstants.RECTANGLE_ROUNDING_FACTOR)/100;return Math.min(t*n,e*n)},mxShape.prototype.paintGlassEffect=function(t,e,n,i,o,r){var s=Math.ceil(this.strokewidth/2);t.setGradient("#ffffff","#ffffff",e,n,i,.6*o,"south",.9,.1),t.begin(),r+=2*s,this.isRounded?(t.moveTo(e-s+r,n-s),t.quadTo(e-s,n-s,e-s,n-s+r),t.lineTo(e-s,n+.4*o),t.quadTo(e+.5*i,n+.7*o,e+i+s,n+.4*o),t.lineTo(e+i+s,n-s+r),t.quadTo(e+i+s,n-s,e+i+s-r,n-s)):(t.moveTo(e-s,n-s),t.lineTo(e-s,n+.4*o),t.quadTo(e+.5*i,n+.7*o,e+i+s,n+.4*o),t.lineTo(e+i+s,n-s)),t.close(),t.fill()},mxShape.prototype.apply=function(t){this.state=t,this.style=t.style,null!=this.style&&(this.fill=mxUtils.getValue(this.style,mxConstants.STYLE_FILLCOLOR,this.fill),this.gradient=mxUtils.getValue(this.style,mxConstants.STYLE_GRADIENTCOLOR,this.gradient),this.gradientDirection=mxUtils.getValue(this.style,mxConstants.STYLE_GRADIENT_DIRECTION,this.gradientDirection),this.opacity=mxUtils.getValue(this.style,mxConstants.STYLE_OPACITY,this.opacity),this.stroke=mxUtils.getValue(this.style,mxConstants.STYLE_STROKECOLOR,this.stroke),this.strokewidth=mxUtils.getNumber(this.style,mxConstants.STYLE_STROKEWIDTH,this.strokewidth),this.spacing=mxUtils.getValue(this.style,mxConstants.STYLE_SPACING,this.spacing),this.startSize=mxUtils.getNumber(this.style,mxConstants.STYLE_STARTSIZE,this.startSize),this.endSize=mxUtils.getNumber(this.style,mxConstants.STYLE_ENDSIZE,this.endSize),this.startArrow=mxUtils.getValue(this.style,mxConstants.STYLE_STARTARROW,this.startArrow),this.endArrow=mxUtils.getValue(this.style,mxConstants.STYLE_ENDARROW,this.endArrow),this.rotation=mxUtils.getValue(this.style,mxConstants.STYLE_ROTATION,this.rotation),this.direction=mxUtils.getValue(this.style,mxConstants.STYLE_DIRECTION,this.direction),this.flipH=1==mxUtils.getValue(this.style,mxConstants.STYLE_FLIPH,0),this.flipV=1==mxUtils.getValue(this.style,mxConstants.STYLE_FLIPV,0),null!=this.stencil&&(this.flipH=1==mxUtils.getValue(this.style,"stencilFlipH",0)||this.flipH,this.flipV=1==mxUtils.getValue(this.style,"stencilFlipV",0)||this.flipV),("north"==this.direction||"south"==this.direction)&&(t=this.flipH,this.flipH=this.flipV,this.flipV=t),this.isShadow=1==mxUtils.getValue(this.style,mxConstants.STYLE_SHADOW,this.isShadow),this.isDashed=1==mxUtils.getValue(this.style,mxConstants.STYLE_DASHED,this.isDashed),this.isRounded=1==mxUtils.getValue(this.style,mxConstants.STYLE_ROUNDED,this.isRounded),this.glass=1==mxUtils.getValue(this.style,mxConstants.STYLE_GLASS,this.glass),"none"==this.fill&&(this.fill=null),"none"==this.gradient&&(this.gradient=null),"none"==this.stroke&&(this.stroke=null))},mxShape.prototype.setCursor=function(t){null==t&&(t=""),this.cursor=t,null!=this.node&&(this.node.style.cursor=t)},mxShape.prototype.getCursor=function(){return this.cursor},mxShape.prototype.updateBoundingBox=function(){if(null!=this.bounds){var t=this.createBoundingBox();if(null!=t){this.augmentBoundingBox(t);var e=this.getShapeRotation();0!=e&&(t=mxUtils.getBoundingBox(t,e)),t.x=Math.floor(t.x),t.y=Math.floor(t.y),t.width=Math.ceil(t.width),t.height=Math.ceil(t.height)}this.boundingBox=t}},mxShape.prototype.createBoundingBox=function(){var t=this.bounds.clone();if(this.isPaintBoundsInverted()){var e=(t.width-t.height)/2;t.x+=e,t.y-=e,e=t.width,t.width=t.height,t.height=e}return t},mxShape.prototype.augmentBoundingBox=function(t){this.isShadow&&(t.width+=Math.ceil(mxConstants.SHADOW_OFFSET_X*this.scale),t.height+=Math.ceil(mxConstants.SHADOW_OFFSET_Y*this.scale));var e=Math.ceil(this.strokewidth*this.scale);t.grow(Math.ceil(e/2))},mxShape.prototype.isPaintBoundsInverted=function(){return null==this.stencil&&("north"==this.direction||"south"==this.direction)},mxShape.prototype.getRotation=function(){return null!=this.rotation?this.rotation:0},mxShape.prototype.getTextRotation=function(){var t=this.getRotation();return 1!=mxUtils.getValue(this.style,mxConstants.STYLE_HORIZONTAL,1)&&(t+=mxText.prototype.verticalTextRotation),t},mxShape.prototype.getShapeRotation=function(){var t=this.getRotation();return null!=this.direction&&("north"==this.direction?t+=270:"west"==this.direction?t+=180:"south"==this.direction&&(t+=90)),t},mxShape.prototype.addTransparentBackgroundRectangle=function(t,e,n,i,o){t=document.createElementNS(mxConstants.NS_SVG,"rect"),t.setAttribute("x",e),t.setAttribute("y",n),t.setAttribute("width",i),t.setAttribute("height",o),t.setAttribute("fill","none"),t.setAttribute("stroke","none"),t.setAttribute("pointer-events","all"),this.node.appendChild(t)},mxShape.prototype.setTransparentBackgroundImage=function(t){t.style.backgroundImage="url('"+mxClient.imageBasePath+"/transparent.gif')"},mxShape.prototype.releaseSvgGradients=function(t){if(null!=t)for(var e in t){var n=t[e];n.mxRefCount=(n.mxRefCount||0)-1,0==n.mxRefCount&&null!=n.parentNode&&n.parentNode.removeChild(n)}},mxShape.prototype.destroy=function(){null!=this.node&&(mxEvent.release(this.node),null!=this.node.parentNode&&this.node.parentNode.removeChild(this.node),this.node=null),this.releaseSvgGradients(this.oldGradients),this.oldGradients=null};var mxStencilRegistry={stencils:[],addStencil:function(t,e){mxStencilRegistry.stencils[t]=e},getStencil:function(t){return mxStencilRegistry.stencils[t]}},mxMarker={markers:[],addMarker:function(t,e){mxMarker.markers[t]=e},createMarker:function(t,e,n,i,o,r,s,l,a,h){var d=mxMarker.markers[n];return null!=d?d(t,e,n,i,o,r,s,l,a,h):null}};!function(){function t(t,e,n,i,o,r,s,l,a,h){e=1.118*o*a,l=1.118*r*a,o*=s+a,r*=s+a;var d=i.clone();return d.x-=e,d.y-=l,s=n!=mxConstants.ARROW_CLASSIC?1:.75,i.x+=-o*s-e,i.y+=-r*s-l,function(){t.begin(),t.moveTo(d.x,d.y),t.lineTo(d.x-o-r/2,d.y-r+o/2),n==mxConstants.ARROW_CLASSIC&&t.lineTo(d.x-3*o/4,d.y-3*r/4),t.lineTo(d.x+r/2-o,d.y-r-o/2),t.close(),h?t.fillAndStroke():t.stroke()}}function e(t,e,n,i,o,r,s,l,a,h){l=n==mxConstants.ARROW_DIAMOND?.7071:.9862,e=o*a*l,l*=r*a,o*=s+a,r*=s+a;var d=i.clone();d.x-=e,d.y-=l,i.x+=-o-e,i.y+=-r-l;var u=n==mxConstants.ARROW_DIAMOND?2:3.4;return function(){t.begin(),t.moveTo(d.x,d.y),t.lineTo(d.x-o/2-r/u,d.y+o/u-r/2),t.lineTo(d.x-o,d.y-r),t.lineTo(d.x-o/2+r/u,d.y-r/2-o/u),t.close(),h?t.fillAndStroke():t.stroke()}}mxMarker.addMarker("classic",t),mxMarker.addMarker("block",t),mxMarker.addMarker("open",function(t,e,n,i,o,r,s,l,a){e=1.118*o*a,n=1.118*r*a,o*=s+a,r*=s+a;var h=i.clone();return h.x-=e,h.y-=n,i.x+=2*-e,i.y+=2*-n,function(){t.begin(),t.moveTo(h.x-o-r/2,h.y-r+o/2),t.lineTo(h.x,h.y),t.lineTo(h.x+r/2-o,h.y-r-o/2),t.stroke()}}),mxMarker.addMarker("oval",function(t,e,n,i,o,r,s,l,a,h){var d=s/2,u=i.clone();return i.x-=o*d,i.y-=r*d,function(){t.ellipse(u.x-d,u.y-d,s,s),h?t.fillAndStroke():t.stroke()}}),mxMarker.addMarker("diamond",e),mxMarker.addMarker("diamondThin",e)}(),mxUtils.extend(mxActor,mxShape),mxActor.prototype.paintVertexShape=function(t,e,n,i,o){t.translate(e,n),t.begin(),this.redrawPath(t,e,n,i,o),t.fillAndStroke()},mxActor.prototype.redrawPath=function(t,e,n,i,o){e=i/3,t.moveTo(0,o),t.curveTo(0,3*o/5,0,2*o/5,i/2,2*o/5),t.curveTo(i/2-e,2*o/5,i/2-e,0,i/2,0),t.curveTo(i/2+e,0,i/2+e,2*o/5,i/2,2*o/5),t.curveTo(i,2*o/5,i,3*o/5,i,o),t.close()},mxUtils.extend(mxCloud,mxActor),mxCloud.prototype.redrawPath=function(t,e,n,i,o){t.moveTo(.25*i,.25*o),t.curveTo(.05*i,.25*o,0,.5*o,.16*i,.55*o),t.curveTo(0,.66*o,.18*i,.9*o,.31*i,.8*o),t.curveTo(.4*i,o,.7*i,o,.8*i,.8*o),t.curveTo(i,.8*o,i,.6*o,.875*i,.5*o),t.curveTo(i,.3*o,.8*i,.1*o,.625*i,.2*o),t.curveTo(.5*i,.05*o,.3*i,.05*o,.25*i,.25*o),t.close()},mxUtils.extend(mxRectangleShape,mxShape),mxRectangleShape.prototype.isHtmlAllowed=function(){return!this.isRounded&&!this.glass&&0==this.rotation},mxRectangleShape.prototype.paintBackground=function(t,e,n,i,o){if(this.isRounded){var r=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,100*mxConstants.RECTANGLE_ROUNDING_FACTOR)/100,r=Math.min(i*r,o*r);t.roundrect(e,n,i,o,r,r)}else t.rect(e,n,i,o);t.fillAndStroke()},mxRectangleShape.prototype.paintForeground=function(t,e,n,i,o){this.glass&&this.paintGlassEffect(t,e,n,i,o,this.getArcSize(i+this.strokewidth,o+this.strokewidth))},mxRectangleShape.prototype.redrawHtmlShape=function(){this.updateHtmlBounds(this.node),this.updateHtmlFilters(this.node),this.updateHtmlColors(this.node)},mxRectangleShape.prototype.updateHtmlBounds=function(t){var e=9<=document.documentMode?0:Math.ceil(this.strokewidth*this.scale);t.style.borderWidth=Math.max(1,e)+"px",t.style.overflow="hidden",t.style.left=Math.round(this.bounds.x-e/2)+"px",t.style.top=Math.round(this.bounds.y-e/2)+"px","CSS1Compat"==document.compatMode&&(e=-e),t.style.width=Math.round(Math.max(0,this.bounds.width+e))+"px",t.style.height=Math.round(Math.max(0,this.bounds.height+e))+"px"},mxRectangleShape.prototype.updateHtmlColors=function(t){var e=this.stroke;null!=e&&e!=mxConstants.NONE?(t.style.borderColor=e,this.isDashed?t.style.borderStyle="dashed":0<this.strokewidth&&(t.style.borderStyle="solid"),t.style.borderWidth=Math.max(1,Math.ceil(this.strokewidth*this.scale))+"px"):t.style.borderWidth="0px",e=this.fill,null!=e&&e!=mxConstants.NONE?(t.style.backgroundColor=e,t.style.backgroundImage="none"):this.pointerEvents?t.style.backgroundColor="transparent":8==document.documentMode?mxUtils.addTransparentBackgroundFilter(t):this.setTransparentBackgroundImage(t)},mxRectangleShape.prototype.updateHtmlFilters=function(t){var e="";if(100>this.opacity&&(e+="alpha(opacity="+this.opacity+")"),this.isShadow&&(e+="progid:DXImageTransform.Microsoft.dropShadow (OffX='"+Math.round(mxConstants.SHADOW_OFFSET_X*this.scale)+"', OffY='"+Math.round(mxConstants.SHADOW_OFFSET_Y*this.scale)+"', Color='"+mxConstants.SHADOWCOLOR+"')"),this.gradient){var n=this.fill,i=this.gradient,o="0",r={east:0,south:1,west:2,north:3},s=null!=this.direction?r[this.direction]:0;null!=this.gradientDirection&&(s=mxUtils.mod(s+r[this.gradientDirection]-1,4)),1==s?(o="1",r=n,n=i,i=r):2==s?(r=n,n=i,i=r):3==s&&(o="1"),e+="progid:DXImageTransform.Microsoft.gradient(startColorStr='"+n+"', endColorStr='"+i+"', gradientType='"+o+"')"}t.style.filter=e},mxUtils.extend(mxEllipse,mxShape),mxEllipse.prototype.paintVertexShape=function(t,e,n,i,o){t.ellipse(e,n,i,o),t.fillAndStroke()},mxUtils.extend(mxDoubleEllipse,mxShape),mxDoubleEllipse.prototype.vmlScale=10,mxDoubleEllipse.prototype.paintBackground=function(t,e,n,i,o){t.ellipse(e,n,i,o),t.fillAndStroke()},mxDoubleEllipse.prototype.paintForeground=function(t,e,n,i,o){var r=Math.min(4,Math.min(i/5,o/5));i-=2*r,o-=2*r,i>0&&o>0&&t.ellipse(e+r,n+r,i,o),t.stroke()},mxUtils.extend(mxRhombus,mxShape),mxRhombus.prototype.paintVertexShape=function(t,e,n,i,o){var r=i/2,s=o/2;t.begin(),t.moveTo(e+r,n),t.lineTo(e+i,n+s),t.lineTo(e+r,n+o),t.lineTo(e,n+s),t.close(),t.fillAndStroke()},mxUtils.extend(mxPolyline,mxShape),mxPolyline.prototype.getRotation=function(){return 0},mxPolyline.prototype.paintEdgeShape=function(t,e){this.paintLine(t,e,this.isRounded)},mxPolyline.prototype.paintLine=function(t,e,n){var i=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2,o=e[0],r=e[e.length-1];t.begin(),t.moveTo(o.x,o.y);for(var s=1;s<e.length-1;s++){var l=e[s],a=o.x-l.x,o=o.y-l.y;if(n&&s<e.length-1&&(0!=a||0!=o)){var h=Math.sqrt(a*a+o*o),a=a*Math.min(i,h/2)/h,o=o*Math.min(i,h/2)/h;t.lineTo(l.x+a,l.y+o),o=e[s+1],a=o.x-l.x,o=o.y-l.y,h=Math.max(1,Math.sqrt(a*a+o*o)),a=a*Math.min(i,h/2)/h,o=o*Math.min(i,h/2)/h,a=l.x+a,o=l.y+o,t.quadTo(l.x,l.y,a,o),l=new mxPoint(a,o)}else t.lineTo(l.x,l.y);o=l}t.lineTo(r.x,r.y),t.stroke()},mxUtils.extend(mxArrow,mxShape),mxArrow.prototype.paintEdgeShape=function(t,e){var n=mxConstants.ARROW_SPACING,i=mxConstants.ARROW_WIDTH,o=mxConstants.ARROW_SIZE,r=e[0],s=e[e.length-1],l=s.x-r.x,a=s.y-r.y,h=Math.sqrt(l*l+a*a),d=h-2*n-o,l=l/h,a=a/h,h=i*a/3,i=-i*l/3,o=r.x-h/2+n*l,r=r.y-i/2+n*a,u=o+h,c=r+i,p=u+d*l,d=c+d*a,m=p+h,g=d+i,f=m-3*h,x=g-3*i;t.begin(),t.moveTo(o,r),t.lineTo(u,c),t.lineTo(p,d),t.lineTo(m,g),t.lineTo(s.x-n*l,s.y-n*a),t.lineTo(f,x),t.lineTo(f+h,x+i),t.close(),t.fillAndStroke()},mxUtils.extend(mxText,mxShape),mxText.prototype.baseSpacingTop=0,mxText.prototype.baseSpacingBottom=0,mxText.prototype.baseSpacingLeft=0,mxText.prototype.baseSpacingRight=0,mxText.prototype.replaceLinefeeds=!0,mxText.prototype.verticalTextRotation=-90,mxText.prototype.ignoreClippedStringSize=!0,mxText.prototype.ignoreStringSize=!1,mxText.prototype.isParseVml=function(){return!1},mxText.prototype.isHtmlAllowed=function(){return 8!=document.documentMode},mxText.prototype.getSvgScreenOffset=function(){return 0},mxText.prototype.checkBounds=function(){return!(null==this.bounds||isNaN(this.bounds.x)||isNaN(this.bounds.y)||isNaN(this.bounds.width)||isNaN(this.bounds.height))},mxText.prototype.updateBoundingBox=function(){var t=this.node;8==document.documentMode&&null!=t.firstChild&&(t=t.firstChild,null!=t.firstChild&&(t=t.firstChild)),this.boundingBox=this.bounds.clone();var e=this.getTextRotation();if(this.ignoreStringSize||null==t||"fill"==this.overflow||this.clipped&&this.ignoreClippedStringSize)this.boundingBox.x+=this.margin.x*this.boundingBox.width,this.boundingBox.y+=this.margin.y*this.boundingBox.height;else{var n=null,i=null;if(null!=t.ownerSVGElement)if(null!=t.firstChild&&null!=t.firstChild.firstChild&&"foreignObject"==t.firstChild.firstChild.nodeName)t=t.firstChild.firstChild,n=this.wrap?this.bounds.width:parseInt(t.getAttribute("width"))*this.scale,i=parseInt(t.getAttribute("height"))*this.scale;else{if(e=t.getBBox(),0==e.width&&0==e.height)return;this.boundingBox=new mxRectangle(e.x,e.y,e.width,e.height),e=0}else i=this.state.view.textDiv,null!=this.offsetWidth&&null!=this.offsetHeight?(n=this.wrap?this.bounds.width:this.offsetWidth*this.scale,i=this.offsetHeight*this.scale):null!=i?(this.updateFont(i),this.updateSize(i),mxUtils.isNode(this.value)?i.innerHTML=this.value.outerHTML:(n=this.replaceLinefeeds?this.value.replace(/\n/g,"<br/>"):this.value,i.innerHTML=n),n=this.wrap?this.bounds.width:i.offsetWidth*this.scale,i=i.offsetHeight*this.scale):(n=this.wrap?this.bounds.width:t.offsetWidth*this.scale,i=t.offsetHeight*this.scale);null!=n&&null!=i&&(this.boundingBox=new mxRectangle(this.bounds.x+this.margin.x*n,this.bounds.y+this.margin.y*i,n,i))}null!=this.boundingBox&&(0!=e&&(e=mxUtils.getBoundingBox(this.boundingBox,e),this.boundingBox.x=e.x,this.boundingBox.y=e.y,mxClient.IS_QUIRKS||(this.boundingBox.width=e.width,this.boundingBox.height=e.height)),this.boundingBox.x=Math.floor(this.boundingBox.x),this.boundingBox.y=Math.floor(this.boundingBox.y),this.boundingBox.width=Math.ceil(this.boundingBox.width),this.boundingBox.height=Math.ceil(this.boundingBox.height))},mxText.prototype.getShapeRotation=function(){return 0},mxText.prototype.getTextRotation=function(){return null!=this.state&&null!=this.state.shape?this.state.shape.getTextRotation():0},mxText.prototype.isPaintBoundsInverted=function(){return!this.horizontal&&null!=this.state&&this.state.view.graph.model.isVertex(this.state.cell)},mxText.prototype.configureCanvas=function(t){mxShape.prototype.configureCanvas.apply(this,arguments),t.setFontColor(this.color),t.setFontBackgroundColor(this.background),t.setFontBorderColor(this.border),t.setFontFamily(this.family),t.setFontSize(this.size),t.setFontStyle(this.fontStyle)},mxText.prototype.updateVmlContainer=function(){this.node.style.left=Math.round(this.bounds.x)+"px",this.node.style.top=Math.round(this.bounds.y)+"px",this.node.style.width="1px",this.node.style.height="1px",this.node.style.overflow="visible"},mxText.prototype.paint=function(t){var e=this.scale,n=this.bounds.x/e,i=this.bounds.y/e,o=this.bounds.width/e,e=this.bounds.height/e;this.updateTransform(t,n,i,o,e),this.configureCanvas(t,n,i,o,e);var r=mxUtils.isNode(this.value)||this.dialect==mxConstants.DIALECT_STRICTHTML,s=r||t instanceof mxVmlCanvas2D?"html":"",l=this.value;!r&&"html"==s&&(l=mxUtils.htmlEntities(l,!1)),l=!mxUtils.isNode(this.value)&&this.replaceLinefeeds&&"html"==s?l.replace(/\n/g,"<br/>"):l,t.text(n,i,o,e,l,this.align,this.valign,this.wrap,s,this.overflow,this.clipped,this.getTextRotation())},mxText.prototype.redrawHtmlShape=function(){var t=this.node.style;t.opacity=1>this.opacity?this.opacity:"",t.overflow="",t.width="",t.height="",this.updateFont(this.node),this.updateSize(this.node),this.updateValue(),this.offsetHeight=this.offsetWidth=null,null!=mxClient.CSS_PREFIX?this.updateHtmlTransform():this.updateHtmlFilter()},mxText.prototype.updateHtmlTransform=function(){var t=this.getTextRotation(),e=this.node.style,n=this.margin.x,i=this.margin.y;0!=t?(e[mxClient.CSS_PREFIX+"TransformOrigin"]=100*-n+"% "+100*-i+"%",e[mxClient.CSS_PREFIX+"Transform"]="translate("+100*n+"%,"+100*i+"%)scale("+this.scale+") rotate("+t+"deg)"):(e[mxClient.CSS_PREFIX+"TransformOrigin"]="0% 0%",e[mxClient.CSS_PREFIX+"Transform"]="scale("+this.scale+")translate("+100*n+"%,"+100*i+"%)"),e.left=Math.round(this.bounds.x)+"px",e.top=Math.round(this.bounds.y)+"px"},mxText.prototype.updateHtmlFilter=function(){var t=this.node.style,e=this.margin.x,n=this.margin.y,i=this.scale;t.filter="";var o=0,r=0,s=null!=this.state?this.state.view.textDiv:null;if(null!=s){if(s.style.overflow="",s.style.height="",s.style.width="",this.updateFont(s),this.updateSize(s),mxUtils.isNode(this.value))s.innerHTML=this.value.outerHTML;else{var l=this.value;this.dialect!=mxConstants.DIALECT_STRICTHTML&&(l=mxUtils.htmlEntities(l,!1)),l=this.replaceLinefeeds?l.replace(/\n/g,"<br/>"):l,s.innerHTML=l}o=s.offsetWidth+2,r=s.offsetHeight+2}else o=this.node.offsetWidth,r=this.node.offsetHeight+1;this.offsetWidth=o,this.offsetHeight=r,s=this.bounds.width/i,l=this.bounds.height/i,mxClient.IS_QUIRKS&&(this.clipped||"width"==this.overflow)&&l>0?(l=Math.min(l,r),t.height=Math.round(l)+"px"):l=r,"fill"!=this.overflow&&"width"!=this.overflow&&(mxClient.IS_QUIRKS&&(this.clipped||this.wrap)&&s>0?(s=Math.min(s,o),t.width=Math.round(s)+"px"):s=o);var l=l*i,s=s*i,o=this.getTextRotation()*(Math.PI/180),r=parseFloat(parseFloat(Math.cos(o)).toFixed(8)),a=parseFloat(parseFloat(Math.sin(-o)).toFixed(8)),o=o%(2*Math.PI);0>o&&(o+=2*Math.PI),o%=Math.PI,o>Math.PI/2&&(o=Math.PI-o);var h=Math.cos(o),d=Math.sin(-o),e=s*-(e+.5),n=l*-(n+.5),u=(l-l*h+s*d)/2+a*e-r*n;0!=o&&(t.filter="progid:DXImageTransform.Microsoft.Matrix(M11="+r+", M12="+a+", M21="+-a+", M22="+r+", sizingMethod='auto expand')"),t.zoom=i,t.left=Math.round(this.bounds.x+((s-s*h+l*d)/2-r*e-a*n)-s/2)+"px",t.top=Math.round(this.bounds.y+u-l/2)+"px"},mxText.prototype.updateValue=function(){if(mxUtils.isNode(this.value))this.node.innerHTML="",this.node.appendChild(this.value);else{var t=this.value;this.dialect!=mxConstants.DIALECT_STRICTHTML&&(t=mxUtils.htmlEntities(t,!1));var t=this.replaceLinefeeds?t.replace(/\n/g,"<br/>"):t,e=null!=this.background&&this.background!=mxConstants.NONE?this.background:null,n=null!=this.border&&this.border!=mxConstants.NONE?this.border:null;if(null!=e||null!=n)if("fill"==this.overflow||"width"==this.overflow)null!=e&&(this.node.style.backgroundColor=e),null!=n&&(this.node.style.border="1px solid "+n);else{var i="";null!=e&&(i+="background-color:"+e+";"),null!=n&&(i+="border:1px solid "+n+";"),t='<div style="zoom:1;'+i+"display:inline-block;_display:inline;padding-bottom:1px;padding-right:1px;line-height:"+this.node.style.lineHeight+'">'+t+"</div>",this.node.style.lineHeight=""}this.node.innerHTML=t}},mxText.prototype.updateFont=function(t){t=t.style,t.lineHeight=Math.round(this.size*mxConstants.LINE_HEIGHT)+"px",t.fontSize=Math.round(this.size)+"px",t.fontFamily=this.family,t.verticalAlign="top",t.color=this.color,t.fontWeight=(this.fontStyle&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD?"bold":"",t.fontStyle=(this.fontStyle&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC?"italic":"",t.textDecoration=(this.fontStyle&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE?"underline":"",t.textAlign=this.align==mxConstants.ALIGN_CENTER?"center":this.align==mxConstants.ALIGN_RIGHT?"right":"left"},mxText.prototype.updateSize=function(t){var e=Math.round(this.bounds.width/this.scale),n=Math.round(this.bounds.height/this.scale);t=t.style,this.clipped?(t.overflow="hidden",n>0&&(t.maxHeight=n+"px"),e>0&&(t.width=e+"px")):"fill"==this.overflow?(t.width=e+"px",t.height=n+"px"):"width"==this.overflow&&(t.width=e+"px",n>0&&(t.maxHeight=n+"px")),this.wrap&&e>0?(this.clipped||(t.width=e+"px"),t.whiteSpace="normal"):t.whiteSpace="nowrap"},mxText.prototype.updateMargin=function(){this.margin=mxUtils.getAlignmentAsPoint(this.align,this.valign)},mxText.prototype.getSpacing=function(){var t=0,e=0,t=this.align==mxConstants.ALIGN_CENTER?(this.spacingLeft-this.spacingRight)/2:this.align==mxConstants.ALIGN_RIGHT?-this.spacingRight-this.baseSpacingRight:this.spacingLeft+this.baseSpacingLeft,e=this.valign==mxConstants.ALIGN_MIDDLE?(this.spacingTop-this.spacingBottom)/2:this.valign==mxConstants.ALIGN_BOTTOM?-this.spacingBottom-this.baseSpacingBottom:this.spacingTop+this.baseSpacingTop;return new mxPoint(t,e)},mxUtils.extend(mxTriangle,mxActor),mxTriangle.prototype.redrawPath=function(t,e,n,i,o){t.moveTo(0,0),t.lineTo(i,.5*o),t.lineTo(0,o),t.close()},mxUtils.extend(mxHexagon,mxActor),mxHexagon.prototype.redrawPath=function(t,e,n,i,o){t.moveTo(.25*i,0),t.lineTo(.75*i,0),t.lineTo(i,.5*o),t.lineTo(.75*i,o),t.lineTo(.25*i,o),t.lineTo(0,.5*o),t.close()},mxUtils.extend(mxLine,mxShape),mxLine.prototype.paintVertexShape=function(t,e,n,i,o){n+=o/2,t.begin(),t.moveTo(e,n),t.lineTo(e+i,n),t.stroke()},mxUtils.extend(mxImageShape,mxRectangleShape),mxImageShape.prototype.preserveImageAspect=!0,mxImageShape.prototype.getSvgScreenOffset=function(){return mxClient.IS_IE?0:.5},mxImageShape.prototype.apply=function(){mxShape.prototype.apply.apply(this,arguments),this.gradient=this.stroke=this.fill=null,null!=this.style&&(this.fill=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_BACKGROUND),this.stroke=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_BORDER),this.preserveImageAspect=1==mxUtils.getNumber(this.style,mxConstants.STYLE_IMAGE_ASPECT,1),this.flipH=this.flipH||1==mxUtils.getValue(this.style,"imageFlipH",0),this.flipV=this.flipV||1==mxUtils.getValue(this.style,"imageFlipV",0))},mxImageShape.prototype.isHtmlAllowed=function(){return!this.preserveImageAspect},mxImageShape.prototype.createHtml=function(){var t=document.createElement("div");return t.style.position="absolute",t},mxImageShape.prototype.paintVertexShape=function(t,e,n,i,o){if(null!=this.image){var r=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_BACKGROUND,null),s=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_BORDER,null);(null!=r||null!=s)&&(t.setFillColor(r),t.setStrokeColor(s),t.rect(e,n,i,o),t.fillAndStroke()),t.image(e,n,i,o,this.image,this.preserveImageAspect,!1,!1)}else mxRectangleShape.prototype.paintBackground.apply(this,arguments)},mxImageShape.prototype.redrawHtmlShape=function(){if(this.node.style.left=Math.round(this.bounds.x)+"px",this.node.style.top=Math.round(this.bounds.y)+"px",this.node.style.width=Math.max(0,Math.round(this.bounds.width))+"px",this.node.style.height=Math.max(0,Math.round(this.bounds.height))+"px",this.node.style.backgroundColor=this.fill||"",this.node.style.borderColor=this.stroke||"",this.node.innerHTML="",null!=this.image){var t=document.createElement(mxClient.IS_IE6||null==mxClient.CSS_PREFIX&&0!=this.rotation?mxClient.VML_PREFIX+":image":"img");t.style.position="absolute",t.src=this.image;var e=100>this.opacity?"alpha(opacity="+this.opacity+")":"";this.node.style.filter=e,this.flipH&&this.flipV?e+="progid:DXImageTransform.Microsoft.BasicImage(rotation=2)":this.flipH?e+="progid:DXImageTransform.Microsoft.BasicImage(mirror=1)":this.flipV&&(e+="progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)"),t.style.filter!=e&&(t.style.filter=e),"image"==t.nodeName?t.style.rotation=this.rotation:t.style[mxClient.CSS_PREFIX+"Transform"]="rotate("+this.rotation+"deg)",t.style.width=this.node.style.width,t.style.height=this.node.style.height,this.node.style.backgroundImage="",this.node.appendChild(t)}else this.setTransparentBackgroundImage(this.node)},mxUtils.extend(mxLabel,mxRectangleShape),mxLabel.prototype.imageSize=mxConstants.DEFAULT_IMAGESIZE,mxLabel.prototype.spacing=2,mxLabel.prototype.indicatorSize=10,mxLabel.prototype.indicatorSpacing=2,mxLabel.prototype.init=function(){mxShape.prototype.init.apply(this,arguments),null!=this.indicatorColor&&null!=this.indicatorShape&&(this.indicator=new this.indicatorShape,this.indicator.dialect=this.dialect,this.indicator.bounds=this.bounds,this.indicator.fill=this.indicatorColor,this.indicator.stroke=this.indicatorColor,this.indicator.gradient=this.indicatorGradientColor,this.indicator.direction=this.indicatorDirection,this.indicator.init(this.node))},mxLabel.prototype.redraw=function(){null!=this.indicator&&(this.indicator.fill=this.indicatorColor,this.indicator.stroke=this.indicatorColor,this.indicator.gradient=this.indicatorGradientColor,this.indicator.direction=this.indicatorDirection),mxShape.prototype.redraw.apply(this,arguments)},mxLabel.prototype.isHtmlAllowed=function(){return mxRectangleShape.prototype.isHtmlAllowed.apply(this,arguments)&&null==this.indicatorColor&&null==this.indicatorShape},mxLabel.prototype.paintForeground=function(t,e,n,i,o){this.paintImage(t,e,n,i,o),this.paintIndicator(t,e,n,i,o),mxRectangleShape.prototype.paintForeground.apply(this,arguments)},mxLabel.prototype.paintImage=function(t,e,n,i,o){null!=this.image&&(e=this.getImageBounds(e,n,i,o),t.image(e.x,e.y,e.width,e.height,this.image,!1,!1,!1))},mxLabel.prototype.getImageBounds=function(t,e,n,i){var o=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_ALIGN,mxConstants.ALIGN_LEFT),r=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_VERTICAL_ALIGN,mxConstants.ALIGN_MIDDLE),s=mxUtils.getNumber(this.style,mxConstants.STYLE_IMAGE_WIDTH,mxConstants.DEFAULT_IMAGESIZE),l=mxUtils.getNumber(this.style,mxConstants.STYLE_IMAGE_HEIGHT,mxConstants.DEFAULT_IMAGESIZE),a=mxUtils.getNumber(this.style,mxConstants.STYLE_SPACING,this.spacing)+5;return t=o==mxConstants.ALIGN_CENTER?t+(n-s)/2:o==mxConstants.ALIGN_RIGHT?t+(n-s-a):t+a,e=r==mxConstants.ALIGN_TOP?e+a:r==mxConstants.ALIGN_BOTTOM?e+(i-l-a):e+(i-l)/2,new mxRectangle(t,e,s,l)},mxLabel.prototype.paintIndicator=function(t,e,n,i,o){null!=this.indicator?(this.indicator.bounds=this.getIndicatorBounds(e,n,i,o),this.indicator.paint(t)):null!=this.indicatorImage&&(e=this.getIndicatorBounds(e,n,i,o),t.image(e.x,e.y,e.width,e.height,this.indicatorImage,!1,!1,!1))},mxLabel.prototype.getIndicatorBounds=function(t,e,n,i){var o=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_ALIGN,mxConstants.ALIGN_LEFT),r=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_VERTICAL_ALIGN,mxConstants.ALIGN_MIDDLE),s=mxUtils.getNumber(this.style,mxConstants.STYLE_INDICATOR_WIDTH,this.indicatorSize),l=mxUtils.getNumber(this.style,mxConstants.STYLE_INDICATOR_HEIGHT,this.indicatorSize),a=this.spacing+5;return t=o==mxConstants.ALIGN_RIGHT?t+(n-s-a):o==mxConstants.ALIGN_CENTER?t+(n-s)/2:t+a,e=r==mxConstants.ALIGN_BOTTOM?e+(i-l-a):r==mxConstants.ALIGN_TOP?e+a:e+(i-l)/2,new mxRectangle(t,e,s,l)},mxLabel.prototype.redrawHtmlShape=function(){for(mxRectangleShape.prototype.redrawHtmlShape.apply(this,arguments);this.node.hasChildNodes();)this.node.removeChild(this.node.lastChild);if(null!=this.image){var t=document.createElement("img");t.style.position="relative",t.setAttribute("border","0");var e=this.getImageBounds(this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height);e.x-=this.bounds.x,e.y-=this.bounds.y,t.style.left=Math.round(e.x)+"px",t.style.top=Math.round(e.y)+"px",t.style.width=Math.round(e.width)+"px",t.style.height=Math.round(e.height)+"px",t.src=this.image,this.node.appendChild(t)}},mxUtils.extend(mxCylinder,mxShape),mxCylinder.prototype.maxHeight=40,mxCylinder.prototype.svgStrokeTolerance=0,mxCylinder.prototype.paintVertexShape=function(t,e,n,i,o){t.translate(e,n),t.begin(),this.redrawPath(t,e,n,i,o,!1),t.fillAndStroke(),t.setShadow(!1),t.begin(),this.redrawPath(t,e,n,i,o,!0),t.stroke()},mxCylinder.prototype.redrawPath=function(t,e,n,i,o,r){e=Math.min(this.maxHeight,Math.round(o/5)),(r&&null!=this.fill||!r&&null==this.fill)&&(t.moveTo(0,e),t.curveTo(0,2*e,i,2*e,i,e),r||(t.stroke(),t.begin())),r||(t.moveTo(0,e),t.curveTo(0,-e/3,i,-e/3,i,e),t.lineTo(i,o-e),t.curveTo(i,o+e/3,0,o+e/3,0,o-e),t.close())},mxUtils.extend(mxConnector,mxPolyline),mxConnector.prototype.paintEdgeShape=function(t,e){var n=this.createMarker(t,e,!0),i=this.createMarker(t,e,!1);null==this.style||1!=this.style[mxConstants.STYLE_CURVED]?this.paintLine(t,e,this.isRounded):this.paintCurvedLine(t,e),t.setFillColor(this.stroke),t.setShadow(!1),t.setDashed(!1),null!=n&&n(),null!=i&&i()},mxConnector.prototype.paintCurvedLine=function(t,e){t.begin();var n=e[0],i=e.length;for(t.moveTo(n.x,n.y),n=1;i-2>n;n++){var o=e[n],r=e[n+1];t.quadTo(o.x,o.y,(o.x+r.x)/2,(o.y+r.y)/2)}o=e[i-2],r=e[i-1],t.quadTo(o.x,o.y,r.x,r.y),t.stroke()},mxConnector.prototype.createMarker=function(t,e,n){var i=e.length,o=n?e[1]:e[i-2];e=n?e[0]:e[i-1];var i=e.x-o.x,r=e.y-o.y,s=Math.max(1,Math.sqrt(i*i+r*r)),o=i/s,i=r/s,r=mxUtils.getNumber(this.style,n?mxConstants.STYLE_STARTSIZE:mxConstants.STYLE_ENDSIZE,mxConstants.DEFAULT_MARKERSIZE),s=mxUtils.getValue(this.style,n?mxConstants.STYLE_STARTARROW:mxConstants.STYLE_ENDARROW);return mxMarker.createMarker(t,this,s,e,o,i,r,n,this.strokewidth,0!=this.style[n?mxConstants.STYLE_STARTFILL:mxConstants.STYLE_ENDFILL])},mxConnector.prototype.augmentBoundingBox=function(t){mxShape.prototype.augmentBoundingBox.apply(this,arguments);var e=0;mxUtils.getValue(this.style,mxConstants.STYLE_STARTARROW,mxConstants.NONE)!=mxConstants.NONE&&(e=mxUtils.getNumber(this.style,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_MARKERSIZE)+1),mxUtils.getValue(this.style,mxConstants.STYLE_ENDARROW,mxConstants.NONE)!=mxConstants.NONE&&(e=Math.max(e,mxUtils.getNumber(this.style,mxConstants.STYLE_ENDSIZE,mxConstants.DEFAULT_MARKERSIZE))+1),t.grow(Math.ceil(e*this.scale))},mxUtils.extend(mxSwimlane,mxShape),mxSwimlane.prototype.imageSize=16,mxSwimlane.prototype.getGradientBounds=function(t,e,n,i,o){return t=Math.min(o,mxUtils.getValue(this.style,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_STARTSIZE)),new mxRectangle(e,n,i,t)},mxSwimlane.prototype.getRotation=function(){var t=mxShape.prototype.getRotation.apply(this,arguments);return 1!=mxUtils.getValue(this.style,mxConstants.STYLE_HORIZONTAL,1)&&(t+=mxText.prototype.verticalTextRotation),t
},mxSwimlane.prototype.getTextRotation=function(){return this.getRotation()},mxSwimlane.prototype.isPaintBoundsInverted=function(){return mxShape.prototype.isPaintBoundsInverted.apply(this,arguments)||1!=mxUtils.getValue(this.style,mxConstants.STYLE_HORIZONTAL,1)},mxSwimlane.prototype.getArcSize=function(t,e,n){return t=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,100*mxConstants.RECTANGLE_ROUNDING_FACTOR)/100,3*n*t},mxSwimlane.prototype.paintVertexShape=function(t,e,n,i,o){var r=Math.min(o,mxUtils.getValue(this.style,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_STARTSIZE)),s=mxUtils.getValue(this.style,mxConstants.STYLE_SWIMLANE_FILLCOLOR,mxConstants.NONE),l=1==mxUtils.getValue(this.style,mxConstants.STYLE_SWIMLANE_LINE,1),a=0;t.translate(e,n),this.isRounded?(a=this.getArcSize(i,o,r),this.paintRoundedSwimlane(t,e,n,i,o,r,a,s,l)):this.paintSwimlane(t,e,n,i,o,r,s,l),s=mxUtils.getValue(this.style,mxConstants.STYLE_SEPARATORCOLOR,mxConstants.NONE),this.paintSeparator(t,i,r,o,s),null!=this.image&&(o=this.getImageBounds(e,n,i,o),t.image(o.x-e,o.y-n,o.width,o.height,this.image,!1,!1,!1)),this.glass&&(t.setShadow(!1),this.paintGlassEffect(t,0,0,i,r,a))},mxSwimlane.prototype.paintSwimlane=function(t,e,n,i,o,r,s,l){s!=mxConstants.NONE&&(t.save(),t.setFillColor(s),t.rect(0,0,i,o),t.fillAndStroke(),t.restore(),t.setShadow(!1)),t.begin(),t.moveTo(0,r),t.lineTo(0,0),t.lineTo(i,0),t.lineTo(i,r),l&&t.close(),t.fillAndStroke(),o>r&&s==mxConstants.NONE&&(t.pointerEvents=!1,t.begin(),t.moveTo(0,r),t.lineTo(0,o),t.lineTo(i,o),t.lineTo(i,r),t.stroke())},mxSwimlane.prototype.paintRoundedSwimlane=function(t,e,n,i,o,r,s,l,a){l!=mxConstants.NONE&&(t.save(),t.setFillColor(l),t.roundrect(0,0,i,o,s,s),t.fillAndStroke(),t.restore(),t.setShadow(!1)),t.begin(),t.moveTo(i,r),t.lineTo(i,s),t.quadTo(i,0,i-Math.min(i/2,s),0),t.lineTo(Math.min(i/2,s),0),t.quadTo(0,0,0,s),t.lineTo(0,r),a&&t.close(),t.fillAndStroke(),o>r&&l==mxConstants.NONE&&(t.pointerEvents=!1,t.begin(),t.moveTo(0,r),t.lineTo(0,o-s),t.quadTo(0,o,Math.min(i/2,s),o),t.lineTo(i-Math.min(i/2,s),o),t.quadTo(i,o,i,o-s),t.lineTo(i,r),t.stroke())},mxSwimlane.prototype.paintSeparator=function(t,e,n,i,o){o!=mxConstants.NONE&&(t.setStrokeColor(o),t.setDashed(!0),t.begin(),t.moveTo(e,n),t.lineTo(e,i),t.stroke(),t.setDashed(!1))},mxSwimlane.prototype.getImageBounds=function(t,e,n){return new mxRectangle(t+n-this.imageSize,e,this.imageSize,this.imageSize)},mxGraphLayout.prototype.graph=null,mxGraphLayout.prototype.useBoundingBox=!0,mxGraphLayout.prototype.parent=null,mxGraphLayout.prototype.moveCell=function(){},mxGraphLayout.prototype.execute=function(){},mxGraphLayout.prototype.getGraph=function(){return this.graph},mxGraphLayout.prototype.getConstraint=function(t,e,n){return n=this.graph.view.getState(e),e=null!=n?n.style:this.graph.getCellStyle(e),null!=e?e[t]:null},mxGraphLayout.traverse=function(t,e,n,i,o){if(null!=n&&null!=t){e=null!=e?e:!0,o=o||[];var r=mxCellPath.create(t);if(null==o[r]&&(o[r]=t,i=n(t,i),null==i||i)&&(i=this.graph.model.getEdgeCount(t),i>0))for(r=0;i>r;r++){var s=this.graph.model.getEdgeAt(t,r),l=this.graph.model.getTerminal(s,!0)==t;(!e||l)&&(l=this.graph.view.getVisibleTerminal(s,!l),this.traverse(l,e,n,s,o))}}},mxGraphLayout.prototype.isVertexMovable=function(t){return this.graph.isCellMovable(t)},mxGraphLayout.prototype.isVertexIgnored=function(t){return!this.graph.getModel().isVertex(t)||!this.graph.isCellVisible(t)},mxGraphLayout.prototype.isEdgeIgnored=function(t){var e=this.graph.getModel();return!e.isEdge(t)||!this.graph.isCellVisible(t)||null==e.getTerminal(t,!0)||null==e.getTerminal(t,!1)},mxGraphLayout.prototype.setEdgeStyleEnabled=function(t,e){this.graph.setCellStyles(mxConstants.STYLE_NOEDGESTYLE,e?"0":"1",[t])},mxGraphLayout.prototype.setOrthogonalEdge=function(t,e){this.graph.setCellStyles(mxConstants.STYLE_ORTHOGONAL,e?"1":"0",[t])},mxGraphLayout.prototype.getParentOffset=function(t){var e=new mxPoint;if(null!=t&&t!=this.parent){var n=this.graph.getModel();if(n.isAncestor(this.parent,t))for(var i=n.getGeometry(t);t!=this.parent;)e.x+=i.x,e.y+=i.y,t=n.getParent(t),i=n.getGeometry(t)}return e},mxGraphLayout.prototype.setEdgePoints=function(t,e){if(null!=t){var n=this.graph.model,i=n.getGeometry(t);if(null==i?(i=new mxGeometry,i.setRelative(!0)):i=i.clone(),null!=this.parent&&null!=e)for(var o=n.getParent(t),o=this.getParentOffset(o),r=0;r<e.length;r++)e[r].x-=o.x,e[r].y-=o.y;i.points=e,n.setGeometry(t,i)}},mxGraphLayout.prototype.setVertexLocation=function(t,e,n){var i=this.graph.getModel(),o=i.getGeometry(t),r=null;if(null!=o){if(r=new mxRectangle(e,n,o.width,o.height),this.useBoundingBox){var s=this.graph.getView().getState(t);if(null!=s&&null!=s.text&&null!=s.text.boundingBox){var l=this.graph.getView().scale,a=s.text.boundingBox;s.text.boundingBox.x<s.x&&(e+=(s.x-a.x)/l,r.width=a.width),s.text.boundingBox.y<s.y&&(n+=(s.y-a.y)/l,r.height=a.height)}}null!=this.parent&&(s=i.getParent(t),null!=s&&s!=this.parent&&(s=this.getParentOffset(s),e-=s.x,n-=s.y)),(o.x!=e||o.y!=n)&&(o=o.clone(),o.x=e,o.y=n,i.setGeometry(t,o))}return r},mxGraphLayout.prototype.getVertexBounds=function(t){var e=this.graph.getModel().getGeometry(t);if(this.useBoundingBox){var n=this.graph.getView().getState(t);if(null!=n&&null!=n.text&&null!=n.text.boundingBox)var i=this.graph.getView().scale,o=n.text.boundingBox,r=Math.max(n.x-o.x,0)/i,s=Math.max(n.y-o.y,0)/i,l=Math.max(o.x+o.width-(n.x+n.width),0)/i,n=Math.max(o.y+o.height-(n.y+n.height),0)/i,e=new mxRectangle(e.x-r,e.y-s,e.width+r+l,e.height+s+n)}return null!=this.parent&&(t=this.graph.getModel().getParent(t),e=e.clone(),null!=t&&t!=this.parent&&(t=this.getParentOffset(t),e.x+=t.x,e.y+=t.y)),new mxRectangle(e.x,e.y,e.width,e.height)},mxGraphLayout.prototype.arrangeGroups=function(t,e){this.graph.getModel().beginUpdate();try{for(var n=t.length-1;n>=0;n--){var i=t[n],o=this.graph.getChildVertices(i),r=this.graph.getBoundingBoxFromGeometry(o),s=this.graph.getCellGeometry(i),l=0,a=0;if(this.graph.isSwimlane(i))var h=this.graph.getStartSize(i),l=h.width,a=h.height;null!=r&&null!=s&&(s=s.clone(),s.x=s.x+r.x-e-l,s.y=s.y+r.y-e-a,s.width=r.width+2*e+l,s.height=r.height+2*e+a,this.graph.getModel().setGeometry(i,s),this.graph.moveCells(o,e+l-r.x,e+a-r.y))}}finally{this.graph.getModel().endUpdate()}},mxStackLayout.prototype=new mxGraphLayout,mxStackLayout.prototype.constructor=mxStackLayout,mxStackLayout.prototype.horizontal=null,mxStackLayout.prototype.spacing=null,mxStackLayout.prototype.x0=null,mxStackLayout.prototype.y0=null,mxStackLayout.prototype.border=0,mxStackLayout.prototype.keepFirstLocation=!1,mxStackLayout.prototype.fill=!1,mxStackLayout.prototype.resizeParent=!1,mxStackLayout.prototype.resizeLast=!1,mxStackLayout.prototype.wrap=null,mxStackLayout.prototype.isHorizontal=function(){return this.horizontal},mxStackLayout.prototype.moveCell=function(t,e,n){var i=this.graph.getModel(),o=i.getParent(t),r=this.isHorizontal();if(null!=t&&null!=o){var s=0,l=0,a=i.getChildCount(o);for(e=r?e:n,s=this.graph.getView().getState(o),null!=s&&(e-=r?s.x:s.y),s=0;a>s;s++)if(n=i.getChildAt(o,s),n!=t&&(n=i.getGeometry(n),null!=n)){if(n=r?n.x+n.width/2:n.y+n.height/2,e>l&&n>e)break;l=n}r=o.getIndex(t),r=Math.max(0,s-(s>r?1:0)),i.add(o,t,r)}},mxStackLayout.prototype.getParentSize=function(t){var e=this.graph.getModel(),n=e.getGeometry(t);return null!=this.graph.container&&(null==n&&e.isLayer(t)||t==this.graph.getView().currentRoot)&&(n=new mxRectangle(0,0,this.graph.container.offsetWidth-1,this.graph.container.offsetHeight-1)),n},mxStackLayout.prototype.execute=function(t){if(null!=t){var e=this.isHorizontal(),n=this.graph.getModel(),i=this.getParentSize(t),o=null;null!=i&&(o=e?i.height:i.width);var o=o-(2*this.spacing+2*this.border),r=this.x0+this.border,s=this.y0+this.border;if(this.graph.isSwimlane(t)){var l=this.graph.getCellStyle(t),a=mxUtils.getNumber(l,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_STARTSIZE),l=1==mxUtils.getValue(l,mxConstants.STYLE_HORIZONTAL,!0);null!=i&&(a=l?Math.min(a,i.height):Math.min(a,i.width)),e==l&&(o-=a),l?s+=a:r+=a}n.beginUpdate();try{for(var a=0,l=null,h=n.getChildCount(t),d=0;h>d;d++){var u=n.getChildAt(t,d);if(!this.isVertexIgnored(u)&&this.isVertexMovable(u)){var c=n.getGeometry(u);null!=c&&(c=c.clone(),null!=this.wrap&&null!=l&&(e&&l.x+l.width+c.width+2*this.spacing>this.wrap||!e&&l.y+l.height+c.height+2*this.spacing>this.wrap)&&(l=null,e?s+=a+this.spacing:r+=a+this.spacing,a=0),a=Math.max(a,e?c.height:c.width),null!=l?e?c.x=l.x+l.width+this.spacing:c.y=l.y+l.height+this.spacing:this.keepFirstLocation||(e?c.x=r:c.y=s),e?c.y=s:c.x=r,this.fill&&null!=o&&(e?c.height=o:c.width=o),n.setGeometry(u,c),l=c)}}this.resizeParent&&null!=i&&null!=l&&!this.graph.isCellCollapsed(t)?(i=i.clone(),e?i.width=l.x+l.width+this.spacing:i.height=l.y+l.height+this.spacing,n.setGeometry(t,i)):this.resizeLast&&null!=i&&null!=l&&(e?l.width=i.width-l.x-this.spacing:l.height=i.height-l.y-this.spacing)}finally{n.endUpdate()}}},mxPartitionLayout.prototype=new mxGraphLayout,mxPartitionLayout.prototype.constructor=mxPartitionLayout,mxPartitionLayout.prototype.horizontal=null,mxPartitionLayout.prototype.spacing=null,mxPartitionLayout.prototype.border=null,mxPartitionLayout.prototype.resizeVertices=!0,mxPartitionLayout.prototype.isHorizontal=function(){return this.horizontal},mxPartitionLayout.prototype.moveCell=function(t,e,n){n=this.graph.getModel();var i=n.getParent(t);if(null!=t&&null!=i){for(var o=0,r=0,s=n.getChildCount(i),o=0;s>o;o++){var l=n.getChildAt(i,o),l=this.getVertexBounds(l);if(null!=l){if(l=l.x+l.width/2,e>r&&l>e)break;r=l}}e=i.getIndex(t),e=Math.max(0,o-(o>e?1:0)),n.add(i,t,e)}},mxPartitionLayout.prototype.execute=function(t){var e=this.isHorizontal(),n=this.graph.getModel(),i=n.getGeometry(t);if(null!=this.graph.container&&(null==i&&n.isLayer(t)||t==this.graph.getView().currentRoot)&&(i=new mxRectangle(0,0,this.graph.container.offsetWidth-1,this.graph.container.offsetHeight-1)),null!=i){for(var o=[],r=n.getChildCount(t),s=0;r>s;s++){var l=n.getChildAt(t,s);!this.isVertexIgnored(l)&&this.isVertexMovable(l)&&o.push(l)}if(r=o.length,r>0){var a=this.border,h=this.border,d=e?i.height:i.width,d=d-2*this.border;if(t=this.graph.isSwimlane(t)?this.graph.getStartSize(t):new mxRectangle,d-=e?t.height:t.width,a+=t.width,h+=t.height,t=this.border+(r-1)*this.spacing,i=e?(i.width-a-t)/r:(i.height-h-t)/r,i>0){n.beginUpdate();try{for(s=0;r>s;s++){var l=o[s],u=n.getGeometry(l);null!=u&&(u=u.clone(),u.x=a,u.y=h,e?(this.resizeVertices&&(u.width=i,u.height=d),a+=i+this.spacing):(this.resizeVertices&&(u.height=i,u.width=d),h+=i+this.spacing),n.setGeometry(l,u))}}finally{n.endUpdate()}}}}},mxCompactTreeLayout.prototype=new mxGraphLayout,mxCompactTreeLayout.prototype.constructor=mxCompactTreeLayout,mxCompactTreeLayout.prototype.horizontal=null,mxCompactTreeLayout.prototype.invert=null,mxCompactTreeLayout.prototype.resizeParent=!0,mxCompactTreeLayout.prototype.groupPadding=10,mxCompactTreeLayout.prototype.parentsChanged=null,mxCompactTreeLayout.prototype.moveTree=!1,mxCompactTreeLayout.prototype.levelDistance=10,mxCompactTreeLayout.prototype.nodeDistance=20,mxCompactTreeLayout.prototype.resetEdges=!0,mxCompactTreeLayout.prototype.prefHozEdgeSep=5,mxCompactTreeLayout.prototype.prefVertEdgeOff=4,mxCompactTreeLayout.prototype.minEdgeJetty=8,mxCompactTreeLayout.prototype.channelBuffer=4,mxCompactTreeLayout.prototype.edgeRouting=!0,mxCompactTreeLayout.prototype.sortEdges=!1,mxCompactTreeLayout.prototype.isVertexIgnored=function(t){return mxGraphLayout.prototype.isVertexIgnored.apply(this,arguments)||0==this.graph.getConnections(t).length},mxCompactTreeLayout.prototype.isHorizontal=function(){return this.horizontal},mxCompactTreeLayout.prototype.execute=function(t,e){this.parent=t;var n=this.graph.getModel();if(null==e)if(0<this.graph.getEdges(t,n.getParent(t),this.invert,!this.invert,!1).length)e=t;else{var i=this.graph.findTreeRoots(t,!0,this.invert);if(0<i.length)for(var o=0;o<i.length;o++)if(!this.isVertexIgnored(i[o])&&0<this.graph.getEdges(i[o],null,this.invert,!this.invert,!1).length){e=i[o];break}}if(null!=e){this.parentsChanged=this.resizeParent?{}:null,n.beginUpdate();try{var r=this.dfs(e,t);if(null!=r){this.layout(r);var s=this.graph.gridSize,i=s;if(!this.moveTree){var l=this.getVertexBounds(e);null!=l&&(s=l.x,i=l.y)}if(l=null,l=this.isHorizontal()?this.horizontalLayout(r,s,i):this.verticalLayout(r,null,s,i),null!=l){var a=o=0;0>l.x&&(o=Math.abs(s-l.x)),0>l.y&&(a=Math.abs(i-l.y)),(0!=o||0!=a)&&this.moveNode(r,o,a),this.resizeParent&&this.adjustParents(),this.edgeRouting&&this.localEdgeProcessing(r)}}}finally{n.endUpdate()}}},mxCompactTreeLayout.prototype.moveNode=function(t,e,n){for(t.x+=e,t.y+=n,this.apply(t),t=t.child;null!=t;)this.moveNode(t,e,n),t=t.next},mxCompactTreeLayout.prototype.sortOutgoingEdges=function(t,e){var n=new mxDictionary;e.sort(function(e,i){var o=e.getTerminal(e.getTerminal(!1)==t),r=n.get(o);null==r&&(r=mxCellPath.create(o).split(mxCellPath.PATH_SEPARATOR),n.put(o,r));var o=i.getTerminal(i.getTerminal(!1)==t),s=n.get(o);return null==s&&(s=mxCellPath.create(o).split(mxCellPath.PATH_SEPARATOR),n.put(o,s)),mxCellPath.compare(r,s)})},mxCompactTreeLayout.prototype.dfs=function(t,e,n){n=null!=n?n:[];var i=mxCellPath.create(t),o=null;if(null!=t&&null==n[i]&&!this.isVertexIgnored(t)){n[i]=t;var o=this.createNode(t),i=this.graph.getModel(),r=null,s=this.graph.getEdges(t,e,this.invert,!this.invert,!1,!0),l=this.graph.getView();for(this.sortEdges&&this.sortOutgoingEdges(t,s),t=0;t<s.length;t++){var a=s[t];if(!this.isEdgeIgnored(a)){this.resetEdges&&this.setEdgePoints(a,null),this.edgeRouting&&(this.setEdgeStyleEnabled(a,!1),this.setEdgePoints(a,null));var h=l.getState(a),a=null!=h?h.getVisibleTerminal(this.invert):l.getVisibleTerminal(a,this.invert),h=this.dfs(a,e,n);null!=h&&null!=i.getGeometry(a)&&(null==r?o.child=h:r.next=h,r=h)}}}return o},mxCompactTreeLayout.prototype.layout=function(t){if(null!=t){for(var e=t.child;null!=e;)this.layout(e),e=e.next;null!=t.child?this.attachParent(t,this.join(t)):this.layoutLeaf(t)}},mxCompactTreeLayout.prototype.horizontalLayout=function(t,e,n,i){if(t.x+=e+t.offsetX,t.y+=n+t.offsetY,i=this.apply(t,i),e=t.child,null!=e){i=this.horizontalLayout(e,t.x,t.y,i),n=t.y+e.offsetY;for(var o=e.next;null!=o;)i=this.horizontalLayout(o,t.x+e.offsetX,n,i),n+=o.offsetY,o=o.next}return i},mxCompactTreeLayout.prototype.verticalLayout=function(t,e,n,i,o){if(t.x+=n+t.offsetY,t.y+=i+t.offsetX,o=this.apply(t,o),e=t.child,null!=e)for(o=this.verticalLayout(e,t,t.x,t.y,o),n=t.x+e.offsetY,i=e.next;null!=i;)o=this.verticalLayout(i,t,n,t.y+e.offsetX,o),n+=i.offsetY,i=i.next;return o},mxCompactTreeLayout.prototype.attachParent=function(t,e){var n=this.nodeDistance+this.levelDistance,i=(e-t.width)/2-this.nodeDistance,o=i+t.width+2*this.nodeDistance-e;t.child.offsetX=n+t.height,t.child.offsetY=o,t.contour.upperHead=this.createLine(t.height,0,this.createLine(n,o,t.contour.upperHead)),t.contour.lowerHead=this.createLine(t.height,0,this.createLine(n,i,t.contour.lowerHead))},mxCompactTreeLayout.prototype.layoutLeaf=function(t){var e=2*this.nodeDistance;t.contour.upperTail=this.createLine(t.height+e,0),t.contour.upperHead=t.contour.upperTail,t.contour.lowerTail=this.createLine(0,-t.width-e),t.contour.lowerHead=this.createLine(t.height+e,0,t.contour.lowerTail)},mxCompactTreeLayout.prototype.join=function(t){var e=2*this.nodeDistance,n=t.child;t.contour=n.contour;for(var i=n.width+e,o=i,n=n.next;null!=n;){var r=this.merge(t.contour,n.contour);n.offsetY=r+i,n.offsetX=0,i=n.width+e,o+=r+i,n=n.next}return o},mxCompactTreeLayout.prototype.merge=function(t,e){for(var n=0,i=0,o=0,r=t.lowerHead,s=e.upperHead;null!=s&&null!=r;){var l=this.offset(n,i,s.dx,s.dy,r.dx,r.dy),i=i+l,o=o+l;n+s.dx<=r.dx?(n+=s.dx,i+=s.dy,s=s.next):(n-=r.dx,i-=r.dy,r=r.next)}return null!=s?(n=this.bridge(t.upperTail,0,0,s,n,i),t.upperTail=null!=n.next?e.upperTail:n,t.lowerTail=e.lowerTail):(n=this.bridge(e.lowerTail,n,i,r,0,0),null==n.next&&(t.lowerTail=n)),t.lowerHead=e.lowerHead,o},mxCompactTreeLayout.prototype.offset=function(t,e,n,i,o,r){var s=0;return t>=o||0>=t+n?0:(s=o*i-n*r>0?0>t?t*i/n-e:t>0?t*r/o-e:-e:t+n>o?r-(e+(o-t)*i/n):o>t+n?(n+t)*r/o-(e+i):r-(e+i),s>0?s:0)},mxCompactTreeLayout.prototype.bridge=function(t,e,n,i,o,r){return e=o+i.dx-e,o=o=0,0==i.dx?o=i.dy:(o=e*i.dy,o/=i.dx),e=this.createLine(e,o,i.next),t.next=this.createLine(0,r+i.dy-o-n,e),e},mxCompactTreeLayout.prototype.createNode=function(t){var e={};return e.cell=t,e.x=0,e.y=0,e.width=0,e.height=0,t=this.getVertexBounds(t),null!=t&&(this.isHorizontal()?(e.width=t.height,e.height=t.width):(e.width=t.width,e.height=t.height)),e.offsetX=0,e.offsetY=0,e.contour={},e},mxCompactTreeLayout.prototype.apply=function(t,e){var n=this.graph.getModel(),i=t.cell,o=n.getGeometry(i);return null!=i&&null!=o&&(this.isVertexMovable(i)&&(o=this.setVertexLocation(i,t.x,t.y),this.resizeParent&&(n=n.getParent(i),i=mxCellPath.create(n),null==this.parentsChanged[i]&&(this.parentsChanged[i]=n))),e=null==e?new mxRectangle(o.x,o.y,o.width,o.height):new mxRectangle(Math.min(e.x,o.x),Math.min(e.y,o.y),Math.max(e.x+e.width,o.x+o.width),Math.max(e.y+e.height,o.y+o.height))),e},mxCompactTreeLayout.prototype.createLine=function(t,e,n){var i={};return i.dx=t,i.dy=e,i.next=n,i},mxCompactTreeLayout.prototype.adjustParents=function(){var t,e=[];for(t in this.parentsChanged)e.push(this.parentsChanged[t]);this.arrangeGroups(mxUtils.sortCells(e,!0),this.groupPadding)},mxCompactTreeLayout.prototype.localEdgeProcessing=function(t){for(this.processNodeOutgoing(t),t=t.child;null!=t;)this.localEdgeProcessing(t),t=t.next},mxCompactTreeLayout.prototype.processNodeOutgoing=function(t){for(var e=t.child,n=t.cell,i=0,o=[];null!=e;){i++;var r=e.x;this.horizontal&&(r=e.y),o.push(new WeightedCellSorter(e,r)),e=e.next}o.sort(WeightedCellSorter.prototype.compare);var r=t.width,s=(i+1)*this.prefHozEdgeSep;r>s+2*this.prefHozEdgeSep&&(r-=2*this.prefHozEdgeSep),t=r/i,e=t/2,r>s+2*this.prefHozEdgeSep&&(e+=this.prefHozEdgeSep);for(var r=this.minEdgeJetty-this.prefVertEdgeOff,s=0,l=this.getVertexBounds(n),a=0;a<o.length;a++){for(var h=o[a].cell.cell,d=this.getVertexBounds(h),h=this.graph.getEdgesBetween(n,h,!1),u=[],c=0,p=0,m=0;m<h.length;m++)this.horizontal?(c=l.x+l.width,p=l.y+e,u.push(new mxPoint(c,p)),c=l.x+l.width+r,u.push(new mxPoint(c,p)),p=d.y+d.height/2):(c=l.x+e,p=l.y+l.height,u.push(new mxPoint(c,p)),p=l.y+l.height+r,u.push(new mxPoint(c,p)),c=d.x+d.width/2),u.push(new mxPoint(c,p)),this.setEdgePoints(h[m],u);i/2>a?r+=this.prefVertEdgeOff:a>i/2&&(r-=this.prefVertEdgeOff),e+=t,s=Math.max(s,r)}},WeightedCellSorter.prototype.weightedValue=0,WeightedCellSorter.prototype.nudge=!1,WeightedCellSorter.prototype.visited=!1,WeightedCellSorter.prototype.rankIndex=null,WeightedCellSorter.prototype.cell=null,WeightedCellSorter.prototype.compare=function(t,e){return null!=t&&null!=e?e.weightedValue>t.weightedValue?1:e.weightedValue<t.weightedValue?-1:e.nudge?1:-1:0},mxFastOrganicLayout.prototype=new mxGraphLayout,mxFastOrganicLayout.prototype.constructor=mxFastOrganicLayout,mxFastOrganicLayout.prototype.useInputOrigin=!0,mxFastOrganicLayout.prototype.resetEdges=!0,mxFastOrganicLayout.prototype.disableEdgeStyle=!0,mxFastOrganicLayout.prototype.forceConstant=50,mxFastOrganicLayout.prototype.forceConstantSquared=0,mxFastOrganicLayout.prototype.minDistanceLimit=2,mxFastOrganicLayout.prototype.maxDistanceLimit=500,mxFastOrganicLayout.prototype.minDistanceLimitSquared=4,mxFastOrganicLayout.prototype.initialTemp=200,mxFastOrganicLayout.prototype.temperature=0,mxFastOrganicLayout.prototype.maxIterations=0,mxFastOrganicLayout.prototype.iteration=0,mxFastOrganicLayout.prototype.allowedToRun=!0,mxFastOrganicLayout.prototype.isVertexIgnored=function(t){return mxGraphLayout.prototype.isVertexIgnored.apply(this,arguments)||0==this.graph.getConnections(t).length},mxFastOrganicLayout.prototype.execute=function(t){var e=this.graph.getModel();this.vertexArray=[];for(var n=this.graph.getChildVertices(t),i=0;i<n.length;i++)this.isVertexIgnored(n[i])||this.vertexArray.push(n[i]);var o=this.useInputOrigin?this.graph.getBoundingBoxFromGeometry(this.vertexArray):null,r=this.vertexArray.length;for(this.indices=[],this.dispX=[],this.dispY=[],this.cellLocation=[],this.isMoveable=[],this.neighbours=[],this.radius=[],this.radiusSquared=[],.001>this.forceConstant&&(this.forceConstant=.001),this.forceConstantSquared=this.forceConstant*this.forceConstant,i=0;i<this.vertexArray.length;i++){var s=this.vertexArray[i];this.cellLocation[i]=[];var l=mxCellPath.create(s);this.indices[l]=i;var a=this.getVertexBounds(s),h=a.width,d=a.height,u=a.x,c=a.y;this.cellLocation[i][0]=u+h/2,this.cellLocation[i][1]=c+d/2,this.radius[i]=Math.min(h,d),this.radiusSquared[i]=this.radius[i]*this.radius[i]}e.beginUpdate();try{for(i=0;r>i;i++){this.dispX[i]=0,this.dispY[i]=0,this.isMoveable[i]=this.isVertexMovable(this.vertexArray[i]);var p=this.graph.getConnections(this.vertexArray[i],t),n=this.graph.getOpposites(p,this.vertexArray[i]);for(this.neighbours[i]=[],h=0;h<n.length;h++){this.resetEdges&&this.graph.resetEdge(p[h]),this.disableEdgeStyle&&this.setEdgeStyleEnabled(p[h],!1);var l=mxCellPath.create(n[h]),m=this.indices[l];this.neighbours[i][h]=null!=m?m:i}}for(this.temperature=this.initialTemp,0==this.maxIterations&&(this.maxIterations=20*Math.sqrt(r)),this.iteration=0;this.iteration<this.maxIterations;this.iteration++){if(!this.allowedToRun)return;this.calcRepulsion(),this.calcAttraction(),this.calcPositions(),this.reduceTemperature()}for(t=n=null,i=0;i<this.vertexArray.length;i++)s=this.vertexArray[i],this.isVertexMovable(s)&&(a=this.getVertexBounds(s),null!=a&&(this.cellLocation[i][0]-=a.width/2,this.cellLocation[i][1]-=a.height/2,u=this.graph.snap(this.cellLocation[i][0]),c=this.graph.snap(this.cellLocation[i][1]),this.setVertexLocation(s,u,c),n=null==n?u:Math.min(n,u),t=null==t?c:Math.min(t,c)));i=-(n||0)+1,s=-(t||0)+1,null!=o&&(i+=o.x,s+=o.y),this.graph.moveCells(this.vertexArray,i,s)}finally{e.endUpdate()}},mxFastOrganicLayout.prototype.calcPositions=function(){for(var t=0;t<this.vertexArray.length;t++)if(this.isMoveable[t]){var e=Math.sqrt(this.dispX[t]*this.dispX[t]+this.dispY[t]*this.dispY[t]);.001>e&&(e=.001);var n=this.dispX[t]/e*Math.min(e,this.temperature),e=this.dispY[t]/e*Math.min(e,this.temperature);this.dispX[t]=0,this.dispY[t]=0,this.cellLocation[t][0]+=n,this.cellLocation[t][1]+=e}},mxFastOrganicLayout.prototype.calcAttraction=function(){for(var t=0;t<this.vertexArray.length;t++)for(var e=0;e<this.neighbours[t].length;e++){var n=this.neighbours[t][e];if(t!=n&&this.isMoveable[t]&&this.isMoveable[n]){var i=this.cellLocation[t][0]-this.cellLocation[n][0],o=this.cellLocation[t][1]-this.cellLocation[n][1],r=i*i+o*o-this.radiusSquared[t]-this.radiusSquared[n];r<this.minDistanceLimitSquared&&(r=this.minDistanceLimitSquared);var s=Math.sqrt(r),r=r/this.forceConstant,i=i/s*r,o=o/s*r;this.dispX[t]-=i,this.dispY[t]-=o,this.dispX[n]+=i,this.dispY[n]+=o}}},mxFastOrganicLayout.prototype.calcRepulsion=function(){for(var t=this.vertexArray.length,e=0;t>e;e++)for(var n=e;t>n;n++){if(!this.allowedToRun)return;if(n!=e&&this.isMoveable[e]&&this.isMoveable[n]){var i=this.cellLocation[e][0]-this.cellLocation[n][0],o=this.cellLocation[e][1]-this.cellLocation[n][1];0==i&&(i=.01+Math.random()),0==o&&(o=.01+Math.random());var r=Math.sqrt(i*i+o*o),s=r-this.radius[e]-this.radius[n];s>this.maxDistanceLimit||(s<this.minDistanceLimit&&(s=this.minDistanceLimit),s=this.forceConstantSquared/s,i=i/r*s,o=o/r*s,this.dispX[e]+=i,this.dispY[e]+=o,this.dispX[n]-=i,this.dispY[n]-=o)}}},mxFastOrganicLayout.prototype.reduceTemperature=function(){this.temperature=this.initialTemp*(1-this.iteration/this.maxIterations)},mxCircleLayout.prototype=new mxGraphLayout,mxCircleLayout.prototype.constructor=mxCircleLayout,mxCircleLayout.prototype.radius=null,mxCircleLayout.prototype.moveCircle=!1,mxCircleLayout.prototype.x0=0,mxCircleLayout.prototype.y0=0,mxCircleLayout.prototype.resetEdges=!0,mxCircleLayout.prototype.disableEdgeStyle=!0,mxCircleLayout.prototype.execute=function(t){var e=this.graph.getModel();e.beginUpdate();try{for(var n=0,i=null,o=null,r=[],s=e.getChildCount(t),l=0;s>l;l++){var a=e.getChildAt(t,l);if(this.isVertexIgnored(a))this.isEdgeIgnored(a)||(this.resetEdges&&this.graph.resetEdge(a),this.disableEdgeStyle&&this.setEdgeStyleEnabled(a,!1));else{r.push(a);var h=this.getVertexBounds(a),i=null==i?h.y:Math.min(i,h.y),o=null==o?h.x:Math.min(o,h.x),n=Math.max(n,Math.max(h.width,h.height))}}var d=this.getRadius(r.length,n);this.moveCircle&&(o=this.x0,i=this.y0),this.circle(r,d,o,i)}finally{e.endUpdate()}},mxCircleLayout.prototype.getRadius=function(t,e){return Math.max(t*e/Math.PI,this.radius)},mxCircleLayout.prototype.circle=function(t,e,n,i){for(var o=t.length,r=2*Math.PI/o,s=0;o>s;s++)this.isVertexMovable(t[s])&&this.setVertexLocation(t[s],n+e+e*Math.sin(s*r),i+e+e*Math.cos(s*r))},mxParallelEdgeLayout.prototype=new mxGraphLayout,mxParallelEdgeLayout.prototype.constructor=mxParallelEdgeLayout,mxParallelEdgeLayout.prototype.spacing=20,mxParallelEdgeLayout.prototype.execute=function(t){t=this.findParallels(t),this.graph.model.beginUpdate();try{for(var e in t){var n=t[e];1<n.length&&this.layout(n)}}finally{this.graph.model.endUpdate()}},mxParallelEdgeLayout.prototype.findParallels=function(t){for(var e=this.graph.getModel(),n=[],i=e.getChildCount(t),o=0;i>o;o++){var r=e.getChildAt(t,o);if(!this.isEdgeIgnored(r)){var s=this.getEdgeId(r);null!=s&&(null==n[s]&&(n[s]=[]),n[s].push(r))}}return n},mxParallelEdgeLayout.prototype.getEdgeId=function(t){var e=this.graph.getView(),n=e.getState(t),i=null!=n?n.getVisibleTerminal(!0):e.getVisibleTerminal(t,!0);return t=null!=n?n.getVisibleTerminal(!1):e.getVisibleTerminal(t,!1),null!=i&&null!=t?(i=mxCellPath.create(i),t=mxCellPath.create(t),i>t?t+"-"+i:i+"-"+t):null},mxParallelEdgeLayout.prototype.layout=function(t){var e=t[0],n=this.graph.getModel(),i=n.getGeometry(n.getTerminal(e,!0)),o=n.getGeometry(n.getTerminal(e,!1));if(i==o)for(var e=i.x+i.width+this.spacing,n=i.y+i.height/2,r=0;r<t.length;r++)this.route(t[r],e,n),e+=this.spacing;else if(null!=i&&null!=o)for(var e=i.x+i.width/2,n=i.y+i.height/2,r=o.x+o.width/2-e,s=o.y+o.height/2-n,o=Math.sqrt(r*r+s*s),i=s*this.spacing/o,o=r*this.spacing/o,e=e+r/2+i*(t.length-1)/2,n=n+s/2-o*(t.length-1)/2,r=0;r<t.length;r++)this.route(t[r],e,n),e-=i,n+=o},mxParallelEdgeLayout.prototype.route=function(t,e,n){this.graph.isCellMovable(t)&&this.setEdgePoints(t,[new mxPoint(e,n)])},mxCompositeLayout.prototype=new mxGraphLayout,mxCompositeLayout.prototype.constructor=mxCompositeLayout,mxCompositeLayout.prototype.layouts=null,mxCompositeLayout.prototype.master=null,mxCompositeLayout.prototype.moveCell=function(){null!=this.master?this.master.move.apply(this.master,arguments):this.layouts[0].move.apply(this.layouts[0],arguments)},mxCompositeLayout.prototype.execute=function(){var t=this.graph.getModel();t.beginUpdate();try{for(var e=0;e<this.layouts.length;e++)this.layouts[e].execute.apply(this.layouts[e],arguments)}finally{t.endUpdate()}},mxEdgeLabelLayout.prototype=new mxGraphLayout,mxEdgeLabelLayout.prototype.constructor=mxEdgeLabelLayout,mxEdgeLabelLayout.prototype.execute=function(t){for(var e=this.graph.view,n=this.graph.getModel(),i=[],o=[],r=n.getChildCount(t),s=0;r>s;s++){var l=n.getChildAt(t,s),a=e.getState(l);null!=a&&(this.isVertexIgnored(l)?this.isEdgeIgnored(l)||i.push(a):o.push(a))}this.placeLabels(o,i)},mxEdgeLabelLayout.prototype.placeLabels=function(t,e){var n=this.graph.getModel();n.beginUpdate();try{for(var i=0;i<e.length;i++){var o=e[i];if(null!=o&&null!=o.text&&null!=o.text.boundingBox)for(var r=0;r<t.length;r++){var s=t[r];null!=s&&this.avoid(o,s)}}}finally{n.endUpdate()}},mxEdgeLabelLayout.prototype.avoid=function(t,e){var n=this.graph.getModel(),i=t.text.boundingBox;if(mxUtils.intersects(i,e)){var o=-i.y-i.height+e.y,r=-i.y+e.y+e.height,o=Math.abs(o)<Math.abs(r)?o:r,r=-i.x-i.width+e.x,i=-i.x+e.x+e.width,i=Math.abs(r)<Math.abs(i)?r:i;Math.abs(i)<Math.abs(o)?o=0:i=0,r=n.getGeometry(t.cell),null!=r&&(r=r.clone(),null!=r.offset?(r.offset.x+=i,r.offset.y+=o):r.offset=new mxPoint(i,o),n.setGeometry(t.cell,r))}},mxGraphAbstractHierarchyCell.prototype.maxRank=-1,mxGraphAbstractHierarchyCell.prototype.minRank=-1,mxGraphAbstractHierarchyCell.prototype.x=null,mxGraphAbstractHierarchyCell.prototype.y=null,mxGraphAbstractHierarchyCell.prototype.width=0,mxGraphAbstractHierarchyCell.prototype.height=0,mxGraphAbstractHierarchyCell.prototype.nextLayerConnectedCells=null,mxGraphAbstractHierarchyCell.prototype.previousLayerConnectedCells=null,mxGraphAbstractHierarchyCell.prototype.temp=null,mxGraphAbstractHierarchyCell.prototype.getNextLayerConnectedCells=function(){return null},mxGraphAbstractHierarchyCell.prototype.getPreviousLayerConnectedCells=function(){return null},mxGraphAbstractHierarchyCell.prototype.isEdge=function(){return!1},mxGraphAbstractHierarchyCell.prototype.isVertex=function(){return!1},mxGraphAbstractHierarchyCell.prototype.getGeneralPurposeVariable=function(){return null},mxGraphAbstractHierarchyCell.prototype.setGeneralPurposeVariable=function(){return null},mxGraphAbstractHierarchyCell.prototype.setX=function(t,e){this.isVertex()?this.x[0]=e:this.isEdge()&&(this.x[t-this.minRank-1]=e)},mxGraphAbstractHierarchyCell.prototype.getX=function(t){return this.isVertex()?this.x[0]:this.isEdge()?this.x[t-this.minRank-1]:0},mxGraphAbstractHierarchyCell.prototype.setY=function(t,e){this.isVertex()?this.y[0]=e:this.isEdge()&&(this.y[t-this.minRank-1]=e)},mxGraphHierarchyNode.prototype=new mxGraphAbstractHierarchyCell,mxGraphHierarchyNode.prototype.constructor=mxGraphHierarchyNode,mxGraphHierarchyNode.prototype.cell=null,mxGraphHierarchyNode.prototype.connectsAsTarget=[],mxGraphHierarchyNode.prototype.connectsAsSource=[],mxGraphHierarchyNode.prototype.hashCode=!1,mxGraphHierarchyNode.prototype.getRankValue=function(){return this.maxRank},mxGraphHierarchyNode.prototype.getNextLayerConnectedCells=function(t){if(null==this.nextLayerConnectedCells){this.nextLayerConnectedCells=[],this.nextLayerConnectedCells[0]=[];for(var e=0;e<this.connectsAsTarget.length;e++){var n=this.connectsAsTarget[e];-1==n.maxRank||n.maxRank==t+1?this.nextLayerConnectedCells[0].push(n.source):this.nextLayerConnectedCells[0].push(n)}}return this.nextLayerConnectedCells[0]},mxGraphHierarchyNode.prototype.getPreviousLayerConnectedCells=function(t){if(null==this.previousLayerConnectedCells){this.previousLayerConnectedCells=[],this.previousLayerConnectedCells[0]=[];for(var e=0;e<this.connectsAsSource.length;e++){var n=this.connectsAsSource[e];-1==n.minRank||n.minRank==t-1?this.previousLayerConnectedCells[0].push(n.target):this.previousLayerConnectedCells[0].push(n)}}return this.previousLayerConnectedCells[0]},mxGraphHierarchyNode.prototype.isVertex=function(){return!0},mxGraphHierarchyNode.prototype.getGeneralPurposeVariable=function(){return this.temp[0]},mxGraphHierarchyNode.prototype.setGeneralPurposeVariable=function(t,e){this.temp[0]=e},mxGraphHierarchyNode.prototype.isAncestor=function(t){if(null!=t&&null!=this.hashCode&&null!=t.hashCode&&this.hashCode.length<t.hashCode.length){if(this.hashCode==t.hashCode)return!0;if(null==this.hashCode||null==this.hashCode)return!1;for(var e=0;e<this.hashCode.length;e++)if(this.hashCode[e]!=t.hashCode[e])return!1;return!0}return!1},mxGraphHierarchyNode.prototype.getCoreCell=function(){return this.cell},mxGraphHierarchyEdge.prototype=new mxGraphAbstractHierarchyCell,mxGraphHierarchyEdge.prototype.constructor=mxGraphHierarchyEdge,mxGraphHierarchyEdge.prototype.edges=null,mxGraphHierarchyEdge.prototype.source=null,mxGraphHierarchyEdge.prototype.target=null,mxGraphHierarchyEdge.prototype.isReversed=!1,mxGraphHierarchyEdge.prototype.invert=function(t){t=this.source,this.source=this.target,this.target=t,this.isReversed=!this.isReversed},mxGraphHierarchyEdge.prototype.getNextLayerConnectedCells=function(t){if(null==this.nextLayerConnectedCells){this.nextLayerConnectedCells=[];for(var e=0;e<this.temp.length;e++)this.nextLayerConnectedCells[e]=[],e==this.temp.length-1?this.nextLayerConnectedCells[e].push(this.source):this.nextLayerConnectedCells[e].push(this)}return this.nextLayerConnectedCells[t-this.minRank-1]},mxGraphHierarchyEdge.prototype.getPreviousLayerConnectedCells=function(t){if(null==this.previousLayerConnectedCells){this.previousLayerConnectedCells=[];for(var e=0;e<this.temp.length;e++)this.previousLayerConnectedCells[e]=[],0==e?this.previousLayerConnectedCells[e].push(this.target):this.previousLayerConnectedCells[e].push(this)}return this.previousLayerConnectedCells[t-this.minRank-1]},mxGraphHierarchyEdge.prototype.isEdge=function(){return!0},mxGraphHierarchyEdge.prototype.getGeneralPurposeVariable=function(t){return this.temp[t-this.minRank-1]
},mxGraphHierarchyEdge.prototype.setGeneralPurposeVariable=function(t,e){this.temp[t-this.minRank-1]=e},mxGraphHierarchyEdge.prototype.getCoreCell=function(){return null!=this.edges&&0<this.edges.length?this.edges[0]:null},mxGraphHierarchyModel.prototype.maxRank=null,mxGraphHierarchyModel.prototype.vertexMapper=null,mxGraphHierarchyModel.prototype.edgeMapper=null,mxGraphHierarchyModel.prototype.ranks=null,mxGraphHierarchyModel.prototype.roots=null,mxGraphHierarchyModel.prototype.parent=null,mxGraphHierarchyModel.prototype.dfsCount=0,mxGraphHierarchyModel.prototype.SOURCESCANSTARTRANK=1e8,mxGraphHierarchyModel.prototype.tightenToSource=!1,mxGraphHierarchyModel.prototype.createInternalCells=function(t,e,n){for(var i=t.getGraph(),o=0;o<e.length;o++){n[o]=new mxGraphHierarchyNode(e[o]);var r=mxCellPath.create(e[o]);this.vertexMapper[r]=n[o],r=t.getEdges(e[o]),n[o].connectsAsSource=[];for(var s=0;s<r.length;s++){var l=t.getVisibleTerminal(r[s],!1);if(l!=e[o]&&l!=e[o]&&t.graph.model.isVertex(l)&&!t.isVertexIgnored(l)){var a=t.getEdgesBetween(e[o],l,!1),h=t.getEdgesBetween(e[o],l,!0),l=mxCellPath.create(a[0]);if(null!=a&&0<a.length&&null==this.edgeMapper[l]&&2*h.length>=a.length){for(var h=new mxGraphHierarchyEdge(a),d=0;d<a.length;d++){var u=a[d],l=mxCellPath.create(u);this.edgeMapper[l]=h,i.resetEdge(u),t.disableEdgeStyle&&(t.setEdgeStyleEnabled(u,!1),t.setOrthogonalEdge(u,!0))}h.source=n[o],0>mxUtils.indexOf(n[o].connectsAsSource,h)&&n[o].connectsAsSource.push(h)}}}n[o].temp[0]=0}},mxGraphHierarchyModel.prototype.initialRank=function(){var t=[];if(null!=this.roots)for(var e=0;e<this.roots.length;e++){var n=mxCellPath.create(this.roots[e]),n=this.vertexMapper[n];null!=n&&t.push(n)}for(var i in this.vertexMapper)n=this.vertexMapper[i],n.temp[0]=-1;for(var o=t.slice();0<t.length;){var r,s,n=t[0];r=n.connectsAsTarget,s=n.connectsAsSource;for(var l=!0,a=this.SOURCESCANSTARTRANK,e=0;e<r.length;e++){var h=r[e];if(5270620!=h.temp[0]){l=!1;break}h=h.source,a=Math.min(a,h.temp[0]-1)}if(l){if(n.temp[0]=a,this.maxRank=Math.min(this.maxRank,a),null!=s)for(e=0;e<s.length;e++)h=s[e],h.temp[0]=5270620,h=h.target,-1==h.temp[0]&&(t.push(h),h.temp[0]=-2);t.shift()}else if(e=t.shift(),t.push(n),e==n&&1==t.length)break}for(i in this.vertexMapper)n=this.vertexMapper[i],n.temp[0]-=this.maxRank;for(e=0;e<o.length;e++)for(n=o[e],t=0,r=n.connectsAsSource,i=0;i<r.length;i++)h=r[i],h=h.target,n.temp[0]=Math.max(t,h.temp[0]+1),t=n.temp[0];this.maxRank=this.SOURCESCANSTARTRANK-this.maxRank},mxGraphHierarchyModel.prototype.fixRanks=function(){var t=[];this.ranks=[];for(var e=0;e<this.maxRank+1;e++)t[e]=[],this.ranks[e]=t[e];var n=null;if(null!=this.roots)for(var i=this.roots,n=[],e=0;e<i.length;e++){var o=mxCellPath.create(i[e]);n[e]=this.vertexMapper[o]}this.visit(function(e,n,i,o,r){if(0==r&&0>n.maxRank&&0>n.minRank&&(t[n.temp[0]].push(n),n.maxRank=n.temp[0],n.minRank=n.temp[0],n.temp[0]=t[n.maxRank].length-1),null!=e&&null!=i&&1<e.maxRank-n.maxRank)for(i.maxRank=e.maxRank,i.minRank=n.maxRank,i.temp=[],i.x=[],i.y=[],e=i.minRank+1;e<i.maxRank;e++)t[e].push(i),i.setGeneralPurposeVariable(e,t[e].length-1)},n,!1,null)},mxGraphHierarchyModel.prototype.visit=function(t,e,n,i){if(null!=e){for(var o=0;o<e.length;o++){var r=e[o];null!=r&&(null==i&&(i={}),n?(r.hashCode=[],r.hashCode[0]=this.dfsCount,r.hashCode[1]=o,this.extendedDfs(null,r,null,t,i,r.hashCode,o,0)):this.dfs(null,r,null,t,i,0))}this.dfsCount++}},mxGraphHierarchyModel.prototype.dfs=function(t,e,n,i,o,r){if(null!=e){var s=mxCellPath.create(e.cell);if(null==o[s])for(o[s]=e,i(t,e,n,r,0),t=e.connectsAsSource.slice(),n=0;n<t.length;n++)s=t[n],this.dfs(e,s.target,s,i,o,r+1);else i(t,e,n,r,1)}},mxGraphHierarchyModel.prototype.extendedDfs=function(t,e,n,i,o,r,s,l){if(null!=e)if(null==t||null!=e.hashCode&&e.hashCode[0]==t.hashCode[0]||(r=t.hashCode.length+1,e.hashCode=t.hashCode.slice(),e.hashCode[r-1]=s),s=mxCellPath.create(e.cell),null==o[s])for(o[s]=e,i(t,e,n,l,0),t=e.connectsAsSource.slice(),n=0;n<t.length;n++)s=t[n],this.extendedDfs(e,s.target,s,i,o,e.hashCode,n,l+1);else i(t,e,n,l,1)},mxHierarchicalLayoutStage.prototype.execute=function(){},mxMedianHybridCrossingReduction.prototype=new mxHierarchicalLayoutStage,mxMedianHybridCrossingReduction.prototype.constructor=mxMedianHybridCrossingReduction,mxMedianHybridCrossingReduction.prototype.layout=null,mxMedianHybridCrossingReduction.prototype.maxIterations=24,mxMedianHybridCrossingReduction.prototype.nestedBestRanks=null,mxMedianHybridCrossingReduction.prototype.currentBestCrossings=0,mxMedianHybridCrossingReduction.prototype.iterationsWithoutImprovement=0,mxMedianHybridCrossingReduction.prototype.maxNoImprovementIterations=2,mxMedianHybridCrossingReduction.prototype.execute=function(t){t=this.layout.getModel(),this.nestedBestRanks=[];for(var e=0;e<t.ranks.length;e++)this.nestedBestRanks[e]=t.ranks[e].slice();for(var n=0,i=this.calculateCrossings(t),e=0;e<this.maxIterations&&n<this.maxNoImprovementIterations;e++){this.weightedMedian(e,t),this.transpose(e,t);var o=this.calculateCrossings(t);if(i>o)for(i=o,o=n=0;o<this.nestedBestRanks.length;o++)for(var r=t.ranks[o],s=0;s<r.length;s++){var l=r[s];this.nestedBestRanks[o][l.getGeneralPurposeVariable(o)]=l}else for(n++,o=0;o<this.nestedBestRanks.length;o++)for(r=t.ranks[o],s=0;s<r.length;s++)l=r[s],l.setGeneralPurposeVariable(o,s);if(0==i)break}for(n=[],i=[],e=0;e<t.maxRank+1;e++)i[e]=[],n[e]=i[e];for(e=0;e<this.nestedBestRanks.length;e++)for(o=0;o<this.nestedBestRanks[e].length;o++)i[e].push(this.nestedBestRanks[e][o]);t.ranks=n},mxMedianHybridCrossingReduction.prototype.calculateCrossings=function(t){for(var e=t.ranks.length,n=0,i=1;e>i;i++)n+=this.calculateRankCrossing(i,t);return n},mxMedianHybridCrossingReduction.prototype.calculateRankCrossing=function(t,e){for(var n=0,i=e.ranks[t],o=i.length,r=e.ranks[t-1].length,s=[],l=0;o>l;l++)s[l]=[];for(l=0;l<i.length;l++)for(var a=i[l],h=a.getGeneralPurposeVariable(t),d=a.getPreviousLayerConnectedCells(t),a=0;a<d.length;a++){var u=d[a].getGeneralPurposeVariable(t-1);s[h][u]=201207}for(l=0;o>l;l++)for(a=0;r>a;a++)if(201207==s[l][a]){for(i=l+1;o>i;i++)for(h=0;a>h;h++)201207==s[i][h]&&n++;for(i=0;l>i;i++)for(h=a+1;r>h;h++)201207==s[i][h]&&n++}return n/2},mxMedianHybridCrossingReduction.prototype.transpose=function(t,e){for(var n=!0,i=0;n&&10>i++;)for(var o=1==t%2&&1==i%2,n=!1,r=0;r<e.ranks.length;r++){for(var s=e.ranks[r],l=[],a=0;a<s.length;a++){var h=s[a],d=h.getGeneralPurposeVariable(r);0>d&&(d=a),l[d]=h}for(var u=d=h=null,c=null,p=null,m=null,g=null,f=null,x=null,C=null,a=0;a<s.length-1;a++){if(0==a){for(var x=l[a],h=x.getNextLayerConnectedCells(r),d=x.getPreviousLayerConnectedCells(r),p=[],m=[],E=0;E<h.length;E++)p[E]=h[E].getGeneralPurposeVariable(r+1);for(E=0;E<d.length;E++)m[E]=d[E].getGeneralPurposeVariable(r-1)}else h=u,d=c,p=g,m=f,x=C;for(C=l[a+1],u=C.getNextLayerConnectedCells(r),c=C.getPreviousLayerConnectedCells(r),g=[],f=[],E=0;E<u.length;E++)g[E]=u[E].getGeneralPurposeVariable(r+1);for(E=0;E<c.length;E++)f[E]=c[E].getGeneralPurposeVariable(r-1);for(var y=0,v=0,E=0;E<p.length;E++)for(var T=0;T<g.length;T++)p[E]>g[T]&&y++,p[E]<g[T]&&v++;for(E=0;E<m.length;E++)for(T=0;T<f.length;T++)m[E]>f[T]&&y++,m[E]<f[T]&&v++;(y>v||v==y&&o)&&(u=x.getGeneralPurposeVariable(r),x.setGeneralPurposeVariable(r,C.getGeneralPurposeVariable(r)),C.setGeneralPurposeVariable(r,u),u=h,c=d,g=p,f=m,C=x,o||(n=!0))}}},mxMedianHybridCrossingReduction.prototype.weightedMedian=function(t,e){var n=0==t%2;if(n)for(var i=e.maxRank-1;i>=0;i--)this.medianRank(i,n);else for(i=1;i<e.maxRank;i++)this.medianRank(i,n)},mxMedianHybridCrossingReduction.prototype.medianRank=function(t,e){for(var n=this.nestedBestRanks[t].length,i=[],o=[],r=0;n>r;r++){var s=this.nestedBestRanks[t][r],l=new MedianCellSorter;l.cell=s;var a;a=e?s.getNextLayerConnectedCells(t):s.getPreviousLayerConnectedCells(t);var h;h=e?t+1:t-1,null!=a&&0!=a.length?(l.medianValue=this.medianValue(a,h),i.push(l)):o[s.getGeneralPurposeVariable(t)]=!0}for(i.sort(MedianCellSorter.prototype.compare),r=0;n>r;r++)null==o[r]&&(s=i.shift().cell,s.setGeneralPurposeVariable(t,r))},mxMedianHybridCrossingReduction.prototype.medianValue=function(t,e){for(var n=[],i=0,o=0;o<t.length;o++){var r=t[o];n[i++]=r.getGeneralPurposeVariable(e)}return n.sort(function(t,e){return t-e}),1==i%2?n[Math.floor(i/2)]:2==i?(n[0]+n[1])/2:(o=i/2,r=n[o-1]-n[0],i=n[i-1]-n[o],(n[o-1]*i+n[o]*r)/(r+i))},MedianCellSorter.prototype.medianValue=0,MedianCellSorter.prototype.cell=!1,MedianCellSorter.prototype.compare=function(t,e){return null!=t&&null!=e?e.medianValue>t.medianValue?-1:e.medianValue<t.medianValue?1:0:0},mxMinimumCycleRemover.prototype=new mxHierarchicalLayoutStage,mxMinimumCycleRemover.prototype.constructor=mxMinimumCycleRemover,mxMinimumCycleRemover.prototype.layout=null,mxMinimumCycleRemover.prototype.execute=function(t){var e=this.layout.getModel(),n={},i=mxUtils.clone(e.vertexMapper,null,!0),o=null;if(null!=e.roots){var r=e.roots,o=[];for(t=0;t<r.length;t++){var s=mxCellPath.create(r[t]);o[t]=e.vertexMapper[s]}}if(e.visit(function(t,e,o){e.isAncestor(t)&&(o.invert(),mxUtils.remove(o,t.connectsAsSource),t.connectsAsTarget.push(o),mxUtils.remove(o,e.connectsAsTarget),e.connectsAsSource.push(o)),t=mxCellPath.create(e.cell),n[t]=e,delete i[t]},o,!0,null),o=null,0<i.lenth&&(o=mxUtils.clone(i,null,!0)),t=mxUtils.clone(n,null,!0),e.visit(function(t,e,o){e.isAncestor(t)&&(o.invert(),mxUtils.remove(o,t.connectsAsSource),e.connectsAsSource.push(o),t.connectsAsTarget.push(o),mxUtils.remove(o,e.connectsAsTarget)),t=mxCellPath.create(e.cell),n[t]=e,delete i[t]},i,!0,t),r=this.layout.getGraph(),null!=o&&0<o.length)for(e=e.roots,t=0;t<o.length;t++)s=o[t].cell,0==r.getIncomingEdges(s).length&&e.push(s)};var mxHierarchicalEdgeStyle={ORTHOGONAL:1,POLYLINE:2,STRAIGHT:3,CURVE:4};mxCoordinateAssignment.prototype=new mxHierarchicalLayoutStage,mxCoordinateAssignment.prototype.constructor=mxCoordinateAssignment,mxCoordinateAssignment.prototype.layout=null,mxCoordinateAssignment.prototype.intraCellSpacing=30,mxCoordinateAssignment.prototype.interRankCellSpacing=100,mxCoordinateAssignment.prototype.parallelEdgeSpacing=10,mxCoordinateAssignment.prototype.maxIterations=8,mxCoordinateAssignment.prototype.prefHozEdgeSep=5,mxCoordinateAssignment.prototype.prefVertEdgeOff=2,mxCoordinateAssignment.prototype.minEdgeJetty=12,mxCoordinateAssignment.prototype.channelBuffer=4,mxCoordinateAssignment.prototype.jettyPositions=null,mxCoordinateAssignment.prototype.orientation=mxConstants.DIRECTION_NORTH,mxCoordinateAssignment.prototype.initialX=null,mxCoordinateAssignment.prototype.limitX=null,mxCoordinateAssignment.prototype.currentXDelta=null,mxCoordinateAssignment.prototype.widestRank=null,mxCoordinateAssignment.prototype.rankTopY=null,mxCoordinateAssignment.prototype.rankBottomY=null,mxCoordinateAssignment.prototype.widestRankValue=null,mxCoordinateAssignment.prototype.rankWidths=null,mxCoordinateAssignment.prototype.rankY=null,mxCoordinateAssignment.prototype.fineTuning=!0,mxCoordinateAssignment.prototype.edgeStyle=mxHierarchicalEdgeStyle.POLYLINE,mxCoordinateAssignment.prototype.nextLayerConnectedCache=null,mxCoordinateAssignment.prototype.previousLayerConnectedCache=null,mxCoordinateAssignment.prototype.groupPadding=10,mxCoordinateAssignment.prototype.printStatus=function(){var t=this.layout.getModel();mxLog.show(),mxLog.writeln("======Coord assignment debug=======");for(var e=0;e<t.ranks.length;e++){mxLog.write("Rank ",e," : ");for(var n=t.ranks[e],i=0;i<n.length;i++)mxLog.write(n[i].getGeneralPurposeVariable(e),"  ");mxLog.writeln()}mxLog.writeln("====================================")},mxCoordinateAssignment.prototype.execute=function(t){this.jettyPositions=[],t=this.layout.getModel(),this.currentXDelta=0,this.initialCoords(this.layout.getGraph(),t),this.fineTuning&&this.minNode(t);var e=1e8;if(this.fineTuning)for(var n=0;n<this.maxIterations;n++){if(0!=n&&(this.medianPos(n,t),this.minNode(t)),this.currentXDelta<e){for(var i=0;i<t.ranks.length;i++)for(var o=t.ranks[i],r=0;r<o.length;r++){var s=o[r];s.setX(i,s.getGeneralPurposeVariable(i))}e=this.currentXDelta}else for(i=0;i<t.ranks.length;i++)for(o=t.ranks[i],r=0;r<o.length;r++)s=o[r],s.setGeneralPurposeVariable(i,s.getX(i));this.minPath(this.layout.getGraph(),t),this.currentXDelta=0}this.setCellLocations(this.layout.getGraph(),t)},mxCoordinateAssignment.prototype.minNode=function(t){for(var e=[],n=[],i=[],o=0;o<=t.maxRank;o++){i[o]=t.ranks[o];for(var r=0;r<i[o].length;r++){var s=i[o][r],l=new WeightedCellSorter(s,o);l.rankIndex=r,l.visited=!0,e.push(l),s=mxCellPath.create(s.getCoreCell()),n[s]=l}}for(t=10*e.length,r=0;0<e.length&&t>=r;){var l=e.shift(),o=l.cell,a=l.weightedValue,h=parseInt(l.rankIndex),s=o.getNextLayerConnectedCells(a),d=o.getPreviousLayerConnectedCells(a),u=s.length,c=d.length,p=this.medianXValue(s,a+1),m=this.medianXValue(d,a-1),g=u+c,f=o.getGeneralPurposeVariable(a),x=f;if(g>0&&(x=(p*u+m*c)/g),u=!1,f-1>x?0==h?(o.setGeneralPurposeVariable(a,x),u=!0):(h=i[a][h-1],f=h.getGeneralPurposeVariable(a),f=f+h.width/2+this.intraCellSpacing+o.width/2,x>f?(o.setGeneralPurposeVariable(a,x),u=!0):f<o.getGeneralPurposeVariable(a)-1&&(o.setGeneralPurposeVariable(a,f),u=!0)):x>f+1&&(h==i[a].length-1?(o.setGeneralPurposeVariable(a,x),u=!0):(h=i[a][h+1],f=h.getGeneralPurposeVariable(a),f=f-h.width/2-this.intraCellSpacing-o.width/2,f>x?(o.setGeneralPurposeVariable(a,x),u=!0):f>o.getGeneralPurposeVariable(a)+1&&(o.setGeneralPurposeVariable(a,f),u=!0))),u){for(o=0;o<s.length;o++)a=s[o],a=mxCellPath.create(a.getCoreCell()),a=n[a],null!=a&&0==a.visited&&(a.visited=!0,e.push(a));for(o=0;o<d.length;o++)a=d[o],a=mxCellPath.create(a.getCoreCell()),a=n[a],null!=a&&0==a.visited&&(a.visited=!0,e.push(a))}l.visited=!1,r++}},mxCoordinateAssignment.prototype.medianPos=function(t,e){if(0==t%2)for(var n=e.maxRank;n>0;n--)this.rankMedianPosition(n-1,e,n);else for(n=0;n<e.maxRank-1;n++)this.rankMedianPosition(n+1,e,n)},mxCoordinateAssignment.prototype.rankMedianPosition=function(t,e,n){e=e.ranks[t];for(var i=[],o=[],r=0;r<e.length;r++){var s=e[r];i[r]=new WeightedCellSorter,i[r].cell=s,i[r].rankIndex=r;var l=mxCellPath.create(s.getCoreCell());o[l]=i[r];var a=null,a=t>n?s.getPreviousLayerConnectedCells(t):s.getNextLayerConnectedCells(t);i[r].weightedValue=this.calculatedWeightedValue(s,a)}for(i.sort(WeightedCellSorter.prototype.compare),r=0;r<i.length;r++){l=0,s=i[r].cell,l=0,a=t>n?s.getPreviousLayerConnectedCells(t).slice():s.getNextLayerConnectedCells(t).slice(),null!=a&&(l=a.length,l=l>0?this.medianXValue(a,n):s.getGeneralPurposeVariable(t));for(var h=0,a=-1e8,d=i[r].rankIndex-1;d>=0;){var u=mxCellPath.create(e[d].getCoreCell()),u=o[u];if(null!=u){var c=u.cell;u.visited?(a=c.getGeneralPurposeVariable(t)+c.width/2+this.intraCellSpacing+h+s.width/2,d=-1):(h+=c.width+this.intraCellSpacing,d--)}}for(h=0,c=1e8,d=i[r].rankIndex+1;d<i.length;)if(u=mxCellPath.create(e[d].getCoreCell()),u=o[u],null!=u){var p=u.cell;u.visited?(c=p.getGeneralPurposeVariable(t)-p.width/2-this.intraCellSpacing-h-s.width/2,d=i.length):(h+=p.width+this.intraCellSpacing,d++)}l>=a&&c>=l?s.setGeneralPurposeVariable(t,l):a>l?(s.setGeneralPurposeVariable(t,a),this.currentXDelta+=a-l):l>c&&(s.setGeneralPurposeVariable(t,c),this.currentXDelta+=l-c),i[r].visited=!0}},mxCoordinateAssignment.prototype.calculatedWeightedValue=function(t,e){for(var n=0,i=0;i<e.length;i++){var o=e[i];t.isVertex()&&o.isVertex()?n++:n=t.isEdge()&&o.isEdge()?n+8:n+2}return n},mxCoordinateAssignment.prototype.medianXValue=function(t,e){if(0==t.length)return 0;for(var n=[],i=0;i<t.length;i++)n[i]=t[i].getGeneralPurposeVariable(e);return n.sort(function(t,e){return t-e}),1==t.length%2?n[Math.floor(t.length/2)]:(i=t.length/2,(n[i-1]+n[i])/2)},mxCoordinateAssignment.prototype.initialCoords=function(t,e){this.calculateWidestRank(t,e);for(var n=this.widestRank;n>=0;n--)n<e.maxRank&&this.rankCoordinates(n,t,e);for(n=this.widestRank+1;n<=e.maxRank;n++)n>0&&this.rankCoordinates(n,t,e)},mxCoordinateAssignment.prototype.rankCoordinates=function(t,e,n){e=n.ranks[t],n=0;for(var i=this.initialX+(this.widestRankValue-this.rankWidths[t])/2,o=!1,r=0;r<e.length;r++){var s=e[r];if(s.isVertex()){var l=this.layout.getVertexBounds(s.cell);null!=l?this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH?(s.width=l.width,s.height=l.height):(s.width=l.height,s.height=l.width):o=!0,n=Math.max(n,s.height)}else s.isEdge()&&(l=1,null!=s.edges?l=s.edges.length:mxLog.warn("edge.edges is null"),s.width=(l-1)*this.parallelEdgeSpacing);i+=s.width/2,s.setX(t,i),s.setGeneralPurposeVariable(t,i),i+=s.width/2,i+=this.intraCellSpacing}1==o&&mxLog.warn("At least one cell has no bounds")},mxCoordinateAssignment.prototype.calculateWidestRank=function(t,e){var n=-this.interRankCellSpacing,i=0;this.rankWidths=[],this.rankY=[];for(var o=e.maxRank;o>=0;o--){for(var r=0,s=e.ranks[o],l=this.initialX,a=!1,h=0;h<s.length;h++){var d=s[h];if(d.isVertex()){var u=this.layout.getVertexBounds(d.cell);null!=u?this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH?(d.width=u.width,d.height=u.height):(d.width=u.height,d.height=u.width):a=!0,r=Math.max(r,d.height)}else d.isEdge()&&(u=1,null!=d.edges?u=d.edges.length:mxLog.warn("edge.edges is null"),d.width=(u-1)*this.parallelEdgeSpacing);l+=d.width/2,d.setX(o,l),d.setGeneralPurposeVariable(o,l),l+=d.width/2,l+=this.intraCellSpacing,l>this.widestRankValue&&(this.widestRankValue=l,this.widestRank=o),this.rankWidths[o]=l}for(1==a&&mxLog.warn("At least one cell has no bounds"),this.rankY[o]=n,l=r/2+i/2+this.interRankCellSpacing,i=r,n=this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_WEST?n+l:n-l,h=0;h<s.length;h++)s[h].setY(o,n)}},mxCoordinateAssignment.prototype.minPath=function(t,e){var n,i=e.edgeMapper;for(n in i){var o=i[n];if(!(1>o.maxRank-o.minRank-1)){for(var r=o.getGeneralPurposeVariable(o.minRank+1),s=!0,l=0,a=o.minRank+2;a<o.maxRank;a++){var h=o.getGeneralPurposeVariable(a);r!=h?(s=!1,r=h):l++}if(!s){for(var s=r=0,h=[],d=[],u=o.getGeneralPurposeVariable(o.minRank+1),a=o.minRank+1;a<o.maxRank-1;a++){var c=o.getX(a+1);u==c?(h[a-o.minRank-1]=u,r++):this.repositionValid(e,o,a+1,u)?(h[a-o.minRank-1]=u,r++):u=h[a-o.minRank-1]=c}for(u=o.getX(a),a=o.maxRank-1;a>o.minRank+1;a--)c=o.getX(a-1),u==c?(d[a-o.minRank-2]=u,s++):this.repositionValid(e,o,a-1,u)?(d[a-o.minRank-2]=u,s++):(d[a-o.minRank-2]=o.getX(a-1),u=c);if(s>l||r>l)if(s>=r)for(a=o.maxRank-2;a>o.minRank;a--)o.setX(a,d[a-o.minRank-1]);else if(r>s)for(a=o.minRank+2;a<o.maxRank;a++)o.setX(a,h[a-o.minRank-2])}}}},mxCoordinateAssignment.prototype.repositionValid=function(t,e,n,i){t=t.ranks[n];for(var o=-1,r=0;r<t.length;r++)if(e==t[r]){o=r;break}if(0>o)return!1;if(r=e.getGeneralPurposeVariable(n),r>i){if(0==o)return!0;if(t=t[o-1],n=t.getGeneralPurposeVariable(n),n=n+t.width/2+this.intraCellSpacing+e.width/2,!(i>=n))return!1}else if(i>r){if(o==t.length-1)return!0;if(t=t[o+1],n=t.getGeneralPurposeVariable(n),n=n-t.width/2-this.intraCellSpacing-e.width/2,!(n>=i))return!1}return!0},mxCoordinateAssignment.prototype.setCellLocations=function(t,e){this.rankTopY=[],this.rankBottomY=[];for(var n=0;n<e.ranks.length;n++)this.rankTopY[n]=Number.MAX_VALUE,this.rankBottomY[n]=0;n=null,this.layout.resizeParent&&(n={});var i,o=e.edgeMapper,r=e.vertexMapper;for(i in r){var s=r[i];if(this.setVertexLocation(s),this.layout.resizeParent){var s=t.model.getParent(s.cell),l=mxCellPath.create(s);null==n[l]&&(n[l]=s)}}this.layout.resizeParent&&null!=n&&this.adjustParents(n),(this.edgeStyle==mxHierarchicalEdgeStyle.ORTHOGONAL||this.edgeStyle==mxHierarchicalEdgeStyle.POLYLINE||this.edgeStyle==mxHierarchicalEdgeStyle.CURVE)&&this.localEdgeProcessing(e);for(i in o)this.setEdgePosition(o[i])},mxCoordinateAssignment.prototype.adjustParents=function(t){var e,n=[];for(e in t)n.push(t[e]);this.layout.arrangeGroups(mxUtils.sortCells(n,!0),this.groupPadding)},mxCoordinateAssignment.prototype.localEdgeProcessing=function(t){for(var e=0;e<t.ranks.length;e++)for(var n=t.ranks[e],i=0;i<n.length;i++){var o=n[i];if(o.isVertex())for(var r=o.getPreviousLayerConnectedCells(e),s=e-1,l=0;2>l;l++){if(s>-1&&s<t.ranks.length&&null!=r&&0<r.length){for(var a=[],h=0;h<r.length;h++){var d=new WeightedCellSorter(r[h],r[h].getX(s));a.push(d)}a.sort(WeightedCellSorter.prototype.compare);for(var d=o.x[0]-o.width/2,u=d+o.width,c=r=0,s=[],h=0;h<a.length;h++){var p,m=a[h].cell;if(m.isVertex()){p=0==l?o.connectsAsSource:o.connectsAsTarget;for(var g=0;g<p.length;g++)(p[g].source==m||p[g].target==m)&&(r+=p[g].edges.length,c++,s.push(p[g]))}else r+=m.edges.length,c++,s.push(m)}for(o.width>(r+1)*this.prefHozEdgeSep+2*this.prefHozEdgeSep&&(d+=this.prefHozEdgeSep,u-=this.prefHozEdgeSep),a=(u-d)/r,d+=a/2,u=this.minEdgeJetty-this.prefVertEdgeOff,h=c=0;h<s.length;h++){for(m=s[h].edges.length,g=mxCellPath.create(s[h].edges[0]),p=this.jettyPositions[g],null==p&&(p=[],this.jettyPositions[g]=p),r/2>h?u+=this.prefVertEdgeOff:h>r/2&&(u-=this.prefVertEdgeOff),g=0;m>g;g++)p[4*g+2*l]=d,d+=a,p[4*g+2*l+1]=u;c=Math.max(c,u)}}r=o.getNextLayerConnectedCells(e),s=e+1}}},mxCoordinateAssignment.prototype.setEdgePosition=function(t){var e=0;if(101207!=t.temp[0]){var n=t.maxRank,i=t.minRank;n==i&&(n=t.source.maxRank,i=t.target.minRank);for(var o=0,r=mxCellPath.create(t.edges[0]),r=this.jettyPositions[r],s=t.isReversed?t.target.cell:t.source.cell,l=this.layout.graph,a=0;a<t.edges.length;a++){var h=t.edges[a],d=this.layout.getVisibleTerminal(h,!0),u=l.model.getTerminal(h,!0),c=[],p=t.isReversed;if(d!=s&&(p=!p),null!=r){var m=p?2:0,g=p?this.rankTopY[i]:this.rankBottomY[n],f=r[4*o+1+m];p&&(f=-f),g+=f,m=r[4*o+m],u=l.model.getTerminal(h,!0),this.layout.isPort(u)&&l.model.getParent(u)==d&&(m=l.view.getState(u),m=null!=m?m.x:d.geometry.x+t.source.width*u.geometry.x),this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH?(c.push(new mxPoint(m,g)),this.edgeStyle==mxHierarchicalEdgeStyle.CURVE&&c.push(new mxPoint(m,g+f))):(c.push(new mxPoint(g,m)),this.edgeStyle==mxHierarchicalEdgeStyle.CURVE&&c.push(new mxPoint(g+f,m)))}for(m=t.x.length-1,g=f=-1,d=t.maxRank-1,p&&(m=0,f=t.x.length,g=1,d=t.minRank+1);t.maxRank!=t.minRank&&m!=f;m+=g){var u=t.x[m]+e,x=(this.rankTopY[d]+this.rankBottomY[d+1])/2,C=(this.rankTopY[d-1]+this.rankBottomY[d])/2;if(p)var E=x,x=C,C=E;this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH?(c.push(new mxPoint(u,x)),c.push(new mxPoint(u,C))):(c.push(new mxPoint(x,u)),c.push(new mxPoint(C,u))),this.limitX=Math.max(this.limitX,u),d+=g}null!=r&&(m=p?2:0,g=p?this.rankBottomY[n]:this.rankTopY[i],f=r[4*o+3-m],p&&(f=-f),g-=f,m=r[4*o+2-m],p=l.model.getTerminal(h,!1),d=this.layout.getVisibleTerminal(h,!1),this.layout.isPort(p)&&l.model.getParent(p)==d&&(m=l.view.getState(p),m=null!=m?m.x:d.geometry.x+t.target.width*p.geometry.x),this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH?(this.edgeStyle==mxHierarchicalEdgeStyle.CURVE&&c.push(new mxPoint(m,g-f)),c.push(new mxPoint(m,g))):(this.edgeStyle==mxHierarchicalEdgeStyle.CURVE&&c.push(new mxPoint(g-f,m)),c.push(new mxPoint(g,m)))),t.isReversed&&this.processReversedEdge(t,h),this.layout.setEdgePoints(h,c),e=0==e?this.parallelEdgeSpacing:e>0?-e:-e+this.parallelEdgeSpacing,o++}t.temp[0]=101207}},mxCoordinateAssignment.prototype.setVertexLocation=function(t){var e=t.cell,n=t.x[0]-t.width/2,i=t.y[0]-t.height/2;this.rankTopY[t.minRank]=Math.min(this.rankTopY[t.minRank],i),this.rankBottomY[t.minRank]=Math.max(this.rankBottomY[t.minRank],i+t.height),this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH?this.layout.setVertexLocation(e,n,i):this.layout.setVertexLocation(e,i,n),this.limitX=Math.max(this.limitX,n+t.width)},mxCoordinateAssignment.prototype.processReversedEdge=function(){},WeightedCellSorter.prototype.weightedValue=0,WeightedCellSorter.prototype.nudge=!1,WeightedCellSorter.prototype.visited=!1,WeightedCellSorter.prototype.rankIndex=null,WeightedCellSorter.prototype.cell=null,WeightedCellSorter.prototype.compare=function(t,e){return null!=t&&null!=e?e.weightedValue>t.weightedValue?-1:e.weightedValue<t.weightedValue?1:e.nudge?-1:1:0},mxHierarchicalLayout.prototype=new mxGraphLayout,mxHierarchicalLayout.prototype.constructor=mxHierarchicalLayout,mxHierarchicalLayout.prototype.roots=null,mxHierarchicalLayout.prototype.resizeParent=!1,mxHierarchicalLayout.prototype.moveParent=!1,mxHierarchicalLayout.prototype.parentBorder=0,mxHierarchicalLayout.prototype.intraCellSpacing=30,mxHierarchicalLayout.prototype.interRankCellSpacing=100,mxHierarchicalLayout.prototype.interHierarchySpacing=60,mxHierarchicalLayout.prototype.parallelEdgeSpacing=10,mxHierarchicalLayout.prototype.orientation=mxConstants.DIRECTION_NORTH,mxHierarchicalLayout.prototype.fineTuning=!0,mxHierarchicalLayout.prototype.tightenToSource=!0,mxHierarchicalLayout.prototype.disableEdgeStyle=!0,mxHierarchicalLayout.prototype.traverseAncestors=!0,mxHierarchicalLayout.prototype.model=null,mxHierarchicalLayout.prototype.edgesCache=null,mxHierarchicalLayout.prototype.getModel=function(){return this.model},mxHierarchicalLayout.prototype.execute=function(t,e){this.parent=t;var n=this.graph.model;if(this.edgesCache={},null!=e&&"array"!=typeof e&&(e=[e]),null!=e||null!=t){if(null!=e&&null!=t){for(var i=[],o=0;o<e.length;o++)n.isAncestor(t,e[o])&&i.push(e[o]);this.roots=i}else this.roots=e;n.beginUpdate();try{this.run(t),this.resizeParent&&!this.graph.isCellCollapsed(t)&&this.graph.updateGroupBounds([t],this.parentBorder,this.moveParent)}finally{n.endUpdate()}}},mxHierarchicalLayout.prototype.findRoots=function(t,e){var n=[];if(null!=t&&null!=e){var i,o=this.graph.model,r=null,s=-1e5;for(i in e){var l=e[i];if(o.isVertex(l)&&this.graph.isCellVisible(l)){for(var a=this.getEdges(l),h=0,d=0,u=0;u<a.length;u++)this.getVisibleTerminal(a[u],!0)==l?h++:d++;0==d&&h>0&&n.push(l),a=h-d,a>s&&(s=a,r=l)}}0==n.length&&null!=r&&n.push(r)}return n},mxHierarchicalLayout.prototype.getEdges=function(t){var e=mxCellPath.create(t);if(null!=this.edgesCache[e])return this.edgesCache[e];for(var n=this.graph.model,i=[],o=this.graph.isCellCollapsed(t),r=n.getChildCount(t),s=0;r>s;s++){var l=n.getChildAt(t,s);this.isPort(l)?i=i.concat(n.getEdges(l,!0,!0)):(o||!this.graph.isCellVisible(l))&&(i=i.concat(n.getEdges(l,!0,!0)))}for(i=i.concat(n.getEdges(t,!0,!0)),n=[],s=0;s<i.length;s++)o=this.getVisibleTerminal(i[s],!0),r=this.getVisibleTerminal(i[s],!1),(o==r||o!=r&&(r==t&&(null==this.parent||this.graph.isValidAncestor(o,this.parent,this.traverseAncestors))||o==t&&(null==this.parent||this.graph.isValidAncestor(r,this.parent,this.traverseAncestors))))&&n.push(i[s]);return this.edgesCache[e]=n},mxHierarchicalLayout.prototype.getVisibleTerminal=function(t,e){var n=this.graph.view.getState(t),n=null!=n?n.getVisibleTerminal(e):this.graph.view.getVisibleTerminal(t,e);return this.isPort(n)&&(n=this.graph.model.getParent(n)),n},mxHierarchicalLayout.prototype.run=function(t){var e=[],n=[];if(null==this.roots&&null!=t){var i={};this.filterDescendants(t,i),this.roots=[];var o,r=!0;for(o in i)if(null!=i[o]){r=!1;break}for(;!r;){for(var s=this.findRoots(t,i),r=0;r<s.length;r++){var l={};e.push(l),this.traverse(s[r],!0,null,n,l,e,i)}for(r=0;r<s.length;r++)this.roots.push(s[r]);r=!0;for(o in i)if(null!=i[o]){r=!1;break}}}else for(r=0;r<this.roots.length;r++)l={},e.push(l),this.traverse(this.roots[r],!0,null,n,l,e,null);for(r=n=0;r<e.length;r++){l=e[r],i=[];for(o in l)i.push(l[o]);this.model=new mxGraphHierarchyModel(this,i,this.roots,t,this.tightenToSource),this.cycleStage(t),this.layeringStage(),this.crossingStage(t),n=this.placementStage(n,t)}},mxHierarchicalLayout.prototype.filterDescendants=function(t,e){var n=this.graph.model;if(n.isVertex(t)&&t!=this.parent&&this.graph.isCellVisible(t)&&(e[mxCellPath.create(t)]=t),this.traverseAncestors||t==this.parent&&this.graph.isCellVisible(t))for(var i=n.getChildCount(t),o=0;i>o;o++){var r=n.getChildAt(t,o);this.isPort(r)||this.filterDescendants(r,e)}},mxHierarchicalLayout.prototype.isPort=function(t){return t.geometry.relative?!0:!1},mxHierarchicalLayout.prototype.getEdgesBetween=function(t,e,n){n=null!=n?n:!1;for(var i=this.getEdges(t),o=[],r=0;r<i.length;r++){var s=this.getVisibleTerminal(i[r],!0),l=this.getVisibleTerminal(i[r],!1);(s==t&&l==e||!n&&s==e&&l==t)&&o.push(i[r])}return o},mxHierarchicalLayout.prototype.traverse=function(t,e,n,i,o,r,s){if(null!=t&&null!=i){var l=mxCellPath.create(t);if(null!=i[l]||null!=s&&null==s[l]){if(null==o[l])for(n=0;n<r.length;n++)if(t=r[n],null!=t[l]){for(a in o)t[a]=o[a];return r.pop(),t}}else{null==o[l]&&(o[l]=t),null==i[l]&&(i[l]=t),null!==s&&delete s[l];var a=this.getEdges(t);for(n=0;n<a.length;n++)l=this.getVisibleTerminal(a[n],!0)==t,(!e||l)&&(l=this.getVisibleTerminal(a[n],!l),o=this.traverse(l,e,a[n],i,o,r,s))}}return o},mxHierarchicalLayout.prototype.cycleStage=function(t){new mxMinimumCycleRemover(this).execute(t)},mxHierarchicalLayout.prototype.layeringStage=function(){this.model.initialRank(),this.model.fixRanks()},mxHierarchicalLayout.prototype.crossingStage=function(t){new mxMedianHybridCrossingReduction(this).execute(t)},mxHierarchicalLayout.prototype.placementStage=function(t,e){var n=new mxCoordinateAssignment(this,this.intraCellSpacing,this.interRankCellSpacing,this.orientation,t,this.parallelEdgeSpacing);return n.fineTuning=this.fineTuning,n.execute(e),n.limitX+this.interHierarchySpacing},mxGraphModel.prototype=new mxEventSource,mxGraphModel.prototype.constructor=mxGraphModel,mxGraphModel.prototype.root=null,mxGraphModel.prototype.cells=null,mxGraphModel.prototype.maintainEdgeParent=!0,mxGraphModel.prototype.createIds=!0,mxGraphModel.prototype.prefix="",mxGraphModel.prototype.postfix="",mxGraphModel.prototype.nextId=0,mxGraphModel.prototype.currentEdit=null,mxGraphModel.prototype.updateLevel=0,mxGraphModel.prototype.endingUpdate=!1,mxGraphModel.prototype.clear=function(){this.setRoot(this.createRoot())},mxGraphModel.prototype.isCreateIds=function(){return this.createIds},mxGraphModel.prototype.setCreateIds=function(t){this.createIds=t},mxGraphModel.prototype.createRoot=function(){var t=new mxCell;return t.insert(new mxCell),t},mxGraphModel.prototype.getCell=function(t){return null!=this.cells?this.cells[t]:null},mxGraphModel.prototype.filterCells=function(t,e){var n=null;if(null!=t)for(var n=[],i=0;i<t.length;i++)e(t[i])&&n.push(t[i]);return n},mxGraphModel.prototype.getDescendants=function(t){return this.filterDescendants(null,t)},mxGraphModel.prototype.filterDescendants=function(t,e){var n=[];e=e||this.getRoot(),(null==t||t(e))&&n.push(e);for(var i=this.getChildCount(e),o=0;i>o;o++)var r=this.getChildAt(e,o),n=n.concat(this.filterDescendants(t,r));return n},mxGraphModel.prototype.getRoot=function(t){var e=t||this.root;if(null!=t)for(;null!=t;)e=t,t=this.getParent(t);return e},mxGraphModel.prototype.setRoot=function(t){return this.execute(new mxRootChange(this,t)),t},mxGraphModel.prototype.rootChanged=function(t){var e=this.root;return this.root=t,this.nextId=0,this.cells=null,this.cellAdded(t),e},mxGraphModel.prototype.isRoot=function(t){return null!=t&&this.root==t},mxGraphModel.prototype.isLayer=function(t){return this.isRoot(this.getParent(t))},mxGraphModel.prototype.isAncestor=function(t,e){for(;null!=e&&e!=t;)e=this.getParent(e);return e==t},mxGraphModel.prototype.contains=function(t){return this.isAncestor(this.root,t)},mxGraphModel.prototype.getParent=function(t){return null!=t?t.getParent():null},mxGraphModel.prototype.add=function(t,e,n){if(e!=t&&null!=t&&null!=e){null==n&&(n=this.getChildCount(t));var i=t!=this.getParent(e);this.execute(new mxChildChange(this,t,e,n)),this.maintainEdgeParent&&i&&this.updateEdgeParents(e)}return e},mxGraphModel.prototype.cellAdded=function(t){if(null!=t){if(null==t.getId()&&this.createIds&&t.setId(this.createId(t)),null!=t.getId()){var e=this.getCell(t.getId());if(e!=t){for(;null!=e;)t.setId(this.createId(t)),e=this.getCell(t.getId());null==this.cells&&(this.cells={}),this.cells[t.getId()]=t}}mxUtils.isNumeric(t.getId())&&(this.nextId=Math.max(this.nextId,t.getId()));for(var e=this.getChildCount(t),n=0;e>n;n++)this.cellAdded(this.getChildAt(t,n))}},mxGraphModel.prototype.createId=function(t){return t=this.nextId,this.nextId++,this.prefix+t+this.postfix},mxGraphModel.prototype.updateEdgeParents=function(t,e){e=e||this.getRoot(t);for(var n=this.getChildCount(t),i=0;n>i;i++){var o=this.getChildAt(t,i);this.updateEdgeParents(o,e)}for(o=this.getEdgeCount(t),n=[],i=0;o>i;i++)n.push(this.getEdgeAt(t,i));for(i=0;i<n.length;i++)o=n[i],this.isAncestor(e,o)&&this.updateEdgeParent(o,e)},mxGraphModel.prototype.updateEdgeParent=function(t,e){for(var n=this.getTerminal(t,!0),i=this.getTerminal(t,!1),o=null;null!=n&&!this.isEdge(n)&&null!=n.geometry&&n.geometry.relative;)n=this.getParent(n);
for(;null!=i&&!this.isEdge(i)&&null!=i.geometry&&i.geometry.relative;)i=this.getParent(i);if(this.isAncestor(e,n)&&this.isAncestor(e,i)&&(o=n==i?this.getParent(n):this.getNearestCommonAncestor(n,i),null!=o&&(this.getParent(o)!=this.root||this.isAncestor(o,t))&&this.getParent(t)!=o)){if(n=this.getGeometry(t),null!=n){var r=this.getOrigin(this.getParent(t)),s=this.getOrigin(o),i=s.x-r.x,r=s.y-r.y,n=n.clone();n.translate(-i,-r),this.setGeometry(t,n)}this.add(o,t,this.getChildCount(o))}},mxGraphModel.prototype.getOrigin=function(t){var e=null;return null!=t?(e=this.getOrigin(this.getParent(t)),this.isEdge(t)||(t=this.getGeometry(t),null!=t&&(e.x+=t.x,e.y+=t.y))):e=new mxPoint,e},mxGraphModel.prototype.getNearestCommonAncestor=function(t,e){if(null!=t&&null!=e){var n=mxCellPath.create(e);if(null!=n&&0<n.length){var i=t,o=mxCellPath.create(i);if(n.length<o.length)var i=e,r=o,o=n,n=r;for(;null!=i;){if(r=this.getParent(i),0==n.indexOf(o+mxCellPath.PATH_SEPARATOR)&&null!=r)return i;o=mxCellPath.getParentPath(o),i=r}}}return null},mxGraphModel.prototype.remove=function(t){return t==this.root?this.setRoot(null):null!=this.getParent(t)&&this.execute(new mxChildChange(this,null,t)),t},mxGraphModel.prototype.cellRemoved=function(t){if(null!=t&&null!=this.cells){for(var e=this.getChildCount(t)-1;e>=0;e--)this.cellRemoved(this.getChildAt(t,e));null!=this.cells&&null!=t.getId()&&delete this.cells[t.getId()]}},mxGraphModel.prototype.parentForCellChanged=function(t,e,n){var i=this.getParent(t);return null!=e?(e!=i||i.getIndex(t)!=n)&&e.insert(t,n):null!=i&&(n=i.getIndex(t),i.remove(n)),this.contains(i)||null==e?null==e&&this.cellRemoved(t):this.cellAdded(t),i},mxGraphModel.prototype.getChildCount=function(t){return null!=t?t.getChildCount():0},mxGraphModel.prototype.getChildAt=function(t,e){return null!=t?t.getChildAt(e):null},mxGraphModel.prototype.getChildren=function(t){return null!=t?t.children:null},mxGraphModel.prototype.getChildVertices=function(t){return this.getChildCells(t,!0,!1)},mxGraphModel.prototype.getChildEdges=function(t){return this.getChildCells(t,!1,!0)},mxGraphModel.prototype.getChildCells=function(t,e,n){e=null!=e?e:!1,n=null!=n?n:!1;for(var i=this.getChildCount(t),o=[],r=0;i>r;r++){var s=this.getChildAt(t,r);(!n&&!e||n&&this.isEdge(s)||e&&this.isVertex(s))&&o.push(s)}return o},mxGraphModel.prototype.getTerminal=function(t,e){return null!=t?t.getTerminal(e):null},mxGraphModel.prototype.setTerminal=function(t,e,n){var i=e!=this.getTerminal(t,n);return this.execute(new mxTerminalChange(this,t,e,n)),this.maintainEdgeParent&&i&&this.updateEdgeParent(t,this.getRoot()),e},mxGraphModel.prototype.setTerminals=function(t,e,n){this.beginUpdate();try{this.setTerminal(t,e,!0),this.setTerminal(t,n,!1)}finally{this.endUpdate()}},mxGraphModel.prototype.terminalForCellChanged=function(t,e,n){var i=this.getTerminal(t,n);return null!=e?e.insertEdge(t,n):null!=i&&i.removeEdge(t,n),i},mxGraphModel.prototype.getEdgeCount=function(t){return null!=t?t.getEdgeCount():0},mxGraphModel.prototype.getEdgeAt=function(t,e){return null!=t?t.getEdgeAt(e):null},mxGraphModel.prototype.getDirectedEdgeCount=function(t,e,n){for(var i=0,o=this.getEdgeCount(t),r=0;o>r;r++){var s=this.getEdgeAt(t,r);s!=n&&this.getTerminal(s,e)==t&&i++}return i},mxGraphModel.prototype.getConnections=function(t){return this.getEdges(t,!0,!0,!1)},mxGraphModel.prototype.getIncomingEdges=function(t){return this.getEdges(t,!0,!1,!1)},mxGraphModel.prototype.getOutgoingEdges=function(t){return this.getEdges(t,!1,!0,!1)},mxGraphModel.prototype.getEdges=function(t,e,n,i){e=null!=e?e:!0,n=null!=n?n:!0,i=null!=i?i:!0;for(var o=this.getEdgeCount(t),r=[],s=0;o>s;s++){var l=this.getEdgeAt(t,s),a=this.getTerminal(l,!0),h=this.getTerminal(l,!1);(i&&a==h||a!=h&&(e&&h==t||n&&a==t))&&r.push(l)}return r},mxGraphModel.prototype.getEdgesBetween=function(t,e,n){n=null!=n?n:!1;var i=this.getEdgeCount(t),o=this.getEdgeCount(e),r=t,s=i;for(i>o&&(s=o,r=e),i=[],o=0;s>o;o++){var l=this.getEdgeAt(r,o),a=this.getTerminal(l,!0),h=this.getTerminal(l,!1),d=h==t&&a==e;(a==t&&h==e||!n&&d)&&i.push(l)}return i},mxGraphModel.prototype.getOpposites=function(t,e,n,i){n=null!=n?n:!0,i=null!=i?i:!0;var o=[];if(null!=t)for(var r=0;r<t.length;r++){var s=this.getTerminal(t[r],!0),l=this.getTerminal(t[r],!1);s==e&&null!=l&&l!=e&&i?o.push(l):l==e&&null!=s&&s!=e&&n&&o.push(s)}return o},mxGraphModel.prototype.getTopmostCells=function(t){for(var e=[],n=0;n<t.length;n++){for(var i=t[n],o=!0,r=this.getParent(i);null!=r;){if(0<=mxUtils.indexOf(t,r)){o=!1;break}r=this.getParent(r)}o&&e.push(i)}return e},mxGraphModel.prototype.isVertex=function(t){return null!=t?t.isVertex():!1},mxGraphModel.prototype.isEdge=function(t){return null!=t?t.isEdge():!1},mxGraphModel.prototype.isConnectable=function(t){return null!=t?t.isConnectable():!1},mxGraphModel.prototype.getValue=function(t){return null!=t?t.getValue():null},mxGraphModel.prototype.setValue=function(t,e){return this.execute(new mxValueChange(this,t,e)),e},mxGraphModel.prototype.valueForCellChanged=function(t,e){return t.valueChanged(e)},mxGraphModel.prototype.getGeometry=function(t){return null!=t?t.getGeometry():null},mxGraphModel.prototype.setGeometry=function(t,e){return e!=this.getGeometry(t)&&this.execute(new mxGeometryChange(this,t,e)),e},mxGraphModel.prototype.geometryForCellChanged=function(t,e){var n=this.getGeometry(t);return t.setGeometry(e),n},mxGraphModel.prototype.getStyle=function(t){return null!=t?t.getStyle():null},mxGraphModel.prototype.setStyle=function(t,e){return e!=this.getStyle(t)&&this.execute(new mxStyleChange(this,t,e)),e},mxGraphModel.prototype.styleForCellChanged=function(t,e){var n=this.getStyle(t);return t.setStyle(e),n},mxGraphModel.prototype.isCollapsed=function(t){return null!=t?t.isCollapsed():!1},mxGraphModel.prototype.setCollapsed=function(t,e){return e!=this.isCollapsed(t)&&this.execute(new mxCollapseChange(this,t,e)),e},mxGraphModel.prototype.collapsedStateForCellChanged=function(t,e){var n=this.isCollapsed(t);return t.setCollapsed(e),n},mxGraphModel.prototype.isVisible=function(t){return null!=t?t.isVisible():!1},mxGraphModel.prototype.setVisible=function(t,e){return e!=this.isVisible(t)&&this.execute(new mxVisibleChange(this,t,e)),e},mxGraphModel.prototype.visibleStateForCellChanged=function(t,e){var n=this.isVisible(t);return t.setVisible(e),n},mxGraphModel.prototype.execute=function(t){t.execute(),this.beginUpdate(),this.currentEdit.add(t),this.fireEvent(new mxEventObject(mxEvent.EXECUTE,"change",t)),this.fireEvent(new mxEventObject(mxEvent.EXECUTED,"change",t)),this.endUpdate()},mxGraphModel.prototype.beginUpdate=function(){this.updateLevel++,this.fireEvent(new mxEventObject(mxEvent.BEGIN_UPDATE)),1==this.updateLevel&&this.fireEvent(new mxEventObject(mxEvent.START_EDIT))},mxGraphModel.prototype.endUpdate=function(){if(this.updateLevel--,0==this.updateLevel&&this.fireEvent(new mxEventObject(mxEvent.END_EDIT)),!this.endingUpdate){this.endingUpdate=0==this.updateLevel,this.fireEvent(new mxEventObject(mxEvent.END_UPDATE,"edit",this.currentEdit));try{if(this.endingUpdate&&!this.currentEdit.isEmpty()){this.fireEvent(new mxEventObject(mxEvent.BEFORE_UNDO,"edit",this.currentEdit));var t=this.currentEdit;this.currentEdit=this.createUndoableEdit(),t.notify(),this.fireEvent(new mxEventObject(mxEvent.UNDO,"edit",t))}}finally{this.endingUpdate=!1}}},mxGraphModel.prototype.createUndoableEdit=function(){var t=new mxUndoableEdit(this,!0);return t.notify=function(){t.source.fireEvent(new mxEventObject(mxEvent.CHANGE,"edit",t,"changes",t.changes)),t.source.fireEvent(new mxEventObject(mxEvent.NOTIFY,"edit",t,"changes",t.changes))},t},mxGraphModel.prototype.mergeChildren=function(t,e,n){n=null!=n?n:!0,this.beginUpdate();try{var i={};this.mergeChildrenImpl(t,e,n,i);for(var o in i){var r=i[o],s=this.getTerminal(r,!0);null!=s&&(s=i[mxCellPath.create(s)],this.setTerminal(r,s,!0)),s=this.getTerminal(r,!1),null!=s&&(s=i[mxCellPath.create(s)],this.setTerminal(r,s,!1))}}finally{this.endUpdate()}},mxGraphModel.prototype.mergeChildrenImpl=function(t,e,n,i){this.beginUpdate();try{for(var o=t.getChildCount(),r=0;o>r;r++){var s=t.getChildAt(r);if("function"==typeof s.getId){var l=s.getId(),a=null==l||this.isEdge(s)&&n?null:this.getCell(l);if(null==a){var h=s.clone();h.setId(l),h.setTerminal(s.getTerminal(!0),!0),h.setTerminal(s.getTerminal(!1),!1),a=e.insert(h),this.cellAdded(a)}i[mxCellPath.create(s)]=a,this.mergeChildrenImpl(s,a,n,i)}}}finally{this.endUpdate()}},mxGraphModel.prototype.getParents=function(t){var e=[];if(null!=t)for(var n={},i=0;i<t.length;i++){var o=this.getParent(t[i]);if(null!=o){var r=mxCellPath.create(o);null==n[r]&&(n[r]=o,e.push(o))}}return e},mxGraphModel.prototype.cloneCell=function(t){return null!=t?this.cloneCells([t],!0)[0]:null},mxGraphModel.prototype.cloneCells=function(t,e){for(var n={},i=[],o=0;o<t.length;o++)null!=t[o]?i.push(this.cloneCellImpl(t[o],n,e)):i.push(null);for(o=0;o<i.length;o++)null!=i[o]&&this.restoreClone(i[o],t[o],n);return i},mxGraphModel.prototype.cloneCellImpl=function(t,e,n){var i=this.cellCloned(t);if(e[mxObjectIdentity.get(t)]=i,n){n=this.getChildCount(t);for(var o=0;n>o;o++){var r=this.cloneCellImpl(this.getChildAt(t,o),e,!0);i.insert(r)}}return i},mxGraphModel.prototype.cellCloned=function(t){return t.clone()},mxGraphModel.prototype.restoreClone=function(t,e,n){var i=this.getTerminal(e,!0);null!=i&&(i=n[mxObjectIdentity.get(i)],null!=i&&i.insertEdge(t,!0)),i=this.getTerminal(e,!1),null!=i&&(i=n[mxObjectIdentity.get(i)],null!=i&&i.insertEdge(t,!1));for(var i=this.getChildCount(t),o=0;i>o;o++)this.restoreClone(this.getChildAt(t,o),this.getChildAt(e,o),n)},mxRootChange.prototype.execute=function(){this.root=this.previous,this.previous=this.model.rootChanged(this.previous)},mxChildChange.prototype.execute=function(){var t=this.model.getParent(this.child),e=null!=t?t.getIndex(this.child):0;null==this.previous&&this.connect(this.child,!1),t=this.model.parentForCellChanged(this.child,this.previous,this.previousIndex),null!=this.previous&&this.connect(this.child,!0),this.parent=this.previous,this.previous=t,this.index=this.previousIndex,this.previousIndex=e},mxChildChange.prototype.connect=function(t,e){e=null!=e?e:!0;var n=t.getTerminal(!0),i=t.getTerminal(!1);for(null!=n&&(e?this.model.terminalForCellChanged(t,n,!0):this.model.terminalForCellChanged(t,null,!0)),null!=i&&(e?this.model.terminalForCellChanged(t,i,!1):this.model.terminalForCellChanged(t,null,!1)),t.setTerminal(n,!0),t.setTerminal(i,!1),n=this.model.getChildCount(t),i=0;n>i;i++)this.connect(this.model.getChildAt(t,i),e)},mxTerminalChange.prototype.execute=function(){this.terminal=this.previous,this.previous=this.model.terminalForCellChanged(this.cell,this.previous,this.source)},mxValueChange.prototype.execute=function(){this.value=this.previous,this.previous=this.model.valueForCellChanged(this.cell,this.previous)},mxStyleChange.prototype.execute=function(){this.style=this.previous,this.previous=this.model.styleForCellChanged(this.cell,this.previous)},mxGeometryChange.prototype.execute=function(){this.geometry=this.previous,this.previous=this.model.geometryForCellChanged(this.cell,this.previous)},mxCollapseChange.prototype.execute=function(){this.collapsed=this.previous,this.previous=this.model.collapsedStateForCellChanged(this.cell,this.previous)},mxVisibleChange.prototype.execute=function(){this.visible=this.previous,this.previous=this.model.visibleStateForCellChanged(this.cell,this.previous)},mxCellAttributeChange.prototype.execute=function(){var t=this.cell.getAttribute(this.attribute);null==this.previous?this.cell.value.removeAttribute(this.attribute):this.cell.setAttribute(this.attribute,this.previous),this.previous=t},mxCell.prototype.id=null,mxCell.prototype.value=null,mxCell.prototype.geometry=null,mxCell.prototype.style=null,mxCell.prototype.vertex=!1,mxCell.prototype.edge=!1,mxCell.prototype.connectable=!0,mxCell.prototype.visible=!0,mxCell.prototype.collapsed=!1,mxCell.prototype.parent=null,mxCell.prototype.source=null,mxCell.prototype.target=null,mxCell.prototype.children=null,mxCell.prototype.edges=null,mxCell.prototype.mxTransient="id value parent source target children edges".split(" "),mxCell.prototype.getId=function(){return this.id},mxCell.prototype.setId=function(t){this.id=t},mxCell.prototype.getValue=function(){return this.value},mxCell.prototype.setValue=function(t){this.value=t},mxCell.prototype.valueChanged=function(t){var e=this.getValue();return this.setValue(t),e},mxCell.prototype.getGeometry=function(){return this.geometry},mxCell.prototype.setGeometry=function(t){this.geometry=t},mxCell.prototype.getStyle=function(){return this.style},mxCell.prototype.setStyle=function(t){this.style=t},mxCell.prototype.isVertex=function(){return this.vertex},mxCell.prototype.setVertex=function(t){this.vertex=t},mxCell.prototype.isEdge=function(){return this.edge},mxCell.prototype.setEdge=function(t){this.edge=t},mxCell.prototype.isConnectable=function(){return this.connectable},mxCell.prototype.setConnectable=function(t){this.connectable=t},mxCell.prototype.isVisible=function(){return this.visible},mxCell.prototype.setVisible=function(t){this.visible=t},mxCell.prototype.isCollapsed=function(){return this.collapsed},mxCell.prototype.setCollapsed=function(t){this.collapsed=t},mxCell.prototype.getParent=function(){return this.parent},mxCell.prototype.setParent=function(t){this.parent=t},mxCell.prototype.getTerminal=function(t){return t?this.source:this.target},mxCell.prototype.setTerminal=function(t,e){return e?this.source=t:this.target=t,t},mxCell.prototype.getChildCount=function(){return null==this.children?0:this.children.length},mxCell.prototype.getIndex=function(t){return mxUtils.indexOf(this.children,t)},mxCell.prototype.getChildAt=function(t){return null==this.children?null:this.children[t]},mxCell.prototype.insert=function(t,e){return null!=t&&(null==e&&(e=this.getChildCount(),t.getParent()==this&&e--),t.removeFromParent(),t.setParent(this),null==this.children?(this.children=[],this.children.push(t)):this.children.splice(e,0,t)),t},mxCell.prototype.remove=function(t){var e=null;return null!=this.children&&t>=0&&(e=this.getChildAt(t),null!=e&&(this.children.splice(t,1),e.setParent(null))),e},mxCell.prototype.removeFromParent=function(){if(null!=this.parent){var t=this.parent.getIndex(this);this.parent.remove(t)}},mxCell.prototype.getEdgeCount=function(){return null==this.edges?0:this.edges.length},mxCell.prototype.getEdgeIndex=function(t){return mxUtils.indexOf(this.edges,t)},mxCell.prototype.getEdgeAt=function(t){return null==this.edges?null:this.edges[t]},mxCell.prototype.insertEdge=function(t,e){return null!=t&&(t.removeFromTerminal(e),t.setTerminal(this,e),null==this.edges||t.getTerminal(!e)!=this||0>mxUtils.indexOf(this.edges,t))&&(null==this.edges&&(this.edges=[]),this.edges.push(t)),t},mxCell.prototype.removeEdge=function(t,e){if(null!=t){if(t.getTerminal(!e)!=this&&null!=this.edges){var n=this.getEdgeIndex(t);n>=0&&this.edges.splice(n,1)}t.setTerminal(null,e)}return t},mxCell.prototype.removeFromTerminal=function(t){var e=this.getTerminal(t);null!=e&&e.removeEdge(this,t)},mxCell.prototype.getAttribute=function(t,e){var n=this.getValue();return(null!=n&&n.nodeType==mxConstants.NODETYPE_ELEMENT?n.getAttribute(t):null)||e},mxCell.prototype.setAttribute=function(t,e){var n=this.getValue();null!=n&&n.nodeType==mxConstants.NODETYPE_ELEMENT&&n.setAttribute(t,e)},mxCell.prototype.clone=function(){var t=mxUtils.clone(this,this.mxTransient);return t.setValue(this.cloneValue()),t},mxCell.prototype.cloneValue=function(){var t=this.getValue();return null!=t&&("function"==typeof t.clone?t=t.clone():isNaN(t.nodeType)||(t=t.cloneNode(!0))),t},mxGeometry.prototype=new mxRectangle,mxGeometry.prototype.constructor=mxGeometry,mxGeometry.prototype.TRANSLATE_CONTROL_POINTS=!0,mxGeometry.prototype.alternateBounds=null,mxGeometry.prototype.sourcePoint=null,mxGeometry.prototype.targetPoint=null,mxGeometry.prototype.points=null,mxGeometry.prototype.offset=null,mxGeometry.prototype.relative=!1,mxGeometry.prototype.swap=function(){if(null!=this.alternateBounds){var t=new mxRectangle(this.x,this.y,this.width,this.height);this.x=this.alternateBounds.x,this.y=this.alternateBounds.y,this.width=this.alternateBounds.width,this.height=this.alternateBounds.height,this.alternateBounds=t}},mxGeometry.prototype.getTerminalPoint=function(t){return t?this.sourcePoint:this.targetPoint},mxGeometry.prototype.setTerminalPoint=function(t,e){return e?this.sourcePoint=t:this.targetPoint=t,t},mxGeometry.prototype.translate=function(t,e){if(this.clone(),this.relative||(this.x+=t,this.y+=e),null!=this.sourcePoint&&(this.sourcePoint.x+=t,this.sourcePoint.y+=e),null!=this.targetPoint&&(this.targetPoint.x+=t,this.targetPoint.y+=e),this.TRANSLATE_CONTROL_POINTS&&null!=this.points)for(var n=this.points.length,i=0;n>i;i++){var o=this.points[i];null!=o&&(o.x+=t,o.y+=e)}};var mxCellPath={PATH_SEPARATOR:".",create:function(t){var e="";if(null!=t)for(var n=t.getParent();null!=n;)e=n.getIndex(t)+mxCellPath.PATH_SEPARATOR+e,t=n,n=t.getParent();return t=e.length,t>1&&(e=e.substring(0,t-1)),e},getParentPath:function(t){if(null!=t){var e=t.lastIndexOf(mxCellPath.PATH_SEPARATOR);if(e>=0)return t.substring(0,e);if(0<t.length)return""}return null},resolve:function(t,e){var n=t;if(null!=e)for(var i=e.split(mxCellPath.PATH_SEPARATOR),o=0;o<i.length;o++)n=n.getChildAt(parseInt(i[o]));return n},compare:function(t,e){for(var n=Math.min(t.length,e.length),i=0,o=0;n>o;o++)if(t[o]!=e[o]){0==t[o].length||0==e[o].length?i=t[o]==e[o]?0:t[o]>e[o]?1:-1:(n=parseInt(t[o]),o=parseInt(e[o]),i=n==o?0:n>o?1:-1);break}return 0==i&&(n=t.length,o=e.length,n!=o&&(i=n>o?1:-1)),i}},mxPerimeter={RectanglePerimeter:function(t,e,n,i){e=t.getCenterX();var o=t.getCenterY(),r=Math.atan2(n.y-o,n.x-e),s=new mxPoint(0,0),l=Math.PI,a=Math.PI/2-r,h=Math.atan2(t.height,t.width);return-l+h>r||r>l-h?(s.x=t.x,s.y=o-t.width*Math.tan(r)/2):-h>r?(s.y=t.y,s.x=e-t.height*Math.tan(a)/2):h>r?(s.x=t.x+t.width,s.y=o+t.width*Math.tan(r)/2):(s.y=t.y+t.height,s.x=e+t.height*Math.tan(a)/2),i&&(n.x>=t.x&&n.x<=t.x+t.width?s.x=n.x:n.y>=t.y&&n.y<=t.y+t.height&&(s.y=n.y),n.x<t.x?s.x=t.x:n.x>t.x+t.width&&(s.x=t.x+t.width),n.y<t.y?s.y=t.y:n.y>t.y+t.height&&(s.y=t.y+t.height)),s},EllipsePerimeter:function(t,e,n,i){var o=t.x,r=t.y,s=t.width/2,l=t.height/2,a=o+s,h=r+l;e=n.x,n=n.y;var d=parseInt(e-a),u=parseInt(n-h);if(0==d&&0!=u)return new mxPoint(a,h+l*u/Math.abs(u));if(0==d&&0==u)return new mxPoint(e,n);if(i){if(n>=r&&n<=r+t.height)return t=n-h,t=Math.sqrt(s*s*(1-t*t/(l*l)))||0,o>=e&&(t=-t),new mxPoint(a+t,n);if(e>=o&&e<=o+t.width)return t=e-a,t=Math.sqrt(l*l*(1-t*t/(s*s)))||0,r>=n&&(t=-t),new mxPoint(e,h+t)}return o=u/d,h-=o*a,r=s*s*o*o+l*l,t=-2*a*r,l=Math.sqrt(t*t-4*r*(s*s*o*o*a*a+l*l*a*a-s*s*l*l)),s=(-t+l)/(2*r),l=(-t-l)/(2*r),a=o*s+h,h=o*l+h,o=Math.sqrt(Math.pow(s-e,2)+Math.pow(a-n,2)),e=Math.sqrt(Math.pow(l-e,2)+Math.pow(h-n,2)),r=n=0,e>o?(n=s,r=a):(n=l,r=h),new mxPoint(n,r)},RhombusPerimeter:function(t,e,n,i){e=t.x;var o=t.y,r=t.width;t=t.height;var s=e+r/2,l=o+t/2,a=n.x;if(n=n.y,s==a)return l>n?new mxPoint(s,o):new mxPoint(s,o+t);if(l==n)return s>a?new mxPoint(e,l):new mxPoint(e+r,l);var h=s,d=l;return i&&(a>=e&&e+r>=a?h=a:n>=o&&o+t>=n&&(d=n)),s>a?l>n?mxUtils.intersection(a,n,h,d,s,o,e,l):mxUtils.intersection(a,n,h,d,s,o+t,e,l):l>n?mxUtils.intersection(a,n,h,d,s,o,e+r,l):mxUtils.intersection(a,n,h,d,s,o+t,e+r,l)},TrianglePerimeter:function(t,e,n,i){e=null!=e?e.style[mxConstants.STYLE_DIRECTION]:null;var o=e==mxConstants.DIRECTION_NORTH||e==mxConstants.DIRECTION_SOUTH,r=t.x,s=t.y,l=t.width;t=t.height;var a=r+l/2,h=s+t/2,d=new mxPoint(r,s),u=new mxPoint(r+l,h),c=new mxPoint(r,s+t);e==mxConstants.DIRECTION_NORTH?(d=c,u=new mxPoint(a,s),c=new mxPoint(r+l,s+t)):e==mxConstants.DIRECTION_SOUTH?(u=new mxPoint(a,s+t),c=new mxPoint(r+l,s)):e==mxConstants.DIRECTION_WEST&&(d=new mxPoint(r+l,s),u=new mxPoint(r,h),c=new mxPoint(r+l,s+t));var p=n.x-a,m=n.y-h,p=o?Math.atan2(p,m):Math.atan2(m,p),g=o?Math.atan2(l,t):Math.atan2(t,l),m=!1,m=e==mxConstants.DIRECTION_NORTH||e==mxConstants.DIRECTION_WEST?p>-g&&g>p:p<-Math.PI+g||p>Math.PI-g,g=null;return m?g=i&&(o&&n.x>=d.x&&n.x<=c.x||!o&&n.y>=d.y&&n.y<=c.y)?o?new mxPoint(n.x,d.y):new mxPoint(d.x,n.y):e==mxConstants.DIRECTION_NORTH?new mxPoint(r+l/2+t*Math.tan(p)/2,s+t):e==mxConstants.DIRECTION_SOUTH?new mxPoint(r+l/2-t*Math.tan(p)/2,s):e==mxConstants.DIRECTION_WEST?new mxPoint(r+l,s+t/2+l*Math.tan(p)/2):new mxPoint(r,s+t/2-l*Math.tan(p)/2):(i&&(i=new mxPoint(a,h),n.y>=s&&n.y<=s+t?(i.x=o?a:e==mxConstants.DIRECTION_WEST?r+l:r,i.y=n.y):n.x>=r&&n.x<=r+l&&(i.x=n.x,i.y=o?e==mxConstants.DIRECTION_NORTH?s+t:s:h),a=i.x,h=i.y),g=o&&n.x<=r+l/2||!o&&n.y<=s+t/2?mxUtils.intersection(n.x,n.y,a,h,d.x,d.y,u.x,u.y):mxUtils.intersection(n.x,n.y,a,h,u.x,u.y,c.x,c.y)),null==g&&(g=new mxPoint(a,h)),g}};mxPrintPreview.prototype.graph=null,mxPrintPreview.prototype.pageFormat=null,mxPrintPreview.prototype.scale=null,mxPrintPreview.prototype.border=0,mxPrintPreview.prototype.x0=0,mxPrintPreview.prototype.y0=0,mxPrintPreview.prototype.autoOrigin=!0,mxPrintPreview.prototype.printOverlays=!1,mxPrintPreview.prototype.borderColor=null,mxPrintPreview.prototype.title=null,mxPrintPreview.prototype.pageSelector=null,mxPrintPreview.prototype.wnd=null,mxPrintPreview.prototype.pageCount=0,mxPrintPreview.prototype.getWindow=function(){return this.wnd},mxPrintPreview.prototype.getDoctype=function(){var t="";return 8==document.documentMode&&(t='<meta http-equiv="X-UA-Compatible" content="IE=8">'),t},mxPrintPreview.prototype.open=function(t){var e=this.graph.cellRenderer.initializeOverlay,n=null;try{if(this.printOverlays&&(this.graph.cellRenderer.initializeOverlay=function(t,e){e.init(t.view.getDrawPane())}),null==this.wnd){this.wnd=window.open();var i=this.wnd.document,o=this.getDoctype();null!=o&&0<o.length&&i.writeln(o),i.writeln("<html>"),i.writeln("<head>"),this.writeHead(i,t),i.writeln("</head>"),i.writeln('<body class="mxPage">'),mxClient.link("stylesheet",mxClient.basePath+"/css/common.css",i),mxClient.IS_VML&&(i.namespaces.add("v","urn:schemas-microsoft-com:vml"),i.namespaces.add("o","urn:schemas-microsoft-com:office:office"),i.createStyleSheet().cssText="v\\:*{behavior:url(#default#VML)}o\\:*{behavior:url(#default#VML)}",mxClient.link("stylesheet",mxClient.basePath+"/css/explorer.css",i));var r=this.graph.getGraphBounds().clone(),s=this.graph.getView().getScale(),l=s/this.scale,a=this.graph.getView().getTranslate();this.autoOrigin||(this.x0=-a.x*this.scale,this.y0=-a.y*this.scale,r.width+=r.x,r.height+=r.y,r.x=0,this.border=r.y=0),r.width/=l,r.height/=l;var h=this.pageFormat.width-2*this.border,d=this.pageFormat.height-2*this.border,u=Math.max(1,Math.ceil((r.width+this.x0)/h)),c=Math.max(1,Math.ceil((r.height+this.y0)/d));this.pageCount=u*c;var p=mxUtils.bind(this,function(){if(this.pageSelector&&(c>1||u>1)){var t=this.createPageSelector(c,u);if(i.body.appendChild(t),mxClient.IS_IE){t.style.position="absolute";var e=function(){t.style.top=i.body.scrollTop+10+"px"};mxEvent.addListener(this.wnd,"scroll",function(){e()}),mxEvent.addListener(this.wnd,"resize",function(){e()})}}});t=function(t,e){if(null!=this.borderColor&&(t.style.borderColor=this.borderColor,t.style.borderStyle="solid",t.style.borderWidth="1px"),t.style.background="white",e&&(t.style.pageBreakAfter="always"),mxClient.IS_IE?(i.writeln(t.outerHTML),t.parentNode.removeChild(t)):(t.parentNode.removeChild(t),i.body.appendChild(t)),e){var n=i.createElement("hr");n.className="mxPageBreak",i.body.appendChild(n)}};var m=this.getCoverPages(this.pageFormat.width,this.pageFormat.height);if(null!=m)for(var g=0;g<m.length;g++)t(m[g],!0);for(var f=this.getAppendices(this.pageFormat.width,this.pageFormat.height),g=0;c>g;g++)for(var x=g*d/this.scale-this.y0/this.scale+(r.y-a.y*s)/s,m=0;u>m;m++){if(null==this.wnd)return null;var C=m*h/this.scale-this.x0/this.scale+(r.x-a.x*s)/s,E=g*u+m+1,n=this.renderPage(this.pageFormat.width,this.pageFormat.height,mxUtils.bind(this,function(t){this.addGraphFragment(-C,-x,this.scale,E,t)}));n.setAttribute("id","mxPage-"+E),t(n,null!=f||c-1>g||u-1>m)}if(null!=f)for(g=0;g<f.length;g++)t(f[g],g<f.length);i.writeln("</body>"),i.writeln("</html>"),i.close(),p(),mxEvent.release(i.body)}this.wnd.focus()}catch(y){null!=n&&null!=n.parentNode&&n.parentNode.removeChild(n)}finally{this.graph.cellRenderer.initializeOverlay=e}return this.wnd},mxPrintPreview.prototype.writeHead=function(t,e){null!=this.title&&t.writeln("<title>"+this.title+"</title>"),t.writeln('<style type="text/css">'),t.writeln("@media print {"),t.writeln("  table.mxPageSelector { display: none; }"),t.writeln("  hr.mxPageBreak { display: none; }"),t.writeln("}"),t.writeln("@media screen {"),t.writeln("  table.mxPageSelector { position: fixed; right: 10px; top: 10px;font-family: Arial; font-size:10pt; border: solid 1px darkgray;background: white; border-collapse:collapse; }"),t.writeln("  table.mxPageSelector td { border: solid 1px gray; padding:4px; }"),t.writeln("  body.mxPage { background: gray; }"),t.writeln("}"),null!=e&&t.writeln(e),t.writeln("</style>")},mxPrintPreview.prototype.createPageSelector=function(t,e){var n=this.wnd.document,i=n.createElement("table");i.className="mxPageSelector",i.setAttribute("border","0");for(var o=n.createElement("tbody"),r=0;t>r;r++){for(var s=n.createElement("tr"),l=0;e>l;l++){var a=r*e+l+1,h=n.createElement("td");if(!mxClient.IS_NS||mxClient.IS_SF||mxClient.IS_GC){var d=n.createElement("a");d.setAttribute("href","#mxPage-"+a),mxUtils.write(d,a,n),h.appendChild(d)}else mxUtils.write(h,a,n);s.appendChild(h)}o.appendChild(s)}return i.appendChild(o),i},mxPrintPreview.prototype.renderPage=function(t,e,n){var i=document.createElement("div");try{i.style.width=t+"px",i.style.height=e+"px",i.style.overflow="hidden",i.style.pageBreakInside="avoid",i.style.position="relative";var o=document.createElement("div");o.style.top=this.border+"px",o.style.left=this.border+"px",o.style.width=t-2*this.border+"px",o.style.height=e-2*this.border+"px",o.style.overflow="hidden",this.graph.dialect==mxConstants.DIALECT_VML&&(o.style.position="absolute"),i.appendChild(o),document.body.appendChild(i),n(o)}catch(r){throw i.parentNode.removeChild(i),r}return i},mxPrintPreview.prototype.getRoot=function(){var t=this.graph.view.currentRoot;return null==t&&(t=this.graph.getModel().getRoot()),t},mxPrintPreview.prototype.addGraphFragment=function(t,e,n,i,o){i=this.graph.getView();var r=this.graph.container;this.graph.container=o;var s=i.getCanvas(),l=i.getBackgroundPane(),a=i.getDrawPane(),h=i.getOverlayPane();this.graph.dialect==mxConstants.DIALECT_SVG?i.createSvg():this.graph.dialect==mxConstants.DIALECT_VML?i.createVml():i.createHtml();var d=i.isEventsEnabled();i.setEventsEnabled(!1);var u=this.graph.isEnabled();this.graph.setEnabled(!1);var c=i.getTranslate();i.translate=new mxPoint(t,e),t=null;try{var p=[this.getRoot()];t=new mxTemporaryCellStates(i,n,p)}finally{if(mxClient.IS_IE)i.overlayPane.innerHTML="";else for(n=o.firstChild;null!=n;)p=n.nextSibling,e=n.nodeName.toLowerCase(),"svg"==e?(n.setAttribute("width",parseInt(o.style.width)),n.setAttribute("height",parseInt(o.style.height))):"default"!=n.style.cursor&&"table"!=e&&n.parentNode.removeChild(n),n=p;i.overlayPane.parentNode.removeChild(i.overlayPane),this.graph.setEnabled(u),this.graph.container=r,i.canvas=s,i.backgroundPane=l,i.drawPane=a,i.overlayPane=h,i.translate=c,t.destroy(),i.setEventsEnabled(d)}},mxPrintPreview.prototype.getCoverPages=function(){return null},mxPrintPreview.prototype.getAppendices=function(){return null},mxPrintPreview.prototype.print=function(){var t=this.open();null!=t&&t.print()},mxPrintPreview.prototype.close=function(){null!=this.wnd&&(this.wnd.close(),this.wnd=null)},mxStylesheet.prototype.createDefaultVertexStyle=function(){var t={};return t[mxConstants.STYLE_SHAPE]=mxConstants.SHAPE_RECTANGLE,t[mxConstants.STYLE_PERIMETER]=mxPerimeter.RectanglePerimeter,t[mxConstants.STYLE_VERTICAL_ALIGN]=mxConstants.ALIGN_MIDDLE,t[mxConstants.STYLE_ALIGN]=mxConstants.ALIGN_CENTER,t[mxConstants.STYLE_FILLCOLOR]="#C3D9FF",t[mxConstants.STYLE_STROKECOLOR]="#6482B9",t[mxConstants.STYLE_FONTCOLOR]="#774400",t},mxStylesheet.prototype.createDefaultEdgeStyle=function(){var t={};return t[mxConstants.STYLE_SHAPE]=mxConstants.SHAPE_CONNECTOR,t[mxConstants.STYLE_ENDARROW]=mxConstants.ARROW_CLASSIC,t[mxConstants.STYLE_VERTICAL_ALIGN]=mxConstants.ALIGN_MIDDLE,t[mxConstants.STYLE_ALIGN]=mxConstants.ALIGN_CENTER,t[mxConstants.STYLE_STROKECOLOR]="#6482B9",t[mxConstants.STYLE_FONTCOLOR]="#446299",t},mxStylesheet.prototype.putDefaultVertexStyle=function(t){this.putCellStyle("defaultVertex",t)},mxStylesheet.prototype.putDefaultEdgeStyle=function(t){this.putCellStyle("defaultEdge",t)},mxStylesheet.prototype.getDefaultVertexStyle=function(){return this.styles.defaultVertex},mxStylesheet.prototype.getDefaultEdgeStyle=function(){return this.styles.defaultEdge},mxStylesheet.prototype.putCellStyle=function(t,e){this.styles[t]=e},mxStylesheet.prototype.getCellStyle=function(t,e){var n=e;if(null!=t&&0<t.length)for(var i=t.split(";"),n=null!=n&&";"!=t.charAt(0)?mxUtils.clone(n):{},o=0;o<i.length;o++){var r=i[o],s=r.indexOf("=");if(s>=0){var l=r.substring(0,s),r=r.substring(s+1);r==mxConstants.NONE?delete n[l]:n[l]=mxUtils.isNumeric(r)?parseFloat(r):r}else if(r=this.styles[r],null!=r)for(l in r)n[l]=r[l]}return n},mxCellState.prototype=new mxRectangle,mxCellState.prototype.constructor=mxCellState,mxCellState.prototype.view=null,mxCellState.prototype.cell=null,mxCellState.prototype.style=null,mxCellState.prototype.invalid=!0,mxCellState.prototype.invalidOrder=!1,mxCellState.prototype.orderChanged=!1,mxCellState.prototype.origin=null,mxCellState.prototype.absolutePoints=null,mxCellState.prototype.absoluteOffset=null,mxCellState.prototype.visibleSourceState=null,mxCellState.prototype.visibleTargetState=null,mxCellState.prototype.terminalDistance=0,mxCellState.prototype.length=0,mxCellState.prototype.segments=null,mxCellState.prototype.shape=null,mxCellState.prototype.text=null,mxCellState.prototype.getPerimeterBounds=function(t,e){if(t=t||0,e=null!=e?e:new mxRectangle(this.x,this.y,this.width,this.height),null!=this.shape&&null!=this.shape.stencil){var n=this.shape.stencil.computeAspect(this.style,e.x,e.y,e.width,e.height);e.x=n.x,e.y=n.y,e.width=this.shape.stencil.w0*n.width,e.height=this.shape.stencil.h0*n.height}return 0!=t&&e.grow(t),e},mxCellState.prototype.setAbsoluteTerminalPoint=function(t,e){e?(null==this.absolutePoints&&(this.absolutePoints=[]),0==this.absolutePoints.length?this.absolutePoints.push(t):this.absolutePoints[0]=t):null==this.absolutePoints?(this.absolutePoints=[],this.absolutePoints.push(null),this.absolutePoints.push(t)):1==this.absolutePoints.length?this.absolutePoints.push(t):this.absolutePoints[this.absolutePoints.length-1]=t},mxCellState.prototype.setCursor=function(t){null!=this.shape&&this.shape.setCursor(t),null!=this.text&&this.text.setCursor(t)},mxCellState.prototype.getVisibleTerminal=function(t){return t=this.getVisibleTerminalState(t),null!=t?t.cell:null},mxCellState.prototype.getVisibleTerminalState=function(t){return t?this.visibleSourceState:this.visibleTargetState},mxCellState.prototype.setVisibleTerminalState=function(t,e){e?this.visibleSourceState=t:this.visibleTargetState=t},mxCellState.prototype.destroy=function(){this.view.graph.cellRenderer.destroy(this)},mxCellState.prototype.clone=function(){var t=new mxCellState(this.view,this.cell,this.style);if(null!=this.absolutePoints){t.absolutePoints=[];for(var e=0;e<this.absolutePoints.length;e++)t.absolutePoints[e]=this.absolutePoints[e].clone()}return null!=this.origin&&(t.origin=this.origin.clone()),null!=this.absoluteOffset&&(t.absoluteOffset=this.absoluteOffset.clone()),null!=this.boundingBox&&(t.boundingBox=this.boundingBox.clone()),t.terminalDistance=this.terminalDistance,t.segments=this.segments,t.length=this.length,t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},mxGraphSelectionModel.prototype=new mxEventSource,mxGraphSelectionModel.prototype.constructor=mxGraphSelectionModel,mxGraphSelectionModel.prototype.doneResource="none"!=mxClient.language?"done":"",mxGraphSelectionModel.prototype.updatingSelectionResource="none"!=mxClient.language?"updatingSelection":"",mxGraphSelectionModel.prototype.graph=null,mxGraphSelectionModel.prototype.singleSelection=!1,mxGraphSelectionModel.prototype.isSingleSelection=function(){return this.singleSelection},mxGraphSelectionModel.prototype.setSingleSelection=function(t){this.singleSelection=t},mxGraphSelectionModel.prototype.isSelected=function(t){return null!=t?0<=mxUtils.indexOf(this.cells,t):!1},mxGraphSelectionModel.prototype.isEmpty=function(){return 0==this.cells.length
},mxGraphSelectionModel.prototype.clear=function(){this.changeSelection(null,this.cells)},mxGraphSelectionModel.prototype.setCell=function(t){null!=t&&this.setCells([t])},mxGraphSelectionModel.prototype.setCells=function(t){if(null!=t){this.singleSelection&&(t=[this.getFirstSelectableCell(t)]);for(var e=[],n=0;n<t.length;n++)this.graph.isCellSelectable(t[n])&&e.push(t[n]);this.changeSelection(e,this.cells)}},mxGraphSelectionModel.prototype.getFirstSelectableCell=function(t){if(null!=t)for(var e=0;e<t.length;e++)if(this.graph.isCellSelectable(t[e]))return t[e];return null},mxGraphSelectionModel.prototype.addCell=function(t){null!=t&&this.addCells([t])},mxGraphSelectionModel.prototype.addCells=function(t){if(null!=t){var e=null;this.singleSelection&&(e=this.cells,t=[this.getFirstSelectableCell(t)]);for(var n=[],i=0;i<t.length;i++)!this.isSelected(t[i])&&this.graph.isCellSelectable(t[i])&&n.push(t[i]);this.changeSelection(n,e)}},mxGraphSelectionModel.prototype.removeCell=function(t){null!=t&&this.removeCells([t])},mxGraphSelectionModel.prototype.removeCells=function(t){if(null!=t){for(var e=[],n=0;n<t.length;n++)this.isSelected(t[n])&&e.push(t[n]);this.changeSelection(null,e)}},mxGraphSelectionModel.prototype.changeSelection=function(t,e){if(null!=t&&0<t.length&&null!=t[0]||null!=e&&0<e.length&&null!=e[0]){var n=new mxSelectionChange(this,t,e);n.execute();var i=new mxUndoableEdit(this,!1);i.add(n),this.fireEvent(new mxEventObject(mxEvent.UNDO,"edit",i))}},mxGraphSelectionModel.prototype.cellAdded=function(t){null!=t&&!this.isSelected(t)&&this.cells.push(t)},mxGraphSelectionModel.prototype.cellRemoved=function(t){null!=t&&(t=mxUtils.indexOf(this.cells,t),t>=0&&this.cells.splice(t,1))},mxSelectionChange.prototype.execute=function(){var t=mxLog.enter("mxSelectionChange.execute");if(window.status=mxResources.get(this.selectionModel.updatingSelectionResource)||this.selectionModel.updatingSelectionResource,null!=this.removed)for(var e=0;e<this.removed.length;e++)this.selectionModel.cellRemoved(this.removed[e]);if(null!=this.added)for(e=0;e<this.added.length;e++)this.selectionModel.cellAdded(this.added[e]);e=this.added,this.added=this.removed,this.removed=e,window.status=mxResources.get(this.selectionModel.doneResource)||this.selectionModel.doneResource,mxLog.leave("mxSelectionChange.execute",t),this.selectionModel.fireEvent(new mxEventObject(mxEvent.CHANGE,"added",this.added,"removed",this.removed))},mxCellEditor.prototype.graph=null,mxCellEditor.prototype.textarea=null,mxCellEditor.prototype.editingCell=null,mxCellEditor.prototype.trigger=null,mxCellEditor.prototype.modified=!1,mxCellEditor.prototype.autoSize=!0,mxCellEditor.prototype.emptyLabelText="",mxCellEditor.prototype.textNode="",mxCellEditor.prototype.init=function(){this.textarea=document.createElement("textarea"),this.textarea.className="mxCellEditor",this.textarea.id="mxCellEditor",this.textarea.style.position="absolute",this.textarea.style.overflow="auto",this.textarea.setAttribute("cols","20"),this.textarea.setAttribute("rows","4"),mxClient.IS_NS&&(this.textarea.style.resize="none"),mxEvent.addListener(this.textarea,"blur",mxUtils.bind(this,this.focusLost)),mxEvent.addListener(this.textarea,"keydown",mxUtils.bind(this,function(t){mxEvent.isConsumed(t)||(113==t.keyCode||this.graph.isEnterStopsCellEditing()&&13==t.keyCode&&!mxEvent.isControlDown(t)&&!mxEvent.isShiftDown(t)?(this.graph.stopEditing(!1),mxEvent.consume(t)):27==t.keyCode?(this.graph.stopEditing(!0),mxEvent.consume(t)):(this.clearOnChange&&(this.clearOnChange=!1,this.textarea.value=""),this.setModified(!0)))})),this.changeHandler=mxUtils.bind(this,function(){null!=this.editingCell&&null==this.graph.getView().getState(this.editingCell)&&this.stopEditing(!0)}),this.graph.getModel().addListener(mxEvent.CHANGE,this.changeHandler),mxEvent.addListener(this.textarea,"keypress",mxUtils.bind(this,function(t){this.autoSize&&!mxEvent.isConsumed(t)&&setTimeout(mxUtils.bind(this,function(){this.resize()}),0)}))},mxCellEditor.prototype.resize=function(){if(null!=this.textDiv){var t=this.graph.getView().getState(this.editingCell);if(null==t)this.stopEditing(!0);else{var e=this.graph.isLabelClipped(t.cell),n=this.graph.isWrapping(t.cell);if(this.graph.getModel().isEdge(t.cell))this.bounds.x=t.absoluteOffset.x,this.bounds.y=t.absoluteOffset.y,this.bounds.width=0,this.bounds.height=0;else if(null!=this.bounds){this.bounds.x=t.x,this.bounds.y=t.y,this.bounds.width=t.width,this.bounds.height=t.height;var i=mxUtils.getValue(t.style,mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_CENTER);i==mxConstants.ALIGN_LEFT?this.bounds.x-=t.width:i==mxConstants.ALIGN_RIGHT&&(this.bounds.x+=t.width),i=mxUtils.getValue(t.style,mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_MIDDLE),i==mxConstants.ALIGN_TOP?this.bounds.y-=t.height:i==mxConstants.ALIGN_BOTTOM&&(this.bounds.y+=t.height)}i=this.textarea.value,("\n"==i.charAt(i.length-1)||""==i)&&(i+="&nbsp;"),i=mxUtils.htmlEntities(i,!1),n?(this.textDiv.style.whiteSpace="normal",this.textDiv.style.width=this.bounds.width+"px"):i=i.replace(/ /g,"&nbsp;"),i=i.replace(/\n/g,"<br/>"),this.textDiv.innerHTML=i;var i=this.textDiv.offsetWidth+30,o=this.textDiv.offsetHeight+16,i=Math.max(i,40),o=Math.max(o,20);e&&(i=Math.min(this.bounds.width-4,i),o=Math.min(this.bounds.height,o));var r=null!=t.text?t.text.margin:null;null==r&&(r=mxUtils.getValue(t.style,mxConstants.STYLE_ALIGN,mxConstants.ALIGN_CENTER),t=mxUtils.getValue(t.style,mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_MIDDLE),r=mxUtils.getAlignmentAsPoint(r,t)),null!=r&&((e||!n)&&(this.textarea.style.left=Math.max(0,Math.round(this.bounds.x-r.x*this.bounds.width+r.x*i)-3)+"px"),this.textarea.style.top=Math.max(0,Math.round(this.bounds.y-r.y*this.bounds.height+r.y*o)+4)+"px"),(e||!n)&&(this.textarea.style.width=i+"px"),this.textarea.style.height=o+"px"}}},mxCellEditor.prototype.isModified=function(){return this.modified},mxCellEditor.prototype.setModified=function(t){this.modified=t},mxCellEditor.prototype.focusLost=function(){this.stopEditing(!this.graph.isInvokesStopCellEditing())},mxCellEditor.prototype.startEditing=function(t,e){null==this.textarea&&this.init(),this.stopEditing(!0);{var n=this.graph.getView().getState(t);n.text.node}if(null!=n){this.editingCell=t,this.trigger=e,this.textNode=null,null!=n.text&&this.isHideLabel(n)&&(this.textNode=n.text.node,this.textNode.style.visibility="hidden");var i=this.graph.getView().scale,i=mxUtils.getValue(n.style,mxConstants.STYLE_FONTSIZE,mxConstants.DEFAULT_FONTSIZE)*i,o=mxUtils.getValue(n.style,mxConstants.STYLE_FONTFAMILY,mxConstants.DEFAULT_FONTFAMILY),r=mxUtils.getValue(n.style,mxConstants.STYLE_FONTCOLOR,"black"),s=mxUtils.getValue(n.style,mxConstants.STYLE_ALIGN,mxConstants.ALIGN_LEFT),l=(mxUtils.getValue(n.style,mxConstants.STYLE_FONTSTYLE,0)&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD,a=(mxUtils.getValue(n.style,mxConstants.STYLE_FONTSTYLE,0)&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC,h=(mxUtils.getValue(n.style,mxConstants.STYLE_FONTSTYLE,0)&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE;if(this.textarea.style.fontSize=Math.round(i)+"px",this.textarea.style.lineHeight=Math.round(i*mxConstants.LINE_HEIGHT)+"px",this.textarea.style.fontFamily=o,this.textarea.style.textAlign=s,this.textarea.style.color=r,this.textarea.style.fontWeight=l?"bold":"normal",this.textarea.style.fontStyle=a?"italic":"",this.textarea.style.textDecoration=h?"underline":"",this.textarea.style.overflow="auto",this.textarea.style.outline="none",this.bounds=i=this.getEditorBounds(n),this.textarea.style.left=i.x+"px",this.textarea.style.top=i.y+"px",this.textarea.style.width=i.width+"px",this.textarea.style.height=i.height+"px",this.textarea.style.zIndex=5,n=this.getInitialValue(n,e),null==n||0==n.length?(n=this.getEmptyLabelText(),this.clearOnChange=!0):this.clearOnChange=!1,this.setModified(!1),this.textarea.value="",this.graph.container.appendChild(this.textarea),null!=n.match(".*\\<[^>]+>.*")){this.textarea.value=n;var d={skin:"moono",extraPlugins:"image",toolbar:[["Bold","Underline","Strike","Link","Unlink"],["Cut","Copy","Paste","PasteText","PasteFromWord"],["Undo","Redo"],["Source"]],autoGrow_onStartup:!0,width:this.textarea.style.width||200,removePlugins:"elementspath,liststyle,resize",disableNativeSpellChecker:!1,startupFocus:!0,allowedContent:!0},u=this;this.$cketa=$(this.textarea),this.$cketa.ckeditor(d);var c=this.$cketa.ckeditorGet();c.on("instanceReady",function(t){this.dataProcessor.writer.setRules("p",{indent:!1,breakBeforeOpen:!1,breakBeforeClose:!1,breakAfterClose:!1});var e=t.editor.container.$;e.style.position="absolute",e.style.width=i.width+"px",e.style.height=i.height+44+"px",e.style.left=i.x-2+"px",e.style.top=i.y-113+"px",e.style.zIndex=5;var n=this;t.editor.on("blur",mxUtils.bind(u,function(){n.destroy(),this.modified=1,this.textarea.focus(),this.textarea.blur()}))})}else this.textarea.value=n;"none"!=this.textarea.style.display&&this.autoSize&&(this.textDiv=this.createTextDiv(),document.body.appendChild(this.textDiv))}},mxCellEditor.prototype.createTextDiv=function(){var t=document.createElement("div"),e=t.style;return e.position="absolute",e.whiteSpace="nowrap",e.visibility="hidden",e.display=mxClient.IS_QUIRKS?"inline":"inline-block",e.zoom="1",e.verticalAlign="top",e.lineHeight=this.textarea.style.lineHeight,e.fontSize=this.textarea.style.fontSize,e.fontFamily=this.textarea.style.fontFamily,e.fontWeight=this.textarea.style.fontWeight,e.textAlign=this.textarea.style.textAlign,e.fontStyle=this.textarea.style.fontStyle,e.textDecoration=this.textarea.style.textDecoration,t},mxCellEditor.prototype.stopEditing=function(t){null!=this.editingCell&&(null!=this.textNode&&(this.textNode.style.visibility="visible",this.textNode=null),!t&&this.isModified()&&this.graph.labelChanged(this.editingCell,this.getCurrentValue(),this.trigger),null!=this.textDiv&&(document.body.removeChild(this.textDiv),this.textDiv=null),this.bounds=this.trigger=this.editingCell=null,this.textarea.blur(),this.textarea.parentNode?this.textarea.parentNode.removeChild(this.textarea):delete this.textarea)},mxCellEditor.prototype.getInitialValue=function(t,e){return this.graph.getEditingValue(t.cell,e)},mxCellEditor.prototype.getCurrentValue=function(){return this.textarea.value.replace(/\r/g,"")},mxCellEditor.prototype.isHideLabel=function(){return!0},mxCellEditor.prototype.getMinimumSize=function(t){var e=this.graph.getView().scale;return new mxRectangle(0,0,null==t.text?30:t.text.size*e+20,"left"==this.textarea.style.textAlign?120:40)},mxCellEditor.prototype.getEditorBounds=function(t){var e=this.graph.getModel().isEdge(t.cell),n=this.graph.getView().scale,i=this.getMinimumSize(t),o=i.width,i=i.height,r=parseInt(t.style[mxConstants.STYLE_SPACING]||2)*n,s=parseInt(t.style[mxConstants.STYLE_SPACING_TOP]||0)*n+r,l=parseInt(t.style[mxConstants.STYLE_SPACING_RIGHT]||0)*n+r,a=parseInt(t.style[mxConstants.STYLE_SPACING_BOTTOM]||0)*n+r,n=parseInt(t.style[mxConstants.STYLE_SPACING_LEFT]||0)*n+r,l=new mxRectangle(t.x,t.y,Math.max(o,t.width-n-l),Math.max(i,t.height-s-a));return e?(l.x=t.absoluteOffset.x,l.y=t.absoluteOffset.y,null!=t.text&&null!=t.text.boundingBox&&(0<t.text.boundingBox.x&&(l.x=t.text.boundingBox.x),0<t.text.boundingBox.y&&(l.y=t.text.boundingBox.y))):null!=t.text&&null!=t.text.boundingBox&&(l.x=Math.min(l.x,t.text.boundingBox.x),l.y=Math.min(l.y,t.text.boundingBox.y)),l.x+=n,l.y+=s,null!=t.text&&null!=t.text.boundingBox&&(e?(l.width=Math.max(o,t.text.boundingBox.width),l.height=Math.max(i,t.text.boundingBox.height)):(l.width=Math.max(l.width,t.text.boundingBox.width),l.height=Math.max(l.height,t.text.boundingBox.height))),this.graph.getModel().isVertex(t.cell)&&(e=mxUtils.getValue(t.style,mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_CENTER),e==mxConstants.ALIGN_LEFT?l.x-=t.width:e==mxConstants.ALIGN_RIGHT&&(l.x+=t.width),e=mxUtils.getValue(t.style,mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_MIDDLE),e==mxConstants.ALIGN_TOP?l.y-=t.height:e==mxConstants.ALIGN_BOTTOM&&(l.y+=t.height)),l},mxCellEditor.prototype.getEmptyLabelText=function(){return this.emptyLabelText},mxCellEditor.prototype.getEditingCell=function(){return this.editingCell},mxCellEditor.prototype.destroy=function(){null!=this.textarea&&(mxEvent.release(this.textarea),null!=this.textarea.parentNode&&this.textarea.parentNode.removeChild(this.textarea),this.textarea=null,null!=this.changeHandler&&(this.graph.getModel().removeListener(this.changeHandler),this.changeHandler=null))},mxCellRenderer.prototype.defaultEdgeShape=mxConnector,mxCellRenderer.prototype.defaultVertexShape=mxRectangleShape,mxCellRenderer.prototype.defaultTextShape=mxText,mxCellRenderer.prototype.legacyControlPosition=!0,mxCellRenderer.prototype.defaultShapes={},mxCellRenderer.registerShape=function(t,e){mxCellRenderer.prototype.defaultShapes[t]=e},mxCellRenderer.registerShape(mxConstants.SHAPE_RECTANGLE,mxRectangleShape),mxCellRenderer.registerShape(mxConstants.SHAPE_ELLIPSE,mxEllipse),mxCellRenderer.registerShape(mxConstants.SHAPE_RHOMBUS,mxRhombus),mxCellRenderer.registerShape(mxConstants.SHAPE_CYLINDER,mxCylinder),mxCellRenderer.registerShape(mxConstants.SHAPE_CONNECTOR,mxConnector),mxCellRenderer.registerShape(mxConstants.SHAPE_ACTOR,mxActor),mxCellRenderer.registerShape(mxConstants.SHAPE_TRIANGLE,mxTriangle),mxCellRenderer.registerShape(mxConstants.SHAPE_HEXAGON,mxHexagon),mxCellRenderer.registerShape(mxConstants.SHAPE_CLOUD,mxCloud),mxCellRenderer.registerShape(mxConstants.SHAPE_LINE,mxLine),mxCellRenderer.registerShape(mxConstants.SHAPE_ARROW,mxArrow),mxCellRenderer.registerShape(mxConstants.SHAPE_DOUBLE_ELLIPSE,mxDoubleEllipse),mxCellRenderer.registerShape(mxConstants.SHAPE_SWIMLANE,mxSwimlane),mxCellRenderer.registerShape(mxConstants.SHAPE_IMAGE,mxImageShape),mxCellRenderer.registerShape(mxConstants.SHAPE_LABEL,mxLabel),mxCellRenderer.prototype.initialize=function(t,e){var n=t.view.graph.getModel();null!=t.view.graph.container&&null==t.shape&&t.cell!=t.view.currentRoot&&(n.isVertex(t.cell)||n.isEdge(t.cell))&&(this.createShape(t),null==t.shape||null!=e&&!e||(this.initializeShape(t),t.view.graph.ordered||n.isEdge(t.cell)?t.invalidOrder=!0:t.view.graph.keepEdgesInForeground&&null!=this.firstEdge&&(this.firstEdge.parentNode==t.shape.node.parentNode?this.insertState(t,this.firstEdge):this.firstEdge=null),t.shape.scale=t.view.scale,this.createCellOverlays(t),this.installListeners(t)))},mxCellRenderer.prototype.initializeShape=function(t){t.shape.init(t.view.getDrawPane())},mxCellRenderer.prototype.getPreviousStateInContainer=function(t,e){for(var n=null,i=t.view.graph,o=i.getModel(),r=t.cell,s=o.getParent(r);null!=s&&null==n;)n=this.findPreviousStateInContainer(i,s,r,e),r=s,s=o.getParent(r);return n},mxCellRenderer.prototype.findPreviousStateInContainer=function(t,e,n,i){var o=null,r=t.getModel();for(n=null!=n?e.getIndex(n)-1:r.getChildCount(e)-1;n>=0&&null==o;n--)o=this.findPreviousStateInContainer(t,r.getChildAt(e,n),null,i);return null!=o||(o=t.view.getState(e),null==o||null!=o.shape&&null!=o.shape.node&&o.shape.node.parentNode==i)||(o=null),o},mxCellRenderer.prototype.order=function(t){var e=t.shape.node.parentNode,n=this.getPreviousStateInContainer(t,e),i=e.firstChild;null!=n&&(i=n.shape.node,null!=n.text&&null!=n.text.node&&n.text.node.parentNode==e&&(i=n.text.node),i=i.nextSibling),this.insertState(t,i)},mxCellRenderer.prototype.orderEdge=function(t){var e=t.view,n=e.graph.getModel();if(e.graph.keepEdgesInForeground)(null==this.firstEdge||null==this.firstEdge.parentNode||this.firstEdge.parentNode!=t.shape.node.parentNode)&&(this.firstEdge=t.shape.node);else if(e.graph.keepEdgesInBackground){var i=t.shape.node,o=i.parentNode,n=n.getParent(t.cell),e=e.getState(n),o=null!=e&&null!=e.shape&&null!=e.shape.node?e.shape.node.nextSibling:o.firstChild;null!=o&&o!=i&&this.insertState(t,o)}},mxCellRenderer.prototype.insertState=function(t,e){t.shape.node.parentNode.insertBefore(t.shape.node,e),null!=t.text&&null!=t.text.node&&t.text.node.parentNode==t.shape.node.parentNode&&t.shape.node.parentNode.insertBefore(t.text.node,t.shape.node.nextSibling)},mxCellRenderer.prototype.createShape=function(t){if(null!=t.style){var e=mxStencilRegistry.getStencil(t.style[mxConstants.STYLE_SHAPE]);null!=e?t.shape=new mxShape(e):(e=this.getShapeConstructor(t),t.shape=new e),t.shape.points=t.absolutePoints,t.shape.bounds=new mxRectangle(t.x,t.y,t.width,t.height),t.shape.dialect=t.view.graph.dialect,this.configureShape(t)}},mxCellRenderer.prototype.getShape=function(t){return null!=t?mxCellRenderer.prototype.defaultShapes[t]:null},mxCellRenderer.prototype.getShapeConstructor=function(t){var e=this.getShape(t.style[mxConstants.STYLE_SHAPE]);return null==e&&(e=t.view.graph.getModel().isEdge(t.cell)?this.defaultEdgeShape:this.defaultVertexShape),e},mxCellRenderer.prototype.configureShape=function(t){t.shape.apply(t),t.shape.image=t.view.graph.getImage(t),t.shape.indicatorShape=this.getShape(t.view.graph.getIndicatorShape(t)),t.shape.indicatorColor=t.view.graph.getIndicatorColor(t),t.shape.indicatorGradientColor=t.view.graph.getIndicatorGradientColor(t),t.shape.indicatorDirection=t.style[mxConstants.STYLE_INDICATOR_DIRECTION],t.shape.indicatorImage=t.view.graph.getIndicatorImage(t),this.postConfigureShape(t)},mxCellRenderer.prototype.postConfigureShape=function(t){null!=t.shape&&(this.resolveColor(t,"indicatorColor",mxConstants.STYLE_FILLCOLOR),this.resolveColor(t,"indicatorGradientColor",mxConstants.STYLE_GRADIENTCOLOR),this.resolveColor(t,"fill",mxConstants.STYLE_FILLCOLOR),this.resolveColor(t,"stroke",mxConstants.STYLE_STROKECOLOR),this.resolveColor(t,"gradient",mxConstants.STYLE_GRADIENTCOLOR))},mxCellRenderer.prototype.resolveColor=function(t,e,n){var i=t.shape[e],o=t.view.graph,r=null;"inherit"==i?r=o.model.getParent(t.cell):"swimlane"==i?(r=null!=o.model.getTerminal(t.cell,!1)?o.model.getTerminal(t.cell,!1):t.cell,r=o.getSwimlane(r),n=o.swimlaneIndicatorColorAttribute):"indicated"==i&&(t.shape[e]=t.shape.indicatorColor),null!=r&&(i=o.getView().getState(r),t.shape[e]=null,null!=i&&(t.shape[e]=null!=i.shape&&"indicatorColor"!=e?i.shape[e]:i.style[n]))},mxCellRenderer.prototype.getLabelValue=function(t){return t.view.graph.getLabel(t.cell)},mxCellRenderer.prototype.createLabel=function(t,e){var n=t.view.graph;if(n.getModel().isEdge(t.cell),0<t.style[mxConstants.STYLE_FONTSIZE]||null==t.style[mxConstants.STYLE_FONTSIZE]){var i=n.isHtmlLabel(t.cell)||null!=e&&mxUtils.isNode(e);t.text=new this.defaultTextShape(e,new mxRectangle,t.style[mxConstants.STYLE_ALIGN]||mxConstants.ALIGN_CENTER,n.getVerticalAlign(t),t.style[mxConstants.STYLE_FONTCOLOR],t.style[mxConstants.STYLE_FONTFAMILY],t.style[mxConstants.STYLE_FONTSIZE],t.style[mxConstants.STYLE_FONTSTYLE],t.style[mxConstants.STYLE_SPACING],t.style[mxConstants.STYLE_SPACING_TOP],t.style[mxConstants.STYLE_SPACING_RIGHT],t.style[mxConstants.STYLE_SPACING_BOTTOM],t.style[mxConstants.STYLE_SPACING_LEFT],t.style[mxConstants.STYLE_HORIZONTAL],t.style[mxConstants.STYLE_LABEL_BACKGROUNDCOLOR],t.style[mxConstants.STYLE_LABEL_BORDERCOLOR],n.isWrapping(t.cell)&&n.isHtmlLabel(t.cell),n.isLabelClipped(t.cell),t.style[mxConstants.STYLE_OVERFLOW],t.style[mxConstants.STYLE_LABEL_PADDING]),t.text.opacity=mxUtils.getValue(t.style,mxConstants.STYLE_TEXT_OPACITY,100),t.text.dialect=i?mxConstants.DIALECT_STRICTHTML:t.view.graph.dialect,t.text.state=t,this.initializeLabel(t);var o=!1,r=function(e){var i=t;return(mxClient.IS_TOUCH||o)&&(i=mxEvent.getClientX(e),e=mxEvent.getClientY(e),e=mxUtils.convertPoint(n.container,i,e),i=n.view.getState(n.getCellAt(e.x,e.y))),i};mxEvent.addGestureListeners(t.text.node,mxUtils.bind(this,function(e){this.isLabelEvent(t,e)&&(n.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(e,t)),o=n.dialect!=mxConstants.DIALECT_SVG&&"IMG"==mxEvent.getSource(e).nodeName)}),mxUtils.bind(this,function(e){this.isLabelEvent(t,e)&&n.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(e,r(e)))}),mxUtils.bind(this,function(e){this.isLabelEvent(t,e)&&(n.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(e,r(e))),o=!1)})),mxEvent.addListener(t.text.node,"dblclick",mxUtils.bind(this,function(e){this.isLabelEvent(t,e)&&(n.dblClick(e,t.cell),mxEvent.consume(e))}))}},mxCellRenderer.prototype.initializeLabel=function(t){var e=t.view.graph;t.text.dialect!=mxConstants.DIALECT_SVG&&(mxClient.IS_SVG&&mxClient.NO_FO?t.text.init(e.container):mxUtils.isVml(t.view.getDrawPane())&&(null!=t.shape.label?t.text.init(t.shape.label):t.text.init(t.shape.node))),null==t.text.node&&(t.text.init(t.view.getDrawPane()),null!=t.shape&&null!=t.text&&t.shape.node.parentNode.insertBefore(t.text.node,t.shape.node.nextSibling))},mxCellRenderer.prototype.createCellOverlays=function(t){var e=t.view.graph.getCellOverlays(t.cell),n=null;if(null!=e)for(var n=new mxDictionary,i=0;i<e.length;i++){var o=null!=t.overlays?t.overlays.remove(e[i]):null;null==o&&(o=new mxImageShape(new mxRectangle,e[i].image.src),o.dialect=t.view.graph.dialect,o.preserveImageAspect=!1,o.overlay=e[i],this.initializeOverlay(t,o),this.installCellOverlayListeners(t,e[i],o),null!=e[i].cursor&&(o.node.style.cursor=e[i].cursor)),n.put(e[i],o)}null!=t.overlays&&t.overlays.visit(function(t,e){e.destroy()}),t.overlays=n},mxCellRenderer.prototype.initializeOverlay=function(t,e){e.init(t.view.getOverlayPane())},mxCellRenderer.prototype.installCellOverlayListeners=function(t,e,n){var i=t.view.graph;mxEvent.addListener(n.node,"click",function(n){i.isEditing()&&i.stopEditing(!i.isInvokesStopCellEditing()),e.fireEvent(new mxEventObject(mxEvent.CLICK,"event",n,"cell",t.cell))}),mxEvent.addGestureListeners(n.node,function(t){mxEvent.consume(t)},function(e){i.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(e,t))}),mxClient.IS_TOUCH&&mxEvent.addListener(n.node,"touchend",function(n){e.fireEvent(new mxEventObject(mxEvent.CLICK,"event",n,"cell",t.cell))})},mxCellRenderer.prototype.createControl=function(t){var e=t.view.graph,n=e.getFoldingImage(t);if(e.foldingEnabled&&null!=n){if(null==t.control){var i=new mxRectangle(0,0,n.width,n.height);t.control=new mxImageShape(i,n.src),t.control.preserveImageAspect=!1,t.control.dialect=e.dialect,this.initControl(t,t.control,!0,function(n){if(e.isEnabled()){var i=!e.isCellCollapsed(t.cell);e.foldCells(i,!1,[t.cell]),mxEvent.consume(n)}})}}else null!=t.control&&(t.control.destroy(),t.control=null)},mxCellRenderer.prototype.initControl=function(t,e,n,i){var o=t.view.graph;return o.isHtmlLabel(t.cell)&&mxClient.NO_FO&&o.dialect==mxConstants.DIALECT_SVG?(e.dialect=mxConstants.DIALECT_PREFERHTML,e.init(o.container),e.node.style.zIndex=1):e.init(t.view.getOverlayPane()),e=e.innerNode||e.node,i&&(o.isEnabled()&&(e.style.cursor="pointer"),mxEvent.addListener(e,"click",i)),n&&mxEvent.addGestureListeners(e,function(e){o.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(e,t)),mxEvent.consume(e)},function(e){o.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(e,t))}),e},mxCellRenderer.prototype.isShapeEvent=function(){return!0},mxCellRenderer.prototype.isLabelEvent=function(){return!0},mxCellRenderer.prototype.installListeners=function(t){var e=t.view.graph,n=function(n){var i=t;return(e.dialect!=mxConstants.DIALECT_SVG&&"IMG"==mxEvent.getSource(n).nodeName||mxClient.IS_TOUCH)&&(i=mxEvent.getClientX(n),n=mxEvent.getClientY(n),n=mxUtils.convertPoint(e.container,i,n),i=e.view.getState(e.getCellAt(n.x,n.y))),i},i=!1;mxEvent.addListener(t.shape.node,"gesturestart",mxUtils.bind(this,function(t){e.lastTouchTime=0,i=!0,mxEvent.consume(t)})),mxEvent.addGestureListeners(t.shape.node,mxUtils.bind(this,function(n){this.isShapeEvent(t,n)&&!i?e.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(n,null!=t.shape&&mxEvent.getSource(n)==t.shape.content?null:t)):i&&mxEvent.consume(n)}),mxUtils.bind(this,function(o){this.isShapeEvent(t,o)&&!i?e.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(o,null!=t.shape&&mxEvent.getSource(o)==t.shape.content?null:n(o))):i&&mxEvent.consume(o)}),mxUtils.bind(this,function(o){this.isShapeEvent(t,o)&&!i?e.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(o,null!=t.shape&&mxEvent.getSource(o)==t.shape.content?null:n(o))):i&&mxEvent.consume(o)}));var o=mxClient.IS_TOUCH?"gestureend":"dblclick";mxEvent.addListener(t.shape.node,o,mxUtils.bind(this,function(n){i=!1,"gestureend"==o?(e.lastTouchTime=0,e.gestureEnabled&&(e.handleGesture(t,n),mxEvent.consume(n))):this.isShapeEvent(t,n)&&(e.dblClick(n,null!=t.shape&&mxEvent.getSource(n)==t.shape.content?null:t.cell),mxEvent.consume(n))}))},mxCellRenderer.prototype.redrawLabel=function(t,e){var n=this.getLabelValue(t);if(null==t.text&&null!=n&&(mxUtils.isNode(n)||0<n.length)?this.createLabel(t,n):null==t.text||null!=n&&0!=n.length||(t.text.destroy(),t.text=null),null!=t.text){var i=t.view.graph,o=i.isWrapping(t.cell),i=i.isLabelClipped(t.cell),r=this.getLabelBounds(t);(e||t.text.value!=n||t.text.isWrapping!=o||t.text.isClipping!=i||t.text.scale!=t.view.scale||!t.text.bounds.equals(r))&&(t.text.value=n,t.text.bounds=r,t.text.scale=this.getTextScale(t),t.text.isWrapping=o,t.text.isClipping=i,t.text.redraw())}},mxCellRenderer.prototype.getTextScale=function(t){return t.view.scale},mxCellRenderer.prototype.getLabelBounds=function(t){var e=t.view.graph,n=t.view.scale,i=e.getModel().isEdge(t.cell),o=new mxRectangle(t.absoluteOffset.x,t.absoluteOffset.y);if(t.text.updateMargin(),i){var r=t.text.getSpacing();o.x+=r.x*n,o.y+=r.y*n,e=e.getCellGeometry(t.cell),null!=e&&(o.width=Math.max(0,e.width*n),o.height=Math.max(0,e.height*n))}else t.text.isPaintBoundsInverted()&&(r=o.x,o.x=o.y,o.y=r),o.x+=t.x,o.y+=t.y,o.width=Math.max(1,t.width),o.height=Math.max(1,t.height),e.isSwimlane(t.cell)&&(e=e.getStartSize(t.cell),0<e.width?(r=Math.min(o.width,e.width*n),t.shape.flipH&&(o.x+=o.width-r),o.width=r):0<e.height&&(r=Math.min(o.height,e.height*n),t.shape.flipV&&(o.y+=o.height-r),o.height=r));return null!=t.shape&&(o=t.shape.getLabelBounds(o)),i||this.rotateLabelBounds(t,o),o},mxCellRenderer.prototype.rotateLabelBounds=function(t,e){if(t.text.isPaintBoundsInverted()){var n=(t.width-t.height)/2;e.x+=n,e.y-=n,n=e.width,e.width=e.height,e.height=n}if(e.x-=t.text.margin.x*e.width,e.y-=t.text.margin.y*e.height,"fill"!=t.style[mxConstants.STYLE_OVERFLOW]&&"width"!=t.style[mxConstants.STYLE_OVERFLOW]){var n=t.view.scale,i=t.text.getSpacing();e.x+=i.x*n,e.y+=i.y*n,e.width=Math.max(0,e.width-t.text.spacingLeft*n-t.text.spacingRight*n),e.height=Math.max(0,e.height-t.text.spacingTop*n-t.text.spacingBottom*n)}var o=t.text.getTextRotation();0!=o&&null!=t&&t.view.graph.model.isVertex(t.cell)&&(n=t.getCenterX(),i=t.getCenterY(),e.x!=n||e.y!=i)&&(o*=Math.PI/180,pt=mxUtils.getRotatedPoint(new mxPoint(e.x,e.y),Math.cos(o),Math.sin(o),new mxPoint(n,i)),e.x=pt.x,e.y=pt.y)},mxCellRenderer.prototype.redrawCellOverlays=function(t,e){if(this.createCellOverlays(t),null!=t.overlays){var n=mxUtils.mod(mxUtils.getValue(t.style,mxConstants.STYLE_ROTATION,0),90),i=mxUtils.toRadians(n),o=Math.cos(i),r=Math.sin(i);t.overlays.visit(function(i,s){var l=s.overlay.getBounds(t);if(!t.view.graph.getModel().isEdge(t.cell)&&null!=t.shape&&0!=n){var a=l.getCenterX(),h=l.getCenterY(),h=mxUtils.getRotatedPoint(new mxPoint(a,h),o,r,new mxPoint(t.getCenterX(),t.getCenterY())),a=h.x,h=h.y;l.x=Math.round(a-l.width/2),l.y=Math.round(h-l.height/2)}(e||null==s.bounds||s.scale!=t.view.scale||!s.bounds.equals(l))&&(s.bounds=l,s.scale=t.view.scale,s.redraw())})}},mxCellRenderer.prototype.redrawControl=function(t,e){if(null!=t.control){var n=this.getControlBounds(t),i=this.legacyControlPosition?mxUtils.getValue(t.style,mxConstants.STYLE_ROTATION,0):t.shape.getTextRotation(),o=t.view.scale;(e||t.control.scale!=o||!t.control.bounds.equals(n)||t.control.rotation!=i)&&(t.control.rotation=i,t.control.bounds=n,t.control.scale=o,t.control.redraw())}},mxCellRenderer.prototype.getControlBounds=function(t){if(null!=t.control){var e=t.control.scale,n=t.control.bounds.width/e,e=t.control.bounds.height/e,i=t.view.scale,o=t.getCenterX(),r=t.getCenterY();if(!t.view.graph.getModel().isEdge(t.cell)&&(o=t.x+n*i,r=t.y+e*i,null!=t.shape)){var s=t.shape.getShapeRotation();if(this.legacyControlPosition)s=mxUtils.getValue(t.style,mxConstants.STYLE_ROTATION,0);else if(t.shape.isPaintBoundsInverted())var l=(t.width-t.height)/2,o=o+l,r=r-l;0!=s&&(l=mxUtils.toRadians(s),s=Math.cos(l),l=Math.sin(l),r=mxUtils.getRotatedPoint(new mxPoint(o,r),s,l,new mxPoint(t.getCenterX(),t.getCenterY())),o=r.x,r=r.y)}return t.view.graph.getModel().isEdge(t.cell),new mxRectangle(Math.round(o-n/2*i),Math.round(r-e/2*i),Math.round(n*i),Math.round(e*i))}return null},mxCellRenderer.prototype.redraw=function(t,e,n){if(null!=t.shape){var i=!1;t.view.graph.getModel().isEdge(t.cell),reconfigure=null!=e?e:!1,this.createControl(t),(t.orderChanged||t.invalidOrder)&&(t.view.graph.ordered?this.order(t):this.orderEdge(t)),(t.orderChanged||!mxUtils.equalEntries(t.shape.style,t.style))&&(this.configureShape(t),e=!0),delete t.invalidOrder,delete t.orderChanged,!e&&null!=t.shape.bounds&&t.shape.scale==t.view.scale&&t.shape.bounds.equals(t)&&mxUtils.equalPoints(t.shape.points,t.absolutePoints)||(i=!0,t.shape.points=null!=t.absolutePoints?t.absolutePoints.slice():null,t.shape.bounds=new mxRectangle(t.x,t.y,t.width,t.height),t.shape.scale=t.view.scale,null==n||n?t.shape.redraw():t.shape.updateBoundingBox()),(null==n||n)&&(this.redrawLabel(t,i),this.redrawCellOverlays(t,i),this.redrawControl(t,i))}},mxCellRenderer.prototype.destroy=function(t){null!=t.shape&&(null!=t.text&&(t.text.destroy(),t.text=null),null!=t.overlays&&(t.overlays.visit(function(t,e){e.destroy()}),t.overlays=null),null!=t.control&&(t.control.destroy(),t.control=null),t.shape.destroy(),t.shape=null)};var mxEdgeStyle={EntityRelation:function(t,e,n,i,o){var r=t.view,s=r.graph;i=mxUtils.getValue(t.style,mxConstants.STYLE_SEGMENT,mxConstants.ENTITY_SEGMENT)*r.scale;var l=t.absolutePoints,a=l[0],h=l[l.length-1],l=!1;if(null!=a)e=new mxCellState,e.x=a.x,e.y=a.y;else{if(null==e)return;var d=mxUtils.getPortConstraints(e,t,!0,mxConstants.DIRECTION_MASK_NONE);d!=mxConstants.DIRECTION_MASK_NONE?l=d==mxConstants.DIRECTION_MASK_WEST:(a=s.getCellGeometry(e.cell),a.relative?l=.5>=a.x:null!=n&&(l=n.x+n.width<e.x))}a=!0,null!=h?(n=new mxCellState,n.x=h.x,n.y=h.y):null!=n&&(d=mxUtils.getPortConstraints(n,t,!1,mxConstants.DIRECTION_MASK_NONE),d!=mxConstants.DIRECTION_MASK_NONE?a=d==mxConstants.DIRECTION_MASK_WEST:(t=s.getCellGeometry(n.cell),t.relative?a=.5>=t.x:null!=e&&(a=e.x+e.width<n.x))),null!=e&&null!=n&&(t=l?e.x:e.x+e.width,e=r.getRoutingCenterY(e),s=a?n.x:n.x+n.width,n=r.getRoutingCenterY(n),r=new mxPoint(t+(l?-i:i),e),h=new mxPoint(s+(a?-i:i),n),l==a?(i=l?Math.min(t,s)-i:Math.max(t,s)+i,o.push(new mxPoint(i,e)),o.push(new mxPoint(i,n))):(r.x<h.x==l?(i=e+(n-e)/2,o.push(r),o.push(new mxPoint(r.x,i)),o.push(new mxPoint(h.x,i))):o.push(r),o.push(h)))},Loop:function(t,e,n,i,o){if(null!=e){n=t.view;var r=n.graph;i=null!=i&&0<i.length?i[0]:null,null!=i&&(i=n.transformControlPoint(t,i),mxUtils.contains(e,i.x,i.y)&&(i=null));var s=0,l=0,a=0,h=0,r=mxUtils.getValue(t.style,mxConstants.STYLE_SEGMENT,r.gridSize)*n.scale;t=mxUtils.getValue(t.style,mxConstants.STYLE_DIRECTION,mxConstants.DIRECTION_WEST),t==mxConstants.DIRECTION_NORTH||t==mxConstants.DIRECTION_SOUTH?(s=n.getRoutingCenterX(e),l=r):(a=n.getRoutingCenterY(e),h=r),null==i||i.x<e.x||i.x>e.x+e.width?null!=i?(s=i.x,h=Math.max(Math.abs(a-i.y),h)):t==mxConstants.DIRECTION_NORTH?a=e.y-2*l:t==mxConstants.DIRECTION_SOUTH?a=e.y+e.height+2*l:s=t==mxConstants.DIRECTION_EAST?e.x-2*h:e.x+e.width+2*h:null!=i&&(s=n.getRoutingCenterX(e),l=Math.max(Math.abs(s-i.x),h),a=i.y,h=0),o.push(new mxPoint(s-l,a-h)),o.push(new mxPoint(s+l,a+h))}},ElbowConnector:function(t,e,n,i,o){var r=null!=i&&0<i.length?i[0]:null,s=!1,l=!1;if(null!=e&&null!=n)if(null!=r)var a=Math.min(e.x,n.x),h=Math.max(e.x+e.width,n.x+n.width),l=Math.min(e.y,n.y),d=Math.max(e.y+e.height,n.y+n.height),r=t.view.transformControlPoint(t,r),s=r.y<l||r.y>d,l=r.x<a||r.x>h;else a=Math.max(e.x,n.x),h=Math.min(e.x+e.width,n.x+n.width),s=a==h,s||(l=Math.max(e.y,n.y),d=Math.min(e.y+e.height,n.y+n.height),l=l==d);l||!s&&t.style[mxConstants.STYLE_ELBOW]!=mxConstants.ELBOW_VERTICAL?mxEdgeStyle.SideToSide(t,e,n,i,o):mxEdgeStyle.TopToBottom(t,e,n,i,o)},SideToSide:function(t,e,n,i,o){var r=t.view;i=null!=i&&0<i.length?i[0]:null;var s=t.absolutePoints,l=s[0],s=s[s.length-1];null!=i&&(i=r.transformControlPoint(t,i)),null!=l&&(e=new mxCellState,e.x=l.x,e.y=l.y),null!=s&&(n=new mxCellState,n.x=s.x,n.y=s.y),null!=e&&null!=n&&(t=Math.max(e.x,n.x),l=Math.min(e.x+e.width,n.x+n.width),t=null!=i?i.x:l+(t-l)/2,l=r.getRoutingCenterY(e),r=r.getRoutingCenterY(n),null!=i&&(i.y>=e.y&&i.y<=e.y+e.height&&(l=i.y),i.y>=n.y&&i.y<=n.y+n.height&&(r=i.y)),!mxUtils.contains(n,t,l)&&!mxUtils.contains(e,t,l)&&o.push(new mxPoint(t,l)),!mxUtils.contains(n,t,r)&&!mxUtils.contains(e,t,r)&&o.push(new mxPoint(t,r)),1==o.length&&(null!=i?!mxUtils.contains(n,t,i.y)&&!mxUtils.contains(e,t,i.y)&&o.push(new mxPoint(t,i.y)):(r=Math.max(e.y,n.y),e=Math.min(e.y+e.height,n.y+n.height),o.push(new mxPoint(t,r+(e-r)/2)))))
},TopToBottom:function(t,e,n,i,o){var r=t.view;i=null!=i&&0<i.length?i[0]:null;var s=t.absolutePoints,l=s[0],s=s[s.length-1];null!=i&&(i=r.transformControlPoint(t,i)),null!=l&&(e=new mxCellState,e.x=l.x,e.y=l.y),null!=s&&(n=new mxCellState,n.x=s.x,n.y=s.y),null!=e&&null!=n&&(l=Math.max(e.y,n.y),s=Math.min(e.y+e.height,n.y+n.height),t=r.getRoutingCenterX(e),null!=i&&i.x>=e.x&&i.x<=e.x+e.width&&(t=i.x),l=null!=i?i.y:s+(l-s)/2,!mxUtils.contains(n,t,l)&&!mxUtils.contains(e,t,l)&&o.push(new mxPoint(t,l)),t=null!=i&&i.x>=n.x&&i.x<=n.x+n.width?i.x:r.getRoutingCenterX(n),!mxUtils.contains(n,t,l)&&!mxUtils.contains(e,t,l)&&o.push(new mxPoint(t,l)),1==o.length&&(null!=i&&1==o.length?!mxUtils.contains(n,i.x,l)&&!mxUtils.contains(e,i.x,l)&&o.push(new mxPoint(i.x,l)):(r=Math.max(e.x,n.x),e=Math.min(e.x+e.width,n.x+n.width),o.push(new mxPoint(r+(e-r)/2,l)))))},SegmentConnector:function(t,e,n,i,o){var r=t.absolutePoints,s=!0,l=null,a=r[0];null==a&&null!=e?a=new mxPoint(t.view.getRoutingCenterX(e),t.view.getRoutingCenterY(e)):null!=a&&(a=a.clone());var h=r.length-1;if(null!=i&&0<i.length){for(var l=t.view.transformControlPoint(t,i[0]),d=e,u=r[0],c=!1,p=!1,c=l,m=i.length,g=0;2>g;g++){var f=null!=u&&u.x==c.x,x=null!=u&&u.y==c.y,C=null!=d&&c.y>=d.y&&c.y<=d.y+d.height,d=null!=d&&c.x>=d.x&&c.x<=d.x+d.width,c=x||null==u&&C,p=f||null==u&&d;if(null!=u&&!x&&!f&&(C||d)){s=C?!1:!0;break}if(p||c){s=c,1==g&&(s=0==i.length%2?c:p);break}d=n,u=r[h],c=t.view.transformControlPoint(t,i[m-1])}for(s&&(null!=r[0]&&r[0].y!=l.y||null==r[0]&&null!=e&&(l.y<e.y||l.y>e.y+e.height))?o.push(new mxPoint(a.x,l.y)):!s&&(null!=r[0]&&r[0].x!=l.x||null==r[0]&&null!=e&&(l.x<e.x||l.x>e.x+e.width))&&o.push(new mxPoint(l.x,a.y)),s?a.y=l.y:a.x=l.x,g=0;g<i.length;g++)s=!s,l=t.view.transformControlPoint(t,i[g]),s?a.y=l.y:a.x=l.x,o.push(a.clone())}else l=a,s=!0;if(a=r[h],null==a&&null!=n&&(a=new mxPoint(t.view.getRoutingCenterX(n),t.view.getRoutingCenterY(n))),s&&(null!=r[h]&&r[h].y!=l.y||null==r[h]&&null!=n&&(l.y<n.y||l.y>n.y+n.height))?o.push(new mxPoint(a.x,l.y)):!s&&(null!=r[h]&&r[h].x!=l.x||null==r[h]&&null!=n&&(l.x<n.x||l.x>n.x+n.width))&&o.push(new mxPoint(l.x,a.y)),null==r[0]&&null!=e)for(;1<o.length&&mxUtils.contains(e,o[1].x,o[1].y);)o=o.splice(1,1);if(null==r[h]&&null!=n)for(;1<o.length&&mxUtils.contains(n,o[o.length-1].x,o[o.length-1].y);)o=o.splice(o.length-1,1)},orthBuffer:10,dirVectors:[[-1,0],[0,-1],[1,0],[0,1],[-1,0],[0,-1],[1,0]],wayPoints1:[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],routePatterns:[[[513,2308,2081,2562],[513,1090,514,2184,2114,2561],[513,1090,514,2564,2184,2562],[513,2308,2561,1090,514,2568,2308]],[[514,1057,513,2308,2081,2562],[514,2184,2114,2561],[514,2184,2562,1057,513,2564,2184],[514,1057,513,2568,2308,2561]],[[1090,514,1057,513,2308,2081,2562],[2114,2561],[1090,2562,1057,513,2564,2184],[1090,514,1057,513,2308,2561,2568]],[[2081,2562],[1057,513,1090,514,2184,2114,2561],[1057,513,1090,514,2184,2562,2564],[1057,2561,1090,514,2568,2308]]],inlineRoutePatterns:[[null,[2114,2568],null,null],[null,[514,2081,2114,2568],null,null],[null,[2114,2561],null,null],[[2081,2562],[1057,2114,2568],[2184,2562],null]],vertexSeperations:[],limits:[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]],LEFT_MASK:32,TOP_MASK:64,RIGHT_MASK:128,BOTTOM_MASK:256,LEFT:1,TOP:2,RIGHT:4,BOTTOM:8,SIDE_MASK:480,CENTER_MASK:512,SOURCE_MASK:1024,TARGET_MASK:2048,VERTEX_MASK:3072,OrthConnector:function(t,e,n,i,o){var r=t.view.graph,s=null==e?!1:r.getModel().isEdge(e.cell),r=null==n?!1:r.getModel().isEdge(n.cell);if(null!=i&&0<i.length||s||r)mxEdgeStyle.SegmentConnector(t,e,n,i,o);else{i=t.absolutePoints;var l=i[0],a=i[i.length-1];i=null!=e?e.x:l.x;var s=null!=e?e.y:l.y,h=null!=e?e.width:1,d=null!=e?e.height:1,u=null!=n?n.x:a.x,c=null!=n?n.y:a.y,p=null!=n?n.width:1,m=null!=n?n.height:1,r=t.view.scale*mxEdgeStyle.orthBuffer,g=[mxConstants.DIRECTION_MASK_ALL,mxConstants.DIRECTION_MASK_ALL];for(null!=e&&(g[0]=mxUtils.getPortConstraints(e,t,!0,mxConstants.DIRECTION_MASK_ALL)),null!=n&&(g[1]=mxUtils.getPortConstraints(n,t,!1,mxConstants.DIRECTION_MASK_ALL)),t=[0,0],i=[[i,s,h,d],[u,c,p,m]],h=0;2>h;h++)mxEdgeStyle.limits[h][1]=i[h][0]-r,mxEdgeStyle.limits[h][2]=i[h][1]-r,mxEdgeStyle.limits[h][4]=i[h][0]+i[h][2]+r,mxEdgeStyle.limits[h][8]=i[h][1]+i[h][3]+r;for(h=i[0][0]+i[0][2]/2-(i[1][0]+i[1][2]/2),d=i[0][1]+i[0][3]/2-(i[1][1]+i[1][3]/2),s=0,0>h?s=0>d?2:1:0>=d&&(s=3,0==h&&(s=2)),d=null,null!=e&&(d=l),e=[[.5,.5],[.5,.5]],h=0;2>h;h++)null!=d&&(e[h][0]=(d.x-i[h][0])/i[h][2],.01>e[h][0]?t[h]=mxConstants.DIRECTION_MASK_WEST:.99<e[h][0]&&(t[h]=mxConstants.DIRECTION_MASK_EAST),e[h][1]=(d.y-i[h][1])/i[h][3],.01>e[h][1]?t[h]=mxConstants.DIRECTION_MASK_NORTH:.99<e[h][1]&&(t[h]=mxConstants.DIRECTION_MASK_SOUTH)),d=null,null!=n&&(d=a);for(h=i[0][1]-(i[1][1]+i[1][3]),d=i[0][0]-(i[1][0]+i[1][2]),u=i[1][1]-(i[0][1]+i[0][3]),c=i[1][0]-(i[0][0]+i[0][2]),mxEdgeStyle.vertexSeperations[1]=Math.max(d-2*r,0),mxEdgeStyle.vertexSeperations[2]=Math.max(h-2*r,0),mxEdgeStyle.vertexSeperations[4]=Math.max(u-2*r,0),mxEdgeStyle.vertexSeperations[3]=Math.max(c-2*r,0),n=[],l=[],a=[],l[0]=d>=c?mxConstants.DIRECTION_MASK_WEST:mxConstants.DIRECTION_MASK_EAST,a[0]=h>=u?mxConstants.DIRECTION_MASK_NORTH:mxConstants.DIRECTION_MASK_SOUTH,l[1]=mxUtils.reversePortConstraints(l[0]),a[1]=mxUtils.reversePortConstraints(a[0]),d=d>=c?d:c,u=h>=u?h:u,c=[[0,0],[0,0]],p=!1,h=0;2>h;h++)0==t[h]&&(0==(l[h]&g[h])&&(l[h]=mxUtils.reversePortConstraints(l[h])),0==(a[h]&g[h])&&(a[h]=mxUtils.reversePortConstraints(a[h])),c[h][0]=a[h],c[h][1]=l[h]);for(u>2*r&&d>2*r&&(0<(l[0]&g[0])&&0<(a[1]&g[1])?(c[0][0]=l[0],c[0][1]=a[0],c[1][0]=a[1],c[1][1]=l[1],p=!0):0<(a[0]&g[0])&&0<(l[1]&g[1])&&(c[0][0]=a[0],c[0][1]=l[0],c[1][0]=l[1],c[1][1]=a[1],p=!0)),u>2*r&&!p&&(c[0][0]=a[0],c[0][1]=l[0],c[1][0]=a[1],c[1][1]=l[1],p=!0),d>2*r&&!p&&(c[0][0]=l[0],c[0][1]=a[0],c[1][0]=l[1],c[1][1]=a[1]),h=0;2>h;h++)0==t[h]&&(0==(c[h][0]&g[h])&&(c[h][0]=c[h][1]),n[h]=c[h][0]&g[h],n[h]|=(c[h][1]&g[h])<<8,n[h]|=(c[1-h][h]&g[h])<<16,n[h]|=(c[1-h][1-h]&g[h])<<24,0==(15&n[h])&&(n[h]<<=8),0==(3840&n[h])&&(n[h]=15&n[h]|n[h]>>8),0==(983040&n[h])&&(n[h]=65535&n[h]|(251658240&n[h])>>8),t[h]=15&n[h],g[h]==mxConstants.DIRECTION_MASK_WEST||g[h]==mxConstants.DIRECTION_MASK_NORTH||g[h]==mxConstants.DIRECTION_MASK_EAST||g[h]==mxConstants.DIRECTION_MASK_SOUTH)&&(t[h]=g[h]);switch(h=t[0]==mxConstants.DIRECTION_MASK_EAST?3:t[0],g=t[1]==mxConstants.DIRECTION_MASK_EAST?3:t[1],h-=s,g-=s,1>h&&(h+=4),1>g&&(g+=4),g=mxEdgeStyle.routePatterns[h-1][g-1],mxEdgeStyle.wayPoints1[0][0]=i[0][0],mxEdgeStyle.wayPoints1[0][1]=i[0][1],t[0]){case mxConstants.DIRECTION_MASK_WEST:mxEdgeStyle.wayPoints1[0][0]-=r,mxEdgeStyle.wayPoints1[0][1]+=e[0][1]*i[0][3];break;case mxConstants.DIRECTION_MASK_SOUTH:mxEdgeStyle.wayPoints1[0][0]+=e[0][0]*i[0][2],mxEdgeStyle.wayPoints1[0][1]+=i[0][3]+r;break;case mxConstants.DIRECTION_MASK_EAST:mxEdgeStyle.wayPoints1[0][0]+=i[0][2]+r,mxEdgeStyle.wayPoints1[0][1]+=e[0][1]*i[0][3];break;case mxConstants.DIRECTION_MASK_NORTH:mxEdgeStyle.wayPoints1[0][0]+=e[0][0]*i[0][2],mxEdgeStyle.wayPoints1[0][1]-=r}for(r=0,l=n=0<(t[0]&(mxConstants.DIRECTION_MASK_EAST|mxConstants.DIRECTION_MASK_WEST))?0:1,h=a=0;h<g.length;h++){a=15&g[h],m=a==mxConstants.DIRECTION_MASK_EAST?3:a,m+=s,m>4&&(m-=4),d=mxEdgeStyle.dirVectors[m-1],a=m%2>0?0:1,a!=n&&(r++,mxEdgeStyle.wayPoints1[r][0]=mxEdgeStyle.wayPoints1[r-1][0],mxEdgeStyle.wayPoints1[r][1]=mxEdgeStyle.wayPoints1[r-1][1]);var f=0<(g[h]&mxEdgeStyle.TARGET_MASK),p=0<(g[h]&mxEdgeStyle.SOURCE_MASK),u=(g[h]&mxEdgeStyle.SIDE_MASK)>>5,u=u<<s;u>15&&(u>>=4),c=0<(g[h]&mxEdgeStyle.CENTER_MASK),(p||f)&&9>u?(m=0,p=p?0:1,m=c&&0==a?i[p][0]+e[p][0]*i[p][2]:c?i[p][1]+e[p][1]*i[p][3]:mxEdgeStyle.limits[p][u],0==a?(u=(m-mxEdgeStyle.wayPoints1[r][0])*d[0],u>0&&(mxEdgeStyle.wayPoints1[r][0]+=d[0]*u)):(u=(m-mxEdgeStyle.wayPoints1[r][1])*d[1],u>0&&(mxEdgeStyle.wayPoints1[r][1]+=d[1]*u))):c&&(mxEdgeStyle.wayPoints1[r][0]+=d[0]*Math.abs(mxEdgeStyle.vertexSeperations[m]/2),mxEdgeStyle.wayPoints1[r][1]+=d[1]*Math.abs(mxEdgeStyle.vertexSeperations[m]/2)),r>0&&mxEdgeStyle.wayPoints1[r][a]==mxEdgeStyle.wayPoints1[r-1][a]?r--:n=a}for(h=0;r>=h&&(h!=r||((0<(t[1]&(mxConstants.DIRECTION_MASK_EAST|mxConstants.DIRECTION_MASK_WEST))?0:1)==l?0:1)==(r+1)%2);h++)o.push(new mxPoint(mxEdgeStyle.wayPoints1[h][0],mxEdgeStyle.wayPoints1[h][1]))}},getRoutePattern:function(t,e,n,i){var o=t[0]==mxConstants.DIRECTION_MASK_EAST?3:t[0];return t=t[1]==mxConstants.DIRECTION_MASK_EAST?3:t[1],o-=e,t-=e,1>o&&(o+=4),1>t&&(t+=4),e=routePatterns[o-1][t-1],(0==n||0==i)&&null!=inlineRoutePatterns[o-1][t-1]&&(e=inlineRoutePatterns[o-1][t-1]),e}},mxStyleRegistry={values:[],putValue:function(t,e){mxStyleRegistry.values[t]=e},getValue:function(t){return mxStyleRegistry.values[t]},getName:function(t){for(var e in mxStyleRegistry.values)if(mxStyleRegistry.values[e]==t)return e;return null}};mxStyleRegistry.putValue(mxConstants.EDGESTYLE_ELBOW,mxEdgeStyle.ElbowConnector),mxStyleRegistry.putValue(mxConstants.EDGESTYLE_ENTITY_RELATION,mxEdgeStyle.EntityRelation),mxStyleRegistry.putValue(mxConstants.EDGESTYLE_LOOP,mxEdgeStyle.Loop),mxStyleRegistry.putValue(mxConstants.EDGESTYLE_SIDETOSIDE,mxEdgeStyle.SideToSide),mxStyleRegistry.putValue(mxConstants.EDGESTYLE_TOPTOBOTTOM,mxEdgeStyle.TopToBottom),mxStyleRegistry.putValue(mxConstants.EDGESTYLE_ORTHOGONAL,mxEdgeStyle.OrthConnector),mxStyleRegistry.putValue(mxConstants.EDGESTYLE_SEGMENT,mxEdgeStyle.SegmentConnector),mxStyleRegistry.putValue(mxConstants.PERIMETER_ELLIPSE,mxPerimeter.EllipsePerimeter),mxStyleRegistry.putValue(mxConstants.PERIMETER_RECTANGLE,mxPerimeter.RectanglePerimeter),mxStyleRegistry.putValue(mxConstants.PERIMETER_RHOMBUS,mxPerimeter.RhombusPerimeter),mxStyleRegistry.putValue(mxConstants.PERIMETER_TRIANGLE,mxPerimeter.TrianglePerimeter),mxGraphView.prototype=new mxEventSource,mxGraphView.prototype.constructor=mxGraphView,mxGraphView.prototype.EMPTY_POINT=new mxPoint,mxGraphView.prototype.doneResource="none"!=mxClient.language?"done":"",mxGraphView.prototype.updatingDocumentResource="none"!=mxClient.language?"updatingDocument":"",mxGraphView.prototype.allowEval=!1,mxGraphView.prototype.captureDocumentGesture=!0,mxGraphView.prototype.optimizeVmlReflows=!0,mxGraphView.prototype.rendering=!0,mxGraphView.prototype.graph=null,mxGraphView.prototype.currentRoot=null,mxGraphView.prototype.graphBounds=null,mxGraphView.prototype.scale=1,mxGraphView.prototype.translate=null,mxGraphView.prototype.updateStyle=!1,mxGraphView.prototype.getGraphBounds=function(){return this.graphBounds},mxGraphView.prototype.setGraphBounds=function(t){this.graphBounds=t},mxGraphView.prototype.getBounds=function(t){var e=null;if(null!=t&&0<t.length)for(var n=this.graph.getModel(),i=0;i<t.length;i++)if(n.isVertex(t[i])||n.isEdge(t[i])){var o=this.getState(t[i]);null!=o&&(null==e?e=new mxRectangle(o.x,o.y,o.width,o.height):e.add(o))}return e},mxGraphView.prototype.setCurrentRoot=function(t){if(this.currentRoot!=t){var e=new mxCurrentRootChange(this,t);e.execute();var n=new mxUndoableEdit(this,!1);n.add(e),this.fireEvent(new mxEventObject(mxEvent.UNDO,"edit",n)),this.graph.sizeDidChange()}return t},mxGraphView.prototype.scaleAndTranslate=function(t,e,n){var i=this.scale,o=new mxPoint(this.translate.x,this.translate.y);(this.scale!=t||this.translate.x!=e||this.translate.y!=n)&&(this.scale=t,this.translate.x=e,this.translate.y=n,this.isEventsEnabled()&&(this.revalidate(),this.graph.sizeDidChange())),this.fireEvent(new mxEventObject(mxEvent.SCALE_AND_TRANSLATE,"scale",t,"previousScale",i,"translate",this.translate,"previousTranslate",o))},mxGraphView.prototype.getScale=function(){return this.scale},mxGraphView.prototype.setScale=function(t){var e=this.scale;this.scale!=t&&(this.scale=t,this.isEventsEnabled()&&(this.revalidate(),this.graph.sizeDidChange())),this.fireEvent(new mxEventObject(mxEvent.SCALE,"scale",t,"previousScale",e))},mxGraphView.prototype.getTranslate=function(){return this.translate},mxGraphView.prototype.setTranslate=function(t,e){var n=new mxPoint(this.translate.x,this.translate.y);(this.translate.x!=t||this.translate.y!=e)&&(this.translate.x=t,this.translate.y=e,this.isEventsEnabled()&&(this.revalidate(),this.graph.sizeDidChange())),this.fireEvent(new mxEventObject(mxEvent.TRANSLATE,"translate",this.translate,"previousTranslate",n))},mxGraphView.prototype.refresh=function(){null!=this.currentRoot&&this.clear(),this.revalidate()},mxGraphView.prototype.revalidate=function(){this.invalidate(),this.validate()},mxGraphView.prototype.clear=function(t,e,n){var i=this.graph.getModel();if(t=t||i.getRoot(),e=null!=e?e:!1,n=null!=n?n:!0,this.removeState(t),n&&(e||t!=this.currentRoot)){n=i.getChildCount(t);for(var o=0;n>o;o++)this.clear(i.getChildAt(t,o),e)}else this.invalidate(t)},mxGraphView.prototype.invalidate=function(t,e,n,i){var o=this.graph.getModel();t=t||o.getRoot(),e=null!=e?e:!0,n=null!=n?n:!0,i=null!=i?i:!1;var r=this.getState(t);if(null!=r&&(r.invalid=!0,i&&(r.orderChanged=!0)),e)for(var s=o.getChildCount(t),r=0;s>r;r++){var l=o.getChildAt(t,r);this.invalidate(l,e,n,i)}if(n)for(i=o.getEdgeCount(t),r=0;i>r;r++)this.invalidate(o.getEdgeAt(t,r),e,n)},mxGraphView.prototype.validate=function(t){var e=mxLog.enter("mxGraphView.validate");window.status=mxResources.get(this.updatingDocumentResource)||this.updatingDocumentResource;var n=null;if(this.optimizeVmlReflows&&null!=this.canvas&&null==this.textDiv&&(8==document.documentMode||mxClient.IS_QUIRKS)){n=this.canvas.style.display,this.canvas.style.display="none";var i=document.createElement("div");i.style.position="absolute",i.style.whiteSpace="nowrap",i.style.visibility="hidden",i.style.display=mxClient.IS_QUIRKS?"inline":"inline-block",i.style.zoom="1",document.body.appendChild(i),this.textDiv=i}t=t||(null!=this.currentRoot?this.currentRoot:this.graph.getModel().getRoot()),this.validateBounds(null,t),t=this.validatePoints(null,t),null==t&&(t=new mxRectangle),this.setGraphBounds(t),this.validateBackground(),null!=n&&(this.canvas.style.display=n,document.body.removeChild(this.textDiv),this.textDiv=null),window.status=mxResources.get(this.doneResource)||this.doneResource,mxLog.leave("mxGraphView.validate",e)},mxGraphView.prototype.createBackgroundPageShape=function(t){return new mxRectangleShape(t,"white","black")},mxGraphView.prototype.validateBackground=function(){var t=this.graph.getBackgroundImage();if(null!=t){if(null==this.backgroundImage||this.backgroundImage.image!=t.src){null!=this.backgroundImage&&this.backgroundImage.destroy();var e=new mxRectangle(0,0,1,1);this.backgroundImage=new mxImageShape(e,t.src),this.backgroundImage.dialect=this.graph.dialect,this.backgroundImage.init(this.backgroundPane),this.backgroundImage.redraw()}this.redrawBackgroundImage(this.backgroundImage,t)}else null!=this.backgroundImage&&(this.backgroundImage.destroy(),this.backgroundImage=null);this.graph.pageVisible?(e=this.getBackgroundPageBounds(),null==this.backgroundPageShape?(this.backgroundPageShape=this.createBackgroundPageShape(e),this.backgroundPageShape.scale=this.scale,this.backgroundPageShape.isShadow=!0,this.backgroundPageShape.dialect=this.graph.dialect,this.backgroundPageShape.init(this.backgroundPane),this.backgroundPageShape.redraw(),mxEvent.addListener(this.backgroundPageShape.node,"dblclick",mxUtils.bind(this,function(t){this.graph.dblClick(t)})),mxEvent.addGestureListeners(this.backgroundPageShape.node,mxUtils.bind(this,function(t){this.graph.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(t))}),mxUtils.bind(this,function(t){null!=this.graph.tooltipHandler&&this.graph.tooltipHandler.isHideOnHover()&&this.graph.tooltipHandler.hide(),this.graph.isMouseDown&&!mxEvent.isConsumed(t)&&this.graph.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(t))}),mxUtils.bind(this,function(t){this.graph.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(t))}))):(this.backgroundPageShape.scale=this.scale,this.backgroundPageShape.bounds=e,this.backgroundPageShape.redraw())):null!=this.backgroundPageShape&&(this.backgroundPageShape.destroy(),this.backgroundPageShape=null)},mxGraphView.prototype.getBackgroundPageBounds=function(){var t=this.graph.pageFormat,e=this.scale*this.graph.pageScale;return new mxRectangle(this.scale*this.translate.x,this.scale*this.translate.y,t.width*e,t.height*e)},mxGraphView.prototype.redrawBackgroundImage=function(t,e){t.scale=this.scale,t.bounds.x=this.scale*this.translate.x,t.bounds.y=this.scale*this.translate.y,t.bounds.width=this.scale*e.width,t.bounds.height=this.scale*e.height,t.redraw()},mxGraphView.prototype.validateBounds=function(t,e){var n=this.graph.getModel(),i=this.getState(e,!0);if(null!=i&&i.invalid){if(this.graph.isCellVisible(e)){if(e!=this.currentRoot&&null!=t){i.absoluteOffset.x=0,i.absoluteOffset.y=0,i.origin.x=t.origin.x,i.origin.y=t.origin.y;var o=this.graph.getCellGeometry(e);if(null!=o){if(!n.isEdge(e)){var r=o.offset||this.EMPTY_POINT;o.relative?(i.origin.x+=o.x*t.width/this.scale+r.x,i.origin.y+=o.y*t.height/this.scale+r.y):(i.absoluteOffset.x=this.scale*r.x,i.absoluteOffset.y=this.scale*r.y,i.origin.x+=o.x,i.origin.y+=o.y)}if(i.x=this.scale*(this.translate.x+i.origin.x),i.y=this.scale*(this.translate.y+i.origin.y),i.width=this.scale*o.width,i.height=this.scale*o.height,n.isVertex(e)){if(o.relative&&(r=mxUtils.toRadians(t.style[mxConstants.STYLE_ROTATION]||"0"),0!=r)){var o=Math.cos(r),r=Math.sin(r),s=new mxPoint(i.getCenterX(),i.getCenterY()),l=new mxPoint(t.getCenterX(),t.getCenterY()),o=mxUtils.getRotatedPoint(s,o,r,l);i.x=o.x-i.width/2,i.y=o.y-i.height/2}this.updateVertexLabelOffset(i)}}}}else this.removeState(e);r=this.graph.getChildOffsetForCell(e),null!=r&&(i.origin.x+=r.x,i.origin.y+=r.y)}if(null!=i&&(!this.graph.isCellCollapsed(e)||e==this.currentRoot))for(o=n.getChildCount(e),r=0;o>r;r++)s=n.getChildAt(e,r),this.validateBounds(i,s)},mxGraphView.prototype.updateVertexLabelOffset=function(t){var e=mxUtils.getValue(t.style,mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_CENTER);e==mxConstants.ALIGN_LEFT?t.absoluteOffset.x-=t.width:e==mxConstants.ALIGN_RIGHT&&(t.absoluteOffset.x+=t.width),e=mxUtils.getValue(t.style,mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_MIDDLE),e==mxConstants.ALIGN_TOP?t.absoluteOffset.y-=t.height:e==mxConstants.ALIGN_BOTTOM&&(t.absoluteOffset.y+=t.height)},mxGraphView.prototype.validatePoints=function(t,e){var n=this.graph.getModel(),i=this.getState(e),o=null;if(null!=i){if(i.invalid){var r=this.graph.getCellGeometry(e);if(null!=r&&n.isEdge(e)){var s=this.getState(this.getVisibleTerminal(e,!0));if(i.setVisibleTerminalState(s,!0),null!=s&&n.isEdge(s.cell)&&!n.isAncestor(s.cell,e)){var l=this.getState(n.getParent(s.cell));this.validatePoints(l,s.cell)}var a=this.getState(this.getVisibleTerminal(e,!1));i.setVisibleTerminalState(a,!1),null!=a&&n.isEdge(a.cell)&&!n.isAncestor(a.cell,e)&&(l=this.getState(n.getParent(a.cell)),this.validatePoints(l,a.cell)),this.updateFixedTerminalPoints(i,s,a),this.updatePoints(i,r.points,s,a),this.updateFloatingTerminalPoints(i,s,a),this.updateEdgeBounds(i),this.updateEdgeLabelOffset(i)}else null!=r&&r.relative&&null!=t&&n.isEdge(t.cell)&&(r=this.getPoint(t,r),null!=r&&(i.x=r.x,i.y=r.y,r.x=r.x/this.scale-this.translate.x,r.y=r.y/this.scale-this.translate.y,i.origin=r,this.childMoved(t,i)));i.invalid=!1,e!=this.currentRoot&&this.graph.cellRenderer.redraw(i,!1,this.isRendering())}(n.isEdge(e)||n.isVertex(e))&&(null!=i.shape&&null!=i.shape.boundingBox&&(o=i.shape.boundingBox.clone()),null!=i.text&&!this.graph.isLabelClipped(i.cell)&&null!=i.text.boundingBox&&(null!=o?o.add(i.text.boundingBox):o=i.text.boundingBox.clone()))}if(null!=i&&(!this.graph.isCellCollapsed(e)||e==this.currentRoot))for(r=n.getChildCount(e),s=0;r>s;s++)l=n.getChildAt(e,s),l=this.validatePoints(i,l),null!=l&&(null==o?o=l:o.add(l));return o},mxGraphView.prototype.childMoved=function(t,e){var n=e.cell;if(!this.graph.isCellCollapsed(n)||n==this.currentRoot)for(var i=this.graph.getModel(),o=i.getChildCount(n),r=0;o>r;r++)this.validateBounds(e,i.getChildAt(n,r))},mxGraphView.prototype.updateFixedTerminalPoints=function(t,e,n){this.updateFixedTerminalPoint(t,e,!0,this.graph.getConnectionConstraint(t,e,!0)),this.updateFixedTerminalPoint(t,n,!1,this.graph.getConnectionConstraint(t,n,!1))},mxGraphView.prototype.updateFixedTerminalPoint=function(t,e,n,i){var o=null;if(null!=i&&(o=this.graph.getConnectionPoint(e,i)),null==o&&null==e){e=this.scale,i=this.translate;var r=t.origin,o=this.graph.getCellGeometry(t.cell).getTerminalPoint(n);null!=o&&(o=new mxPoint(e*(i.x+o.x+r.x),e*(i.y+o.y+r.y)))}t.setAbsoluteTerminalPoint(o,n)},mxGraphView.prototype.updatePoints=function(t,e,n,i){if(null!=t){var o=[];o.push(t.absolutePoints[0]);var r=this.getEdgeStyle(t,e,n,i);if(null!=r)n=this.getTerminalPort(t,n,!0),i=this.getTerminalPort(t,i,!1),r(t,n,i,e,o);else if(null!=e)for(r=0;r<e.length;r++)null!=e[r]&&(i=mxUtils.clone(e[r]),o.push(this.transformControlPoint(t,i)));e=t.absolutePoints,o.push(e[e.length-1]),t.absolutePoints=o}},mxGraphView.prototype.transformControlPoint=function(t,e){var n=t.origin;return new mxPoint(this.scale*(e.x+this.translate.x+n.x),this.scale*(e.y+this.translate.y+n.y))},mxGraphView.prototype.getEdgeStyle=function(t,e,n,i){return t=null!=n&&n==i?mxUtils.getValue(t.style,mxConstants.STYLE_LOOP,this.graph.defaultLoopStyle):mxUtils.getValue(t.style,mxConstants.STYLE_NOEDGESTYLE,!1)?null:t.style[mxConstants.STYLE_EDGE],"string"==typeof t&&(e=mxStyleRegistry.getValue(t),null==e&&this.isAllowEval()&&(e=mxUtils.eval(t)),t=e),"function"==typeof t?t:null},mxGraphView.prototype.updateFloatingTerminalPoints=function(t,e,n){var i=t.absolutePoints,o=i[0];null==i[i.length-1]&&null!=n&&this.updateFloatingTerminalPoint(t,n,e,!1),null==o&&null!=e&&this.updateFloatingTerminalPoint(t,e,n,!0)},mxGraphView.prototype.updateFloatingTerminalPoint=function(t,e,n,i){e=this.getTerminalPort(t,e,i);var o=this.getNextPoint(t,n,i),r=this.graph.isOrthogonal(t);n=mxUtils.toRadians(Number(e.style[mxConstants.STYLE_ROTATION]||"0"));var s=new mxPoint(e.getCenterX(),e.getCenterY());if(0!=n)var l=Math.cos(-n),a=Math.sin(-n),o=mxUtils.getRotatedPoint(o,l,a,s);l=parseFloat(t.style[mxConstants.STYLE_PERIMETER_SPACING]||0),l+=parseFloat(t.style[i?mxConstants.STYLE_SOURCE_PERIMETER_SPACING:mxConstants.STYLE_TARGET_PERIMETER_SPACING]||0),e=this.getPerimeterPoint(e,o,0==n&&r,l),0!=n&&(l=Math.cos(n),a=Math.sin(n),e=mxUtils.getRotatedPoint(e,l,a,s)),t.setAbsoluteTerminalPoint(e,i)},mxGraphView.prototype.getTerminalPort=function(t,e,n){return t=mxUtils.getValue(t.style,n?mxConstants.STYLE_SOURCE_PORT:mxConstants.STYLE_TARGET_PORT),null!=t&&(t=this.getState(this.graph.getModel().getCell(t)),null!=t&&(e=t)),e},mxGraphView.prototype.getPerimeterPoint=function(t,e,n,i){var o=null;if(null!=t){var r=this.getPerimeterFunction(t);null!=r&&null!=e&&(i=this.getPerimeterBounds(t,i),0<i.width||0<i.height)&&(o=r(i,t,e,n)),null==o&&(o=this.getPoint(t))}return o},mxGraphView.prototype.getRoutingCenterX=function(t){var e=null!=t.style?parseFloat(t.style[mxConstants.STYLE_ROUTING_CENTER_X])||0:0;return t.getCenterX()+e*t.width},mxGraphView.prototype.getRoutingCenterY=function(t){var e=null!=t.style?parseFloat(t.style[mxConstants.STYLE_ROUTING_CENTER_Y])||0:0;return t.getCenterY()+e*t.height},mxGraphView.prototype.getPerimeterBounds=function(t,e){return e=null!=e?e:0,null!=t&&(e+=parseFloat(t.style[mxConstants.STYLE_PERIMETER_SPACING]||0)),t.getPerimeterBounds(e*this.scale)},mxGraphView.prototype.getPerimeterFunction=function(t){if(t=t.style[mxConstants.STYLE_PERIMETER],"string"==typeof t){var e=mxStyleRegistry.getValue(t);null==e&&this.isAllowEval()&&(e=mxUtils.eval(t)),t=e}return"function"==typeof t?t:null},mxGraphView.prototype.getNextPoint=function(t,e,n){t=t.absolutePoints;var i=null;return null!=t&&(n||2<t.length||null==e)&&(i=t.length,i=t[n?Math.min(1,i-1):Math.max(0,i-2)]),null==i&&null!=e&&(i=new mxPoint(e.getCenterX(),e.getCenterY())),i},mxGraphView.prototype.getVisibleTerminal=function(t,e){for(var n=this.graph.getModel(),i=n.getTerminal(t,e),o=i;null!=i&&i!=this.currentRoot;)(!this.graph.isCellVisible(o)||this.graph.isCellCollapsed(i))&&(o=i),i=n.getParent(i);return n.getParent(o)==n.getRoot()&&(o=null),o},mxGraphView.prototype.updateEdgeBounds=function(t){var e=t.absolutePoints;if(t.length=0,null!=e&&0<e.length){var n=e[0],i=e[e.length-1];if(null==n||null==i)t.cell!=this.currentRoot&&this.clear(t.cell,!0);else{if(n.x!=i.x||n.y!=i.y){var o=i.x-n.x,r=i.y-n.y;t.terminalDistance=Math.sqrt(o*o+r*r)}else t.terminalDistance=0;var i=0,s=[],r=n;if(null!=r){for(var n=r.x,l=r.y,a=n,h=l,d=1;d<e.length;d++){var u=e[d];null!=u&&(o=r.x-u.x,r=r.y-u.y,o=Math.sqrt(o*o+r*r),s.push(o),i+=o,r=u,n=Math.min(r.x,n),l=Math.min(r.y,l),a=Math.max(r.x,a),h=Math.max(r.y,h))}t.length=i,t.segments=s,t.x=n,t.y=l,t.width=Math.max(1,a-n),t.height=Math.max(1,h-l)}}}},mxGraphView.prototype.getPoint=function(t,e){var n=t.getCenterX(),i=t.getCenterY();if(null==t.segments||null!=e&&!e.relative)null!=e&&(h=e.offset,null!=h&&(n+=h.x,i+=h.y));else{for(var o=t.absolutePoints.length,r=((null!=e?e.x/2:0)+.5)*t.length,s=t.segments[0],l=0,a=1;r>l+s&&o-1>a;)l+=s,s=t.segments[a++];if(o=0==s?0:(r-l)/s,r=t.absolutePoints[a-1],a=t.absolutePoints[a],null!=r&&null!=a){if(l=n=i=0,null!=e){var i=e.y,h=e.offset;null!=h&&(n=h.x,l=h.y)}h=a.x-r.x,a=a.y-r.y,n=r.x+h*o+((0==s?0:a/s)*i+n)*this.scale,i=r.y+a*o-((0==s?0:h/s)*i-l)*this.scale}}return new mxPoint(n,i)},mxGraphView.prototype.getRelativePoint=function(t,e,n){var i=this.graph.getModel().getGeometry(t.cell);if(null!=i){var o=t.absolutePoints.length;if(i.relative&&o>1){for(var i=t.length,r=t.segments,s=t.absolutePoints[0],l=t.absolutePoints[1],a=mxUtils.ptSegDistSq(s.x,s.y,l.x,l.y,e,n),h=0,d=0,u=0,c=2;o>c;c++)d+=r[c-2],l=t.absolutePoints[c],s=mxUtils.ptSegDistSq(s.x,s.y,l.x,l.y,e,n),a>=s&&(a=s,h=c-1,u=d),s=l;return o=r[h],s=t.absolutePoints[h],l=t.absolutePoints[h+1],a=l.x,r=l.y,t=s.x-a,h=s.y-r,a=e-a,r=n-r,a=t-a,r=h-r,r=a*t+r*h,t=Math.sqrt(0>=r?0:r*r/(t*t+h*h)),t>o&&(t=o),o=Math.sqrt(mxUtils.ptSegDistSq(s.x,s.y,l.x,l.y,e,n)),-1==mxUtils.relativeCcw(s.x,s.y,l.x,l.y,e,n)&&(o=-o),new mxPoint(-2*((i/2-u-t)/i),o/this.scale)}}return new mxPoint},mxGraphView.prototype.updateEdgeLabelOffset=function(t){var e=t.absolutePoints;if(t.absoluteOffset.x=t.getCenterX(),t.absoluteOffset.y=t.getCenterY(),null!=e&&0<e.length&&null!=t.segments){var n=this.graph.getCellGeometry(t.cell);if(n.relative){var i=this.getPoint(t,n);null!=i&&(t.absoluteOffset=i)}else{var i=e[0],o=e[e.length-1];if(null!=i&&null!=o){var e=o.x-i.x,r=o.y-i.y,s=o=0,n=n.offset;null!=n&&(o=n.x,s=n.y),n=i.y+r/2+s*this.scale,t.absoluteOffset.x=i.x+e/2+o*this.scale,t.absoluteOffset.y=n}}}},mxGraphView.prototype.getState=function(t,e){e=e||!1;var n=null;return null!=t&&(n=this.states.get(t),this.graph.isCellVisible(t)&&(null==n&&e&&this.graph.isCellVisible(t)?(n=this.createState(t),this.states.put(t,n)):e&&null!=n&&this.updateStyle&&(n.style=this.graph.getCellStyle(t)))),n},mxGraphView.prototype.isRendering=function(){return this.rendering},mxGraphView.prototype.setRendering=function(t){this.rendering=t},mxGraphView.prototype.isAllowEval=function(){return this.allowEval},mxGraphView.prototype.setAllowEval=function(t){this.allowEval=t},mxGraphView.prototype.getStates=function(){return this.states},mxGraphView.prototype.setStates=function(t){this.states=t},mxGraphView.prototype.getCellStates=function(t){if(null==t)return this.states;for(var e=[],n=0;n<t.length;n++){var i=this.getState(t[n]);null!=i&&e.push(i)}return e},mxGraphView.prototype.removeState=function(t){var e=null;return null!=t&&(e=this.states.remove(t),null!=e&&(this.graph.cellRenderer.destroy(e),e.destroy())),e},mxGraphView.prototype.createState=function(t){var e=this.graph.getCellStyle(t);return t=new mxCellState(this,t,e),this.graph.cellRenderer.initialize(t,this.isRendering()),t},mxGraphView.prototype.getCanvas=function(){return this.canvas},mxGraphView.prototype.getBackgroundPane=function(){return this.backgroundPane},mxGraphView.prototype.getDrawPane=function(){return this.drawPane},mxGraphView.prototype.getOverlayPane=function(){return this.overlayPane},mxGraphView.prototype.isContainerEvent=function(t){return t=mxEvent.getSource(t),t==this.graph.container||t.parentNode==this.backgroundPane||null!=t.parentNode&&t.parentNode.parentNode==this.backgroundPane||t==this.canvas.parentNode||t==this.canvas||t==this.backgroundPane||t==this.drawPane||t==this.overlayPane},mxGraphView.prototype.isScrollEvent=function(t){var e=mxUtils.getOffset(this.graph.container);t=new mxPoint(t.clientX-e.x,t.clientY-e.y);var e=this.graph.container.offsetWidth,n=this.graph.container.clientWidth;return e>n&&t.x>n+2&&t.x<=e?!0:(e=this.graph.container.offsetHeight,n=this.graph.container.clientHeight,e>n&&t.y>n+2&&t.y<=e?!0:!1)},mxGraphView.prototype.init=function(){this.installListeners();var t=this.graph;t.dialect==mxConstants.DIALECT_SVG?this.createSvg():t.dialect==mxConstants.DIALECT_VML?this.createVml():this.createHtml()},mxGraphView.prototype.installListeners=function(){var t=this.graph,e=t.container;if(null!=e){mxEvent.addGestureListeners(e,mxUtils.bind(this,function(e){mxClient.IS_TOUCH&&t.isEditing()&&t.stopEditing(!t.isInvokesStopCellEditing()),this.isContainerEvent(e)&&(!mxClient.IS_IE&&!mxClient.IS_GC&&!mxClient.IS_OP&&!mxClient.IS_SF||!this.isScrollEvent(e))&&t.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(e))}),mxUtils.bind(this,function(e){this.isContainerEvent(e)&&t.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(e))}),mxUtils.bind(this,function(e){this.isContainerEvent(e)&&t.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(e))})),mxEvent.addListener(e,"dblclick",mxUtils.bind(this,function(e){t.dblClick(e)}));var n=function(n){var i=null;return mxClient.IS_TOUCH&&(i=mxEvent.getClientX(n),n=mxEvent.getClientY(n),n=mxUtils.convertPoint(e,i,n),i=t.view.getState(t.getCellAt(n.x,n.y))),i};t.addMouseListener({mouseDown:function(){t.panningHandler.hideMenu()},mouseMove:function(){},mouseUp:function(){}}),this.moveHandler=mxUtils.bind(this,function(e){null!=t.tooltipHandler&&t.tooltipHandler.isHideOnHover()&&t.tooltipHandler.hide(),this.captureDocumentGesture&&t.isMouseDown&&!mxEvent.isConsumed(e)&&t.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(e,n(e)))}),this.endHandler=mxUtils.bind(this,function(e){this.captureDocumentGesture&&t.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(e))}),mxEvent.addGestureListeners(document,null,this.moveHandler,this.endHandler)}},mxGraphView.prototype.createHtml=function(){var t=this.graph.container;null!=t&&(this.canvas=this.createHtmlPane("100%","100%"),this.backgroundPane=this.createHtmlPane("1px","1px"),this.drawPane=this.createHtmlPane("1px","1px"),this.overlayPane=this.createHtmlPane("1px","1px"),this.canvas.appendChild(this.backgroundPane),this.canvas.appendChild(this.drawPane),this.canvas.appendChild(this.overlayPane),t.appendChild(this.canvas),mxClient.IS_QUIRKS&&(t=mxUtils.bind(this,function(t){t=this.getGraphBounds(),this.updateHtmlCanvasSize(t.x+t.width+this.graph.border,t.y+t.height+this.graph.border)}),mxEvent.addListener(window,"resize",t)))},mxGraphView.prototype.updateHtmlCanvasSize=function(t,e){if(null!=this.graph.container){var n=this.graph.container.offsetHeight;this.canvas.style.width=this.graph.container.offsetWidth<t?t+"px":"100%",this.canvas.style.height=e>n?e+"px":"100%"}},mxGraphView.prototype.createHtmlPane=function(t,e){var n=document.createElement("DIV");return null!=t&&null!=e?(n.style.position="absolute",n.style.left="0px",n.style.top="0px",n.style.width=t,n.style.height=e):n.style.position="relative",n},mxGraphView.prototype.createVml=function(){var t=this.graph.container;if(null!=t){var e=t.offsetWidth,n=t.offsetHeight;this.canvas=this.createVmlPane(e,n),this.backgroundPane=this.createVmlPane(e,n),this.drawPane=this.createVmlPane(e,n),this.overlayPane=this.createVmlPane(e,n),this.canvas.appendChild(this.backgroundPane),this.canvas.appendChild(this.drawPane),this.canvas.appendChild(this.overlayPane),t.appendChild(this.canvas)}},mxGraphView.prototype.createVmlPane=function(t,e){var n=document.createElement(mxClient.VML_PREFIX+":group");return n.style.position="absolute",n.style.left="0px",n.style.top="0px",n.style.width=t+"px",n.style.height=e+"px",n.setAttribute("coordsize",t+","+e),n.setAttribute("coordorigin","0,0"),n},mxGraphView.prototype.createSvg=function(){var t=this.graph.container;this.canvas=document.createElementNS(mxConstants.NS_SVG,"g"),this.backgroundPane=document.createElementNS(mxConstants.NS_SVG,"g"),this.canvas.appendChild(this.backgroundPane),this.drawPane=document.createElementNS(mxConstants.NS_SVG,"g"),this.canvas.appendChild(this.drawPane),this.overlayPane=document.createElementNS(mxConstants.NS_SVG,"g"),this.canvas.appendChild(this.overlayPane);
var e=document.createElementNS(mxConstants.NS_SVG,"svg");e.style.width="100%",e.style.height="100%",e.style.display="block",e.appendChild(this.canvas),null!=t&&(t.appendChild(e),this.updateContainerStyle(t))},mxGraphView.prototype.updateContainerStyle=function(t){"static"==mxUtils.getCurrentStyle(t).position&&(t.style.position="relative"),mxClient.IS_POINTER&&(t.style.msTouchAction="none")},mxGraphView.prototype.destroy=function(){var t=null!=this.canvas?this.canvas.ownerSVGElement:null;null==t&&(t=this.canvas),null!=t&&null!=t.parentNode&&(this.clear(this.currentRoot,!0),mxEvent.removeGestureListeners(document,null,this.moveHandler,this.endHandler),mxEvent.release(this.graph.container),t.parentNode.removeChild(t),this.overlayPane=this.drawPane=this.backgroundPane=this.canvas=this.endHandler=this.moveHandler=null)},mxCurrentRootChange.prototype.execute=function(){var t=this.view.currentRoot;this.view.currentRoot=this.previous,this.previous=t,t=this.view.graph.getTranslateForRoot(this.view.currentRoot),null!=t&&(this.view.translate=new mxPoint(-t.x,-t.y)),this.view.fireEvent(new mxEventObject(this.isUp?mxEvent.UP:mxEvent.DOWN,"root",this.view.currentRoot,"previous",this.previous)),this.isUp?(this.view.clear(this.view.currentRoot,!0),this.view.validate()):this.view.refresh(),this.isUp=!this.isUp},mxLoadResources&&mxResources.add(mxClient.basePath+"/resources/graph"),mxGraph.prototype=new mxEventSource,mxGraph.prototype.constructor=mxGraph,mxGraph.prototype.EMPTY_ARRAY=[],mxGraph.prototype.mouseListeners=null,mxGraph.prototype.isMouseDown=!1,mxGraph.prototype.model=null,mxGraph.prototype.view=null,mxGraph.prototype.stylesheet=null,mxGraph.prototype.selectionModel=null,mxGraph.prototype.cellEditor=null,mxGraph.prototype.cellRenderer=null,mxGraph.prototype.multiplicities=null,mxGraph.prototype.renderHint=null,mxGraph.prototype.dialect=null,mxGraph.prototype.gridSize=10,mxGraph.prototype.gridEnabled=!0,mxGraph.prototype.portsEnabled=!0,mxGraph.prototype.doubleTapEnabled=!0,mxGraph.prototype.doubleTapTimeout=700,mxGraph.prototype.doubleTapTolerance=25,mxGraph.prototype.lastTouchY=0,mxGraph.prototype.lastTouchY=0,mxGraph.prototype.lastTouchTime=0,mxGraph.prototype.gestureEnabled=!0,mxGraph.prototype.tolerance=4,mxGraph.prototype.defaultOverlap=.5,mxGraph.prototype.defaultParent=null,mxGraph.prototype.alternateEdgeStyle=null,mxGraph.prototype.backgroundImage=null,mxGraph.prototype.pageVisible=!1,mxGraph.prototype.pageBreaksVisible=!1,mxGraph.prototype.pageBreakColor="gray",mxGraph.prototype.pageBreakDashed=!0,mxGraph.prototype.minPageBreakDist=20,mxGraph.prototype.preferPageSize=!1,mxGraph.prototype.pageFormat=mxConstants.PAGE_FORMAT_A4_PORTRAIT,mxGraph.prototype.pageScale=1.5,mxGraph.prototype.enabled=!0,mxGraph.prototype.escapeEnabled=!0,mxGraph.prototype.invokesStopCellEditing=!0,mxGraph.prototype.enterStopsCellEditing=!1,mxGraph.prototype.useScrollbarsForPanning=!0,mxGraph.prototype.exportEnabled=!0,mxGraph.prototype.importEnabled=!0,mxGraph.prototype.cellsLocked=!1,mxGraph.prototype.cellsCloneable=!0,mxGraph.prototype.foldingEnabled=!0,mxGraph.prototype.cellsEditable=!0,mxGraph.prototype.cellsDeletable=!0,mxGraph.prototype.cellsMovable=!0,mxGraph.prototype.edgeLabelsMovable=!0,mxGraph.prototype.vertexLabelsMovable=!1,mxGraph.prototype.dropEnabled=!1,mxGraph.prototype.splitEnabled=!0,mxGraph.prototype.cellsResizable=!0,mxGraph.prototype.cellsBendable=!0,mxGraph.prototype.cellsSelectable=!0,mxGraph.prototype.cellsDisconnectable=!0,mxGraph.prototype.autoSizeCells=!1,mxGraph.prototype.autoScroll=!0,mxGraph.prototype.timerAutoScroll=!1,mxGraph.prototype.allowAutoPanning=!1,mxGraph.prototype.ignoreScrollbars=!1,mxGraph.prototype.autoExtend=!0,mxGraph.prototype.maximumGraphBounds=null,mxGraph.prototype.minimumGraphSize=null,mxGraph.prototype.minimumContainerSize=null,mxGraph.prototype.maximumContainerSize=null,mxGraph.prototype.resizeContainer=!1,mxGraph.prototype.border=0,mxGraph.prototype.ordered=!0,mxGraph.prototype.keepEdgesInForeground=!1,mxGraph.prototype.keepEdgesInBackground=!0,mxGraph.prototype.allowNegativeCoordinates=!0,mxGraph.prototype.constrainChildren=!0,mxGraph.prototype.extendParents=!0,mxGraph.prototype.extendParentsOnAdd=!0,mxGraph.prototype.collapseToPreferredSize=!0,mxGraph.prototype.zoomFactor=1.2,mxGraph.prototype.keepSelectionVisibleOnZoom=!1,mxGraph.prototype.centerZoom=!0,mxGraph.prototype.resetViewOnRootChange=!0,mxGraph.prototype.resetEdgesOnResize=!1,mxGraph.prototype.resetEdgesOnMove=!1,mxGraph.prototype.resetEdgesOnConnect=!0,mxGraph.prototype.allowLoops=!1,mxGraph.prototype.defaultLoopStyle=mxEdgeStyle.Loop,mxGraph.prototype.multigraph=!0,mxGraph.prototype.connectableEdges=!1,mxGraph.prototype.allowDanglingEdges=!0,mxGraph.prototype.cloneInvalidEdges=!1,mxGraph.prototype.disconnectOnMove=!0,mxGraph.prototype.labelsVisible=!0,mxGraph.prototype.htmlLabels=!1,mxGraph.prototype.swimlaneSelectionEnabled=!0,mxGraph.prototype.swimlaneNesting=!0,mxGraph.prototype.swimlaneIndicatorColorAttribute=mxConstants.STYLE_FILLCOLOR,mxGraph.prototype.imageBundles=null,mxGraph.prototype.minFitScale=.1,mxGraph.prototype.maxFitScale=8,mxGraph.prototype.panDx=0,mxGraph.prototype.panDy=0,mxGraph.prototype.collapsedImage=new mxImage(mxClient.imageBasePath+"/collapsed.gif",9,9),mxGraph.prototype.expandedImage=new mxImage(mxClient.imageBasePath+"/expanded.gif",9,9),mxGraph.prototype.warningImage=new mxImage(mxClient.imageBasePath+"/warning"+(mxClient.IS_MAC?".png":".gif"),16,16),mxGraph.prototype.alreadyConnectedResource="none"!=mxClient.language?"alreadyConnected":"",mxGraph.prototype.containsValidationErrorsResource="none"!=mxClient.language?"containsValidationErrors":"",mxGraph.prototype.collapseExpandResource="none"!=mxClient.language?"collapse-expand":"",mxGraph.prototype.init=function(t){this.container=t,this.cellEditor=this.createCellEditor(),this.view.init(),this.sizeDidChange(),mxClient.IS_IE&&(mxEvent.addListener(window,"unload",mxUtils.bind(this,function(){this.destroy()})),mxEvent.addListener(t,"selectstart",mxUtils.bind(this,function(){return this.isEditing()}))),8==document.documentMode&&t.insertAdjacentHTML("beforeend",'<v:group style="DISPLAY: none;"></v:group>')},mxGraph.prototype.createHandlers=function(){this.tooltipHandler=new mxTooltipHandler(this),this.tooltipHandler.setEnabled(!1),this.panningHandler=new mxPanningHandler(this),this.panningHandler.panningEnabled=!1,this.selectionCellsHandler=new mxSelectionCellsHandler(this),this.connectionHandler=new mxConnectionHandler(this),this.connectionHandler.setEnabled(!1),this.graphHandler=new mxGraphHandler(this)},mxGraph.prototype.createSelectionModel=function(){return new mxGraphSelectionModel(this)},mxGraph.prototype.createStylesheet=function(){return new mxStylesheet},mxGraph.prototype.createGraphView=function(){return new mxGraphView(this)},mxGraph.prototype.createCellRenderer=function(){return new mxCellRenderer},mxGraph.prototype.createCellEditor=function(){return new mxCellEditor(this)},mxGraph.prototype.getModel=function(){return this.model},mxGraph.prototype.getView=function(){return this.view},mxGraph.prototype.getStylesheet=function(){return this.stylesheet},mxGraph.prototype.setStylesheet=function(t){this.stylesheet=t},mxGraph.prototype.getSelectionModel=function(){return this.selectionModel},mxGraph.prototype.setSelectionModel=function(t){this.selectionModel=t},mxGraph.prototype.getSelectionCellsForChanges=function(t){for(var e=[],n=0;n<t.length;n++){var i=t[n];if(i.constructor!=mxRootChange){var o=null;i instanceof mxChildChange&&null==i.previous?o=i.child:null!=i.cell&&i.cell instanceof mxCell&&(o=i.cell),null!=o&&0>mxUtils.indexOf(e,o)&&e.push(o)}}return this.getModel().getTopmostCells(e)},mxGraph.prototype.graphModelChanged=function(t){for(var e=0;e<t.length;e++)this.processChange(t[e]);this.removeSelectionCells(this.getRemovedCellsForChanges(t)),this.view.validate(),this.sizeDidChange()},mxGraph.prototype.getRemovedCellsForChanges=function(t){for(var e=[],n=0;n<t.length;n++){var i=t[n];if(i instanceof mxRootChange)break;i instanceof mxChildChange?null!=i.previous&&null==i.parent&&(e=e.concat(this.model.getDescendants(i.child))):i instanceof mxVisibleChange&&(e=e.concat(this.model.getDescendants(i.cell)))}return e},mxGraph.prototype.processChange=function(t){if(t instanceof mxRootChange)this.clearSelection(),this.removeStateForCell(t.previous),this.resetViewOnRootChange&&(this.view.scale=1,this.view.translate.x=0,this.view.translate.y=0),this.fireEvent(new mxEventObject(mxEvent.ROOT));else if(t instanceof mxChildChange){var e=this.model.getParent(t.child);null!=e?this.view.invalidate(t.child,!0,!1,null!=t.previous):(this.removeStateForCell(t.child),this.view.currentRoot==t.child&&this.home()),e!=t.previous&&(null!=e&&this.view.invalidate(e,!1,!1),null!=t.previous&&this.view.invalidate(t.previous,!1,!1))}else t instanceof mxTerminalChange||t instanceof mxGeometryChange?this.view.invalidate(t.cell):t instanceof mxValueChange?this.view.invalidate(t.cell,!1,!1):t instanceof mxStyleChange?(this.view.invalidate(t.cell,!0,!0,!1),this.view.removeState(t.cell)):null!=t.cell&&t.cell instanceof mxCell&&this.removeStateForCell(t.cell)},mxGraph.prototype.removeStateForCell=function(t){for(var e=this.model.getChildCount(t),n=0;e>n;n++)this.removeStateForCell(this.model.getChildAt(t,n));this.view.removeState(t)},mxGraph.prototype.addCellOverlay=function(t,e){null==t.overlays&&(t.overlays=[]),t.overlays.push(e);var n=this.view.getState(t);return null!=n&&this.cellRenderer.redraw(n),this.fireEvent(new mxEventObject(mxEvent.ADD_OVERLAY,"cell",t,"overlay",e)),e},mxGraph.prototype.getCellOverlays=function(t){return t.overlays},mxGraph.prototype.removeCellOverlay=function(t,e){if(null==e)this.removeCellOverlays(t);else{var n=mxUtils.indexOf(t.overlays,e);n>=0?(t.overlays.splice(n,1),0==t.overlays.length&&(t.overlays=null),n=this.view.getState(t),null!=n&&this.cellRenderer.redraw(n),this.fireEvent(new mxEventObject(mxEvent.REMOVE_OVERLAY,"cell",t,"overlay",e))):e=null}return e},mxGraph.prototype.removeCellOverlays=function(t){var e=t.overlays;if(null!=e){t.overlays=null;var n=this.view.getState(t);for(null!=n&&this.cellRenderer.redraw(n),n=0;n<e.length;n++)this.fireEvent(new mxEventObject(mxEvent.REMOVE_OVERLAY,"cell",t,"overlay",e[n]))}return e},mxGraph.prototype.clearCellOverlays=function(t){t=null!=t?t:this.model.getRoot(),this.removeCellOverlays(t);for(var e=this.model.getChildCount(t),n=0;e>n;n++){var i=this.model.getChildAt(t,n);this.clearCellOverlays(i)}},mxGraph.prototype.setCellWarning=function(t,e,n,i){return null!=e&&0<e.length?(n=null!=n?n:this.warningImage,e=new mxCellOverlay(n,"<font color=red>"+e+"</font>"),i&&e.addListener(mxEvent.CLICK,mxUtils.bind(this,function(){this.isEnabled()&&this.setSelectionCell(t)})),this.addCellOverlay(t,e)):(this.removeCellOverlays(t),null)},mxGraph.prototype.startEditing=function(t){this.startEditingAtCell(null,t)},mxGraph.prototype.startEditingAtCell=function(t,e){null==t&&(t=this.getSelectionCell(),null!=t&&!this.isCellEditable(t)&&(t=null)),null!=t&&(this.fireEvent(new mxEventObject(mxEvent.START_EDITING,"cell",t,"event",e)),this.cellEditor.startEditing(t,e))},mxGraph.prototype.getEditingValue=function(t){return this.convertValueToString(t)},mxGraph.prototype.stopEditing=function(t){this.cellEditor.stopEditing(t)},mxGraph.prototype.labelChanged=function(t,e,n){this.model.beginUpdate();try{this.cellLabelChanged(t,e,this.isAutoSizeCell(t)),this.fireEvent(new mxEventObject(mxEvent.LABEL_CHANGED,"cell",t,"value",e,"event",n))}finally{this.model.endUpdate()}return t},mxGraph.prototype.cellLabelChanged=function(t,e,n){this.model.beginUpdate();try{this.model.setValue(t,e),n&&this.cellSizeUpdated(t,!1)}finally{this.model.endUpdate()}},mxGraph.prototype.escape=function(t){this.stopEditing(!0),this.connectionHandler.reset(),this.graphHandler.reset(),t=this.getSelectionCells();for(var e=0;e<t.length;e++){var n=this.view.getState(t[e]);null!=n&&null!=n.handler&&n.handler.reset()}},mxGraph.prototype.click=function(t){var e=t.getEvent(),n=t.getCell(),i=new mxEventObject(mxEvent.CLICK,"event",e,"cell",n);t.isConsumed()&&i.consume(),this.fireEvent(i),this.isEnabled()&&!mxEvent.isConsumed(e)&&!i.isConsumed()&&(null!=n?this.selectCellForEvent(n,e):(n=null,this.isSwimlaneSelectionEnabled()&&(n=this.getSwimlaneAt(t.getGraphX(),t.getGraphY())),null!=n?this.selectCellForEvent(n,e):this.isToggleEvent(e)||this.clearSelection()))},mxGraph.prototype.dblClick=function(t,e){var n=new mxEventObject(mxEvent.DOUBLE_CLICK,"event",t,"cell",e);this.fireEvent(n),this.isEnabled()&&!mxEvent.isConsumed(t)&&!n.isConsumed()&&null!=e&&this.isCellEditable(e)&&this.startEditingAtCell(e,t)},mxGraph.prototype.scrollPointToVisible=function(t,e,n,i){if(this.timerAutoScroll||!this.ignoreScrollbars&&!mxUtils.hasScrollbars(this.container))this.allowAutoPanning&&!this.panningHandler.active&&(null==this.panningManager&&(this.panningManager=this.createPanningManager()),this.panningManager.panTo(t+this.panDx,e+this.panDy));else{var o=this.container;if(i=null!=i?i:20,t>=o.scrollLeft&&e>=o.scrollTop&&t<=o.scrollLeft+o.clientWidth&&e<=o.scrollTop+o.clientHeight){var r=o.scrollLeft+o.clientWidth-t;if(i>r){if(t=o.scrollLeft,o.scrollLeft+=i-r,n&&t==o.scrollLeft){if(this.dialect==mxConstants.DIALECT_SVG){t=this.view.getDrawPane().ownerSVGElement;var s=this.container.scrollWidth+i-r}else s=Math.max(o.clientWidth,o.scrollWidth)+i-r,t=this.view.getCanvas();t.style.width=s+"px",o.scrollLeft+=i-r}}else r=t-o.scrollLeft,i>r&&(o.scrollLeft-=i-r);r=o.scrollTop+o.clientHeight-e,i>r?(t=o.scrollTop,o.scrollTop+=i-r,t==o.scrollTop&&n&&(this.dialect==mxConstants.DIALECT_SVG?(t=this.view.getDrawPane().ownerSVGElement,e=this.container.scrollHeight+i-r):(e=Math.max(o.clientHeight,o.scrollHeight)+i-r,t=this.view.getCanvas()),t.style.height=e+"px",o.scrollTop+=i-r)):(r=e-o.scrollTop,i>r&&(o.scrollTop-=i-r))}}},mxGraph.prototype.createPanningManager=function(){return new mxPanningManager(this)},mxGraph.prototype.getBorderSizes=function(){function t(t){var e=0,e="thin"==t?2:"medium"==t?4:"thick"==t?6:parseInt(t);return isNaN(e)&&(e=0),e}var e=mxUtils.getCurrentStyle(this.container),n=new mxRectangle;return n.x=t(e.borderLeftWidth)+parseInt(e.paddingLeft||0),n.y=t(e.borderTopWidth)+parseInt(e.paddingTop||0),n.width=t(e.borderRightWidth)+parseInt(e.paddingRight||0),n.height=t(e.borderBottomWidth)+parseInt(e.paddingBottom||0),n},mxGraph.prototype.getPreferredPageSize=function(t,e,n){t=this.view.scale;var i=this.view.translate,o=this.pageFormat,r=t*this.pageScale,o=new mxRectangle(0,0,o.width*r,o.height*r);return e=this.pageBreaksVisible?Math.ceil(e/o.width):1,n=this.pageBreaksVisible?Math.ceil(n/o.height):1,new mxRectangle(0,0,e*o.width+2+i.x/t,n*o.height+2+i.y/t)},mxGraph.prototype.sizeDidChange=function(){var t=this.getGraphBounds();if(null!=this.container){var e=this.getBorder(),n=Math.max(0,t.x+t.width+1+e),e=Math.max(0,t.y+t.height+1+e);if(null!=this.minimumContainerSize&&(n=Math.max(n,this.minimumContainerSize.width),e=Math.max(e,this.minimumContainerSize.height)),this.resizeContainer&&this.doResizeContainer(n,e),this.preferPageSize||!mxClient.IS_IE&&this.pageVisible){var i=this.getPreferredPageSize(t,n,e);null!=i&&(n=i.width,e=i.height)}null!=this.minimumGraphSize&&(n=Math.max(n,this.minimumGraphSize.width*this.view.scale),e=Math.max(e,this.minimumGraphSize.height*this.view.scale)),n=Math.ceil(n-1),e=Math.ceil(e-1),this.dialect==mxConstants.DIALECT_SVG?(i=this.view.getDrawPane().ownerSVGElement,i.style.minWidth=Math.max(1,n)+"px",i.style.minHeight=Math.max(1,e)+"px",i.style.width="100%",i.style.height="100%"):mxClient.IS_QUIRKS?this.view.updateHtmlCanvasSize(Math.max(1,n),Math.max(1,e)):(this.view.canvas.style.minWidth=Math.max(1,n)+"px",this.view.canvas.style.minHeight=Math.max(1,e)+"px"),this.updatePageBreaks(this.pageBreaksVisible,n-1,e-1)}this.fireEvent(new mxEventObject(mxEvent.SIZE,"bounds",t))},mxGraph.prototype.doResizeContainer=function(t,e){if(mxClient.IS_IE)if(mxClient.IS_QUIRKS){var n=this.getBorderSizes();t+=Math.max(2,n.x+n.width+1),e+=Math.max(2,n.y+n.height+1)}else 9<=document.documentMode?(t+=3,e+=5):(t+=1,e+=1);else e+=1;null!=this.maximumContainerSize&&(t=Math.min(this.maximumContainerSize.width,t),e=Math.min(this.maximumContainerSize.height,e)),this.container.style.width=Math.ceil(t)+"px",this.container.style.height=Math.ceil(e)+"px"},mxGraph.prototype.updatePageBreaks=function(t,e,n){var i=this.view.scale,o=this.view.translate,r=this.pageFormat,s=i*this.pageScale,o=new mxRectangle(i*o.x,i*o.y,r.width*s,r.height*s);if(t=t&&Math.min(o.width,o.height)>this.minPageBreakDist,o.x=mxUtils.mod(o.x,o.width),o.y=mxUtils.mod(o.y,o.height),r=t?Math.ceil((e-o.x)/o.width):0,t=t?Math.ceil((n-o.y)/o.height):0,null==this.horizontalPageBreaks&&r>0&&(this.horizontalPageBreaks=[]),null!=this.horizontalPageBreaks){for(s=0;r>=s;s++){var l=[new mxPoint(o.x+s*o.width,1),new mxPoint(o.x+s*o.width,n)];null!=this.horizontalPageBreaks[s]?(this.horizontalPageBreaks[s].scale=1,this.horizontalPageBreaks[s].points=l,this.horizontalPageBreaks[s].redraw()):(l=new mxPolyline(l,this.pageBreakColor,this.scale),l.dialect=this.dialect,l.isDashed=this.pageBreakDashed,l.scale=i,l.init(this.view.backgroundPane),l.redraw(),this.horizontalPageBreaks[s]=l)}for(s=r;s<this.horizontalPageBreaks.length;s++)this.horizontalPageBreaks[s].destroy();this.horizontalPageBreaks.splice(r,this.horizontalPageBreaks.length-r)}if(null==this.verticalPageBreaks&&t>0&&(this.verticalPageBreaks=[]),null!=this.verticalPageBreaks){for(s=0;t>=s;s++)l=[new mxPoint(1,o.y+s*o.height),new mxPoint(e,o.y+s*o.height)],null!=this.verticalPageBreaks[s]?(this.verticalPageBreaks[s].scale=1,this.verticalPageBreaks[s].points=l,this.verticalPageBreaks[s].redraw()):(l=new mxPolyline(l,this.pageBreakColor,i),l.dialect=this.dialect,l.isDashed=this.pageBreakDashed,l.scale=i,l.init(this.view.backgroundPane),l.redraw(),this.verticalPageBreaks[s]=l);for(s=t;s<this.verticalPageBreaks.length;s++)this.verticalPageBreaks[s].destroy();this.verticalPageBreaks.splice(t,this.verticalPageBreaks.length-t)}},mxGraph.prototype.getCellStyle=function(t){var e=this.model.getStyle(t),n=null,n=this.model.isEdge(t)?this.stylesheet.getDefaultEdgeStyle():this.stylesheet.getDefaultVertexStyle();return null!=e&&(n=this.postProcessCellStyle(this.stylesheet.getCellStyle(e,n))),null==n&&(n=mxGraph.prototype.EMPTY_ARRAY),n},mxGraph.prototype.postProcessCellStyle=function(t){if(null!=t){var e=t[mxConstants.STYLE_IMAGE],n=this.getImageFromBundles(e);null!=n?t[mxConstants.STYLE_IMAGE]=n:n=e,null!=n&&"data:image/"==n.substring(0,11)&&("data:image/svg+xml,"!=n.substring(0,19)&&(e=n.indexOf(","),e>0&&(n=n.substring(0,e)+";base64,"+n.substring(e+1))),t[mxConstants.STYLE_IMAGE]=n)}return t},mxGraph.prototype.setCellStyle=function(t,e){if(e=e||this.getSelectionCells(),null!=e){this.model.beginUpdate();try{for(var n=0;n<e.length;n++)this.model.setStyle(e[n],t)}finally{this.model.endUpdate()}}},mxGraph.prototype.toggleCellStyle=function(t,e,n){n=n||this.getSelectionCell(),this.toggleCellStyles(t,e,[n])},mxGraph.prototype.toggleCellStyles=function(t,e,n){if(e=null!=e?e:!1,n=n||this.getSelectionCells(),null!=n&&0<n.length){var i=this.view.getState(n[0]),i=null!=i?i.style:this.getCellStyle(n[0]);null!=i&&(e=mxUtils.getValue(i,t,e)?0:1,this.setCellStyles(t,e,n))}},mxGraph.prototype.setCellStyles=function(t,e,n){n=n||this.getSelectionCells(),mxUtils.setCellStyles(this.model,n,t,e)},mxGraph.prototype.toggleCellStyleFlags=function(t,e,n){this.setCellStyleFlags(t,e,null,n)},mxGraph.prototype.setCellStyleFlags=function(t,e,n,i){if(i=i||this.getSelectionCells(),null!=i&&0<i.length){if(null==n){var o=this.view.getState(i[0]),o=null!=o?o.style:this.getCellStyle(i[0]);null!=o&&(n=(parseInt(o[t]||0)&e)!=e)}mxUtils.setCellStyleFlags(this.model,i,t,e,n)}},mxGraph.prototype.alignCells=function(t,e,n){if(null==e&&(e=this.getSelectionCells()),null!=e&&1<e.length){if(null==n)for(var i=0;i<e.length;i++){var o=this.getCellGeometry(e[i]);if(null!=o&&!this.model.isEdge(e[i]))if(null==n){if(t==mxConstants.ALIGN_CENTER){n=o.x+o.width/2;break}if(t==mxConstants.ALIGN_RIGHT)n=o.x+o.width;else if(t==mxConstants.ALIGN_TOP)n=o.y;else{if(t==mxConstants.ALIGN_MIDDLE){n=o.y+o.height/2;break}n=t==mxConstants.ALIGN_BOTTOM?o.y+o.height:o.x}}else n=t==mxConstants.ALIGN_RIGHT?Math.max(n,o.x+o.width):t==mxConstants.ALIGN_TOP?Math.min(n,o.y):t==mxConstants.ALIGN_BOTTOM?Math.max(n,o.y+o.height):Math.min(n,o.x)}if(null!=n){this.model.beginUpdate();try{for(i=0;i<e.length;i++)o=this.getCellGeometry(e[i]),null!=o&&!this.model.isEdge(e[i])&&(o=o.clone(),t==mxConstants.ALIGN_CENTER?o.x=n-o.width/2:t==mxConstants.ALIGN_RIGHT?o.x=n-o.width:t==mxConstants.ALIGN_TOP?o.y=n:t==mxConstants.ALIGN_MIDDLE?o.y=n-o.height/2:t==mxConstants.ALIGN_BOTTOM?o.y=n-o.height:o.x=n,this.model.setGeometry(e[i],o));this.fireEvent(new mxEventObject(mxEvent.ALIGN_CELLS,"align",t,"cells",e))}finally{this.model.endUpdate()}}}return e},mxGraph.prototype.flipEdge=function(t){if(null!=t&&null!=this.alternateEdgeStyle){this.model.beginUpdate();try{var e=this.model.getStyle(t);null==e||0==e.length?this.model.setStyle(t,this.alternateEdgeStyle):this.model.setStyle(t,null),this.resetEdge(t),this.fireEvent(new mxEventObject(mxEvent.FLIP_EDGE,"edge",t))}finally{this.model.endUpdate()}}return t},mxGraph.prototype.addImageBundle=function(t){this.imageBundles.push(t)},mxGraph.prototype.removeImageBundle=function(t){for(var e=[],n=0;n<this.imageBundles.length;n++)this.imageBundles[n]!=t&&e.push(this.imageBundles[n]);this.imageBundles=e},mxGraph.prototype.getImageFromBundles=function(t){if(null!=t)for(var e=0;e<this.imageBundles.length;e++){var n=this.imageBundles[e].getImage(t);if(null!=n)return n}return null},mxGraph.prototype.orderCells=function(t,e){null==e&&(e=mxUtils.sortCells(this.getSelectionCells(),!0)),this.model.beginUpdate();try{this.cellsOrdered(e,t),this.fireEvent(new mxEventObject(mxEvent.ORDER_CELLS,"back",t,"cells",e))}finally{this.model.endUpdate()}return e},mxGraph.prototype.cellsOrdered=function(t,e){if(null!=t){this.model.beginUpdate();try{for(var n=0;n<t.length;n++){var i=this.model.getParent(t[n]);e?this.model.add(i,t[n],n):this.model.add(i,t[n],this.model.getChildCount(i)-1)}this.fireEvent(new mxEventObject(mxEvent.CELLS_ORDERED,"back",e,"cells",t))}finally{this.model.endUpdate()}}},mxGraph.prototype.groupCells=function(t,e,n){null==n&&(n=mxUtils.sortCells(this.getSelectionCells(),!0)),n=this.getCellsForGroup(n),null==t&&(t=this.createGroupCell(n));var i=this.getBoundsForGroup(t,n,e);if(0<n.length&&null!=i){var o=this.model.getParent(t);null==o&&(o=this.model.getParent(n[0])),this.model.beginUpdate();try{null==this.getCellGeometry(t)&&this.model.setGeometry(t,new mxGeometry);var r=this.model.getChildCount(o);this.cellsAdded([t],o,r,null,null,!1),r=this.model.getChildCount(t),this.cellsAdded(n,t,r,null,null,!1,!1),this.cellsMoved(n,-i.x,-i.y,!1,!0),this.cellsResized([t],[i]),this.fireEvent(new mxEventObject(mxEvent.GROUP_CELLS,"group",t,"border",e,"cells",n))}finally{this.model.endUpdate()}}return t},mxGraph.prototype.getCellsForGroup=function(t){var e=[];if(null!=t&&0<t.length){var n=this.model.getParent(t[0]);e.push(t[0]);for(var i=1;i<t.length;i++)this.model.getParent(t[i])==n&&e.push(t[i])}return e},mxGraph.prototype.getBoundsForGroup=function(t,e,n){return e=this.getBoundingBoxFromGeometry(e),null!=e&&(this.isSwimlane(t)&&(t=this.getStartSize(t),e.x-=t.width,e.y-=t.height,e.width+=t.width,e.height+=t.height),e.x-=n,e.y-=n,e.width+=2*n,e.height+=2*n),e},mxGraph.prototype.createGroupCell=function(t){return t=new mxCell(""),t.setVertex(!0),t.setConnectable(!1),t},mxGraph.prototype.ungroupCells=function(t){var e=[];if(null==t){t=this.getSelectionCells();for(var n=[],i=0;i<t.length;i++)0<this.model.getChildCount(t[i])&&n.push(t[i]);t=n}if(null!=t&&0<t.length){this.model.beginUpdate();try{for(i=0;i<t.length;i++){var o=this.model.getChildren(t[i]);if(null!=o&&0<o.length){var o=o.slice(),r=this.model.getParent(t[i]),s=this.model.getChildCount(r);this.cellsAdded(o,r,s,null,null,!0),e=e.concat(o)}}this.cellsRemoved(this.addAllEdges(t)),this.fireEvent(new mxEventObject(mxEvent.UNGROUP_CELLS,"cells",t))}finally{this.model.endUpdate()}}return e},mxGraph.prototype.removeCellsFromParent=function(t){null==t&&(t=this.getSelectionCells()),this.model.beginUpdate();try{var e=this.getDefaultParent(),n=this.model.getChildCount(e);this.cellsAdded(t,e,n,null,null,!0),this.fireEvent(new mxEventObject(mxEvent.REMOVE_CELLS_FROM_PARENT,"cells",t))}finally{this.model.endUpdate()}return t},mxGraph.prototype.updateGroupBounds=function(t,e,n){null==t&&(t=this.getSelectionCells()),e=null!=e?e:0,n=null!=n?n:!1,this.model.beginUpdate();try{for(var i=0;i<t.length;i++){var o=this.getCellGeometry(t[i]);if(null!=o){var r=this.getChildCells(t[i]);if(null!=r&&0<r.length){var s=this.getBoundingBoxFromGeometry(r);if(0<s.width&&0<s.height){var l=this.isSwimlane(t[i])?this.getStartSize(t[i]):new mxRectangle,o=o.clone();n&&(o.x+=s.x-l.width-e,o.y+=s.y-l.height-e),o.width=s.width+l.width+2*e,o.height=s.height+l.height+2*e,this.model.setGeometry(t[i],o),this.moveCells(r,-s.x+l.width+e,-s.y+l.height+e)}}}}}finally{this.model.endUpdate()}return t},mxGraph.prototype.cloneCells=function(t,e){e=null!=e?e:!0;var n=null;if(null!=t){for(var i={},n=[],o=0;o<t.length;o++){var r=mxCellPath.create(t[o]);i[r]=t[o],n.push(t[o])}if(0<n.length)for(var r=this.view.scale,s=this.view.translate,n=this.model.cloneCells(t,!0),o=0;o<t.length;o++)if(!e&&this.model.isEdge(n[o])&&null!=this.getEdgeValidationError(n[o],this.model.getTerminal(n[o],!0),this.model.getTerminal(n[o],!1)))n[o]=null;else{var l=this.model.getGeometry(n[o]);if(null!=l){var a=this.view.getState(t[o]),h=this.view.getState(this.model.getParent(t[o]));if(null!=a&&null!=h){var d=h.origin.x,h=h.origin.y;if(this.model.isEdge(n[o])){for(var a=a.absolutePoints,u=this.model.getTerminal(t[o],!0),c=mxCellPath.create(u);null!=u&&null==i[c];)u=this.model.getParent(u),c=mxCellPath.create(u);for(null==u&&l.setTerminalPoint(new mxPoint(a[0].x/r-s.x,a[0].y/r-s.y),!0),u=this.model.getTerminal(t[o],!1),c=mxCellPath.create(u);null!=u&&null==i[c];)u=this.model.getParent(u),c=mxCellPath.create(u);if(null==u&&(u=a.length-1,l.setTerminalPoint(new mxPoint(a[u].x/r-s.x,a[u].y/r-s.y),!1)),l=l.points,null!=l)for(a=0;a<l.length;a++)l[a].x+=d,l[a].y+=h}else l.x+=d,l.y+=h}}}else n=[]}return n},mxGraph.prototype.insertVertex=function(t,e,n,i,o,r,s,l,a){return e=this.createVertex(t,e,n,i,o,r,s,l,a),this.addCell(e,t)},mxGraph.prototype.createVertex=function(t,e,n,i,o,r,s,l,a){return t=new mxGeometry(i,o,r,s),t.relative=null!=a?a:!1,n=new mxCell(n,t,l),n.setId(e),n.setVertex(!0),n.setConnectable(!0),n},mxGraph.prototype.insertEdge=function(t,e,n,i,o,r){return e=this.createEdge(t,e,n,i,o,r),this.addEdge(e,t,i,o)},mxGraph.prototype.createEdge=function(t,e,n,i,o,r){return t=new mxCell(n,new mxGeometry,r),t.setId(e),t.setEdge(!0),t.geometry.relative=!0,t},mxGraph.prototype.addEdge=function(t,e,n,i,o){return this.addCell(t,e,o,n,i)},mxGraph.prototype.addCell=function(t,e,n,i,o){return this.addCells([t],e,n,i,o)[0]},mxGraph.prototype.addCells=function(t,e,n,i,o){null==e&&(e=this.getDefaultParent()),null==n&&(n=this.model.getChildCount(e)),this.model.beginUpdate();try{this.cellsAdded(t,e,n,i,o,!1,!0),this.fireEvent(new mxEventObject(mxEvent.ADD_CELLS,"cells",t,"parent",e,"index",n,"source",i,"target",o))}finally{this.model.endUpdate()}return t},mxGraph.prototype.cellsAdded=function(t,e,n,i,o,r,s){if(null!=t&&null!=e&&null!=n){this.model.beginUpdate();try{for(var l=r?this.view.getState(e):null,a=null!=l?l.origin:null,h=new mxPoint(0,0),l=0;l<t.length;l++)if(null==t[l])n--;else{var d=this.model.getParent(t[l]);if(null!=a&&t[l]!=e&&e!=d){var u=this.view.getState(d),c=null!=u?u.origin:h,p=this.model.getGeometry(t[l]);if(null!=p){var m=c.x-a.x,g=c.y-a.y,p=p.clone();p.translate(m,g),!p.relative&&this.model.isVertex(t[l])&&!this.isAllowNegativeCoordinates()&&(p.x=Math.max(0,p.x),p.y=Math.max(0,p.y)),this.model.setGeometry(t[l],p)}}e==d&&n+l>this.model.getChildCount(e)&&n--,this.model.add(e,t[l],n+l),this.isExtendParentsOnAdd()&&this.isExtendParent(t[l])&&this.extendParent(t[l]),(null==s||s)&&this.constrainChild(t[l]),null!=i&&this.cellConnected(t[l],i,!0),null!=o&&this.cellConnected(t[l],o,!1)}this.fireEvent(new mxEventObject(mxEvent.CELLS_ADDED,"cells",t,"parent",e,"index",n,"source",i,"target",o,"absolute",r))}finally{this.model.endUpdate()}}},mxGraph.prototype.removeCells=function(t,e){e=null!=e?e:!0,null==t&&(t=this.getDeletableCells(this.getSelectionCells())),e&&(t=this.getDeletableCells(this.addAllEdges(t))),this.model.beginUpdate();try{this.cellsRemoved(t),this.fireEvent(new mxEventObject(mxEvent.REMOVE_CELLS,"cells",t,"includeEdges",e))}finally{this.model.endUpdate()}return t},mxGraph.prototype.cellsRemoved=function(t){if(null!=t&&0<t.length){var e=this.view.scale,n=this.view.translate;this.model.beginUpdate();try{for(var i={},o=0;o<t.length;o++){var r=mxCellPath.create(t[o]);i[r]=t[o]}for(o=0;o<t.length;o++){for(var s=this.getConnections(t[o]),l=0;l<s.length;l++)if(r=mxCellPath.create(s[l]),null==i[r]){var a=this.model.getGeometry(s[l]);if(null!=a){var h=this.view.getState(s[l]);if(null!=h){var a=a.clone(),d=h.getVisibleTerminal(!0)==t[o],u=h.absolutePoints,c=d?0:u.length-1;a.setTerminalPoint(new mxPoint(u[c].x/e-n.x,u[c].y/e-n.y),d),this.model.setTerminal(s[l],null,d),this.model.setGeometry(s[l],a)}}}this.model.remove(t[o])}this.fireEvent(new mxEventObject(mxEvent.CELLS_REMOVED,"cells",t))}finally{this.model.endUpdate()}}},mxGraph.prototype.splitEdge=function(t,e,n,i,o){i=i||0,o=o||0,null==n&&(n=this.cloneCells([t])[0]);var r=this.model.getParent(t),s=this.model.getTerminal(t,!0);this.model.beginUpdate();try{this.cellsMoved(e,i,o,!1,!1),this.cellsAdded(e,r,this.model.getChildCount(r),null,null,!0),this.cellsAdded([n],r,this.model.getChildCount(r),s,e[0],!1),this.cellConnected(t,e[0],!0),this.fireEvent(new mxEventObject(mxEvent.SPLIT_EDGE,"edge",t,"cells",e,"newEdge",n,"dx",i,"dy",o))}finally{this.model.endUpdate()}return n},mxGraph.prototype.toggleCells=function(t,e,n){null==e&&(e=this.getSelectionCells()),n&&(e=this.addAllEdges(e)),this.model.beginUpdate();try{this.cellsToggled(e,t),this.fireEvent(new mxEventObject(mxEvent.TOGGLE_CELLS,"show",t,"cells",e,"includeEdges",n))}finally{this.model.endUpdate()}return e},mxGraph.prototype.cellsToggled=function(t,e){if(null!=t&&0<t.length){this.model.beginUpdate();try{for(var n=0;n<t.length;n++)this.model.setVisible(t[n],e)}finally{this.model.endUpdate()}}},mxGraph.prototype.foldCells=function(t,e,n,i){e=null!=e?e:!1,null==n&&(n=this.getFoldableCells(this.getSelectionCells(),t)),this.stopEditing(!1),this.model.beginUpdate();try{this.cellsFolded(n,t,e,i),this.fireEvent(new mxEventObject(mxEvent.FOLD_CELLS,"collapse",t,"recurse",e,"cells",n))}finally{this.model.endUpdate()}return n},mxGraph.prototype.cellsFolded=function(t,e,n,i){if(null!=t&&0<t.length){this.model.beginUpdate();try{for(var o=0;o<t.length;o++)if((!i||this.isCellFoldable(t[o],e))&&e!=this.isCellCollapsed(t[o])&&(this.model.setCollapsed(t[o],e),this.swapBounds(t[o],e),this.isExtendParent(t[o])&&this.extendParent(t[o]),n)){var r=this.model.getChildren(t[o]);this.foldCells(r,e,n)}this.fireEvent(new mxEventObject(mxEvent.CELLS_FOLDED,"cells",t,"collapse",e,"recurse",n))}finally{this.model.endUpdate()}}},mxGraph.prototype.swapBounds=function(t,e){if(null!=t){var n=this.model.getGeometry(t);null!=n&&(n=n.clone(),this.updateAlternateBounds(t,n,e),n.swap(),this.model.setGeometry(t,n))}},mxGraph.prototype.updateAlternateBounds=function(t,e,n){if(null!=t&&null!=e){if(n=this.view.getState(t),n=null!=n?n.style:this.getCellStyle(t),null==e.alternateBounds){var i=e;this.collapseToPreferredSize&&(t=this.getPreferredSizeForCell(t),null!=t&&(i=t,t=mxUtils.getValue(n,mxConstants.STYLE_STARTSIZE),t>0&&(i.height=Math.max(i.height,t)))),e.alternateBounds=new mxRectangle(0,0,i.width,i.height)}if(null!=e.alternateBounds){e.alternateBounds.x=e.x,e.alternateBounds.y=e.y;var o=mxUtils.toRadians(n[mxConstants.STYLE_ROTATION]||"0");0!=o&&(t=e.alternateBounds.getCenterX()-e.getCenterX(),n=e.alternateBounds.getCenterY()-e.getCenterY(),i=Math.cos(o),o=Math.sin(o),e.alternateBounds.x+=i*t-o*n-t,e.alternateBounds.y+=o*t+i*n-n)}}},mxGraph.prototype.addAllEdges=function(t){var e=t.slice();return e=e.concat(this.getAllEdges(t))},mxGraph.prototype.getAllEdges=function(t){var e=[];if(null!=t)for(var n=0;n<t.length;n++){for(var i=this.model.getEdgeCount(t[n]),o=0;i>o;o++)e.push(this.model.getEdgeAt(t[n],o));i=this.model.getChildren(t[n]),e=e.concat(this.getAllEdges(i))}return e},mxGraph.prototype.updateCellSize=function(t,e){e=null!=e?e:!1,this.model.beginUpdate();
try{this.cellSizeUpdated(t,e),this.fireEvent(new mxEventObject(mxEvent.UPDATE_CELL_SIZE,"cell",t,"ignoreChildren",e))}finally{this.model.endUpdate()}return t},mxGraph.prototype.cellSizeUpdated=function(t,e){if(null!=t){this.model.beginUpdate();try{var n=this.getPreferredSizeForCell(t),i=this.model.getGeometry(t);if(null!=n&&null!=i){var o=this.isCellCollapsed(t),i=i.clone();if(this.isSwimlane(t)){var r=this.view.getState(t),s=null!=r?r.style:this.getCellStyle(t),l=this.model.getStyle(t);null==l&&(l=""),mxUtils.getValue(s,mxConstants.STYLE_HORIZONTAL,!0)?(l=mxUtils.setStyle(l,mxConstants.STYLE_STARTSIZE,n.height+8),o&&(i.height=n.height+8),i.width=n.width):(l=mxUtils.setStyle(l,mxConstants.STYLE_STARTSIZE,n.width+8),o&&(i.width=n.width+8),i.height=n.height),this.model.setStyle(t,l)}else i.width=n.width,i.height=n.height;if(!e&&!o){var a=this.view.getBounds(this.model.getChildren(t));if(null!=a){var h=this.view.translate,d=this.view.scale,u=(a.y+a.height)/d-i.y-h.y;i.width=Math.max(i.width,(a.x+a.width)/d-i.x-h.x),i.height=Math.max(i.height,u)}}this.cellsResized([t],[i])}}finally{this.model.endUpdate()}}},mxGraph.prototype.getPreferredSizeForCell=function(t){var e=null;if(null!=t){var n=this.view.getState(t),i=null!=n?n.style:this.getCellStyle(t);if(null!=i&&!this.model.isEdge(t)){var o=i[mxConstants.STYLE_FONTSIZE]||mxConstants.DEFAULT_FONTSIZE,r=0,e=0;null==this.getImage(n)&&null==i[mxConstants.STYLE_IMAGE]||i[mxConstants.STYLE_SHAPE]!=mxConstants.SHAPE_LABEL||(i[mxConstants.STYLE_VERTICAL_ALIGN]==mxConstants.ALIGN_MIDDLE&&(r+=parseFloat(i[mxConstants.STYLE_IMAGE_WIDTH])||mxLabel.prototype.imageSize),i[mxConstants.STYLE_ALIGN]!=mxConstants.ALIGN_CENTER&&(e+=parseFloat(i[mxConstants.STYLE_IMAGE_HEIGHT])||mxLabel.prototype.imageSize)),r+=2*(i[mxConstants.STYLE_SPACING]||0),r+=i[mxConstants.STYLE_SPACING_LEFT]||0,r+=i[mxConstants.STYLE_SPACING_RIGHT]||0,e+=2*(i[mxConstants.STYLE_SPACING]||0),e+=i[mxConstants.STYLE_SPACING_TOP]||0,e+=i[mxConstants.STYLE_SPACING_BOTTOM]||0,n=this.getFoldingImage(n),null!=n&&(r+=n.width+8),n=this.getLabel(t),null!=n&&0<n.length?(this.isHtmlLabel(t)||(n=n.replace(/\n/g,"<br>")),o=mxUtils.getSizeForString(n,o,i[mxConstants.STYLE_FONTFAMILY]),t=o.width+r,e=o.height+e,mxUtils.getValue(i,mxConstants.STYLE_HORIZONTAL,!0)||(i=e,e=t,t=i),this.gridEnabled&&(t=this.snap(t+this.gridSize/2),e=this.snap(e+this.gridSize/2)),e=new mxRectangle(0,0,t,e)):(i=4*this.gridSize,e=new mxRectangle(0,0,i,i))}}return e},mxGraph.prototype.handleGesture=function(t,e){if(this.isEnabled()&&this.isCellResizable(t.cell)&&.2<Math.abs(1-e.scale)){var n=this.view.scale,i=this.view.translate,o=t.width*e.scale,r=t.height*e.scale,s=t.y-(r-t.height)/2,n=new mxRectangle(this.snap((t.x-(o-t.width)/2)/n)-i.x,this.snap(s/n)-i.y,this.snap(o/n),this.snap(r/n));this.resizeCell(t.cell,n)}},mxGraph.prototype.resizeCell=function(t,e){return this.resizeCells([t],[e])[0]},mxGraph.prototype.resizeCells=function(t,e){this.model.beginUpdate();try{this.cellsResized(t,e),this.fireEvent(new mxEventObject(mxEvent.RESIZE_CELLS,"cells",t,"bounds",e))}finally{this.model.endUpdate()}return t},mxGraph.prototype.cellsResized=function(t,e){if(null!=t&&null!=e&&t.length==e.length){this.model.beginUpdate();try{for(var n=0;n<t.length;n++){var i=e[n],o=this.model.getGeometry(t[n]);if(null!=o&&(o.x!=i.x||o.y!=i.y||o.width!=i.width||o.height!=i.height)){if(o=o.clone(),o.relative){var r=o.offset;null!=r&&(r.x+=i.x-o.x,r.y+=i.y-o.y)}else o.x=i.x,o.y=i.y;o.width=i.width,o.height=i.height,!o.relative&&this.model.isVertex(t[n])&&!this.isAllowNegativeCoordinates()&&(o.x=Math.max(0,o.x),o.y=Math.max(0,o.y)),this.model.setGeometry(t[n],o),this.isExtendParent(t[n])&&this.extendParent(t[n])}}this.resetEdgesOnResize&&this.resetEdges(t),this.fireEvent(new mxEventObject(mxEvent.CELLS_RESIZED,"cells",t,"bounds",e))}finally{this.model.endUpdate()}}},mxGraph.prototype.extendParent=function(t){if(null!=t){var e=this.model.getParent(t),n=this.model.getGeometry(e);null!=e&&null!=n&&!this.isCellCollapsed(e)&&(t=this.model.getGeometry(t),null!=t&&(n.width<t.x+t.width||n.height<t.y+t.height))&&(n=n.clone(),n.width=Math.max(n.width,t.x+t.width),n.height=Math.max(n.height,t.y+t.height),this.cellsResized([e],[n]))}},mxGraph.prototype.importCells=function(t,e,n,i,o){return this.moveCells(t,e,n,!0,i,o)},mxGraph.prototype.moveCells=function(t,e,n,i,o,r){if(e=null!=e?e:0,n=null!=n?n:0,i=null!=i?i:!1,null!=t&&(0!=e||0!=n||i||null!=o)){this.model.beginUpdate();try{i&&(t=this.cloneCells(t,this.isCloneInvalidEdges()),null==o&&(o=this.getDefaultParent()));var s=this.isAllowNegativeCoordinates();if(null!=o&&this.setAllowNegativeCoordinates(!0),this.cellsMoved(t,e,n,!i&&this.isDisconnectOnMove()&&this.isAllowDanglingEdges(),null==o),this.setAllowNegativeCoordinates(s),null!=o){var l=this.model.getChildCount(o);this.cellsAdded(t,o,l,null,null,!0)}this.fireEvent(new mxEventObject(mxEvent.MOVE_CELLS,"cells",t,"dx",e,"dy",n,"clone",i,"target",o,"event",r))}finally{this.model.endUpdate()}}return t},mxGraph.prototype.cellsMoved=function(t,e,n,i,o){if(null!=t&&(0!=e||0!=n)){this.model.beginUpdate();try{i&&this.disconnectGraph(t);for(var r=0;r<t.length;r++)this.translateCell(t[r],e,n),o&&this.constrainChild(t[r]);this.resetEdgesOnMove&&this.resetEdges(t),this.fireEvent(new mxEventObject(mxEvent.CELLS_MOVED,"cells",t,"dx",n,"dy",n,"disconnect",i))}finally{this.model.endUpdate()}}},mxGraph.prototype.translateCell=function(t,e,n){var i=this.model.getGeometry(t);null!=i&&(i=i.clone(),i.translate(e,n),!i.relative&&this.model.isVertex(t)&&!this.isAllowNegativeCoordinates()&&(i.x=Math.max(0,i.x),i.y=Math.max(0,i.y)),i.relative&&!this.model.isEdge(t)&&(null==i.offset?i.offset=new mxPoint(e,n):(i.offset.x+=e,i.offset.y+=n)),this.model.setGeometry(t,i))},mxGraph.prototype.getCellContainmentArea=function(t){if(null!=t&&!this.model.isEdge(t)){var e=this.model.getParent(t);if(e==this.getDefaultParent()||e==this.getCurrentRoot())return this.getMaximumGraphBounds();if(null!=e&&e!=this.getDefaultParent()){var n=this.model.getGeometry(e);if(null!=n){var i=t=0,o=n.width,n=n.height;return this.isSwimlane(e)&&(e=this.getStartSize(e),t=e.width,o-=e.width,i=e.height,n-=e.height),new mxRectangle(t,i,o,n)}}}return null},mxGraph.prototype.getMaximumGraphBounds=function(){return this.maximumGraphBounds},mxGraph.prototype.constrainChild=function(t){if(null!=t){var e=this.model.getGeometry(t),n=this.isConstrainChild(t)?this.getCellContainmentArea(t):this.getMaximumGraphBounds();null!=e&&null!=n&&!e.relative&&(e.x<n.x||e.y<n.y||n.width<e.x+e.width||n.height<e.y+e.height)&&(t=this.getOverlap(t),0<n.width&&(e.x=Math.min(e.x,n.x+n.width-(1-t)*e.width)),0<n.height&&(e.y=Math.min(e.y,n.y+n.height-(1-t)*e.height)),e.x=Math.max(e.x,n.x-e.width*t),e.y=Math.max(e.y,n.y-e.height*t))}},mxGraph.prototype.resetEdges=function(t){if(null!=t){for(var e={},n=0;n<t.length;n++){var i=mxCellPath.create(t[n]);e[i]=t[n]}this.model.beginUpdate();try{for(n=0;n<t.length;n++){var o=this.model.getEdges(t[n]);if(null!=o)for(i=0;i<o.length;i++){var r=this.view.getState(o[i]),s=null!=r?r.getVisibleTerminal(!0):this.view.getVisibleTerminal(o[i],!0),l=null!=r?r.getVisibleTerminal(!1):this.view.getVisibleTerminal(o[i],!1),a=mxCellPath.create(s),h=mxCellPath.create(l);(null==e[a]||null==e[h])&&this.resetEdge(o[i])}this.resetEdges(this.model.getChildren(t[n]))}}finally{this.model.endUpdate()}}},mxGraph.prototype.resetEdge=function(t){var e=this.model.getGeometry(t);return null!=e&&null!=e.points&&0<e.points.length&&(e=e.clone(),e.points=[],this.model.setGeometry(t,e)),t},mxGraph.prototype.getAllConnectionConstraints=function(t){return null!=t&&null!=t.shape&&null!=t.shape.stencil?t.shape.stencil.constraints:null},mxGraph.prototype.getConnectionConstraint=function(t,e,n){e=null;var i=t.style[n?mxConstants.STYLE_EXIT_X:mxConstants.STYLE_ENTRY_X];if(null!=i){var o=t.style[n?mxConstants.STYLE_EXIT_Y:mxConstants.STYLE_ENTRY_Y];null!=o&&(e=new mxPoint(parseFloat(i),parseFloat(o)))}return i=!1,null!=e&&(i=mxUtils.getValue(t.style,n?mxConstants.STYLE_EXIT_PERIMETER:mxConstants.STYLE_ENTRY_PERIMETER,!0)),new mxConnectionConstraint(e,i)},mxGraph.prototype.setConnectionConstraint=function(t,e,n,i){if(null!=i){this.model.beginUpdate();try{null==i||null==i.point?(this.setCellStyles(n?mxConstants.STYLE_EXIT_X:mxConstants.STYLE_ENTRY_X,null,[t]),this.setCellStyles(n?mxConstants.STYLE_EXIT_Y:mxConstants.STYLE_ENTRY_Y,null,[t]),this.setCellStyles(n?mxConstants.STYLE_EXIT_PERIMETER:mxConstants.STYLE_ENTRY_PERIMETER,null,[t])):null!=i.point&&(this.setCellStyles(n?mxConstants.STYLE_EXIT_X:mxConstants.STYLE_ENTRY_X,i.point.x,[t]),this.setCellStyles(n?mxConstants.STYLE_EXIT_Y:mxConstants.STYLE_ENTRY_Y,i.point.y,[t]),i.perimeter?this.setCellStyles(n?mxConstants.STYLE_EXIT_PERIMETER:mxConstants.STYLE_ENTRY_PERIMETER,null,[t]):this.setCellStyles(n?mxConstants.STYLE_EXIT_PERIMETER:mxConstants.STYLE_ENTRY_PERIMETER,"0",[t]))}finally{this.model.endUpdate()}}},mxGraph.prototype.getConnectionPoint=function(t,e){var n=null;if(null!=t){var i=this.view.getPerimeterBounds(t),o=new mxPoint(i.getCenterX(),i.getCenterY()),r=t.style[mxConstants.STYLE_DIRECTION],s=0;if(null!=r&&("north"==r?s+=270:"west"==r?s+=180:"south"==r&&(s+=90),"north"==r||"south"==r)){i.x+=i.width/2-i.height/2,i.y+=i.height/2-i.width/2;var l=i.width;i.width=i.height,i.height=l}if(null!=e.point){var a=n=1,h=0,d=0;if(this.getModel().isVertex(t.cell)){var u=t.style[mxConstants.STYLE_FLIPH],c=t.style[mxConstants.STYLE_FLIPV];null!=t.shape.stencil&&(u=1==mxUtils.getValue(t.style,"stencilFlipH",0)||u,c=1==mxUtils.getValue(t.style,"stencilFlipV",0)||c),("north"==r||"south"==r)&&(l=u,u=c,c=l),u&&(n=-1,h=-i.width),c&&(a=-1,d=-i.height)}n=new mxPoint(i.x+e.point.x*i.width*n-h,i.y+e.point.y*i.height*a-d)}r=t.style[mxConstants.STYLE_ROTATION]||0,e.perimeter?(0!=s&&null!=n&&(l=i=0,90==s?l=1:180==s?i=-1:270==r&&(l=-1),n=mxUtils.getRotatedPoint(n,i,l,o)),null!=n&&e.perimeter&&(n=this.view.getPerimeterPoint(t,n,!1))):r+=s,0!=r&&null!=n&&(s=mxUtils.toRadians(r),i=Math.cos(s),l=Math.sin(s),n=mxUtils.getRotatedPoint(n,i,l,o))}return n},mxGraph.prototype.connectCell=function(t,e,n,i){this.model.beginUpdate();try{var o=this.model.getTerminal(t,n);this.cellConnected(t,e,n,i),this.fireEvent(new mxEventObject(mxEvent.CONNECT_CELL,"edge",t,"terminal",e,"source",n,"previous",o))}finally{this.model.endUpdate()}return t},mxGraph.prototype.cellConnected=function(t,e,n,i){if(null!=t){this.model.beginUpdate();try{var o=this.model.getTerminal(t,n);this.setConnectionConstraint(t,e,n,i),this.isPortsEnabled()&&(i=null,this.isPort(e)&&(i=e.getId(),e=this.getTerminalForPort(e,n)),this.setCellStyles(n?mxConstants.STYLE_SOURCE_PORT:mxConstants.STYLE_TARGET_PORT,i,[t])),this.model.setTerminal(t,e,n),this.resetEdgesOnConnect&&this.resetEdge(t),this.fireEvent(new mxEventObject(mxEvent.CELL_CONNECTED,"edge",t,"terminal",e,"source",n,"previous",o))}finally{this.model.endUpdate()}}},mxGraph.prototype.disconnectGraph=function(t){if(null!=t){this.model.beginUpdate();try{for(var e=this.view.scale,n=this.view.translate,i={},o=0;o<t.length;o++){var r=mxCellPath.create(t[o]);i[r]=t[o]}for(o=0;o<t.length;o++)if(this.model.isEdge(t[o])){var s=this.model.getGeometry(t[o]);if(null!=s){var l=this.view.getState(t[o]),a=this.view.getState(this.model.getParent(t[o]));if(null!=l&&null!=a){var s=s.clone(),h=-a.origin.x,d=-a.origin.y,u=l.absolutePoints,c=this.model.getTerminal(t[o],!0);if(null!=c&&this.isCellDisconnectable(t[o],c,!0)){for(var p=mxCellPath.create(c);null!=c&&null==i[p];)c=this.model.getParent(c),p=mxCellPath.create(c);null==c&&(s.setTerminalPoint(new mxPoint(u[0].x/e-n.x+h,u[0].y/e-n.y+d),!0),this.model.setTerminal(t[o],null,!0))}var m=this.model.getTerminal(t[o],!1);if(null!=m&&this.isCellDisconnectable(t[o],m,!1)){for(var g=mxCellPath.create(m);null!=m&&null==i[g];)m=this.model.getParent(m),g=mxCellPath.create(m);if(null==m){var f=u.length-1;s.setTerminalPoint(new mxPoint(u[f].x/e-n.x+h,u[f].y/e-n.y+d),!1),this.model.setTerminal(t[o],null,!1)}}this.model.setGeometry(t[o],s)}}}}finally{this.model.endUpdate()}}},mxGraph.prototype.getCurrentRoot=function(){return this.view.currentRoot},mxGraph.prototype.getTranslateForRoot=function(){return null},mxGraph.prototype.isPort=function(){return!1},mxGraph.prototype.getTerminalForPort=function(t){return this.model.getParent(t)},mxGraph.prototype.getChildOffsetForCell=function(){return null},mxGraph.prototype.enterGroup=function(t){t=t||this.getSelectionCell(),null!=t&&this.isValidRoot(t)&&(this.view.setCurrentRoot(t),this.clearSelection())},mxGraph.prototype.exitGroup=function(){var t=this.model.getRoot(),e=this.getCurrentRoot();if(null!=e){for(var n=this.model.getParent(e);n!=t&&!this.isValidRoot(n)&&this.model.getParent(n)!=t;)n=this.model.getParent(n);n==t||this.model.getParent(n)==t?this.view.setCurrentRoot(null):this.view.setCurrentRoot(n),null!=this.view.getState(e)&&this.setSelectionCell(e)}},mxGraph.prototype.home=function(){var t=this.getCurrentRoot();null!=t&&(this.view.setCurrentRoot(null),null!=this.view.getState(t)&&this.setSelectionCell(t))},mxGraph.prototype.isValidRoot=function(t){return null!=t},mxGraph.prototype.getGraphBounds=function(){return this.view.getGraphBounds()},mxGraph.prototype.getCellBounds=function(t,e,n){var i=[t];if(e&&(i=i.concat(this.model.getEdges(t))),i=this.view.getBounds(i),n){n=this.model.getChildCount(t);for(var o=0;n>o;o++){var r=this.getCellBounds(this.model.getChildAt(t,o),e,!0);null!=i?i.add(r):i=r}}return i},mxGraph.prototype.getBoundingBoxFromGeometry=function(t,e){e=null!=e?e:!1;var n=null;if(null!=t)for(var i=0;i<t.length;i++)if(e||this.model.isVertex(t[i])){var o=this.getCellGeometry(t[i]);if(null!=o){var r=o.points;if(null!=r&&0<r.length){for(var s=new mxRectangle(r[0].x,r[0].y,0,0),l=function(t){null!=t&&s.add(new mxRectangle(t.x,t.y,0,0))},a=1;a<r.length;a++)l(r[a]);l(o.getTerminalPoint(!0)),l(o.getTerminalPoint(!1))}null==n?n=new mxRectangle(o.x,o.y,o.width,o.height):n.add(o)}}return n},mxGraph.prototype.refresh=function(t){this.view.clear(t,null==t),this.view.validate(),this.sizeDidChange(),this.fireEvent(new mxEventObject(mxEvent.REFRESH))},mxGraph.prototype.snap=function(t){return this.gridEnabled&&(t=Math.round(t/this.gridSize)*this.gridSize),t},mxGraph.prototype.panGraph=function(t,e){if(this.useScrollbarsForPanning&&mxUtils.hasScrollbars(this.container))this.container.scrollLeft=-t,this.container.scrollTop=-e;else{var n=this.view.getCanvas();if(this.dialect==mxConstants.DIALECT_SVG)if(0==t&&0==e){if(mxClient.IS_IE?n.setAttribute("transform","translate("+t+","+e+")"):n.removeAttribute("transform"),null!=this.shiftPreview1){for(var i=this.shiftPreview1.firstChild;null!=i;){var o=i.nextSibling;this.container.appendChild(i),i=o}for(this.shiftPreview1.parentNode.removeChild(this.shiftPreview1),this.shiftPreview1=null,this.container.appendChild(n.parentNode),i=this.shiftPreview2.firstChild;null!=i;)o=i.nextSibling,this.container.appendChild(i),i=o;this.shiftPreview2.parentNode.removeChild(this.shiftPreview2),this.shiftPreview2=null}}else{if(n.setAttribute("transform","translate("+t+","+e+")"),null==this.shiftPreview1){this.shiftPreview1=document.createElement("div"),this.shiftPreview1.style.position="absolute",this.shiftPreview1.style.overflow="visible",this.shiftPreview2=document.createElement("div"),this.shiftPreview2.style.position="absolute",this.shiftPreview2.style.overflow="visible";for(var r=this.shiftPreview1,i=this.container.firstChild;null!=i;)o=i.nextSibling,i!=n.parentNode?r.appendChild(i):r=this.shiftPreview2,i=o;this.container.insertBefore(this.shiftPreview1,n.parentNode),this.container.appendChild(this.shiftPreview2)}this.shiftPreview1.style.left=t+"px",this.shiftPreview1.style.top=e+"px",this.shiftPreview2.style.left=t+"px",this.shiftPreview2.style.top=e+"px"}else n.style.left=t+"px",n.style.top=e+"px";this.panDx=t,this.panDy=e,this.fireEvent(new mxEventObject(mxEvent.PAN))}},mxGraph.prototype.zoomIn=function(){this.zoom(this.zoomFactor)},mxGraph.prototype.zoomOut=function(){this.zoom(1/this.zoomFactor)},mxGraph.prototype.zoomActual=function(){1==this.view.scale?this.view.setTranslate(0,0):(this.view.translate.x=0,this.view.translate.y=0,this.view.setScale(1))},mxGraph.prototype.zoomTo=function(t,e){this.zoom(t/this.view.scale,e)},mxGraph.prototype.zoom=function(t,e){e=null!=e?e:this.centerZoom;var n=this.view.scale*t,i=this.view.getState(this.getSelectionCell());if(this.keepSelectionVisibleOnZoom&&null!=i)i=new mxRectangle(i.x*t,i.y*t,i.width*t,i.height*t),this.view.scale=n,this.scrollRectToVisible(i)||(this.view.revalidate(),this.view.setScale(n));else if(e&&!mxUtils.hasScrollbars(this.container)){var i=this.container.offsetWidth,o=this.container.offsetHeight;if(t>1)var r=(t-1)/(2*n),i=i*-r,o=o*-r;else r=(1/t-1)/(2*this.view.scale),i*=r,o*=r;this.view.scaleAndTranslate(n,this.view.translate.x+i,this.view.translate.y+o)}else this.view.setScale(n),mxUtils.hasScrollbars(this.container)&&(o=i=0,e&&(i=this.container.offsetWidth*(t-1)/2,o=this.container.offsetHeight*(t-1)/2),this.container.scrollLeft=Math.round(this.container.scrollLeft*t+i),this.container.scrollTop=Math.round(this.container.scrollTop*t+o))},mxGraph.prototype.zoomToRect=function(t){var e=this.container.clientWidth/t.width/(this.container.clientHeight/t.height);t.x=Math.max(0,t.x),t.y=Math.max(0,t.y);var n=Math.min(this.container.scrollWidth,t.x+t.width),i=Math.min(this.container.scrollHeight,t.y+t.height);t.width=n-t.x,t.height=i-t.y,1>e?(e=t.height/e,n=(e-t.height)/2,t.height=e,e=Math.min(t.y,n),t.y-=e,i=Math.min(this.container.scrollHeight,t.y+t.height),t.height=i-t.y):(e*=t.width,n=(e-t.width)/2,t.width=e,e=Math.min(t.x,n),t.x-=e,n=Math.min(this.container.scrollWidth,t.x+t.width),t.width=n-t.x),e=this.container.clientWidth/t.width,n=this.view.scale*e,mxUtils.hasScrollbars(this.container)?(this.view.setScale(n),this.container.scrollLeft=Math.round(t.x*e),this.container.scrollTop=Math.round(t.y*e)):this.view.scaleAndTranslate(n,this.view.translate.x-t.x/this.view.scale,this.view.translate.y-t.y/this.view.scale)},mxGraph.prototype.fit=function(t,e){if(null!=this.container){t=null!=t?t:0,e=null!=e?e:!1;var n=this.container.clientWidth,i=this.container.clientHeight,o=this.view.getGraphBounds();e&&null!=o.x&&null!=o.y&&(o.width+=o.x,o.height+=o.y,o.x=0,o.y=0);var r=this.view.scale,s=o.width/r,l=o.height/r;null!=this.backgroundImage&&(s=Math.max(s,this.backgroundImage.width-o.x/r),l=Math.max(l,this.backgroundImage.height-o.y/r));var a=e?t:2*t,n=Math.floor(100*Math.min(n/(s+a),i/(l+a)))/100;null!=this.minFitScale&&(n=Math.max(n,this.minFitScale)),null!=this.maxFitScale&&(n=Math.min(n,this.maxFitScale)),e?this.view.scale!=n&&this.view.setScale(n):mxUtils.hasScrollbars(this.container)?(this.view.setScale(n),null!=o.x&&(this.container.scrollLeft=Math.round(o.x/r)*n-t-Math.max(0,(this.container.clientWidth-s*n)/2)),null!=o.y&&(this.container.scrollTop=Math.round(o.y/r)*n-t-Math.max(0,(this.container.clientHeight-l*n)/2))):this.view.scaleAndTranslate(n,null!=o.x?Math.floor(this.view.translate.x-o.x/r+t+1):t,null!=o.y?Math.floor(this.view.translate.y-o.y/r+t+1):t)}return this.view.scale},mxGraph.prototype.scrollCellToVisible=function(t,e){var n=-this.view.translate.x,i=-this.view.translate.y,o=this.view.getState(t);null!=o&&(n=new mxRectangle(n+o.x,i+o.y,o.width,o.height),e&&null!=this.container&&(i=this.container.clientWidth,o=this.container.clientHeight,n.x=n.getCenterX()-i/2,n.width=i,n.y=n.getCenterY()-o/2,n.height=o),this.scrollRectToVisible(n)&&this.view.setTranslate(this.view.translate.x,this.view.translate.y))},mxGraph.prototype.scrollRectToVisible=function(t){var e=!1;if(null!=t){var n=this.container.offsetWidth,i=this.container.offsetHeight,o=Math.min(n,t.width),r=Math.min(i,t.height);if(mxUtils.hasScrollbars(this.container)){n=this.container,t.x+=this.view.translate.x,t.y+=this.view.translate.y;var s=n.scrollLeft-t.x,i=Math.max(s-n.scrollLeft,0);s>0?n.scrollLeft-=s+2:(s=t.x+o-n.scrollLeft-n.clientWidth,s>0&&(n.scrollLeft+=s+2)),o=n.scrollTop-t.y,s=Math.max(0,o-n.scrollTop),o>0?n.scrollTop-=o+2:(o=t.y+r-n.scrollTop-n.clientHeight,o>0&&(n.scrollTop+=o+2)),!this.useScrollbarsForPanning&&(0!=i||0!=s)&&this.view.setTranslate(i,s)}else{var s=-this.view.translate.x,l=-this.view.translate.y,a=this.view.scale;t.x+o>s+n&&(this.view.translate.x-=(t.x+o-n-s)/a,e=!0),t.y+r>l+i&&(this.view.translate.y-=(t.y+r-i-l)/a,e=!0),t.x<s&&(this.view.translate.x+=(s-t.x)/a,e=!0),t.y<l&&(this.view.translate.y+=(l-t.y)/a,e=!0),e&&(this.view.refresh(),null!=this.selectionCellsHandler&&this.selectionCellsHandler.refresh())}}return e},mxGraph.prototype.getCellGeometry=function(t){return this.model.getGeometry(t)},mxGraph.prototype.isCellVisible=function(t){return this.model.isVisible(t)},mxGraph.prototype.isCellCollapsed=function(t){return this.model.isCollapsed(t)},mxGraph.prototype.isCellConnectable=function(t){return this.model.isConnectable(t)},mxGraph.prototype.isOrthogonal=function(t){var e=t.style[mxConstants.STYLE_ORTHOGONAL];return null!=e?e:(t=this.view.getEdgeStyle(t),t==mxEdgeStyle.SegmentConnector||t==mxEdgeStyle.ElbowConnector||t==mxEdgeStyle.SideToSide||t==mxEdgeStyle.TopToBottom||t==mxEdgeStyle.EntityRelation||t==mxEdgeStyle.OrthConnector)},mxGraph.prototype.isLoop=function(t){var e=t.getVisibleTerminalState(!0);return t=t.getVisibleTerminalState(!1),null!=e&&e==t},mxGraph.prototype.isCloneEvent=function(t){return mxEvent.isControlDown(t)},mxGraph.prototype.isToggleEvent=function(t){return mxClient.IS_MAC?mxEvent.isMetaDown(t):mxEvent.isControlDown(t)},mxGraph.prototype.isGridEnabledEvent=function(t){return null!=t&&!mxEvent.isAltDown(t)},mxGraph.prototype.isConstrainedEvent=function(t){return mxEvent.isShiftDown(t)},mxGraph.prototype.isForceMarqueeEvent=function(t){return mxEvent.isAltDown(t)},mxGraph.prototype.validationAlert=function(t){mxUtils.alert(t)},mxGraph.prototype.isEdgeValid=function(t,e,n){return null==this.getEdgeValidationError(t,e,n)},mxGraph.prototype.getEdgeValidationError=function(t,e,n){if(null!=t&&!this.isAllowDanglingEdges()&&(null==e||null==n))return"";if(null!=t&&null==this.model.getTerminal(t,!0)&&null==this.model.getTerminal(t,!1))return null;if(!this.allowLoops&&e==n&&null!=e||!this.isValidConnection(e,n))return"";if(null!=e&&null!=n){var i="";if(!this.multigraph){var o=this.model.getEdgesBetween(e,n,!0);(1<o.length||1==o.length&&o[0]!=t)&&(i+=(mxResources.get(this.alreadyConnectedResource)||this.alreadyConnectedResource)+"\n")}var o=this.model.getDirectedEdgeCount(e,!0,t),r=this.model.getDirectedEdgeCount(n,!1,t);if(null!=this.multiplicities)for(var s=0;s<this.multiplicities.length;s++){var l=this.multiplicities[s].check(this,t,e,n,o,r);null!=l&&(i+=l)}return l=this.validateEdge(t,e,n),null!=l&&(i+=l),0<i.length?i:null}return this.allowDanglingEdges?null:""},mxGraph.prototype.validateEdge=function(){return null},mxGraph.prototype.validateGraph=function(t,e){t=null!=t?t:this.model.getRoot(),e=null!=e?e:{};for(var n=!0,i=this.model.getChildCount(t),o=0;i>o;o++){var r=this.model.getChildAt(t,o),s=e;this.isValidRoot(r)&&(s={}),s=this.validateGraph(r,s),null!=s?this.setCellWarning(r,s.replace(/\n/g,"<br>")):this.setCellWarning(r,null),n=n&&null==s}return i="",this.isCellCollapsed(t)&&!n&&(i+=(mxResources.get(this.containsValidationErrorsResource)||this.containsValidationErrorsResource)+"\n"),i=this.model.isEdge(t)?i+(this.getEdgeValidationError(t,this.model.getTerminal(t,!0),this.model.getTerminal(t,!1))||""):i+(this.getCellValidationError(t)||""),o=this.validateCell(t,e),null!=o&&(i+=o),null==this.model.getParent(t)&&this.view.validate(),0<i.length||!n?i:null},mxGraph.prototype.getCellValidationError=function(t){var e=this.model.getDirectedEdgeCount(t,!0),n=this.model.getDirectedEdgeCount(t,!1);t=this.model.getValue(t);var i="";if(null!=this.multiplicities)for(var o=0;o<this.multiplicities.length;o++){var r=this.multiplicities[o];r.source&&mxUtils.isNode(t,r.type,r.attr,r.value)&&(0==r.max&&e>0||1==r.min&&0==e||1==r.max&&e>1)?i+=r.countError+"\n":!r.source&&mxUtils.isNode(t,r.type,r.attr,r.value)&&(0==r.max&&n>0||1==r.min&&0==n||1==r.max&&n>1)&&(i+=r.countError+"\n")}return 0<i.length?i:null},mxGraph.prototype.validateCell=function(){return null},mxGraph.prototype.getBackgroundImage=function(){return this.backgroundImage},mxGraph.prototype.setBackgroundImage=function(t){this.backgroundImage=t},mxGraph.prototype.getFoldingImage=function(t){if(null!=t&&this.foldingEnabled&&!this.getModel().isEdge(t.cell)){var e=this.isCellCollapsed(t.cell);if(this.isCellFoldable(t.cell,!e))return e?this.collapsedImage:this.expandedImage}return null},mxGraph.prototype.convertValueToString=function(t){if(t=this.model.getValue(t),null!=t){if(mxUtils.isNode(t))return t.nodeName;if("function"==typeof t.toString)return t.toString()}return""},mxGraph.prototype.getLabel=function(t){var e="";if(this.labelsVisible&&null!=t){var n=this.view.getState(t),n=null!=n?n.style:this.getCellStyle(t);mxUtils.getValue(n,mxConstants.STYLE_NOLABEL,!1)||(e=this.convertValueToString(t))}return e},mxGraph.prototype.isHtmlLabel=function(){return this.isHtmlLabels()},mxGraph.prototype.isHtmlLabels=function(){return this.htmlLabels},mxGraph.prototype.setHtmlLabels=function(t){this.htmlLabels=t},mxGraph.prototype.isWrapping=function(t){var e=this.view.getState(t);return t=null!=e?e.style:this.getCellStyle(t),null!=t?"wrap"==t[mxConstants.STYLE_WHITE_SPACE]:!1},mxGraph.prototype.isLabelClipped=function(t){var e=this.view.getState(t);return t=null!=e?e.style:this.getCellStyle(t),null!=t?"hidden"==t[mxConstants.STYLE_OVERFLOW]:!1},mxGraph.prototype.getTooltip=function(t,e,n){var i=null;return null!=t&&(null==t.control||e!=t.control.node&&e.parentNode!=t.control.node||(i=this.collapseExpandResource,i=mxResources.get(i)||i),null==i&&null!=t.overlays&&t.overlays.visit(function(t,n){null!=i||e!=n.node&&e.parentNode!=n.node||(i=n.overlay.toString())}),null==i&&(n=this.selectionCellsHandler.getHandler(t.cell),null!=n&&"function"==typeof n.getTooltipForNode&&(i=n.getTooltipForNode(e))),null==i&&(i=this.getTooltipForCell(t.cell))),i},mxGraph.prototype.getTooltipForCell=function(t){var e=null;return e=null!=t&&null!=t.getTooltip?t.getTooltip():this.convertValueToString(t)},mxGraph.prototype.getCursorForCell=function(){return null},mxGraph.prototype.getStartSize=function(t){var e=new mxRectangle,n=this.view.getState(t);return t=null!=n?n.style:this.getCellStyle(t),null!=t&&(n=parseInt(mxUtils.getValue(t,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_STARTSIZE)),mxUtils.getValue(t,mxConstants.STYLE_HORIZONTAL,!0)?e.height=n:e.width=n),e},mxGraph.prototype.getImage=function(t){return null!=t&&null!=t.style?t.style[mxConstants.STYLE_IMAGE]:null},mxGraph.prototype.getVerticalAlign=function(t){return null!=t&&null!=t.style?t.style[mxConstants.STYLE_VERTICAL_ALIGN]||mxConstants.ALIGN_MIDDLE:null},mxGraph.prototype.getIndicatorColor=function(t){return null!=t&&null!=t.style?t.style[mxConstants.STYLE_INDICATOR_COLOR]:null},mxGraph.prototype.getIndicatorGradientColor=function(t){return null!=t&&null!=t.style?t.style[mxConstants.STYLE_INDICATOR_GRADIENTCOLOR]:null},mxGraph.prototype.getIndicatorShape=function(t){return null!=t&&null!=t.style?t.style[mxConstants.STYLE_INDICATOR_SHAPE]:null},mxGraph.prototype.getIndicatorImage=function(t){return null!=t&&null!=t.style?t.style[mxConstants.STYLE_INDICATOR_IMAGE]:null},mxGraph.prototype.getBorder=function(){return this.border},mxGraph.prototype.setBorder=function(t){this.border=t},mxGraph.prototype.isSwimlane=function(t){if(null!=t&&this.model.getParent(t)!=this.model.getRoot()){var e=this.view.getState(t),e=null!=e?e.style:this.getCellStyle(t);if(null!=e&&!this.model.isEdge(t))return e[mxConstants.STYLE_SHAPE]==mxConstants.SHAPE_SWIMLANE}return!1},mxGraph.prototype.isResizeContainer=function(){return this.resizeContainer},mxGraph.prototype.setResizeContainer=function(t){this.resizeContainer=t},mxGraph.prototype.isEnabled=function(){return this.enabled},mxGraph.prototype.setEnabled=function(t){this.enabled=t},mxGraph.prototype.isEscapeEnabled=function(){return this.escapeEnabled},mxGraph.prototype.setEscapeEnabled=function(t){this.escapeEnabled=t},mxGraph.prototype.isInvokesStopCellEditing=function(){return this.invokesStopCellEditing},mxGraph.prototype.setInvokesStopCellEditing=function(t){this.invokesStopCellEditing=t},mxGraph.prototype.isEnterStopsCellEditing=function(){return this.enterStopsCellEditing},mxGraph.prototype.setEnterStopsCellEditing=function(t){this.enterStopsCellEditing=t},mxGraph.prototype.isCellLocked=function(t){var e=this.model.getGeometry(t);return this.isCellsLocked()||null!=e&&this.model.isVertex(t)&&e.relative},mxGraph.prototype.isCellsLocked=function(){return this.cellsLocked},mxGraph.prototype.setCellsLocked=function(t){this.cellsLocked=t},mxGraph.prototype.getCloneableCells=function(t){return this.model.filterCells(t,mxUtils.bind(this,function(t){return this.isCellCloneable(t)}))},mxGraph.prototype.isCellCloneable=function(t){var e=this.view.getState(t);return t=null!=e?e.style:this.getCellStyle(t),this.isCellsCloneable()&&0!=t[mxConstants.STYLE_CLONEABLE]},mxGraph.prototype.isCellsCloneable=function(){return this.cellsCloneable},mxGraph.prototype.setCellsCloneable=function(t){this.cellsCloneable=t},mxGraph.prototype.getExportableCells=function(t){return this.model.filterCells(t,mxUtils.bind(this,function(t){return this.canExportCell(t)}))},mxGraph.prototype.canExportCell=function(){return this.exportEnabled},mxGraph.prototype.getImportableCells=function(t){return this.model.filterCells(t,mxUtils.bind(this,function(t){return this.canImportCell(t)}))},mxGraph.prototype.canImportCell=function(){return this.importEnabled},mxGraph.prototype.isCellSelectable=function(){return this.isCellsSelectable()},mxGraph.prototype.isCellsSelectable=function(){return this.cellsSelectable},mxGraph.prototype.setCellsSelectable=function(t){this.cellsSelectable=t},mxGraph.prototype.getDeletableCells=function(t){return this.model.filterCells(t,mxUtils.bind(this,function(t){return this.isCellDeletable(t)}))},mxGraph.prototype.isCellDeletable=function(t){var e=this.view.getState(t);return t=null!=e?e.style:this.getCellStyle(t),this.isCellsDeletable()&&0!=t[mxConstants.STYLE_DELETABLE]},mxGraph.prototype.isCellsDeletable=function(){return this.cellsDeletable},mxGraph.prototype.setCellsDeletable=function(t){this.cellsDeletable=t},mxGraph.prototype.isLabelMovable=function(t){return!this.isCellLocked(t)&&(this.model.isEdge(t)&&this.edgeLabelsMovable||this.model.isVertex(t)&&this.vertexLabelsMovable)},mxGraph.prototype.isCellRotatable=function(t){var e=this.view.getState(t);return 0!=(null!=e?e.style:this.getCellStyle(t))[mxConstants.STYLE_ROTATABLE]},mxGraph.prototype.getMovableCells=function(t){return this.model.filterCells(t,mxUtils.bind(this,function(t){return this.isCellMovable(t)}))},mxGraph.prototype.isCellMovable=function(t){var e=this.view.getState(t),e=null!=e?e.style:this.getCellStyle(t);return this.isCellsMovable()&&!this.isCellLocked(t)&&0!=e[mxConstants.STYLE_MOVABLE]},mxGraph.prototype.isCellsMovable=function(){return this.cellsMovable},mxGraph.prototype.setCellsMovable=function(t){this.cellsMovable=t},mxGraph.prototype.isGridEnabled=function(){return this.gridEnabled},mxGraph.prototype.setGridEnabled=function(t){this.gridEnabled=t},mxGraph.prototype.isPortsEnabled=function(){return this.portsEnabled},mxGraph.prototype.setPortsEnabled=function(t){this.portsEnabled=t},mxGraph.prototype.getGridSize=function(){return this.gridSize},mxGraph.prototype.setGridSize=function(t){this.gridSize=t},mxGraph.prototype.getTolerance=function(){return this.tolerance},mxGraph.prototype.setTolerance=function(t){this.tolerance=t},mxGraph.prototype.isVertexLabelsMovable=function(){return this.vertexLabelsMovable},mxGraph.prototype.setVertexLabelsMovable=function(t){this.vertexLabelsMovable=t},mxGraph.prototype.isEdgeLabelsMovable=function(){return this.edgeLabelsMovable},mxGraph.prototype.setEdgeLabelsMovable=function(t){this.edgeLabelsMovable=t},mxGraph.prototype.isSwimlaneNesting=function(){return this.swimlaneNesting},mxGraph.prototype.setSwimlaneNesting=function(t){this.swimlaneNesting=t},mxGraph.prototype.isSwimlaneSelectionEnabled=function(){return this.swimlaneSelectionEnabled},mxGraph.prototype.setSwimlaneSelectionEnabled=function(t){this.swimlaneSelectionEnabled=t},mxGraph.prototype.isMultigraph=function(){return this.multigraph},mxGraph.prototype.setMultigraph=function(t){this.multigraph=t},mxGraph.prototype.isAllowLoops=function(){return this.allowLoops},mxGraph.prototype.setAllowDanglingEdges=function(t){this.allowDanglingEdges=t},mxGraph.prototype.isAllowDanglingEdges=function(){return this.allowDanglingEdges},mxGraph.prototype.setConnectableEdges=function(t){this.connectableEdges=t
},mxGraph.prototype.isConnectableEdges=function(){return this.connectableEdges},mxGraph.prototype.setCloneInvalidEdges=function(t){this.cloneInvalidEdges=t},mxGraph.prototype.isCloneInvalidEdges=function(){return this.cloneInvalidEdges},mxGraph.prototype.setAllowLoops=function(t){this.allowLoops=t},mxGraph.prototype.isDisconnectOnMove=function(){return this.disconnectOnMove},mxGraph.prototype.setDisconnectOnMove=function(t){this.disconnectOnMove=t},mxGraph.prototype.isDropEnabled=function(){return this.dropEnabled},mxGraph.prototype.setDropEnabled=function(t){this.dropEnabled=t},mxGraph.prototype.isSplitEnabled=function(){return this.splitEnabled},mxGraph.prototype.setSplitEnabled=function(t){this.splitEnabled=t},mxGraph.prototype.isCellResizable=function(t){var e=this.view.getState(t),e=null!=e?e.style:this.getCellStyle(t);return this.isCellsResizable()&&!this.isCellLocked(t)&&0!=e[mxConstants.STYLE_RESIZABLE]},mxGraph.prototype.isCellsResizable=function(){return this.cellsResizable},mxGraph.prototype.setCellsResizable=function(t){this.cellsResizable=t},mxGraph.prototype.isTerminalPointMovable=function(){return!0},mxGraph.prototype.isCellBendable=function(t){var e=this.view.getState(t),e=null!=e?e.style:this.getCellStyle(t);return this.isCellsBendable()&&!this.isCellLocked(t)&&0!=e[mxConstants.STYLE_BENDABLE]},mxGraph.prototype.isCellsBendable=function(){return this.cellsBendable},mxGraph.prototype.setCellsBendable=function(t){this.cellsBendable=t},mxGraph.prototype.isCellEditable=function(t){var e=this.view.getState(t),e=null!=e?e.style:this.getCellStyle(t);return this.isCellsEditable()&&!this.isCellLocked(t)&&0!=e[mxConstants.STYLE_EDITABLE]},mxGraph.prototype.isCellsEditable=function(){return this.cellsEditable},mxGraph.prototype.setCellsEditable=function(t){this.cellsEditable=t},mxGraph.prototype.isCellDisconnectable=function(t){return this.isCellsDisconnectable()&&!this.isCellLocked(t)},mxGraph.prototype.isCellsDisconnectable=function(){return this.cellsDisconnectable},mxGraph.prototype.setCellsDisconnectable=function(t){this.cellsDisconnectable=t},mxGraph.prototype.isValidSource=function(t){return null==t&&this.allowDanglingEdges||null!=t&&(!this.model.isEdge(t)||this.connectableEdges)&&this.isCellConnectable(t)},mxGraph.prototype.isValidTarget=function(t){return this.isValidSource(t)},mxGraph.prototype.isValidConnection=function(t,e){return this.isValidSource(t)&&this.isValidTarget(e)},mxGraph.prototype.setConnectable=function(t){this.connectionHandler.setEnabled(t)},mxGraph.prototype.isConnectable=function(){return this.connectionHandler.isEnabled()},mxGraph.prototype.setTooltips=function(t){this.tooltipHandler.setEnabled(t)},mxGraph.prototype.setPanning=function(t){this.panningHandler.panningEnabled=t},mxGraph.prototype.isEditing=function(t){if(null!=this.cellEditor){var e=this.cellEditor.getEditingCell();return null==t?null!=e:t==e}return!1},mxGraph.prototype.isAutoSizeCell=function(t){var e=this.view.getState(t);return t=null!=e?e.style:this.getCellStyle(t),this.isAutoSizeCells()||1==t[mxConstants.STYLE_AUTOSIZE]},mxGraph.prototype.isAutoSizeCells=function(){return this.autoSizeCells},mxGraph.prototype.setAutoSizeCells=function(t){this.autoSizeCells=t},mxGraph.prototype.isExtendParent=function(t){return!this.getModel().isEdge(t)&&this.isExtendParents()},mxGraph.prototype.isExtendParents=function(){return this.extendParents},mxGraph.prototype.setExtendParents=function(t){this.extendParents=t},mxGraph.prototype.isExtendParentsOnAdd=function(){return this.extendParentsOnAdd},mxGraph.prototype.setExtendParentsOnAdd=function(t){this.extendParentsOnAdd=t},mxGraph.prototype.isConstrainChild=function(t){return this.isConstrainChildren()&&!this.getModel().isEdge(this.getModel().getParent(t))},mxGraph.prototype.isConstrainChildren=function(){return this.constrainChildren},mxGraph.prototype.setConstrainChildren=function(t){this.constrainChildren=t},mxGraph.prototype.isAllowNegativeCoordinates=function(){return this.allowNegativeCoordinates},mxGraph.prototype.setAllowNegativeCoordinates=function(t){this.allowNegativeCoordinates=t},mxGraph.prototype.getOverlap=function(t){return this.isAllowOverlapParent(t)?this.defaultOverlap:0},mxGraph.prototype.isAllowOverlapParent=function(){return!1},mxGraph.prototype.getFoldableCells=function(t,e){return this.model.filterCells(t,mxUtils.bind(this,function(t){return this.isCellFoldable(t,e)}))},mxGraph.prototype.isCellFoldable=function(t){var e=this.view.getState(t),e=null!=e?e.style:this.getCellStyle(t);return 0<this.model.getChildCount(t)&&0!=e[mxConstants.STYLE_FOLDABLE]},mxGraph.prototype.isValidDropTarget=function(t,e,n){return null!=t&&(this.isSplitEnabled()&&this.isSplitTarget(t,e,n)||!this.model.isEdge(t)&&(this.isSwimlane(t)||0<this.model.getChildCount(t)&&!this.isCellCollapsed(t)))},mxGraph.prototype.isSplitTarget=function(t,e,n){return this.model.isEdge(t)&&null!=e&&1==e.length&&this.isCellConnectable(e[0])&&null==this.getEdgeValidationError(t,this.model.getTerminal(t,!0),e[0])?(n=this.model.getTerminal(t,!0),t=this.model.getTerminal(t,!1),!this.model.isAncestor(e[0],n)&&!this.model.isAncestor(e[0],t)):!1},mxGraph.prototype.getDropTarget=function(t,e,n){if(!this.isSwimlaneNesting())for(var i=0;i<t.length;i++)if(this.isSwimlane(t[i]))return null;if(i=mxUtils.convertPoint(this.container,mxEvent.getClientX(e),mxEvent.getClientY(e)),i.x-=this.panDx,i.y-=this.panDy,i=this.getSwimlaneAt(i.x,i.y),null==n)n=i;else if(null!=i){for(var o=this.model.getParent(i);null!=o&&this.isSwimlane(o)&&o!=n;)o=this.model.getParent(o);o==n&&(n=i)}for(;null!=n&&!this.isValidDropTarget(n,t,e)&&!this.model.isLayer(n);)n=this.model.getParent(n);return!this.model.isLayer(n)&&0>mxUtils.indexOf(t,n)?n:null},mxGraph.prototype.getDefaultParent=function(){var t=this.getCurrentRoot();return null==t&&(t=this.defaultParent,null==t&&(t=this.model.getRoot(),t=this.model.getChildAt(t,0))),t},mxGraph.prototype.setDefaultParent=function(t){this.defaultParent=t},mxGraph.prototype.getSwimlane=function(t){for(;null!=t&&!this.isSwimlane(t);)t=this.model.getParent(t);return t},mxGraph.prototype.getSwimlaneAt=function(t,e,n){if(n=n||this.getDefaultParent(),null!=n)for(var i=this.model.getChildCount(n),o=0;i>o;o++){var r=this.model.getChildAt(n,o),s=this.getSwimlaneAt(t,e,r);if(null!=s)return s;if(this.isSwimlane(r)&&(s=this.view.getState(r),this.intersects(s,t,e)))return r}return null},mxGraph.prototype.getCellAt=function(t,e,n,i,o){if(i=null!=i?i:!0,o=null!=o?o:!0,n=null!=n?n:this.getDefaultParent(),null!=n)for(var r=this.model.getChildCount(n)-1;r>=0;r--){var s=this.model.getChildAt(n,r),l=this.getCellAt(t,e,s,i,o);if(null!=l)return l;if(this.isCellVisible(s)&&(o&&this.model.isEdge(s)||i&&this.model.isVertex(s))&&(l=this.view.getState(s),this.intersects(l,t,e)))return s}return null},mxGraph.prototype.intersects=function(t,e,n){if(null!=t){var i=t.absolutePoints;if(null!=i){t=this.tolerance*this.tolerance;for(var o=i[0],r=1;r<i.length;r++){var s=i[r];if(mxUtils.ptSegDistSq(o.x,o.y,s.x,s.y,e,n)<=t)return!0;o=s}}else if(o=mxUtils.toRadians(mxUtils.getValue(t.style,mxConstants.STYLE_ROTATION)||0),0!=o&&(i=Math.cos(-o),o=Math.sin(-o),r=new mxPoint(t.getCenterX(),t.getCenterY()),o=mxUtils.getRotatedPoint(new mxPoint(e,n),i,o,r),e=o.x,n=o.y),mxUtils.contains(t,e,n))return!0}return!1},mxGraph.prototype.hitsSwimlaneContent=function(t,e,n){var i=this.getView().getState(t);if(t=this.getStartSize(t),null!=i){var o=this.getView().getScale();if(e-=i.x,n-=i.y,0<t.width&&e>0&&e>t.width*o||0<t.height&&n>0&&n>t.height*o)return!0}return!1},mxGraph.prototype.getChildVertices=function(t){return this.getChildCells(t,!0,!1)},mxGraph.prototype.getChildEdges=function(t){return this.getChildCells(t,!1,!0)},mxGraph.prototype.getChildCells=function(t,e,n){for(t=null!=t?t:this.getDefaultParent(),t=this.model.getChildCells(t,null!=e?e:!1,null!=n?n:!1),e=[],n=0;n<t.length;n++)this.isCellVisible(t[n])&&e.push(t[n]);return e},mxGraph.prototype.getConnections=function(t,e){return this.getEdges(t,e,!0,!0,!1)},mxGraph.prototype.getIncomingEdges=function(t,e){return this.getEdges(t,e,!0,!1,!1)},mxGraph.prototype.getOutgoingEdges=function(t,e){return this.getEdges(t,e,!1,!0,!1)},mxGraph.prototype.getEdges=function(t,e,n,i,o,r){n=null!=n?n:!0,i=null!=i?i:!0,o=null!=o?o:!0,r=null!=r?r:!1;for(var s=[],l=this.isCellCollapsed(t),a=this.model.getChildCount(t),h=0;a>h;h++){var d=this.model.getChildAt(t,h);(l||!this.isCellVisible(d))&&(s=s.concat(this.model.getEdges(d,n,i)))}for(s=s.concat(this.model.getEdges(t,n,i)),l=[],h=0;h<s.length;h++)d=this.view.getState(s[h]),a=null!=d?d.getVisibleTerminal(!0):this.view.getVisibleTerminal(s[h],!0),d=null!=d?d.getVisibleTerminal(!1):this.view.getVisibleTerminal(s[h],!1),(o&&a==d||a!=d&&(n&&d==t&&(null==e||this.isValidAncestor(a,e,r))||i&&a==t&&(null==e||this.isValidAncestor(d,e,r))))&&l.push(s[h]);return l},mxGraph.prototype.isValidAncestor=function(t,e,n){return n?this.model.isAncestor(e,t):this.model.getParent(t)==e},mxGraph.prototype.getOpposites=function(t,e,n,i){n=null!=n?n:!0,i=null!=i?i:!0;var o=[],r={};if(null!=t)for(var s=0;s<t.length;s++){var l=this.view.getState(t[s]),a=null!=l?l.getVisibleTerminal(!0):this.view.getVisibleTerminal(t[s],!0),l=null!=l?l.getVisibleTerminal(!1):this.view.getVisibleTerminal(t[s],!1);if(a==e&&null!=l&&l!=e&&i){var h=mxCellPath.create(l);null==r[h]&&(r[h]=l,o.push(l))}else l==e&&null!=a&&a!=e&&n&&(h=mxCellPath.create(a),null==r[h]&&(r[h]=a,o.push(a)))}return o},mxGraph.prototype.getEdgesBetween=function(t,e,n){n=null!=n?n:!1;for(var i=this.getEdges(t),o=[],r=0;r<i.length;r++){var s=this.view.getState(i[r]),l=null!=s?s.getVisibleTerminal(!0):this.view.getVisibleTerminal(i[r],!0),s=null!=s?s.getVisibleTerminal(!1):this.view.getVisibleTerminal(i[r],!1);(l==t&&s==e||!n&&l==e&&s==t)&&o.push(i[r])}return o},mxGraph.prototype.getPointForEvent=function(t,e){var n=mxUtils.convertPoint(this.container,mxEvent.getClientX(t),mxEvent.getClientY(t)),i=this.view.scale,o=this.view.translate,r=0!=e?this.gridSize/2:0;return n.x=this.snap(n.x/i-o.x-r),n.y=this.snap(n.y/i-o.y-r),n},mxGraph.prototype.getCells=function(t,e,n,i,o,r){if(r=null!=r?r:[],n>0||i>0){var s=t+n,l=e+i;if(o=o||this.getDefaultParent(),null!=o)for(var a=this.model.getChildCount(o),h=0;a>h;h++){var d=this.model.getChildAt(o,h),u=this.view.getState(d);if(this.isCellVisible(d)&&null!=u){var c=u,u=mxUtils.getValue(u.style,mxConstants.STYLE_ROTATION)||0;0!=u&&(c=mxUtils.getBoundingBox(c,u)),c.x>=t&&c.y+c.height<=l&&c.y>=e&&c.x+c.width<=s?r.push(d):this.getCells(t,e,n,i,d,r)}}}return r},mxGraph.prototype.getCellsBeyond=function(t,e,n,i,o){var r=[];if((i||o)&&(null==n&&(n=this.getDefaultParent()),null!=n))for(var s=this.model.getChildCount(n),l=0;s>l;l++){var a=this.model.getChildAt(n,l),h=this.view.getState(a);this.isCellVisible(a)&&null!=h&&(!i||h.x>=t)&&(!o||h.y>=e)&&r.push(a)}return r},mxGraph.prototype.findTreeRoots=function(t,e,n){e=null!=e?e:!1,n=null!=n?n:!1;var i=[];if(null!=t){for(var o=this.getModel(),r=o.getChildCount(t),s=null,l=0,a=0;r>a;a++){var h=o.getChildAt(t,a);if(this.model.isVertex(h)&&this.isCellVisible(h)){for(var d=this.getConnections(h,e?t:null),u=0,c=0,p=0;p<d.length;p++)this.view.getVisibleTerminal(d[p],!0)==h?u++:c++;(n&&0==u&&c>0||!n&&0==c&&u>0)&&i.push(h),d=n?c-u:u-c,d>l&&(l=d,s=h)}}0==i.length&&null!=s&&i.push(s)}return i},mxGraph.prototype.traverse=function(t,e,n,i,o){if(null!=n&&null!=t){e=null!=e?e:!0,o=o||[];var r=mxCellPath.create(t);if(null==o[r]&&(o[r]=t,i=n(t,i),null==i||i)&&(i=this.model.getEdgeCount(t),i>0))for(r=0;i>r;r++){var s=this.model.getEdgeAt(t,r),l=this.model.getTerminal(s,!0)==t;(!e||l)&&(l=this.model.getTerminal(s,!l),this.traverse(l,e,n,s,o))}}},mxGraph.prototype.isCellSelected=function(t){return this.getSelectionModel().isSelected(t)},mxGraph.prototype.isSelectionEmpty=function(){return this.getSelectionModel().isEmpty()},mxGraph.prototype.clearSelection=function(){return this.getSelectionModel().clear()},mxGraph.prototype.getSelectionCount=function(){return this.getSelectionModel().cells.length},mxGraph.prototype.getSelectionCell=function(){return this.getSelectionModel().cells[0]},mxGraph.prototype.getSelectionCells=function(){return this.getSelectionModel().cells.slice()},mxGraph.prototype.setSelectionCell=function(t){this.getSelectionModel().setCell(t)},mxGraph.prototype.setSelectionCells=function(t){this.getSelectionModel().setCells(t)},mxGraph.prototype.addSelectionCell=function(t){this.getSelectionModel().addCell(t)},mxGraph.prototype.addSelectionCells=function(t){this.getSelectionModel().addCells(t)},mxGraph.prototype.removeSelectionCell=function(t){this.getSelectionModel().removeCell(t)},mxGraph.prototype.removeSelectionCells=function(t){this.getSelectionModel().removeCells(t)},mxGraph.prototype.selectRegion=function(t,e){var n=this.getCells(t.x,t.y,t.width,t.height);return this.selectCellsForEvent(n,e),n},mxGraph.prototype.selectNextCell=function(){this.selectCell(!0)},mxGraph.prototype.selectPreviousCell=function(){this.selectCell()},mxGraph.prototype.selectParentCell=function(){this.selectCell(!1,!0)},mxGraph.prototype.selectChildCell=function(){this.selectCell(!1,!1,!0)},mxGraph.prototype.selectCell=function(t,e,n){var i=this.selectionModel,o=0<i.cells.length?i.cells[0]:null;1<i.cells.length&&i.clear();var i=null!=o?this.model.getParent(o):this.getDefaultParent(),r=this.model.getChildCount(i);null==o&&r>0?(t=this.model.getChildAt(i,0),this.setSelectionCell(t)):null!=o&&!e||null==this.view.getState(i)||null==this.model.getGeometry(i)?null!=o&&n?0<this.model.getChildCount(o)&&(t=this.model.getChildAt(o,0),this.setSelectionCell(t)):r>0&&(e=i.getIndex(o),t?(e++,t=this.model.getChildAt(i,e%r)):(e--,t=this.model.getChildAt(i,0>e?r-1:e)),this.setSelectionCell(t)):this.getCurrentRoot()!=i&&this.setSelectionCell(i)},mxGraph.prototype.selectAll=function(t){t=t||this.getDefaultParent(),t=this.model.getChildren(t),null!=t&&this.setSelectionCells(t)},mxGraph.prototype.selectVertices=function(t){this.selectCells(!0,!1,t)},mxGraph.prototype.selectEdges=function(t){this.selectCells(!1,!0,t)},mxGraph.prototype.selectCells=function(t,e,n){n=n||this.getDefaultParent();var i=mxUtils.bind(this,function(n){return null!=this.view.getState(n)&&0==this.model.getChildCount(n)&&(this.model.isVertex(n)&&t||this.model.isEdge(n)&&e)});n=this.model.filterDescendants(i,n),this.setSelectionCells(n)},mxGraph.prototype.selectCellForEvent=function(t,e){var n=this.isCellSelected(t);this.isToggleEvent(e)?n?this.removeSelectionCell(t):this.addSelectionCell(t):(!n||1!=this.getSelectionCount())&&this.setSelectionCell(t)},mxGraph.prototype.selectCellsForEvent=function(t,e){this.isToggleEvent(e)?this.addSelectionCells(t):this.setSelectionCells(t)},mxGraph.prototype.createHandler=function(t){var e=null;return null!=t&&(this.model.isEdge(t.cell)?(e=this.view.getEdgeStyle(t),e=this.isLoop(t)||e==mxEdgeStyle.ElbowConnector||e==mxEdgeStyle.SideToSide||e==mxEdgeStyle.TopToBottom?new mxElbowEdgeHandler(t):e==mxEdgeStyle.SegmentConnector||e==mxEdgeStyle.OrthConnector?new mxEdgeSegmentHandler(t):new mxEdgeHandler(t)):e=new mxVertexHandler(t)),e},mxGraph.prototype.addMouseListener=function(t){null==this.mouseListeners&&(this.mouseListeners=[]),this.mouseListeners.push(t)},mxGraph.prototype.removeMouseListener=function(t){if(null!=this.mouseListeners)for(var e=0;e<this.mouseListeners.length;e++)if(this.mouseListeners[e]==t){this.mouseListeners.splice(e,1);break}},mxGraph.prototype.updateMouseEvent=function(t){if(null==t.graphX||null==t.graphY){var e=mxUtils.convertPoint(this.container,t.getX(),t.getY());t.graphX=e.x-this.panDx,t.graphY=e.y-this.panDy}},mxGraph.prototype.fireMouseEvent=function(t,e,n){if(null==n&&(n=this),this.updateMouseEvent(e),t==mxEvent.MOUSE_DOWN&&(this.isMouseDown=!0),mxClient.IS_TOUCH&&this.doubleTapEnabled&&t==mxEvent.MOUSE_DOWN){var i=(new Date).getTime();i-this.lastTouchTime<this.doubleTapTimeout&&Math.abs(this.lastTouchX-e.getX())<this.doubleTapTolerance&&Math.abs(this.lastTouchY-e.getY())<this.doubleTapTolerance?(this.lastTouchTime=0,this.dblClick(e.getEvent(),e.getCell()),e.getEvent().cancelBubble=!0):(this.lastTouchX=e.getX(),this.lastTouchY=e.getY(),this.lastTouchTime=i)}if(i=2!=e.getEvent().detail,mxClient.IS_IE&&"CSS1Compat"==document.compatMode&&((null!=this.lastMouseX&&Math.abs(this.lastMouseX-e.getX())>this.doubleTapTolerance||null!=this.lastMouseY&&Math.abs(this.lastMouseY-e.getY())>this.doubleTapTolerance)&&(i=!0),t==mxEvent.MOUSE_UP&&(this.lastMouseX=e.getX(),this.lastMouseY=e.getY())),(t!=mxEvent.MOUSE_UP||this.isMouseDown)&&i){if(t==mxEvent.MOUSE_UP&&(this.isMouseDown=!1),!this.isEditing()&&(mxClient.IS_OP||mxClient.IS_SF||mxClient.IS_GC||mxClient.IS_IE&&mxClient.IS_SVG||e.getEvent().target!=this.container)){if(t==mxEvent.MOUSE_MOVE&&this.isMouseDown&&this.autoScroll&&this.scrollPointToVisible(e.getGraphX(),e.getGraphY(),this.autoExtend),null!=this.mouseListeners)for(n=[n,e],e.getEvent().returnValue=!0,i=0;i<this.mouseListeners.length;i++){var o=this.mouseListeners[i];t==mxEvent.MOUSE_DOWN?o.mouseDown.apply(o,n):t==mxEvent.MOUSE_MOVE?o.mouseMove.apply(o,n):t==mxEvent.MOUSE_UP&&o.mouseUp.apply(o,n)}t==mxEvent.MOUSE_UP&&this.click(e)}}else t==mxEvent.MOUSE_UP&&(this.isMouseDown=!1)},mxGraph.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,null!=this.tooltipHandler&&this.tooltipHandler.destroy(),null!=this.selectionCellsHandler&&this.selectionCellsHandler.destroy(),null!=this.panningHandler&&this.panningHandler.destroy(),null!=this.connectionHandler&&this.connectionHandler.destroy(),null!=this.graphHandler&&this.graphHandler.destroy(),null!=this.cellEditor&&this.cellEditor.destroy(),null!=this.view&&this.view.destroy(),null!=this.model&&null!=this.graphModelChangeListener&&(this.model.removeListener(this.graphModelChangeListener),this.graphModelChangeListener=null),this.container=null)},mxCellOverlay.prototype=new mxEventSource,mxCellOverlay.prototype.constructor=mxCellOverlay,mxCellOverlay.prototype.image=null,mxCellOverlay.prototype.tooltip=null,mxCellOverlay.prototype.align=mxConstants.ALIGN_RIGHT,mxCellOverlay.prototype.verticalAlign=mxConstants.ALIGN_BOTTOM,mxCellOverlay.prototype.offset=null,mxCellOverlay.prototype.cursor=null,mxCellOverlay.prototype.defaultOverlap=.5,mxCellOverlay.prototype.getBounds=function(t){var e=t.view.graph.getModel().isEdge(t.cell),n=t.view.scale,i=null,o=this.image.width,r=this.image.height;return e?(e=t.absolutePoints,1==e.length%2?i=e[Math.floor(e.length/2)]:(i=e.length/2,t=e[i-1],e=e[i],i=new mxPoint(t.x+(e.x-t.x)/2,t.y+(e.y-t.y)/2))):(i=new mxPoint,i.x=this.align==mxConstants.ALIGN_LEFT?t.x:this.align==mxConstants.ALIGN_CENTER?t.x+t.width/2:t.x+t.width,i.y=this.verticalAlign==mxConstants.ALIGN_TOP?t.y:this.verticalAlign==mxConstants.ALIGN_MIDDLE?t.y+t.height/2:t.y+t.height),new mxRectangle(Math.round(i.x-(o*this.defaultOverlap-this.offset.x)*n),Math.round(i.y-(r*this.defaultOverlap-this.offset.y)*n),o*n,r*n)},mxCellOverlay.prototype.toString=function(){return this.tooltip},mxOutline.prototype.source=null,mxOutline.prototype.outline=null,mxOutline.prototype.graphRenderHint=mxConstants.RENDERING_HINT_FASTER,mxOutline.prototype.enabled=!0,mxOutline.prototype.showViewport=!0,mxOutline.prototype.border=10,mxOutline.prototype.sizerSize=8,mxOutline.prototype.updateOnPan=!1,mxOutline.prototype.sizerImage=null,mxOutline.prototype.suspended=!1,mxOutline.prototype.init=function(t){this.outline=new mxGraph(t,this.source.getModel(),this.graphRenderHint,this.source.getStylesheet()),this.outline.foldingEnabled=!1,this.outline.autoScroll=!1;var e=this.outline.graphModelChanged;this.outline.graphModelChanged=mxUtils.bind(this,function(){!this.suspended&&null!=this.outline&&e.apply(this.outline,arguments)}),mxClient.IS_SVG&&(t=this.outline.getView().getCanvas().parentNode,t.setAttribute("shape-rendering","optimizeSpeed"),t.setAttribute("image-rendering","optimizeSpeed")),this.outline.labelsVisible=!1,this.outline.setEnabled(!1),this.updateHandler=mxUtils.bind(this,function(){!this.suspended&&!this.active&&this.update()}),this.source.getModel().addListener(mxEvent.CHANGE,this.updateHandler),this.outline.addMouseListener(this),t=this.source.getView(),t.addListener(mxEvent.SCALE,this.updateHandler),t.addListener(mxEvent.TRANSLATE,this.updateHandler),t.addListener(mxEvent.SCALE_AND_TRANSLATE,this.updateHandler),t.addListener(mxEvent.DOWN,this.updateHandler),t.addListener(mxEvent.UP,this.updateHandler),mxEvent.addListener(this.source.container,"scroll",this.updateHandler),this.panHandler=mxUtils.bind(this,function(){this.updateOnPan&&this.updateHandler.apply(this,arguments)}),this.source.addListener(mxEvent.PAN,this.panHandler),this.refreshHandler=mxUtils.bind(this,function(){this.outline.setStylesheet(this.source.getStylesheet()),this.outline.refresh()}),this.source.addListener(mxEvent.REFRESH,this.refreshHandler),this.bounds=new mxRectangle(0,0,0,0),this.selectionBorder=new mxRectangleShape(this.bounds,null,mxConstants.OUTLINE_COLOR,mxConstants.OUTLINE_STROKEWIDTH),this.selectionBorder.dialect=this.outline.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG,this.selectionBorder.init(this.outline.getView().getOverlayPane()),t=mxUtils.bind(this,function(t){var e=mxEvent.getSource(t),n=mxUtils.bind(this,function(t){this.outline.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(t))}),i=mxUtils.bind(this,function(t){mxEvent.removeGestureListeners(e,null,n,i),this.outline.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(t))});mxEvent.addGestureListeners(e,null,n,i),this.outline.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(t))}),mxEvent.addGestureListeners(this.selectionBorder.node,t),this.sizer=this.createSizer(),this.sizer.init(this.outline.getView().getOverlayPane()),this.enabled&&(this.sizer.node.style.cursor="pointer"),mxEvent.addGestureListeners(this.sizer.node,t),this.selectionBorder.node.style.display=this.showViewport?"":"none",this.sizer.node.style.display=this.selectionBorder.node.style.display,this.selectionBorder.node.style.cursor="move",this.update(!1)},mxOutline.prototype.isEnabled=function(){return this.enabled},mxOutline.prototype.setEnabled=function(t){this.enabled=t},mxOutline.prototype.setZoomEnabled=function(t){this.sizer.node.style.visibility=t?"visible":"hidden"},mxOutline.prototype.refresh=function(){this.update(!0)},mxOutline.prototype.createSizer=function(){var t=null!=this.sizerImage?new mxImageShape(new mxRectangle(0,0,this.sizerImage.width,this.sizerImage.height),this.sizerImage.src):new mxRectangleShape(new mxRectangle(0,0,this.sizerSize,this.sizerSize),mxConstants.OUTLINE_HANDLE_FILLCOLOR,mxConstants.OUTLINE_HANDLE_STROKECOLOR);return t.dialect=this.outline.dialect,t},mxOutline.prototype.getSourceContainerSize=function(){return new mxRectangle(0,0,this.source.container.scrollWidth,this.source.container.scrollHeight)},mxOutline.prototype.getOutlineOffset=function(){return null},mxOutline.prototype.update=function(t){if(null!=this.source){var e=this.source.view.scale,n=this.source.getGraphBounds(),n=new mxRectangle(n.x/e+this.source.panDx,n.y/e+this.source.panDy,n.width/e,n.height/e),i=new mxRectangle(0,0,this.source.container.clientWidth/e,this.source.container.clientHeight/e),o=n.clone();o.add(i);var r=this.getSourceContainerSize(),i=Math.max(r.width/e,o.width),e=Math.max(r.height/e,o.height),o=Math.max(0,this.outline.container.clientWidth-this.border),r=Math.max(0,this.outline.container.clientHeight-this.border),o=Math.min(o/i,r/e);if(o>0){this.outline.getView().scale!=o&&(this.outline.getView().scale=o,t=!0),i=this.outline.getView(),i.currentRoot!=this.source.getView().currentRoot&&i.setCurrentRoot(this.source.getView().currentRoot);var e=this.source.view.translate,r=e.x+this.source.panDx,s=e.y+this.source.panDy,o=this.getOutlineOffset(o);null!=o&&(r+=o.x,s+=o.y),0>n.x&&(r-=n.x),0>n.y&&(s-=n.y),(i.translate.x!=r||i.translate.y!=s)&&(i.translate.x=r,i.translate.y=s,t=!0);var n=i.translate,o=this.source.getView().scale,r=o/i.scale,s=1/i.scale,l=this.source.container;this.bounds=new mxRectangle((n.x-e.x-this.source.panDx)/s,(n.y-e.y-this.source.panDy)/s,l.clientWidth/r,l.clientHeight/r),this.bounds.x+=this.source.container.scrollLeft*i.scale/o,this.bounds.y+=this.source.container.scrollTop*i.scale/o,n=this.selectionBorder.bounds,(n.x!=this.bounds.x||n.y!=this.bounds.y||n.width!=this.bounds.width||n.height!=this.bounds.height)&&(this.selectionBorder.bounds=this.bounds,this.selectionBorder.redraw()),n=this.sizer.bounds,i=new mxRectangle(this.bounds.x+this.bounds.width-n.width/2,this.bounds.y+this.bounds.height-n.height/2,n.width,n.height),(n.x!=i.x||n.y!=i.y||n.width!=i.width||n.height!=i.height)&&(this.sizer.bounds=i,"hidden"!=this.sizer.node.style.visibility&&this.sizer.redraw()),t&&this.outline.view.revalidate()}}},mxOutline.prototype.mouseDown=function(t,e){this.enabled&&this.showViewport&&(this.zoom=e.isSource(this.sizer),this.startX=e.getX(),this.startY=e.getY(),this.active=!0,this.source.useScrollbarsForPanning&&mxUtils.hasScrollbars(this.source.container)?(this.dx0=this.source.container.scrollLeft,this.dy0=this.source.container.scrollTop):this.dy0=this.dx0=0),e.consume()},mxOutline.prototype.mouseMove=function(t,e){if(this.active){this.selectionBorder.node.style.display=this.showViewport?"":"none",this.sizer.node.style.display=this.selectionBorder.node.style.display;var n=this.getTranslateForEvent(e),i=n.x,o=n.y,n=null;if(this.zoom)n=this.source.container,o=i/(n.clientWidth/n.clientHeight),n=new mxRectangle(this.bounds.x,this.bounds.y,Math.max(1,this.bounds.width+i),Math.max(1,this.bounds.height+o)),this.selectionBorder.bounds=n,this.selectionBorder.redraw();else{var r=this.outline.getView().scale,n=new mxRectangle(this.bounds.x+i,this.bounds.y+o,this.bounds.width,this.bounds.height);this.selectionBorder.bounds=n,this.selectionBorder.redraw(),i=i/r*this.source.getView().scale,o=o/r*this.source.getView().scale,this.source.panGraph(-i-this.dx0,-o-this.dy0)}i=this.sizer.bounds,this.sizer.bounds=new mxRectangle(n.x+n.width-i.width/2,n.y+n.height-i.height/2,i.width,i.height),"hidden"!=this.sizer.node.style.visibility&&this.sizer.redraw(),e.consume()}},mxOutline.prototype.getTranslateForEvent=function(t){return new mxPoint(t.getX()-this.startX,t.getY()-this.startY)},mxOutline.prototype.mouseUp=function(t,e){if(this.active){var n=this.getTranslateForEvent(e),i=n.x,n=n.y;if(0<Math.abs(i)||0<Math.abs(n)){if(this.zoom){var n=this.selectionBorder.bounds.width,o=this.source.getView().scale;this.source.zoomTo(o-i*o/n,!1)}else this.source.useScrollbarsForPanning&&mxUtils.hasScrollbars(this.source.container)||(this.source.panGraph(0,0),i/=this.outline.getView().scale,n/=this.outline.getView().scale,o=this.source.getView().translate,this.source.getView().setTranslate(o.x-i,o.y-n));this.update(),e.consume()}this.index=null,this.active=!1}},mxOutline.prototype.destroy=function(){null!=this.source&&(this.source.removeListener(this.panHandler),this.source.removeListener(this.refreshHandler),this.source.getModel().removeListener(this.updateHandler),this.source.getView().removeListener(this.updateHandler),mxEvent.addListener(this.source.container,"scroll",this.updateHandler),this.source=null),null!=this.outline&&(this.outline.removeMouseListener(this),this.outline.destroy(),this.outline=null),null!=this.selectionBorder&&(this.selectionBorder.destroy(),this.selectionBorder=null),null!=this.sizer&&(this.sizer.destroy(),this.sizer=null)},mxMultiplicity.prototype.type=null,mxMultiplicity.prototype.attr=null,mxMultiplicity.prototype.value=null,mxMultiplicity.prototype.source=null,mxMultiplicity.prototype.min=null,mxMultiplicity.prototype.max=null,mxMultiplicity.prototype.validNeighbors=null,mxMultiplicity.prototype.validNeighborsAllowed=!0,mxMultiplicity.prototype.countError=null,mxMultiplicity.prototype.typeError=null,mxMultiplicity.prototype.check=function(t,e,n,i,o,r){var s="";return(this.source&&this.checkTerminal(t,n,e)||!this.source&&this.checkTerminal(t,i,e))&&(null!=this.countError&&(this.source&&(0==this.max||o>=this.max)||!this.source&&(0==this.max||r>=this.max))&&(s+=this.countError+"\n"),null!=this.validNeighbors&&null!=this.typeError&&0<this.validNeighbors.length&&(this.checkNeighbors(t,e,n,i)||(s+=this.typeError+"\n"))),0<s.length?s:null},mxMultiplicity.prototype.checkNeighbors=function(t,e,n,i){e=t.model.getValue(n),i=t.model.getValue(i),n=!this.validNeighborsAllowed;for(var o=this.validNeighbors,r=0;r<o.length;r++){if(this.source&&this.checkType(t,i,o[r])){n=this.validNeighborsAllowed;break}if(!this.source&&this.checkType(t,e,o[r])){n=this.validNeighborsAllowed;break}}return n},mxMultiplicity.prototype.checkTerminal=function(t,e){return e=t.model.getValue(e),this.checkType(t,e,this.type,this.attr,this.value)},mxMultiplicity.prototype.checkType=function(t,e,n,i,o){return null!=e?isNaN(e.nodeType)?e==n:mxUtils.isNode(e,n,i,o):!1},mxLayoutManager.prototype=new mxEventSource,mxLayoutManager.prototype.constructor=mxLayoutManager,mxLayoutManager.prototype.graph=null,mxLayoutManager.prototype.bubbling=!0,mxLayoutManager.prototype.enabled=!0,mxLayoutManager.prototype.updateHandler=null,mxLayoutManager.prototype.moveHandler=null,mxLayoutManager.prototype.isEnabled=function(){return this.enabled},mxLayoutManager.prototype.setEnabled=function(t){this.enabled=t},mxLayoutManager.prototype.isBubbling=function(){return this.bubbling},mxLayoutManager.prototype.setBubbling=function(t){this.bubbling=t},mxLayoutManager.prototype.getGraph=function(){return this.graph},mxLayoutManager.prototype.setGraph=function(t){if(null!=this.graph){var e=this.graph.getModel();e.removeListener(this.undoHandler),this.graph.removeListener(this.moveHandler)}this.graph=t,null!=this.graph&&(e=this.graph.getModel(),e.addListener(mxEvent.BEFORE_UNDO,this.undoHandler),this.graph.addListener(mxEvent.MOVE_CELLS,this.moveHandler))},mxLayoutManager.prototype.getLayout=function(){return null},mxLayoutManager.prototype.beforeUndo=function(t){t=this.getCellsForChanges(t.changes);var e=this.getGraph().getModel();if(this.isBubbling())for(var n=e.getParents(t);0<n.length;)t=t.concat(n),n=e.getParents(n);this.layoutCells(mxUtils.sortCells(t,!1))},mxLayoutManager.prototype.cellsMoved=function(t,e){if(null!=t&&null!=e)for(var n=mxUtils.convertPoint(this.getGraph().container,mxEvent.getClientX(e),mxEvent.getClientY(e)),i=this.getGraph().getModel(),o=0;o<t.length;o++){var r=this.getLayout(i.getParent(t[o]));null!=r&&r.moveCell(t[o],n.x,n.y)}},mxLayoutManager.prototype.getCellsForChanges=function(t){for(var e=[],n={},i=0;i<t.length;i++){var o=t[i];if(o instanceof mxRootChange)return[];for(var o=this.getCellsForChange(o),r=0;r<o.length;r++)if(null!=o[r]){var s=mxCellPath.create(o[r]);null==n[s]&&(n[s]=o[r],e.push(o[r]))}}return e},mxLayoutManager.prototype.getCellsForChange=function(t){var e=this.getGraph().getModel();return t instanceof mxChildChange?[t.child,t.previous,e.getParent(t.child)]:t instanceof mxTerminalChange||t instanceof mxGeometryChange?[t.cell,e.getParent(t.cell)]:[]},mxLayoutManager.prototype.layoutCells=function(t){if(0<t.length){var e=this.getGraph().getModel();e.beginUpdate();try{for(var n=null,i=0;i<t.length;i++)t[i]!=e.getRoot()&&t[i]!=n&&(n=t[i],this.executeLayout(this.getLayout(n),n));this.fireEvent(new mxEventObject(mxEvent.LAYOUT_CELLS,"cells",t))}finally{e.endUpdate()}}},mxLayoutManager.prototype.executeLayout=function(t,e){null!=t&&null!=e&&t.execute(e)},mxLayoutManager.prototype.destroy=function(){this.setGraph(null)},mxSpaceManager.prototype=new mxEventSource,mxSpaceManager.prototype.constructor=mxSpaceManager,mxSpaceManager.prototype.graph=null,mxSpaceManager.prototype.enabled=!0,mxSpaceManager.prototype.shiftRightwards=!0,mxSpaceManager.prototype.shiftDownwards=!0,mxSpaceManager.prototype.extendParents=!0,mxSpaceManager.prototype.resizeHandler=null,mxSpaceManager.prototype.foldHandler=null,mxSpaceManager.prototype.isCellIgnored=function(t){return!this.getGraph().getModel().isVertex(t)},mxSpaceManager.prototype.isCellShiftable=function(t){return this.getGraph().getModel().isVertex(t)&&this.getGraph().isCellMovable(t)},mxSpaceManager.prototype.isEnabled=function(){return this.enabled},mxSpaceManager.prototype.setEnabled=function(t){this.enabled=t},mxSpaceManager.prototype.isShiftRightwards=function(){return this.shiftRightwards},mxSpaceManager.prototype.setShiftRightwards=function(t){this.shiftRightwards=t},mxSpaceManager.prototype.isShiftDownwards=function(){return this.shiftDownwards},mxSpaceManager.prototype.setShiftDownwards=function(t){this.shiftDownwards=t},mxSpaceManager.prototype.isExtendParents=function(){return this.extendParents},mxSpaceManager.prototype.setExtendParents=function(t){this.extendParents=t},mxSpaceManager.prototype.getGraph=function(){return this.graph
},mxSpaceManager.prototype.setGraph=function(t){null!=this.graph&&(this.graph.removeListener(this.resizeHandler),this.graph.removeListener(this.foldHandler)),this.graph=t,null!=this.graph&&(this.graph.addListener(mxEvent.RESIZE_CELLS,this.resizeHandler),this.graph.addListener(mxEvent.FOLD_CELLS,this.foldHandler))},mxSpaceManager.prototype.cellsResized=function(t){if(null!=t){var e=this.graph.getModel();e.beginUpdate();try{for(var n=0;n<t.length;n++)if(!this.isCellIgnored(t[n])){this.cellResized(t[n]);break}}finally{e.endUpdate()}}},mxSpaceManager.prototype.cellResized=function(t){var e=this.getGraph(),n=e.getView(),i=e.getModel(),o=n.getState(t),r=n.getState(i.getParent(t));if(null!=o&&null!=r){var s=this.getCellsToShift(o),l=i.getGeometry(t);if(null!=s&&null!=l){var a=n.translate,h=n.scale,n=o.x-r.origin.x-a.x*h,r=o.y-r.origin.y-a.y*h,a=o.x+o.width,d=o.y+o.height,u=o.width-l.width*h+n-l.x*h,c=o.height-l.height*h+r-l.y*h,p=1-l.width*h/o.width,o=1-l.height*h/o.height;i.beginUpdate();try{for(l=0;l<s.length;l++)s[l]!=t&&this.isCellShiftable(s[l])&&this.shiftCell(s[l],u,c,n,r,a,d,p,o,this.isExtendParents()&&e.isExtendParent(s[l]))}finally{i.endUpdate()}}}},mxSpaceManager.prototype.shiftCell=function(t,e,n,i,o,r,s,l,a,h){i=this.getGraph();var d=i.getView().getState(t);if(null!=d){var u=i.getModel(),c=u.getGeometry(t);if(null!=c){u.beginUpdate();try{if(this.isShiftRightwards())if(d.x>=r)c=c.clone(),c.translate(-e,0);else{var p=Math.max(0,d.x-x0),c=c.clone();c.translate(-l*p,0)}if(this.isShiftDownwards())if(d.y>=s)c=c.clone(),c.translate(0,-n);else{var m=Math.max(0,d.y-o),c=c.clone();c.translate(0,-a*m)}c!=u.getGeometry(t)&&(u.setGeometry(t,c),h&&i.extendParent(t))}finally{u.endUpdate()}}}},mxSpaceManager.prototype.getCellsToShift=function(t){var e=this.getGraph(),n=e.getModel().getParent(t.cell),i=this.isShiftDownwards(),o=this.isShiftRightwards();return e.getCellsBeyond(t.x+(i?0:t.width),t.y+(i&&o?0:t.height),n,o,i)},mxSpaceManager.prototype.destroy=function(){this.setGraph(null)},mxSwimlaneManager.prototype=new mxEventSource,mxSwimlaneManager.prototype.constructor=mxSwimlaneManager,mxSwimlaneManager.prototype.graph=null,mxSwimlaneManager.prototype.enabled=!0,mxSwimlaneManager.prototype.horizontal=!0,mxSwimlaneManager.prototype.addEnabled=!0,mxSwimlaneManager.prototype.resizeEnabled=!0,mxSwimlaneManager.prototype.addHandler=null,mxSwimlaneManager.prototype.resizeHandler=null,mxSwimlaneManager.prototype.isEnabled=function(){return this.enabled},mxSwimlaneManager.prototype.setEnabled=function(t){this.enabled=t},mxSwimlaneManager.prototype.isHorizontal=function(){return this.horizontal},mxSwimlaneManager.prototype.setHorizontal=function(t){this.horizontal=t},mxSwimlaneManager.prototype.isAddEnabled=function(){return this.addEnabled},mxSwimlaneManager.prototype.setAddEnabled=function(t){this.addEnabled=t},mxSwimlaneManager.prototype.isResizeEnabled=function(){return this.resizeEnabled},mxSwimlaneManager.prototype.setResizeEnabled=function(t){this.resizeEnabled=t},mxSwimlaneManager.prototype.getGraph=function(){return this.graph},mxSwimlaneManager.prototype.setGraph=function(t){null!=this.graph&&(this.graph.removeListener(this.addHandler),this.graph.removeListener(this.resizeHandler)),this.graph=t,null!=this.graph&&(this.graph.addListener(mxEvent.ADD_CELLS,this.addHandler),this.graph.addListener(mxEvent.CELLS_RESIZED,this.resizeHandler))},mxSwimlaneManager.prototype.isSwimlaneIgnored=function(t){return!this.getGraph().isSwimlane(t)},mxSwimlaneManager.prototype.isCellHorizontal=function(t){if(this.graph.isSwimlane(t)){var e=this.graph.view.getState(t);return t=null!=e?e.style:this.graph.getCellStyle(t),1==mxUtils.getValue(t,mxConstants.STYLE_HORIZONTAL,1)}return!this.isHorizontal()},mxSwimlaneManager.prototype.cellsAdded=function(t){if(null!=t){var e=this.getGraph().getModel();e.beginUpdate();try{for(var n=0;n<t.length;n++)this.isSwimlaneIgnored(t[n])||this.swimlaneAdded(t[n])}finally{e.endUpdate()}}},mxSwimlaneManager.prototype.swimlaneAdded=function(t){for(var e=this.getGraph().getModel(),n=e.getParent(t),i=e.getChildCount(n),o=null,r=0;i>r;r++){var s=e.getChildAt(n,r);if(s!=t&&!this.isSwimlaneIgnored(s)&&(o=e.getGeometry(s),null!=o))break}null!=o&&this.resizeSwimlane(t,o.width,o.height)},mxSwimlaneManager.prototype.cellsResized=function(t){if(null!=t){var e=this.getGraph().getModel();e.beginUpdate();try{for(var n=0;n<t.length;n++)if(!this.isSwimlaneIgnored(t[n])){var i=e.getGeometry(t[n]);if(null!=i){for(var o=new mxRectangle(0,0,i.width,i.height),r=t[n],s=r;null!=s;){var r=s,s=e.getParent(s),l=this.graph.isSwimlane(s)?this.graph.getStartSize(s):new mxRectangle;o.width+=l.width,o.height+=l.height}this.resizeSwimlane(r,o.width,o.height)}}}finally{e.endUpdate()}}},mxSwimlaneManager.prototype.resizeSwimlane=function(t,e,n){var i=this.getGraph().getModel();i.beginUpdate();try{if(!this.isSwimlaneIgnored(t)){var o=i.getGeometry(t);if(null!=o){var r=this.isCellHorizontal(t);(r&&o.height!=n||!r&&o.width!=e)&&(o=o.clone(),r?o.height=n:o.width=e,i.setGeometry(t,o))}}var s=this.graph.isSwimlane(t)?this.graph.getStartSize(t):new mxRectangle;e-=s.width,n-=s.height;for(var l=i.getChildCount(t),o=0;l>o;o++){var a=i.getChildAt(t,o);this.resizeSwimlane(a,e,n)}}finally{i.endUpdate()}},mxSwimlaneManager.prototype.destroy=function(){this.setGraph(null)},mxTemporaryCellStates.prototype.view=null,mxTemporaryCellStates.prototype.oldStates=null,mxTemporaryCellStates.prototype.oldBounds=null,mxTemporaryCellStates.prototype.oldScale=null,mxTemporaryCellStates.prototype.destroy=function(){this.view.setScale(this.oldScale),this.view.setStates(this.oldStates),this.view.setGraphBounds(this.oldBounds)},mxCellStatePreview.prototype.graph=null,mxCellStatePreview.prototype.deltas=null,mxCellStatePreview.prototype.count=0,mxCellStatePreview.prototype.isEmpty=function(){return 0==this.count},mxCellStatePreview.prototype.moveState=function(t,e,n,i,o){i=null!=i?i:!0,o=null!=o?o:!0;var r=mxCellPath.create(t.cell),s=this.deltas[r];return null==s?(s=new mxPoint(e,n),this.deltas[r]=s,this.count++):i?(s.X+=e,s.Y+=n):(s.X=e,s.Y=n),o&&this.addEdges(t),s},mxCellStatePreview.prototype.show=function(t){var e,n=this.graph.getModel(),i=n.getRoot();for(e in this.deltas){var o=mxCellPath.resolve(i,e),r=this.graph.view.getState(o),s=this.deltas[e],o=this.graph.view.getState(n.getParent(o));this.translateState(o,r,s.x,s.y)}for(e in this.deltas)o=mxCellPath.resolve(i,e),r=this.graph.view.getState(o),s=this.deltas[e],o=this.graph.view.getState(n.getParent(o)),this.revalidateState(o,r,s.x,s.y,t)},mxCellStatePreview.prototype.translateState=function(t,e,n,i){if(null!=e){var o=this.graph.getModel();if(o.isVertex(e.cell)){e.invalid=!0,this.graph.view.validateBounds(t,e.cell),t=o.getGeometry(e.cell);var r=mxCellPath.create(e.cell);0==n&&0==i||null==t||t.relative&&null==this.deltas[r]||(e.x+=n,e.y+=i)}for(t=o.getChildCount(e.cell),r=0;t>r;r++)this.translateState(e,this.graph.view.getState(o.getChildAt(e.cell,r)),n,i)}},mxCellStatePreview.prototype.revalidateState=function(t,e,n,i,o){if(null!=e){e.invalid=!0,this.graph.view.validatePoints(t,e.cell);var r=mxCellPath.create(e.cell),s=this.graph.getModel(),l=this.graph.getCellGeometry(e.cell);for(0==n&&0==i||null==l||!l.relative||!s.isVertex(e.cell)||null!=t&&!s.isVertex(t.cell)&&null==this.deltas[r]||(e.x+=n,e.y+=i,this.graph.cellRenderer.redraw(e)),null!=o&&o(e),t=s.getChildCount(e.cell),r=0;t>r;r++)this.revalidateState(e,this.graph.view.getState(s.getChildAt(e.cell,r)),n,i,o)}},mxCellStatePreview.prototype.addEdges=function(t){for(var e=this.graph.getModel(),n=e.getEdgeCount(t.cell),i=0;n>i;i++){var o=this.graph.view.getState(e.getEdgeAt(t.cell,i));null!=o&&this.moveState(o,0,0)}},mxConnectionConstraint.prototype.point=null,mxConnectionConstraint.prototype.perimeter=null,mxGraphHandler.prototype.graph=null,mxGraphHandler.prototype.maxCells=mxClient.IS_IE?20:50,mxGraphHandler.prototype.enabled=!0,mxGraphHandler.prototype.highlightEnabled=!0,mxGraphHandler.prototype.cloneEnabled=!0,mxGraphHandler.prototype.moveEnabled=!0,mxGraphHandler.prototype.guidesEnabled=!1,mxGraphHandler.prototype.guide=null,mxGraphHandler.prototype.currentDx=null,mxGraphHandler.prototype.currentDy=null,mxGraphHandler.prototype.updateCursor=!0,mxGraphHandler.prototype.selectEnabled=!0,mxGraphHandler.prototype.removeCellsFromParent=!0,mxGraphHandler.prototype.connectOnDrop=!1,mxGraphHandler.prototype.scrollOnMove=!0,mxGraphHandler.prototype.minimumSize=6,mxGraphHandler.prototype.previewColor="black",mxGraphHandler.prototype.htmlPreview=!1,mxGraphHandler.prototype.shape=null,mxGraphHandler.prototype.scaleGrid=!1,mxGraphHandler.prototype.rotationEnabled=!0,mxGraphHandler.prototype.isEnabled=function(){return this.enabled},mxGraphHandler.prototype.setEnabled=function(t){this.enabled=t},mxGraphHandler.prototype.isCloneEnabled=function(){return this.cloneEnabled},mxGraphHandler.prototype.setCloneEnabled=function(t){this.cloneEnabled=t},mxGraphHandler.prototype.isMoveEnabled=function(){return this.moveEnabled},mxGraphHandler.prototype.setMoveEnabled=function(t){this.moveEnabled=t},mxGraphHandler.prototype.isSelectEnabled=function(){return this.selectEnabled},mxGraphHandler.prototype.setSelectEnabled=function(t){this.selectEnabled=t},mxGraphHandler.prototype.isRemoveCellsFromParent=function(){return this.removeCellsFromParent},mxGraphHandler.prototype.setRemoveCellsFromParent=function(t){this.removeCellsFromParent=t},mxGraphHandler.prototype.getInitialCellForEvent=function(t){return t.getCell()},mxGraphHandler.prototype.isDelayedSelection=function(t){return this.graph.isCellSelected(t)},mxGraphHandler.prototype.mouseDown=function(t,e){if(!e.isConsumed()&&this.isEnabled()&&this.graph.isEnabled()&&!this.graph.isForceMarqueeEvent(e.getEvent())&&null!=e.getState()){var n=this.getInitialCellForEvent(e);if(this.cell=null,this.delayedSelection=this.isDelayedSelection(n),this.isSelectEnabled()&&!this.delayedSelection&&this.graph.selectCellForEvent(n,e.getEvent()),this.isMoveEnabled()){var i=this.graph.model,o=i.getGeometry(n);this.graph.isCellMovable(n)&&(!i.isEdge(n)||1<this.graph.getSelectionCount()||null!=o.points&&0<o.points.length||null==i.getTerminal(n,!0)||null==i.getTerminal(n,!1)||this.graph.allowDanglingEdges||this.graph.isCloneEvent(e.getEvent())&&this.graph.isCellsCloneable())&&this.start(n,e.getX(),e.getY()),this.cellWasClicked=!0,!mxClient.IS_SF&&!mxClient.IS_GC||"SELECT"!=e.getSource().nodeName?e.consume():mxClient.IS_SF&&"SELECT"==e.getSource().nodeName&&(this.cellWasClicked=!1,this.first=null)}}},mxGraphHandler.prototype.getGuideStates=function(){var t=this.graph.getDefaultParent(),e=this.graph.getModel(),n=mxUtils.bind(this,function(t){return null!=this.graph.view.getState(t)&&e.isVertex(t)&&null!=e.getGeometry(t)&&!e.getGeometry(t).relative});return this.graph.view.getCellStates(e.filterDescendants(n,t))},mxGraphHandler.prototype.getCells=function(t){return!this.delayedSelection&&this.graph.isCellMovable(t)?[t]:this.graph.getMovableCells(this.graph.getSelectionCells())},mxGraphHandler.prototype.getPreviewBounds=function(t){return t=this.getBoundingBox(t),null!=t&&(t.grow(-1,-1),t.width<this.minimumSize&&(t.x-=(this.minimumSize-t.width)/2,t.width=this.minimumSize),t.height<this.minimumSize&&(t.y-=(this.minimumSize-t.height)/2,t.height=this.minimumSize)),t},mxGraphHandler.prototype.getBoundingBox=function(t){var e=null;if(null!=t&&0<t.length)for(var n=this.graph.getModel(),i=0;i<t.length;i++)if(n.isVertex(t[i])||n.isEdge(t[i])){var o=this.graph.view.getState(t[i]);if(null!=o){var r=o;n.isVertex(t[i])&&null!=o.shape&&null!=o.shape.boundingBox&&(r=o.shape.boundingBox),null==e?e=new mxRectangle(r.x,r.y,r.width,r.height):e.add(r)}}return e},mxGraphHandler.prototype.createPreviewShape=function(t){return t=new mxRectangleShape(t,null,this.previewColor),t.isDashed=!0,this.htmlPreview?(t.dialect=mxConstants.DIALECT_STRICTHTML,t.init(this.graph.container)):(t.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG,t.init(this.graph.getView().getOverlayPane()),t.pointerEvents=!1),t},mxGraphHandler.prototype.start=function(t,e,n){this.cell=t,this.first=mxUtils.convertPoint(this.graph.container,e,n),this.cells=this.getCells(this.cell),this.bounds=this.graph.getView().getBounds(this.cells),this.pBounds=this.getPreviewBounds(this.cells),this.guidesEnabled&&(this.guide=new mxGuide(this.graph,this.getGuideStates()))},mxGraphHandler.prototype.useGuidesForEvent=function(t){return null!=this.guide?this.guide.isEnabledForEvent(t.getEvent()):!0},mxGraphHandler.prototype.snap=function(t){var e=this.scaleGrid?this.graph.view.scale:1;return t.x=this.graph.snap(t.x/e)*e,t.y=this.graph.snap(t.y/e)*e,t},mxGraphHandler.prototype.mouseMove=function(t,e){var n=this.graph;if(!e.isConsumed()&&n.isMouseDown&&null!=this.cell&&null!=this.first&&null!=this.bounds){var i=mxUtils.convertPoint(n.container,e.getX(),e.getY()),o=i.x-this.first.x,r=i.y-this.first.y,i=n.tolerance;if(null!=this.shape||Math.abs(o)>i||Math.abs(r)>i){null==this.highlight&&(this.highlight=new mxCellHighlight(this.graph,mxConstants.DROP_TARGET_COLOR,3)),null==this.shape&&(this.shape=this.createPreviewShape(this.bounds));var s=n.isGridEnabledEvent(e.getEvent()),i=!0;if(null!=this.guide&&this.useGuidesForEvent(e))r=this.guide.move(this.bounds,new mxPoint(o,r),s),i=!1,o=r.x,r=r.y;else if(s)var l=n.getView().translate,a=n.getView().scale,s=this.bounds.x-(n.snap(this.bounds.x/a-l.x)+l.x)*a,l=this.bounds.y-(n.snap(this.bounds.y/a-l.y)+l.y)*a,r=this.snap(new mxPoint(o,r)),o=r.x-s,r=r.y-l;for(null!=this.guide&&i&&this.guide.hide(),n.isConstrainedEvent(e.getEvent())&&(Math.abs(o)>Math.abs(r)?r=0:o=0),this.currentDx=o,this.currentDy=r,this.updatePreviewShape(),i=null,r=e.getCell(),n.isDropEnabled()&&this.highlightEnabled&&(i=n.getDropTarget(this.cells,e.getEvent(),r)),s=i,l=n.getModel();null!=s&&s!=this.cells[0];)s=l.getParent(s);var a=n.isCloneEvent(e.getEvent())&&n.isCellsCloneable()&&this.isCloneEnabled(),o=n.getView().getState(i),h=!1;null==o||null!=s||l.getParent(this.cell)==i&&!a?(this.target=null,this.connectOnDrop&&null!=r&&1==this.cells.length&&n.getModel().isVertex(r)&&n.isCellConnectable(r)&&(o=n.getView().getState(r),null!=o&&(n=null==n.getEdgeValidationError(null,this.cell,r)?mxConstants.VALID_COLOR:mxConstants.INVALID_CONNECT_TARGET_COLOR,this.setHighlightColor(n),h=!0))):(this.target!=i&&(this.target=i,this.setHighlightColor(mxConstants.DROP_TARGET_COLOR)),h=!0),null!=o&&h?this.highlight.highlight(o):this.highlight.hide()}e.consume(),mxEvent.consume(e.getEvent())}else!this.isMoveEnabled()&&!this.isCloneEnabled()||!this.updateCursor||e.isConsumed()||null==e.getState()||n.isMouseDown||(o=n.getCursorForCell(e.getCell()),null==o&&n.isEnabled()&&n.isCellMovable(e.getCell())&&(o=n.getModel().isEdge(e.getCell())?mxConstants.CURSOR_MOVABLE_EDGE:mxConstants.CURSOR_MOVABLE_VERTEX),e.getState().setCursor(o),e.consume())},mxGraphHandler.prototype.updatePreviewShape=function(){null!=this.shape&&(this.shape.bounds=new mxRectangle(Math.round(this.pBounds.x+this.currentDx-this.graph.panDx),Math.round(this.pBounds.y+this.currentDy-this.graph.panDy),this.pBounds.width,this.pBounds.height),this.shape.redraw())},mxGraphHandler.prototype.setHighlightColor=function(t){null!=this.highlight&&this.highlight.setHighlightColor(t)},mxGraphHandler.prototype.mouseUp=function(t,e){if(!e.isConsumed()){var n=this.graph;if(null!=this.cell&&null!=this.first&&null!=this.shape&&null!=this.currentDx&&null!=this.currentDy){var i=n.getView().scale,o=n.isCloneEvent(e.getEvent())&&n.isCellsCloneable()&&this.isCloneEnabled(),r=this.currentDx/i,i=this.currentDy/i,s=e.getCell();this.connectOnDrop&&null==this.target&&null!=s&&n.getModel().isVertex(s)&&n.isCellConnectable(s)&&n.isEdgeValid(null,this.cell,s)?n.connectionHandler.connect(this.cell,s,e.getEvent()):(s=this.target,n.isSplitEnabled()&&n.isSplitTarget(s,this.cells,e.getEvent())?n.splitEdge(s,this.cells,null,r,i):this.moveCells(this.cells,r,i,o,this.target,e.getEvent()))}else this.isSelectEnabled()&&this.delayedSelection&&null!=this.cell&&this.selectDelayed(e)}this.cellWasClicked&&e.consume(),this.reset()},mxGraphHandler.prototype.selectDelayed=function(t){this.graph.selectCellForEvent(this.cell,t.getEvent())},mxGraphHandler.prototype.reset=function(){this.destroyShapes(),this.delayedSelection=this.cellWasClicked=!1,this.target=this.cell=this.first=this.guides=this.currentDy=this.currentDx=null},mxGraphHandler.prototype.shouldRemoveCellsFromParent=function(t,e,n){if(this.graph.getModel().isVertex(t)){t=this.graph.getView().getState(t),n=mxUtils.convertPoint(this.graph.container,mxEvent.getClientX(n),mxEvent.getClientY(n));var i=mxUtils.toRadians(mxUtils.getValue(t.style,mxConstants.STYLE_ROTATION)||0);if(0!=i){e=Math.cos(-i);var i=Math.sin(-i),o=new mxPoint(t.getCenterX(),t.getCenterY());n=mxUtils.getRotatedPoint(n,e,i,o)}return null!=t&&!mxUtils.contains(t,n.x,n.y)}return!1},mxGraphHandler.prototype.moveCells=function(t,e,n,i,o,r){i&&(t=this.graph.getCloneableCells(t)),null==o&&this.isRemoveCellsFromParent()&&this.shouldRemoveCellsFromParent(this.graph.getModel().getParent(this.cell),t,r)&&(o=this.graph.getDefaultParent()),t=this.graph.moveCells(t,e-this.graph.panDx/this.graph.view.scale,n-this.graph.panDy/this.graph.view.scale,i,o,r),this.isSelectEnabled()&&this.scrollOnMove&&this.graph.scrollCellToVisible(t[0]),i&&this.graph.setSelectionCells(t)},mxGraphHandler.prototype.destroyShapes=function(){null!=this.shape&&(this.shape.destroy(),this.shape=null),null!=this.guide&&(this.guide.destroy(),this.guide=null),null!=this.highlight&&(this.highlight.destroy(),this.highlight=null)},mxGraphHandler.prototype.destroy=function(){this.graph.removeMouseListener(this),this.graph.removeListener(this.panHandler),this.destroyShapes()},mxPanningHandler.prototype=new mxPopupMenu,mxPanningHandler.prototype.constructor=mxPanningHandler,mxPanningHandler.prototype.graph=null,mxPanningHandler.prototype.triggerX=null,mxPanningHandler.prototype.triggerY=null,mxPanningHandler.prototype.usePopupTrigger=!0,mxPanningHandler.prototype.useLeftButtonForPanning=!1,mxPanningHandler.prototype.selectOnPopup=!0,mxPanningHandler.prototype.clearSelectionOnBackground=!0,mxPanningHandler.prototype.ignoreCell=!1,mxPanningHandler.prototype.previewEnabled=!0,mxPanningHandler.prototype.useGrid=!1,mxPanningHandler.prototype.panningEnabled=!0,mxPanningHandler.prototype.isPanningEnabled=function(){return this.panningEnabled},mxPanningHandler.prototype.setPanningEnabled=function(t){this.panningEnabled=t},mxPanningHandler.prototype.init=function(){mxPopupMenu.prototype.init.apply(this),mxEvent.addGestureListeners(this.div,mxUtils.bind(this,function(){this.graph.tooltipHandler.hide()}))},mxPanningHandler.prototype.isPanningTrigger=function(t){var e=t.getEvent();return this.useLeftButtonForPanning&&(this.ignoreCell||null==t.getState())&&mxEvent.isLeftMouseButton(e)||mxEvent.isControlDown(e)&&mxEvent.isShiftDown(e)||this.usePopupTrigger&&mxEvent.isPopupTrigger(e)},mxPanningHandler.prototype.mouseDown=function(t,e){if(!e.isConsumed()&&this.isEnabled()&&!this.active){this.hideMenu(),this.dx0=-this.graph.container.scrollLeft,this.dy0=-this.graph.container.scrollTop;var n=mxUtils.convertPoint(this.graph.container,e.getX(),e.getY());this.triggerX=n.x,this.triggerY=n.y,this.popupTrigger=this.isPopupTrigger(e),this.panningTrigger=this.isPanningEnabled()&&this.isPanningTrigger(e),this.startX=e.getX(),this.startY=e.getY(),this.panningTrigger&&this.consumePanningTrigger(e)}},mxPanningHandler.prototype.consumePanningTrigger=function(t){t.consume()},mxPanningHandler.prototype.mouseMove=function(t,e){var n=e.getX()-this.startX,i=e.getY()-this.startY;if(this.active){var o=e.getEvent().scale;null!=o&&1!=o?this.scaleGraph(o,!0):this.previewEnabled&&(this.useGrid&&(n=this.graph.snap(n),i=this.graph.snap(i)),this.graph.panGraph(n+this.dx0,i+this.dy0)),this.fireEvent(new mxEventObject(mxEvent.PAN,"event",e)),e.consume()}else this.panningTrigger&&(o=this.active,this.active=Math.abs(n)>this.graph.tolerance||Math.abs(i)>this.graph.tolerance,!o&&this.active&&this.fireEvent(new mxEventObject(mxEvent.PAN_START,"event",e)))},mxPanningHandler.prototype.mouseUp=function(t,e){var n=Math.abs(e.getX()-this.startX),i=Math.abs(e.getY()-this.startY);if(this.active){if(!this.graph.useScrollbarsForPanning||!mxUtils.hasScrollbars(this.graph.container)){n=e.getX()-this.startX,i=e.getY()-this.startY,this.useGrid&&(n=this.graph.snap(n),i=this.graph.snap(i));var o=this.graph.getView().scale,r=this.graph.getView().translate;this.graph.panGraph(0,0);var s=e.getEvent().scale;null!=s&&1!=s?this.scaleGraph(s,!1):this.panGraph(r.x+n/o,r.y+i/o)}this.active=!1,this.fireEvent(new mxEventObject(mxEvent.PAN_END,"event",e)),e.consume()}else this.popupTrigger&&n<this.graph.tolerance&&i<this.graph.tolerance&&(n=this.getCellForPopupEvent(e),this.graph.isEnabled()&&this.selectOnPopup&&null!=n&&!this.graph.isCellSelected(n)?this.graph.setSelectionCell(n):this.clearSelectionOnBackground&&null==n&&this.graph.clearSelection(),this.graph.tooltipHandler.hide(),i=mxUtils.getScrollOrigin(),i=new mxPoint(e.getX()+i.x,e.getY()+i.y),this.popup(i.x+1,i.y+1,n,e.getEvent()),e.consume());this.popupTrigger=this.panningTrigger=!1},mxPanningHandler.prototype.scaleGraph=function(t,e){e?this.graph.view.getCanvas().setAttribute("transform","scale("+t+")"):(this.graph.view.getCanvas().removeAttribute("transform"),this.graph.view.setScale(this.graph.view.scale*t))},mxPanningHandler.prototype.getCellForPopupEvent=function(t){return t.getCell()},mxPanningHandler.prototype.panGraph=function(t,e){this.graph.getView().setTranslate(t,e)},mxPanningHandler.prototype.destroy=function(){this.graph.removeMouseListener(this),mxPopupMenu.prototype.destroy.apply(this)},mxUtils.extend(mxCellMarker,mxEventSource),mxCellMarker.prototype.graph=null,mxCellMarker.prototype.enabled=!0,mxCellMarker.prototype.hotspot=mxConstants.DEFAULT_HOTSPOT,mxCellMarker.prototype.hotspotEnabled=!1,mxCellMarker.prototype.validColor=null,mxCellMarker.prototype.invalidColor=null,mxCellMarker.prototype.currentColor=null,mxCellMarker.prototype.validState=null,mxCellMarker.prototype.markedState=null,mxCellMarker.prototype.setEnabled=function(t){this.enabled=t},mxCellMarker.prototype.isEnabled=function(){return this.enabled},mxCellMarker.prototype.setHotspot=function(t){this.hotspot=t},mxCellMarker.prototype.getHotspot=function(){return this.hotspot},mxCellMarker.prototype.setHotspotEnabled=function(t){this.hotspotEnabled=t},mxCellMarker.prototype.isHotspotEnabled=function(){return this.hotspotEnabled},mxCellMarker.prototype.hasValidState=function(){return null!=this.validState},mxCellMarker.prototype.getValidState=function(){return this.validState},mxCellMarker.prototype.getMarkedState=function(){return this.markedState},mxCellMarker.prototype.reset=function(){this.validState=null,null!=this.markedState&&(this.markedState=null,this.unmark())},mxCellMarker.prototype.process=function(t){var e=null;if(this.isEnabled()){var e=this.getState(t),n=null!=e?this.isValidState(e):!1;t=this.getMarkerColor(t.getEvent(),e,n),this.validState=n?e:null,(e!=this.markedState||t!=this.currentColor)&&(this.currentColor=t,null!=e&&null!=this.currentColor?(this.markedState=e,this.mark()):null!=this.markedState&&(this.markedState=null,this.unmark()))}return e},mxCellMarker.prototype.markCell=function(t,e){var n=this.graph.getView().getState(t);null!=n&&(this.currentColor=null!=e?e:this.validColor,this.markedState=n,this.mark())},mxCellMarker.prototype.mark=function(){this.highlight.setHighlightColor(this.currentColor),this.highlight.highlight(this.markedState),this.fireEvent(new mxEventObject(mxEvent.MARK,"state",this.markedState))},mxCellMarker.prototype.unmark=function(){this.mark()},mxCellMarker.prototype.isValidState=function(){return!0},mxCellMarker.prototype.getMarkerColor=function(t,e,n){return n?this.validColor:this.invalidColor},mxCellMarker.prototype.getState=function(t){var e=this.graph.getView();return cell=this.getCell(t),e=this.getStateToMark(e.getState(cell)),null!=e&&this.intersects(e,t)?e:null},mxCellMarker.prototype.getCell=function(t){return t.getCell()},mxCellMarker.prototype.getStateToMark=function(t){return t},mxCellMarker.prototype.intersects=function(t,e){return this.hotspotEnabled?mxUtils.intersectsHotspot(t,e.getGraphX(),e.getGraphY(),this.hotspot,mxConstants.MIN_HOTSPOT_SIZE,mxConstants.MAX_HOTSPOT_SIZE):!0},mxCellMarker.prototype.destroy=function(){this.graph.getView().removeListener(this.resetHandler),this.graph.getModel().removeListener(this.resetHandler),this.highlight.destroy()},mxUtils.extend(mxSelectionCellsHandler,mxEventSource),mxSelectionCellsHandler.prototype.graph=null,mxSelectionCellsHandler.prototype.enabled=!0,mxSelectionCellsHandler.prototype.refreshHandler=null,mxSelectionCellsHandler.prototype.maxHandlers=100,mxSelectionCellsHandler.prototype.handlers=null,mxSelectionCellsHandler.prototype.isEnabled=function(){return this.enabled},mxSelectionCellsHandler.prototype.setEnabled=function(t){this.enabled=t},mxSelectionCellsHandler.prototype.getHandler=function(t){return this.handlers.get(t)},mxSelectionCellsHandler.prototype.reset=function(){this.handlers.visit(function(t,e){e.reset.apply(e)})},mxSelectionCellsHandler.prototype.refresh=function(){var t=this.handlers;this.handlers=new mxDictionary;for(var e=this.graph.getSelectionCells(),n=0;n<e.length;n++){var i=this.graph.view.getState(e[n]);if(null!=i){var o=t.remove(e[n]);null!=o&&(o.state!=i?(o.destroy(),o=null):o.redraw()),null==o&&(o=this.graph.createHandler(i),this.fireEvent(new mxEventObject(mxEvent.ADD,"state",i))),null!=o&&this.handlers.put(e[n],o)}}t.visit(mxUtils.bind(this,function(t,e){this.fireEvent(new mxEventObject(mxEvent.REMOVE,"state",e.state)),e.destroy()}))},mxSelectionCellsHandler.prototype.mouseDown=function(t,e){if(this.graph.isEnabled()&&this.isEnabled()){var n=[t,e];this.handlers.visit(function(t,e){e.mouseDown.apply(e,n)})}},mxSelectionCellsHandler.prototype.mouseMove=function(t,e){if(this.graph.isEnabled()&&this.isEnabled()){var n=[t,e];this.handlers.visit(function(t,e){e.mouseMove.apply(e,n)})}},mxSelectionCellsHandler.prototype.mouseUp=function(t,e){if(this.graph.isEnabled()&&this.isEnabled()){var n=[t,e];this.handlers.visit(function(t,e){e.mouseUp.apply(e,n)})}},mxSelectionCellsHandler.prototype.destroy=function(){this.graph.removeMouseListener(this),null!=this.refreshHandler&&(this.graph.getSelectionModel().removeListener(this.refreshHandler),this.graph.getModel().removeListener(this.refreshHandler),this.graph.getView().removeListener(this.refreshHandler),this.refreshHandler=null)},mxUtils.extend(mxConnectionHandler,mxEventSource),mxConnectionHandler.prototype.graph=null,mxConnectionHandler.prototype.factoryMethod=!0,mxConnectionHandler.prototype.moveIconFront=!1,mxConnectionHandler.prototype.moveIconBack=!1,mxConnectionHandler.prototype.connectImage=null,mxConnectionHandler.prototype.targetConnectImage=!1,mxConnectionHandler.prototype.enabled=!0,mxConnectionHandler.prototype.select=!0,mxConnectionHandler.prototype.createTarget=!1,mxConnectionHandler.prototype.marker=null,mxConnectionHandler.prototype.constraintHandler=null,mxConnectionHandler.prototype.error=null,mxConnectionHandler.prototype.waypointsEnabled=!1,mxConnectionHandler.prototype.tapAndHoldEnabled=!0,mxConnectionHandler.prototype.tapAndHoldDelay=500,mxConnectionHandler.prototype.tapAndHoldInProgress=!1,mxConnectionHandler.prototype.tapAndHoldValid=!1,mxConnectionHandler.prototype.tapAndHoldTolerance=4,mxConnectionHandler.prototype.initialTouchX=0,mxConnectionHandler.prototype.initialTouchY=0,mxConnectionHandler.prototype.ignoreMouseDown=!1,mxConnectionHandler.prototype.first=null,mxConnectionHandler.prototype.connectIconOffset=new mxPoint(0,mxConstants.TOOLTIP_VERTICAL_OFFSET),mxConnectionHandler.prototype.edgeState=null,mxConnectionHandler.prototype.changeHandler=null,mxConnectionHandler.prototype.drillHandler=null,mxConnectionHandler.prototype.mouseDownCounter=0,mxConnectionHandler.prototype.movePreviewAway=mxClient.IS_VML,mxConnectionHandler.prototype.isEnabled=function(){return this.enabled},mxConnectionHandler.prototype.setEnabled=function(t){this.enabled=t},mxConnectionHandler.prototype.isCreateTarget=function(){return this.createTarget},mxConnectionHandler.prototype.setCreateTarget=function(t){this.createTarget=t},mxConnectionHandler.prototype.createShape=function(){var t=new mxPolyline([],mxConstants.INVALID_COLOR);if(t.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG,t.init(this.graph.getView().getOverlayPane()),t.svgStrokeTolerance=0,t.pointerEvents=!1,t.isDashed=!0,this.graph.dialect==mxConstants.DIALECT_SVG)t.node.setAttribute("pointer-events","none");else{var e=mxUtils.bind(this,function(t){return t=mxUtils.convertPoint(this.graph.container,mxEvent.getClientX(t),mxEvent.getClientY(t)),this.graph.view.getState(this.graph.getCellAt(t.x,t.y))});mxEvent.redirectMouseEvents(t.node,this.graph,e)}return t},mxConnectionHandler.prototype.init=function(){this.graph.addMouseListener(this),this.marker=this.createMarker(),this.constraintHandler=new mxConstraintHandler(this.graph),this.changeHandler=mxUtils.bind(this,function(){null!=this.iconState&&(this.iconState=this.graph.getView().getState(this.iconState.cell)),null!=this.iconState?(this.redrawIcons(this.icons,this.iconState),this.constraintHandler.reset()):this.reset()}),this.graph.getModel().addListener(mxEvent.CHANGE,this.changeHandler),this.graph.getView().addListener(mxEvent.SCALE,this.changeHandler),this.graph.getView().addListener(mxEvent.TRANSLATE,this.changeHandler),this.graph.getView().addListener(mxEvent.SCALE_AND_TRANSLATE,this.changeHandler),this.drillHandler=mxUtils.bind(this,function(){this.reset()}),this.graph.addListener(mxEvent.START_EDITING,this.drillHandler),this.graph.getView().addListener(mxEvent.DOWN,this.drillHandler),this.graph.getView().addListener(mxEvent.UP,this.drillHandler)},mxConnectionHandler.prototype.isConnectableCell=function(){return!0},mxConnectionHandler.prototype.createMarker=function(){var t=new mxCellMarker(this.graph);return t.hotspotEnabled=!0,t.getCell=mxUtils.bind(this,function(e,n){return n=mxCellMarker.prototype.getCell.apply(t,arguments),this.error=null,this.isConnectableCell(n)?(null!=n?this.isConnecting()?null!=this.previous&&(this.error=this.validateConnection(this.previous.cell,n),null!=this.error&&0==this.error.length&&(n=null,this.isCreateTarget()&&(this.error=null))):this.isValidSource(n)||(n=null):this.isConnecting()&&!this.isCreateTarget()&&!this.graph.allowDanglingEdges&&(this.error=""),n):null}),t.isValidState=mxUtils.bind(this,function(){return this.isConnecting()?null==this.error:mxCellMarker.prototype.isValidState.apply(t,arguments)}),t.getMarkerColor=mxUtils.bind(this,function(){return null==this.connectImage||this.isConnecting()?mxCellMarker.prototype.getMarkerColor.apply(t,arguments):null}),t.intersects=mxUtils.bind(this,function(){return null!=this.connectImage||this.isConnecting()?!0:mxCellMarker.prototype.intersects.apply(t,arguments)}),t},mxConnectionHandler.prototype.start=function(t,e,n,i){this.previous=t,this.first=new mxPoint(e,n),this.edgeState=null!=i?i:this.createEdgeState(null),this.marker.currentColor=this.marker.validColor,this.marker.markedState=t,this.marker.mark(),this.fireEvent(new mxEventObject(mxEvent.START,"state",this.previous))},mxConnectionHandler.prototype.isConnecting=function(){return null!=this.first&&null!=this.shape},mxConnectionHandler.prototype.isValidSource=function(t){return this.graph.isValidSource(t)},mxConnectionHandler.prototype.isValidTarget=function(){return!0},mxConnectionHandler.prototype.validateConnection=function(t,e){return this.isValidTarget(e)?this.graph.getEdgeValidationError(null,t,e):""},mxConnectionHandler.prototype.getConnectImage=function(){return this.connectImage},mxConnectionHandler.prototype.isMoveIconToFrontForState=function(t){return null!=t.text&&t.text.node.parentNode==this.graph.container?!0:this.moveIconFront},mxConnectionHandler.prototype.createIcons=function(t){var e=this.getConnectImage(t);if(null!=e&&null!=t){this.iconState=t;var n=[],i=new mxRectangle(0,0,e.width,e.height),o=new mxImageShape(i,e.src,null,null,0);o.preserveImageAspect=!1,this.isMoveIconToFrontForState(t)?(o.dialect=mxConstants.DIALECT_STRICTHTML,o.init(this.graph.container)):(o.dialect=this.graph.dialect==mxConstants.DIALECT_SVG?mxConstants.DIALECT_SVG:mxConstants.DIALECT_VML,o.init(this.graph.getView().getOverlayPane()),this.moveIconBack&&null!=o.node.previousSibling&&o.node.parentNode.insertBefore(o.node,o.node.parentNode.firstChild)),o.node.style.cursor=mxConstants.CURSOR_CONNECT;var r=mxUtils.bind(this,function(){return null!=this.currentState?this.currentState:t
}),e=mxUtils.bind(this,function(t){mxEvent.isConsumed(t)||(this.icon=o,this.graph.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(t,r())))});return mxEvent.redirectMouseEvents(o.node,this.graph,r,e),n.push(o),this.redrawIcons(n,this.iconState),n}return null},mxConnectionHandler.prototype.redrawIcons=function(t,e){if(null!=t&&null!=t[0]&&null!=e){var n=this.getIconPosition(t[0],e);t[0].bounds.x=n.x,t[0].bounds.y=n.y,t[0].redraw()}},mxConnectionHandler.prototype.getIconPosition=function(t,e){var n=this.graph.getView().scale,i=e.getCenterX(),o=e.getCenterY();if(this.graph.isSwimlane(e.cell)){var r=this.graph.getStartSize(e.cell),i=0!=r.width?e.x+r.width*n/2:i,o=0!=r.height?e.y+r.height*n/2:o,r=mxUtils.toRadians(mxUtils.getValue(e.style,mxConstants.STYLE_ROTATION)||0);if(0!=r)var n=Math.cos(r),r=Math.sin(r),s=new mxPoint(e.getCenterX(),e.getCenterY()),o=mxUtils.getRotatedPoint(new mxPoint(i,o),n,r,s),i=o.x,o=o.y}return new mxPoint(i-t.bounds.width/2,o-t.bounds.height/2)},mxConnectionHandler.prototype.destroyIcons=function(){if(null!=this.icons){for(var t=0;t<this.icons.length;t++)this.icons[t].destroy();this.iconState=this.selectedIcon=this.icon=this.icons=null}},mxConnectionHandler.prototype.isStartEvent=function(t){return!this.graph.isForceMarqueeEvent(t.getEvent())&&(null!=this.constraintHandler.currentFocus&&null!=this.constraintHandler.currentConstraint||null!=this.previous&&null==this.error&&(null==this.icons||null!=this.icons&&null!=this.icon))},mxConnectionHandler.prototype.mouseDown=function(t,e){if(this.mouseDownCounter++,this.isEnabled()&&this.graph.isEnabled()&&!e.isConsumed()&&!this.isConnecting()&&this.isStartEvent(e)){if(null!=this.constraintHandler.currentConstraint&&null!=this.constraintHandler.currentFocus&&null!=this.constraintHandler.currentPoint?(this.sourceConstraint=this.constraintHandler.currentConstraint,this.previous=this.constraintHandler.currentFocus,this.first=this.constraintHandler.currentPoint.clone()):this.first=new mxPoint(e.getGraphX(),e.getGraphY()),this.edgeState=this.createEdgeState(e),this.mouseDownCounter=1,this.waypointsEnabled&&null==this.shape&&(this.waypoints=null,this.shape=this.createShape()),null==this.previous&&null!=this.edgeState){var n=this.graph.getPointForEvent(e.getEvent());this.edgeState.cell.geometry.setTerminalPoint(n,!0)}this.fireEvent(new mxEventObject(mxEvent.START,"state",this.previous)),e.consume()}else if(mxClient.IS_TOUCH&&this.tapAndHoldEnabled&&!this.tapAndHoldInProgress&&this.isEnabled()&&this.graph.isEnabled()&&!this.isConnecting()){this.tapAndHoldInProgress=!0,this.initialTouchX=e.getX(),this.initialTouchY=e.getY();var i=this.graph.view.getState(this.marker.getCell(e));this.tapAndHoldThread&&window.clearTimeout(this.tapAndHoldThread),this.tapAndHoldThread=window.setTimeout(mxUtils.bind(this,function(){this.tapAndHoldValid&&this.tapAndHold(e,i),this.tapAndHoldValid=this.tapAndHoldInProgress=!1}),this.tapAndHoldDelay),this.tapAndHoldValid=!0}this.selectedIcon=this.icon,this.icon=null},mxConnectionHandler.prototype.tapAndHold=function(t,e){null!=e&&(this.marker.currentColor=this.marker.validColor,this.marker.markedState=e,this.marker.mark(),this.first=new mxPoint(t.getGraphX(),t.getGraphY()),this.edgeState=this.createEdgeState(t),this.previous=e,this.fireEvent(new mxEventObject(mxEvent.START,"state",this.previous)))},mxConnectionHandler.prototype.isImmediateConnectSource=function(t){return!this.graph.isCellMovable(t.cell)},mxConnectionHandler.prototype.createEdgeState=function(){return null},mxConnectionHandler.prototype.updateCurrentState=function(t){var e=this.marker.process(t);this.constraintHandler.update(t,null==this.first),this.currentState=e},mxConnectionHandler.prototype.convertWaypoint=function(t){var e=this.graph.getView().getScale(),n=this.graph.getView().getTranslate();t.x=t.x/e-n.x,t.y=t.y/e-n.y},mxConnectionHandler.prototype.mouseMove=function(t,e){if(this.tapAndHoldValid&&(this.tapAndHoldValid=Math.abs(this.initialTouchX-e.getX())<this.tapAndHoldTolerance&&Math.abs(this.initialTouchY-e.getY())<this.tapAndHoldTolerance),e.isConsumed()||!this.ignoreMouseDown&&null==this.first&&this.graph.isMouseDown)this.constraintHandler.reset();else{if(!this.isEnabled()&&null!=this.currentState&&(this.destroyIcons(),this.currentState=null),(null!=this.first||this.isEnabled()&&this.graph.isEnabled())&&this.updateCurrentState(e),null!=this.first){var n=this.graph.getView().scale,n=new mxPoint(this.graph.snap(e.getGraphX()/n)*n,this.graph.snap(e.getGraphY()/n)*n),i=null,o=n;null!=this.constraintHandler.currentConstraint&&null!=this.constraintHandler.currentFocus&&null!=this.constraintHandler.currentPoint&&(i=this.constraintHandler.currentConstraint,o=this.constraintHandler.currentPoint.clone());var r=this.first;if(null!=this.selectedIcon){var s=this.selectedIcon.bounds.width,l=this.selectedIcon.bounds.height;null!=this.currentState&&this.targetConnectImage?(s=this.getIconPosition(this.selectedIcon,this.currentState),this.selectedIcon.bounds.x=s.x,this.selectedIcon.bounds.y=s.y):(s=new mxRectangle(e.getGraphX()+this.connectIconOffset.x,e.getGraphY()+this.connectIconOffset.y,s,l),this.selectedIcon.bounds=s),this.selectedIcon.redraw()}if(null!=this.edgeState){if(this.edgeState.absolutePoints=[null,null!=this.currentState?null:o],this.graph.view.updateFixedTerminalPoint(this.edgeState,this.previous,!0,this.sourceConstraint),null!=this.currentState&&(null==i&&(i=this.graph.getConnectionConstraint(this.edgeState,this.previous,!1)),this.edgeState.setAbsoluteTerminalPoint(null,!1),this.graph.view.updateFixedTerminalPoint(this.edgeState,this.currentState,!1,i)),r=null,null!=this.waypoints)for(r=[],o=0;o<this.waypoints.length;o++)i=this.waypoints[o].clone(),this.convertWaypoint(i),r[o]=i;this.graph.view.updatePoints(this.edgeState,r,this.previous,this.currentState),this.graph.view.updateFloatingTerminalPoints(this.edgeState,this.previous,this.currentState),o=this.edgeState.absolutePoints[this.edgeState.absolutePoints.length-1],r=this.edgeState.absolutePoints[0]}else null!=this.currentState&&null==this.constraintHandler.currentConstraint&&(s=this.getTargetPerimeterPoint(this.currentState,e),null!=s&&(o=s)),null==this.sourceConstraint&&null!=this.previous&&(s=this.getSourcePerimeterPoint(this.previous,null!=this.waypoints&&0<this.waypoints.length?this.waypoints[0]:o,e),null!=s&&(r=s));if(null==this.currentState&&this.movePreviewAway){if(s=r,null!=this.edgeState&&2<this.edgeState.absolutePoints.length&&(i=this.edgeState.absolutePoints[this.edgeState.absolutePoints.length-2],null!=i&&(s=i)),i=o.x-s.x,s=o.y-s.y,l=Math.sqrt(i*i+s*s),0==l)return;o.x-=4*i/l,o.y-=4*s/l}null==this.shape&&(i=Math.abs(n.x-this.first.x),s=Math.abs(n.y-this.first.y),i>this.graph.tolerance||s>this.graph.tolerance)&&(this.shape=this.createShape(),this.updateCurrentState(e)),null!=this.shape&&(null!=this.edgeState?this.shape.points=this.edgeState.absolutePoints:(n=[r],null!=this.waypoints&&(n=n.concat(this.waypoints)),n.push(o),this.shape.points=n),this.drawPreview()),mxEvent.consume(e.getEvent()),e.consume()}else this.isEnabled()&&this.graph.isEnabled()?this.previous!=this.currentState&&null==this.edgeState?(this.destroyIcons(),null!=this.currentState&&null==this.error&&(this.icons=this.createIcons(this.currentState),null==this.icons&&(this.currentState.setCursor(mxConstants.CURSOR_CONNECT),e.consume())),this.previous=this.currentState):this.previous==this.currentState&&null!=this.currentState&&null==this.icons&&!this.graph.isMouseDown&&e.consume():this.constraintHandler.reset();if(null!=this.constraintHandler.currentConstraint&&this.marker.reset(),!this.graph.isMouseDown&&null!=this.currentState&&null!=this.icons){for(n=!1,r=e.getSource(),o=0;o<this.icons.length&&!n;o++)n=r==this.icons[o].node||r.parentNode==this.icons[o].node;n||this.updateIcons(this.currentState,this.icons,e)}}},mxConnectionHandler.prototype.getTargetPerimeterPoint=function(t){var e=null,n=t.view,i=n.getPerimeterFunction(t);if(null!=i){var o=null!=this.waypoints&&0<this.waypoints.length?this.waypoints[this.waypoints.length-1]:new mxPoint(this.previous.getCenterX(),this.previous.getCenterY()),n=i(n.getPerimeterBounds(t),this.edgeState,o,!1);null!=n&&(e=n)}else e=new mxPoint(t.getCenterX(),t.getCenterY());return e},mxConnectionHandler.prototype.getSourcePerimeterPoint=function(t,e,n){n=null;var i=t.view,o=i.getPerimeterFunction(t),r=new mxPoint(t.getCenterX(),t.getCenterY());if(null!=o){var s=mxUtils.getValue(t.style,mxConstants.STYLE_ROTATION,0),l=-s*(Math.PI/180);0!=s&&(e=mxUtils.getRotatedPoint(new mxPoint(e.x,e.y),Math.cos(l),Math.sin(l),r)),t=o(i.getPerimeterBounds(t),t,e,!1),null!=t&&(0!=s&&(t=mxUtils.getRotatedPoint(new mxPoint(t.x,t.y),Math.cos(-l),Math.sin(-l),r)),n=t)}else n=r;return n},mxConnectionHandler.prototype.updateIcons=function(){},mxConnectionHandler.prototype.isStopEvent=function(t){return null!=t.getState()},mxConnectionHandler.prototype.addWaypointForEvent=function(t){var e=mxUtils.convertPoint(this.graph.container,t.getX(),t.getY()),n=Math.abs(e.x-this.first.x),e=Math.abs(e.y-this.first.y);(null!=this.waypoints||1<this.mouseDownCounter&&(n>this.graph.tolerance||e>this.graph.tolerance))&&(null==this.waypoints&&(this.waypoints=[]),n=this.graph.view.scale,e=new mxPoint(this.graph.snap(t.getGraphX()/n)*n,this.graph.snap(t.getGraphY()/n)*n),this.waypoints.push(e))},mxConnectionHandler.prototype.mouseUp=function(t,e){if(!e.isConsumed()&&this.isConnecting()){if(this.waypointsEnabled&&!this.isStopEvent(e))return this.addWaypointForEvent(e),e.consume(),void 0;if(null==this.error){var n=null!=this.previous?this.previous.cell:null,i=null;null!=this.constraintHandler.currentConstraint&&null!=this.constraintHandler.currentFocus&&(i=this.constraintHandler.currentFocus.cell),null==i&&this.marker.hasValidState()&&(i=this.marker.validState.cell),this.connect(n,i,e.getEvent(),e.getCell())}else null!=this.previous&&null!=this.marker.validState&&this.previous.cell==this.marker.validState.cell&&this.graph.selectCellForEvent(this.marker.source,evt),0<this.error.length&&this.graph.validationAlert(this.error);this.destroyIcons(),e.consume()}null!=this.first&&this.reset(),this.tapAndHoldValid=this.tapAndHoldInProgress=!1},mxConnectionHandler.prototype.reset=function(){null!=this.shape&&(this.shape.destroy(),this.shape=null),this.destroyIcons(),this.marker.reset(),this.constraintHandler.reset(),this.sourceConstraint=this.error=this.previous=this.edgeState=null,this.mouseDownCounter=0,this.first=null,this.fireEvent(new mxEventObject(mxEvent.RESET))},mxConnectionHandler.prototype.drawPreview=function(){var t=null==this.error;this.shape.strokewidth=this.getEdgeWidth(t),t=this.getEdgeColor(t),this.shape.stroke=t,this.shape.redraw()},mxConnectionHandler.prototype.getEdgeColor=function(t){return t?mxConstants.VALID_COLOR:mxConstants.INVALID_COLOR},mxConnectionHandler.prototype.getEdgeWidth=function(t){return t?3:1},mxConnectionHandler.prototype.connect=function(t,e,n,i){if(null!=e||this.isCreateTarget()||this.graph.allowDanglingEdges){var o=this.graph.getModel(),r=null;o.beginUpdate();try{if(null!=t&&null==e&&this.isCreateTarget()&&(e=this.createTargetVertex(n,t),null!=e)){if(i=this.graph.getDropTarget([e],n,i),null!=i&&this.graph.getModel().isEdge(i))i=this.graph.getDefaultParent();else{var s=this.graph.getView().getState(i);if(null!=s){var l=o.getGeometry(e);l.x-=s.origin.x,l.y-=s.origin.y}}this.graph.addCell(e,i)}var a=this.graph.getDefaultParent();if(null!=t&&null!=e&&o.getParent(t)==o.getParent(e)&&o.getParent(o.getParent(t))!=o.getRoot()&&(a=o.getParent(t),null!=t.geometry&&t.geometry.relative&&null!=e.geometry&&e.geometry.relative&&(a=o.getParent(a))),l=s=null,null!=this.edgeState&&(s=this.edgeState.cell.value,l=this.edgeState.cell.style),r=this.insertEdge(a,null,s,t,e,l),null!=r){this.graph.setConnectionConstraint(r,t,!0,this.sourceConstraint),this.graph.setConnectionConstraint(r,e,!1,this.constraintHandler.currentConstraint),null!=this.edgeState&&o.setGeometry(r,this.edgeState.cell.geometry);var h=o.getGeometry(r);if(null==h&&(h=new mxGeometry,h.relative=!0,o.setGeometry(r,h)),null!=this.waypoints&&0<this.waypoints.length){var d=this.graph.view.scale,u=this.graph.view.translate;for(h.points=[],t=0;t<this.waypoints.length;t++){var c=this.waypoints[t];h.points.push(new mxPoint(c.x/d-u.x,c.y/d-u.y))}}null==e&&(c=this.graph.getPointForEvent(n,!1),c.x-=this.graph.panDx/this.graph.view.scale,c.y-=this.graph.panDy/this.graph.view.scale,h.setTerminalPoint(c,!1)),this.fireEvent(new mxEventObject(mxEvent.CONNECT,"cell",r,"event",n,"target",i))}}catch(p){mxLog.show(),mxLog.debug(p.message)}finally{o.endUpdate()}this.select&&this.selectCells(r,e)}},mxConnectionHandler.prototype.selectCells=function(t){this.graph.setSelectionCell(t)},mxConnectionHandler.prototype.insertEdge=function(t,e,n,i,o,r){return null==this.factoryMethod?this.graph.insertEdge(t,e,n,i,o,r):(e=this.createEdge(n,i,o,r),e=this.graph.addEdge(e,t,i,o))},mxConnectionHandler.prototype.createTargetVertex=function(t,e){for(var n=this.graph.getCellGeometry(e);null!=n&&n.relative;)e=this.graph.getModel().getParent(e),n=this.graph.getCellGeometry(e);var i=this.graph.cloneCells([e])[0],n=this.graph.getModel().getGeometry(i);if(null!=n){var o=this.graph.getPointForEvent(t);if(n.x=this.graph.snap(o.x-n.width/2)-this.graph.panDx/this.graph.view.scale,n.y=this.graph.snap(o.y-n.height/2)-this.graph.panDy/this.graph.view.scale,null!=this.first){var r=this.graph.view.getState(e);if(null!=r){var s=this.getAlignmentTolerance();Math.abs(this.graph.snap(this.first.x)-this.graph.snap(o.x))<=s?n.x=r.x:Math.abs(this.graph.snap(this.first.y)-this.graph.snap(o.y))<=s&&(n.y=r.y)}}}return i},mxConnectionHandler.prototype.getAlignmentTolerance=function(){return this.graph.isGridEnabled()?this.graph.gridSize:this.graph.tolerance},mxConnectionHandler.prototype.createEdge=function(t,e,n,i){var o=null;return null!=this.factoryMethod&&(o=this.factoryMethod(e,n,i)),null==o&&(o=new mxCell(t||""),o.setEdge(!0),o.setStyle(i),t=new mxGeometry,t.relative=!0,o.setGeometry(t)),o},mxConnectionHandler.prototype.destroy=function(){this.graph.removeMouseListener(this),null!=this.shape&&(this.shape.destroy(),this.shape=null),null!=this.marker&&(this.marker.destroy(),this.marker=null),null!=this.constraintHandler&&(this.constraintHandler.destroy(),this.constraintHandler=null),null!=this.changeHandler&&(this.graph.getModel().removeListener(this.changeHandler),this.graph.getView().removeListener(this.changeHandler),this.changeHandler=null),null!=this.drillHandler&&(this.graph.removeListener(this.drillHandler),this.graph.getView().removeListener(this.drillHandler),this.drillHandler=null)},mxConstraintHandler.prototype.pointImage=new mxImage(mxClient.imageBasePath+"/point.gif",5,5),mxConstraintHandler.prototype.graph=null,mxConstraintHandler.prototype.enabled=!0,mxConstraintHandler.prototype.highlightColor=mxConstants.DEFAULT_VALID_COLOR,mxConstraintHandler.prototype.isEnabled=function(){return this.enabled},mxConstraintHandler.prototype.setEnabled=function(t){this.enabled=t},mxConstraintHandler.prototype.reset=function(){if(null!=this.focusIcons){for(var t=0;t<this.focusIcons.length;t++)this.focusIcons[t].destroy();this.focusIcons=null}null!=this.focusHighlight&&(this.focusHighlight.destroy(),this.focusHighlight=null),this.focusPoints=this.currentFocus=this.currentPoint=this.currentFocusArea=this.currentConstraint=null},mxConstraintHandler.prototype.getTolerance=function(){return this.graph.getTolerance()},mxConstraintHandler.prototype.getImageForConstraint=function(){return this.pointImage},mxConstraintHandler.prototype.isEventIgnored=function(){return!1},mxConstraintHandler.prototype.isStateIgnored=function(){return!1},mxConstraintHandler.prototype.destroyIcons=function(){if(null!=this.focusIcons){for(var t=0;t<this.focusIcons.length;t++)this.focusIcons[t].destroy();this.focusPoints=this.focusIcons=null}},mxConstraintHandler.prototype.destroyFocusHighlight=function(){null!=this.focusHighlight&&(this.focusHighlight.destroy(),this.focusHighlight=null)},mxConstraintHandler.prototype.update=function(t,e){if(this.isEnabled()&&!this.isEventIgnored(t)){var n=this.getTolerance(),i=new mxRectangle(t.getGraphX()-n,t.getGraphY()-n,2*n,2*n),o=null!=t.getCell()?this.graph.isCellConnectable(t.getCell()):!1;if((null==this.currentFocusArea||!mxUtils.intersects(this.currentFocusArea,i)||null!=t.getState()&&null!=this.currentFocus&&o)&&(this.currentFocusArea=null,t.getState()!=this.currentFocus))if(this.currentFocus=null,this.constraints=null!=t.getState()&&o&&!this.isStateIgnored(t.getState(),e)?this.graph.getAllConnectionConstraints(t.getState(),e):null,null!=this.constraints){if(this.currentFocus=t.getState(),this.currentFocusArea=new mxRectangle(t.getState().x,t.getState().y,t.getState().width,t.getState().height),null!=this.focusIcons){for(o=0;o<this.focusIcons.length;o++)this.focusIcons[o].destroy();this.focusPoints=this.focusIcons=null}for(this.focusIcons=[],this.focusPoints=[],o=0;o<this.constraints.length;o++){var r=this.graph.getConnectionPoint(t.getState(),this.constraints[o]),s=this.getImageForConstraint(t.getState(),this.constraints[o],r),l=s.src,s=new mxRectangle(r.x-s.width/2,r.y-s.height/2,s.width,s.height),s=new mxImageShape(s,l);s.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_MIXEDHTML:mxConstants.DIALECT_SVG,s.preserveImageAspect=!1,s.init(this.graph.getView().getOverlayPane()),null!=s.node.previousSibling&&s.node.parentNode.insertBefore(s.node,s.node.parentNode.firstChild),l=mxUtils.bind(this,function(){return null!=this.currentFocus?this.currentFocus:t.getState()}),s.redraw(),mxEvent.redirectMouseEvents(s.node,this.graph,l),this.currentFocusArea.add(s.bounds),this.focusIcons.push(s),this.focusPoints.push(r)}this.currentFocusArea.grow(n)}else this.destroyIcons(),this.destroyFocusHighlight();if(this.currentPoint=this.currentConstraint=null,null!=this.focusIcons&&null!=this.constraints&&(null==t.getState()||this.currentFocus==t.getState()))for(o=0;o<this.focusIcons.length;o++)if(mxUtils.intersects(this.focusIcons[o].bounds,i)){this.currentConstraint=this.constraints[o],this.currentPoint=this.focusPoints[o],n=this.focusIcons[o].bounds.clone(),n.grow(mxClient.IS_IE?3:2),mxClient.IS_IE&&(n.width-=1,n.height-=1),null==this.focusHighlight?(n=new mxRectangleShape(n,null,this.highlightColor,3),n.dialect=this.graph.dialect==mxConstants.DIALECT_SVG?mxConstants.DIALECT_SVG:mxConstants.DIALECT_VML,n.init(this.graph.getView().getOverlayPane()),this.focusHighlight=n,l=mxUtils.bind(this,function(){return null!=this.currentFocus?this.currentFocus:t.getState()}),mxEvent.redirectMouseEvents(n.node,this.graph,l)):(this.focusHighlight.bounds=n,this.focusHighlight.redraw());break}null==this.currentConstraint&&this.destroyFocusHighlight()}},mxConstraintHandler.prototype.destroy=function(){this.reset()},mxRubberband.prototype.defaultOpacity=20,mxRubberband.prototype.enabled=!0,mxRubberband.prototype.div=null,mxRubberband.prototype.sharedDiv=null,mxRubberband.prototype.currentX=0,mxRubberband.prototype.currentY=0,mxRubberband.prototype.isEnabled=function(){return this.enabled},mxRubberband.prototype.setEnabled=function(t){this.enabled=t},mxRubberband.prototype.mouseDown=function(t,e){if(!e.isConsumed()&&this.isEnabled()&&this.graph.isEnabled()&&(this.graph.isForceMarqueeEvent(e.getEvent())||null==e.getState())){var n=mxUtils.getOffset(this.graph.container),i=mxUtils.getScrollOrigin(this.graph.container);if(i.x-=n.x,i.y-=n.y,this.start(e.getX()+i.x,e.getY()+i.y),mxClient.IS_NS&&!mxClient.IS_SF&&!mxClient.IS_GC){var o=this.graph.container,r=function(t){t=new mxMouseEvent(t);var e=mxUtils.convertPoint(o,t.getX(),t.getY());return t.graphX=e.x,t.graphY=e.y,t};this.dragHandler=mxUtils.bind(this,function(t){this.mouseMove(this.graph,r(t))}),this.dropHandler=mxUtils.bind(this,function(t){this.mouseUp(this.graph,r(t))}),mxEvent.addListener(document,"mousemove",this.dragHandler),mxEvent.addListener(document,"mouseup",this.dropHandler)}e.consume(!1)}},mxRubberband.prototype.start=function(t,e){this.first=new mxPoint(t,e)},mxRubberband.prototype.mouseMove=function(t,e){if(!e.isConsumed()&&null!=this.first){var n=mxUtils.getScrollOrigin(this.graph.container),i=mxUtils.getOffset(this.graph.container);n.x-=i.x,n.y-=i.y;var i=e.getX()+n.x,n=e.getY()+n.y,o=this.first.x-i,r=this.first.y-n,s=this.graph.tolerance;(null!=this.div||Math.abs(o)>s||Math.abs(r)>s)&&(null==this.div&&(this.div=this.createShape()),mxUtils.clearSelection(),this.update(i,n),e.consume())}},mxRubberband.prototype.createShape=function(){return null==this.sharedDiv&&(this.sharedDiv=document.createElement("div"),this.sharedDiv.className="mxRubberband",mxUtils.setOpacity(this.sharedDiv,this.defaultOpacity)),this.graph.container.appendChild(this.sharedDiv),this.sharedDiv},mxRubberband.prototype.mouseUp=function(t,e){var n=null!=this.div;this.reset(),n&&(n=new mxRectangle(this.x,this.y,this.width,this.height),this.graph.selectRegion(n,e.getEvent()),e.consume())},mxRubberband.prototype.reset=function(){null!=this.div&&this.div.parentNode.removeChild(this.div),null!=this.dragHandler&&(mxEvent.removeListener(document,"mousemove",this.dragHandler),this.dragHandler=null),null!=this.dropHandler&&(mxEvent.removeListener(document,"mouseup",this.dropHandler),this.dropHandler=null),this.currentY=this.currentX=0,this.div=this.first=null},mxRubberband.prototype.update=function(t,e){this.currentX=t,this.currentY=e,this.repaint()},mxRubberband.prototype.repaint=function(){if(null!=this.div){var t=this.currentX-this.graph.panDx,e=this.currentY-this.graph.panDy;this.x=Math.min(this.first.x,t),this.y=Math.min(this.first.y,e),this.width=Math.max(this.first.x,t)-this.x,this.height=Math.max(this.first.y,e)-this.y,t=mxClient.IS_VML?this.graph.panDy:0,this.div.style.left=this.x+(mxClient.IS_VML?this.graph.panDx:0)+"px",this.div.style.top=this.y+t+"px",this.div.style.width=Math.max(1,this.width)+"px",this.div.style.height=Math.max(1,this.height)+"px"}},mxRubberband.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.graph.removeMouseListener(this),this.graph.removeListener(this.panHandler),this.reset(),null!=this.sharedDiv&&(this.sharedDiv=null))},mxVertexHandler.prototype.graph=null,mxVertexHandler.prototype.state=null,mxVertexHandler.prototype.singleSizer=!1,mxVertexHandler.prototype.index=null,mxVertexHandler.prototype.allowHandleBoundsCheck=!0,mxVertexHandler.prototype.handleImage=null,mxVertexHandler.prototype.tolerance=0,mxVertexHandler.prototype.rotationEnabled=!1,mxVertexHandler.prototype.rotationRaster=!0,mxVertexHandler.prototype.livePreview=!1,mxVertexHandler.prototype.init=function(){if(this.graph=this.state.view.graph,this.selectionBounds=this.getSelectionBounds(this.state),this.bounds=new mxRectangle(this.selectionBounds.x,this.selectionBounds.y,this.selectionBounds.width,this.selectionBounds.height),this.selectionBorder=this.createSelectionShape(this.bounds),this.selectionBorder.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG,this.selectionBorder.pointerEvents=!1,this.selectionBorder.init(this.graph.getView().getOverlayPane()),this.graph.isCellMovable(this.state.cell)&&(this.selectionBorder.node.style.cursor=mxConstants.CURSOR_MOVABLE_VERTEX),mxEvent.redirectMouseEvents(this.selectionBorder.node,this.graph,this.state),0>=mxGraphHandler.prototype.maxCells||this.graph.getSelectionCount()<mxGraphHandler.prototype.maxCells){var t=this.graph.isCellResizable(this.state.cell);if(this.sizers=[],t||this.graph.isLabelMovable(this.state.cell)&&2<=this.state.width&&2<=this.state.height){var e=0;t&&(this.singleSizer||(this.sizers.push(this.createSizer("nw-resize",e++)),this.sizers.push(this.createSizer("n-resize",e++)),this.sizers.push(this.createSizer("ne-resize",e++)),this.sizers.push(this.createSizer("w-resize",e++)),this.sizers.push(this.createSizer("e-resize",e++)),this.sizers.push(this.createSizer("sw-resize",e++)),this.sizers.push(this.createSizer("s-resize",e++))),this.sizers.push(this.createSizer("se-resize",e++))),t=this.graph.model.getGeometry(this.state.cell),null!=t&&!t.relative&&!this.graph.isSwimlane(this.state.cell)&&this.graph.isLabelMovable(this.state.cell)&&(this.labelShape=this.createSizer(mxConstants.CURSOR_LABEL_HANDLE,mxEvent.LABEL_HANDLE,mxConstants.LABEL_HANDLE_SIZE,mxConstants.LABEL_HANDLE_FILLCOLOR),this.sizers.push(this.labelShape))}else this.graph.isCellMovable(this.state.cell)&&!this.graph.isCellResizable(this.state.cell)&&2>this.state.width&&2>this.state.height&&(this.labelShape=this.createSizer(mxConstants.CURSOR_MOVABLE_VERTEX,null,null,mxConstants.LABEL_HANDLE_FILLCOLOR),this.sizers.push(this.labelShape))}this.rotationEnabled&&this.graph.isCellRotatable(this.state.cell)&&(0>=mxGraphHandler.prototype.maxCells||this.graph.getSelectionCount()<mxGraphHandler.prototype.maxCells)&&(this.rotationShape=this.createSizer("pointer",mxEvent.ROTATION_HANDLE,mxConstants.HANDLE_SIZE+3,mxConstants.HANDLE_FILLCOLOR),this.sizers.push(this.rotationShape)),this.redraw()},mxVertexHandler.prototype.getSelectionBounds=function(t){return new mxRectangle(Math.round(t.x),Math.round(t.y),Math.round(t.width),Math.round(t.height))},mxVertexHandler.prototype.createSelectionShape=function(t){return t=new mxRectangleShape(t,null,this.getSelectionColor()),t.strokewidth=this.getSelectionStrokeWidth(),t.isDashed=this.isSelectionDashed(),t},mxVertexHandler.prototype.getSelectionColor=function(){return mxConstants.VERTEX_SELECTION_COLOR},mxVertexHandler.prototype.getSelectionStrokeWidth=function(){return mxConstants.VERTEX_SELECTION_STROKEWIDTH},mxVertexHandler.prototype.isSelectionDashed=function(){return mxConstants.VERTEX_SELECTION_DASHED},mxVertexHandler.prototype.createSizer=function(t,e,n,i){return n=n||mxConstants.HANDLE_SIZE,n=new mxRectangle(0,0,n,n),i=this.createSizerShape(n,e,i),i.isHtmlAllowed()&&null!=this.state.text&&this.state.text.node.parentNode==this.graph.container?(i.bounds.height-=1,i.bounds.width-=1,i.dialect=mxConstants.DIALECT_STRICTHTML,i.init(this.graph.container)):(i.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_MIXEDHTML:mxConstants.DIALECT_SVG,i.init(this.graph.getView().getOverlayPane())),mxEvent.redirectMouseEvents(i.node,this.graph,this.state),this.graph.isEnabled()&&(i.node.style.cursor=t),this.isSizerVisible(e)||(i.node.style.visibility="hidden"),i},mxVertexHandler.prototype.isSizerVisible=function(){return!0},mxVertexHandler.prototype.createSizerShape=function(t,e,n){return null!=this.handleImage?(t.width=this.handleImage.width,t.height=this.handleImage.height,new mxImageShape(t,this.handleImage.src)):e==mxEvent.ROTATION_HANDLE?new mxEllipse(t,n||mxConstants.HANDLE_FILLCOLOR,mxConstants.HANDLE_STROKECOLOR):new mxRectangleShape(t,n||mxConstants.HANDLE_FILLCOLOR,mxConstants.HANDLE_STROKECOLOR)},mxVertexHandler.prototype.moveSizerTo=function(t,e,n){null!=t&&(t.bounds.x=Math.round(e-t.bounds.width/2),t.bounds.y=Math.round(n-t.bounds.height/2),t.redraw())},mxVertexHandler.prototype.getHandleForEvent=function(t){if(t.isSource(this.rotationShape))return mxEvent.ROTATION_HANDLE;if(t.isSource(this.labelShape))return mxEvent.LABEL_HANDLE;if(null!=this.sizers)for(var e=this.tolerance,e=this.allowHandleBoundsCheck&&(mxClient.IS_IE||e>0)?new mxRectangle(t.getGraphX()-e,t.getGraphY()-e,2*e,2*e):null,n=0;n<this.sizers.length;n++)if(t.isSource(this.sizers[n])||null!=e&&mxUtils.intersects(this.sizers[n].bounds,e))return n;return null},mxVertexHandler.prototype.mouseDown=function(t,e){if(!e.isConsumed()&&this.graph.isEnabled()&&!this.graph.isForceMarqueeEvent(e.getEvent())&&(0<this.tolerance||e.getState()==this.state)){var n=this.getHandleForEvent(e);null!=n&&(this.start(e.getX(),e.getY(),n),e.consume())}},mxVertexHandler.prototype.start=function(t,e,n){t=mxUtils.convertPoint(this.graph.container,t,e),this.startX=t.x,this.startY=t.y,this.index=n,this.selectionBorder.node.style.display=n==mxEvent.ROTATION_HANDLE?"inline":"none",this.livePreview||(this.preview=this.createSelectionShape(this.bounds),mxClient.IS_SVG&&0!=Number(this.state.style[mxConstants.STYLE_ROTATION]||"0")||null==this.state.text||this.state.text.node.parentNode!=this.graph.container?(this.preview.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG,this.preview.init(this.graph.view.getOverlayPane())):(this.preview.dialect=mxConstants.DIALECT_STRICTHTML,this.preview.init(this.graph.container)))},mxVertexHandler.prototype.mouseMove=function(t,e){if(e.isConsumed()||null==this.index)null!=this.getHandleForEvent(e)&&e.consume(!1);else{var n=new mxPoint(e.getGraphX(),e.getGraphY()),i=this.graph.isGridEnabledEvent(e.getEvent()),o=this.graph.getView().scale;if(this.index==mxEvent.LABEL_HANDLE)i&&(n.x=this.graph.snap(n.x/o)*o,n.y=this.graph.snap(n.y/o)*o),this.moveSizerTo(this.sizers[this.sizers.length-1],n.x,n.y);else if(this.index==mxEvent.ROTATION_HANDLE){var r=this.state.x+this.state.width/2-n.x,s=this.state.y+this.state.height/2-n.y;this.currentAlpha=0!=r?180*Math.atan(s/r)/Math.PI+90:0>s?180:0,r>0&&(this.currentAlpha-=180),this.rotationRaster&&this.graph.isGridEnabledEvent(e.getEvent())&&(r=n.x-this.state.getCenterX(),s=n.y-this.state.getCenterY(),o=Math.abs(Math.sqrt(r*r+s*s)-this.state.height/2-20),o=Math.max(1,5*Math.min(3,Math.max(0,Math.round(80/Math.abs(o))))),this.currentAlpha=Math.round(this.currentAlpha/o)*o),this.selectionBorder.rotation=this.currentAlpha,this.selectionBorder.redraw()}else{var l=mxUtils.toRadians(this.state.style[mxConstants.STYLE_ROTATION]||"0"),a=Math.cos(-l),h=Math.sin(-l),d=new mxPoint(this.state.getCenterX(),this.state.getCenterY()),r=n.x-this.startX,s=n.y-this.startY,n=this.graph.view.translate,u=h*r+a*s,r=a*r-h*s;this.bounds=this.union(this.selectionBounds,r,u,this.index,i,o,n),a=Math.cos(l),h=Math.sin(l),s=new mxPoint(this.bounds.getCenterX(),this.bounds.getCenterY()),r=s.x-d.x,s=s.y-d.y,d=h*r+a*s-s,this.bounds.x+=a*r-h*s-r,this.bounds.y+=d,this.livePreview?(r=new mxRectangle(this.state.x,this.state.y,this.state.width,this.state.height),a=this.state.origin,this.state.x=this.bounds.x,this.state.y=this.bounds.y,this.state.origin=new mxPoint(this.state.x/o-n.x,this.state.y/o-n.y),this.state.width=this.bounds.width,this.state.height=this.bounds.height,this.state.view.graph.cellRenderer.redraw(this.state,!0),this.redrawHandles(),this.state.view.invalidate(this.state.cell),this.state.invalid=!1,this.state.view.validate(),this.state.x=r.x,this.state.y=r.y,this.state.width=r.width,this.state.height=r.height,this.state.origin=a):this.drawPreview()}e.consume()}},mxVertexHandler.prototype.mouseUp=function(t,e){if(!e.isConsumed()&&null!=this.index&&null!=this.state){var n=new mxPoint(e.getGraphX(),e.getGraphY());this.graph.getModel().beginUpdate();try{if(this.index==mxEvent.ROTATION_HANDLE){if(null!=this.currentAlpha){var i=this.currentAlpha-(this.state.style[mxConstants.STYLE_ROTATION]||0);0!=i&&this.rotateCell(this.state.cell,i)}}else{var o=this.graph.isGridEnabledEvent(e.getEvent()),r=mxUtils.toRadians(this.state.style[mxConstants.STYLE_ROTATION]||"0"),s=Math.cos(-r),l=Math.sin(-r),a=n.x-this.startX,h=n.y-this.startY,n=l*a+s*h,a=s*a-l*h,h=n,d=this.graph.view.scale;this.resizeCell(this.state.cell,a/d,h/d,this.index,o)}}finally{this.graph.getModel().endUpdate()}this.reset(),e.consume()}},mxVertexHandler.prototype.rotateCell=function(t,e){var n=this.graph.getModel();if(n.isVertex(t)){var i=t==this.state?this.state:this.graph.view.getState(t);if(null!=i&&this.graph.setCellStyles(mxConstants.STYLE_ROTATION,(i.style[mxConstants.STYLE_ROTATION]||0)+e,[t]),this.state.cell!=t&&(i=this.graph.getCellGeometry(t),null!=i&&!i.relative&&0!=e)){var o=this.graph.getModel().getParent(t),r=this.graph.getCellGeometry(o);if(!i.relative&&null!=r){var s=mxUtils.toRadians(e),o=Math.cos(s),s=Math.sin(s),l=new mxPoint(i.getCenterX(),i.getCenterY()),r=new mxPoint(r.width/2,r.height/2),o=mxUtils.getRotatedPoint(l,o,s,r),i=i.clone();i.x=o.x-i.width/2,i.y=o.y-i.height/2,n.setGeometry(t,i)}}for(i=n.getChildCount(t),o=0;i>o;o++)this.rotateCell(n.getChildAt(t,o),e)}},mxVertexHandler.prototype.reset=function(){null!=this.sizers&&null!=this.index&&null!=this.sizers[this.index]&&"none"==this.sizers[this.index].node.style.display&&(this.sizers[this.index].node.style.display=""),this.index=this.currentAlpha=null,null!=this.preview&&(this.preview.destroy(),this.preview=null),null!=this.selectionBorder&&(this.selectionBorder.node.style.display="inline",this.selectionBounds=this.getSelectionBounds(this.state),this.bounds=new mxRectangle(this.selectionBounds.x,this.selectionBounds.y,this.selectionBounds.width,this.selectionBounds.height),this.drawPreview())},mxVertexHandler.prototype.resizeCell=function(t,e,n,i,o){var r=this.graph.model.getGeometry(t);
if(null!=r)if(i==mxEvent.LABEL_HANDLE)i=this.graph.view.scale,e=(this.labelShape.bounds.getCenterX()-this.startX)/i,n=(this.labelShape.bounds.getCenterY()-this.startY)/i,r=r.clone(),null==r.offset?r.offset=new mxPoint(e,n):(r.offset.x+=e,r.offset.y+=n),this.graph.model.setGeometry(t,r);else{i=this.union(r,e,n,i,o,1,new mxPoint(0,0));var s=mxUtils.toRadians(this.state.style[mxConstants.STYLE_ROTATION]||"0");if(0!=s){e=i.getCenterX()-r.getCenterX(),n=i.getCenterY()-r.getCenterY(),o=Math.cos(s);var l=Math.sin(s),s=o*e-l*n-e;e=l*e+o*n-n,n=i.x-r.x;var a=i.y-r.y,h=o*n-l*a;o=l*n+o*a,i.x+=s,i.y+=e,this.graph.isCellCollapsed(t)||0==s&&0==e||(n=r.x-i.x+h,a=r.y-i.y+o,this.moveChildren(t,n,a))}this.graph.resizeCell(t,i)}},mxVertexHandler.prototype.moveChildren=function(t,e,n){for(var i=this.graph.getModel(),o=i.getChildCount(t),r=0;o>r;r++){var s=i.getChildAt(t,r);if(i.isVertex(s)){var l=this.graph.getCellGeometry(s);null!=l&&!l.relative&&(l=l.clone(),l.x+=e,l.y+=n,i.setGeometry(s,l))}}},mxVertexHandler.prototype.union=function(t,e,n,i,o,r,s){if(this.singleSizer){s=t.x+t.width+e;var l=t.y+t.height+n;return o&&(s=this.graph.snap(s/r)*r,l=this.graph.snap(l/r)*r),r=new mxRectangle(t.x,t.y,0,0),r.add(new mxRectangle(s,l,0,0)),r}var l=t.x-s.x*r,a=l+t.width,h=t.y-s.y*r;return t=h+t.height,i>4?(t+=n,o&&(t=this.graph.snap(t/r)*r)):3>i&&(h+=n,o&&(h=this.graph.snap(h/r)*r)),0==i||3==i||5==i?(l+=e,o&&(l=this.graph.snap(l/r)*r)):(2==i||4==i||7==i)&&(a+=e,o&&(a=this.graph.snap(a/r)*r)),o=a-l,t-=h,0>o&&(l+=o,o=Math.abs(o)),0>t&&(h+=t,t=Math.abs(t)),new mxRectangle(l+s.x*r,h+s.y*r,o,t)},mxVertexHandler.prototype.redraw=function(){this.selectionBounds=this.getSelectionBounds(this.state),this.bounds=new mxRectangle(this.state.x,this.state.y,this.state.width,this.state.height),this.redrawHandles(),this.drawPreview()},mxVertexHandler.prototype.redrawHandles=function(){var t=this.state;if(null!=this.sizers){var e=t.x+t.width,n=t.y+t.height;if(this.singleSizer)this.moveSizerTo(this.sizers[0],e,n);else{var i=t.x+t.width/2,o=t.y+t.height/2;if(1<this.sizers.length){var r=mxUtils.toRadians(t.style[mxConstants.STYLE_ROTATION]||"0"),s=Math.cos(r),r=Math.sin(r),l=new mxPoint(t.getCenterX(),t.getCenterY()),a=mxUtils.getRotatedPoint(new mxPoint(t.x,t.y),s,r,l);this.moveSizerTo(this.sizers[0],a.x,a.y),a.x=i,a.y=t.y,a=mxUtils.getRotatedPoint(a,s,r,l),this.moveSizerTo(this.sizers[1],a.x,a.y),a.x=e,a.y=t.y,a=mxUtils.getRotatedPoint(a,s,r,l),this.moveSizerTo(this.sizers[2],a.x,a.y),a.x=t.x,a.y=o,a=mxUtils.getRotatedPoint(a,s,r,l),this.moveSizerTo(this.sizers[3],a.x,a.y),a.x=e,a.y=o,a=mxUtils.getRotatedPoint(a,s,r,l),this.moveSizerTo(this.sizers[4],a.x,a.y),a.x=t.x,a.y=n,a=mxUtils.getRotatedPoint(a,s,r,l),this.moveSizerTo(this.sizers[5],a.x,a.y),a.x=i,a.y=n,a=mxUtils.getRotatedPoint(a,s,r,l),this.moveSizerTo(this.sizers[6],a.x,a.y),a.x=e,a.y=n,a=mxUtils.getRotatedPoint(a,s,r,l),this.moveSizerTo(this.sizers[7],a.x,a.y),this.moveSizerTo(this.sizers[8],i+t.absoluteOffset.x,o+t.absoluteOffset.y)}else 2<=this.state.width&&2<=this.state.height?this.moveSizerTo(this.sizers[0],i+t.absoluteOffset.x,o+t.absoluteOffset.y):this.moveSizerTo(this.sizers[0],t.x,t.y)}}null!=this.rotationShape&&(r=mxUtils.toRadians(this.state.style[mxConstants.STYLE_ROTATION]||"0"),s=Math.cos(r),r=Math.sin(r),l=new mxPoint(this.state.getCenterX(),this.state.getCenterY()),a=mxUtils.getRotatedPoint(new mxPoint(t.x+t.width/2,t.y-16),s,r,l),this.moveSizerTo(this.rotationShape,a.x,a.y)),this.selectionBorder.rotation=Number(this.state.style[mxConstants.STYLE_ROTATION]||"0")},mxVertexHandler.prototype.drawPreview=function(){null!=this.preview&&(this.preview.bounds=this.bounds,this.preview.node.parentNode==this.graph.container&&(this.preview.bounds.width=Math.max(0,this.preview.bounds.width-1),this.preview.bounds.height=Math.max(0,this.preview.bounds.height-1)),this.preview.rotation=Number(this.state.style[mxConstants.STYLE_ROTATION]||"0"),this.preview.redraw()),this.selectionBorder.bounds=this.bounds,this.selectionBorder.redraw()},mxVertexHandler.prototype.destroy=function(){if(null!=this.preview&&(this.preview.destroy(),this.preview=null),this.selectionBorder.destroy(),this.labelShape=this.selectionBorder=null,null!=this.sizers)for(var t=0;t<this.sizers.length;t++)this.sizers[t].destroy(),this.sizers[t]=null},mxEdgeHandler.prototype.graph=null,mxEdgeHandler.prototype.state=null,mxEdgeHandler.prototype.marker=null,mxEdgeHandler.prototype.constraintHandler=null,mxEdgeHandler.prototype.error=null,mxEdgeHandler.prototype.shape=null,mxEdgeHandler.prototype.bends=null,mxEdgeHandler.prototype.labelShape=null,mxEdgeHandler.prototype.cloneEnabled=!0,mxEdgeHandler.prototype.addEnabled=!1,mxEdgeHandler.prototype.removeEnabled=!1,mxEdgeHandler.prototype.preferHtml=!1,mxEdgeHandler.prototype.allowHandleBoundsCheck=!0,mxEdgeHandler.prototype.snapToTerminals=!1,mxEdgeHandler.prototype.handleImage=null,mxEdgeHandler.prototype.tolerance=0,mxEdgeHandler.prototype.livePreview=!1,mxEdgeHandler.prototype.init=function(){if(this.graph=this.state.view.graph,this.marker=this.createMarker(),this.constraintHandler=new mxConstraintHandler(this.graph),this.points=[],this.abspoints=this.getSelectionPoints(this.state),this.shape=this.createSelectionShape(this.abspoints),this.shape.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_MIXEDHTML:mxConstants.DIALECT_SVG,this.shape.init(this.graph.getView().getOverlayPane()),this.shape.svgStrokeTolerance=0,this.shape.node.style.cursor=mxConstants.CURSOR_MOVABLE_EDGE,mxEvent.addListener(this.shape.node,"dblclick",mxUtils.bind(this,function(t){this.graph.dblClick(t,this.state.cell)})),mxEvent.addGestureListeners(this.shape.node,mxUtils.bind(this,function(t){this.addEnabled&&this.isAddPointEvent(t)?this.addPoint(this.state,t):this.graph.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(t,this.state))}),mxUtils.bind(this,function(t){var e=this.state.cell;if(null!=this.index){var n=mxUtils.convertPoint(this.graph.container,mxEvent.getClientX(t),mxEvent.getClientY(t)),e=this.graph.getCellAt(n.x,n.y);this.graph.isSwimlane(e)&&this.graph.hitsSwimlaneContent(e,n.x,n.y)&&(e=null)}this.graph.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(t,this.graph.getView().getState(e)))}),mxUtils.bind(this,function(t){this.graph.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(t,this.state))})),this.preferHtml=null!=this.state.text&&this.state.text.node.parentNode==this.graph.container,!this.preferHtml){var t=this.state.getVisibleTerminalState(!0);null!=t&&(this.preferHtml=null!=t.text&&t.text.node.parentNode==this.graph.container),this.preferHtml||(t=this.state.getVisibleTerminalState(!1),null!=t&&(this.preferHtml=null!=t.text&&t.text.node.parentNode==this.graph.container))}(this.graph.getSelectionCount()<mxGraphHandler.prototype.maxCells||0>=mxGraphHandler.prototype.maxCells)&&(this.bends=this.createBends()),this.label=new mxPoint(this.state.absoluteOffset.x,this.state.absoluteOffset.y),this.labelShape=new mxRectangleShape(new mxRectangle,mxConstants.LABEL_HANDLE_FILLCOLOR,mxConstants.HANDLE_STROKECOLOR),this.labelShape.pointerEvents=!1,this.initBend(this.labelShape),this.labelShape.node.style.cursor=mxConstants.CURSOR_LABEL_HANDLE,mxEvent.redirectMouseEvents(this.labelShape.node,this.graph,this.state),this.redraw()},mxEdgeHandler.prototype.isAddPointEvent=function(t){return mxEvent.isShiftDown(t)},mxEdgeHandler.prototype.isRemovePointEvent=function(t){return mxEvent.isShiftDown(t)},mxEdgeHandler.prototype.getSelectionPoints=function(t){return t.absolutePoints},mxEdgeHandler.prototype.createSelectionShape=function(t){return t=new mxPolyline(t,this.getSelectionColor()),t.strokewidth=this.getSelectionStrokeWidth(),t.isDashed=this.isSelectionDashed(),t},mxEdgeHandler.prototype.getSelectionColor=function(){return mxConstants.EDGE_SELECTION_COLOR},mxEdgeHandler.prototype.getSelectionStrokeWidth=function(){return mxConstants.EDGE_SELECTION_STROKEWIDTH},mxEdgeHandler.prototype.isSelectionDashed=function(){return mxConstants.EDGE_SELECTION_DASHED},mxEdgeHandler.prototype.isConnectableCell=function(){return!0},mxEdgeHandler.prototype.createMarker=function(){var t=new mxCellMarker(this.graph),e=this;return t.getCell=function(){var t=mxCellMarker.prototype.getCell.apply(this,arguments);if(!e.isConnectableCell(t))return null;var n=e.graph.getModel();return(t==e.state.cell||null!=t&&!e.graph.connectableEdges&&n.isEdge(t))&&(t=null),t},t.isValidState=function(t){var n=e.graph.getModel(),n=e.graph.view.getTerminalPort(t,e.graph.view.getState(n.getTerminal(e.state.cell,!e.isSource)),!e.isSource),n=null!=n?n.cell:null;return e.error=e.validateConnection(e.isSource?t.cell:n,e.isSource?n:t.cell),null==e.error},t},mxEdgeHandler.prototype.validateConnection=function(t,e){return this.graph.getEdgeValidationError(this.state.cell,t,e)},mxEdgeHandler.prototype.createBends=function(){for(var t=this.state.cell,e=[],n=0;n<this.abspoints.length;n++)if(this.isHandleVisible(n)){var i=n==this.abspoints.length-1;if((i=0==n||i)||this.graph.isCellBendable(t)){var o=this.createHandleShape(n);if(this.initBend(o),this.isHandleEnabled(n))if(mxClient.IS_TOUCH){var r=mxUtils.bind(this,function(t){return t=mxUtils.convertPoint(this.graph.container,mxEvent.getClientX(t),mxEvent.getClientY(t)),this.graph.view.getState(this.graph.getCellAt(t.x,t.y))});mxEvent.redirectMouseEvents(o.node,this.graph,r)}else o.node.style.cursor=mxConstants.CURSOR_BEND_HANDLE,mxEvent.redirectMouseEvents(o.node,this.graph,this.state);e.push(o),i||(this.points.push(new mxPoint(0,0)),o.node.style.visibility="hidden")}}return e},mxEdgeHandler.prototype.isHandleEnabled=function(){return!0},mxEdgeHandler.prototype.isHandleVisible=function(){return!0},mxEdgeHandler.prototype.createHandleShape=function(t){return null!=this.handleImage?new mxImageShape(new mxRectangle(0,0,this.handleImage.width,this.handleImage.height),this.handleImage.src):(t=mxConstants.HANDLE_SIZE,this.preferHtml&&(t-=1),new mxRectangleShape(new mxRectangle(0,0,t,t),mxConstants.HANDLE_FILLCOLOR,mxConstants.HANDLE_STROKECOLOR))},mxEdgeHandler.prototype.initBend=function(t){this.preferHtml?(t.dialect=mxConstants.DIALECT_STRICTHTML,t.init(this.graph.container)):(t.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_MIXEDHTML:mxConstants.DIALECT_SVG,t.init(this.graph.getView().getOverlayPane()))},mxEdgeHandler.prototype.getHandleForEvent=function(t){if(null!=this.bends)for(var e=this.tolerance,e=this.allowHandleBoundsCheck&&(mxClient.IS_IE||e>0)?new mxRectangle(t.getGraphX()-e,t.getGraphY()-e,2*e,2*e):null,n=0;n<this.bends.length;n++)if((t.isSource(this.bends[n])||null!=e&&mxUtils.intersects(this.bends[n].bounds,e))&&"hidden"!=this.bends[n].node.style.visibility)return n;return!(t.isSource(this.labelShape)&&"hidden"!=this.labelShape.node.style.visibility||t.isSource(this.state.text))||(mxClient.IS_SF||mxClient.IS_GC)&&"SELECT"==t.getSource().nodeName?null:mxEvent.LABEL_HANDLE},mxEdgeHandler.prototype.mouseDown=function(t,e){var n=null,n=this.getHandleForEvent(e);null!=n&&!e.isConsumed()&&this.graph.isEnabled()&&!this.graph.isForceMarqueeEvent(e.getEvent())&&(this.removeEnabled&&this.isRemovePointEvent(e.getEvent())?this.removePoint(this.state,n):(n!=mxEvent.LABEL_HANDLE||this.graph.isLabelMovable(e.getCell()))&&this.start(e.getX(),e.getY(),n),e.consume())},mxEdgeHandler.prototype.start=function(t,e,n){this.startX=t,this.startY=e,this.isSource=null==this.bends?!1:0==n,this.isTarget=null==this.bends?!1:n==this.bends.length-1,this.isLabel=n==mxEvent.LABEL_HANDLE,this.isSource||this.isTarget?(t=this.state.cell,e=this.graph.model.getTerminal(t,this.isSource),(null==e&&this.graph.isTerminalPointMovable(t,this.isSource)||null!=e&&this.graph.isCellDisconnectable(t,e,this.isSource))&&(this.index=n)):this.index=n,this.livePreview&&(this.shape.node.style.visibility="hidden",(this.isSource||this.isTarget)&&null!=this.bends[n])&&(this.bends[n].node.style.display="none")},mxEdgeHandler.prototype.clonePreviewState=function(){return this.state.clone()},mxEdgeHandler.prototype.getSnapToTerminalTolerance=function(){return this.graph.gridSize*this.graph.view.scale/2},mxEdgeHandler.prototype.getPointForEvent=function(t){var e=new mxPoint(t.getGraphX(),t.getGraphY()),n=this.getSnapToTerminalTolerance(),i=this.graph.getView(),o=!1,r=!1;if(this.snapToTerminals&&n>0){var s=function(t){if(null!=t){var i=t.x;Math.abs(e.x-i)<n&&(e.x=i,o=!0),t=t.y,Math.abs(e.y-t)<n&&(e.y=t,r=!0)}},l=function(t){null!=t&&s.call(this,new mxPoint(i.getRoutingCenterX(t),i.getRoutingCenterY(t)))};if(l.call(this,this.state.getVisibleTerminalState(!0)),l.call(this,this.state.getVisibleTerminalState(!1)),null!=this.abspoints)for(l=0;l<this.abspoints;l++)l!=this.index&&s.call(this,this.abspoints[l])}return this.graph.isGridEnabledEvent(t.getEvent())&&(t=i.scale,l=i.translate,o||(e.x=(this.graph.snap(e.x/t-l.x)+l.x)*t),r||(e.y=(this.graph.snap(e.y/t-l.y)+l.y)*t)),e},mxEdgeHandler.prototype.getPreviewTerminalState=function(t){this.constraintHandler.update(t,this.isSource),this.marker.process(t),t=this.marker.getValidState();var e=null;return null!=this.constraintHandler.currentFocus&&null!=this.constraintHandler.currentConstraint&&this.marker.reset(),null!=t?e=t:null!=this.constraintHandler.currentConstraint&&null!=this.constraintHandler.currentFocus&&(e=this.constraintHandler.currentFocus),e},mxEdgeHandler.prototype.getPreviewPoints=function(t){var e=this.graph.getCellGeometry(this.state.cell),e=null!=e.points?e.points.slice():null;return this.isSource||this.isTarget?this.graph.resetEdgesOnConnect&&(e=null):(this.convertPoint(t,!1),null==e?e=[t]:e[this.index-1]=t),e},mxEdgeHandler.prototype.updatePreviewState=function(t,e,n){var i=this.isSource?n:this.state.getVisibleTerminalState(!0),o=this.isTarget?n:this.state.getVisibleTerminalState(!1),r=this.graph.getConnectionConstraint(t,i,!0),s=this.graph.getConnectionConstraint(t,o,!1),l=this.constraintHandler.currentConstraint;null==l&&(l=new mxConnectionConstraint),this.isSource?r=l:this.isTarget&&(s=l),(!this.isSource||null!=i)&&t.view.updateFixedTerminalPoint(t,i,!0,r),(!this.isTarget||null!=o)&&t.view.updateFixedTerminalPoint(t,o,!1,s),(this.isSource||this.isTarget)&&null==n&&(t.setAbsoluteTerminalPoint(e,this.isSource),null==this.marker.getMarkedState()&&(this.error=this.graph.allowDanglingEdges?null:"")),t.view.updatePoints(t,this.points,i,o),t.view.updateFloatingTerminalPoints(t,i,o)},mxEdgeHandler.prototype.mouseMove=function(t,e){if(null!=this.index&&null!=this.marker){var n=this.getPointForEvent(e);if(this.isLabel)this.label.x=n.x,this.label.y=n.y;else{this.points=this.getPreviewPoints(n);var i=this.isSource||this.isTarget?this.getPreviewTerminalState(e):null,o=this.clonePreviewState(n,null!=i?i.cell:null);this.updatePreviewState(o,n,i),this.setPreviewColor(null==this.error?this.marker.validColor:this.marker.invalidColor),this.abspoints=o.absolutePoints,this.active=!0}this.livePreview?(i=this.state.absolutePoints,this.isLabel?this.state.absoluteOffset=n:(this.state.absolutePoints=this.abspoints,this.state.view.updateEdgeBounds(this.state),this.state.view.updateEdgeLabelOffset(this.state)),this.state.view.graph.cellRenderer.redraw(this.state,!0),this.redrawHandles(),this.state.view.invalidate(this.state.cell),this.state.invalid=!1,this.state.view.validate(),this.state.absolutePoints=i,this.state.view.updateEdgeBounds(this.state),this.state.view.updateEdgeLabelOffset(this.state)):this.drawPreview(),mxEvent.consume(e.getEvent()),e.consume()}else mxClient.IS_IE&&null!=this.getHandleForEvent(e)&&e.consume(!1)},mxEdgeHandler.prototype.mouseUp=function(t,e){if(null!=this.index&&null!=this.marker){var n=this.state.cell;if(e.getX()!=this.startX||e.getY()!=this.startY)if(null!=this.error)0<this.error.length&&this.graph.validationAlert(this.error);else if(this.isLabel)this.moveLabel(this.state,this.label.x,this.label.y);else if(this.isSource||this.isTarget){var i=null;if(null!=this.constraintHandler.currentConstraint&&null!=this.constraintHandler.currentFocus&&(i=this.constraintHandler.currentFocus.cell),null==i&&this.marker.hasValidState()&&(i=this.marker.validState.cell),null!=i)n=this.connect(n,i,this.isSource,this.graph.isCloneEvent(e.getEvent())&&this.cloneEnabled&&this.graph.isCellsCloneable(),e);else if(this.graph.isAllowDanglingEdges()){i=this.abspoints[this.isSource?0:this.abspoints.length-1],i.x=i.x/this.graph.view.scale-this.graph.view.translate.x,i.y=i.y/this.graph.view.scale-this.graph.view.translate.y;var o=this.graph.getView().getState(this.graph.getModel().getParent(n));null!=o&&(i.x-=o.origin.x,i.y-=o.origin.y),i.x-=this.graph.panDx/this.graph.view.scale,i.y-=this.graph.panDy/this.graph.view.scale,this.changeTerminalPoint(n,i,this.isSource)}}else this.active?this.changePoints(n,this.points):(this.graph.getView().invalidate(this.state.cell),this.graph.getView().revalidate(this.state.cell));null!=this.marker&&(this.reset(),n!=this.state.cell&&this.graph.setSelectionCell(n)),e.consume()}},mxEdgeHandler.prototype.reset=function(){null!=this.bends&&null!=this.index&&null!=this.bends[this.index]&&"none"==this.bends[this.index].node.style.display&&(this.bends[this.index].node.style.display=""),this.points=this.label=this.index=this.error=null,this.isTarget=this.isSource=this.isLabel=this.active=!1,this.marker.reset(),this.constraintHandler.reset(),this.setPreviewColor(mxConstants.EDGE_SELECTION_COLOR),this.redraw()},mxEdgeHandler.prototype.setPreviewColor=function(t){null!=this.shape&&(this.shape.stroke=t)},mxEdgeHandler.prototype.convertPoint=function(t,e){var n=this.graph.getView().getScale(),i=this.graph.getView().getTranslate();return e&&(t.x=this.graph.snap(t.x),t.y=this.graph.snap(t.y)),t.x=Math.round(t.x/n-i.x),t.y=Math.round(t.y/n-i.y),n=this.graph.getView().getState(this.graph.getModel().getParent(this.state.cell)),null!=n&&(t.x-=n.origin.x,t.y-=n.origin.y),t},mxEdgeHandler.prototype.moveLabel=function(t,e,n){var i=this.graph.getModel(),o=i.getGeometry(t.cell);if(null!=o){var o=o.clone(),r=this.graph.getView().getRelativePoint(t,e,n);o.x=r.x,o.y=r.y;var s=this.graph.getView().scale;o.offset=new mxPoint(0,0),r=this.graph.view.getPoint(t,o),o.offset=new mxPoint((e-r.x)/s,(n-r.y)/s),i.setGeometry(t.cell,o)}},mxEdgeHandler.prototype.connect=function(t,e,n,i,o){o=this.graph.getModel();var r=o.getParent(t);o.beginUpdate();try{if(i){var s=t.clone();o.add(r,s,o.getChildCount(r));var l=o.getTerminal(t,!n);this.graph.connectCell(s,l,!n),t=s}var a=this.constraintHandler.currentConstraint;null==a&&(a=new mxConnectionConstraint),this.graph.connectCell(t,e,n,a)}finally{o.endUpdate()}return t},mxEdgeHandler.prototype.changeTerminalPoint=function(t,e,n){var i=this.graph.getModel(),o=i.getGeometry(t);if(null!=o){i.beginUpdate();try{o=o.clone(),o.setTerminalPoint(e,n),i.setGeometry(t,o),this.graph.connectCell(t,null,n,new mxConnectionConstraint)}finally{i.endUpdate()}}},mxEdgeHandler.prototype.changePoints=function(t,e){var n=this.graph.getModel(),i=n.getGeometry(t);null!=i&&(i=i.clone(),i.points=e,n.setGeometry(t,i))},mxEdgeHandler.prototype.addPoint=function(t,e){var n=mxUtils.convertPoint(this.graph.container,mxEvent.getClientX(e),mxEvent.getClientY(e)),i=this.graph.isGridEnabledEvent(e);this.convertPoint(n,i),this.addPointAt(t,n.x,n.y),mxEvent.consume(e)},mxEdgeHandler.prototype.addPointAt=function(t,e,n){var i=this.graph.getCellGeometry(t.cell);if(e=new mxPoint(e,n),null!=i){i=i.clone(),n=this.graph.view.translate;var o=this.graph.view.scale;n=mxUtils.findNearestSegment(t,(e.x+n.x)*o,(e.y+n.y)*o),null==i.points?i.points=[e]:i.points.splice(n,0,e),this.graph.getModel().setGeometry(t.cell,i),this.destroy(),this.init()}},mxEdgeHandler.prototype.removePoint=function(t,e){if(e>0&&e<this.abspoints.length-1){var n=this.graph.getCellGeometry(this.state.cell);null!=n&&null!=n.points&&(n=n.clone(),n.points.splice(e-1,1),this.graph.getModel().setGeometry(t.cell,n),this.destroy(),this.init())}},mxEdgeHandler.prototype.getHandleFillColor=function(t){t=0==t;var e=this.state.cell,n=this.graph.getModel().getTerminal(e,t),i=mxConstants.HANDLE_FILLCOLOR;return null!=n&&!this.graph.isCellDisconnectable(e,n,t)||null==n&&!this.graph.isTerminalPointMovable(e,t)?i=mxConstants.LOCKED_HANDLE_FILLCOLOR:null!=n&&this.graph.isCellDisconnectable(e,n,t)&&(i=mxConstants.CONNECT_HANDLE_FILLCOLOR),i},mxEdgeHandler.prototype.redraw=function(){this.abspoints=this.state.absolutePoints.slice(),this.redrawHandles();var t=this.graph.getModel().getGeometry(this.state.cell).points;if(null!=this.bends&&0<this.bends.length&&null!=t){null==this.points&&(this.points=[]);for(var e=1;e<this.bends.length-1;e++)null!=this.bends[e]&&null!=this.abspoints[e]&&(this.points[e-1]=t[e-1])}this.drawPreview()},mxEdgeHandler.prototype.redrawHandles=function(){var t=this.state.cell,e=mxConstants.LABEL_HANDLE_SIZE;if(this.label=new mxPoint(this.state.absoluteOffset.x,this.state.absoluteOffset.y),this.labelShape.bounds=new mxRectangle(Math.round(this.label.x-e/2),Math.round(this.label.y-e/2),e,e),this.labelShape.redraw(),e=this.graph.getLabel(t),this.labelShape.node.style.visibility=null!=e&&0<e.length&&this.graph.isLabelMovable(t)?"visible":"hidden",null!=this.bends&&0<this.bends.length){var n=this.abspoints.length-1,t=this.abspoints[0],i=this.abspoints[0].y,e=this.bends[0].bounds;this.bends[0].bounds=new mxRectangle(Math.round(this.abspoints[0].x-e.width/2),Math.round(i-e.height/2),e.width,e.height),this.bends[0].fill=this.getHandleFillColor(0),this.bends[0].redraw();var i=this.abspoints[n],o=this.abspoints[n].x,n=this.abspoints[n].y,r=this.bends.length-1,e=this.bends[r].bounds;this.bends[r].bounds=new mxRectangle(Math.round(o-e.width/2),Math.round(n-e.height/2),e.width,e.height),this.bends[r].fill=this.getHandleFillColor(r),this.bends[r].redraw(),this.redrawInnerBends(t,i)}},mxEdgeHandler.prototype.redrawInnerBends=function(){for(var t=1;t<this.bends.length-1;t++)if(null!=this.bends[t])if(null!=this.abspoints[t]){var e=this.abspoints[t].x,n=this.abspoints[t].y,i=this.bends[t].bounds;this.bends[t].node.style.visibility="visible",this.bends[t].bounds=new mxRectangle(Math.round(e-i.width/2),Math.round(n-i.height/2),i.width,i.height),this.bends[t].redraw()}else this.bends[t].destroy(),this.bends[t]=null},mxEdgeHandler.prototype.drawPreview=function(){if(this.isLabel){var t=mxConstants.LABEL_HANDLE_SIZE,t=new mxRectangle(Math.round(this.label.x-t/2),Math.round(this.label.y-t/2),t,t);this.labelShape.bounds=t,this.labelShape.redraw()}else this.shape.points=this.abspoints,this.shape.redraw()},mxEdgeHandler.prototype.destroy=function(){if(null!=this.marker&&(this.marker.destroy(),this.marker=null),null!=this.shape&&(this.shape.destroy(),this.shape=null),null!=this.labelShape&&(this.labelShape.destroy(),this.labelShape=null),null!=this.constraintHandler&&(this.constraintHandler.destroy(),this.constraintHandler=null),null!=this.bends)for(var t=0;t<this.bends.length;t++)null!=this.bends[t]&&(this.bends[t].destroy(),this.bends[t]=null)},mxUtils.extend(mxElbowEdgeHandler,mxEdgeHandler),mxElbowEdgeHandler.prototype=new mxEdgeHandler,mxElbowEdgeHandler.prototype.constructor=mxElbowEdgeHandler,mxElbowEdgeHandler.prototype.flipEnabled=!0,mxElbowEdgeHandler.prototype.doubleClickOrientationResource="none"!=mxClient.language?"doubleClickOrientation":"",mxElbowEdgeHandler.prototype.createBends=function(){var t=[],e=this.createHandleShape(0);return this.initBend(e),e.node.style.cursor=mxConstants.CURSOR_BEND_HANDLE,mxEvent.redirectMouseEvents(e.node,this.graph,this.state),t.push(e),mxClient.IS_TOUCH&&e.node.setAttribute("pointer-events","none"),t.push(this.createVirtualBend()),this.points.push(new mxPoint(0,0)),e=this.createHandleShape(2),this.initBend(e),e.node.style.cursor=mxConstants.CURSOR_BEND_HANDLE,mxEvent.redirectMouseEvents(e.node,this.graph,this.state),t.push(e),mxClient.IS_TOUCH&&e.node.setAttribute("pointer-events","none"),t},mxElbowEdgeHandler.prototype.createVirtualBend=function(){var t=this.createHandleShape();this.initBend(t);var e=this.getCursorForBend();return t.node.style.cursor=e,e=mxUtils.bind(this,function(t){!mxEvent.isConsumed(t)&&this.flipEnabled&&(this.graph.flipEdge(this.state.cell,t),mxEvent.consume(t))}),mxEvent.redirectMouseEvents(t.node,this.graph,this.state,null,null,null,e),this.graph.isCellBendable(this.state.cell)||(t.node.style.display="none"),t},mxElbowEdgeHandler.prototype.getCursorForBend=function(){return this.state.style[mxConstants.STYLE_EDGE]==mxEdgeStyle.TopToBottom||this.state.style[mxConstants.STYLE_EDGE]==mxConstants.EDGESTYLE_TOPTOBOTTOM||(this.state.style[mxConstants.STYLE_EDGE]==mxEdgeStyle.ElbowConnector||this.state.style[mxConstants.STYLE_EDGE]==mxConstants.EDGESTYLE_ELBOW)&&this.state.style[mxConstants.STYLE_ELBOW]==mxConstants.ELBOW_VERTICAL?"row-resize":"col-resize"},mxElbowEdgeHandler.prototype.getTooltipForNode=function(t){var e=null;return null==this.bends||null==this.bends[1]||t!=this.bends[1].node&&t.parentNode!=this.bends[1].node||(e=this.doubleClickOrientationResource,e=mxResources.get(e)||e),e},mxElbowEdgeHandler.prototype.convertPoint=function(t,e){var n=this.graph.getView().getScale(),i=this.graph.getView().getTranslate(),o=this.state.origin;e&&(t.x=this.graph.snap(t.x),t.y=this.graph.snap(t.y)),t.x=Math.round(t.x/n-i.x-o.x),t.y=Math.round(t.y/n-i.y-o.y)},mxElbowEdgeHandler.prototype.redrawInnerBends=function(t,e){var n=this.graph.getModel().getGeometry(this.state.cell).points,n=null!=n?n[0]:null,n=null==n?new mxPoint(t.x+(e.x-t.x)/2,t.y+(e.y-t.y)/2):new mxPoint(this.graph.getView().scale*(n.x+this.graph.getView().translate.x+this.state.origin.x),this.graph.getView().scale*(n.y+this.graph.getView().translate.y+this.state.origin.y)),i=this.bends[1].bounds,o=i.width,i=i.height;null==this.handleImage&&(i=o=mxConstants.HANDLE_SIZE);var r=new mxRectangle(Math.round(n.x-o/2),Math.round(n.y-i/2),o,i);null==this.handleImage&&"hidden"!=this.labelShape.node.style.visibility&&mxUtils.intersects(r,this.labelShape.bounds)&&(o+=3,i+=3,r=new mxRectangle(Math.round(n.x-o/2),Math.round(n.y-i/2),o,i)),this.bends[1].bounds=r,this.bends[1].redraw()},mxUtils.extend(mxEdgeSegmentHandler,mxEdgeHandler),mxEdgeSegmentHandler.prototype=new mxElbowEdgeHandler,mxEdgeSegmentHandler.prototype.constructor=mxEdgeSegmentHandler,mxEdgeSegmentHandler.prototype.getPreviewPoints=function(t){if(this.isSource||this.isTarget)return mxElbowEdgeHandler.prototype.getPreviewPoints.apply(this,arguments);this.convertPoint(t,!1);var e=this.state.absolutePoints,n=e[0].clone();this.convertPoint(n,!1);for(var i=[],o=1;o<e.length;o++){var r=e[o].clone();this.convertPoint(r,!1),o==this.index&&(n.x==r.x?(n.x=t.x,r.x=t.x):(n.y=t.y,r.y=t.y)),o<e.length-1&&i.push(r),n=r}if(1==i.length){if(n=this.state.view,o=this.state.getVisibleTerminalState(!0),r=this.state.getVisibleTerminalState(!1),null!=r&null!=o){var s=this.state.origin.x,l=this.state.origin.y;mxUtils.contains(r,i[0].x+s,i[0].y+l)?e[1].y==e[2].y?i[0].y=n.getRoutingCenterY(o)-l:i[0].x=n.getRoutingCenterX(o)-s:mxUtils.contains(o,i[0].x+s,i[0].y+l)&&(e[1].y==e[0].y?i[0].y=n.getRoutingCenterY(r)-l:i[0].x=n.getRoutingCenterX(r)-s)}}else 0==i.length&&(i=[t]);return i},mxEdgeSegmentHandler.prototype.createBends=function(){var t=[],e=this.createHandleShape(0);this.initBend(e),e.node.style.cursor=mxConstants.CURSOR_BEND_HANDLE,mxEvent.redirectMouseEvents(e.node,this.graph,this.state),t.push(e),mxClient.IS_TOUCH&&e.node.setAttribute("pointer-events","none");var n=this.state.absolutePoints;if(this.graph.isCellBendable(this.state.cell)){null==this.points&&(this.points=[]);for(var i=0;i<n.length-1;i++)e=this.createVirtualBend(),t.push(e),e.node.style.cursor=0==n[i].x-n[i+1].x?"col-resize":"row-resize",this.points.push(new mxPoint(0,0)),mxClient.IS_TOUCH&&e.node.setAttribute("pointer-events","none")}return e=this.createHandleShape(n.length),this.initBend(e),e.node.style.cursor=mxConstants.CURSOR_BEND_HANDLE,mxEvent.redirectMouseEvents(e.node,this.graph,this.state),t.push(e),mxClient.IS_TOUCH&&e.node.setAttribute("pointer-events","none"),t},mxEdgeSegmentHandler.prototype.redraw=function(){this.refresh(),mxEdgeHandler.prototype.redraw.apply(this,arguments)},mxEdgeSegmentHandler.prototype.refresh=function(){if(null!=this.bends){for(var t=0;t<this.bends.length;t++)null!=this.bends[t]&&(this.bends[t].destroy(),this.bends[t]=null);this.bends=this.createBends()}},mxEdgeSegmentHandler.prototype.redrawInnerBends=function(t,e){if(this.graph.isCellBendable(this.state.cell)){var n=mxConstants.HANDLE_SIZE,i=this.state.absolutePoints;if(null!=i&&1<i.length)for(var o=0;o<this.state.absolutePoints.length-1;o++)if(null!=this.bends[o+1]){t=i[o],e=i[o+1];var r=new mxPoint(t.x+(e.x-t.x)/2,t.y+(e.y-t.y)/2);this.bends[o+1].bounds=new mxRectangle(Math.round(r.x-n/2),Math.round(r.y-n/2),n,n),this.bends[o+1].redraw()}}},mxEdgeSegmentHandler.prototype.changePoints=function(t,e){e=[];var n=this.abspoints;if(1<n.length)for(var i=n[0],o=n[1],r=2;r<n.length;r++){var s=n[r];Math.round(i.x)==Math.round(o.x)&&Math.round(o.x)==Math.round(s.x)||Math.round(i.y)==Math.round(o.y)&&Math.round(o.y)==Math.round(s.y)||(i=o,o=o.clone(),this.convertPoint(o,!1),e.push(o)),o=s}mxElbowEdgeHandler.prototype.changePoints.apply(this,arguments)},mxKeyHandler.prototype.graph=null,mxKeyHandler.prototype.target=null,mxKeyHandler.prototype.normalKeys=null,mxKeyHandler.prototype.shiftKeys=null,mxKeyHandler.prototype.controlKeys=null,mxKeyHandler.prototype.controlShiftKeys=null,mxKeyHandler.prototype.enabled=!0,mxKeyHandler.prototype.isEnabled=function(){return this.enabled},mxKeyHandler.prototype.setEnabled=function(t){this.enabled=t},mxKeyHandler.prototype.bindKey=function(t,e){this.normalKeys[t]=e},mxKeyHandler.prototype.bindShiftKey=function(t,e){this.shiftKeys[t]=e},mxKeyHandler.prototype.bindControlKey=function(t,e){this.controlKeys[t]=e},mxKeyHandler.prototype.bindControlShiftKey=function(t,e){this.controlShiftKeys[t]=e},mxKeyHandler.prototype.isControlDown=function(t){return mxEvent.isControlDown(t)},mxKeyHandler.prototype.getFunction=function(t){return null!=t?this.isControlDown(t)?mxEvent.isShiftDown(t)?this.controlShiftKeys[t.keyCode]:this.controlKeys[t.keyCode]:mxEvent.isShiftDown(t)?this.shiftKeys[t.keyCode]:this.normalKeys[t.keyCode]:null},mxKeyHandler.prototype.isGraphEvent=function(t){if(t=mxEvent.getSource(t),t==this.target||t.parentNode==this.target||null!=this.graph.cellEditor&&t==this.graph.cellEditor.textarea)return!0;for(;null!=t;){if(t==this.graph.container)return!0;t=t.parentNode}return!1},mxKeyHandler.prototype.keyDown=function(t){if(this.graph.isEnabled()&&!mxEvent.isConsumed(t)&&this.isGraphEvent(t)&&this.isEnabled())if(27==t.keyCode)this.escape(t);else if(!this.graph.isEditing()){var e=this.getFunction(t);null!=e&&(e(t),mxEvent.consume(t))}},mxKeyHandler.prototype.escape=function(t){this.graph.isEscapeEnabled()&&this.graph.escape(t)},mxKeyHandler.prototype.destroy=function(){this.target=null},mxTooltipHandler.prototype.zIndex=10005,mxTooltipHandler.prototype.graph=null,mxTooltipHandler.prototype.delay=null,mxTooltipHandler.prototype.hideOnHover=!1,mxTooltipHandler.prototype.enabled=!0,mxTooltipHandler.prototype.isEnabled=function(){return this.enabled},mxTooltipHandler.prototype.setEnabled=function(t){this.enabled=t},mxTooltipHandler.prototype.isHideOnHover=function(){return this.hideOnHover},mxTooltipHandler.prototype.setHideOnHover=function(t){this.hideOnHover=t},mxTooltipHandler.prototype.init=function(){null!=document.body&&(this.div=document.createElement("div"),this.div.className="mxTooltip",this.div.style.visibility="hidden",document.body.appendChild(this.div),mxEvent.addGestureListeners(this.div,mxUtils.bind(this,function(){this.hideTooltip()})))},mxTooltipHandler.prototype.mouseDown=function(t,e){this.reset(e,!1),this.hideTooltip()},mxTooltipHandler.prototype.mouseMove=function(t,e){(e.getX()!=this.lastX||e.getY()!=this.lastY)&&(this.reset(e,!0),(this.isHideOnHover()||e.getState()!=this.state||e.getSource()!=this.node&&(!this.stateSource||null!=e.getState()&&this.stateSource==(e.isSource(e.getState().shape)||!e.isSource(e.getState().text))))&&this.hideTooltip()),this.lastX=e.getX(),this.lastY=e.getY()},mxTooltipHandler.prototype.mouseUp=function(t,e){this.reset(e,!0),this.hideTooltip()},mxTooltipHandler.prototype.resetTimer=function(){null!=this.thread&&(window.clearTimeout(this.thread),this.thread=null)},mxTooltipHandler.prototype.reset=function(t,e){if(this.resetTimer(),e&&this.isEnabled()&&null!=t.getState()&&(null==this.div||"hidden"==this.div.style.visibility)){var n=t.getState(),i=t.getSource(),o=t.getX(),r=t.getY(),s=t.isSource(n.shape)||t.isSource(n.text);this.thread=window.setTimeout(mxUtils.bind(this,function(){if(!this.graph.isEditing()&&!this.graph.panningHandler.isMenuShowing()){var t=this.graph.getTooltip(n,i,o,r);this.show(t,o,r),this.state=n,this.node=i,this.stateSource=s
}}),this.delay)}},mxTooltipHandler.prototype.hide=function(){this.resetTimer(),this.hideTooltip()},mxTooltipHandler.prototype.hideTooltip=function(){null!=this.div&&(this.div.style.visibility="hidden")},mxTooltipHandler.prototype.show=function(t,e,n){if(null!=t&&0<t.length){null==this.div&&this.init();var i=mxUtils.getScrollOrigin();this.div.style.zIndex=this.zIndex,this.div.style.left=e+i.x+"px",this.div.style.top=n+mxConstants.TOOLTIP_VERTICAL_OFFSET+i.y+"px",mxUtils.isNode(t)?(this.div.innerHTML="",this.div.appendChild(t)):this.div.innerHTML=t.replace(/\n/g,"<br>"),this.div.style.visibility="",mxUtils.fit(this.div)}},mxTooltipHandler.prototype.destroy=function(){this.graph.removeMouseListener(this),mxEvent.release(this.div),null!=this.div&&null!=this.div.parentNode&&this.div.parentNode.removeChild(this.div),this.div=null},mxUtils.extend(mxCellTracker,mxCellMarker),mxCellTracker.prototype.mouseDown=function(){},mxCellTracker.prototype.mouseMove=function(t,e){this.isEnabled()&&this.process(e)},mxCellTracker.prototype.mouseUp=function(){this.reset()},mxCellTracker.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.graph.removeMouseListener(this),mxCellMarker.prototype.destroy.apply(this))},mxCellHighlight.prototype.keepOnTop=!1,mxCellHighlight.prototype.graph=!0,mxCellHighlight.prototype.state=null,mxCellHighlight.prototype.spacing=2,mxCellHighlight.prototype.resetHandler=null,mxCellHighlight.prototype.setHighlightColor=function(t){this.highlightColor=t,null!=this.shape&&(this.shape.stroke=t)},mxCellHighlight.prototype.drawHighlight=function(){this.shape=this.createShape(),this.repaint(),!this.keepOnTop&&this.shape.node.parentNode.firstChild!=this.shape.node&&this.shape.node.parentNode.insertBefore(this.shape.node,this.shape.node.parentNode.firstChild)},mxCellHighlight.prototype.createShape=function(){var t=null,t=this.graph.model.isEdge(this.state.cell)?new mxPolyline(this.state.absolutePoints,this.highlightColor,this.strokeWidth):new mxRectangleShape(new mxRectangle,null,this.highlightColor,this.strokeWidth);return t.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG,t.init(this.graph.getView().getOverlayPane()),mxEvent.redirectMouseEvents(t.node,this.graph,this.state),t.svgStrokeTolerance=0,t.pointerEvents=!1,t.isDashed=this.dashed,t},mxCellHighlight.prototype.repaint=function(){null!=this.state&&null!=this.shape&&(this.graph.model.isEdge(this.state.cell)?this.shape.points=this.state.absolutePoints:(this.shape.bounds=new mxRectangle(this.state.x-this.spacing,this.state.y-this.spacing,this.state.width+2*this.spacing,this.state.height+2*this.spacing),this.shape.rotation=Number(this.state.style[mxConstants.STYLE_ROTATION]||"0")),null!=this.state.shape&&this.shape.setCursor(this.state.shape.getCursor()),this.shape.redraw())},mxCellHighlight.prototype.hide=function(){this.highlight(null)},mxCellHighlight.prototype.highlight=function(t){this.state!=t&&(null!=this.shape&&(this.shape.destroy(),this.shape=null),this.state=t,null!=this.state&&this.drawHighlight())},mxCellHighlight.prototype.destroy=function(){this.graph.getView().removeListener(this.repaintHandler),this.graph.getModel().removeListener(this.repaintHandler),this.graph.getView().removeListener(this.resetHandler),this.graph.getModel().removeListener(this.resetHandler),null!=this.shape&&(this.shape.destroy(),this.shape=null)},mxDefaultKeyHandler.prototype.editor=null,mxDefaultKeyHandler.prototype.handler=null,mxDefaultKeyHandler.prototype.bindAction=function(t,e,n){var i=mxUtils.bind(this,function(){this.editor.execute(e)});n?this.handler.bindControlKey(t,i):this.handler.bindKey(t,i)},mxDefaultKeyHandler.prototype.destroy=function(){this.handler.destroy(),this.handler=null},mxDefaultPopupMenu.prototype.imageBasePath=null,mxDefaultPopupMenu.prototype.config=null,mxDefaultPopupMenu.prototype.createMenu=function(t,e,n,i){if(null!=this.config){var o=this.createConditions(t,n,i);this.addItems(t,e,n,i,o,this.config.firstChild,null)}},mxDefaultPopupMenu.prototype.addItems=function(t,e,n,i,o,r,s){for(var l=!1;null!=r;){if("add"==r.nodeName){var a=r.getAttribute("if");if(null==a||o[a]){var a=r.getAttribute("as"),a=mxResources.get(a)||a,h=mxUtils.eval(mxUtils.getTextContent(r)),d=r.getAttribute("action"),u=r.getAttribute("icon"),c=r.getAttribute("iconCls");l&&(e.addSeparator(s),l=!1),null!=u&&this.imageBasePath&&(u=this.imageBasePath+u),a=this.addAction(e,t,a,u,h,d,n,s,c),this.addItems(t,e,n,i,o,r.firstChild,a)}}else"separator"==r.nodeName&&(l=!0);r=r.nextSibling}},mxDefaultPopupMenu.prototype.addAction=function(t,e,n,i,o,r,s,l,a){return t.addItem(n,i,function(t){"function"==typeof o&&o.call(e,e,s,t),null!=r&&e.execute(r,s,t)},l,a)},mxDefaultPopupMenu.prototype.createConditions=function(t,e,n){var i=t.graph.getModel(),o=i.getChildCount(e),r=[];for(r.nocell=null==e,r.ncells=1<t.graph.getSelectionCount(),r.notRoot=i.getRoot()!=i.getParent(t.graph.getDefaultParent()),r.cell=null!=e,i=null!=e&&1==t.graph.getSelectionCount(),r.nonEmpty=i&&o>0,r.expandable=i&&t.graph.isCellFoldable(e,!1),r.collapsable=i&&t.graph.isCellFoldable(e,!0),r.validRoot=i&&t.graph.isValidRoot(e),r.emptyValidRoot=r.validRoot&&0==o,r.swimlane=i&&t.graph.isSwimlane(e),o=this.config.getElementsByTagName("condition"),i=0;i<o.length;i++){var s=mxUtils.eval(mxUtils.getTextContent(o[i])),l=o[i].getAttribute("name");null!=l&&"function"==typeof s&&(r[l]=s(t,e,n))}return r},mxDefaultToolbar.prototype.editor=null,mxDefaultToolbar.prototype.toolbar=null,mxDefaultToolbar.prototype.resetHandler=null,mxDefaultToolbar.prototype.spacing=4,mxDefaultToolbar.prototype.connectOnDrop=!1,mxDefaultToolbar.prototype.init=function(t){null!=t&&(this.toolbar=new mxToolbar(t),this.toolbar.addListener(mxEvent.SELECT,mxUtils.bind(this,function(t,e){var n=e.getProperty("function");this.editor.insertFunction=null!=n?mxUtils.bind(this,function(){n.apply(this,arguments),this.toolbar.resetMode()}):null})),this.resetHandler=mxUtils.bind(this,function(){null!=this.toolbar&&this.toolbar.resetMode(!0)}),this.editor.graph.addListener(mxEvent.DOUBLE_CLICK,this.resetHandler),this.editor.addListener(mxEvent.ESCAPE,this.resetHandler))},mxDefaultToolbar.prototype.addItem=function(t,e,n,i){var o=mxUtils.bind(this,function(){null!=n&&0<n.length&&this.editor.execute(n)});return this.toolbar.addItem(t,e,o,i)},mxDefaultToolbar.prototype.addSeparator=function(t){t=t||mxClient.imageBasePath+"/separator.gif",this.toolbar.addSeparator(t)},mxDefaultToolbar.prototype.addCombo=function(){return this.toolbar.addCombo()},mxDefaultToolbar.prototype.addActionCombo=function(t){return this.toolbar.addActionCombo(t)},mxDefaultToolbar.prototype.addActionOption=function(t,e,n){var i=mxUtils.bind(this,function(){this.editor.execute(n)});this.addOption(t,e,i)},mxDefaultToolbar.prototype.addOption=function(t,e,n){return this.toolbar.addOption(t,e,n)},mxDefaultToolbar.prototype.addMode=function(t,e,n,i,o){var r=mxUtils.bind(this,function(){this.editor.setMode(n),null!=o&&o(this.editor)});return this.toolbar.addSwitchMode(t,e,r,i)},mxDefaultToolbar.prototype.addPrototype=function(t,e,n,i,o,r){var s=function(){return"function"==typeof n?n():null!=n?n.clone():null},l=mxUtils.bind(this,function(t,e){"function"==typeof o?o(this.editor,s(),t,e):this.drop(s(),t,e),this.toolbar.resetMode(),mxEvent.consume(t)});return t=this.toolbar.addMode(t,e,l,i,null,r),this.installDropHandler(t,function(t,e,n){l(e,n)}),t},mxDefaultToolbar.prototype.drop=function(t,e,n){var i=this.editor.graph,o=i.getModel();if(null!=n&&!o.isEdge(n)&&this.connectOnDrop&&i.isCellConnectable(n))this.connect(t,e,n);else{for(;null!=n&&!i.isValidDropTarget(n,[t],e);)n=o.getParent(n);this.insert(t,e,n)}},mxDefaultToolbar.prototype.insert=function(t,e,n){var i=this.editor.graph;if(i.canImportCell(t)){var o=mxEvent.getClientX(e),r=mxEvent.getClientY(e),o=mxUtils.convertPoint(i.container,o,r);return i.isSplitEnabled()&&i.isSplitTarget(n,[t],e)?i.splitEdge(n,[t],null,o.x,o.y):this.editor.addVertex(n,t,o.x,o.y)}return null},mxDefaultToolbar.prototype.connect=function(t,e,n){e=this.editor.graph;var i=e.getModel();if(null!=n&&e.isCellConnectable(t)&&e.isEdgeValid(null,n,t)){var o=null;i.beginUpdate();try{var r=i.getGeometry(n),s=i.getGeometry(t).clone();s.x=r.x+(r.width-s.width)/2,s.y=r.y+(r.height-s.height)/2;var l=this.spacing*e.gridSize,a=20*i.getDirectedEdgeCount(n,!0);this.editor.horizontalFlow?s.x+=(s.width+r.width)/2+l+a:s.y+=(s.height+r.height)/2+l+a,t.setGeometry(s);var h=i.getParent(n);if(e.addCell(t,h),e.constrainChild(t),o=this.editor.createEdge(n,t),null==i.getGeometry(o)){var d=new mxGeometry;d.relative=!0,i.setGeometry(o,d)}e.addEdge(o,h,n,t)}finally{i.endUpdate()}e.setSelectionCells([t,o]),e.scrollCellToVisible(t)}},mxDefaultToolbar.prototype.installDropHandler=function(t,e){var n=document.createElement("img");n.setAttribute("src",t.getAttribute("src"));var i=mxUtils.bind(this,function(){n.style.width=2*t.offsetWidth+"px",n.style.height=2*t.offsetHeight+"px",mxUtils.makeDraggable(t,this.editor.graph,e,n),mxEvent.removeListener(n,"load",i)});mxClient.IS_IE?i():mxEvent.addListener(n,"load",i)},mxDefaultToolbar.prototype.destroy=function(){null!=this.resetHandler&&(this.editor.graph.removeListener("dblclick",this.resetHandler),this.editor.removeListener("escape",this.resetHandler),this.resetHandler=null),null!=this.toolbar&&(this.toolbar.destroy(),this.toolbar=null)},mxLoadResources&&mxResources.add(mxClient.basePath+"/resources/editor"),mxEditor.prototype=new mxEventSource,mxEditor.prototype.constructor=mxEditor,mxEditor.prototype.askZoomResource="none"!=mxClient.language?"askZoom":"",mxEditor.prototype.lastSavedResource="none"!=mxClient.language?"lastSaved":"",mxEditor.prototype.currentFileResource="none"!=mxClient.language?"currentFile":"",mxEditor.prototype.propertiesResource="none"!=mxClient.language?"properties":"",mxEditor.prototype.tasksResource="none"!=mxClient.language?"tasks":"",mxEditor.prototype.helpResource="none"!=mxClient.language?"help":"",mxEditor.prototype.outlineResource="none"!=mxClient.language?"outline":"",mxEditor.prototype.outline=null,mxEditor.prototype.graph=null,mxEditor.prototype.graphRenderHint=null,mxEditor.prototype.toolbar=null,mxEditor.prototype.session=null,mxEditor.prototype.status=null,mxEditor.prototype.popupHandler=null,mxEditor.prototype.undoManager=null,mxEditor.prototype.keyHandler=null,mxEditor.prototype.actions=null,mxEditor.prototype.dblClickAction="edit",mxEditor.prototype.swimlaneRequired=!1,mxEditor.prototype.disableContextMenu=!0,mxEditor.prototype.insertFunction=null,mxEditor.prototype.forcedInserting=!1,mxEditor.prototype.templates=null,mxEditor.prototype.defaultEdge=null,mxEditor.prototype.defaultEdgeStyle=null,mxEditor.prototype.defaultGroup=null,mxEditor.prototype.groupBorderSize=null,mxEditor.prototype.filename=null,mxEditor.prototype.linefeed="&#xa;",mxEditor.prototype.postParameterName="xml",mxEditor.prototype.escapePostData=!0,mxEditor.prototype.urlPost=null,mxEditor.prototype.urlImage=null,mxEditor.prototype.urlInit=null,mxEditor.prototype.urlNotify=null,mxEditor.prototype.urlPoll=null,mxEditor.prototype.horizontalFlow=!1,mxEditor.prototype.layoutDiagram=!1,mxEditor.prototype.swimlaneSpacing=0,mxEditor.prototype.maintainSwimlanes=!1,mxEditor.prototype.layoutSwimlanes=!1,mxEditor.prototype.cycleAttributeValues=null,mxEditor.prototype.cycleAttributeIndex=0,mxEditor.prototype.cycleAttributeName="fillColor",mxEditor.prototype.tasks=null,mxEditor.prototype.tasksWindowImage=null,mxEditor.prototype.tasksTop=20,mxEditor.prototype.help=null,mxEditor.prototype.helpWindowImage=null,mxEditor.prototype.urlHelp=null,mxEditor.prototype.helpWidth=300,mxEditor.prototype.helpHeight=260,mxEditor.prototype.propertiesWidth=240,mxEditor.prototype.propertiesHeight=null,mxEditor.prototype.movePropertiesDialog=!1,mxEditor.prototype.validating=!1,mxEditor.prototype.modified=!1,mxEditor.prototype.isModified=function(){return this.modified},mxEditor.prototype.setModified=function(t){this.modified=t},mxEditor.prototype.addActions=function(){this.addAction("save",function(t){t.save()}),this.addAction("print",function(t){new mxPrintPreview(t.graph,1).open()}),this.addAction("show",function(t){mxUtils.show(t.graph,null,10,10)}),this.addAction("exportImage",function(t){var e=t.getUrlImage();if(null==e||mxClient.IS_LOCAL)t.execute("show");else{var n=mxUtils.getViewXml(t.graph,1),n=mxUtils.getXml(n,"\n");mxUtils.submit(e,t.postParameterName+"="+encodeURIComponent(n),document,"_blank")}}),this.addAction("refresh",function(t){t.graph.refresh()}),this.addAction("cut",function(t){t.graph.isEnabled()&&mxClipboard.cut(t.graph)}),this.addAction("copy",function(t){t.graph.isEnabled()&&mxClipboard.copy(t.graph)}),this.addAction("paste",function(t){t.graph.isEnabled()&&mxClipboard.paste(t.graph)}),this.addAction("delete",function(t){t.graph.isEnabled()&&t.graph.removeCells()}),this.addAction("group",function(t){t.graph.isEnabled()&&t.graph.setSelectionCell(t.groupCells())}),this.addAction("ungroup",function(t){t.graph.isEnabled()&&t.graph.setSelectionCells(t.graph.ungroupCells())}),this.addAction("removeFromParent",function(t){t.graph.isEnabled()&&t.graph.removeCellsFromParent()}),this.addAction("undo",function(t){t.graph.isEnabled()&&t.undo()}),this.addAction("redo",function(t){t.graph.isEnabled()&&t.redo()}),this.addAction("zoomIn",function(t){t.graph.zoomIn()}),this.addAction("zoomOut",function(t){t.graph.zoomOut()}),this.addAction("actualSize",function(t){t.graph.zoomActual()}),this.addAction("fit",function(t){t.graph.fit()}),this.addAction("showProperties",function(t,e){t.showProperties(e)}),this.addAction("selectAll",function(t){t.graph.isEnabled()&&t.graph.selectAll()}),this.addAction("selectNone",function(t){t.graph.isEnabled()&&t.graph.clearSelection()}),this.addAction("selectVertices",function(t){t.graph.isEnabled()&&t.graph.selectVertices()}),this.addAction("selectEdges",function(t){t.graph.isEnabled()&&t.graph.selectEdges()}),this.addAction("edit",function(t,e){t.graph.isEnabled()&&t.graph.isCellEditable(e)&&t.graph.startEditingAtCell(e)}),this.addAction("toBack",function(t){t.graph.isEnabled()&&t.graph.orderCells(!0)}),this.addAction("toFront",function(t){t.graph.isEnabled()&&t.graph.orderCells(!1)}),this.addAction("enterGroup",function(t,e){t.graph.enterGroup(e)}),this.addAction("exitGroup",function(t){t.graph.exitGroup()}),this.addAction("home",function(t){t.graph.home()}),this.addAction("selectPrevious",function(t){t.graph.isEnabled()&&t.graph.selectPreviousCell()}),this.addAction("selectNext",function(t){t.graph.isEnabled()&&t.graph.selectNextCell()}),this.addAction("selectParent",function(t){t.graph.isEnabled()&&t.graph.selectParentCell()}),this.addAction("selectChild",function(t){t.graph.isEnabled()&&t.graph.selectChildCell()}),this.addAction("collapse",function(t){t.graph.isEnabled()&&t.graph.foldCells(!0)}),this.addAction("collapseAll",function(t){if(t.graph.isEnabled()){var e=t.graph.getChildVertices();t.graph.foldCells(!0,!1,e)}}),this.addAction("expand",function(t){t.graph.isEnabled()&&t.graph.foldCells(!1)}),this.addAction("expandAll",function(t){if(t.graph.isEnabled()){var e=t.graph.getChildVertices();t.graph.foldCells(!1,!1,e)}}),this.addAction("bold",function(t){t.graph.isEnabled()&&t.graph.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,mxConstants.FONT_BOLD)}),this.addAction("italic",function(t){t.graph.isEnabled()&&t.graph.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,mxConstants.FONT_ITALIC)}),this.addAction("underline",function(t){t.graph.isEnabled()&&t.graph.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,mxConstants.FONT_UNDERLINE)}),this.addAction("shadow",function(t){t.graph.isEnabled()&&t.graph.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,mxConstants.FONT_SHADOW)}),this.addAction("alignCellsLeft",function(t){t.graph.isEnabled()&&t.graph.alignCells(mxConstants.ALIGN_LEFT)}),this.addAction("alignCellsCenter",function(t){t.graph.isEnabled()&&t.graph.alignCells(mxConstants.ALIGN_CENTER)}),this.addAction("alignCellsRight",function(t){t.graph.isEnabled()&&t.graph.alignCells(mxConstants.ALIGN_RIGHT)}),this.addAction("alignCellsTop",function(t){t.graph.isEnabled()&&t.graph.alignCells(mxConstants.ALIGN_TOP)}),this.addAction("alignCellsMiddle",function(t){t.graph.isEnabled()&&t.graph.alignCells(mxConstants.ALIGN_MIDDLE)}),this.addAction("alignCellsBottom",function(t){t.graph.isEnabled()&&t.graph.alignCells(mxConstants.ALIGN_BOTTOM)}),this.addAction("alignFontLeft",function(t){t.graph.setCellStyles(mxConstants.STYLE_ALIGN,mxConstants.ALIGN_LEFT)}),this.addAction("alignFontCenter",function(t){t.graph.isEnabled()&&t.graph.setCellStyles(mxConstants.STYLE_ALIGN,mxConstants.ALIGN_CENTER)}),this.addAction("alignFontRight",function(t){t.graph.isEnabled()&&t.graph.setCellStyles(mxConstants.STYLE_ALIGN,mxConstants.ALIGN_RIGHT)}),this.addAction("alignFontTop",function(t){t.graph.isEnabled()&&t.graph.setCellStyles(mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_TOP)}),this.addAction("alignFontMiddle",function(t){t.graph.isEnabled()&&t.graph.setCellStyles(mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_MIDDLE)}),this.addAction("alignFontBottom",function(t){t.graph.isEnabled()&&t.graph.setCellStyles(mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_BOTTOM)}),this.addAction("zoom",function(t){var e=100*t.graph.getView().scale,e=parseFloat(mxUtils.prompt(mxResources.get(t.askZoomResource)||t.askZoomResource,e))/100;isNaN(e)||t.graph.getView().setScale(e)}),this.addAction("toggleTasks",function(t){null!=t.tasks?t.tasks.setVisible(!t.tasks.isVisible()):t.showTasks()}),this.addAction("toggleHelp",function(t){null!=t.help?t.help.setVisible(!t.help.isVisible()):t.showHelp()}),this.addAction("toggleOutline",function(t){null==t.outline?t.showOutline():t.outline.setVisible(!t.outline.isVisible())}),this.addAction("toggleConsole",function(){mxLog.setVisible(!mxLog.isVisible())})},mxEditor.prototype.createSession=function(){var t=mxUtils.bind(this,function(t){this.fireEvent(new mxEventObject(mxEvent.SESSION,"session",t))});return this.connect(this.urlInit,this.urlPoll,this.urlNotify,t)},mxEditor.prototype.configure=function(t){null!=t&&(new mxCodec(t.ownerDocument).decode(t,this),this.resetHistory())},mxEditor.prototype.resetFirstTime=function(){document.cookie="mxgraph=seen; expires=Fri, 27 Jul 2001 02:47:11 UTC; path=/"},mxEditor.prototype.resetHistory=function(){this.lastSnapshot=(new Date).getTime(),this.undoManager.clear(),this.ignoredChanges=0,this.setModified(!1)},mxEditor.prototype.addAction=function(t,e){this.actions[t]=e},mxEditor.prototype.execute=function(t){var e=this.actions[t];if(null!=e)try{var n=arguments;n[0]=this,e.apply(this,n)}catch(i){throw mxUtils.error("Cannot execute "+t+": "+i.message,280,!0),i}else mxUtils.error("Cannot find action "+t,280,!0)},mxEditor.prototype.addTemplate=function(t,e){this.templates[t]=e},mxEditor.prototype.getTemplate=function(t){return this.templates[t]},mxEditor.prototype.createGraph=function(){var t=new mxGraph(null,null,this.graphRenderHint);return t.setTooltips(!0),t.setPanning(!0),this.installDblClickHandler(t),this.installUndoHandler(t),this.installDrillHandler(t),this.installChangeHandler(t),this.installInsertHandler(t),t.panningHandler.factoryMethod=mxUtils.bind(this,function(t,e,n){return this.createPopupMenu(t,e,n)}),t.connectionHandler.factoryMethod=mxUtils.bind(this,function(t,e){return this.createEdge(t,e)}),this.createSwimlaneManager(t),this.createLayoutManager(t),t},mxEditor.prototype.createSwimlaneManager=function(t){return t=new mxSwimlaneManager(t,!1),t.isHorizontal=mxUtils.bind(this,function(){return this.horizontalFlow}),t.isEnabled=mxUtils.bind(this,function(){return this.maintainSwimlanes}),t},mxEditor.prototype.createLayoutManager=function(t){var e=new mxLayoutManager(t),n=this;return e.getLayout=function(e){var i=null,o=n.graph.getModel();return null!=o.getParent(e)&&(n.layoutSwimlanes&&t.isSwimlane(e)?(null==n.swimlaneLayout&&(n.swimlaneLayout=n.createSwimlaneLayout()),i=n.swimlaneLayout):n.layoutDiagram&&(t.isValidRoot(e)||null==o.getParent(o.getParent(e)))&&(null==n.diagramLayout&&(n.diagramLayout=n.createDiagramLayout()),i=n.diagramLayout)),i},e},mxEditor.prototype.setGraphContainer=function(t){null==this.graph.container&&(this.graph.init(t),this.rubberband=new mxRubberband(this.graph),this.disableContextMenu&&mxEvent.disableContextMenu(t),mxClient.IS_QUIRKS&&new mxDivResizer(t))},mxEditor.prototype.installDblClickHandler=function(t){t.addListener(mxEvent.DOUBLE_CLICK,mxUtils.bind(this,function(e,n){var i=n.getProperty("cell");null!=i&&t.isEnabled()&&null!=this.dblClickAction&&(this.execute(this.dblClickAction,i),n.consume())}))},mxEditor.prototype.installUndoHandler=function(t){var e=mxUtils.bind(this,function(t,e){var n=e.getProperty("edit");this.undoManager.undoableEditHappened(n)});t.getModel().addListener(mxEvent.UNDO,e),t.getView().addListener(mxEvent.UNDO,e),e=function(e,n){var i=n.getProperty("edit").changes;t.setSelectionCells(t.getSelectionCellsForChanges(i))},this.undoManager.addListener(mxEvent.UNDO,e),this.undoManager.addListener(mxEvent.REDO,e)},mxEditor.prototype.installDrillHandler=function(t){var e=mxUtils.bind(this,function(){this.fireEvent(new mxEventObject(mxEvent.ROOT))});t.getView().addListener(mxEvent.DOWN,e),t.getView().addListener(mxEvent.UP,e)},mxEditor.prototype.installChangeHandler=function(t){var e=mxUtils.bind(this,function(e,n){this.setModified(!0),1==this.validating&&t.validateGraph();for(var i=n.getProperty("edit").changes,o=0;o<i.length;o++){var r=i[o];if(r instanceof mxRootChange||r instanceof mxValueChange&&r.cell==this.graph.model.root||r instanceof mxCellAttributeChange&&r.cell==this.graph.model.root){this.fireEvent(new mxEventObject(mxEvent.ROOT));break}}});t.getModel().addListener(mxEvent.CHANGE,e)},mxEditor.prototype.installInsertHandler=function(t){var e=this;t.addMouseListener({mouseDown:function(t,n){null==e.insertFunction||n.isPopupTrigger()||!e.forcedInserting&&null!=n.getState()||(e.graph.clearSelection(),e.insertFunction(n.getEvent(),n.getCell()),this.isActive=!0,n.consume())},mouseMove:function(t,e){this.isActive&&e.consume()},mouseUp:function(t,e){this.isActive&&(this.isActive=!1,e.consume())}})},mxEditor.prototype.createDiagramLayout=function(){var t=this.graph.gridSize,e=new mxStackLayout(this.graph,!this.horizontalFlow,this.swimlaneSpacing,2*t,2*t);return e.isVertexIgnored=function(t){return!e.graph.isSwimlane(t)},e},mxEditor.prototype.createSwimlaneLayout=function(){return new mxCompactTreeLayout(this.graph,this.horizontalFlow)},mxEditor.prototype.createToolbar=function(){return new mxDefaultToolbar(null,this)},mxEditor.prototype.setToolbarContainer=function(t){this.toolbar.init(t),mxClient.IS_QUIRKS&&new mxDivResizer(t)},mxEditor.prototype.setStatusContainer=function(t){null==this.status&&(this.status=t,this.addListener(mxEvent.SAVE,mxUtils.bind(this,function(){var t=(new Date).toLocaleString();this.setStatus((mxResources.get(this.lastSavedResource)||this.lastSavedResource)+": "+t)})),this.addListener(mxEvent.OPEN,mxUtils.bind(this,function(){this.setStatus((mxResources.get(this.currentFileResource)||this.currentFileResource)+": "+this.filename)})),mxClient.IS_QUIRKS&&new mxDivResizer(t))},mxEditor.prototype.setStatus=function(t){null!=this.status&&null!=t&&(this.status.innerHTML=t)},mxEditor.prototype.setTitleContainer=function(t){this.addListener(mxEvent.ROOT,mxUtils.bind(this,function(){t.innerHTML=this.getTitle()})),mxClient.IS_QUIRKS&&new mxDivResizer(t)},mxEditor.prototype.treeLayout=function(t,e){null!=t&&new mxCompactTreeLayout(this.graph,e).execute(t)},mxEditor.prototype.getTitle=function(){for(var t="",e=this.graph,n=e.getCurrentRoot();null!=n&&null!=e.getModel().getParent(e.getModel().getParent(n));)e.isValidRoot(n)&&(t=" > "+e.convertValueToString(n)+t),n=e.getModel().getParent(n);return this.getRootTitle()+t},mxEditor.prototype.getRootTitle=function(){var t=this.graph.getModel().getRoot();return this.graph.convertValueToString(t)},mxEditor.prototype.undo=function(){this.undoManager.undo()},mxEditor.prototype.redo=function(){this.undoManager.redo()},mxEditor.prototype.groupCells=function(){var t=null!=this.groupBorderSize?this.groupBorderSize:this.graph.gridSize;return this.graph.groupCells(this.createGroup(),t)},mxEditor.prototype.createGroup=function(){return this.graph.getModel().cloneCell(this.defaultGroup)},mxEditor.prototype.open=function(t){if(null!=t){var e=mxUtils.load(t).getXml();this.readGraphModel(e.documentElement),this.filename=t,this.fireEvent(new mxEventObject(mxEvent.OPEN,"filename",t))}},mxEditor.prototype.readGraphModel=function(t){new mxCodec(t.ownerDocument).decode(t,this.graph.getModel()),this.resetHistory()},mxEditor.prototype.save=function(t,e){if(t=t||this.getUrlPost(),null!=t&&0<t.length){var n=this.writeGraphModel(e);this.postDiagram(t,n),this.setModified(!1)}this.fireEvent(new mxEventObject(mxEvent.SAVE,"url",t))},mxEditor.prototype.postDiagram=function(t,e){this.escapePostData&&(e=encodeURIComponent(e)),mxUtils.post(t,this.postParameterName+"="+e,mxUtils.bind(this,function(n){this.fireEvent(new mxEventObject(mxEvent.POST,"request",n,"url",t,"data",e))}))},mxEditor.prototype.writeGraphModel=function(t){t=null!=t?t:this.linefeed;var e=(new mxCodec).encode(this.graph.getModel());return mxUtils.getXml(e,t)},mxEditor.prototype.getUrlPost=function(){return this.urlPost},mxEditor.prototype.getUrlImage=function(){return this.urlImage},mxEditor.prototype.connect=function(t,e,n,i){var o=null;return mxClient.IS_LOCAL||(o=new mxSession(this.graph.getModel(),t,e,n),o.addListener(mxEvent.RECEIVE,mxUtils.bind(this,function(t,e){null!=e.getProperty("node").getAttribute("namespace")&&this.resetHistory()})),o.addListener(mxEvent.DISCONNECT,i),o.addListener(mxEvent.CONNECT,i),o.addListener(mxEvent.NOTIFY,i),o.addListener(mxEvent.GET,i),o.start()),o},mxEditor.prototype.swapStyles=function(t,e){var n=this.graph.getStylesheet().styles[e];this.graph.getView().getStylesheet().putCellStyle(e,this.graph.getStylesheet().styles[t]),this.graph.getStylesheet().putCellStyle(t,n),this.graph.refresh()},mxEditor.prototype.showProperties=function(t){if(t=t||this.graph.getSelectionCell(),null==t&&(t=this.graph.getCurrentRoot(),null==t&&(t=this.graph.getModel().getRoot())),null!=t){this.graph.stopEditing(!0);var e=mxUtils.getOffset(this.graph.container),n=e.x+10,e=e.y;if(null==this.properties||this.movePropertiesDialog){var i=this.graph.getCellBounds(t);null!=i&&(n+=i.x+Math.min(200,i.width),e+=i.y)}else n=this.properties.getX(),e=this.properties.getY();this.hideProperties(),t=this.createProperties(t),null!=t&&(this.properties=new mxWindow(mxResources.get(this.propertiesResource)||this.propertiesResource,t,n,e,this.propertiesWidth,this.propertiesHeight,!1),this.properties.setVisible(!0))}},mxEditor.prototype.isPropertiesVisible=function(){return null!=this.properties},mxEditor.prototype.createProperties=function(t){var e=this.graph.getModel(),n=e.getValue(t);if(mxUtils.isNode(n)){var i=new mxForm("properties");i.addText("ID",t.getId()).setAttribute("readonly","true");var o=null,r=null,s=null,l=null,a=null;e.isVertex(t)&&(o=e.getGeometry(t),null!=o&&(r=i.addText("top",o.y),s=i.addText("left",o.x),l=i.addText("width",o.width),a=i.addText("height",o.height)));for(var h=e.getStyle(t),d=i.addText("Style",h||""),u=n.attributes,c=[],n=0;n<u.length;n++)c[n]=i.addTextarea(u[n].nodeName,u[n].nodeValue,"label"==u[n].nodeName?4:2);return n=mxUtils.bind(this,function(){this.hideProperties(),e.beginUpdate();try{null!=o&&(o=o.clone(),o.x=parseFloat(s.value),o.y=parseFloat(r.value),o.width=parseFloat(l.value),o.height=parseFloat(a.value),e.setGeometry(t,o)),0<d.value.length?e.setStyle(t,d.value):e.setStyle(t,null);for(var n=0;n<u.length;n++){var i=new mxCellAttributeChange(t,u[n].nodeName,c[n].value);e.execute(i)}this.graph.isAutoSizeCell(t)&&this.graph.updateCellSize(t)}finally{e.endUpdate()}}),h=mxUtils.bind(this,function(){this.hideProperties()}),i.addButtons(n,h),i.table}return null},mxEditor.prototype.hideProperties=function(){null!=this.properties&&(this.properties.destroy(),this.properties=null)},mxEditor.prototype.showTasks=function(){if(null==this.tasks){var t=document.createElement("div");t.style.padding="4px",t.style.paddingLeft="20px";var e=document.body.clientWidth,e=new mxWindow(mxResources.get(this.tasksResource)||this.tasksResource,t,e-220,this.tasksTop,200);e.setClosable(!0),e.destroyOnClose=!1;var n=mxUtils.bind(this,function(){mxEvent.release(t),t.innerHTML="",this.createTasks(t)});this.graph.getModel().addListener(mxEvent.CHANGE,n),this.graph.getSelectionModel().addListener(mxEvent.CHANGE,n),this.graph.addListener(mxEvent.ROOT,n),null!=this.tasksWindowImage&&e.setImage(this.tasksWindowImage),this.tasks=e,this.createTasks(t)}this.tasks.setVisible(!0)},mxEditor.prototype.refreshTasks=function(t){null!=this.tasks&&(t=this.tasks.content,mxEvent.release(t),t.innerHTML="",this.createTasks(t))},mxEditor.prototype.createTasks=function(){},mxEditor.prototype.showHelp=function(t){if(null==this.help){var e=document.createElement("iframe");e.setAttribute("src",mxResources.get("urlHelp")||this.urlHelp),e.setAttribute("height","100%"),e.setAttribute("width","100%"),e.setAttribute("frameBorder","0"),e.style.backgroundColor="white",t=document.body.clientWidth;var n=document.body.clientHeight||document.documentElement.clientHeight,i=new mxWindow(mxResources.get(this.helpResource)||this.helpResource,e,(t-this.helpWidth)/2,(n-this.helpHeight)/3,this.helpWidth,this.helpHeight);i.setMaximizable(!0),i.setClosable(!0),i.destroyOnClose=!1,i.setResizable(!0),null!=this.helpWindowImage&&i.setImage(this.helpWindowImage),mxClient.IS_NS&&(t=function(){e.setAttribute("height",i.div.offsetHeight-26+"px")},i.addListener(mxEvent.RESIZE_END,t),i.addListener(mxEvent.MAXIMIZE,t),i.addListener(mxEvent.NORMALIZE,t),i.addListener(mxEvent.SHOW,t)),this.help=i}this.help.setVisible(!0)},mxEditor.prototype.showOutline=function(){if(null==this.outline){var t=document.createElement("div");t.style.overflow="hidden",t.style.width="100%",t.style.height="100%",t.style.background="white",t.style.cursor="move";var e=new mxWindow(mxResources.get(this.outlineResource)||this.outlineResource,t,600,480,200,200,!1),n=new mxOutline(this.graph,t);e.setClosable(!0),e.setResizable(!0),e.destroyOnClose=!1,e.addListener(mxEvent.RESIZE_END,function(){n.update()}),this.outline=e,this.outline.outline=n}this.outline.setVisible(!0),this.outline.outline.update(!0)},mxEditor.prototype.setMode=function(t){"select"==t?(this.graph.panningHandler.useLeftButtonForPanning=!1,this.graph.setConnectable(!1)):"connect"==t?(this.graph.panningHandler.useLeftButtonForPanning=!1,this.graph.setConnectable(!0)):"pan"==t&&(this.graph.panningHandler.useLeftButtonForPanning=!0,this.graph.setConnectable(!1))},mxEditor.prototype.createPopupMenu=function(t,e,n){this.popupHandler.createMenu(this,t,e,n)},mxEditor.prototype.createEdge=function(){var t=null;if(null!=this.defaultEdge)t=this.graph.getModel().cloneCell(this.defaultEdge);else{t=new mxCell(""),t.setEdge(!0);var e=new mxGeometry;e.relative=!0,t.setGeometry(e)}return e=this.getEdgeStyle(),null!=e&&t.setStyle(e),t},mxEditor.prototype.getEdgeStyle=function(){return this.defaultEdgeStyle},mxEditor.prototype.consumeCycleAttribute=function(t){return null!=this.cycleAttributeValues&&0<this.cycleAttributeValues.length&&this.graph.isSwimlane(t)?this.cycleAttributeValues[this.cycleAttributeIndex++%this.cycleAttributeValues.length]:null},mxEditor.prototype.cycleAttribute=function(t){if(null!=this.cycleAttributeName){var e=this.consumeCycleAttribute(t);null!=e&&t.setStyle(t.getStyle()+";"+this.cycleAttributeName+"="+e)}},mxEditor.prototype.addVertex=function(t,e,n,i){for(var o=this.graph.getModel();null!=t&&!this.graph.isValidDropTarget(t);)t=o.getParent(t);t=null!=t?t:this.graph.getSwimlaneAt(n,i);var r=this.graph.getView().scale,s=o.getGeometry(e),l=o.getGeometry(t);if(this.graph.isSwimlane(e)&&!this.graph.swimlaneNesting)t=null;else{if(null==t&&this.swimlaneRequired)return null;if(null!=t&&null!=l){var a=this.graph.getView().getState(t);if(null!=a){if(n-=a.origin.x*r,i-=a.origin.y*r,this.graph.isConstrainedMoving){var l=s.width,h=s.height,d=a.x+a.width;n+l>d&&(n-=n+l-d),d=a.y+a.height,i+h>d&&(i-=i+h-d)}}else null!=l&&(n-=l.x*r,i-=l.y*r)}}s=s.clone(),s.x=this.graph.snap(n/r-this.graph.getView().translate.x-this.graph.gridSize/2),s.y=this.graph.snap(i/r-this.graph.getView().translate.y-this.graph.gridSize/2),e.setGeometry(s),null==t&&(t=this.graph.getDefaultParent()),this.cycleAttribute(e),this.fireEvent(new mxEventObject(mxEvent.BEFORE_ADD_VERTEX,"vertex",e,"parent",t)),o.beginUpdate();try{e=this.graph.addCell(e,t),null!=e&&(this.graph.constrainChild(e),this.fireEvent(new mxEventObject(mxEvent.ADD_VERTEX,"vertex",e)))
}finally{o.endUpdate()}return null!=e&&(this.graph.setSelectionCell(e),this.graph.scrollCellToVisible(e),this.fireEvent(new mxEventObject(mxEvent.AFTER_ADD_VERTEX,"vertex",e))),e},mxEditor.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,null!=this.tasks&&this.tasks.destroy(),null!=this.outline&&this.outline.destroy(),null!=this.properties&&this.properties.destroy(),null!=this.keyHandler&&this.keyHandler.destroy(),null!=this.rubberband&&this.rubberband.destroy(),null!=this.toolbar&&this.toolbar.destroy(),null!=this.graph&&this.graph.destroy(),this.templates=this.status=null)};var mxCodecRegistry={codecs:[],aliases:[],register:function(t){if(null!=t){var e=t.getName();mxCodecRegistry.codecs[e]=t;var n=mxUtils.getFunctionName(t.template.constructor);n!=e&&mxCodecRegistry.addAlias(n,e)}return t},addAlias:function(t,e){mxCodecRegistry.aliases[t]=e},getCodec:function(t){var e=null;if(null!=t){var e=mxUtils.getFunctionName(t),n=mxCodecRegistry.aliases[e];if(null!=n&&(e=n),e=mxCodecRegistry.codecs[e],null==e)try{e=new mxObjectCodec(new t),mxCodecRegistry.register(e)}catch(i){}}return e}};mxCodec.prototype.document=null,mxCodec.prototype.objects=null,mxCodec.prototype.encodeDefaults=!1,mxCodec.prototype.putObject=function(t,e){return this.objects[t]=e},mxCodec.prototype.getObject=function(t){var e=null;return null!=t&&(e=this.objects[t],null==e&&(e=this.lookup(t),null==e&&(t=this.getElementById(t),null!=t&&(e=this.decode(t))))),e},mxCodec.prototype.lookup=function(){return null},mxCodec.prototype.getElementById=function(t,e){return mxUtils.findNodeByAttribute(this.document.documentElement,null!=e?e:"id",t)},mxCodec.prototype.getId=function(t){var e=null;return null!=t&&(e=this.reference(t),null==e&&t instanceof mxCell&&(e=t.getId(),null==e&&(e=mxCellPath.create(t),0==e.length&&(e="root")))),e},mxCodec.prototype.reference=function(){return null},mxCodec.prototype.encode=function(t){var e=null;if(null!=t&&null!=t.constructor){var n=mxCodecRegistry.getCodec(t.constructor);null!=n?e=n.encode(this,t):mxUtils.isNode(t)?e=mxClient.IS_IE?t.cloneNode(!0):this.document.importNode(t,!0):mxLog.warn("mxCodec.encode: No codec for "+mxUtils.getFunctionName(t.constructor))}return e},mxCodec.prototype.decode=function(a,b){var c=null;if(null!=a&&a.nodeType==mxConstants.NODETYPE_ELEMENT){var d=null;try{d=eval(a.nodeName)}catch(e){}try{var f=mxCodecRegistry.getCodec(d);null!=f?c=f.decode(this,a,b):(c=a.cloneNode(!0),c.removeAttribute("as"))}catch(g){mxLog.debug("Cannot decode "+a.nodeName+": "+g.message)}}return c},mxCodec.prototype.encodeCell=function(t,e,n){if(e.appendChild(this.encode(t)),null==n||n){n=t.getChildCount();for(var i=0;n>i;i++)this.encodeCell(t.getChildAt(i),e)}},mxCodec.prototype.isCellCodec=function(t){return null!=t&&"function"==typeof t.isCellCodec?t.isCellCodec():!1},mxCodec.prototype.decodeCell=function(t,e){e=null!=e?e:!0;var n=null;if(null!=t&&t.nodeType==mxConstants.NODETYPE_ELEMENT){if(n=mxCodecRegistry.getCodec(t.nodeName),!this.isCellCodec(n))for(var i=t.firstChild;null!=i&&!this.isCellCodec(n);)n=mxCodecRegistry.getCodec(i.nodeName),i=i.nextSibling;this.isCellCodec(n)||(n=mxCodecRegistry.getCodec(mxCell)),n=n.decode(this,t),e&&this.insertIntoGraph(n)}return n},mxCodec.prototype.insertIntoGraph=function(t){var e=t.parent,n=t.getTerminal(!0),i=t.getTerminal(!1);t.setTerminal(null,!1),t.setTerminal(null,!0),t.parent=null,null!=e&&e.insert(t),null!=n&&n.insertEdge(t,!0),null!=i&&i.insertEdge(t,!1)},mxCodec.prototype.setAttribute=function(t,e,n){null!=e&&null!=n&&t.setAttribute(e,n)},mxObjectCodec.prototype.template=null,mxObjectCodec.prototype.exclude=null,mxObjectCodec.prototype.idrefs=null,mxObjectCodec.prototype.mapping=null,mxObjectCodec.prototype.reverse=null,mxObjectCodec.prototype.getName=function(){return mxUtils.getFunctionName(this.template.constructor)},mxObjectCodec.prototype.cloneTemplate=function(){return new this.template.constructor},mxObjectCodec.prototype.getFieldName=function(t){if(null!=t){var e=this.reverse[t];null!=e&&(t=e)}return t},mxObjectCodec.prototype.getAttributeName=function(t){if(null!=t){var e=this.mapping[t];null!=e&&(t=e)}return t},mxObjectCodec.prototype.isExcluded=function(t,e){return e==mxObjectIdentity.FIELD_NAME||0<=mxUtils.indexOf(this.exclude,e)},mxObjectCodec.prototype.isReference=function(t,e){return 0<=mxUtils.indexOf(this.idrefs,e)},mxObjectCodec.prototype.encode=function(t,e){var n=t.document.createElement(this.getName());return e=this.beforeEncode(t,e,n),this.encodeObject(t,e,n),this.afterEncode(t,e,n)},mxObjectCodec.prototype.encodeObject=function(t,e,n){t.setAttribute(n,"id",t.getId(e));for(var i in e){var o=i,r=e[o];null!=r&&!this.isExcluded(e,o,r,!0)&&(mxUtils.isNumeric(o)&&(o=null),this.encodeValue(t,e,o,r,n))}},mxObjectCodec.prototype.encodeValue=function(t,e,n,i,o){if(null!=i){if(this.isReference(e,n,i,!0)){var r=t.getId(i);if(null==r)return mxLog.warn("mxObjectCodec.encode: No ID for "+this.getName()+"."+n+"="+i),void 0;i=r}r=this.template[n],(null==n||t.encodeDefaults||r!=i)&&(n=this.getAttributeName(n),this.writeAttribute(t,e,n,i,o))}},mxObjectCodec.prototype.writeAttribute=function(t,e,n,i,o){"object"!=typeof i?this.writePrimitiveAttribute(t,e,n,i,o):this.writeComplexAttribute(t,e,n,i,o)},mxObjectCodec.prototype.writePrimitiveAttribute=function(t,e,n,i,o){i=this.convertValueToXml(i),null==n?(e=t.document.createElement("add"),"function"==typeof i?e.appendChild(t.document.createTextNode(i)):t.setAttribute(e,"value",i),o.appendChild(e)):"function"!=typeof i&&t.setAttribute(o,n,i)},mxObjectCodec.prototype.writeComplexAttribute=function(t,e,n,i,o){t=t.encode(i),null!=t?(null!=n&&t.setAttribute("as",n),o.appendChild(t)):mxLog.warn("mxObjectCodec.encode: No node for "+this.getName()+"."+n+": "+i)},mxObjectCodec.prototype.convertValueToXml=function(t){return"undefined"!=typeof t.length||1!=t&&0!=t||(t=1==t?"1":"0"),t},mxObjectCodec.prototype.convertValueFromXml=function(t){return mxUtils.isNumeric(t)&&(t=parseFloat(t)),t},mxObjectCodec.prototype.beforeEncode=function(t,e){return e},mxObjectCodec.prototype.afterEncode=function(t,e,n){return n},mxObjectCodec.prototype.decode=function(t,e,n){var i=e.getAttribute("id"),o=t.objects[i];return null==o&&(o=n||this.cloneTemplate(),null!=i&&t.putObject(i,o)),e=this.beforeDecode(t,e,o),this.decodeNode(t,e,o),this.afterDecode(t,e,o)},mxObjectCodec.prototype.decodeNode=function(t,e,n){null!=e&&(this.decodeAttributes(t,e,n),this.decodeChildren(t,e,n))},mxObjectCodec.prototype.decodeAttributes=function(t,e,n){if(e=e.attributes,null!=e)for(var i=0;i<e.length;i++)this.decodeAttribute(t,e[i],n)},mxObjectCodec.prototype.decodeAttribute=function(t,e,n){var i=e.nodeName;if("as"!=i&&"id"!=i){e=this.convertValueFromXml(e.nodeValue);var o=this.getFieldName(i);if(this.isReference(n,o,e,!1)){if(t=t.getObject(e),null==t)return mxLog.warn("mxObjectCodec.decode: No object for "+this.getName()+"."+i+"="+e),void 0;e=t}this.isExcluded(n,i,e,!1)||(n[i]=e)}},mxObjectCodec.prototype.decodeChildren=function(t,e,n){for(e=e.firstChild;null!=e;){var i=e.nextSibling;e.nodeType==mxConstants.NODETYPE_ELEMENT&&!this.processInclude(t,e,n)&&this.decodeChild(t,e,n),e=i}},mxObjectCodec.prototype.decodeChild=function(t,e,n){var i=this.getFieldName(e.getAttribute("as"));if(null==i||!this.isExcluded(n,i,e,!1)){var o=this.getFieldTemplate(n,i,e),r=null;"add"==e.nodeName?(r=e.getAttribute("value"),null==r&&(r=mxUtils.eval(mxUtils.getTextContent(e)))):r=t.decode(e,o),this.addObjectValue(n,i,r,o)}},mxObjectCodec.prototype.getFieldTemplate=function(t,e){return t=t[e],t instanceof Array&&0<t.length&&(t=null),t},mxObjectCodec.prototype.addObjectValue=function(t,e,n,i){null!=n&&n!=i&&(null!=e&&0<e.length?t[e]=n:t.push(n))},mxObjectCodec.prototype.processInclude=function(t,e,n){if("include"==e.nodeName){if(e=e.getAttribute("name"),null!=e)try{var i=mxUtils.load(e).getDocumentElement();null!=i&&t.decode(i,n)}catch(o){}return!0}return!1},mxObjectCodec.prototype.beforeDecode=function(t,e){return e},mxObjectCodec.prototype.afterDecode=function(t,e,n){return n},mxCodecRegistry.register(function(){var t=new mxObjectCodec(new mxCell,["children","edges","overlays","mxTransient"],["parent","source","target"]);return t.isCellCodec=function(){return!0},t.isExcluded=function(t,e,n,i){return mxObjectCodec.prototype.isExcluded.apply(this,arguments)||i&&"value"==e&&n.nodeType==mxConstants.NODETYPE_ELEMENT},t.afterEncode=function(t,e,n){if(null!=e.value&&e.value.nodeType==mxConstants.NODETYPE_ELEMENT){var i=n;n=mxClient.IS_IE?e.value.cloneNode(!0):t.document.importNode(e.value,!0),n.appendChild(i),t=i.getAttribute("id"),n.setAttribute("id",t),i.removeAttribute("id")}return n},t.beforeDecode=function(t,e,n){var i=e,o=this.getName();if(e.nodeName!=o?(i=e.getElementsByTagName(o)[0],null!=i&&i.parentNode==e?(mxUtils.removeWhitespace(i,!0),mxUtils.removeWhitespace(i,!1),i.parentNode.removeChild(i)):i=null,n.value=e.cloneNode(!0),e=n.value.getAttribute("id"),null!=e&&(n.setId(e),n.value.removeAttribute("id"))):n.setId(e.getAttribute("id")),null!=i)for(e=0;e<this.idrefs.length;e++){var o=this.idrefs[e],r=i.getAttribute(o);if(null!=r){i.removeAttribute(o);var s=t.objects[r]||t.lookup(r);null==s&&(r=t.getElementById(r),null!=r&&(s=(mxCodecRegistry.codecs[r.nodeName]||this).decode(t,r))),n[o]=s}}return i},t}()),mxCodecRegistry.register(function(){var t=new mxObjectCodec(new mxGraphModel);return t.encodeObject=function(t,e,n){var i=t.document.createElement("root");t.encodeCell(e.getRoot(),i),n.appendChild(i)},t.decodeChild=function(t,e,n){"root"==e.nodeName?this.decodeRoot(t,e,n):mxObjectCodec.prototype.decodeChild.apply(this,arguments)},t.decodeRoot=function(t,e,n){var i=null;for(e=e.firstChild;null!=e;){var o=t.decodeCell(e);null!=o&&null==o.getParent()&&(i=o),e=e.nextSibling}null!=i&&n.setRoot(i)},t}()),mxCodecRegistry.register(function(){var t=new mxObjectCodec(new mxRootChange,["model","previous","root"]);return t.afterEncode=function(t,e,n){return t.encodeCell(e.root,n),n},t.beforeDecode=function(t,e,n){if(null!=e.firstChild&&e.firstChild.nodeType==mxConstants.NODETYPE_ELEMENT){e=e.cloneNode(!0);var i=e.firstChild;for(n.root=t.decodeCell(i,!1),n=i.nextSibling,i.parentNode.removeChild(i),i=n;null!=i;)n=i.nextSibling,t.decodeCell(i),i.parentNode.removeChild(i),i=n}return e},t.afterDecode=function(t,e,n){return n.previous=n.root,n},t}()),mxCodecRegistry.register(function(){var t=new mxObjectCodec(new mxChildChange,["model","child","previousIndex"],["parent","previous"]);return t.isReference=function(t,e,n,i){return"child"!=e||null==t.previous&&i?0<=mxUtils.indexOf(this.idrefs,e):!0},t.afterEncode=function(t,e,n){return this.isReference(e,"child",e.child,!0)?n.setAttribute("child",t.getId(e.child)):t.encodeCell(e.child,n),n},t.beforeDecode=function(t,e,n){if(null!=e.firstChild&&e.firstChild.nodeType==mxConstants.NODETYPE_ELEMENT){e=e.cloneNode(!0);var i=e.firstChild;for(n.child=t.decodeCell(i,!1),n=i.nextSibling,i.parentNode.removeChild(i),i=n;null!=i;){if(n=i.nextSibling,i.nodeType==mxConstants.NODETYPE_ELEMENT){var o=i.getAttribute("id");null==t.lookup(o)&&t.decodeCell(i)}i.parentNode.removeChild(i),i=n}}else i=e.getAttribute("child"),n.child=t.getObject(i);return e},t.afterDecode=function(t,e,n){return n.child.parent=n.previous,n.previous=n.parent,n.previousIndex=n.index,n},t}()),mxCodecRegistry.register(function(){var t=new mxObjectCodec(new mxTerminalChange,["model","previous"],["cell","terminal"]);return t.afterDecode=function(t,e,n){return n.previous=n.terminal,n},t}());var mxGenericChangeCodec=function(t,e){var n=new mxObjectCodec(t,["model","previous"],["cell"]);return n.afterDecode=function(t,n,i){return mxUtils.isNode(i.cell)&&(i.cell=t.decodeCell(i.cell,!1)),i.previous=i[e],i},n};mxCodecRegistry.register(mxGenericChangeCodec(new mxValueChange,"value")),mxCodecRegistry.register(mxGenericChangeCodec(new mxStyleChange,"style")),mxCodecRegistry.register(mxGenericChangeCodec(new mxGeometryChange,"geometry")),mxCodecRegistry.register(mxGenericChangeCodec(new mxCollapseChange,"collapsed")),mxCodecRegistry.register(mxGenericChangeCodec(new mxVisibleChange,"visible")),mxCodecRegistry.register(mxGenericChangeCodec(new mxCellAttributeChange,"value")),mxCodecRegistry.register(function(){return new mxObjectCodec(new mxGraph,"graphListeners eventListeners view container cellRenderer editor selection".split(" "))}()),mxCodecRegistry.register(function(){var t=new mxObjectCodec(new mxGraphView);return t.encode=function(t,e){return this.encodeCell(t,e,e.graph.getModel().getRoot())},t.encodeCell=function(t,e,n){var i=e.graph.getModel(),o=e.getState(n),r=i.getParent(n);if(null==r||null!=o){var s=i.getChildCount(n),l=e.graph.getCellGeometry(n),a=null;if(r==i.getRoot()?a="layer":null==r?a="graph":i.isEdge(n)?a="edge":s>0&&null!=l?a="group":i.isVertex(n)&&(a="vertex"),null!=a){var h=t.document.createElement(a);if(null!=e.graph.getLabel(n)&&(h.setAttribute("label",e.graph.getLabel(n)),e.graph.isHtmlLabel(n)&&h.setAttribute("html",!0)),null==r){var d=e.getGraphBounds();null!=d&&(h.setAttribute("x",Math.round(d.x)),h.setAttribute("y",Math.round(d.y)),h.setAttribute("width",Math.round(d.width)),h.setAttribute("height",Math.round(d.height))),h.setAttribute("scale",e.scale)}else if(null!=o&&null!=l){for(d in o.style)r=o.style[d],"function"==typeof r&&"object"==typeof r&&(r=mxStyleRegistry.getName(r)),null!=r&&"function"!=typeof r&&"object"!=typeof r&&h.setAttribute(d,r);if(r=o.absolutePoints,null!=r&&0<r.length){for(l=Math.round(r[0].x)+","+Math.round(r[0].y),d=1;d<r.length;d++)l+=" "+Math.round(r[d].x)+","+Math.round(r[d].y);h.setAttribute("points",l)}else h.setAttribute("x",Math.round(o.x)),h.setAttribute("y",Math.round(o.y)),h.setAttribute("width",Math.round(o.width)),h.setAttribute("height",Math.round(o.height));d=o.absoluteOffset,null!=d&&(0!=d.x&&h.setAttribute("dx",Math.round(d.x)),0!=d.y&&h.setAttribute("dy",Math.round(d.y)))}for(d=0;s>d;d++)o=this.encodeCell(t,e,i.getChildAt(n,d)),null!=o&&h.appendChild(o)}}return h},t}()),mxCodecRegistry.register(function(){var t=new mxObjectCodec(new mxStylesheet);return t.encode=function(t,e){var n,i=t.document.createElement(this.getName());for(n in e.styles){var o=e.styles[n],r=t.document.createElement("add");if(null!=n){r.setAttribute("as",n);for(var s in o){var l=this.getStringValue(s,o[s]);if(null!=l){var a=t.document.createElement("add");a.setAttribute("value",l),a.setAttribute("as",s),r.appendChild(a)}}0<r.childNodes.length&&i.appendChild(r)}}return i},t.getStringValue=function(t,e){var n=typeof e;return"function"==n?e=mxStyleRegistry.getName(style[j]):"object"==n&&(e=null),e},t.decode=function(t,e,n){n=n||new this.template.constructor;var i=e.getAttribute("id");for(null!=i&&(t.objects[i]=n),e=e.firstChild;null!=e;){if(!this.processInclude(t,e,n)&&"add"==e.nodeName&&(i=e.getAttribute("as"),null!=i)){var o=e.getAttribute("extend"),r=null!=o?mxUtils.clone(n.styles[o]):null;for(null==r&&(null!=o&&mxLog.warn("mxStylesheetCodec.decode: stylesheet "+o+" not found to extend"),r={}),o=e.firstChild;null!=o;){if(o.nodeType==mxConstants.NODETYPE_ELEMENT){var s=o.getAttribute("as");if("add"==o.nodeName){var l=mxUtils.getTextContent(o),a=null;null!=l&&0<l.length?a=mxUtils.eval(l):(a=o.getAttribute("value"),mxUtils.isNumeric(a)&&(a=parseFloat(a))),null!=a&&(r[s]=a)}else"remove"==o.nodeName&&delete r[s]}o=o.nextSibling}n.putCellStyle(i,r)}e=e.nextSibling}return n},t}()),mxCodecRegistry.register(function(){var t=new mxObjectCodec(new mxDefaultKeyHandler);return t.encode=function(){return null},t.decode=function(t,e,n){if(null!=n)for(e=e.firstChild;null!=e;){if(!this.processInclude(t,e,n)&&"add"==e.nodeName){var i=e.getAttribute("as"),o=e.getAttribute("action"),r=e.getAttribute("control");n.bindAction(i,o,r)}e=e.nextSibling}return n},t}()),mxCodecRegistry.register(function(){var t=new mxObjectCodec(new mxDefaultToolbar);return t.encode=function(){return null},t.decode=function(t,e,n){if(null!=n){var i=n.editor;for(e=e.firstChild;null!=e;){if(e.nodeType==mxConstants.NODETYPE_ELEMENT&&!this.processInclude(t,e,n))if("separator"==e.nodeName)n.addSeparator();else if("br"==e.nodeName)n.toolbar.addBreak();else if("hr"==e.nodeName)n.toolbar.addLine();else if("add"==e.nodeName){var o=e.getAttribute("as"),o=mxResources.get(o)||o,r=e.getAttribute("icon"),s=e.getAttribute("pressedIcon"),l=e.getAttribute("action"),a=e.getAttribute("mode"),h=e.getAttribute("template"),d="0"!=e.getAttribute("toggle"),u=mxUtils.getTextContent(e),c=null;if(null!=l)c=n.addItem(o,r,l,s);else if(null!=a)var p=mxUtils.eval(u),c=n.addMode(o,r,a,s,p);else if(null!=h||null!=u&&0<u.length)c=i.templates[h],h=e.getAttribute("style"),null!=c&&null!=h&&(c=c.clone(),c.setStyle(h)),h=null,null!=u&&0<u.length&&(h=mxUtils.eval(u)),c=n.addPrototype(o,r,c,s,h,d);else if(s=mxUtils.getChildNodes(e),0<s.length)if(null==r)for(h=n.addActionCombo(o),o=0;o<s.length;o++)d=s[o],"separator"==d.nodeName?n.addOption(h,"---"):"add"==d.nodeName&&(r=d.getAttribute("as"),d=d.getAttribute("action"),n.addActionOption(h,r,d));else{var m=null,g=n.addPrototype(o,r,function(){var t=i.templates[m.value];if(null!=t){var t=t.clone(),e=m.options[m.selectedIndex].cellStyle;return null!=e&&t.setStyle(e),t}return mxLog.warn("Template "+t+" not found"),null},null,null,d),m=n.addCombo();for(mxEvent.addListener(m,"change",function(){n.toolbar.selectMode(g,function(t){return t=mxUtils.convertPoint(i.graph.container,mxEvent.getClientX(t),mxEvent.getClientY(t)),i.addVertex(null,p(),t.x,t.y)}),n.toolbar.noReset=!1}),o=0;o<s.length;o++)d=s[o],"separator"==d.nodeName?n.addOption(m,"---"):"add"==d.nodeName&&(r=d.getAttribute("as"),u=d.getAttribute("template"),n.addOption(m,r,u||h).cellStyle=d.getAttribute("style"))}null!=c&&(h=e.getAttribute("id"),null!=h&&0<h.length&&c.setAttribute("id",h))}e=e.nextSibling}}return n},t}()),mxCodecRegistry.register(function(){var t=new mxObjectCodec(new mxDefaultPopupMenu);return t.encode=function(){return null},t.decode=function(t,e,n){var i=e.getElementsByTagName("include")[0];return null!=i?this.processInclude(t,i,n):null!=n&&(n.config=e),n},t}()),mxCodecRegistry.register(function(){var t=new mxObjectCodec(new mxEditor,"modified lastSnapshot ignoredChanges undoManager graphContainer toolbarContainer".split(" "));return t.afterDecode=function(t,e,n){return t=e.getAttribute("defaultEdge"),null!=t&&(e.removeAttribute("defaultEdge"),n.defaultEdge=n.templates[t]),t=e.getAttribute("defaultGroup"),null!=t&&(e.removeAttribute("defaultGroup"),n.defaultGroup=n.templates[t]),n},t.decodeChild=function(t,e,n){if("Array"==e.nodeName){if("templates"==e.getAttribute("as"))return this.decodeTemplates(t,e,n),void 0}else if("ui"==e.nodeName)return this.decodeUi(t,e,n),void 0;mxObjectCodec.prototype.decodeChild.apply(this,arguments)},t.decodeUi=function(t,e,n){for(t=e.firstChild;null!=t;){if("add"==t.nodeName){e=t.getAttribute("as");var i=t.getAttribute("element"),o=t.getAttribute("style"),r=null;if(null!=i)r=document.getElementById(i),null!=r&&null!=o&&(r.style.cssText+=";"+o);else{var i=parseInt(t.getAttribute("x")),s=parseInt(t.getAttribute("y")),l=t.getAttribute("width"),a=t.getAttribute("height"),r=document.createElement("div");r.style.cssText=o,new mxWindow(mxResources.get(e)||e,r,i,s,l,a,!1,!0).setVisible(!0)}"graph"==e?n.setGraphContainer(r):"toolbar"==e?n.setToolbarContainer(r):"title"==e?n.setTitleContainer(r):"status"==e?n.setStatusContainer(r):"map"==e&&n.setMapContainer(r)}else"resource"==t.nodeName?mxResources.add(t.getAttribute("basename")):"stylesheet"==t.nodeName&&mxClient.link("stylesheet",t.getAttribute("name"));t=t.nextSibling}},t.decodeTemplates=function(t,e,n){null==n.templates&&(n.templates=[]),e=mxUtils.getChildNodes(e);for(var i=0;i<e.length;i++){for(var o=e[i].getAttribute("as"),r=e[i].firstChild;null!=r&&1!=r.nodeType;)r=r.nextSibling;null!=r&&(n.templates[o]=t.decodeCell(r))}},t}());/**
 * $Id: Editor.js,v 1.17 2013/05/23 16:00:22 gaudenz Exp $
 * Copyright (c) 2006-2012, JGraph Ltd
 */
var useLocalStorage=(mxClient.IS_TOUCH||"local"==urlParams.storage)&&"undefined"!=typeof localStorage,fileSupport=null!=window.File&&null!=window.FileReader&&null!=window.FileList,touchStyle=mxClient.IS_TOUCH||"1"==urlParams.touch,counter=0;try{for(var op=window;null!=op.opener&&!isNaN(op.opener.counter);)op=op.opener;null!=op&&(op.counter++,counter=op.counter)}catch(e){}Editor=function(){mxEventSource.call(this),this.init(),this.initStencilRegistry(),this.graph=new Graph,this.outline=new mxOutline(this.graph),this.outline.updateOnPan=!0,this.undoManager=this.createUndoManager(),this.status="",this.filename=null,this.getOrCreateFilename=function(){return this.filename||mxResources.get("drawing",[counter])+".xml"},this.getFilename=function(){return this.filename},this.setStatus=function(t){this.status=t,this.fireEvent(new mxEventObject("statusChanged"))},this.getStatus=function(){return this.status},this.modified=!1,this.graphChangeListener=function(){this.modified=!0},this.graph.getModel().addListener(mxEvent.CHANGE,mxUtils.bind(this,function(){this.graphChangeListener.apply(this,arguments)})),this.graph.resetViewOnRootChange=!1,this.graph.scrollbars=!0,this.graph.background=null},mxUtils.extend(Editor,mxEventSource),Editor.prototype.gridImage=IMAGE_PATH+"/grid.gif",Editor.prototype.transparentImage=IMAGE_PATH+"/transparent.gif",Editor.prototype.setGraphXml=function(t){var e=new mxCodec(t.ownerDocument);if("mxGraphModel"!=t.nodeName){var n=t.getElementsByTagName("mxGraphModel");null!=n&&n.length>0&&(t=n[0])}if("mxGraphModel"==t.nodeName){this.graph.view.scale=1,this.graph.gridEnabled="0"!=t.getAttribute("grid"),this.graph.graphHandler.guidesEnabled="0"!=t.getAttribute("guides"),this.graph.setTooltips("0"!=t.getAttribute("tooltips")),this.graph.setConnectable("0"!=t.getAttribute("connect")),this.graph.foldingEnabled="0"!=t.getAttribute("fold"),this.graph.scrollbars="0"!=t.getAttribute("scrollbars"),this.graph.scrollbars||(this.graph.container.scrollLeft=0,this.graph.container.scrollTop=0,this.graph.view.translate.x=Number(t.getAttribute("dx")||0),this.graph.view.translate.y=Number(t.getAttribute("dy")||0)),this.graph.pageVisible="1"==t.getAttribute("page"),this.graph.pageBreaksVisible=this.graph.pageVisible,this.graph.preferPageSize=this.graph.pageBreaksVisible;var i=t.getAttribute("pageScale");this.graph.pageScale=null!=i?i:1.5;var o=(t.getAttribute("pageWidth"),t.getAttribute("pageHeight"),t.getAttribute("background"));null!=o&&o.length>0&&(this.graph.background=o),e.decode(t,this.graph.getModel()),this.updateGraphComponents()}else{var r=e.document.createElement("mxGraphModel");r.appendChild(t),e.decode(r,this.graph.getModel()),this.updateGraphComponents()}},Editor.prototype.getGraphXml=function(){var t=new mxCodec(mxUtils.createXmlDocument()),e=t.encode(this.graph.getModel());return(0!=this.graph.view.translate.x||0!=this.graph.view.translate.y)&&(e.setAttribute("dx",Math.round(100*this.graph.view.translate.x)/100),e.setAttribute("dy",Math.round(100*this.graph.view.translate.y)/100)),e.setAttribute("grid",this.graph.isGridEnabled()?"1":"0"),e.setAttribute("guides",this.graph.graphHandler.guidesEnabled?"1":"0"),e.setAttribute("guides",this.graph.graphHandler.guidesEnabled?"1":"0"),e.setAttribute("tooltips",this.graph.tooltipHandler.isEnabled()?"1":"0"),e.setAttribute("connect",this.graph.connectionHandler.isEnabled()?"1":"0"),e.setAttribute("fold",this.graph.foldingEnabled?"1":"0"),e.setAttribute("page",this.graph.pageVisible?"1":"0"),e.setAttribute("pageScale",this.graph.pageScale),e.setAttribute("pageWidth",this.graph.pageFormat.width),e.setAttribute("pageHeight",this.graph.pageFormat.height),this.graph.scrollbars||e.setAttribute("scrollbars","0"),null!=this.graph.background&&e.setAttribute("background",this.graph.background),e},Editor.prototype.updateGraphComponents=function(){var t=this.graph,e=this.outline;if(null!=t.container&&null!=e.outline.container){null!=t.background?"none"==t.background?t.container.style.backgroundColor="transparent":(null!=t.view.backgroundPageShape&&(t.view.backgroundPageShape.fill=t.background,t.view.backgroundPageShape.reconfigure()),t.container.style.backgroundColor=t.background):t.container.style.backgroundColor="",t.pageVisible?(t.container.style.backgroundColor="#ebebeb",t.container.style.borderStyle="solid",t.container.style.borderColor="#e5e5e5",t.container.style.borderTopWidth="1px",t.container.style.borderLeftWidth="1px",t.container.style.borderRightWidth="0px",t.container.style.borderBottomWidth="0px"):t.container.style.border="",e.outline.container.style.backgroundColor=t.container.style.backgroundColor,(e.outline.pageVisible!=t.pageVisible||e.outline.pageScale!=t.pageScale)&&(e.outline.pageScale=t.pageScale,e.outline.pageVisible=t.pageVisible,e.outline.view.validate()),t.scrollbars&&"hidden"==t.container.style.overflow&&!touchStyle?t.container.style.overflow="auto":(!t.scrollbars||touchStyle)&&(t.container.style.overflow="hidden");var n=mxClient.IS_IE&&document.documentMode>=9?"url("+this.transparentImage+")":"none";t.container.style.backgroundImage=!t.pageVisible&&t.isGridEnabled()?"url("+this.gridImage+")":n,null!=t.view.backgroundPageShape&&(t.view.backgroundPageShape.node.style.backgroundImage=this.graph.isGridEnabled()?"url("+this.gridImage+")":"none")}},Editor.prototype.init=function(){mxClient.IS_IE6&&mxClient.link("stylesheet",CSS_PATH+"/grapheditor-ie6.css"),mxResources.loadDefaultBundle=!1,mxResources.add(RESOURCE_BASE),mxConstants.DEFAULT_HOTSPOT=.3;var t=mxConnectionHandler.prototype.createMarker;mxConnectionHandler.prototype.createMarker=function(){var e=t.apply(this,arguments);return e.intersects=mxUtils.bind(this,function(){return this.isConnecting()?!0:mxCellMarker.prototype.intersects.apply(e,arguments)}),e},mxConstants.SHADOWCOLOR="#d0d0d0",mxConstants.HANDLE_FILLCOLOR="#99ccff",mxConstants.HANDLE_STROKECOLOR="#0088cf",mxConstants.VERTEX_SELECTION_COLOR="#00a8ff",mxConstants.OUTLINE_COLOR="#00a8ff",mxConstants.OUTLINE_HANDLE_FILLCOLOR="#99ccff",mxConstants.OUTLINE_HANDLE_STROKECOLOR="#00a8ff",mxConstants.CONNECT_HANDLE_FILLCOLOR="#cee7ff",mxConstants.EDGE_SELECTION_COLOR="#00a8ff",mxConstants.DEFAULT_VALID_COLOR="#00a8ff",mxConstants.LABEL_HANDLE_FILLCOLOR="#cee7ff",mxConstants.GUIDE_COLOR="#0088cf",mxGraph.prototype.pageBreakColor="#c0c0c0",mxGraph.prototype.pageScale=1,mxRubberband.prototype.defaultOpacity=30,mxGraphView.prototype.createBackgroundPageShape=function(t){return new mxRectangleShape(t,this.graph.background||"white","#cacaca")},mxGraphView.prototype.getBackgroundPageBounds=function(){var t=this.getGraphBounds(),e=t.width>0?t.x/this.scale-this.translate.x:0,n=t.height>0?t.y/this.scale-this.translate.y:0,i=t.width/this.scale,o=t.height/this.scale,r=this.graph.pageFormat,s=this.graph.pageScale,l=r.width*s,a=r.height*s,h=Math.floor(Math.min(0,e)/l),d=Math.floor(Math.min(0,n)/a),u=Math.ceil(Math.max(1,e+i)/l),c=Math.ceil(Math.max(1,n+o)/a),p=u-h,m=c-d,g=new mxRectangle(this.scale*(this.translate.x+h*l),this.scale*(this.translate.y+d*a),this.scale*p*l,this.scale*m*a);return g};var e=mxGraph.prototype.panGraph;mxGraph.prototype.panGraph=function(t,n){e.apply(this,arguments),this.dialect==mxConstants.DIALECT_SVG||null==this.view.backgroundPageShape||this.useScrollbarsForPanning&&mxUtils.hasScrollbars(this.container)||(this.view.backgroundPageShape.node.style.marginLeft=t+"px",this.view.backgroundPageShape.node.style.marginTop=n+"px")};var n=this;mxGraphView.prototype.validateBackground=function(){var t=this.graph.getBackgroundImage();if(null!=t){if(null==this.backgroundImage||this.backgroundImage.image!=t.src){null!=this.backgroundImage&&this.backgroundImage.destroy();var e=new mxRectangle(0,0,1,1);this.backgroundImage=new mxImageShape(e,t.src),this.backgroundImage.dialect=this.graph.dialect,this.backgroundImage.init(this.backgroundPane),this.backgroundImage.redraw()}this.redrawBackgroundImage(this.backgroundImage,t)}else null!=this.backgroundImage&&(this.backgroundImage.destroy(),this.backgroundImage=null);if(this.graph.pageVisible){var e=this.getBackgroundPageBounds();null==this.backgroundPageShape?(this.backgroundPageShape=this.createBackgroundPageShape(e),this.backgroundPageShape.scale=1,this.backgroundPageShape.isShadow=!0,this.backgroundPageShape.dialect=mxConstants.DIALECT_STRICTHTML,this.backgroundPageShape.init(this.graph.container),this.graph.container.firstChild.style.position="absolute",this.graph.container.insertBefore(this.backgroundPageShape.node,this.graph.container.firstChild),this.backgroundPageShape.redraw(),this.backgroundPageShape.node.className="geBackgroundPage",this.backgroundPageShape.node.style.backgroundPosition="-1px -1px",mxEvent.addListener(this.backgroundPageShape.node,"dblclick",mxUtils.bind(this,function(t){this.graph.dblClick(t)})),mxEvent.addGestureListeners(this.backgroundPageShape.node,mxUtils.bind(this,function(t){this.graph.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(t))}),mxUtils.bind(this,function(t){null!=this.graph.tooltipHandler&&this.graph.tooltipHandler.isHideOnHover()&&this.graph.tooltipHandler.hide(),this.graph.isMouseDown&&!mxEvent.isConsumed(t)&&this.graph.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(t))}),mxUtils.bind(this,function(t){this.graph.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(t))}))):(this.backgroundPageShape.scale=1,this.backgroundPageShape.bounds=e,this.backgroundPageShape.redraw()),this.backgroundPageShape.node.style.backgroundImage=this.graph.isGridEnabled()?"url("+n.gridImage+")":"none"}else null!=this.backgroundPageShape&&(this.backgroundPageShape.destroy(),this.backgroundPageShape=null)},mxGraph.prototype.updatePageBreaks=function(t,e,n){var i=this.view.scale,o=this.view.translate,r=this.pageFormat,s=i*this.pageScale,l=this.view.getBackgroundPageBounds();e=l.width,n=l.height;var a=new mxRectangle(i*o.x,i*o.y,r.width*s,r.height*s);t=t&&Math.min(a.width,a.height)>this.minPageBreakDist;var h=t?Math.ceil(e/a.width)-1:0,d=t?Math.ceil(n/a.height)-1:0,u=l.x+e,c=l.y+n;if(null==this.horizontalPageBreaks&&h>0&&(this.horizontalPageBreaks=[]),null!=this.horizontalPageBreaks){for(var p=0;h>=p;p++){var m=[new mxPoint(l.x+(p+1)*a.width,l.y),new mxPoint(l.x+(p+1)*a.width,c)];if(null!=this.horizontalPageBreaks[p])this.horizontalPageBreaks[p].scale=1,this.horizontalPageBreaks[p].points=m,this.horizontalPageBreaks[p].redraw();else{var g=new mxPolyline(m,this.pageBreakColor,this.scale);g.dialect=this.dialect,g.isDashed=this.pageBreakDashed,g.addPipe=!1,g.scale=i,g.init(this.view.backgroundPane),g.redraw(),this.horizontalPageBreaks[p]=g}}for(var p=h;p<this.horizontalPageBreaks.length;p++)this.horizontalPageBreaks[p].destroy();this.horizontalPageBreaks.splice(h,this.horizontalPageBreaks.length-h)}if(null==this.verticalPageBreaks&&d>0&&(this.verticalPageBreaks=[]),null!=this.verticalPageBreaks){for(var p=0;d>=p;p++){var m=[new mxPoint(l.x,l.y+(p+1)*a.height),new mxPoint(u,l.y+(p+1)*a.height)];if(null!=this.verticalPageBreaks[p])this.verticalPageBreaks[p].scale=1,this.verticalPageBreaks[p].points=m,this.verticalPageBreaks[p].redraw();else{var g=new mxPolyline(m,this.pageBreakColor,i);g.dialect=this.dialect,g.isDashed=this.pageBreakDashed,g.addPipe=!1,g.scale=i,g.init(this.view.backgroundPane),g.redraw(),this.verticalPageBreaks[p]=g}}for(var p=d;p<this.verticalPageBreaks.length;p++)this.verticalPageBreaks[p].destroy();this.verticalPageBreaks.splice(d,this.verticalPageBreaks.length-d)}},mxEdgeHandler.prototype.snapToTerminals=!0,mxGraphHandler.prototype.guidesEnabled=!0;var i=mxGraphHandler.prototype.shouldRemoveCellsFromParent;mxGraphHandler.prototype.shouldRemoveCellsFromParent=function(t,e){for(var n=0;n<e.length;n++)if(this.graph.getModel().isVertex(e[n])){var o=this.graph.getCellGeometry(e[n]);if(null!=o&&o.relative)return!1}return i.apply(this,arguments)},mxGuide.prototype.isEnabledForEvent=function(t){return!mxEvent.isAltDown(t)},mxPopupMenuAddItem=mxPopupMenu.prototype.addItem,mxPopupMenu.prototype.addItem=function(t,e,n,i,o,r){var s=mxPopupMenuAddItem.apply(this,arguments);return null==r||r||mxEvent.addListener(s,"mousedown",function(t){mxEvent.consume(t)}),s};var o=mxGraphHandler.prototype.getInitialCellForEvent;mxGraphHandler.prototype.getInitialCellForEvent=function(){var t=this.graph.getModel(),e=t.getParent(this.graph.getSelectionCell()),n=o.apply(this,arguments),i=t.getParent(n);if(null==e||e!=n&&e!=i)for(;!this.graph.isCellSelected(n)&&!this.graph.isCellSelected(i)&&t.isVertex(i)&&!this.graph.isValidRoot(i);)n=i,i=this.graph.getModel().getParent(n);return n};var r=mxGraphHandler.prototype.isDelayedSelection;mxGraphHandler.prototype.isDelayedSelection=function(t){var e=r.apply(this,arguments),n=this.graph.getModel(),i=n.getParent(this.graph.getSelectionCell()),o=n.getParent(t);return(null==i||i!=t&&i!=o)&&(this.graph.isCellSelected(t)||!n.isVertex(o)||this.graph.isValidRoot(o)||(e=!0)),e},mxGraphHandler.prototype.selectDelayed=function(t){var e=t.getCell();null==e&&(e=this.cell);for(var n=this.graph.getModel(),i=n.getParent(e);this.graph.isCellSelected(e)&&n.isVertex(i)&&!this.graph.isValidRoot(i);)e=i,i=n.getParent(e);this.graph.selectCellForEvent(e,t.getEvent())},mxPanningHandler.prototype.getCellForPopupEvent=function(t){for(var e=t.getCell(),n=this.graph.getModel(),i=n.getParent(e);n.isVertex(i)&&!this.graph.isValidRoot(i);)this.graph.isCellSelected(i)&&(e=i),i=n.getParent(i);return e}},Editor.prototype.createUndoManager=function(){var t=this.graph,e=new mxUndoManager,n=function(t,n){e.undoableEditHappened(n.getProperty("edit"))};t.getModel().addListener(mxEvent.UNDO,n),t.getView().addListener(mxEvent.UNDO,n);var i=function(e,n){for(var i=t.getSelectionCellsForChanges(n.getProperty("edit").changes),o=[],r=0;r<i.length;r++)null!=t.view.getState(i[r])&&o.push(i[r]);t.setSelectionCells(o)};return e.addListener(mxEvent.UNDO,i),e.addListener(mxEvent.REDO,i),e},Editor.prototype.initStencilRegistry=function(){mxStencilRegistry.loadStencilSet(STENCIL_PATH+"/general.xml")},function(){mxStencilRegistry.libraries={},mxStencilRegistry.packages=[],mxStencilRegistry.getStencil=function(t){var e=mxStencilRegistry.stencils[t];if(null==e){var n=mxStencilRegistry.getBasenameForStencil(t);if(null!=n){var i=mxStencilRegistry.libraries[n];if(null!=i){if(null==mxStencilRegistry.packages[n]){mxStencilRegistry.packages[n]=1;for(var o=0;o<i.length;o++){var r=i[o];if(".xml"==r.toLowerCase().substring(r.length-4,r.length))mxStencilRegistry.loadStencilSet(r,null);else if(".js"==r.toLowerCase().substring(r.length-3,r.length)){var s=mxUtils.load(r);null!=s&&eval.call(window,s.getText())}}}}else mxStencilRegistry.loadStencilSet(STENCIL_PATH+"/"+n+".xml",null);e=mxStencilRegistry.stencils[t]}}return e},mxStencilRegistry.getBasenameForStencil=function(t){var e=t.split("."),n=null;if(e.length>0&&"mxgraph"==e[0]){n=e[1];for(var i=2;i<e.length-1;i++)n+="/"+e[i]}return n},mxStencilRegistry.loadStencilSet=function(t,e,n){n=null!=n?n:!1;var i=mxStencilRegistry.packages[t];if(n||null==i){var o=!1;if(null==i){var r=mxUtils.load(t);i=r.getXml(),mxStencilRegistry.packages[t]=i,o=!0}mxStencilRegistry.parseStencilSet(i,e,o)}},mxStencilRegistry.parseStencilSet=function(t,e,n){n=null!=n?n:!0;var i=t.documentElement,o=i.firstChild,r="",s=i.getAttribute("name");for(null!=s&&(r=s+".");null!=o;){if(o.nodeType==mxConstants.NODETYPE_ELEMENT&&(s=o.getAttribute("name"),null!=s)){r=r.toLowerCase();var l=s.replace(/ /g,"_");if(n&&mxStencilRegistry.addStencil(r+l.toLowerCase(),new mxStencil(o)),null!=e){var a=o.getAttribute("w"),h=o.getAttribute("h");a=null==a?80:parseInt(a,10),h=null==h?80:parseInt(h,10),e(r,l,s,a,h)}}o=o.nextSibling}}}(),OpenFile=function(t){this.producer=null,this.consumer=null,this.done=t},OpenFile.prototype.setConsumer=function(t){this.consumer=t,this.execute()},OpenFile.prototype.setData=function(t,e){this.data=t,this.filename=e,this.execute()},OpenFile.prototype.error=function(t){this.cancel(),mxUtils.alert(t)},OpenFile.prototype.execute=function(){null!=this.consumer&&null!=this.data&&(this.consumer(this.data,this.filename),this.cancel())},OpenFile.prototype.cancel=function(){null!=this.done&&this.done()},/**
 * $Id: EditorUi.js,v 1.25 2013/05/01 16:17:21 gaudenz Exp $
 * Copyright (c) 2006-2012, JGraph Ltd
 */
EditorUi=function(t,e,n){if(this.editor=t||new Editor,this.choices=e||["all"],!n)return null;this.container=n||document.body;var i=t.graph;this.container.style.overflow="hidden",(new Image).src=mxPopupMenu.prototype.submenuImage,null!=mxConnectionHandler.prototype.connectImage&&((new Image).src=mxConnectionHandler.prototype.connectImage.src),this.actions=new Actions(this),this.menus=new Menus(this),this.createDivs(),this.refresh(),this.createUi();var o=mxUtils.bind(this,function(t){return null==t&&(t=window.event),this.isSelectionAllowed(t)?!0:i.isEditing()});this.container==document.body&&(this.menubarContainer.onselectstart=o,this.menubarContainer.onmousedown=o,this.toolbarContainer.onselectstart=o,this.toolbarContainer.onmousedown=o,this.diagramContainer.onselectstart=o,this.diagramContainer.onmousedown=o,this.sidebarContainer.onselectstart=o,this.sidebarContainer.onmousedown=o,this.footerContainer.onselectstart=o,this.footerContainer.onmousedown=o),mxClient.IS_IE&&("undefined"==typeof document.documentMode||document.documentMode<9)?mxEvent.addListener(this.diagramContainer,"contextmenu",o):this.diagramContainer.oncontextmenu=o,i.init(this.diagramContainer),i.refresh(),i.container.setAttribute("tabindex","0"),i.container.style.overflow=touchStyle?"hidden":"auto",i.container.style.cursor="default",i.container.style.backgroundImage="url("+t.gridImage+")",i.container.style.backgroundPosition="-1px -1px",i.container.focus();var r=i.fireMouseEvent;i.fireMouseEvent=function(t){t==mxEvent.MOUSE_DOWN&&this.container.focus(),r.apply(this,arguments)},i.panningHandler.autoExpand=!0,i.panningHandler.factoryMethod=mxUtils.bind(this,function(t,e,n){this.menus.createPopupMenu(t,e,n)}),t.outline.init(this.outlineContainer),mxEvent.addGestureListeners(document,mxUtils.bind(this,function(){i.panningHandler.hideMenu()})),mxClient.IS_TOUCH&&(mxEvent.addListener(i.container,"gesturechange",mxUtils.bind(this,function(t){i.view.getDrawPane().setAttribute("transform","scale("+t.scale+")"),i.view.getOverlayPane().style.visibility="hidden",mxEvent.consume(t)})),mxEvent.addListener(i.container,"gestureend",mxUtils.bind(this,function(t){i.view.getDrawPane().removeAttribute("transform"),i.view.setScale(i.view.scale*t.scale),i.view.getOverlayPane().style.visibility="visible",mxEvent.consume(t)})),i.handleGesture=function(){});var s=this.createKeyHandler(t);this.getKeyHandler=function(){return s},mxEvent.addListener(window,"resize",mxUtils.bind(this,function(){this.refresh(),i.sizeDidChange(),this.editor.outline.update(!1),this.editor.outline.outline.sizeDidChange()})),this.init(),this.open()},EditorUi.prototype.splitSize=mxClient.IS_TOUCH?16:8,EditorUi.prototype.menubarHeight=0,EditorUi.prototype.toolbarHeight=36,EditorUi.prototype.footerHeight=0,EditorUi.prototype.sidebarFooterHeight=34,EditorUi.prototype.hsplitPosition=204,EditorUi.prototype.vsplitPosition=0,EditorUi.prototype.init=function(){this.addUndoListener(),this.addSelectionListener();var t=this.actions.get("paste"),e=function(){t.setEnabled(!mxClipboard.isEmpty())},n=mxClipboard.cut;mxClipboard.cut=function(){n.apply(this,arguments),e()};var i=mxClipboard.copy;mxClipboard.copy=function(){i.apply(this,arguments),e()}},EditorUi.prototype.isSelectionAllowed=function(){return!1},EditorUi.prototype.open=function(){try{null!=window.opener&&null!=window.opener.openFile&&window.opener.openFile.setConsumer(mxUtils.bind(this,function(t,e){try{var n=mxUtils.parseXml(t);this.editor.setGraphXml(n.documentElement),this.editor.modified=!1,this.editor.undoManager.clear(),null!=e&&(this.editor.filename=e)}catch(i){mxUtils.alert(mxResources.get("invalidOrMissingFile")+": "+i.message)}}))}catch(t){}},EditorUi.prototype.save=function(t){if(null!=t){var e=mxUtils.getXml(this.editor.getGraphXml());try{if(useLocalStorage){if(null!=localStorage.getItem(t)&&!mxUtils.confirm(mxResources.get("replace",[t])))return;localStorage.setItem(t,e),this.editor.setStatus(mxResources.get("saved")+" "+new Date)}else{if(!(e.length<MAX_REQUEST_SIZE))return mxUtils.alert(mxResources.get("drawingTooLarge")),mxUtils.popup(e),void 0;e=encodeURIComponent(e),new mxXmlRequest(SAVE_URL,"filename="+t+"&xml="+e).simulate(document,"_blank")}this.editor.filename=t,this.editor.modified=!1}catch(n){this.editor.setStatus("Error saving file")}}},EditorUi.prototype.getUrl=function(t){var e=null!=t?t:window.location.pathname,n=e.indexOf("?")>0?1:0;for(var i in urlParams)e+=0==n?"?":"&",e+=i+"="+urlParams[i],n++;return e},EditorUi.prototype.addUndoListener=function(){var t=this.actions.get("undo"),e=this.actions.get("redo"),n=this.editor.undoManager,i=function(){t.setEnabled(n.canUndo()),e.setEnabled(n.canRedo())};n.addListener(mxEvent.ADD,i),n.addListener(mxEvent.UNDO,i),n.addListener(mxEvent.REDO,i),n.addListener(mxEvent.CLEAR,i),i()},EditorUi.prototype.addSelectionListener=function(){var t=mxUtils.bind(this,function(){var t=this.editor.graph,e=!t.isSelectionEmpty(),n=!1,i=!1,o=t.getSelectionCells();if(null!=o)for(var r=0;r<o.length;r++){var s=o[r];if(t.getModel().isEdge(s)&&(i=!0),t.getModel().isVertex(s)&&(n=!0),i&&n)break}for(var l=["cut","copy","delete","duplicate","bold","italic","style","fillColor","gradientColor","underline","fontColor","strokeColor","backgroundColor","borderColor","toFront","toBack","dashed","rounded","shadow","tilt","autosize","lockUnlock"],r=0;r<l.length;r++)this.actions.get(l[r]).setEnabled(e);this.actions.get("curved").setEnabled(i),this.actions.get("rotation").setEnabled(n),this.actions.get("wordWrap").setEnabled(n),this.actions.get("group").setEnabled(t.getSelectionCount()>1),this.actions.get("ungroup").setEnabled(1==t.getSelectionCount()&&t.getModel().getChildCount(t.getSelectionCell())>0);var a=n&&1==t.getSelectionCount();this.actions.get("removeFromGroup").setEnabled(a&&t.getModel().isVertex(t.getModel().getParent(t.getSelectionCell())));for(var h=["fontFamily","fontSize","alignment","position","text","format","arrange","linewidth","spacing","gradient"],r=0;r<h.length;r++)this.menus.get(h[r]).setEnabled(e);h=["line","lineend","linestart"];for(var r=0;r<h.length;r++)this.menus.get(h[r]).setEnabled(i);this.actions.get("setAsDefaultEdge").setEnabled(i),this.menus.get("align").setEnabled(t.getSelectionCount()>1),this.menus.get("direction").setEnabled(n||i&&t.isLoop(t.view.getState(t.getSelectionCell()))),this.menus.get("navigation").setEnabled(t.foldingEnabled&&(null!=t.view.currentRoot||1==t.getSelectionCount()&&t.isValidRoot(t.getSelectionCell()))),this.menus.get("layers").setEnabled(null==t.view.currentRoot),this.actions.get("home").setEnabled(null!=t.view.currentRoot),this.actions.get("exitGroup").setEnabled(null!=t.view.currentRoot);var d=1==t.getSelectionCount()&&t.isValidRoot(t.getSelectionCell());this.actions.get("enterGroup").setEnabled(d),this.actions.get("expand").setEnabled(d),this.actions.get("collapse").setEnabled(d),this.actions.get("editLink").setEnabled(1==t.getSelectionCount()),this.actions.get("openLink").setEnabled(1==t.getSelectionCount()&&null!=t.getLinkForCell(t.getSelectionCell()))});this.editor.graph.getSelectionModel().addListener(mxEvent.CHANGE,t),t()},EditorUi.prototype.refresh=function(){var t=mxClient.IS_IE&&(null==document.documentMode||5==document.documentMode),e=this.container.clientWidth,n=this.container.clientHeight;this.container==document.body&&(e=document.body.clientWidth||document.documentElement.clientWidth,n=t?document.body.clientHeight||document.documentElement.clientHeight:document.documentElement.clientHeight);var i=Math.max(0,Math.min(this.hsplitPosition,e-this.splitSize-20)),o=Math.max(0,Math.min(this.vsplitPosition,n-this.menubarHeight-this.toolbarHeight-this.footerHeight-this.splitSize-1));this.menubarContainer.style.height=this.menubarHeight+"px",this.toolbarContainer.style.top=this.menubarHeight+"px",this.toolbarContainer.style.height=this.toolbarHeight+"px";var r=this.menubarHeight+this.toolbarHeight;mxClient.IS_QUIRKS||(r+=1);var s=0;if(null!=this.sidebarFooterContainer){var l=o+this.splitSize+this.footerHeight;s=Math.max(0,Math.min(n-r-l,this.sidebarFooterHeight)),this.sidebarFooterContainer.style.width=i+"px",this.sidebarFooterContainer.style.height=s+"px",this.sidebarFooterContainer.style.bottom=l+"px"}if(this.sidebarContainer.style.top=r+"px",this.sidebarContainer.style.width=i+"px",this.outlineContainer.style.width=i+"px",this.outlineContainer.style.height=o+"px",this.outlineContainer.style.bottom=this.footerHeight+"px",this.diagramContainer.style.left=i+this.splitSize+"px",this.diagramContainer.style.top=this.sidebarContainer.style.top,this.footerContainer.style.height=this.footerHeight+"px",this.hsplit.style.top=this.sidebarContainer.style.top,this.hsplit.style.bottom=this.outlineContainer.style.bottom,this.hsplit.style.left=i+"px",this.vsplit.style.width=this.sidebarContainer.style.width,this.vsplit.style.bottom=o+this.footerHeight+"px",t){this.menubarContainer.style.width=e+"px",this.toolbarContainer.style.width=this.menubarContainer.style.width;var a=Math.max(0,n-o-this.splitSize-this.footerHeight-this.menubarHeight-this.toolbarHeight);this.sidebarContainer.style.height=a-s+"px",this.diagramContainer.style.width=Math.max(0,e-i-this.splitSize)+"px";var h=Math.max(0,n-this.footerHeight-this.menubarHeight-this.toolbarHeight);this.diagramContainer.style.height=h+"px",this.footerContainer.style.width=this.menubarContainer.style.width,this.hsplit.style.height=h+"px"}else this.sidebarContainer.style.bottom=o+this.splitSize+this.footerHeight+s+"px",this.diagramContainer.style.bottom=this.outlineContainer.style.bottom},EditorUi.prototype.createDivs=function(){this.menubarContainer=this.createDiv("geMenubarContainer"),this.toolbarContainer=this.createDiv("geToolbarContainer"),this.sidebarContainer=this.createDiv("geSidebarContainer"),this.outlineContainer=this.createDiv("geOutlineContainer"),this.diagramContainer=this.createDiv("geDiagramContainer"),this.footerContainer=this.createDiv("geFooterContainer"),this.hsplit=this.createDiv("geHsplit"),this.vsplit=this.createDiv("geVsplit"),this.menubarContainer.style.top="0px",this.menubarContainer.style.left="0px",this.menubarContainer.style.right="0px",this.toolbarContainer.style.left="0px",this.toolbarContainer.style.right="0px",this.sidebarContainer.style.left="0px",this.outlineContainer.style.left="0px",this.diagramContainer.style.right="0px",this.footerContainer.style.left="0px",this.footerContainer.style.right="0px",this.footerContainer.style.bottom="0px",this.vsplit.style.left="0px",this.vsplit.style.height=this.splitSize+"px",this.hsplit.style.width=this.splitSize+"px",this.sidebarFooterContainer=this.createSidebarFooterContainer(),this.sidebarFooterContainer&&(this.sidebarFooterContainer.style.left="0px")},EditorUi.prototype.createSidebarFooterContainer=function(){return null},EditorUi.prototype.createUi=function(){this.menubar=this.menus.createMenubar(this.createDiv("geMenubar")),this.menubarContainer.appendChild(this.menubar.container),this.toolbar=this.createToolbar(this.createDiv("geToolbar")),this.toolbarContainer.appendChild(this.toolbar.container),this.sidebar=this.createSidebar(this.sidebarContainer),this.footerContainer.appendChild(this.createFooter()),this.statusContainer=this.createStatusContainer(),this.editor.addListener("statusChanged",mxUtils.bind(this,function(){this.setStatusText(this.editor.getStatus())})),this.setStatusText(this.editor.getStatus()),this.menubar.container.appendChild(this.statusContainer),this.container.appendChild(this.menubarContainer),this.container.appendChild(this.toolbarContainer),this.container.appendChild(this.sidebarContainer),this.container.appendChild(this.outlineContainer),this.container.appendChild(this.diagramContainer),this.container.appendChild(this.footerContainer),this.container.appendChild(this.hsplit),this.container.appendChild(this.vsplit),this.sidebarFooterContainer&&this.container.appendChild(this.sidebarFooterContainer),this.addSplitHandler(this.hsplit,!0,0,mxUtils.bind(this,function(t){this.hsplitPosition=t,this.refresh(),this.editor.graph.sizeDidChange(),this.editor.outline.update(!1),this.editor.outline.outline.sizeDidChange()})),this.addSplitHandler(this.vsplit,!1,this.footerHeight,mxUtils.bind(this,function(t){this.vsplitPosition=t,this.refresh(),this.editor.outline.update(!1),this.editor.outline.outline.sizeDidChange()}))},EditorUi.prototype.createStatusContainer=function(){var t=document.createElement("a");return t.className="geItem geStatus",t},EditorUi.prototype.setStatusText=function(t){this.statusContainer.innerHTML=t},EditorUi.prototype.createToolbar=function(t){return new Toolbar(this,t)},EditorUi.prototype.createSidebar=function(t){return new Sidebar(this,t,this.choices)},EditorUi.prototype.createFooter=function(){return this.createDiv("geFooter")},EditorUi.prototype.createDiv=function(t){var e=document.createElement("div");return e.className=t,e},EditorUi.prototype.addSplitHandler=function(t,e,n,i){function o(){return parseInt(e?t.style.left:t.style.bottom)}function r(t){if(null!=l){var o=new mxPoint(mxEvent.getClientX(t),mxEvent.getClientY(t));i(Math.max(0,a+(e?o.x-l.x:l.y-o.y)-n)),mxEvent.consume(t)}}function s(t){r(t),l=null,a=null}var l=null,a=null;mxEvent.addGestureListeners(t,function(t){l=new mxPoint(mxEvent.getClientX(t),mxEvent.getClientY(t)),a=o(),mxEvent.consume(t)}),mxEvent.addListener(document,"mousemove",r),mxEvent.addListener(document,"touchmove",r),mxEvent.addListener(document,"mouseup",s),mxEvent.addListener(document,"touchend",s)},EditorUi.prototype.showDialog=function(t,e,n,i,o,r){this.hideDialog(),this.dialog=new Dialog(this,t,e,mxClient.IS_VML?n-12:n,i,o,r)},EditorUi.prototype.hideDialog=function(){null!=this.dialog&&(this.dialog.close(),this.dialog=null,this.editor.graph.container.focus())},EditorUi.prototype.executeLayout=function(t,e,n,i,o){var r=this.editor.graph,s=r.getSelectionCell();e=null!=this.animate?this.animate:e,r.getModel().beginUpdate();try{null!=i?i():t.execute(r.getDefaultParent(),s)}catch(l){throw l}finally{if(e&&navigator.userAgent.indexOf("Camino")<0){var a=new mxMorphing(r);a.addListener(mxEvent.DONE,mxUtils.bind(this,function(){r.getModel().endUpdate(),null!=o&&o()})),a.startAnimation()}else r.getModel().endUpdate()}},EditorUi.prototype.createKeyHandler=function(){function t(t){if(!e.isSelectionEmpty()){var n=0,i=0;37==t?n=-1:38==t?i=-1:39==t?n=1:40==t&&(i=1),e.moveCells(e.getSelectionCells(),n,i),e.scrollCellToVisible(e.getSelectionCell())}}var e=this.editor.graph,n=new mxKeyHandler(e);n.isControlDown=function(t){return mxEvent.isControlDown(t)||mxClient.IS_MAC&&t.metaKey};var i=mxUtils.bind(this,function(t,e,i,o){var r=this.actions.get(i);if(null!=r){var s=function(){r.enabled&&r.funct()};e?o?n.bindControlShiftKey(t,s):n.bindControlKey(t,s):o?n.bindShiftKey(t,s):n.bindKey(t,s)}}),o=this,r=n.escape;return n.escape=function(){o.hideDialog(),r.apply(this,arguments)},n.enter=function(){},n.bindShiftKey(13,function(){e.foldCells(!0)}),n.bindKey(13,function(){e.foldCells(!1)}),n.bindKey(33,function(){e.exitGroup()}),n.bindKey(34,function(){e.enterGroup()}),n.bindKey(36,function(){e.home()}),n.bindKey(35,function(){e.refresh()}),n.bindKey(37,function(){t(37)}),n.bindKey(38,function(){t(38)}),n.bindKey(39,function(){t(39)}),n.bindKey(40,function(){t(40)}),n.bindKey(113,function(){e.startEditingAtCell()}),n.bindKey(8,function(){e.foldCells(!0)}),i(8,!1,"delete"),i(46,!1,"delete"),i(46,!1,"delete"),i(82,!0,"tilt"),i(107,!1,"zoomIn"),i(109,!1,"zoomOut"),i(65,!0,"selectAll"),i(86,!0,"selectVertices",!0),i(69,!0,"selectEdges",!0),i(66,!0,"toBack"),i(70,!0,"toFront"),i(68,!0,"duplicate"),i(90,!0,"undo"),i(89,!0,"redo"),i(88,!0,"cut"),i(67,!0,"copy"),i(81,!0,"connect"),i(86,!0,"paste"),i(71,!0,"group"),i(71,!0,"grid",!0),i(76,!0,"lockUnlock"),i(85,!0,"ungroup"),n},Actions.prototype.init=function(){var t=this.editorUi,e=t.editor,n=e.graph;this.addAction("new",function(){window.open(t.getUrl())}),this.addAction("open",function(){window.openNew=!0,window.openKey="open",t.openFile()}),this.addAction("import",function(){window.openNew=!1,window.openKey="import",window.openFile=new OpenFile(mxUtils.bind(this,function(){t.hideDialog()})),window.openFile.setConsumer(mxUtils.bind(this,function(t){try{var n=mxUtils.parseXml(t),i=new mxGraphModel,o=new mxCodec(n);o.decode(n.documentElement,i);var r=i.getChildren(i.getChildAt(i.getRoot(),0));e.graph.setSelectionCells(e.graph.importCells(r))}catch(s){mxUtils.alert(mxResources.get("invalidOrMissingFile")+": "+s.message)}})),t.showDialog(new OpenDialog(this).container,300,180,!0,!0,function(){window.openFile=null})}),this.addAction("save",function(){t.saveFile(!1)},null,null,"Ctrl+S"),this.addAction("saveAs",function(){t.saveFile(!0)},null,null,"Ctrl+Shift-S"),this.addAction("export",function(){t.showDialog(new ExportDialog(t).container,300,200,!0,!0)},null,null,"Ctrl+E"),this.put("editFile",new Action(mxResources.get("edit"),mxUtils.bind(this,function(){this.editorUi.showDialog(new EditFileDialog(t).container,620,420,!0,!0)}))),this.addAction("pageSetup",function(){t.showDialog(new PageSetupDialog(t).container,300,200,!0,!0)}),this.addAction("print",function(){t.showDialog(new PrintDialog(t).container,300,200,!0,!0)},null,"sprite-print","Ctrl+P"),this.addAction("preview",function(){mxUtils.show(n,null,10,10)}),this.addAction("undo",function(){e.undoManager.undo()},null,"sprite-undo","Ctrl+Z"),this.addAction("redo",function(){e.undoManager.redo()},null,"sprite-redo","Ctrl+Y"),this.addAction("cut",function(){mxClipboard.cut(n)},null,"sprite-cut","Ctrl+X"),this.addAction("copy",function(){mxClipboard.copy(n)},null,"sprite-copy","Ctrl+C"),this.addAction("paste",function(){mxClipboard.paste(n)},!1,"sprite-paste","Ctrl+V"),this.addAction("delete",function(){n.connectionHandler.isConnecting()?n.connectionHandler.reset():n.removeCells()},null,null,"Delete"),this.addAction("duplicate",function(){var t=n.gridSize;n.setSelectionCells(n.moveCells(n.getSelectionCells(),t,t,!0))},null,null,"Ctrl+D"),this.addAction("selectVertices",function(){n.selectVertices()},null,null,"Ctrl+Shift+V"),this.addAction("selectEdges",function(){n.selectEdges()},null,null,"Ctrl+Shift+E"),this.addAction("selectAll",function(){n.selectAll()},null,null,"Ctrl+A"),this.addAction("lockUnlock",function(){n.getModel().beginUpdate();try{n.toggleCellStyles(mxConstants.STYLE_RESIZABLE,1),n.toggleCellStyles(mxConstants.STYLE_MOVABLE,1),n.toggleCellStyles(mxConstants.STYLE_ROTATABLE,1)}finally{n.getModel().endUpdate()}},null,null,"Ctrl+L"),this.addAction("home",function(){n.home()},null,null,"Home"),this.addAction("exitGroup",function(){n.exitGroup()},null,null,"Page Up"),this.addAction("enterGroup",function(){n.enterGroup()},null,null,"Page Down"),this.addAction("expand",function(){n.foldCells(!1)},null,null,"Enter"),this.addAction("collapse",function(){n.foldCells(!0)},null,null,"Backspace"),this.addAction("toFront",function(){n.orderCells(!1)},null,null,"Ctrl+F"),this.addAction("toBack",function(){n.orderCells(!0)},null,null,"Ctrl+B"),this.addAction("group",function(){n.setSelectionCell(n.groupCells(null,0))},null,null,"Ctrl+G"),this.addAction("ungroup",function(){n.setSelectionCells(n.ungroupCells())},null,null,"Ctrl+U"),this.addAction("removeFromGroup",function(){n.removeCellsFromParent()}),this.addAction("editLink",function(){var t=n.getSelectionCell(),e=n.getLinkForCell(t);null==e&&(e=""),e=mxUtils.prompt(mxResources.get("enterValue"),e),null!=e&&n.setLinkForCell(t,e)}),this.addAction("openLink",function(){var t=n.getSelectionCell(),e=n.getLinkForCell(t);null!=e&&window.open(e)}),this.addAction("autosize",function(){var t=n.getSelectionCells();if(null!=t){n.getModel().beginUpdate();try{for(var e=0;e<t.length;e++){var i=t[e];n.getModel().getChildCount(i)?n.updateGroupBounds([i],20):n.updateCellSize(i)}}finally{n.getModel().endUpdate()}}}),this.addAction("wordWrap",function(){var t=n.getView().getState(n.getSelectionCell()),e="wrap";null!=t&&"wrap"==t.style[mxConstants.STYLE_WHITE_SPACE]&&(e=null),n.setCellStyles(mxConstants.STYLE_WHITE_SPACE,e)}),this.addAction("rotation",function(){var t="0",e=n.getView().getState(n.getSelectionCell());null!=e&&(t=e.style[mxConstants.STYLE_ROTATION]||t),t=mxUtils.prompt(mxResources.get("enterValue")+" ("+mxResources.get("rotation")+" 0-360)",t),null!=t&&n.setCellStyles(mxConstants.STYLE_ROTATION,t)}),this.addAction("tilt",function(){var t=n.getSelectionCells();if(null!=t){n.getModel().beginUpdate();try{for(var e=0;e<t.length;e++){var i=t[e];if(n.getModel().isVertex(i)&&0==n.getModel().getChildCount(i)){var o=n.getCellGeometry(i);if(null!=o){o=o.clone(),o.x+=o.width/2-o.height/2,o.y+=o.height/2-o.width/2;var r=o.width;o.width=o.height,o.height=r,n.getModel().setGeometry(i,o);var s=n.view.getState(i);if(null!=s){var l=s.style[mxConstants.STYLE_DIRECTION]||"east";"east"==l?l="south":"south"==l?l="west":"west"==l?l="north":"north"==l&&(l="east"),n.setCellStyles(mxConstants.STYLE_DIRECTION,l,[i])}}}}}finally{n.getModel().endUpdate()}}},null,null,"Ctrl+R"),this.addAction("actualSize",function(){n.zoomTo(1)}),this.addAction("zoomIn",function(){n.zoomIn()},null,null,"Add"),this.addAction("zoomOut",function(){n.zoomOut()},null,null,"Subtract"),this.addAction("fitWindow",function(){n.fit()}),this.addAction("fitPage",mxUtils.bind(this,function(){n.pageVisible||this.get("pageView").funct();var t=n.pageFormat,e=n.pageScale,i=n.container.clientWidth-20,o=n.container.clientHeight-20,r=Math.floor(100*Math.min(i/t.width/e,o/t.height/e))/100;n.zoomTo(r),n.container.scrollLeft=Math.round(n.view.translate.x*r-Math.max(10,(n.container.clientWidth-t.width*e*r)/2)),n.container.scrollTop=Math.round(n.view.translate.y*r-Math.max(10,(n.container.clientHeight-t.height*e*r)/2))})),this.addAction("fitPageWidth",mxUtils.bind(this,function(){n.pageVisible||this.get("pageView").funct();var t=n.pageFormat,e=n.pageScale,i=n.container.clientWidth-20,o=Math.floor(100*i/t.width/e)/100;n.zoomTo(o),n.container.scrollLeft=Math.round(n.view.translate.x*o-Math.max(10,(n.container.clientWidth-t.width*e*o)/2)),n.container.scrollTop=Math.round(n.view.translate.y*o-Math.max(10,(n.container.clientHeight-t.height*e*o)/2))})),this.put("customZoom",new Action(mxResources.get("custom"),function(){var t=mxUtils.prompt(mxResources.get("enterValue")+" (%)",parseInt(100*n.getView().getScale()));null!=t&&t.length>0&&!isNaN(parseInt(t))&&n.zoomTo(parseInt(t)/100)}));var i=null;i=this.addAction("grid",function(){n.setGridEnabled(!n.isGridEnabled()),e.updateGraphComponents()},null,null,"Ctrl+Shift+G"),i.setToggleAction(!0),i.setSelectedCallback(function(){return n.isGridEnabled()}),i=this.addAction("guides",function(){n.graphHandler.guidesEnabled=!n.graphHandler.guidesEnabled}),i.setToggleAction(!0),i.setSelectedCallback(function(){return n.graphHandler.guidesEnabled}),i=this.addAction("tooltips",function(){n.tooltipHandler.setEnabled(!n.tooltipHandler.isEnabled())}),i.setToggleAction(!0),i.setSelectedCallback(function(){return n.tooltipHandler.isEnabled()}),i=this.addAction("navigation",function(){n.foldingEnabled=!n.foldingEnabled,n.view.revalidate()}),i.setToggleAction(!0),i.setSelectedCallback(function(){return n.foldingEnabled}),i=this.addAction("scrollbars",function(){if(n.scrollbars=!n.scrollbars,e.updateGraphComponents(),n.scrollbars){var t=n.view.translate.x,i=n.view.translate.y;n.view.translate.x=0,n.view.translate.y=0,n.sizeDidChange(),n.container.scrollLeft-=Math.round(t*n.view.scale),n.container.scrollTop-=Math.round(i*n.view.scale)}else{var o=n.view.translate;n.view.setTranslate(o.x-n.container.scrollLeft/n.view.scale,o.y-n.container.scrollTop/n.view.scale),n.container.scrollLeft=0,n.container.scrollTop=0,n.sizeDidChange()}},!mxClient.IS_TOUCH),i.setToggleAction(!0),i.setSelectedCallback(function(){return"auto"==n.container.style.overflow}),i=this.addAction("pageView",mxUtils.bind(this,function(){n.pageVisible=!n.pageVisible,n.pageBreaksVisible=n.pageVisible,n.preferPageSize=n.pageBreaksVisible,n.view.validate(),n.sizeDidChange(),e.updateGraphComponents(),e.outline.update(),mxUtils.hasScrollbars(n.container)&&(n.pageVisible?(n.container.scrollLeft-=20,n.container.scrollTop-=20):(n.container.scrollLeft+=20,n.container.scrollTop+=20))})),i.setToggleAction(!0),i.setSelectedCallback(function(){return n.pageVisible}),this.put("pageBackgroundColor",new Action(mxResources.get("backgroundColor"),function(){var i=function(t){n.background=t,e.updateGraphComponents()},o=new ColorDialog(t,n.background||"none",i);t.showDialog(o.container,220,400,!0,!1),mxClient.IS_TOUCH||o.colorInput.focus()})),i=this.addAction("connect",function(){n.setConnectable(!n.connectionHandler.isEnabled())},null,null,"Ctrl+Q"),i.setToggleAction(!0),i.setSelectedCallback(function(){return n.connectionHandler.isEnabled()}),i=this.addAction("copyConnect",function(){n.connectionHandler.setCreateTarget(!n.connectionHandler.isCreateTarget())}),i.setToggleAction(!0),i.setSelectedCallback(function(){return n.connectionHandler.isCreateTarget()}),this.addAction("help",function(){var t="";mxResources.isLanguageSupported(mxClient.language)&&(t="_"+mxClient.language),window.open(RESOURCES_PATH+"/help"+t+".html")}),this.put("about",new Action(mxResources.get("about")+" Graph Editor",function(){t.showDialog(new AboutDialog(t).container,320,280,!0,!0)},null,null,"F1"));var o=mxUtils.bind(this,function(t,e){this.addAction(t,function(){n.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,e)})});o("bold",mxConstants.FONT_BOLD),o("italic",mxConstants.FONT_ITALIC),o("underline",mxConstants.FONT_UNDERLINE),this.addAction("fontColor",function(){t.menus.pickColor(mxConstants.STYLE_FONTCOLOR)}),this.addAction("strokeColor",function(){t.menus.pickColor(mxConstants.STYLE_STROKECOLOR)}),this.addAction("fillColor",function(){t.menus.pickColor(mxConstants.STYLE_FILLCOLOR)}),this.addAction("gradientColor",function(){t.menus.pickColor(mxConstants.STYLE_GRADIENTCOLOR)}),this.addAction("backgroundColor",function(){t.menus.pickColor(mxConstants.STYLE_LABEL_BACKGROUNDCOLOR)}),this.addAction("borderColor",function(){t.menus.pickColor(mxConstants.STYLE_LABEL_BORDERCOLOR)}),this.addAction("shadow",function(){n.toggleCellStyles(mxConstants.STYLE_SHADOW)}),this.addAction("dashed",function(){n.toggleCellStyles(mxConstants.STYLE_DASHED)}),this.addAction("rounded",function(){n.toggleCellStyles(mxConstants.STYLE_ROUNDED)}),this.addAction("curved",function(){n.toggleCellStyles(mxConstants.STYLE_CURVED)}),this.addAction("style",function(){var t=n.getSelectionCells();if(null!=t&&t.length>0){var e=n.getModel(),i=mxUtils.prompt(mxResources.get("enterValue")+" ("+mxResources.get("style")+")",e.getStyle(t[0])||"");null!=i&&n.setCellStyle(i,t)}}),this.addAction("setAsDefaultEdge",function(){n.setDefaultEdge(n.getSelectionCell())}),this.addAction("addWaypoint",function(){var t=n.getSelectionCell();if(null!=t&&n.getModel().isEdge(t)){var i=e.graph.selectionCellsHandler.getHandler(t);if(i instanceof mxEdgeHandler){var o=n.view.translate,r=n.view.scale,s=o.x,l=o.y,a=n.getModel().getParent(t),h=n.getCellGeometry(a);n.getModel().isVertex(a)&&null!=h&&(s+=h.x,l+=h.y),i.addPointAt(i.state,n.panningHandler.triggerX/r-s,n.panningHandler.triggerY/r-l)}}}),this.addAction("removeWaypoint",function(){var e=t.actions.get("removeWaypoint");null!=e.handler&&e.handler.removePoint(e.handler.state,e.index)}),this.addAction("image",function(){function t(t,e,i){var o=null,r=n.getSelectionCells();n.getModel().beginUpdate();try{if(0==r.length){var s=n.getGridSize();r=[n.insertVertex(n.getDefaultParent(),null,"",s,s,e,i)],o=r}if(n.setCellStyles(mxConstants.STYLE_IMAGE,t,r),n.setCellStyles(mxConstants.STYLE_SHAPE,"image",r),1==n.getSelectionCount()&&null!=e&&null!=i){var l=r[0],a=n.getModel().getGeometry(l);null!=a&&(a=a.clone(),a.width=e,a.height=i,n.getModel().setGeometry(l,a))}}finally{n.getModel().endUpdate()}null!=o&&(n.setSelectionCells(o),n.scrollCellToVisible(o[0]))}var e="",i=n.getView().getState(n.getSelectionCell());if(null!=i&&(e=i.style[mxConstants.STYLE_IMAGE]||e),e=mxUtils.prompt(mxResources.get("enterValue")+" ("+mxResources.get("url")+")",e),null!=e&&e.length>0){var o=new Image;o.onload=function(){t(e,o.width,o.height)},o.onerror=function(){mxUtils.alert(mxResources.get("fileNotFound"))},o.src=e}})},Actions.prototype.addAction=function(t,e,n,i,o){return this.put(t,new Action(mxResources.get(t),e,n,i,o))},Actions.prototype.put=function(t,e){return this.actions[t]=e,e},Actions.prototype.get=function(t){return this.actions[t]},mxUtils.extend(Action,mxEventSource),Action.prototype.setEnabled=function(t){this.enabled!=t&&(this.enabled=t,this.fireEvent(new mxEventObject("stateChanged")))},Action.prototype.setToggleAction=function(t){this.toggleAction=t},Action.prototype.setSelectedCallback=function(t){this.selectedCallback=t},Action.prototype.isSelected=function(){return this.selectedCallback()},Dialog.prototype.close=function(){null!=this.onDialogClose&&(this.onDialogClose(),this.onDialogClose=null),null!=this.dialogImg&&(this.dialogImg.parentNode.removeChild(this.dialogImg),this.dialogImg=null),this.container.parentNode.removeChild(this.container),this.bg.parentNode.removeChild(this.bg)},ColorDialog.prototype.createApplyFunction=function(){return mxUtils.bind(this,function(t){this.editorUi.editor.graph.setCellStyles(this.currentColorKey,"none"==t?"none":t)})};var mxGraphFiles={save:function(t){var e=t.editor.graph,n=e.getGraphBounds(),i=(Math.ceil(n.width/s),Math.ceil(n.height/s),new mxImageExport),o=mxUtils.getXml(t.editor.getGraphXml()),r=1,s=1,n=e.getGraphBounds(),l=e.view.scale,a=mxUtils.createXmlDocument(),h=null!=a.createElementNS?a.createElementNS(mxConstants.NS_SVG,"svg"):a.createElement("svg");null!=e.background&&(null!=h.style?h.style.backgroundColor=e.background:h.setAttribute("style","background-color:"+e.background)),null==a.createElementNS&&h.setAttribute("xmlns",mxConstants.NS_SVG),h.setAttribute("width",Math.ceil(n.width*s/l+2*r)+"px"),h.setAttribute("height",Math.ceil(n.height*s/l+2*r)+"px"),h.setAttribute("xmlns:xlink",mxConstants.NS_XLINK),h.setAttribute("version","1.1");var d=null!=a.createElementNS?a.createElementNS(mxConstants.NS_SVG,"g"):a.createElement("g");d.setAttribute("transform","translate(0.5,0.5)"),h.appendChild(d),a.appendChild(h);var u=new mxSvgCanvas2D(d);u.translate(Math.floor((r/s-n.x)/l),Math.floor((r/s-n.y)/l)),u.scale(s/l),i.drawState(e.getView().getState(e.model.root),u);var c=mxUtils.getXml(h);if(c.length<MAX_REQUEST_SIZE){$("#draw_xml").val(o),$("#draw_svg").val(c);var p={xml:o,svg:c};return p}},load_xml:function(t,e){var n=mxUtils.parseXml(e);t.editor.setGraphXml(n.documentElement)}};/**
 * $Id: Graph.js,v 1.20 2013/05/04 20:16:05 gaudenz Exp $
 * Copyright (c) 2006-2012, JGraph Ltd
 */
Graph=function(t,e,n,i){mxGraph.call(this,t,e,n,i),this.setConnectable(!0),this.setDropEnabled(!0),this.setPanning(!0),this.setTooltips(!mxClient.IS_TOUCH),this.setAllowLoops(!0),this.allowAutoPanning=!0,this.resetEdgesOnConnect=!1,this.constrainChildren=!1,this.connectionHandler.setCreateTarget(!0),this.connectionHandler.isValidSource=function(){return mxConnectionHandler.prototype.isValidSource.apply(this,arguments)&&"2"!=urlParams.connect&&null!=urlParams.connect},this.alternateEdgeStyle="vertical",null==i&&this.loadStylesheet();var o=new mxRubberband(this);this.getRubberband=function(){return o},this.panningHandler.addListener(mxEvent.PAN_START,mxUtils.bind(this,function(){this.container.style.cursor="pointer"})),this.panningHandler.addListener(mxEvent.PAN_END,mxUtils.bind(this,function(){this.container.style.cursor="default"})),this.isHtmlLabel=function(t){var e=this.view.getState(t),n=null!=e?e.style:this.getCellStyle(t);return"1"==n.html||"wrap"==n.whiteSpace},this.cellRenderer.getLabelValue=function(t){var e=mxCellRenderer.prototype.getLabelValue.apply(this,arguments);return"wrap"==t.style.whiteSpace&&1!=t.style.html&&(e=mxUtils.htmlEntities(e,!1)),e},this.isCellLocked=function(){return!1},this.connectionHandler.tapAndHoldTolerance=16;var r=this.connectionHandler.tapAndHold;this.connectionHandler.tapAndHold=function(t,e){null==e?this.graph.panningHandler.active||(o.start(t.getGraphX(),t.getGraphY()),this.graph.panningHandler.panningTrigger=!1):tapAndHoldStartsConnection?r.apply(this,arguments):this.graph.isCellSelected(e.cell)&&this.graph.getSelectionCount()>1&&this.graph.removeSelectionCell(e.cell)},this.connectionHandler.selectCells=function(t,e){this.graph.setSelectionCell(e||t)},this.connectionHandler.constraintHandler.isStateIgnored=function(t,e){return e&&t.view.graph.isCellSelected(t.cell)},this.selectionModel.addListener(mxEvent.CHANGE,mxUtils.bind(this,function(){var t=this.connectionHandler.constraintHandler;null!=t.currentFocus&&t.isStateIgnored(t.currentFocus,!0)&&(t.currentFocus=null,t.constraints=null,t.destroyIcons()),t.destroyFocusHighlight()})),touchStyle&&this.initTouch()},mxUtils.extend(Graph,mxGraph),Graph.prototype.minFitScale=null,Graph.prototype.maxFitScale=null,Graph.prototype.loadStylesheet=function(){var t=mxUtils.load(STYLE_PATH+"/default.xml").getDocumentElement(),e=new mxCodec(t.ownerDocument);e.decode(t,this.getStylesheet())},Graph.prototype.flipEdge=function(t){if(null!=t){var e=this.view.getState(t),n=null!=e?e.style:this.getCellStyle(t);if(null!=n){var i=mxUtils.getValue(n,mxConstants.STYLE_ELBOW,mxConstants.ELBOW_HORIZONTAL),o=i==mxConstants.ELBOW_HORIZONTAL?mxConstants.ELBOW_VERTICAL:mxConstants.ELBOW_HORIZONTAL;this.setCellStyles(mxConstants.STYLE_ELBOW,o,[t])}}},Graph.prototype.setDefaultEdge=function(t){if(null!=t&&this.getModel().isEdge(t)){var e=this.getModel().cloneCell(t);null!=e.geometry&&(e.geometry.points=null);var n=e.getStyle();n=mxUtils.setStyle(n,mxConstants.STYLE_ENTRY_X,null),n=mxUtils.setStyle(n,mxConstants.STYLE_ENTRY_Y,null),n=mxUtils.setStyle(n,mxConstants.STYLE_EXIT_X,null),n=mxUtils.setStyle(n,mxConstants.STYLE_EXIT_Y,null),e.setStyle(n),this.connectionHandler.createEdgeState=function(){return this.graph.view.createState(e)},this.connectionHandler.factoryMethod=function(){return this.graph.cloneCells([e])[0]}}},Graph.prototype.isCellFoldable=function(t){return this.foldingEnabled&&this.isSwimlane(t)},Graph.prototype.isValidRoot=function(t){return this.isSwimlane(t)},Graph.prototype.createGroupCell=function(){var t=mxGraph.prototype.createGroupCell.apply(this,arguments);return t.setStyle("group"),t},Graph.prototype.getTooltipForCell=function(t){var e="";if(this.getModel().isVertex(t)){var n=this.getCellGeometry(t),i=function(t){return Math.round(100*parseFloat(t))/100};null!=n&&(null==e?e="":e.length>0&&(e+="\n"),e+="X: "+i(n.x)+"\nY: "+i(n.y)+"\nW: "+i(n.width)+"\nH: "+i(n.height))}else this.getModel().isEdge(t)&&(e=mxGraph.prototype.getTooltipForCell.apply(this,arguments));return e},Graph.prototype.convertValueToString=function(t){return null!=t.value&&"object"==typeof t.value?t.value.getAttribute("label"):mxGraph.prototype.convertValueToString.apply(this,arguments)},Graph.prototype.cellLabelChanged=function(t,e){if(null!=t.value&&"object"==typeof t.value){var n=t.value.cloneNode(!0);n.setAttribute("label",e),e=n}mxGraph.prototype.cellLabelChanged.apply(this,arguments)},Graph.prototype.setLinkForCell=function(t,e){var n=null;if(null!=t.value&&"object"==typeof t.value)n=t.value.cloneNode(!0);else{var i=mxUtils.createXmlDocument();n=i.createElement("UserObject"),n.setAttribute("label",t.value)}null!=e&&e.length>0?n.setAttribute("link",e):n.removeAttribute("link"),this.model.setValue(t,n)},Graph.prototype.getLinkForCell=function(t){return null!=t.value&&"object"==typeof t.value?t.value.getAttribute("link"):null},Graph.prototype.initTouch=function(){this.connectionHandler.marker.isEnabled=function(){return null!=this.graph.connectionHandler.first},this.addListener(mxEvent.START_EDITING,function(){this.panningHandler.hideMenu()});var t=!1,e=null;this.updateMouseEvent=function(t){if(mxGraph.prototype.updateMouseEvent.apply(this,arguments),null==t.getState()){var e=this.getCellAt(t.graphX,t.graphY);this.getModel().isEdge(e)&&(t.state=this.view.getState(e),null!=t.state&&null!=t.state.shape&&(this.container.style.cursor=t.state.shape.node.style.cursor))}null==t.getState()&&(this.container.style.cursor="default")},this.fireMouseEvent=function(n,i){if(n==mxEvent.MOUSE_DOWN)this.panningHandler.isMenuShowing()?(t=!1,e=null):(e=i.getCell(),t=null!=e?this.isCellSelected(e):this.isSelectionEmpty());else if(n==mxEvent.MOUSE_UP){if(t&&!this.isEditing()){if(!this.panningHandler.isMenuShowing()){var o=mxEvent.getClientX(i.getEvent()),r=mxEvent.getClientY(i.getEvent());this.panningHandler.popup(o+16,r,e,i.getEvent())}return t=!1,e=null,i.consume(),void 0}t=!1,e=null}mxGraph.prototype.fireMouseEvent.apply(this,arguments),n==mxEvent.MOUSE_MOVE&&i.isConsumed()&&(t=!1,e=null)}},function(){if(mxVertexHandler.prototype.rotationEnabled=!0,mxVertexHandler.prototype.livePreview=!mxClient.IS_TOUCH,mxEdgeHandler.prototype.livePreview=!mxClient.IS_TOUCH,mxText.prototype.baseSpacingTop=5,mxText.prototype.baseSpacingBottom=1,touchStyle){mxConstants.HANDLE_SIZE=16,mxConstants.LABEL_HANDLE_SIZE=7,mxClient.IS_TOUCH&&(mxVertexHandler.prototype.tolerance=4,mxEdgeHandler.prototype.tolerance=6,Graph.prototype.tolerance=14,Graph.prototype.gridSize=20,mxPanningHandler.prototype.selectOnPopup=!1,mxPanningHandler.prototype.useLeftButtonForPanning=!0,mxPanningHandler.prototype.isPanningTrigger=function(t){var e=t.getEvent();return this.useLeftButtonForPanning&&(this.ignoreCell||null==t.getState())||mxEvent.isControlDown(e)&&mxEvent.isShiftDown(e)||this.usePopupTrigger&&mxEvent.isPopupTrigger(e)});var t=mxGraphHandler.prototype.mouseDown;mxGraphHandler.prototype.mouseDown=function(e,n){t.apply(this,arguments),this.graph.isCellSelected(n.getCell())&&this.graph.getSelectionCount()>1&&(this.delayedSelection=!1)},Graph.prototype.createHandlers=function(){this.tooltipHandler=new mxTooltipHandler(this),this.tooltipHandler.setEnabled(!1),this.selectionCellsHandler=new mxSelectionCellsHandler(this),this.panningHandler=new mxPanningHandler(this),this.panningHandler.panningEnabled=!1,this.connectionHandler=new mxConnectionHandler(this),this.connectionHandler.setEnabled(!1),this.graphHandler=new mxGraphHandler(this)};var e=mxGraph.prototype.dblClick;Graph.prototype.dblClick=function(t,n){if(null==n){var i=mxUtils.convertPoint(this.container,mxEvent.getClientX(t),mxEvent.getClientY(t));n=this.getCellAt(i.x,i.y)}e.call(this,t,n)};var n=new mxImage(IMAGE_PATH+"/touch-handle.png",16,16);mxVertexHandler.prototype.handleImage=n,mxEdgeHandler.prototype.handleImage=n,mxOutline.prototype.sizerImage=n,(new Image).src=n.src;var i=IMAGE_PATH+"/touch-connector.png",o=mxVertexHandler.prototype.init;mxVertexHandler.prototype.init=function(){o.apply(this,arguments),showConnectorImg&&this.graph.connectionHandler.isEnabled()&&this.graph.isCellConnectable(this.state.cell)&&!this.graph.isValidRoot(this.state.cell)&&1==this.graph.getSelectionCount()&&(this.connectorImg=mxUtils.createImage(i),this.connectorImg.style.cursor="pointer",this.connectorImg.style.width="29px",this.connectorImg.style.height="29px",this.connectorImg.style.position="absolute",mxClient.IS_TOUCH||(this.connectorImg.setAttribute("title",mxResources.get("connect")),mxEvent.redirectMouseEvents(this.connectorImg,this.graph,this.state)),this.connectorImg.style.padding="2px",mxEvent.addGestureListeners(this.connectorImg,mxUtils.bind(this,function(t){this.graph.panningHandler.hideMenu();var e=mxUtils.convertPoint(this.graph.container,mxEvent.getClientX(t),mxEvent.getClientY(t));this.graph.connectionHandler.start(this.state,e.x,e.y),this.graph.isMouseDown=!0,mxEvent.consume(t)})),this.graph.container.appendChild(this.connectorImg)),this.redrawTools()};var r=mxVertexHandler.prototype.redrawHandles;mxVertexHandler.prototype.redrawHandles=function(){r.apply(this),this.redrawTools()},mxVertexHandler.prototype.redrawTools=function(){if(null!=this.state&&null!=this.connectorImg){var t=new mxPoint,e=this.state;mxVertexHandler.prototype.singleSizer?(t.x=e.x+e.width-this.connectorImg.offsetWidth/2,t.y=e.y-this.connectorImg.offsetHeight/2):(t.x=e.x+e.width+mxConstants.HANDLE_SIZE/2+4+this.connectorImg.offsetWidth/2,t.y=e.y+e.height/2);var n=mxUtils.toRadians(mxUtils.getValue(e.style,mxConstants.STYLE_ROTATION,0));if(0!=n){var i=Math.cos(n),o=Math.sin(n),r=new mxPoint(e.getCenterX(),e.getCenterY());t=mxUtils.getRotatedPoint(t,i,o,r)}this.connectorImg.style.left=t.x-this.connectorImg.offsetWidth/2+"px",this.connectorImg.style.top=t.y-this.connectorImg.offsetHeight/2+"px"}};var s=mxVertexHandler.prototype.destroy;mxVertexHandler.prototype.destroy=function(){s.apply(this,arguments),null!=this.connectorImg&&(this.connectorImg.parentNode.removeChild(this.connectorImg),this.connectorImg=null)},(new Image).src=i}else{var l=new mxImage(IMAGE_PATH+"/connector.png",15,15);if(mxConnectionHandler.prototype.connectImage=l,(new Image).src=l.src,null==urlParams.connect||"2"==urlParams.connect){var l=new mxImage(IMAGE_PATH+"/connector.png",15,15),o=mxVertexHandler.prototype.init;mxVertexHandler.prototype.init=function(){this.singleSizer=this.state.width<30&&this.state.height<30,o.apply(this,arguments),showConnectorImg&&this.graph.connectionHandler.isEnabled()&&this.graph.isCellConnectable(this.state.cell)&&!this.graph.isValidRoot(this.state.cell)&&1==this.graph.getSelectionCount()&&(mxClient.IS_IE&&!mxClient.IS_SVG?(this.connectorImg=document.createElement("div"),this.connectorImg.style.backgroundImage="url("+l.src+")",this.connectorImg.style.backgroundPosition="center",this.connectorImg.style.backgroundRepeat="no-repeat",this.connectorImg.style.width=l.width+4+"px",this.connectorImg.style.height=l.height+4+"px",this.connectorImg.style.display=mxClient.IS_QUIRKS?"inline":"inline-block"):(this.connectorImg=mxUtils.createImage(l.src),this.connectorImg.style.width=l.width+"px",this.connectorImg.style.height=l.height+"px"),this.connectorImg.style.cursor="pointer",this.connectorImg.style.position="absolute",this.connectorImg.setAttribute("title",mxResources.get("connect")),mxEvent.redirectMouseEvents(this.connectorImg,this.graph,this.state),this.connectorImg.style.padding="2px",mxEvent.addListener(this.connectorImg,"mousedown",mxUtils.bind(this,function(t){this.graph.panningHandler.hideMenu();var e=mxUtils.convertPoint(this.graph.container,mxEvent.getClientX(t),mxEvent.getClientY(t));this.graph.connectionHandler.start(this.state,e.x,e.y),this.graph.isMouseDown=!0,mxEvent.consume(t)})),this.graph.container.appendChild(this.connectorImg)),this.redrawTools()};var r=mxVertexHandler.prototype.redrawHandles;mxVertexHandler.prototype.redrawHandles=function(){r.apply(this),this.redrawTools()},mxVertexHandler.prototype.redrawTools=function(){if(null!=this.state&&null!=this.connectorImg){var t=new mxPoint,e=this.state;mxVertexHandler.prototype.singleSizer?(t.x=e.x+e.width-this.connectorImg.offsetWidth/2,t.y=e.y):(t.x=e.x+e.width+mxConstants.HANDLE_SIZE/2+2+this.connectorImg.offsetWidth/2,t.y=e.y+e.height/2);var n=mxUtils.toRadians(mxUtils.getValue(e.style,mxConstants.STYLE_ROTATION,0));if(0!=n){var i=Math.cos(n),o=Math.sin(n),r=new mxPoint(e.getCenterX(),e.getCenterY());t=mxUtils.getRotatedPoint(t,i,o,r)}this.connectorImg.style.left=t.x-this.connectorImg.offsetWidth/2+"px",this.connectorImg.style.top=t.y-this.connectorImg.offsetHeight/2+"px"}};var s=mxVertexHandler.prototype.destroy;mxVertexHandler.prototype.destroy=function(){s.apply(this,arguments),null!=this.connectorImg&&(this.connectorImg.parentNode.removeChild(this.connectorImg),this.connectorImg=null)}}}}(),/**
 * $Id: Menus.js,v 1.16 2013/05/07 09:48:56 gaudenz Exp $
 * Copyright (c) 2006-2012, JGraph Ltd
 */
Menus=function(t){this.editorUi=t,this.menus=new Object,this.init(),(new Image).src=IMAGE_PATH+"/checkmark.gif"},Menus.prototype.init=function(){var t=this.editorUi.editor.graph;this.put("fontFamily",new Menu(mxUtils.bind(this,function(t,e){for(var n=["Helvetica","Verdana","Times New Roman","Garamond","Comic Sans MS","Courier New","Georgia","Lucida Console","Tahoma"],i=0;i<n.length;i++){var o=this.styleChange(t,n[i],[mxConstants.STYLE_FONTFAMILY],[n[i]],null,e);o.firstChild.nextSibling.style.fontFamily=n[i]}t.addSeparator(e),this.promptChange(t,mxResources.get("custom"),"",mxConstants.DEFAULT_FONTFAMILY,mxConstants.STYLE_FONTFAMILY,e)}))),this.put("fontSize",new Menu(mxUtils.bind(this,function(t,e){for(var n=[6,8,9,10,11,12,14,18,24,36,48,72],i=0;i<n.length;i++)this.styleChange(t,n[i],[mxConstants.STYLE_FONTSIZE],[n[i]],null,e);t.addSeparator(e),this.promptChange(t,mxResources.get("custom"),"(pt)","12",mxConstants.STYLE_FONTSIZE,e)}))),this.put("linewidth",new Menu(mxUtils.bind(this,function(t,e){for(var n=[1,2,3,4,8,12,16,24],i=0;i<n.length;i++)this.styleChange(t,n[i]+"px",[mxConstants.STYLE_STROKEWIDTH],[n[i]],null,e);t.addSeparator(e),this.promptChange(t,mxResources.get("custom"),"(px)","1",mxConstants.STYLE_STROKEWIDTH,e)}))),this.put("line",new Menu(mxUtils.bind(this,function(t,e){this.styleChange(t,mxResources.get("straight"),[mxConstants.STYLE_EDGE],[null],null,e),this.styleChange(t,mxResources.get("entityRelation"),[mxConstants.STYLE_EDGE],["entityRelationEdgeStyle"],null,e),t.addSeparator(e),this.styleChange(t,mxResources.get("horizontal"),[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW],["elbowEdgeStyle","horizontal"],null,e),this.styleChange(t,mxResources.get("vertical"),[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW],["elbowEdgeStyle","vertical"],null,e),t.addSeparator(e),this.styleChange(t,mxResources.get("manual"),[mxConstants.STYLE_EDGE],["segmentEdgeStyle"],null,e),this.styleChange(t,mxResources.get("automatic"),[mxConstants.STYLE_EDGE],["orthogonalEdgeStyle"],null,e)}))),this.put("lineend",new Menu(mxUtils.bind(this,function(e,n){this.styleChange(e,mxResources.get("classic"),[mxConstants.STYLE_ENDARROW],[mxConstants.ARROW_CLASSIC],null,n),this.styleChange(e,mxResources.get("openArrow"),[mxConstants.STYLE_ENDARROW],[mxConstants.ARROW_OPEN],null,n),this.styleChange(e,mxResources.get("block"),[mxConstants.STYLE_ENDARROW],[mxConstants.ARROW_BLOCK],null,n),e.addSeparator(n),this.styleChange(e,mxResources.get("oval"),[mxConstants.STYLE_ENDARROW],[mxConstants.ARROW_OVAL],null,n),this.styleChange(e,mxResources.get("diamond"),[mxConstants.STYLE_ENDARROW],[mxConstants.ARROW_DIAMOND],null,n),this.styleChange(e,mxResources.get("diamondThin"),[mxConstants.STYLE_ENDARROW],[mxConstants.ARROW_DIAMOND_THIN],null,n),e.addSeparator(n),this.styleChange(e,mxResources.get("none"),[mxConstants.STYLE_ENDARROW],[mxConstants.NONE],null,n),e.addSeparator(n),e.addItem(mxResources.get("transparent"),null,function(){t.toggleCellStyles("endFill",!0)},n,null,!0),e.addSeparator(n),this.promptChange(e,mxResources.get("size"),"(px)",mxConstants.DEFAULT_MARKERSIZE,mxConstants.STYLE_ENDSIZE,n)}))),this.put("linestart",new Menu(mxUtils.bind(this,function(e,n){this.styleChange(e,mxResources.get("classic"),[mxConstants.STYLE_STARTARROW],[mxConstants.ARROW_CLASSIC],null,n),this.styleChange(e,mxResources.get("openArrow"),[mxConstants.STYLE_STARTARROW],[mxConstants.ARROW_OPEN],null,n),this.styleChange(e,mxResources.get("block"),[mxConstants.STYLE_STARTARROW],[mxConstants.ARROW_BLOCK],null,n),e.addSeparator(n),this.styleChange(e,mxResources.get("oval"),[mxConstants.STYLE_STARTARROW],[mxConstants.ARROW_OVAL],null,n),this.styleChange(e,mxResources.get("diamond"),[mxConstants.STYLE_STARTARROW],[mxConstants.ARROW_DIAMOND],null,n),this.styleChange(e,mxResources.get("diamondThin"),[mxConstants.STYLE_STARTARROW],[mxConstants.ARROW_DIAMOND_THIN],null,n),e.addSeparator(n),this.styleChange(e,mxResources.get("none"),[mxConstants.STYLE_STARTARROW],[mxConstants.NONE],null,n),e.addSeparator(n),e.addItem(mxResources.get("transparent"),null,function(){t.toggleCellStyles("startFill",!0)},n,null,!0),e.addSeparator(n),this.promptChange(e,mxResources.get("size"),"(px)",mxConstants.DEFAULT_MARKERSIZE,mxConstants.STYLE_STARTSIZE,n)}))),this.put("spacing",new Menu(mxUtils.bind(this,function(t,e){var n=this.editorUi.actions.get("shadow").enabled,i=this.get("line").enabled;(n||t.showDisabled)&&(this.promptChange(t,mxResources.get("top"),"(px)","0",mxConstants.STYLE_SPACING_TOP,e,n),this.promptChange(t,mxResources.get("right"),"(px)","0",mxConstants.STYLE_SPACING_RIGHT,e,n),this.promptChange(t,mxResources.get("bottom"),"(px)","0",mxConstants.STYLE_SPACING_BOTTOM,e,n),this.promptChange(t,mxResources.get("left"),"(px)","0",mxConstants.STYLE_SPACING_LEFT,e,n),t.addSeparator(e),this.promptChange(t,mxResources.get("global"),"(px)","0",mxConstants.STYLE_SPACING,e,n),this.promptChange(t,mxResources.get("perimeter"),"(px)","0",mxConstants.STYLE_PERIMETER_SPACING,e,n)),(i||t.showDisabled)&&(t.addSeparator(e),this.promptChange(t,mxResources.get("sourceSpacing"),"(px)","0",mxConstants.STYLE_SOURCE_PERIMETER_SPACING,e,i),this.promptChange(t,mxResources.get("targetSpacing"),"(px)","0",mxConstants.STYLE_TARGET_PERIMETER_SPACING,e,i))}))),this.put("format",new Menu(mxUtils.bind(this,function(t,e){this.addMenuItems(t,["fillColor"],e),this.addSubmenu("gradient",t,e),this.addMenuItems(t,["-","shadow"],e),this.promptChange(t,mxResources.get("opacity"),"(%)","100",mxConstants.STYLE_OPACITY,e,this.get("format").enabled),this.addMenuItems(t,["-","curved","rounded","dashed","-","strokeColor"],e),this.addSubmenu("linewidth",t,e),this.addMenuItems(t,["-"],e),this.addSubmenu("line",t,e),this.addMenuItems(t,["-"],e),this.addSubmenu("linestart",t,e),this.addSubmenu("lineend",t,e),t.addSeparator(e),this.addMenuItem(t,"style",e)}))),this.put("gradient",new Menu(mxUtils.bind(this,function(t,e){this.addMenuItems(t,["gradientColor","-"],e),this.styleChange(t,mxResources.get("north"),[mxConstants.STYLE_GRADIENT_DIRECTION],[mxConstants.DIRECTION_NORTH],null,e),this.styleChange(t,mxResources.get("east"),[mxConstants.STYLE_GRADIENT_DIRECTION],[mxConstants.DIRECTION_EAST],null,e),this.styleChange(t,mxResources.get("south"),[mxConstants.STYLE_GRADIENT_DIRECTION],[mxConstants.DIRECTION_SOUTH],null,e),this.styleChange(t,mxResources.get("west"),[mxConstants.STYLE_GRADIENT_DIRECTION],[mxConstants.DIRECTION_WEST],null,e)}))),this.put("text",new Menu(mxUtils.bind(this,function(e,n){var i=this.get("text").enabled;e.addSeparator(n),this.addMenuItem(e,"fontColor",n),this.addMenuItems(e,["backgroundColor","borderColor","-"],n),this.addSubmenu("fontFamily",e,n),this.addSubmenu("fontSize",e,n),this.addMenuItems(e,["-","bold","italic","underline","-"],n),this.addSubmenu("alignment",e,n),this.addMenuItem(e,"wordWrap",n),e.addSeparator(n),this.promptChange(e,mxResources.get("textOpacity"),"(%)","100",mxConstants.STYLE_TEXT_OPACITY,n,i),e.addItem(mxResources.get("hide"),null,function(){t.toggleCellStyles(mxConstants.STYLE_NOLABEL,!1)},n,null,i)}))),this.put("alignment",new Menu(mxUtils.bind(this,function(e,n){this.styleChange(e,mxResources.get("leftAlign"),[mxConstants.STYLE_ALIGN],[mxConstants.ALIGN_LEFT],null,n),this.styleChange(e,mxResources.get("center"),[mxConstants.STYLE_ALIGN],[mxConstants.ALIGN_CENTER],null,n),this.styleChange(e,mxResources.get("rightAlign"),[mxConstants.STYLE_ALIGN],[mxConstants.ALIGN_RIGHT],null,n),e.addSeparator(n),this.styleChange(e,mxResources.get("topAlign"),[mxConstants.STYLE_VERTICAL_ALIGN],[mxConstants.ALIGN_TOP],null,n),this.styleChange(e,mxResources.get("middle"),[mxConstants.STYLE_VERTICAL_ALIGN],[mxConstants.ALIGN_MIDDLE],null,n),this.styleChange(e,mxResources.get("bottomAlign"),[mxConstants.STYLE_VERTICAL_ALIGN],[mxConstants.ALIGN_BOTTOM],null,n),e.addSeparator(n),this.addSubmenu("position",e,n),this.addSubmenu("spacing",e,n),e.addSeparator(n);var i=this.get("text").enabled;e.addItem(mxResources.get("vertical"),null,function(){t.toggleCellStyles(mxConstants.STYLE_HORIZONTAL,!0)},n,null,i)}))),this.put("position",new Menu(mxUtils.bind(this,function(t,e){this.styleChange(t,mxResources.get("left"),[mxConstants.STYLE_LABEL_POSITION,mxConstants.STYLE_ALIGN],[mxConstants.ALIGN_LEFT,mxConstants.ALIGN_RIGHT],null,e),this.styleChange(t,mxResources.get("center"),[mxConstants.STYLE_LABEL_POSITION,mxConstants.STYLE_ALIGN],[mxConstants.ALIGN_CENTER,mxConstants.ALIGN_CENTER],null,e),this.styleChange(t,mxResources.get("right"),[mxConstants.STYLE_LABEL_POSITION,mxConstants.STYLE_ALIGN],[mxConstants.ALIGN_RIGHT,mxConstants.ALIGN_LEFT],null,e),t.addSeparator(e),this.styleChange(t,mxResources.get("top"),[mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.STYLE_VERTICAL_ALIGN],[mxConstants.ALIGN_TOP,mxConstants.ALIGN_BOTTOM],null,e),this.styleChange(t,mxResources.get("middle"),[mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.STYLE_VERTICAL_ALIGN],[mxConstants.ALIGN_MIDDLE,mxConstants.ALIGN_MIDDLE],null,e),this.styleChange(t,mxResources.get("bottom"),[mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.STYLE_VERTICAL_ALIGN],[mxConstants.ALIGN_BOTTOM,mxConstants.ALIGN_TOP],null,e)}))),this.put("direction",new Menu(mxUtils.bind(this,function(e,n){e.addItem(mxResources.get("flipH"),null,function(){t.toggleCellStyles(mxConstants.STYLE_FLIPH,!1)},n),e.addItem(mxResources.get("flipV"),null,function(){t.toggleCellStyles(mxConstants.STYLE_FLIPV,!1)},n),this.addMenuItems(e,["-","tilt","rotation"],n)}))),this.put("align",new Menu(mxUtils.bind(this,function(e,n){e.addItem(mxResources.get("leftAlign"),null,function(){t.alignCells(mxConstants.ALIGN_LEFT)},n),e.addItem(mxResources.get("center"),null,function(){t.alignCells(mxConstants.ALIGN_CENTER)},n),e.addItem(mxResources.get("rightAlign"),null,function(){t.alignCells(mxConstants.ALIGN_RIGHT)},n),e.addSeparator(n),e.addItem(mxResources.get("topAlign"),null,function(){t.alignCells(mxConstants.ALIGN_TOP)},n),e.addItem(mxResources.get("middle"),null,function(){t.alignCells(mxConstants.ALIGN_MIDDLE)},n),e.addItem(mxResources.get("bottomAlign"),null,function(){t.alignCells(mxConstants.ALIGN_BOTTOM)},n)}))),this.put("layers",new Menu(mxUtils.bind(this,function(e,n){var i=t.getDefaultParent(),o=mxResources.get("background"),r=e.addItem(o,null,mxUtils.bind(this,function(){t.setDefaultParent(null)}),n);i==t.model.getChildAt(t.model.root,0)&&this.addCheckmark(r);for(var s=t.model.getChildCount(t.model.root),l=1;s>l;l++)mxUtils.bind(this,function(r){var s=r.value||mxResources.get("layer")+" "+l;t.model.isVisible(r)||(s+=" ("+mxResources.get("hidden")+")");var a=e.addItem(s,null,function(){t.model.isVisible(r)||(t.model.setVisible(r,!0),t.view.invalidate()),t.setDefaultParent(r)},n);i==r&&(this.addCheckmark(a),o=s)})(t.model.getChildAt(t.model.root,l));var a=i!=t.model.getChildAt(t.model.root,0);e.addSeparator(n),e.addItem(mxResources.get("removeIt",[o]),null,mxUtils.bind(this,function(){t.removeCells([i]),t.setDefaultParent(null)}),n,null,a),e.addItem(mxResources.get("renameIt",[o]),null,mxUtils.bind(this,function(){var e=mxUtils.prompt(mxResources.get("enterName"),o);null!=e&&e.length>0&&t.getModel().setValue(i,e)}),n,null,a),e.addItem(mxResources.get("hideIt",[o]),null,mxUtils.bind(this,function(){if(t.model.isVisible(i)){t.model.beginUpdate();try{t.model.setVisible(i,!t.model.isVisible(i)),t.view.invalidate()}finally{t.model.endUpdate()}t.setDefaultParent(null)}}),n,null,a),e.addSeparator(n),e.addItem(mxResources.get("moveSelectionTo",[o]),null,mxUtils.bind(this,function(){t.moveCells(t.getSelectionCells(),0,0,!1,i)}),n,null,!t.isSelectionEmpty()),e.addSeparator(n),e.addItem(mxResources.get("addLayer"),null,mxUtils.bind(this,function(){var e=t.addCell(new mxCell,t.model.root);t.setDefaultParent(e)}),n)}))),this.put("layout",new Menu(mxUtils.bind(this,function(e,n){e.addItem(mxResources.get("horizontalTree"),null,mxUtils.bind(this,function(){if(!t.isSelectionEmpty()){var e=new mxCompactTreeLayout(t,!0);e.edgeRouting=!1,e.levelDistance=30,this.editorUi.executeLayout(e,!0,!0)}}),n),e.addItem(mxResources.get("verticalTree"),null,mxUtils.bind(this,function(){if(!t.isSelectionEmpty()){var e=new mxCompactTreeLayout(t,!1);e.edgeRouting=!1,e.levelDistance=30,this.editorUi.executeLayout(e,!0,!0)}}),n),e.addSeparator(n),e.addItem(mxResources.get("horizontalFlow"),null,mxUtils.bind(this,function(){var e=new mxHierarchicalLayout(t,mxConstants.DIRECTION_WEST);this.editorUi.executeLayout(e,!0,!0)}),n),e.addItem(mxResources.get("verticalFlow"),null,mxUtils.bind(this,function(){var e=new mxHierarchicalLayout(t,mxConstants.DIRECTION_NORTH);this.editorUi.executeLayout(e,!0,!0)}),n),e.addSeparator(n),e.addItem(mxResources.get("organic"),null,mxUtils.bind(this,function(){var e=new mxFastOrganicLayout(t);this.editorUi.executeLayout(e,!0,!0)}),n),e.addItem(mxResources.get("circle"),null,mxUtils.bind(this,function(){var e=new mxCircleLayout(t);this.editorUi.executeLayout(e,!0,!0,t.getSelectionCells())}),n)}))),this.put("navigation",new Menu(mxUtils.bind(this,function(t,e){this.addMenuItems(t,["home","-","exitGroup","enterGroup","-","expand","collapse"],e)}))),this.put("arrange",new Menu(mxUtils.bind(this,function(t,e){this.addMenuItems(t,["toFront","toBack","-"],e),this.addSubmenu("direction",t,e),this.addSubmenu("layout",t,e),this.addSubmenu("align",t,e),t.addSeparator(e),this.addSubmenu("layers",t,e),this.addSubmenu("navigation",t,e),this.addMenuItems(t,["-","group","ungroup","removeFromGroup","-","lockUnlock","-","autosize"],e)}))),this.put("view",new Menu(mxUtils.bind(this,function(e,n){this.addMenuItems(e,["actualSize"],n),e.addSeparator();for(var i=[.25,.5,.75,1,1.5,2,4],o=0;o<i.length;o++)!function(i){e.addItem(100*i+"%",null,function(){t.zoomTo(i)},n)}(i[o]);this.addMenuItems(e,["-","zoomIn","zoomOut","-","fitWindow","customZoom","-","fitPage","fitPageWidth"],n)}))),this.put("file",new Menu(mxUtils.bind(this,function(t,e){this.addMenuItems(t,["new","open","-","save","saveAs","-","import","export","-","editFile","-","pageSetup","print"],e)}))),this.put("edit",new Menu(mxUtils.bind(this,function(t){this.addMenuItems(t,["undo","redo","-","cut","copy","paste","delete","-","duplicate","-","editLink","openLink","-","selectVertices","selectEdges","selectAll","-","setAsDefaultEdge"])}))),this.put("options",new Menu(mxUtils.bind(this,function(t){this.addMenuItems(t,["grid","guides","tooltips","-","connect","copyConnect","navigation","-","scrollbars","pageView","-","pageBackgroundColor"])}))),this.put("help",new Menu(mxUtils.bind(this,function(t){this.addMenuItems(t,["help","-","about"])})))},Menus.prototype.put=function(t,e){this.menus[t]=e},Menus.prototype.get=function(t){return this.menus[t]},Menus.prototype.addSubmenu=function(t,e,n){var i=this.get(t).enabled;if(e.showDisabled||i){var o=e.addItem(mxResources.get(t),null,null,n,null,i);this.addMenu(t,e,o)}},Menus.prototype.addMenu=function(t,e,n){var i=this.get(t);null!=i&&(e.showDisabled||i.enabled)&&this.get(t).execute(e,n)},Menus.prototype.styleChange=function(t,e,n,i,o,r){return t.addItem(e,null,mxUtils.bind(this,function(){var t=this.editorUi.editor.graph;t.getModel().beginUpdate();try{for(var e=0;e<n.length;e++)t.setCellStyles(n[e],i[e])}finally{t.getModel().endUpdate()}}),r,o)},Menus.prototype.promptChange=function(t,e,n,i,o,r,s){return t.addItem(e,null,mxUtils.bind(this,function(){var t=this.editorUi.editor.graph,e=i,r=t.getView().getState(t.getSelectionCell());null!=r&&(e=r.style[o]||e),e=mxUtils.prompt(mxResources.get("enterValue")+(n.length>0?" "+n:""),e),null!=e&&e.length>0&&t.setCellStyles(o,e)}),r,null,s)},Menus.prototype.pickColor=function(t){null==this.colorDialog&&(this.colorDialog=new ColorDialog(this.editorUi)),this.colorDialog.currentColorKey=t;var e=this.editorUi.editor.graph,n=e.getView().getState(e.getSelectionCell()),i="none";null!=n&&(i=n.style[t]||i),"none"==i?(i="ffffff",this.colorDialog.picker.fromString("ffffff"),this.colorDialog.colorInput.value="none"):this.colorDialog.picker.fromString(i),this.editorUi.showDialog(this.colorDialog.container,220,400,!0,!1),mxClient.IS_TOUCH||this.colorDialog.colorInput.focus()},Menus.prototype.addMenuItem=function(t,e,n){var i=this.editorUi.actions.get(e);if(null!=i&&(t.showDisabled||i.enabled)){var o=t.addItem(i.label,null,i.funct,n,null,i.enabled);return i.toggleAction&&i.isSelected()&&this.addCheckmark(o),this.addShortcut(o,i),o}return null},Menus.prototype.addShortcut=function(t,e){if(null!=e.shortcut){var n=t.firstChild.nextSibling.nextSibling,i=document.createElement("span");i.style.color="gray",mxUtils.write(i,e.shortcut),n.appendChild(i)}},Menus.prototype.addCheckmark=function(t){var e=t.firstChild.nextSibling;e.style.backgroundImage="url("+IMAGE_PATH+"/checkmark.gif)",e.style.backgroundRepeat="no-repeat",e.style.backgroundPosition="2px 50%"},Menus.prototype.addMenuItems=function(t,e,n){for(var i=0;i<e.length;i++)"-"==e[i]?t.addSeparator(n):this.addMenuItem(t,e[i],n)},Menus.prototype.createPopupMenu=function(t,e,n){var i=this.editorUi.editor.graph;if(t.smartSeparators=!0,i.isSelectionEmpty()?this.addMenuItems(t,["undo","redo","-","paste","-"]):(this.addMenuItems(t,["delete","-","cut","copy","-","duplicate"]),1==i.getSelectionCount()&&i.getModel().isEdge(i.getSelectionCell())&&this.addMenuItems(t,["setAsDefaultEdge"]),t.addSeparator()),i.getSelectionCount()>0){if(this.addMenuItems(t,["toFront","toBack","-"]),i.getModel().isEdge(i.getSelectionCell())){var o=!1,e=i.getSelectionCell();if(null!=e&&i.getModel().isEdge(e)){var r=i.selectionCellsHandler.getHandler(e);if(r instanceof mxEdgeHandler&&null!=r.bends&&r.bends.length>2){var s=r.getHandleForEvent(new mxMouseEvent(n)),l=this.editorUi.actions.get("removeWaypoint");l.handler=r,l.index=s,o=s>0&&s<r.bends.length}}this.addMenuItems(t,["-",o?"removeWaypoint":"addWaypoint"])}else i.getSelectionCount()>1&&(t.addSeparator(),this.addMenuItems(t,["group"]));if(t.addSeparator(),1==i.getSelectionCount()){var a=i.getLinkForCell(i.getSelectionCell());null!=a&&this.addMenuItems(t,["openLink"])}}else this.addMenuItems(t,["-","selectVertices","selectEdges","-","selectAll"])},Menus.prototype.createMenubar=function(t){for(var e=new Menubar(this.editorUi,t),n=["file","edit","view","format","text","arrange","options","help"],i=0;i<n.length;i++)e.addMenu(mxResources.get(n[i]),this.get(n[i]).funct);return e},Menubar.prototype.hideMenu=function(){null!=this.currentMenu&&this.currentMenu.hideMenu()},Menubar.prototype.addMenu=function(t,e){var n=document.createElement("a");return n.setAttribute("href","javascript:void(0);"),n.className="geItem",mxUtils.write(n,t),this.addMenuHandler(n,e),this.container.appendChild(n),n},Menubar.prototype.addMenuHandler=function(t,e){if(null!=e){var n=!0,i=mxUtils.bind(this,function(i){if(n&&null==t.enabled||t.enabled){this.editorUi.editor.graph.panningHandler.hideMenu();var o=new mxPopupMenu(e);o.div.className+=" geMenubarMenu",o.smartSeparators=!0,o.showDisabled=!0,o.autoExpand=!0,o.hideMenu=mxUtils.bind(this,function(){mxPopupMenu.prototype.hideMenu.apply(o,arguments),o.destroy(),this.currentMenu=null,this.currentElt=null}),o.popup(t.offsetLeft+4,t.offsetTop+t.offsetHeight+4,null,i),this.currentMenu=o,this.currentElt=t}n=!0,mxEvent.consume(i)});mxEvent.addListener(t,"mousemove",mxUtils.bind(this,function(e){null!=this.currentMenu&&this.currentElt!=t&&(this.hideMenu(),i(e))})),mxEvent.addListener(t,"mousedown",mxUtils.bind(this,function(){n=this.currentElt!=t})),mxEvent.addListener(t,"click",i)}},mxUtils.extend(Menu,mxEventSource),Menu.prototype.setEnabled=function(t){this.enabled!=t&&(this.enabled=t,this.fireEvent(new mxEventObject("stateChanged")))},Menu.prototype.execute=function(t,e){this.funct(t,e)},/**
 * $Id: Shapes.js,v 1.16 2013/05/03 14:43:42 gaudenz Exp $
 * Copyright (c) 2006-2012, JGraph Ltd
 */
function(){function t(){}function e(){}function n(){}function i(){}function o(){}function r(){}function s(){}function l(){}function a(){mxRectangleShape.call(this)}function h(){}function d(){mxRectangleShape.call(this)}function u(){mxRectangleShape.call(this)}function c(){}function p(){}function m(){}function g(){}function f(){}function x(){}function C(){mxArrow.call(this)}function E(t){mxVertexHandler.call(this,t)}function y(t){E.call(this,t)}function v(t){y.call(this,t)}function T(t){y.call(this,t)}function b(t){T.call(this,t)}function I(t){T.call(this,t)}function S(t){T.call(this,t)}function O(t){T.call(this,t)}function R(t){T.call(this,t)}function w(t){T.call(this,t)}function D(t){w.call(this,t)}function _(t){T.call(this,t)}t.prototype=new mxCylinder,t.prototype.constructor=t,t.prototype.size=20,t.prototype.redrawPath=function(t,e,n,i,o,r){var s=Math.min(i,Math.min(o,mxUtils.getValue(this.style,"size",this.size)));r?(t.moveTo(s,o),t.lineTo(s,s),t.lineTo(0,0),t.moveTo(s,s),t.lineTo(i,s),t.end()):(t.moveTo(0,0),t.lineTo(i-s,0),t.lineTo(i,s),t.lineTo(i,o),t.lineTo(s,o),t.lineTo(0,o-s),t.lineTo(0,0),t.close(),t.end())},mxCellRenderer.prototype.defaultShapes.cube=t,e.prototype=new mxCylinder,e.prototype.constructor=e,e.prototype.size=30,e.prototype.redrawPath=function(t,e,n,i,o,r){var s=Math.min(i,Math.min(o,mxUtils.getValue(this.style,"size",this.size)));r?(t.moveTo(i-s,0),t.lineTo(i-s,s),t.lineTo(i,s),t.end()):(t.moveTo(0,0),t.lineTo(i-s,0),t.lineTo(i,s),t.lineTo(i,o),t.lineTo(0,o),t.lineTo(0,0),t.close(),t.end())},mxCellRenderer.prototype.defaultShapes.note=e,n.prototype=new mxCylinder,n.prototype.constructor=n,n.prototype.tabWidth=60,n.prototype.tabHeight=20,n.prototype.tabPosition="right",n.prototype.redrawPath=function(t,e,n,i,o,r){var s=mxUtils.getValue(this.style,"tabWidth",this.tabWidth),l=mxUtils.getValue(this.style,"tabHeight",this.tabHeight),a=mxUtils.getValue(this.style,"tabPosition",this.tabPosition),h=Math.min(i,s),d=Math.min(o,l);r?("left"==a?(t.moveTo(0,d),t.lineTo(h,d)):(t.moveTo(i-h,d),t.lineTo(i,d)),t.end()):("left"==a?(t.moveTo(0,0),t.lineTo(h,0),t.lineTo(h,d),t.lineTo(i,d)):(t.moveTo(0,d),t.lineTo(i-h,d),t.lineTo(i-h,0),t.lineTo(i,0)),t.lineTo(i,o),t.lineTo(0,o),t.lineTo(0,d),t.close(),t.end())},mxCellRenderer.prototype.defaultShapes.folder=n,i.prototype=new mxCylinder,i.prototype.constructor=i,i.prototype.size=30,i.prototype.redrawPath=function(t,e,n,i,o,r){var s=Math.min(i,Math.min(o,mxUtils.getValue(this.style,"size",this.size)));r||(t.moveTo(s,0),t.lineTo(i,0),t.lineTo(i,o),t.lineTo(0,o),t.lineTo(0,s),t.lineTo(s,0),t.close(),t.end())},mxCellRenderer.prototype.defaultShapes.card=i,o.prototype=new mxCylinder,o.prototype.constructor=o,o.prototype.size=.4,o.prototype.redrawPath=function(t,e,n,i,o,r){var s=mxUtils.getValue(this.style,"size",this.size),l=o*s,a=1.4;r||(t.moveTo(0,l/2),t.quadTo(i/4,l*a,i/2,l/2),t.quadTo(3*i/4,l*(1-a),i,l/2),t.lineTo(i,o-l/2),t.quadTo(3*i/4,o-l*a,i/2,o-l/2),t.quadTo(i/4,o-l*(1-a),0,o-l/2),t.lineTo(0,l/2),t.close(),t.end())},mxCellRenderer.prototype.defaultShapes.tape=o,r.prototype=new mxCylinder,r.prototype.constructor=r,r.prototype.size=.3,r.prototype.redrawPath=function(t,e,n,i,o,r){var s=mxUtils.getValue(this.style,"size",this.size),l=o*s,a=1.4;r||(t.moveTo(0,0),t.lineTo(i,0),t.lineTo(i,o-l/2),t.quadTo(3*i/4,o-l*a,i/2,o-l/2),t.quadTo(i/4,o-l*(1-a),0,o-l/2),t.lineTo(0,l/2),t.close(),t.end())},mxCellRenderer.prototype.defaultShapes.document=r,s.prototype=new mxCylinder,s.prototype.constructor=s,s.prototype.size=.2,s.prototype.redrawPath=function(t,e,n,i,o,r){var s=Math.min(i,Math.min(i,mxUtils.getValue(this.style,"size",this.size)*i));r||(t.moveTo(0,o),t.lineTo(s,0),t.lineTo(i,0),t.lineTo(i-s,o),t.close(),t.end())},mxCellRenderer.prototype.defaultShapes.parallelogram=s,l.prototype=new mxCylinder,l.prototype.constructor=l,l.prototype.size=.2,l.prototype.redrawPath=function(t,e,n,i,o,r){var s=Math.min(i,Math.min(i,mxUtils.getValue(this.style,"size",this.size)*i));r||(t.moveTo(0,o),t.lineTo(s,0),t.lineTo(i-s,0),t.lineTo(i,o),t.close(),t.end())},mxCellRenderer.prototype.defaultShapes.trapezoid=l,mxUtils.extend(a,mxRectangleShape),a.prototype.size=.1,a.prototype.isHtmlAllowed=function(){return!1},a.prototype.getLabelBounds=function(t){var e=t.width,n=t.height,i=new mxRectangle(t.x,t.y,e,n),o=Math.min(e,Math.min(e,mxUtils.getValue(this.style,"size",this.size)*e)+this.strokewidth);if(this.isRounded){var r=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,100*mxConstants.RECTANGLE_ROUNDING_FACTOR)/100;o=Math.max(o,Math.min(e*r,n*r))}return i.x+=o,i.width-=2*o,i},a.prototype.paintForeground=function(t,e,n,i,o){var r=Math.min(i,Math.min(i,mxUtils.getValue(this.style,"size",this.size)*i)+this.strokewidth);if(this.isRounded){var s=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,100*mxConstants.RECTANGLE_ROUNDING_FACTOR)/100;r=Math.max(r,Math.min(i*s,o*s))}t.begin(),t.moveTo(e+r,n),t.lineTo(e+r,n+o),t.moveTo(e+i-r,n),t.lineTo(e+i-r,n+o),t.end(),t.stroke(),mxRectangleShape.prototype.paintForeground.apply(this,arguments)},mxCellRenderer.prototype.defaultShapes.process=a,h.prototype=new mxCylinder,h.prototype.constructor=h,h.prototype.size=.2,h.prototype.redrawPath=function(t,e,n,i,o,r){var s=i*mxUtils.getValue(this.style,"size",this.size);r||(t.moveTo(0,0),t.lineTo(i-s,0),t.lineTo(i,o/2),t.lineTo(i-s,o),t.lineTo(0,o),t.lineTo(s,o/2),t.close(),t.end())},mxCellRenderer.prototype.defaultShapes.step=h,mxUtils.extend(d,mxRectangleShape),d.prototype.isHtmlAllowed=function(){return!1},d.prototype.paintForeground=function(t,e,n,i,o){var r=Math.min(i/5,o/5)+1;t.begin(),t.moveTo(e+i/2,n+r),t.lineTo(e+i/2,n+o-r),t.moveTo(e+r,n+o/2),t.lineTo(e+i-r,n+o/2),t.end(),t.stroke(),mxRectangleShape.prototype.paintForeground.apply(this,arguments)},mxCellRenderer.prototype.defaultShapes.plus=d,mxUtils.extend(u,mxRectangleShape),u.prototype.isHtmlAllowed=function(){return!1},u.prototype.paintForeground=function(t,e,n,i,o){if(null!=this.style){if(1==this.style["double"]){var r=Math.max(2,this.strokewidth+1);mxRectangleShape.prototype.paintBackground.call(this,t,e+r,n+r,i-2*r,o-2*r),mxRectangleShape.prototype.paintForeground.apply(this,arguments),e+=r,n+=r,i-=2*r,o-=2*r}t.setDashed(!1);var s=0,l=null;do{if(l=mxCellRenderer.prototype.defaultShapes[this.style["symbol"+s]],null!=l){var a=this.style["symbol"+s+"Align"],h=this.style["symbol"+s+"VerticalAlign"],d=this.style["symbol"+s+"Width"],u=this.style["symbol"+s+"Height"],c=this.style["symbol"+s+"Spacing"]||0,p=this.style["symbol"+s+"ArcSpacing"];null!=p&&(c+=this.getArcSize(i+this.strokewidth,o+this.strokewidth)*p);var m=e,g=n;m+=a==mxConstants.ALIGN_CENTER?(i-d)/2:a==mxConstants.ALIGN_RIGHT?i-d-c:c,g+=h==mxConstants.ALIGN_MIDDLE?(o-u)/2:h==mxConstants.ALIGN_BOTTOM?o-u-c:c,t.save();var f=new l;f.style=this.style,l.prototype.paintVertexShape.call(f,t,m,g,d,u),t.restore()}s++}while(null!=l)}},mxCellRenderer.prototype.defaultShapes.ext=u,c.prototype=new mxCylinder,c.prototype.constructor=c,c.prototype.redrawPath=function(t,e,n,i,o,r){r?(t.moveTo(0,0),t.lineTo(i/2,o/2),t.lineTo(i,0),t.end()):(t.moveTo(0,0),t.lineTo(i,0),t.lineTo(i,o),t.lineTo(0,o),t.close())},mxCellRenderer.prototype.defaultShapes.message=c,p.prototype=new mxCylinder,p.prototype.constructor=p,p.prototype.addPipe=!0,p.prototype.redrawPath=function(t,e,n,i,o,r){var s=i/3,l=o/4;r||(t.moveTo(i/2,l),t.curveTo(i/2-s,l,i/2-s,0,i/2,0),t.curveTo(i/2+s,0,i/2+s,l,i/2,l),t.close(),t.moveTo(i/2,l),t.lineTo(i/2,2*o/3),t.moveTo(i/2,o/3),t.lineTo(0,o/3),t.moveTo(i/2,o/3),t.lineTo(i,o/3),t.moveTo(i/2,2*o/3),t.lineTo(0,o),t.moveTo(i/2,2*o/3),t.lineTo(i,o),t.end())},mxCellRenderer.prototype.defaultShapes.umlActor=p,m.prototype=new mxCylinder,m.prototype.constructor=m,m.prototype.size=10,m.prototype.addPipe=!0,m.prototype.redrawPath=function(t,e,n,i,o,r){var s=mxUtils.getValue(this.style,"size",this.size),l=2*s/3,a=s;r||(t.moveTo(i/2,a),t.curveTo(i/2-l,a,i/2-l,0,i/2,0),t.curveTo(i/2+l,0,i/2+l,a,i/2,a),t.close(),t.moveTo(i/2,a),t.lineTo(i/2,o),t.end())},mxCellRenderer.prototype.defaultShapes.lollipop=m,g.prototype=new mxCylinder,g.prototype.constructor=g,g.prototype.jettyWidth=32,g.prototype.jettyHeight=12,g.prototype.redrawPath=function(t,e,n,i,o,r){var s=mxUtils.getValue(this.style,"jettyWidth",this.jettyWidth),l=mxUtils.getValue(this.style,"jettyHeight",this.jettyHeight),a=s/2,h=a+s/2,d=.3*o-l/2,u=.7*o-l/2;r?(t.moveTo(a,d),t.lineTo(h,d),t.lineTo(h,d+l),t.lineTo(a,d+l),t.moveTo(a,u),t.lineTo(h,u),t.lineTo(h,u+l),t.lineTo(a,u+l),t.end()):(t.moveTo(a,0),t.lineTo(i,0),t.lineTo(i,o),t.lineTo(a,o),t.lineTo(a,u+l),t.lineTo(0,u+l),t.lineTo(0,u),t.lineTo(a,u),t.lineTo(a,d+l),t.lineTo(0,d+l),t.lineTo(0,d),t.lineTo(a,d),t.close(),t.end())},mxCellRenderer.prototype.defaultShapes.component=g,f.prototype=new mxDoubleEllipse,f.prototype.constructor=f,f.prototype.outerStroke=!0,f.prototype.paintVertexShape=function(t,e,n,i,o){var r=Math.min(4,Math.min(i/5,o/5));i>0&&o>0&&(t.ellipse(e+r,n+r,i-2*r,o-2*r),t.fillAndStroke()),t.setShadow(!1),this.outerStroke&&(t.ellipse(e,n,i,o),t.stroke())},mxCellRenderer.prototype.defaultShapes.endState=f,x.prototype=new f,x.prototype.constructor=x,x.prototype.outerStroke=!1,mxCellRenderer.prototype.defaultShapes.startState=x;var A=mxImageExport.prototype.initShapes;mxImageExport.prototype.initShapes=function(){function t(t){return{drawShape:function(e,n,i,o){var r=i.x,s=i.y,l=i.width,a=i.height;if(o){var h=Math.min(4,Math.min(l/5,a/5));return r+=h,s+=h,l-=2*h,a-=2*h,l>0&&a>0&&e.ellipse(r,s,l,a),!0}e.fillAndStroke(),t&&(e.ellipse(r,s,l,a),e.stroke())}}}A.apply(this,arguments),this.shapes.endState=t(!0),this.shapes.startState=t(!1)},mxUtils.extend(C,mxArrow),C.prototype.paintEdgeShape=function(t,e){var n=10,i=e[0],o=e[e.length-1],r=o.x-i.x,s=o.y-i.y,l=Math.sqrt(r*r+s*s),a=l,h=r/l,d=s/l,u=a*h,c=a*d,p=n*d/3,m=-n*h/3,g=i.x-p/2,f=i.y-m/2,x=g+p,C=f+m,E=x+u,y=C+c,v=E+p,T=y+m,b=v-3*p,I=T-3*m;t.begin(),t.moveTo(x,C),t.lineTo(E,y),t.moveTo(b+p,I+m),t.lineTo(g,f),t.stroke()},mxCellRenderer.prototype.defaultShapes.link=C,mxMarker.addMarker("dash",function(t,e,n,i,o,r,s,l,a){var h=o*(s+a+1),d=r*(s+a+1);return function(){t.begin(),t.moveTo(i.x-h/2-d/2,i.y-d/2+h/2),t.lineTo(i.x+d/2-3*h/2,i.y-3*d/2-h/2),t.stroke()}});var L=-99;if("undefined"!=typeof mxVertexHandler){mxUtils.extend(E,mxVertexHandler),E.prototype.useGridForSpecialHandle=!1,E.prototype.init=function(){this.horizontal=mxUtils.getValue(this.state.style,mxConstants.STYLE_HORIZONTAL,!0);var t=this.state.view.graph;if(null!=this.handleImage){var e=new mxRectangle(0,0,this.handleImage.width,this.handleImage.height);this.specialHandle=new mxImageShape(e,this.handleImage.src)}else{var n=10,e=new mxRectangle(0,0,n,n);this.specialHandle=new mxRhombus(e,mxConstants.HANDLE_FILLCOLOR,mxConstants.HANDLE_STROKECOLOR)}this.specialHandle.dialect=t.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG,this.specialHandle.init(t.getView().getOverlayPane()),this.specialHandle.node.style.cursor=this.getSpecialHandleCursor(),t.isCellRotatable(this.state.cell)||(this.specialHandle.node.style.display="none"),mxEvent.redirectMouseEvents(this.specialHandle.node,t,this.state),mxVertexHandler.prototype.init.apply(this,arguments)},E.prototype.getSpecialHandleCursor=function(){return"default"},E.prototype.redrawHandles=function(){mxVertexHandler.prototype.redrawHandles.apply(this,arguments);var t=this.specialHandle.bounds.width;this.specialHandle.bounds=this.getSpecialHandleBounds(t),this.specialHandle.redraw()},E.prototype.destroy=function(){mxVertexHandler.prototype.destroy.apply(this,arguments),null!=this.specialHandle&&(this.specialHandle.destroy(),this.specialHandle=null)},E.prototype.getHandleForEvent=function(t){return t.isSource(this.specialHandle)?L:mxVertexHandler.prototype.getHandleForEvent.apply(this,arguments)},E.prototype.mouseMove=function(t,e){if(e.isConsumed()||this.index!=L)mxVertexHandler.prototype.mouseMove.apply(this,arguments);else{var n=new mxPoint(e.getGraphX(),e.getGraphY());this.constrainPoint(n);var i=this.graph.isGridEnabledEvent(e.getEvent()),o=this.graph.getView().scale;i&&this.useGridForSpecialHandle&&(n.x=this.graph.snap(n.x/o)*o,n.y=this.graph.snap(n.y/o)*o),this.updateStyle(n),this.state.view.graph.cellRenderer.redraw(this.state,!0),mxClient.IS_TOUCH||this.moveSizerTo(this.specialHandle,n.x,n.y),e.consume()}},E.prototype.mouseUp=function(t,e){e.isConsumed()||this.index!=L?mxVertexHandler.prototype.mouseUp.apply(this,arguments):(this.applyStyle(),this.reset(),e.consume())},E.prototype.getSpecialHandleBounds=function(t){var e=this.state.shape.getShapeRotation(),n=mxUtils.toRadians(e),i=Math.cos(n),o=Math.sin(n),r=new mxRectangle(this.state.x,this.state.y,this.state.width,this.state.height);if(this.state.shape.isPaintBoundsInverted()){var s=(r.width-r.height)/2;r.x+=s,r.y-=s;var l=r.width;r.width=r.height,r.height=l}var a=this.getSpecialHandlePoint(r);return this.state.shape.flipH&&(a.x=2*r.x+r.width-a.x),this.state.shape.flipV&&(a.y=2*r.y+r.height-a.y),a=mxUtils.getRotatedPoint(a,i,o,new mxPoint(this.state.getCenterX(),this.state.getCenterY())),new mxRectangle(a.x-t/2,a.y-t/2,t,t)},E.prototype.getSpecialHandlePoint=function(){return null},E.prototype.updateStyle=function(){},E.prototype.constrainPoint=function(t){t.x=Math.max(this.state.x,Math.min(this.state.x+this.state.width,t.x)),t.y=Math.max(this.state.y,Math.min(this.state.y+this.state.height,t.y))},E.prototype.applyStyle=function(){},mxUtils.extend(y,E),y.prototype.getSpecialHandlePoint=function(t){var e=this.graph.getView().scale,n=Math.min(t.width,mxUtils.getValue(this.state.style,"tabWidth",60)*e),i=Math.min(t.height,mxUtils.getValue(this.state.style,"tabHeight",20)*e),o=mxUtils.getValue(this.state.style,"tabPosition","right"),r="left"==o?t.x+n:t.x+t.width-n;return new mxPoint(r,t.y+i)},y.prototype.updateStyle=function(t){var e=this.state.shape.getShapeRotation(),n=mxUtils.toRadians(e),i=Math.cos(-n),o=Math.sin(-n),r=new mxRectangle(this.state.x,this.state.y,this.state.width,this.state.height);if(this.state.shape.isPaintBoundsInverted()){var s=(r.width-r.height)/2;r.x+=s,r.y-=s;var l=r.width;r.width=r.height,r.height=l}var a=new mxPoint(t.x,t.y);a=mxUtils.getRotatedPoint(a,i,o,new mxPoint(this.state.getCenterX(),this.state.getCenterY())),this.state.shape.flipH&&(a.x=2*r.x+r.width-a.x),this.state.shape.flipV&&(a.y=2*r.y+r.height-a.y);var h=this.updateStyleUnrotated(a,r);null!=h&&(this.state.shape.flipH&&(h.x=2*r.x+r.width-h.x),this.state.shape.flipV&&(h.y=2*r.y+r.height-h.y),i=Math.cos(n),o=Math.sin(n),h=mxUtils.getRotatedPoint(h,i,o,new mxPoint(this.state.getCenterX(),this.state.getCenterY())),t.x=h.x,t.y=h.y)},y.prototype.updateStyleUnrotated=function(t,e){var n=mxUtils.getValue(this.state.style,"tabPosition","right"),i="left"==n?t.x-e.x:e.x+e.width-t.x,o=t.y-e.y,r=this.graph.getView().scale;this.state.style.tabWidth=Math.round(Math.max(1,i)/r),this.state.style.tabHeight=Math.round(Math.max(1,o)/r)},y.prototype.applyStyle=function(){var t=this.graph.getModel();t.beginUpdate();try{this.state.view.graph.setCellStyles("tabWidth",this.state.style.tabWidth,[this.state.cell]),this.state.view.graph.setCellStyles("tabHeight",this.state.style.tabHeight,[this.state.cell])}finally{t.endUpdate()}},mxUtils.extend(v,y),v.prototype.getSpecialHandlePoint=function(t){var e=this.graph.getView().scale,n=mxUtils.getValue(this.state.style,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_STARTSIZE);return new mxPoint(t.x+t.width/2,t.y+Math.min(t.height,n*e))},v.prototype.updateStyleUnrotated=function(t,e){t.x=e.x+e.width/2,startSize=t.y-e.y;var n=this.graph.getView().scale;return this.state.style.startSize=Math.round(Math.max(1,startSize)/n),t},v.prototype.applyStyle=function(){this.state.view.graph.setCellStyles("startSize",this.state.style.startSize,[this.state.cell])},mxUtils.extend(T,y),T.prototype.defaultValue=20,T.prototype.scaleFactor=1,T.prototype.getSpecialHandlePoint=function(t){var e=this.graph.getView().scale,n=Math.min(t.width,Math.min(t.height,mxUtils.getValue(this.state.style,"size",this.defaultValue)*e/this.scaleFactor));return new mxPoint(t.x+n,t.y+n)},T.prototype.updateStyleUnrotated=function(t,e){var n=Math.max(0,Math.min(Math.min(e.width/this.scaleFactor,t.x-e.x),Math.min(e.height/this.scaleFactor,t.y-e.y))),i=this.graph.getView().scale;return this.state.style.size=Math.round(Math.max(1,n)/i)*this.scaleFactor,new mxPoint(e.x+n,e.y+n)},T.prototype.applyStyle=function(){this.state.view.graph.setCellStyles("size",this.state.style.size,[this.state.cell])},mxUtils.extend(b,T),b.prototype.defaultValue=30,b.prototype.scaleFactor=2,mxUtils.extend(I,T),I.prototype.defaultValue=30,I.prototype.scaleFactor=1,I.prototype.getSpecialHandlePoint=function(t){var e=this.graph.getView().scale,n=Math.min(t.width,Math.min(t.height,mxUtils.getValue(this.state.style,"size",this.defaultValue)*e/this.scaleFactor));return new mxPoint(t.x+t.width-n,t.y+n)},I.prototype.updateStyleUnrotated=function(t,e){var n=Math.max(0,Math.min(Math.min(e.width/this.scaleFactor,t.x-e.x+e.width),Math.min(e.height/this.scaleFactor,t.y-e.y))),i=this.graph.getView().scale;return this.state.style.size=Math.round(Math.max(1,n)/i)*this.scaleFactor,new mxPoint(e.x+e.width-n,e.y+n)},mxUtils.extend(S,T),S.prototype.defaultValue=.2,S.prototype.scaleFactor=1,S.prototype.getSpecialHandlePoint=function(t){var e=mxUtils.getValue(this.state.style,"size",this.defaultValue);return new mxPoint(t.x+t.width*e,t.y+t.height/2)},S.prototype.updateStyleUnrotated=function(t,e){var n=Math.min(1,(t.x-e.x)/e.width);return this.state.style.size=n,new mxPoint(e.x+n*e.width,e.y+e.height/2)},mxUtils.extend(O,T),O.prototype.defaultValue=.4,O.prototype.scaleFactor=1,O.prototype.getSpecialHandlePoint=function(t){var e=mxUtils.getValue(this.state.style,"size",this.defaultValue);return new mxPoint(t.x+t.width/2,t.y+e*t.height/2)},O.prototype.updateStyleUnrotated=function(t,e){var n=Math.max(0,Math.min(1,(t.y-e.y)/e.height*2));return this.state.style.size=n,new mxPoint(e.x+e.width/2,e.y+n*e.height/2)},mxUtils.extend(R,T),R.prototype.defaultValue=.1,R.prototype.scaleFactor=1,R.prototype.getSpecialHandlePoint=function(t){var e=mxUtils.getValue(this.state.style,"size",this.defaultValue);return new mxPoint(t.x+e*t.width,t.y+t.height/4)},R.prototype.updateStyleUnrotated=function(t,e){var n=Math.max(0,Math.min(1,(t.x-e.x)/e.width));return this.state.style.size=n,new mxPoint(e.x+n*e.width,e.y+e.height/4)},mxUtils.extend(w,T),w.prototype.defaultValue=.2,w.prototype.scaleFactor=1,w.prototype.maxSize=.5,w.prototype.getSpecialHandlePoint=function(t){var e=mxUtils.getValue(this.state.style,"size",this.defaultValue);return new mxPoint(t.x+e*t.width*.75,t.y+t.height/4)},w.prototype.updateStyleUnrotated=function(t,e){var n=Math.max(0,Math.min(this.maxSize,(t.x-e.x)/(.75*e.width)));return this.state.style.size=n,new mxPoint(e.x+n*e.width*.75,e.y+e.height/4)},mxUtils.extend(D,w),D.prototype.maxSize=1,mxUtils.extend(_,T),_.prototype.defaultValue=.3,_.prototype.fy=1.4,_.prototype.scaleFactor=1,_.prototype.getSpecialHandlePoint=function(t){var e=mxUtils.getValue(this.state.style,"size",this.defaultValue)*t.height;return new mxPoint(t.x+3*t.width/4,t.y+t.height-e)},_.prototype.updateStyleUnrotated=function(t,e){var n=Math.max(0,Math.min(1,(e.y+e.height-t.y)/e.height));return this.state.style.size=n,new mxPoint(e.x+3*e.width/4,e.y+e.height-n*e.height)};var k={swimlane:v,folder:y,cube:T,card:b,note:I,step:S,tape:O,process:R,document:_,trapezoid:w,parallelogram:D},N=mxGraph.prototype.createHandler;mxGraph.prototype.createHandler=function(t){if(null!=t){var e=k[t.style.shape];if(null!=e)return new e(t)}return N.apply(this,arguments)}}mxGraph.prototype.getAllConnectionConstraints=function(t){if(null!=t&&null!=t.shape)if(null!=t.shape.stencil){if(null!=t.shape.stencil)return t.shape.stencil.constraints}else if(null!=t.shape.constraints)return t.shape.constraints;return null},mxRectangleShape.prototype.constraints=[new mxConnectionConstraint(new mxPoint(.25,0),!0),new mxConnectionConstraint(new mxPoint(.5,0),!0),new mxConnectionConstraint(new mxPoint(.75,0),!0),new mxConnectionConstraint(new mxPoint(0,.25),!0),new mxConnectionConstraint(new mxPoint(0,.5),!0),new mxConnectionConstraint(new mxPoint(0,.75),!0),new mxConnectionConstraint(new mxPoint(1,.25),!0),new mxConnectionConstraint(new mxPoint(1,.5),!0),new mxConnectionConstraint(new mxPoint(1,.75),!0),new mxConnectionConstraint(new mxPoint(.25,1),!0),new mxConnectionConstraint(new mxPoint(.5,1),!0),new mxConnectionConstraint(new mxPoint(.75,1),!0)],mxLabel.prototype.constraints=mxRectangleShape.prototype.constraints,mxImageShape.prototype.constraints=mxRectangleShape.prototype.constraints,mxSwimlane.prototype.constraints=mxRectangleShape.prototype.constraints,d.prototype.constraints=mxRectangleShape.prototype.constraints,e.prototype.constraints=mxRectangleShape.prototype.constraints,i.prototype.constraints=mxRectangleShape.prototype.constraints,t.prototype.constraints=mxRectangleShape.prototype.constraints,n.prototype.constraints=mxRectangleShape.prototype.constraints,mxCylinder.prototype.constraints=[new mxConnectionConstraint(new mxPoint(.15,.05),!1),new mxConnectionConstraint(new mxPoint(.5,0),!0),new mxConnectionConstraint(new mxPoint(.85,.05),!1),new mxConnectionConstraint(new mxPoint(0,.3),!0),new mxConnectionConstraint(new mxPoint(0,.5),!0),new mxConnectionConstraint(new mxPoint(0,.7),!0),new mxConnectionConstraint(new mxPoint(1,.3),!0),new mxConnectionConstraint(new mxPoint(1,.5),!0),new mxConnectionConstraint(new mxPoint(1,.7),!0),new mxConnectionConstraint(new mxPoint(.15,.95),!1),new mxConnectionConstraint(new mxPoint(.5,1),!0),new mxConnectionConstraint(new mxPoint(.85,.95),!1)],p.prototype.constraints=[new mxConnectionConstraint(new mxPoint(.25,.1),!1),new mxConnectionConstraint(new mxPoint(.5,0),!1),new mxConnectionConstraint(new mxPoint(.75,.1),!1),new mxConnectionConstraint(new mxPoint(0,1/3),!1),new mxConnectionConstraint(new mxPoint(0,1),!1),new mxConnectionConstraint(new mxPoint(1,1/3),!1),new mxConnectionConstraint(new mxPoint(1,1),!1),new mxConnectionConstraint(new mxPoint(.5,.5),!1)],g.prototype.constraints=[new mxConnectionConstraint(new mxPoint(.25,0),!0),new mxConnectionConstraint(new mxPoint(.5,0),!0),new mxConnectionConstraint(new mxPoint(.75,0),!0),new mxConnectionConstraint(new mxPoint(0,.3),!0),new mxConnectionConstraint(new mxPoint(0,.7),!0),new mxConnectionConstraint(new mxPoint(1,.25),!0),new mxConnectionConstraint(new mxPoint(1,.5),!0),new mxConnectionConstraint(new mxPoint(1,.75),!0),new mxConnectionConstraint(new mxPoint(.25,1),!0),new mxConnectionConstraint(new mxPoint(.5,1),!0),new mxConnectionConstraint(new mxPoint(.75,1),!0)],mxActor.prototype.constraints=[new mxConnectionConstraint(new mxPoint(.5,0),!0),new mxConnectionConstraint(new mxPoint(.25,.2),!1),new mxConnectionConstraint(new mxPoint(.1,.5),!1),new mxConnectionConstraint(new mxPoint(0,.75),!0),new mxConnectionConstraint(new mxPoint(.75,.25),!1),new mxConnectionConstraint(new mxPoint(.9,.5),!1),new mxConnectionConstraint(new mxPoint(1,.75),!0),new mxConnectionConstraint(new mxPoint(.25,1),!0),new mxConnectionConstraint(new mxPoint(.5,1),!0),new mxConnectionConstraint(new mxPoint(.75,1),!0)],o.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0,.35),!1),new mxConnectionConstraint(new mxPoint(0,.5),!1),new mxConnectionConstraint(new mxPoint(0,.65),!1),new mxConnectionConstraint(new mxPoint(1,.35),!1),new mxConnectionConstraint(new mxPoint(1,.5),!1),new mxConnectionConstraint(new mxPoint(1,.65),!1),new mxConnectionConstraint(new mxPoint(.25,1),!1),new mxConnectionConstraint(new mxPoint(.75,0),!1)],h.prototype.constraints=[new mxConnectionConstraint(new mxPoint(.25,0),!0),new mxConnectionConstraint(new mxPoint(.5,0),!0),new mxConnectionConstraint(new mxPoint(.75,0),!0),new mxConnectionConstraint(new mxPoint(.25,1),!0),new mxConnectionConstraint(new mxPoint(.5,1),!0),new mxConnectionConstraint(new mxPoint(.75,1),!0),new mxConnectionConstraint(new mxPoint(.1,.25),!1),new mxConnectionConstraint(new mxPoint(.2,.5),!1),new mxConnectionConstraint(new mxPoint(.1,.75),!1),new mxConnectionConstraint(new mxPoint(.9,.25),!1),new mxConnectionConstraint(new mxPoint(1,.5),!1),new mxConnectionConstraint(new mxPoint(.9,.75),!1)],mxLine.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0,.5),!1),new mxConnectionConstraint(new mxPoint(.25,.5),!1),new mxConnectionConstraint(new mxPoint(.75,.5),!1),new mxConnectionConstraint(new mxPoint(1,.5),!1)],m.prototype.constraints=[new mxConnectionConstraint(new mxPoint(.5,0),!1),new mxConnectionConstraint(new mxPoint(.5,1),!1)],mxEllipse.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0,0),!0),new mxConnectionConstraint(new mxPoint(1,0),!0),new mxConnectionConstraint(new mxPoint(0,1),!0),new mxConnectionConstraint(new mxPoint(1,1),!0),new mxConnectionConstraint(new mxPoint(.5,0),!0),new mxConnectionConstraint(new mxPoint(.5,1),!0),new mxConnectionConstraint(new mxPoint(0,.5),!0),new mxConnectionConstraint(new mxPoint(1,.5))],mxDoubleEllipse.prototype.constraints=mxEllipse.prototype.constraints,mxRhombus.prototype.constraints=mxEllipse.prototype.constraints,mxTriangle.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0,.25),!0),new mxConnectionConstraint(new mxPoint(0,.5),!0),new mxConnectionConstraint(new mxPoint(0,.75),!0),new mxConnectionConstraint(new mxPoint(.5,0),!0),new mxConnectionConstraint(new mxPoint(.5,1),!0),new mxConnectionConstraint(new mxPoint(1,.5),!0)],mxHexagon.prototype.constraints=[new mxConnectionConstraint(new mxPoint(.375,0),!0),new mxConnectionConstraint(new mxPoint(.5,0),!0),new mxConnectionConstraint(new mxPoint(.625,0),!0),new mxConnectionConstraint(new mxPoint(.125,.25),!1),new mxConnectionConstraint(new mxPoint(0,.5),!0),new mxConnectionConstraint(new mxPoint(.125,.75),!1),new mxConnectionConstraint(new mxPoint(.875,.25),!1),new mxConnectionConstraint(new mxPoint(0,.5),!0),new mxConnectionConstraint(new mxPoint(1,.5),!0),new mxConnectionConstraint(new mxPoint(.875,.75),!1),new mxConnectionConstraint(new mxPoint(.375,1),!0),new mxConnectionConstraint(new mxPoint(.5,1),!0),new mxConnectionConstraint(new mxPoint(.625,1),!0)],mxCloud.prototype.constraints=[new mxConnectionConstraint(new mxPoint(.25,.25),!1),new mxConnectionConstraint(new mxPoint(.4,.1),!1),new mxConnectionConstraint(new mxPoint(.16,.55),!1),new mxConnectionConstraint(new mxPoint(.07,.4),!1),new mxConnectionConstraint(new mxPoint(.31,.8),!1),new mxConnectionConstraint(new mxPoint(.13,.77),!1),new mxConnectionConstraint(new mxPoint(.8,.8),!1),new mxConnectionConstraint(new mxPoint(.55,.95),!1),new mxConnectionConstraint(new mxPoint(.875,.5),!1),new mxConnectionConstraint(new mxPoint(.96,.7),!1),new mxConnectionConstraint(new mxPoint(.625,.2),!1),new mxConnectionConstraint(new mxPoint(.88,.25),!1)],s.prototype.constraints=mxRectangleShape.prototype.constraints,l.prototype.constraints=mxRectangleShape.prototype.constraints,r.prototype.constraints=[new mxConnectionConstraint(new mxPoint(.25,0),!0),new mxConnectionConstraint(new mxPoint(.5,0),!0),new mxConnectionConstraint(new mxPoint(.75,0),!0),new mxConnectionConstraint(new mxPoint(0,.25),!0),new mxConnectionConstraint(new mxPoint(0,.5),!0),new mxConnectionConstraint(new mxPoint(0,.75),!0),new mxConnectionConstraint(new mxPoint(1,.25),!0),new mxConnectionConstraint(new mxPoint(1,.5),!0),new mxConnectionConstraint(new mxPoint(1,.75),!0)],mxArrow.prototype.constraints=null}(),Sidebar.prototype.init=function(){for(var t=STENCIL_PATH,e=0;e<this.choices.length;e++)element=this.choices[e],"general"==element?this.addGeneralPalette(!0):"basic"==element?this.addStencilPalette("basic",mxResources.get("basic"),t+"/basic.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2"):"arrows"==element?this.addStencilPalette("arrows",mxResources.get("arrows"),t+"/arrows.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2"):"uml"==element?this.addUmlPalette(!0):"bmpn"==element?this.addBpmnPalette(t,!1):"electrical"==element?(this.addStencilPalette("electrical","Electrical / Abstract ",t+"/electrical/abstract.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2"),this.addStencilPalette("electrical","Electrical / Capacitors",t+"/electrical/capacitors.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2"),this.addStencilPalette("electrical","Electrical / Diodes ",t+"/electrical/diodes.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2"),this.addStencilPalette("electrical","Electrical / Electro-mechanical ",t+"/electrical/electro-mechanical.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2"),this.addStencilPalette("electrical","Electrical / IEC Logic Gates ",t+"/electrical/iec_logic_gates.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2"),this.addStencilPalette("electrical","Electrical / Inductors ",t+"/electrical/inductors.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2"),this.addStencilPalette("electrical","Electrical / Instruments ",t+"/electrical/instruments.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2"),this.addStencilPalette("electrical","Electrical / Logic Gates ",t+"/electrical/logic_gates.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2"),this.addStencilPalette("electrical","Electrical / Miscellaneous ",t+"/electrical/miscellaneous.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2"),this.addStencilPalette("electrical","Electrical / Op Amps ",t+"/electrical/op_amps.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2"),this.addStencilPalette("electrical","Electrical / Opto-Electronics ",t+"/electrical/opto-electronics.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2"),this.addStencilPalette("electrical","Electrical / PLC Ladder ",t+"/electrical/plc_ladder.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2"),this.addStencilPalette("electrical","Electrical / Power Semiconductors ",t+"/electrical/power_semiconductors.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2"),this.addStencilPalette("electrical","Electrical / Radio ",t+"/electrical/radio.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2"),this.addStencilPalette("electrical","Electrical / Resistors ",t+"/electrical/resistors.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2"),this.addStencilPalette("electrical","Electrical / Signal Sources ",t+"/electrical/signal_sources.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2"),this.addStencilPalette("electrical","Electrical / Thermionic Devices ",t+"/electrical/thermionic_devices.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2"),this.addStencilPalette("electrical","Electrical / Transistors",t+"/electrical/transistors.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2"),this.addStencilPalette("electrical","Electrical / Waveforms ",t+"/electrical/waveforms.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2")):"flowchart"==element?this.addStencilPalette("flowchart","Flowchart",t/0/0,";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2"):"aws"==element?(this.addStencilPalette("aws","AWS / Compute ",t+"/aws/compute.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2"),this.addStencilPalette("aws","AWS / Content Delivery ",t+"/aws/content_delivery.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2"),this.addStencilPalette("aws","AWS / Database ",t+"/aws/database.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2"),this.addStencilPalette("aws","AWS / Deployment ",t+"/aws/deployment_management.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2"),this.addStencilPalette("aws","AWS / Groups ",t+"/aws/groups.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2"),this.addStencilPalette("aws","AWS / Messaging ",t+"/aws/messaging.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2"),this.addStencilPalette("aws","AWS / Miscellaneous ",t+"/aws/misc.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2"),this.addStencilPalette("aws","AWS / Networking ",t+"/aws/networking.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2"),this.addStencilPalette("aws","AWS / Non Service Specific ",t+"/aws/non_service_specific.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2"),this.addStencilPalette("aws","AWS / On Demand ",t+"/aws/on_demand_workforce.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2"),this.addStencilPalette("aws","AWS / Storage ",t+"/aws/storage.xml",";fillColor=#ffffff;strokeColor=#000000;strokeWidth=2")):"image"==element&&this.addImagePalette("clipart",mxResources.get("clipart"),t+"/clipart/","_128x128.png",["Earth_globe","Empty_Folder","Full_Folder","Gear","Lock","Software","Virus","Email","Database","Router_Icon","iPad","iMac","Laptop","MacBook","Monitor_Tower","Printer","Server_Tower","Workstation","Firewall_02","Wireless_Router_N","Credit_Card","Piggy_Bank","Graph","Safe","Shopping_Cart","Suit1","Suit2","Suit3","Pilot1","Worker1","Soldier1","Doctor1","Tech1","Security1","Telesales1"])
},Sidebar.prototype.enableTooltips=!mxClient.IS_TOUCH,Sidebar.prototype.tooltipBorder=16,Sidebar.prototype.thumbBorder=3,Sidebar.prototype.tooltipDelay=300,Sidebar.prototype.installEdges=!0,Sidebar.prototype.gearImage=STENCIL_PATH+"/clipart/Gear_128x128.png",Sidebar.prototype.thumbWidth=34,Sidebar.prototype.thumbHeight=34,Sidebar.prototype.thumbPadding=2,Sidebar.prototype.sidebarTitleSize=9,Sidebar.prototype.sidebarTitles=!0,Sidebar.prototype.tooltipTitles=!0,Sidebar.prototype.showTooltip=function(t,e,n,i){if(this.enableTooltips&&this.showTooltips&&this.currentElt!=t){null!=this.thread&&(window.clearTimeout(this.thread),this.thread=null);var o=mxUtils.bind(this,function(){null==this.tooltip&&(this.tooltip=document.createElement("div"),this.tooltip.className="geSidebarTooltip",document.body.appendChild(this.tooltip),this.graph2=new Graph(this.tooltip,null,null,this.editorUi.editor.graph.getStylesheet()),this.graph2.view.setTranslate(this.tooltipBorder,this.tooltipBorder),this.graph2.resetViewOnRootChange=!1,this.graph2.foldingEnabled=!1,this.graph2.autoScroll=!1,this.graph2.setTooltips(!1),this.graph2.setConnectable(!1),this.graph2.setEnabled(!1),mxClient.IS_SVG||(this.graph2.view.canvas.style.position="relative"),this.tooltipImage=mxUtils.createImage(IMAGE_PATH+"/tooltip.png"),this.tooltipImage.style.position="absolute",this.tooltipImage.style.width="14px",this.tooltipImage.style.height="27px",document.body.appendChild(this.tooltipImage)),this.tooltip.style.display="block",this.graph2.labelsVisible=null==i||i,this.graph2.model.clear(),this.graph2.addCells(e);var o=this.graph2.getGraphBounds(),r=o.width+2*this.tooltipBorder,s=o.height+2*this.tooltipBorder;if(mxClient.IS_QUIRKS?(r+=4,s+=4,this.tooltip.style.overflow="hidden"):this.tooltip.style.overflow="visible",this.tooltipImage.style.visibility="visible",this.tooltip.style.width=r+"px",this.tooltipTitles&&null!=n&&n.length>0){null==this.tooltipTitle?(this.tooltipTitle=document.createElement("div"),this.tooltipTitle.style.borderTop="1px solid gray",this.tooltipTitle.style.textAlign="center",this.tooltipTitle.style.width="100%",this.tooltipTitle.style.overflow="hidden",mxClient.IS_SVG?this.tooltipTitle.style.paddingTop="2px":(this.tooltipTitle.style.position="absolute",this.tooltipTitle.style.paddingTop="6px"),this.tooltip.appendChild(this.tooltipTitle)):this.tooltipTitle.innerHTML="",this.tooltipTitle.style.display="",mxUtils.write(this.tooltipTitle,n);var l=this.tooltipTitle.offsetHeight+10;s+=l,mxClient.IS_SVG?this.tooltipTitle.style.marginTop=-l+"px":(s-=6,this.tooltipTitle.style.top=s-l+"px")}else null!=this.tooltipTitle&&null!=this.tooltipTitle.parentNode&&(this.tooltipTitle.style.display="none");this.tooltip.style.height=s+"px";var a=-Math.min(0,o.x-this.tooltipBorder),h=-Math.min(0,o.y-this.tooltipBorder),d=this.container.offsetWidth+this.editorUi.splitSize+107,u=Math.max(0,this.container.offsetTop+t.offsetTop-this.container.scrollTop-s/2+16);mxClient.IS_SVG?this.graph2.view.canvas.setAttribute("transform","translate("+a+","+h+")"):(this.graph2.view.drawPane.style.left=a+"px",this.graph2.view.drawPane.style.top=h+"px"),this.tooltip.style.position="absolute",this.tooltip.style.left=d+"px",this.tooltip.style.top=u+$(".question").height()+220+"px",this.tooltipImage.style.left=d-13+"px",this.tooltipImage.style.top=u+s/2-13+$(".question").height()+220+"px"});null!=this.tooltip&&"none"!=this.tooltip.style.display?o():this.thread=window.setTimeout(o,this.tooltipDelay),this.currentElt=t}},Sidebar.prototype.hideTooltip=function(){null!=this.thread&&(window.clearTimeout(this.thread),this.thread=null),null!=this.tooltip&&(this.tooltip.style.display="none",this.tooltipImage.style.visibility="hidden",this.currentElt=null)},Sidebar.prototype.addGeneralPalette=function(t){this.addPalette("general",mxResources.get("general"),t||!0,mxUtils.bind(this,function(t){t.appendChild(this.createVertexTemplate("swimlane;whiteSpace=wrap",200,200,"Container","Container",!0)),t.appendChild(this.createVertexTemplate("whiteSpace=wrap",120,60,"","Rectangle",!0)),t.appendChild(this.createVertexTemplate("rounded=1;whiteSpace=wrap",120,60,"","Rounded Rectangle",!0)),t.appendChild(this.createVertexTemplate("text;spacingTop=-5;",30,20,"Text","Text",!0)),t.appendChild(this.createVertexTemplate("ellipse;whiteSpace=wrap",80,80,"","Circle",!0)),t.appendChild(this.createVertexTemplate("ellipse;shape=doubleEllipse;whiteSpace=wrap",80,80,"","Double Ellipse",!0)),t.appendChild(this.createVertexTemplate("shape=ext;double=1;whiteSpace=wrap",120,60,"Double Rectangle","Double Rectangle",!0)),t.appendChild(this.createVertexTemplate("shape=ext;double=1;rounded=1;whiteSpace=wrap",120,60,"Double\nRounded Rectangle","Double Rounded Rectangle",!0)),t.appendChild(this.createVertexTemplate("shape=process;whiteSpace=wrap",120,60,"","Process",!0)),t.appendChild(this.createVertexTemplate("shape=parallelogram;whiteSpace=wrap",120,60,"","Parallelogram",!0)),t.appendChild(this.createVertexTemplate("shape=trapezoid;whiteSpace=wrap",120,60,"","Trapezoid",!0)),t.appendChild(this.createVertexTemplate("shape=document;whiteSpace=wrap",120,80,"","Document",!0)),t.appendChild(this.createVertexTemplate("triangle;whiteSpace=wrap",60,80,"","Triangle",!0)),t.appendChild(this.createVertexTemplate("rhombus;whiteSpace=wrap",80,80,"","Rhombus",!0)),t.appendChild(this.createVertexTemplate("shape=hexagon;whiteSpace=wrap",120,80,"","Hexagon",!0)),t.appendChild(this.createVertexTemplate("shape=step;whiteSpace=wrap",120,80,"","Step",!0)),t.appendChild(this.createVertexTemplate("shape=cylinder;whiteSpace=wrap",60,80,"","Cylinder",!0)),t.appendChild(this.createVertexTemplate("shape=tape;whiteSpace=wrap",120,100,"","Tape",!0)),t.appendChild(this.createVertexTemplate("shape=xor;whiteSpace=wrap",60,80,"","Exclusive Or",!0)),t.appendChild(this.createVertexTemplate("shape=or;whiteSpace=wrap",60,80,"","Or",!0)),t.appendChild(this.createVertexTemplate("shape=cube;whiteSpace=wrap",120,80,"","Cube",!0)),t.appendChild(this.createVertexTemplate("shape=note;whiteSpace=wrap",80,100,"","Note",!0)),t.appendChild(this.createVertexTemplate("shape=folder;whiteSpace=wrap",120,120,"","Folder",!0)),t.appendChild(this.createVertexTemplate("shape=card;whiteSpace=wrap",60,80,"","Card",!0)),t.appendChild(this.createVertexTemplate("shape=message;whiteSpace=wrap",60,40,"","Message",!0)),t.appendChild(this.createVertexTemplate("shape=actor;whiteSpace=wrap",40,60,"","Actor 1",!0)),t.appendChild(this.createVertexTemplate("icon;image="+this.gearImage,60,60,"Image","Image",!1)),t.appendChild(this.createVertexTemplate("whiteSpace=wrap;label;image="+this.gearImage,140,60,"Label","Label",!0)),t.appendChild(this.createVertexTemplate("shape=umlActor;verticalLabelPosition=bottom;verticalAlign=top",30,60,"","Actor 2",!0)),t.appendChild(this.createVertexTemplate("ellipse;shape=cloud;whiteSpace=wrap",120,80,"","Cloud",!0)),t.appendChild(this.createVertexTemplate("line",160,10,"","Horizontal Line",!0)),t.appendChild(this.createVertexTemplate("line;direction=south",10,160,"","Vertical Line",!0)),t.appendChild(this.createEdgeTemplate("edgeStyle=none;endArrow=none;",100,100,"","Line",!0)),t.appendChild(this.createEdgeTemplate("edgeStyle=none;endArrow=none;dashed=1;",100,100,"","Dashed Line",!0)),t.appendChild(this.createEdgeTemplate("edgeStyle=none;endArrow=none;dashed=1;dashPattern=1 4",100,100,"","Dotted Line",!0)),t.appendChild(this.createEdgeTemplate("edgeStyle=none",100,100,"","Connection",!0));var e=[new mxCell("",new mxGeometry(0,0,100,100),"curved=1")];e[0].geometry.setTerminalPoint(new mxPoint(0,100),!0),e[0].geometry.setTerminalPoint(new mxPoint(100,0),!1),e[0].geometry.points=[new mxPoint(100,100),new mxPoint(0,0)],e[0].geometry.relative=!0,e[0].edge=!0,t.appendChild(this.createEdgeTemplateFromCells(e,100,100,"Curve",!0)),t.appendChild(this.createEdgeTemplate("edgeStyle=elbowEdgeStyle;elbow=horizontal",100,100,"","Horizontal Elbow",!0)),t.appendChild(this.createEdgeTemplate("edgeStyle=elbowEdgeStyle;elbow=vertical",100,100,"","Vertical Elbow",!0)),t.appendChild(this.createEdgeTemplate("edgeStyle=entityRelationEdgeStyle",100,100,"","Entity Relation",!0)),t.appendChild(this.createEdgeTemplate("edgeStyle=segmentEdgeStyle",100,100,"","Manual Line",!0)),t.appendChild(this.createEdgeTemplate("edgeStyle=orthogonalEdgeStyle",100,100,"","Automatic Line",!0)),t.appendChild(this.createEdgeTemplate("shape=link",100,100,"","Link",!0)),t.appendChild(this.createEdgeTemplate("arrow",100,100,"","Arrow",!0))}))},Sidebar.prototype.addUmlPalette=function(t){this.addPalette("uml","UML",t||!1,mxUtils.bind(this,function(t){t.appendChild(this.createVertexTemplate("",110,50,"Object","Object",!0));var e=new mxCell('<p style="margin:0px;margin-top:4px;text-align:center;"><b>Class</b></p><hr/><div style="height:2px;"></div><hr/>',new mxGeometry(0,0,140,60),"verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1");e.vertex=!0,t.appendChild(this.createVertexTemplateFromCells([e],140,60,"Class 1",!0));var e=new mxCell('<p style="margin:0px;margin-top:4px;text-align:center;"><b>Class</b></p><hr/><p style="margin:0px;margin-left:4px;">+ field: Type</p><hr/><p style="margin:0px;margin-left:4px;">+ method(): Type</p>',new mxGeometry(0,0,160,90),"verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1");e.vertex=!0,t.appendChild(this.createVertexTemplateFromCells([e],160,90,"Class 2",!0));var e=new mxCell('<p style="margin:0px;margin-top:4px;text-align:center;"><i>&lt;&lt;Interface&gt;&gt;</i><br/><b>Interface</b></p><hr/><p style="margin:0px;margin-left:4px;">+ field1: Type<br/>+ field2: Type</p><hr/><p style="margin:0px;margin-left:4px;">+ method1(Type): Type<br/>+ method2(Type, Type): Type</p>',new mxGeometry(0,0,190,140),"verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1");e.vertex=!0,t.appendChild(this.createVertexTemplateFromCells([e],190,140,"Interface",!0));var e=new mxCell("Module",new mxGeometry(0,0,120,60),"shape=component;align=left;spacingLeft=36");e.vertex=!0,t.appendChild(this.createVertexTemplateFromCells([e],120,60,"Module",!0));var e=new mxCell("&lt;&lt;component&gt;&gt;<br/><b>Component</b>",new mxGeometry(0,0,180,90),"shape=ext;symbol0=component;symbol0Width=20;symbol0Height=20;symbol0Align=right;symbol0VerticalAlign=top;symbol0Spacing=4;symbol0ArcSpacing=0.25;jettyWidth=8;jettyHeight=4;overflow=fill;html=1","Component",!0);e.vertex=!0,t.appendChild(this.createVertexTemplateFromCells([e],180,90,"Component",!0));var e=new mxCell('<p style="margin:0px;margin-top:6px;text-align:center;"><b>Component</b></p><hr/><p style="margin:0px;margin-left:8px;">+ Attribute1: Type<br/>+ Attribute2: Type</p>',new mxGeometry(0,0,180,90),"shape=ext;symbol0=component;symbol0Width=20;symbol0Height=20;symbol0Align=right;symbol0VerticalAlign=top;symbol0ArcSpacing=0.25;jettyWidth=8;jettyHeight=4;verticalAlign=top;align=left;overflow=fill;html=1");e.vertex=!0,t.appendChild(this.createVertexTemplateFromCells([e],180,90,"Component with Attributes",!0)),t.appendChild(this.createVertexTemplate("shape=lollipop;direction=south;",30,10,"","Lollipop",!0));var n=new mxCell("Block",new mxGeometry(0,0,180,120),"verticalAlign=top;align=left;spacingTop=8;spacingLeft=2;spacingRight=12;shape=cube;size=10;direction=south;fontStyle=4;");n.vertex=!0,t.appendChild(this.createVertexTemplateFromCells([n],180,120,"Block",!0)),t.appendChild(this.createVertexTemplate("shape=folder;fontStyle=1;spacingTop=10;tabWidth=40;tabHeight=14;tabPosition=left;",70,50,"package","Package",!0));var e=new mxCell('<p style="margin:0px;margin-top:4px;text-align:center;text-decoration:underline;"><b>Object:Type</b></p><hr/><p style="margin:0px;margin-left:8px;">field1 = value1<br/>field2 = value2<br>field3 = value3</p>',new mxGeometry(0,0,160,90),"verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1");e.vertex=!0,t.appendChild(this.createVertexTemplateFromCells([e],160,90,"Object",!0));var i=new mxCell('<table style="width:100%;font-size:10px;"><tr><td colspan="2" style="background:#e4e4e4;padding:2px;">Tablename</td></tr><tr><td>PK</td><td style="padding:2px;">uniqueId</td></tr><tr><td>FK1</td><td style="padding:2px;">foreignKey</td></tr><tr><td></td><td style="padding:2px;">fieldname</td></tr></table>',new mxGeometry(0,0,180,90),"verticalAlign=top;align=left;overflow=fill;html=1");i.vertex=!0,t.appendChild(this.createVertexTemplateFromCells([i],180,90,"Entity",!0)),t.appendChild(this.createVertexTemplate("shape=note",80,100,"","Note",!0)),t.appendChild(this.createVertexTemplate("shape=umlActor;verticalLabelPosition=bottom;verticalAlign=top",40,80,"Actor","Actor",!1)),t.appendChild(this.createVertexTemplate("ellipse",140,70,"Use Case","Use Case",!0));var n=new mxCell("",new mxGeometry(0,0,30,30),"ellipse;shape=startState;fillColor=#000000;strokeColor=#ff0000;");n.vertex=!0;var o=new mxCell("",new mxGeometry(0,0,0,0),"edgeStyle=elbowEdgeStyle;elbow=horizontal;verticalAlign=bottom;endArrow=open;endSize=8;strokeColor=#ff0000;");o.geometry.setTerminalPoint(new mxPoint(15,70),!1),o.edge=!0,n.insertEdge(o,!0),t.appendChild(this.createVertexTemplateFromCells([n,o],30,30,"Start",!0));var n=new mxCell("Activity",new mxGeometry(0,0,120,40),"rounded=1;arcSize=40;fillColor=#ffffc0;strokeColor=#ff0000;");n.vertex=!0;var o=new mxCell("",new mxGeometry(0,0,0,0),"edgeStyle=elbowEdgeStyle;elbow=horizontal;verticalAlign=bottom;endArrow=open;endSize=8;strokeColor=#ff0000;");o.geometry.setTerminalPoint(new mxPoint(60,80),!1),o.edge=!0,n.insertEdge(o,!0),t.appendChild(this.createVertexTemplateFromCells([n,o],120,40,"Activity",!0));var n=new mxCell('<div style="margin-top:8px;"><b>Composite State</b><hr/>Subtitle</div>',new mxGeometry(0,0,160,60),"rounded=1;arcSize=40;overflow=fill;html=1;verticalAlign=top;fillColor=#ffffc0;strokeColor=#ff0000;");n.vertex=!0;var o=new mxCell("",new mxGeometry(0,0,0,0),"edgeStyle=elbowEdgeStyle;elbow=horizontal;verticalAlign=bottom;endArrow=open;endSize=8;strokeColor=#ff0000;");o.geometry.setTerminalPoint(new mxPoint(80,100),!1),o.edge=!0,n.insertEdge(o,!0),t.appendChild(this.createVertexTemplateFromCells([n,o],160,60,"Composite State",!0));var n=new mxCell("Condition",new mxGeometry(0,0,80,40),"rhombus;fillColor=#ffffc0;strokeColor=#ff0000;");n.vertex=!0;var r=new mxCell("no",new mxGeometry(0,0,0,0),"edgeStyle=elbowEdgeStyle;elbow=horizontal;align=left;verticalAlign=bottom;endArrow=open;endSize=8;strokeColor=#ff0000;");r.geometry.setTerminalPoint(new mxPoint(120,20),!1),r.geometry.relative=!0,r.geometry.x=-1,r.edge=!0,n.insertEdge(r,!0);var o=new mxCell("yes",new mxGeometry(0,0,0,0),"edgeStyle=elbowEdgeStyle;elbow=horizontal;align=left;verticalAlign=top;endArrow=open;endSize=8;strokeColor=#ff0000;");o.geometry.setTerminalPoint(new mxPoint(40,80),!1),o.geometry.relative=!0,o.geometry.x=-1,o.edge=!0,n.insertEdge(o,!0),t.appendChild(this.createVertexTemplateFromCells([n,r,o],80,40,"Condition",!0));var n=new mxCell("",new mxGeometry(0,0,200,10),"shape=line;strokeWidth=6;strokeColor=#ff0000;");n.vertex=!0;var o=new mxCell("",new mxGeometry(0,0,0,0),"edgeStyle=elbowEdgeStyle;elbow=horizontal;verticalAlign=bottom;endArrow=open;endSize=8;strokeColor=#ff0000;");o.geometry.setTerminalPoint(new mxPoint(100,50),!1),o.edge=!0,n.insertEdge(o,!0),t.appendChild(this.createVertexTemplateFromCells([n,o],200,10,"Fork/Join",!0)),t.appendChild(this.createVertexTemplate("ellipse;shape=endState;fillColor=#000000;strokeColor=#ff0000",30,30,"","End",!0));var s=new mxCell(":Object",new mxGeometry(0,0,100,50));s.vertex=!0;var l=new mxCell("",new mxGeometry(40,50,20,240),"shape=line;direction=north;dashed=1");l.vertex=!0,t.appendChild(this.createVertexTemplateFromCells([s,l],100,290,"Class/Object",!0));var s=new mxCell("",new mxGeometry(100,0,20,70));s.vertex=!0;var r=new mxCell("invoke",new mxGeometry(0,0,0,0),"edgeStyle=elbowEdgeStyle;elbow=vertical;verticalAlign=bottom;endArrow=block;");r.geometry.setTerminalPoint(new mxPoint(0,0),!0),r.edge=!0,s.insertEdge(r,!1),t.appendChild(this.createVertexTemplateFromCells([s,r],120,70,"Invocation",!0));var s=new mxCell("",new mxGeometry(100,0,20,70));s.vertex=!0;var r=new mxCell("invoke",new mxGeometry(0,0,0,0),"edgeStyle=elbowEdgeStyle;elbow=vertical;verticalAlign=bottom;endArrow=block;");r.geometry.setTerminalPoint(new mxPoint(0,0),!0),r.edge=!0,s.insertEdge(r,!1);var o=new mxCell("return",new mxGeometry(0,0,0,0),"edgeStyle=elbowEdgeStyle;elbow=vertical;verticalAlign=bottom;dashed=1;endArrow=open;endSize=8;");o.geometry.setTerminalPoint(new mxPoint(0,70),!1),o.edge=!0,s.insertEdge(o,!0);var a=new mxCell("invoke",new mxGeometry(0,0,0,0),"edgeStyle=elbowEdgeStyle;elbow=vertical;align=left;endArrow=open;");a.edge=!0,s.insertEdge(a,!0),s.insertEdge(a,!1),t.appendChild(this.createVertexTemplateFromCells([s,r,o,a],120,70,"Synchronous Invocation",!0));var h=new mxCell("name",new mxGeometry(0,0,0,0),"endArrow=block;endFill=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;");h.geometry.setTerminalPoint(new mxPoint(0,0),!0),h.geometry.setTerminalPoint(new mxPoint(160,0),!1),h.geometry.relative=!0,h.geometry.x=-1,h.edge=!0;var d=new mxCell("1",new mxGeometry(-1,0,0,0),"resizable=0;align=left;verticalAlign=bottom;labelBackgroundColor=#ffffff;fontSize=10");d.geometry.relative=!0,d.setConnectable(!1),d.vertex=!0,h.insert(d),t.appendChild(this.createEdgeTemplateFromCells([h],160,0,"Relation",!0));var h=new mxCell("",new mxGeometry(0,0,0,0),"endArrow=none;edgeStyle=orthogonalEdgeStyle;");h.geometry.setTerminalPoint(new mxPoint(0,0),!0),h.geometry.setTerminalPoint(new mxPoint(160,0),!1),h.edge=!0;var d=new mxCell("parent",new mxGeometry(-1,0,0,0),"resizable=0;align=left;verticalAlign=bottom;labelBackgroundColor=#ffffff;fontSize=10");d.geometry.relative=!0,d.setConnectable(!1),d.vertex=!0,h.insert(d);var u=new mxCell("child",new mxGeometry(1,0,0,0),"resizable=0;align=right;verticalAlign=bottom;labelBackgroundColor=#ffffff;fontSize=10");u.geometry.relative=!0,u.setConnectable(!1),u.vertex=!0,h.insert(u),t.appendChild(this.createEdgeTemplateFromCells([h],160,0,"Association 1",!0));var h=new mxCell("1",new mxGeometry(0,0,0,0),"endArrow=open;endSize=12;startArrow=diamondThin;startSize=14;startFill=0;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=bottom;");h.geometry.setTerminalPoint(new mxPoint(0,0),!0),h.geometry.setTerminalPoint(new mxPoint(160,0),!1),h.geometry.relative=!0,h.geometry.x=-1,h.edge=!0,t.appendChild(this.createEdgeTemplateFromCells([h],160,0,"Composition",!0));var h=new mxCell("Relation",new mxGeometry(0,0,0,0),"endArrow=open;endSize=12;startArrow=diamondThin;startSize=14;startFill=0;edgeStyle=orthogonalEdgeStyle;");h.geometry.setTerminalPoint(new mxPoint(0,0),!0),h.geometry.setTerminalPoint(new mxPoint(160,0),!1),h.edge=!0;var d=new mxCell("0..n",new mxGeometry(-1,0,0,0),"resizable=0;align=left;verticalAlign=top;labelBackgroundColor=#ffffff;fontSize=10");d.geometry.relative=!0,d.setConnectable(!1),d.vertex=!0,h.insert(d);var u=new mxCell("1",new mxGeometry(1,0,0,0),"resizable=0;align=right;verticalAlign=top;labelBackgroundColor=#ffffff;fontSize=10");u.geometry.relative=!0,u.setConnectable(!1),u.vertex=!0,h.insert(u),t.appendChild(this.createEdgeTemplateFromCells([h],160,0,"Relation",!0));var h=new mxCell("Use",new mxGeometry(0,0,0,0),"endArrow=open;endSize=12;dashed=1");h.geometry.setTerminalPoint(new mxPoint(0,0),!0),h.geometry.setTerminalPoint(new mxPoint(160,0),!1),h.edge=!0,t.appendChild(this.createEdgeTemplateFromCells([h],160,0,"Dependency",!0));var h=new mxCell("Extends",new mxGeometry(0,0,0,0),"endArrow=block;endSize=16;endFill=0;dashed=1");h.geometry.setTerminalPoint(new mxPoint(0,0),!0),h.geometry.setTerminalPoint(new mxPoint(160,0),!1),h.edge=!0,t.appendChild(this.createEdgeTemplateFromCells([h],160,0,"Generalization"));var h=new mxCell("",new mxGeometry(0,0,0,0),"endArrow=block;startArrow=block;endFill=1;startFill=1");h.geometry.setTerminalPoint(new mxPoint(0,0),!0),h.geometry.setTerminalPoint(new mxPoint(160,0),!1),h.edge=!0,t.appendChild(this.createEdgeTemplateFromCells([h],160,0,"Association 2"))}))},Sidebar.prototype.addBpmnPalette=function(){this.addPalette("bpmn","BPMN "+mxResources.get("general"),!1,mxUtils.bind(this,function(t){t.appendChild(this.createVertexTemplate("shape=ext;rounded=1;",120,80,"Task","Process",!0)),t.appendChild(this.createVertexTemplate("shape=ext;rounded=1;double=1;",120,80,"Transaction","Transaction",!0)),t.appendChild(this.createVertexTemplate("shape=ext;rounded=1;dashed=1;dashPattern=1 4;",120,80,"Event\nSub-Process","Event Sub-Process",!0)),t.appendChild(this.createVertexTemplate("shape=ext;rounded=1;strokeWidth=3;",120,80,"Call Activity","Call Activity",!0)),t.appendChild(this.createVertexTemplate("shape=ext;rounded=1;symbol0=plus;symbol0Width=14;symbol0Height=14;symbol0Align=center;symbol0VerticalAlign=bottom;",120,80,"Sub-Process","Sub-Process",!0)),t.appendChild(this.createVertexTemplate("shape=ext;rounded=1;symbol0=message;symbol0Width=20;symbol0Height=14;symbol0Align=left;symbol0VerticalAlign=top;symbol0Spacing=4;symbol0ArcSpacing=0.25;",120,80,"Receive","Receive Task",!0)),t.appendChild(this.createVertexTemplate("shape=ext;rounded=1;symbol0=actor;symbol0Width=14;symbol0Height=14;symbol0Align=left;symbol0VerticalAlign=top;symbol0Spacing=4;symbol0ArcSpacing=0.25;",120,80,"User","User Task",!0));var e=new mxCell("Process",new mxGeometry(0,0,120,80),"rounded=1");e.vertex=!0;var n=new mxCell("",new mxGeometry(1,1,30,30),"shape=mxgraph.bpmn.timer_start;perimeter=ellipsePerimeter;");n.vertex=!0,n.geometry.relative=!0,n.geometry.offset=new mxPoint(-40,-15),e.insert(n),t.appendChild(this.createVertexTemplateFromCells([e],120,80,"Attached Timer Event",!0)),t.appendChild(this.createVertexTemplate("swimlane;horizontal=0;startSize=20",320,240,"Pool","Pool",!0)),t.appendChild(this.createVertexTemplate("swimlane;horizontal=0;swimlaneFillColor=white;swimlaneLine=0;",300,120,"Lane","Lane",!0)),t.appendChild(this.createVertexTemplate("shape=hexagon",60,50,"","Conversation",!0)),t.appendChild(this.createVertexTemplate("shape=hexagon;strokeWidth=4",60,50,"","Call Conversation",!0));var e=new mxCell("",new mxGeometry(0,0,40,30),"shape=message");e.vertex=!0,t.appendChild(this.createVertexTemplateFromCells([e],40,30,"Message",!0));var e=new mxCell("",new mxGeometry(0,0,14,14),"shape=plus;resizable=0;");e.connectable=!1,e.vertex=!0,t.appendChild(this.createVertexTemplateFromCells([e],14,14,"Sub-Process Marker",!0));var i=new mxCell("",new mxGeometry(0,0,0,0),"endArrow=block;endFill=1;endSize=6");i.geometry.setTerminalPoint(new mxPoint(0,0),!0),i.geometry.setTerminalPoint(new mxPoint(100,0),!1),i.edge=!0,t.appendChild(this.createEdgeTemplateFromCells([i],100,0,"Sequence Flow",!0));var i=new mxCell("",new mxGeometry(0,0,0,0),"startArrow=dash;startSize=8;endArrow=block;endFill=1;endSize=6");i.geometry.setTerminalPoint(new mxPoint(0,0),!0),i.geometry.setTerminalPoint(new mxPoint(100,0),!1),i.edge=!0,t.appendChild(this.createEdgeTemplateFromCells([i],100,0,"Default Flow",!0));var i=new mxCell("",new mxGeometry(0,0,0,0),"startArrow=diamondThin;startFill=0;startSize=14;endArrow=block;endFill=1;endSize=6");i.geometry.setTerminalPoint(new mxPoint(0,0),!0),i.geometry.setTerminalPoint(new mxPoint(100,0),!1),i.edge=!0,t.appendChild(this.createEdgeTemplateFromCells([i],100,0,"Conditional Flow",!0));var i=new mxCell("",new mxGeometry(0,0,0,0),"startArrow=oval;startFill=0;startSize=7;endArrow=block;endFill=0;endSize=10;dashed=1");i.geometry.setTerminalPoint(new mxPoint(0,0),!0),i.geometry.setTerminalPoint(new mxPoint(100,0),!1),i.edge=!0,t.appendChild(this.createEdgeTemplateFromCells([i],100,0,"Message Flow 1"));var i=new mxCell("",new mxGeometry(0,0,0,0),"startArrow=oval;startFill=0;startSize=7;endArrow=block;endFill=0;endSize=10;dashed=1");i.geometry.setTerminalPoint(new mxPoint(0,0),!0),i.geometry.setTerminalPoint(new mxPoint(100,0),!1),i.edge=!0;var o=new mxCell("",new mxGeometry(0,0,20,14),"shape=message");o.geometry.relative=!0,o.setConnectable(!1),o.vertex=!0,o.geometry.offset=new mxPoint(-10,-7),i.insert(o),t.appendChild(this.createEdgeTemplateFromCells([i],100,0,"Message Flow 2",!0));var i=new mxCell("",new mxGeometry(0,0,0,0),"shape=link");i.geometry.setTerminalPoint(new mxPoint(0,0),!0),i.geometry.setTerminalPoint(new mxPoint(100,0),!1),i.edge=!0,t.appendChild(this.createEdgeTemplateFromCells([i],100,0,"Link",!0))}))},Sidebar.prototype.createTitle=function(t){var e=document.createElement("a");return e.setAttribute("href","javascript:void(0);"),e.className="geTitle",mxUtils.write(e,t),e},Sidebar.prototype.createThumb=function(t,e,n,i,o,r){this.graph.labelsVisible=null==r||r,this.graph.view.scaleAndTranslate(1,0,0),this.graph.addCells(t);var s=this.graph.getGraphBounds(),l=this.thumbBorder,a=Math.min((e-2)/(s.width-s.x+l),(n-2)/(s.height-s.y+l)),h=-Math.min(s.x,0),d=-Math.min(s.y,0);this.graph.view.scaleAndTranslate(a,h,d),s=this.graph.getGraphBounds();var u=Math.max(0,Math.floor((e-s.width-s.x)/2)),c=Math.max(0,Math.floor((n-s.height-s.y)/2)),p=null;this.graph.dialect!=mxConstants.DIALECT_SVG||mxClient.NO_FO?(p=this.graph.container.cloneNode(!1),p.innerHTML=this.graph.container.innerHTML):p=this.graph.view.getCanvas().ownerSVGElement.cloneNode(!0),this.graph.getModel().clear(),mxClient.IS_IE6&&(i.style.backgroundImage="url("+this.editorUi.editor.transparentImage+")");var m=3;if(p.style.position="relative",p.style.overflow="hidden",p.style.cursor="pointer",p.style.left=u+m+"px",p.style.top=c+m+"px",p.style.width=e+"px",p.style.height=n+"px",p.style.visibility="",p.style.minWidth="",p.style.minHeight="",i.appendChild(p),this.sidebarTitles&&null!=o){var g=mxClient.IS_QUIRKS?2*this.thumbPadding+2:0;i.style.height=this.thumbHeight+g+this.sidebarTitleSize+8+"px";var f=document.createElement("div");f.style.fontSize=this.sidebarTitleSize+"px",f.style.textAlign="center",f.style.whiteSpace="nowrap",mxClient.IS_IE&&(f.style.height=this.sidebarTitleSize+12+"px"),f.style.paddingTop="4px",mxUtils.write(f,o),i.appendChild(f)}},Sidebar.prototype.createItem=function(t,e,n){var i=document.createElement("a");i.setAttribute("href","javascript:void(0);"),i.className="geItem",i.style.overflow="hidden";var o=mxClient.IS_QUIRKS?8+2*this.thumbPadding:6;return i.style.width=this.thumbWidth+o+"px",i.style.height=this.thumbHeight+o+"px",i.style.padding=this.thumbPadding+"px",mxEvent.addListener(i,"click",function(t){mxEvent.consume(t)}),this.createThumb(t,this.thumbWidth,this.thumbHeight,i,e,n),i},Sidebar.prototype.createDropHandler=function(t,e){return function(n,i,o,r,s){if(n.isEnabled()&&(t=n.getImportableCells(t),t.length>0)){var l=null!=o?n.isValidDropTarget(o,t,i):!1,a=null;null==o||l||(o=null),e&&n.isSplitEnabled()&&n.isSplitTarget(o,t,i)?(n.splitEdge(o,t,null,r,s),a=t):t.length>0&&(a=n.importCells(t,r,s,o)),null!=a&&a.length>0&&(n.scrollCellToVisible(a[0]),n.setSelectionCells(a))}}},Sidebar.prototype.createDragPreview=function(t,e){var n=document.createElement("div");return n.style.border="1px dashed black",n.style.width=t+"px",n.style.height=e+"px",n},Sidebar.prototype.createDragSource=function(t,e,n){var i=mxUtils.makeDraggable(t,this.editorUi.editor.graph,e,n,0,0,this.editorUi.editor.graph.autoscroll,!0,!0);return i.getDropTarget=function(t){var e=mxDragSource.prototype.getDropTarget.apply(this,arguments);return t.isValidRoot(e)||(e=null),e},i},Sidebar.prototype.itemClicked=function(t,e,n){var i=this.editorUi.editor.graph,o=i.getGridSize();e.drop(i,n,null,o,o)},Sidebar.prototype.addClickHandler=function(t,e,n){var i=this.editorUi.editor.graph,o=e.mouseUp,r=null;mxEvent.addGestureListeners(t,function(t){r=new mxPoint(mxEvent.getClientX(t),mxEvent.getClientY(t))}),e.mouseUp=mxUtils.bind(this,function(s){if(!mxEvent.isPopupTrigger(s)&&null==this.currentGraph&&null!=r){var l=i.tolerance;Math.abs(r.x-mxEvent.getClientX(s))<=l&&Math.abs(r.y-mxEvent.getClientY(s))<=l&&this.itemClicked(n,e,s)}o.apply(e,arguments),r=null,this.currentElt=t})},Sidebar.prototype.createVertexTemplate=function(t,e,n,i,o,r){var s=[new mxCell(null!=i?i:"",new mxGeometry(0,0,e,n),t)];return s[0].vertex=!0,this.createVertexTemplateFromCells(s,e,n,o,r)},Sidebar.prototype.createVertexTemplateFromCells=function(t,e,n,i,o){var r=this.createItem(t,i,o),s=this.createDragSource(r,this.createDropHandler(t,!0),this.createDragPreview(e,n));return this.addClickHandler(r,s,t),s.isGuidesEnabled=mxUtils.bind(this,function(){return this.editorUi.editor.graph.graphHandler.guidesEnabled}),touchStyle||mxEvent.addListener(r,"mousemove",mxUtils.bind(this,function(){this.showTooltip(r,t,i,o)})),r},Sidebar.prototype.createEdgeTemplate=function(t,e,n,i,o,r){var s=[new mxCell(null!=i?i:"",new mxGeometry(0,0,e,n),t)];return s[0].geometry.setTerminalPoint(new mxPoint(0,n),!0),s[0].geometry.setTerminalPoint(new mxPoint(e,0),!1),s[0].geometry.relative=!0,s[0].edge=!0,this.createEdgeTemplateFromCells(s,e,n,o,r)},Sidebar.prototype.createEdgeTemplateFromCells=function(t,e,n,i,o){var r=this.createItem(t,i,o);this.createDragSource(r,this.createDropHandler(t,!1),this.createDragPreview(e,n));var s=this.editorUi.editor.graph;return mxEvent.addListener(r,"click",mxUtils.bind(this,function(e){this.installEdges&&s.setDefaultEdge(t[0]),r.style.backgroundColor="#ffffff",window.setTimeout(function(){r.style.backgroundColor=""},300),mxEvent.consume(e)})),touchStyle||mxEvent.addListener(r,"mousemove",mxUtils.bind(this,function(){this.showTooltip(r,t,i,o)})),r},Sidebar.prototype.addPalette=function(t,e,n,i){var o=this.createTitle(e);this.container.appendChild(o);var r=document.createElement("div");r.className="geSidebar",n?(i(r),i=null):r.style.display="none",this.addFoldingHandler(o,r,i);var s=document.createElement("div");s.appendChild(r),this.container.appendChild(s),null!=t&&(this.palettes[t]=[o,s])},Sidebar.prototype.addFoldingHandler=function(t,e,n){var i=!1;t.style.backgroundImage="none"==e.style.display?"url("+IMAGE_PATH+"/collapsed.gif)":"url("+IMAGE_PATH+"/expanded.gif)",t.style.backgroundRepeat="no-repeat",t.style.backgroundPosition="0% 50%",mxEvent.addListener(t,"click",function(o){if("none"==e.style.display){if(!i&&(i=!0,null!=n)){t.style.cursor="wait";var r=t.innerHTML;t.innerHTML=mxResources.get("loading")+"...",window.setTimeout(function(){n(e),t.style.cursor="",t.innerHTML=r},0)}t.style.backgroundImage="url("+IMAGE_PATH+"/expanded.gif)",e.style.display="block"}else t.style.backgroundImage="url("+IMAGE_PATH+"/collapsed.gif)",e.style.display="none";mxEvent.consume(o)})},Sidebar.prototype.removePalette=function(t){var e=this.palettes[t];if(null!=e){this.palettes[t]=null;for(var n=0;n<e.length;n++)this.container.removeChild(e[n]);return!0}return!1},Sidebar.prototype.addImagePalette=function(t,e,n,i,o,r){this.addPalette(t,e,!1,mxUtils.bind(this,function(t){for(var e=null!=r,s=0;s<o.length;s++){var l=n+o[s]+i;t.appendChild(this.createVertexTemplate("image;image="+l,80,80,"",e?r[s]:null,e))}}))},Sidebar.prototype.addStencilPalette=function(t,e,n,i,o,r,s,l){l=null!=l?l:1,this.addPalette(t,e,o,mxUtils.bind(this,function(t){null==i&&(i=""),null!=s&&s.call(this,t),mxStencilRegistry.loadStencilSet(n,mxUtils.bind(this,function(e,n,o,s,a){(null==r||mxUtils.indexOf(r,n)<0)&&t.appendChild(this.createVertexTemplate("shape="+e+n.toLowerCase()+i,Math.round(s*l),Math.round(a*l),"",n.replace(/_/g," "),!0))}),!0)}))},Toolbar.prototype.init=function(){this.addItems(["undo","redo","delete","-","actualSize","zoomIn","zoomOut","-"]);var t=this.addMenu("Helvetica",mxResources.get("fontFamily"),!0,"fontFamily");t.style.whiteSpace="nowrap",t.style.overflow="hidden",t.style.width="56px",this.addSeparator();var e=this.addMenu("12",mxResources.get("fontSize"),!0,"fontSize");e.style.whiteSpace="nowrap",e.style.overflow="hidden",e.style.width="22px",this.addItems(["-","bold","italic","underline"]);var n=this.addMenuFunction("geSprite-left",mxResources.get("align"),!1,mxUtils.bind(this,function(t){this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_ALIGN],[mxConstants.ALIGN_LEFT],"geIcon geSprite geSprite-left",null).setAttribute("title",mxResources.get("left")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_ALIGN],[mxConstants.ALIGN_CENTER],"geIcon geSprite geSprite-center",null).setAttribute("title",mxResources.get("center")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_ALIGN],[mxConstants.ALIGN_RIGHT],"geIcon geSprite geSprite-right",null).setAttribute("title",mxResources.get("right")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_VERTICAL_ALIGN],[mxConstants.ALIGN_TOP],"geIcon geSprite geSprite-top",null).setAttribute("title",mxResources.get("top")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_VERTICAL_ALIGN],[mxConstants.ALIGN_MIDDLE],"geIcon geSprite geSprite-middle",null).setAttribute("title",mxResources.get("middle")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_VERTICAL_ALIGN],[mxConstants.ALIGN_BOTTOM],"geIcon geSprite geSprite-bottom",null).setAttribute("title",mxResources.get("bottom"))
}));this.addItems(["fontColor","-"]);var i=this.addMenuFunction("geSprite-straight",mxResources.get("line"),!1,mxUtils.bind(this,function(t){this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_EDGE],[null],"geIcon geSprite geSprite-straight",null).setAttribute("title",mxResources.get("straight")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_EDGE],["entityRelationEdgeStyle"],"geIcon geSprite geSprite-entity",null).setAttribute("title",mxResources.get("entityRelation")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW],["elbowEdgeStyle","horizontal"],"geIcon geSprite geSprite-helbow",null).setAttribute("title",mxResources.get("horizontal")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW],["elbowEdgeStyle","vertical"],"geIcon geSprite geSprite-velbow",null).setAttribute("title",mxResources.get("vertical")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_EDGE],["segmentEdgeStyle"],"geIcon geSprite geSprite-segment",null).setAttribute("title",mxResources.get("manual")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_EDGE],["orthogonalEdgeStyle"],"geIcon geSprite geSprite-orthogonal",null).setAttribute("title",mxResources.get("automatic"))})),o=this.addMenuFunction("geSprite-startclassic",mxResources.get("lineend"),!1,mxUtils.bind(this,function(t){this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.NONE,0],"geIcon geSprite geSprite-noarrow",null).setAttribute("title",mxResources.get("none")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_CLASSIC,1],"geIcon geSprite geSprite-startclassic",null).setAttribute("title",mxResources.get("classic")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_OPEN,1],"geIcon geSprite geSprite-startopen",null).setAttribute("title",mxResources.get("openArrow")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_BLOCK,1],"geIcon geSprite geSprite-startblock",null).setAttribute("title",mxResources.get("block")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_OVAL,1],"geIcon geSprite geSprite-startoval",null).setAttribute("title",mxResources.get("oval")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_DIAMOND,1],"geIcon geSprite geSprite-startdiamond",null).setAttribute("title",mxResources.get("diamond")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_DIAMOND_THIN,1],"geIcon geSprite geSprite-startthindiamond",null).setAttribute("title",mxResources.get("diamondThin")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_CLASSIC,0],"geIcon geSprite geSprite-startclassictrans",null).setAttribute("title",mxResources.get("classic")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_BLOCK,0],"geIcon geSprite geSprite-startblocktrans",null).setAttribute("title",mxResources.get("block")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_OVAL,0],"geIcon geSprite geSprite-startovaltrans",null).setAttribute("title",mxResources.get("oval")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_DIAMOND,0],"geIcon geSprite geSprite-startdiamondtrans",null).setAttribute("title",mxResources.get("diamond")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_DIAMOND_THIN,0],"geIcon geSprite geSprite-startthindiamondtrans",null).setAttribute("title",mxResources.get("diamondThin"))})),r=this.addMenuFunction("geSprite-endclassic",mxResources.get("lineend"),!1,mxUtils.bind(this,function(t){this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.NONE,0],"geIcon geSprite geSprite-noarrow",null).setAttribute("title",mxResources.get("none")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_CLASSIC,1],"geIcon geSprite geSprite-endclassic",null).setAttribute("title",mxResources.get("classic")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_OPEN,1],"geIcon geSprite geSprite-endopen",null).setAttribute("title",mxResources.get("openArrow")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_BLOCK,1],"geIcon geSprite geSprite-endblock",null).setAttribute("title",mxResources.get("block")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_OVAL,1],"geIcon geSprite geSprite-endoval",null).setAttribute("title",mxResources.get("oval")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_DIAMOND,1],"geIcon geSprite geSprite-enddiamond",null).setAttribute("title",mxResources.get("diamond")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_DIAMOND_THIN,1],"geIcon geSprite geSprite-endthindiamond",null).setAttribute("title",mxResources.get("diamondThin")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_CLASSIC,0],"geIcon geSprite geSprite-endclassictrans",null).setAttribute("title",mxResources.get("classic")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_BLOCK,0],"geIcon geSprite geSprite-endblocktrans",null).setAttribute("title",mxResources.get("block")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_OVAL,0],"geIcon geSprite geSprite-endovaltrans",null).setAttribute("title",mxResources.get("oval")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_DIAMOND,0],"geIcon geSprite geSprite-enddiamondtrans",null).setAttribute("title",mxResources.get("diamond")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_DIAMOND_THIN,0],"geIcon geSprite geSprite-endthindiamondtrans",null).setAttribute("title",mxResources.get("diamondThin"))}));this.addItems(["-","strokeColor","image","fillColor"]),this.addItem("geSprite-gradientcolor","gradientColor").setAttribute("title",mxResources.get("gradient")),this.addItems(["shadow"]);var s=this.editorUi.editor.graph,l=mxUtils.bind(this,function(){var n="Helvetica",i="12",o=s.getView().getState(s.getSelectionCell());null!=o&&(n=o.style[mxConstants.STYLE_FONTFAMILY]||n,i=o.style[mxConstants.STYLE_FONTSIZE]||i,n.length>10&&(n=n.substring(0,8)+"..."),t.innerHTML=n,e.innerHTML=i)});s.getSelectionModel().addListener(mxEvent.CHANGE,l),s.getModel().addListener(mxEvent.CHANGE,l),this.addEdgeSelectionHandler([i,o,r]),this.addSelectionHandler([n])},Toolbar.prototype.hideMenu=function(){null!=this.currentMenu&&(this.currentMenu.hideMenu(),this.currentMenu.destroy(),this.currentMenu=null)},Toolbar.prototype.addMenu=function(t,e,n,i){var o=this.editorUi.menus.get(i),r=this.addMenuFunction(t,e,n,o.funct);return o.addListener("stateChanged",function(){r.setEnabled(o.enabled)}),r},Toolbar.prototype.addMenuFunction=function(t,e,n,i){var o=n?this.createLabel(t):this.createButton(t);return this.initElement(o,e),this.addMenuHandler(o,n,i),this.container.appendChild(o),o},Toolbar.prototype.addSeparator=function(){var t=document.createElement("div");return t.className="geSeparator",this.container.appendChild(t),t},Toolbar.prototype.addItems=function(t){for(var e=0;e<t.length;e++){var n=t[e];"-"==n?this.addSeparator():this.addItem("geSprite-"+n.toLowerCase(),n)}},Toolbar.prototype.addItem=function(t,e){var n=this.editorUi.actions.get(e),i=null;return null!=n&&(i=this.addButton(t,n.label,n.funct),i.setEnabled(n.enabled),n.addListener("stateChanged",function(){i.setEnabled(n.enabled)})),i},Toolbar.prototype.addButton=function(t,e,n){var i=this.createButton(t);return this.initElement(i,e),this.addClickHandler(i,n),this.container.appendChild(i),i},Toolbar.prototype.addSelectionHandler=function(t){var e=this.editorUi.editor.graph,n=function(){for(var n=!e.isSelectionEmpty(),i=0;i<t.length;i++)t[i].setEnabled(n)};e.getSelectionModel().addListener(mxEvent.CHANGE,n),n()},Toolbar.prototype.addEdgeSelectionHandler=function(t){var e=this.editorUi.editor.graph,n=function(){var n=!1;if(!e.isSelectionEmpty())for(var i=e.getSelectionCells(),o=0;o<i.length;o++)if(e.getModel().isEdge(i[o])){n=!0;break}for(var o=0;o<t.length;o++)t[o].setEnabled(n)};e.getSelectionModel().addListener(mxEvent.CHANGE,n),n()},Toolbar.prototype.initElement=function(t,e){t.setAttribute("tabindex","0"),null!=e&&t.setAttribute("title",e),this.addEnabledState(t)},Toolbar.prototype.addEnabledState=function(t){var e=t.className;t.setEnabled=function(n){t.enabled=n,t.className=n?e:e+" geDisabled"},t.setEnabled(!0)},Toolbar.prototype.addClickHandler=function(t,e){null!=e&&mxEvent.addListener(t,"click",function(n){t.enabled&&e(n),mxEvent.consume(n)})},Toolbar.prototype.createButton=function(t){var e=document.createElement("a");e.setAttribute("href","javascript:void(0);"),e.className="geButton";var n=document.createElement("div");return n.className="geSprite "+t,e.appendChild(n),e},Toolbar.prototype.createLabel=function(t){var e=document.createElement("a");return e.setAttribute("href","javascript:void(0);"),e.className="geLabel",mxUtils.write(e,t),e},Toolbar.prototype.addMenuHandler=function(t,e,n,i){if(null!=n){var o=this.editorUi.editor.graph,r=null;mxEvent.addListener(t,"click",mxUtils.bind(this,function(s){(null==t.enabled||t.enabled)&&(o.panningHandler.hideMenu(),r=new mxPopupMenu(n),r.div.className+=" geToolbarMenu",r.showDisabled=i,r.labels=e,r.autoExpand=!0,r.popup(t.offsetLeft,t.offsetTop+t.offsetHeight+34,null,s),this.currentMenu=r),mxEvent.consume(s)}))}};var jscolor={dir:"/assets/mxGraph/jscolor/",bindClass:"color",binding:!0,preloading:!0,install:function(){},init:function(){jscolor.preloading&&jscolor.preload()},getDir:function(){if(!jscolor.dir){var t=jscolor.detectDir();jscolor.dir=t!==!1?t:"jscolor/"}return jscolor.dir},detectDir:function(){for(var t=location.href,e=document.getElementsByTagName("base"),n=0;n<e.length;n+=1)e[n].href&&(t=e[n].href);for(var e=document.getElementsByTagName("script"),n=0;n<e.length;n+=1)if(e[n].src&&/(^|\/)jscolor\.js([?#].*)?$/i.test(e[n].src)){var i=new jscolor.URI(e[n].src),o=i.toAbsolute(t);return o.path=o.path.replace(/[^\/]+$/,""),o.query=null,o.fragment=null,o.toString()}return!1},preload:function(){for(var t in jscolor.imgRequire)jscolor.imgRequire.hasOwnProperty(t)&&jscolor.loadImage(t)},images:{pad:[181,101],sld:[16,101],cross:[15,15],arrow:[7,11]},imgRequire:{},imgLoaded:{},requireImage:function(t){jscolor.imgRequire[t]=!0},loadImage:function(t){jscolor.imgLoaded[t]||(jscolor.imgLoaded[t]=new Image,jscolor.imgLoaded[t].src=jscolor.getDir()+t)},fetchElement:function(t){return"string"==typeof t?document.getElementById(t):t},addEvent:function(t,e,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent&&t.attachEvent("on"+e,n)},fireEvent:function(t,e){if(t)if(document.createEvent){var n=document.createEvent("HTMLEvents");n.initEvent(e,!0,!0),t.dispatchEvent(n)}else if(document.createEventObject){var n=document.createEventObject();t.fireEvent("on"+e,n)}else t["on"+e]&&t["on"+e]()},getElementPos:function(t){var e=t,n=t,i=0,o=0;if(e.offsetParent)do i+=e.offsetLeft,o+=e.offsetTop;while(e=e.offsetParent);for(;(n=n.parentNode)&&"BODY"!==n.nodeName.toUpperCase();)i-=n.scrollLeft,o-=n.scrollTop;return[i,o]},getElementSize:function(t){return[t.offsetWidth,t.offsetHeight]},getRelMousePos:function(t){var e=0,n=0;return t||(t=window.event),"number"==typeof t.offsetX?(e=t.offsetX,n=t.offsetY):"number"==typeof t.layerX&&(e=t.layerX,n=t.layerY),{x:e,y:n}},getViewPos:function(){return"number"==typeof window.pageYOffset?[window.pageXOffset,window.pageYOffset]:document.body&&(document.body.scrollLeft||document.body.scrollTop)?[document.body.scrollLeft,document.body.scrollTop]:document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)?[document.documentElement.scrollLeft,document.documentElement.scrollTop]:[0,0]},getViewSize:function(){return"number"==typeof window.innerWidth?[window.innerWidth,window.innerHeight]:document.body&&(document.body.clientWidth||document.body.clientHeight)?[document.body.clientWidth,document.body.clientHeight]:document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?[document.documentElement.clientWidth,document.documentElement.clientHeight]:[0,0]},URI:function(t){function e(t){for(var e="";t;)if("../"===t.substr(0,3)||"./"===t.substr(0,2))t=t.replace(/^\.+/,"").substr(1);else if("/./"===t.substr(0,3)||"/."===t)t="/"+t.substr(3);else if("/../"===t.substr(0,4)||"/.."===t)t="/"+t.substr(4),e=e.replace(/\/?[^\/]*$/,"");else if("."===t||".."===t)t="";else{var n=t.match(/^\/?[^\/]*/)[0];t=t.substr(n.length),e+=n}return e}this.scheme=null,this.authority=null,this.path="",this.query=null,this.fragment=null,this.parse=function(t){var e=t.match(/^(([A-Za-z][0-9A-Za-z+.-]*)(:))?((\/\/)([^\/?#]*))?([^?#]*)((\?)([^#]*))?((#)(.*))?/);return this.scheme=e[3]?e[2]:null,this.authority=e[5]?e[6]:null,this.path=e[7],this.query=e[9]?e[10]:null,this.fragment=e[12]?e[13]:null,this},this.toString=function(){var t="";return null!==this.scheme&&(t=t+this.scheme+":"),null!==this.authority&&(t=t+"//"+this.authority),null!==this.path&&(t+=this.path),null!==this.query&&(t=t+"?"+this.query),null!==this.fragment&&(t=t+"#"+this.fragment),t},this.toAbsolute=function(t){var t=new jscolor.URI(t),n=this,i=new jscolor.URI;return null===t.scheme?!1:(null!==n.scheme&&n.scheme.toLowerCase()===t.scheme.toLowerCase()&&(n.scheme=null),null!==n.scheme?(i.scheme=n.scheme,i.authority=n.authority,i.path=e(n.path),i.query=n.query):(null!==n.authority?(i.authority=n.authority,i.path=e(n.path),i.query=n.query):(""===n.path?(i.path=t.path,i.query=null!==n.query?n.query:t.query):("/"===n.path.substr(0,1)?i.path=e(n.path):(i.path=null!==t.authority&&""===t.path?"/"+n.path:t.path.replace(/[^\/]+$/,"")+n.path,i.path=e(i.path)),i.query=n.query),i.authority=t.authority),i.scheme=t.scheme),i.fragment=n.fragment,i)},t&&this.parse(t)},color:function(target,prop){function RGB_HSV(t,e,n){var i=Math.min(Math.min(t,e),n),o=Math.max(Math.max(t,e),n),r=o-i;if(0===r)return[null,0,o];var s=t===i?3+(n-e)/r:e===i?5+(t-n)/r:1+(e-t)/r;return[6===s?0:s,r/o,o]}function HSV_RGB(t,e,n){if(null===t)return[n,n,n];var i=Math.floor(t),o=i%2?t-i:1-(t-i),r=n*(1-e),s=n*(1-e*o);switch(i){case 6:case 0:return[n,s,r];case 1:return[s,n,r];case 2:return[r,n,s];case 3:return[r,s,n];case 4:return[s,r,n];case 5:return[n,r,s]}}function removePicker(){delete jscolor.picker.owner,document.getElementsByTagName("body")[0].removeChild(jscolor.picker.boxB)}function drawPicker(t,e){function n(){var t=THIS.pickerInsetColor.split(/\s+/),e=t.length<2?t[0]:t[1]+" "+t[0]+" "+t[0]+" "+t[1];s.btn.style.borderColor=e}if(!jscolor.picker){jscolor.picker={box:document.createElement("div"),boxB:document.createElement("div"),pad:document.createElement("div"),padB:document.createElement("div"),padM:document.createElement("div"),sld:document.createElement("div"),sldB:document.createElement("div"),sldM:document.createElement("div"),btn:document.createElement("div"),btnS:document.createElement("span"),btnT:document.createTextNode(THIS.pickerCloseText)};for(var i=0,o=4;i<jscolor.images.sld[1];i+=o){var r=document.createElement("div");r.style.height=o+"px",r.style.fontSize="1px",r.style.lineHeight="0",jscolor.picker.sld.appendChild(r)}jscolor.picker.sldB.appendChild(jscolor.picker.sld),jscolor.picker.box.appendChild(jscolor.picker.sldB),jscolor.picker.box.appendChild(jscolor.picker.sldM),jscolor.picker.padB.appendChild(jscolor.picker.pad),jscolor.picker.box.appendChild(jscolor.picker.padB),jscolor.picker.box.appendChild(jscolor.picker.padM),jscolor.picker.btnS.appendChild(jscolor.picker.btnT),jscolor.picker.btn.appendChild(jscolor.picker.btnS),jscolor.picker.box.appendChild(jscolor.picker.btn),jscolor.picker.boxB.appendChild(jscolor.picker.box)}var s=jscolor.picker;s.box.onmouseup=s.box.onmouseout=function(){mxClient.IS_TOUCH||target.focus()},s.box.onmousedown=function(){abortBlur=!0},s.box.onmousemove=function(t){(holdPad||holdSld)&&(holdPad&&setPad(t),holdSld&&setSld(t),document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),dispatchImmediateChange())},s.padM.onmouseup=s.padM.onmouseout=function(){holdPad&&(holdPad=!1,jscolor.fireEvent(valueElement,"change"))},s.padM.onmousedown=function(t){switch(modeID){case 0:0===THIS.hsv[2]&&THIS.fromHSV(null,null,1);break;case 1:0===THIS.hsv[1]&&THIS.fromHSV(null,1,null)}holdPad=!0,setPad(t),dispatchImmediateChange()},s.sldM.onmouseup=s.sldM.onmouseout=function(){holdSld&&(holdSld=!1,jscolor.fireEvent(valueElement,"change"))},s.sldM.onmousedown=function(t){holdSld=!0,setSld(t),dispatchImmediateChange()};var l=getPickerDims(THIS);s.box.style.width=l[0]+"px",s.box.style.height=l[1]+"px",s.boxB.style.position="absolute",s.boxB.style.clear="both",s.boxB.style.left=t+"px",s.boxB.style.top=e+"px",s.boxB.style.zIndex=THIS.pickerZIndex,s.boxB.style.border=THIS.pickerBorder+"px solid",s.boxB.style.borderColor=THIS.pickerBorderColor,s.boxB.style.background=THIS.pickerFaceColor,s.pad.style.width=jscolor.images.pad[0]+"px",s.pad.style.height=jscolor.images.pad[1]+"px",s.padB.style.position="absolute",s.padB.style.left=THIS.pickerFace+"px",s.padB.style.top=THIS.pickerFace+"px",s.padB.style.border=THIS.pickerInset+"px solid",s.padB.style.borderColor=THIS.pickerInsetColor,s.padM.style.position="absolute",s.padM.style.left="0",s.padM.style.top="0",s.padM.style.width=THIS.pickerFace+2*THIS.pickerInset+jscolor.images.pad[0]+jscolor.images.arrow[0]+"px",s.padM.style.height=s.box.style.height,s.padM.style.cursor="crosshair",s.sld.style.overflow="hidden",s.sld.style.width=jscolor.images.sld[0]+"px",s.sld.style.height=jscolor.images.sld[1]+"px",s.sldB.style.display=THIS.slider?"block":"none",s.sldB.style.position="absolute",s.sldB.style.right=THIS.pickerFace+"px",s.sldB.style.top=THIS.pickerFace+"px",s.sldB.style.border=THIS.pickerInset+"px solid",s.sldB.style.borderColor=THIS.pickerInsetColor,s.sldM.style.display=THIS.slider?"block":"none",s.sldM.style.position="absolute",s.sldM.style.right="0",s.sldM.style.top="0",s.sldM.style.width=jscolor.images.sld[0]+jscolor.images.arrow[0]+THIS.pickerFace+2*THIS.pickerInset+"px",s.sldM.style.height=s.box.style.height;try{s.sldM.style.cursor="pointer"}catch(a){s.sldM.style.cursor="hand"}s.btn.style.display=THIS.pickerClosable?"block":"none",s.btn.style.position="absolute",s.btn.style.left=THIS.pickerFace+"px",s.btn.style.bottom=THIS.pickerFace+"px",s.btn.style.padding="0 15px",s.btn.style.height="18px",s.btn.style.border=THIS.pickerInset+"px solid",n(),s.btn.style.color=THIS.pickerButtonColor,s.btn.style.font="12px sans-serif",s.btn.style.textAlign="center";try{s.btn.style.cursor="pointer"}catch(a){s.btn.style.cursor="hand"}switch(s.btn.onmousedown=function(){THIS.hidePicker()},s.btnS.style.lineHeight=s.btn.style.height,modeID){case 0:var h="hs.png";break;case 1:var h="hv.png"}s.padM.style.backgroundImage="url('"+jscolor.getDir()+"cross.gif')",s.padM.style.backgroundRepeat="no-repeat",s.sldM.style.backgroundImage="url('"+jscolor.getDir()+"arrow.gif')",s.sldM.style.backgroundRepeat="no-repeat",s.pad.style.backgroundImage="url('"+jscolor.getDir()+h+"')",s.pad.style.backgroundRepeat="no-repeat",s.pad.style.backgroundPosition="0 0",redrawPad(),redrawSld(),jscolor.picker.owner=THIS,document.getElementsByTagName("body")[0].appendChild(s.boxB)}function getPickerDims(t){var e=[2*t.pickerInset+2*t.pickerFace+jscolor.images.pad[0]+(t.slider?2*t.pickerInset+2*jscolor.images.arrow[0]+jscolor.images.sld[0]:0),t.pickerClosable?4*t.pickerInset+3*t.pickerFace+jscolor.images.pad[1]+t.pickerButtonHeight:2*t.pickerInset+2*t.pickerFace+jscolor.images.pad[1]];return e}function redrawPad(){switch(modeID){case 0:var t=1;break;case 1:var t=2}var e=Math.round(THIS.hsv[0]/6*(jscolor.images.pad[0]-1)),n=Math.round((1-THIS.hsv[t])*(jscolor.images.pad[1]-1));jscolor.picker.padM.style.backgroundPosition=THIS.pickerFace+THIS.pickerInset+e-Math.floor(jscolor.images.cross[0]/2)+"px "+(THIS.pickerFace+THIS.pickerInset+n-Math.floor(jscolor.images.cross[1]/2))+"px";var i=jscolor.picker.sld.childNodes;switch(modeID){case 0:for(var o=HSV_RGB(THIS.hsv[0],THIS.hsv[1],1),r=0;r<i.length;r+=1)i[r].style.backgroundColor="rgb("+o[0]*(1-r/i.length)*100+"%,"+o[1]*(1-r/i.length)*100+"%,"+o[2]*(1-r/i.length)*100+"%)";break;case 1:var o,s,l=[THIS.hsv[2],0,0],r=Math.floor(THIS.hsv[0]),a=r%2?THIS.hsv[0]-r:1-(THIS.hsv[0]-r);switch(r){case 6:case 0:o=[0,1,2];break;case 1:o=[1,0,2];break;case 2:o=[2,0,1];break;case 3:o=[2,1,0];break;case 4:o=[1,2,0];break;case 5:o=[0,2,1]}for(var r=0;r<i.length;r+=1)s=1-1/(i.length-1)*r,l[1]=l[0]*(1-s*a),l[2]=l[0]*(1-s),i[r].style.backgroundColor="rgb("+100*l[o[0]]+"%,"+100*l[o[1]]+"%,"+100*l[o[2]]+"%)"}}function redrawSld(){switch(modeID){case 0:var t=2;break;case 1:var t=1}var e=Math.round((1-THIS.hsv[t])*(jscolor.images.sld[1]-1));jscolor.picker.sldM.style.backgroundPosition="0 "+(THIS.pickerFace+THIS.pickerInset+e-Math.floor(jscolor.images.arrow[1]/2))+"px"}function isPickerOwner(){return jscolor.picker&&jscolor.picker.owner===THIS}function blurTarget(){valueElement===target&&THIS.importColor(),THIS.pickerOnfocus&&THIS.hidePicker()}function blurValue(){valueElement!==target&&THIS.importColor()}function setPad(t){var e=jscolor.getRelMousePos(t),n=e.x-THIS.pickerFace-THIS.pickerInset,i=e.y-THIS.pickerFace-THIS.pickerInset;switch(modeID){case 0:THIS.fromHSV(n*(6/(jscolor.images.pad[0]-1)),1-i/(jscolor.images.pad[1]-1),null,leaveSld);break;case 1:THIS.fromHSV(n*(6/(jscolor.images.pad[0]-1)),null,1-i/(jscolor.images.pad[1]-1),leaveSld)}}function setSld(t){var e=jscolor.getRelMousePos(t),n=e.y-THIS.pickerFace-THIS.pickerInset;switch(modeID){case 0:THIS.fromHSV(null,null,1-n/(jscolor.images.sld[1]-1),leavePad);break;case 1:THIS.fromHSV(null,1-n/(jscolor.images.sld[1]-1),null,leavePad)}}function dispatchImmediateChange(){THIS.onImmediateChange&&("string"==typeof THIS.onImmediateChange?eval(THIS.onImmediateChange):THIS.onImmediateChange(THIS))}this.required=!0,this.adjust=!0,this.hash=!1,this.caps=!0,this.slider=!0,this.valueElement=target,this.styleElement=target,this.onImmediateChange=null,this.hsv=[0,0,1],this.rgb=[1,1,1],this.pickerOnfocus=!0,this.pickerMode="HSV",this.pickerPosition="bottom",this.pickerSmartPosition=!0,this.pickerButtonHeight=20,this.pickerClosable=!1,this.pickerCloseText="Close",this.pickerButtonColor="ButtonText",this.pickerFace=0,this.pickerFaceColor="ThreeDFace",this.pickerBorder=1,this.pickerBorderColor="ThreeDHighlight ThreeDShadow ThreeDShadow ThreeDHighlight",this.pickerInset=1,this.pickerInsetColor="ThreeDShadow ThreeDHighlight ThreeDHighlight ThreeDShadow",this.pickerZIndex=1e4;for(var p in prop)prop.hasOwnProperty(p)&&(this[p]=prop[p]);this.hidePicker=function(){isPickerOwner()&&removePicker()},this.showPicker=function(){if(!isPickerOwner()){var t,e,n,i=jscolor.getElementPos(target),o=jscolor.getElementSize(target),r=jscolor.getViewPos(),s=jscolor.getViewSize(),l=getPickerDims(this);switch(this.pickerPosition.toLowerCase()){case"left":t=1,e=0,n=-1;break;case"right":t=1,e=0,n=1;break;case"top":t=0,e=1,n=-1;break;default:t=0,e=1,n=1}var a=(o[e]+l[e])/2;if(this.pickerSmartPosition){[-r[t]+i[t]+l[t]>s[t]?-r[t]+i[t]+o[t]/2>s[t]/2&&i[t]+o[t]-l[t]>=0?i[t]+o[t]-l[t]:i[t]:i[t],-r[e]+i[e]+o[e]+l[e]-a+a*n>s[e]?-r[e]+i[e]+o[e]/2>s[e]/2&&i[e]+o[e]-a-a*n>=0?i[e]+o[e]-a-a*n:i[e]+o[e]-a+a*n:i[e]+o[e]-a+a*n>=0?i[e]+o[e]-a+a*n:i[e]+o[e]-a-a*n]}else{[i[t],i[e]+o[e]-a+a*n]}drawPicker(0,0)}},this.importColor=function(){valueElement?this.adjust?!this.required&&/^\s*$/.test(valueElement.value)?(valueElement.value="",styleElement.style.backgroundImage=styleElement.jscStyle.backgroundImage,styleElement.style.backgroundColor=styleElement.jscStyle.backgroundColor,styleElement.style.color=styleElement.jscStyle.color,this.exportColor(leaveValue|leaveStyle)):this.fromString(valueElement.value)||this.exportColor():this.fromString(valueElement.value,leaveValue)||(styleElement.style.backgroundImage=styleElement.jscStyle.backgroundImage,styleElement.style.backgroundColor=styleElement.jscStyle.backgroundColor,styleElement.style.color=styleElement.jscStyle.color,this.exportColor(leaveValue|leaveStyle)):this.exportColor()},this.exportColor=function(t){if(!(t&leaveValue)&&valueElement){var e=this.toString();this.caps&&(e=e.toUpperCase()),this.hash&&(e="#"+e),valueElement.value=e}t&leaveStyle||!styleElement||(styleElement.style.backgroundImage="none",styleElement.style.backgroundColor="#"+this.toString(),styleElement.style.color=.213*this.rgb[0]+.715*this.rgb[1]+.072*this.rgb[2]<.5?"#FFF":"#000"),t&leavePad||!isPickerOwner()||redrawPad(),t&leaveSld||!isPickerOwner()||redrawSld()},this.fromHSV=function(t,e,n,i){0>t&&(t=0)||t>6&&(t=6),0>e&&(e=0)||e>1&&(e=1),0>n&&(n=0)||n>1&&(n=1),this.rgb=HSV_RGB(null===t?this.hsv[0]:this.hsv[0]=t,null===e?this.hsv[1]:this.hsv[1]=e,null===n?this.hsv[2]:this.hsv[2]=n),this.exportColor(i)},this.fromRGB=function(t,e,n,i){0>t&&(t=0)||t>1&&(t=1),0>e&&(e=0)||e>1&&(e=1),0>n&&(n=0)||n>1&&(n=1);var o=RGB_HSV(null===t?this.rgb[0]:this.rgb[0]=t,null===e?this.rgb[1]:this.rgb[1]=e,null===n?this.rgb[2]:this.rgb[2]=n);null!==o[0]&&(this.hsv[0]=o[0]),0!==o[2]&&(this.hsv[1]=o[1]),this.hsv[2]=o[2],this.exportColor(i)},this.fromString=function(t,e){var n=t.match(/^\W*([0-9A-F]{3}([0-9A-F]{3})?)\W*$/i);return n?(6===n[1].length?this.fromRGB(parseInt(n[1].substr(0,2),16)/255,parseInt(n[1].substr(2,2),16)/255,parseInt(n[1].substr(4,2),16)/255,e):this.fromRGB(parseInt(n[1].charAt(0)+n[1].charAt(0),16)/255,parseInt(n[1].charAt(1)+n[1].charAt(1),16)/255,parseInt(n[1].charAt(2)+n[1].charAt(2),16)/255,e),!0):!1},this.toString=function(){return(256|Math.round(255*this.rgb[0])).toString(16).substr(1)+(256|Math.round(255*this.rgb[1])).toString(16).substr(1)+(256|Math.round(255*this.rgb[2])).toString(16).substr(1)};var THIS=this,modeID="hvs"===this.pickerMode.toLowerCase()?1:0,abortBlur=!1,valueElement=jscolor.fetchElement(this.valueElement),styleElement=jscolor.fetchElement(this.styleElement),holdPad=!1,holdSld=!1,leaveValue=1,leaveStyle=2,leavePad=4,leaveSld=8;if(valueElement){var updateField=function(){THIS.fromString(valueElement.value,leaveValue),dispatchImmediateChange()};jscolor.addEvent(valueElement,"keyup",updateField),jscolor.addEvent(valueElement,"input",updateField),jscolor.addEvent(valueElement,"blur",blurValue),valueElement.setAttribute("autocomplete","off")}switch(styleElement&&(styleElement.jscStyle={backgroundImage:styleElement.style.backgroundImage,backgroundColor:styleElement.style.backgroundColor,color:styleElement.style.color}),modeID){case 0:jscolor.requireImage("hs.png");break;case 1:jscolor.requireImage("hv.png")}jscolor.requireImage("cross.gif"),jscolor.requireImage("arrow.gif"),this.importColor()}};jscolor.install();
//# sourceMappingURL=candidate_graph-2b329b74502a6504211b280d02122e16.js.map