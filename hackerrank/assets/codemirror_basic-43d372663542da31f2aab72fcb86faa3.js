var _requirejs=requirejs;requirejs=void 0;var _require=require;require=void 0;var _define=define;define=void 0,// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else{if("function"==typeof define&&define.amd)return define([],e);this.CodeMirror=e()}}(function(){"use strict";function e(n,r){if(!(this instanceof e))return new e(n,r);this.options=r=r||{},mo(Os,r,!1),p(r);var i=r.value;"string"==typeof i&&(i=new ta(i,r.mode)),this.doc=i;var o=this.display=new t(n,i);o.wrapper.CodeMirror=this,d(this),l(this),r.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),r.autofocus&&!cs&&Sn(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,cutIncoming:!1,draggingText:!1,highlight:new lo},Qo&&11>Zo&&setTimeout(vo(kn,this,!0),20),jn(this),Oo();var s=this;ln(this,function(){s.curOp.forceUpdate=!0,Mi(s,i),r.autofocus&&!cs||So()==o.input?setTimeout(vo(Jn,s),20):Qn(s);for(var e in Es)Es.hasOwnProperty(e)&&Es[e](s,r[e],Ns);b(s);for(var t=0;t<Ds.length;++t)Ds[t](s)})}function t(e,t){var n=this,r=n.input=xo("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none");es?r.style.width="1000px":r.setAttribute("wrap","off"),ls&&(r.style.border="1px solid black"),r.setAttribute("autocorrect","off"),r.setAttribute("autocapitalize","off"),r.setAttribute("spellcheck","false"),n.inputDiv=xo("div",[r],null,"overflow: hidden; position: relative; width: 3px; height: 0px;"),n.scrollbarH=xo("div",[xo("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar"),n.scrollbarV=xo("div",[xo("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),n.scrollbarFiller=xo("div",null,"CodeMirror-scrollbar-filler"),n.gutterFiller=xo("div",null,"CodeMirror-gutter-filler"),n.lineDiv=xo("div",null,"CodeMirror-code"),n.selectionDiv=xo("div",null,null,"position: relative; z-index: 1"),n.cursorDiv=xo("div",null,"CodeMirror-cursors"),n.measure=xo("div",null,"CodeMirror-measure"),n.lineMeasure=xo("div",null,"CodeMirror-measure"),n.lineSpace=xo("div",[n.measure,n.lineMeasure,n.selectionDiv,n.cursorDiv,n.lineDiv],null,"position: relative; outline: none"),n.mover=xo("div",[xo("div",[n.lineSpace],"CodeMirror-lines")],null,"position: relative"),n.sizer=xo("div",[n.mover],"CodeMirror-sizer"),n.heightForcer=xo("div",null,null,"position: absolute; height: "+ha+"px; width: 1px;"),n.gutters=xo("div",null,"CodeMirror-gutters"),n.lineGutter=null,n.scroller=xo("div",[n.sizer,n.heightForcer,n.gutters],"CodeMirror-scroll"),n.scroller.setAttribute("tabIndex","-1"),n.wrapper=xo("div",[n.inputDiv,n.scrollbarH,n.scrollbarV,n.scrollbarFiller,n.gutterFiller,n.scroller],"CodeMirror"),Qo&&8>Zo&&(n.gutters.style.zIndex=-1,n.scroller.style.paddingRight=0),ls&&(r.style.width="0px"),es||(n.scroller.draggable=!0),os&&(n.inputDiv.style.height="1px",n.inputDiv.style.position="absolute"),Qo&&8>Zo&&(n.scrollbarH.style.minHeight=n.scrollbarV.style.minWidth="18px"),e.appendChild?e.appendChild(n.wrapper):e(n.wrapper),n.viewFrom=n.viewTo=t.first,n.view=[],n.externalMeasured=null,n.viewOffset=0,n.lastSizeC=0,n.updateLineNumbers=null,n.lineNumWidth=n.lineNumInnerWidth=n.lineNumChars=null,n.prevInput="",n.alignWidgets=!1,n.pollingFast=!1,n.poll=new lo,n.cachedCharWidth=n.cachedTextHeight=n.cachedPaddingH=null,n.inaccurateSelection=!1,n.maxLine=null,n.maxLineLength=0,n.maxLineChanged=!1,n.wheelDX=n.wheelDY=n.wheelStartX=n.wheelStartY=null,n.shift=!1,n.selForContextMenu=null}function n(t){t.doc.mode=e.getMode(t.options,t.doc.modeOption),r(t)}function r(e){e.doc.iter(function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)}),e.doc.frontier=e.doc.first,xt(e,100),e.state.modeGen++,e.curOp&&pn(e)}function i(e){e.options.lineWrapping?(jo(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth=""):(Lo(e.display.wrapper,"CodeMirror-wrap"),f(e)),s(e),pn(e),Bt(e),setTimeout(function(){v(e)},100)}function o(e){var t=Yt(e.display),n=e.options.lineWrapping,r=n&&Math.max(5,e.display.scroller.clientWidth/Jt(e.display)-3);return function(i){if(ni(e.doc,i))return 0;var o=0;if(i.widgets)for(var s=0;s<i.widgets.length;s++)i.widgets[s].height&&(o+=i.widgets[s].height);return n?o+(Math.ceil(i.text.length/r)||1)*t:o+t}}function s(e){var t=e.doc,n=o(e);t.iter(function(e){var t=n(e);t!=e.height&&Ni(e,t)})}function a(e){var t=Ks[e.options.keyMap],n=t.style;e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-keymap-\S+/g,"")+(n?" cm-keymap-"+n:"")}function l(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),Bt(e)}function c(e){d(e),pn(e),setTimeout(function(){_(e)},20)}function d(e){var t=e.display.gutters,n=e.options.gutters;Co(t);for(var r=0;r<n.length;++r){var i=n[r],o=t.appendChild(xo("div",null,"CodeMirror-gutter "+i));"CodeMirror-linenumbers"==i&&(e.display.lineGutter=o,o.style.width=(e.display.lineNumWidth||1)+"px")}t.style.display=r?"":"none",h(e)}function h(e){var t=e.display.gutters.offsetWidth;e.display.sizer.style.marginLeft=t+"px",e.display.scrollbarH.style.left=e.options.fixedGutter?t+"px":0}function u(e){if(0==e.height)return 0;for(var t,n=e.text.length,r=e;t=$r(r);){var i=t.find(0,!0);r=i.from.line,n+=i.from.ch-i.to.ch}for(r=e;t=Yr(r);){var i=t.find(0,!0);n-=r.text.length-i.from.ch,r=i.to.line,n+=r.text.length-i.to.ch}return n}function f(e){var t=e.display,n=e.doc;t.maxLine=Ai(n,n.first),t.maxLineLength=u(t.maxLine),t.maxLineChanged=!0,n.iter(function(e){var n=u(e);n>t.maxLineLength&&(t.maxLineLength=n,t.maxLine=e)})}function p(e){var t=fo(e.gutters,"CodeMirror-linenumbers");-1==t&&e.lineNumbers?e.gutters=e.gutters.concat(["CodeMirror-linenumbers"]):t>-1&&!e.lineNumbers&&(e.gutters=e.gutters.slice(0),e.gutters.splice(t,1))}function g(e){return e.display.scroller.clientHeight-e.display.wrapper.clientHeight<ha-3}function m(e){var t=e.display.scroller;return{clientHeight:t.clientHeight,barHeight:e.display.scrollbarV.clientHeight,scrollWidth:t.scrollWidth,clientWidth:t.clientWidth,hScrollbarTakesSpace:g(e),barWidth:e.display.scrollbarH.clientWidth,docHeight:Math.round(e.doc.height+Tt(e.display))}}function v(e,t){t||(t=m(e));var n=e.display,r=No(n.measure),i=t.docHeight+ha,o=t.scrollWidth>t.clientWidth;o&&t.scrollWidth<=t.clientWidth+1&&r>0&&!t.hScrollbarTakesSpace&&(o=!1);var s=i>t.clientHeight;if(s?(n.scrollbarV.style.display="block",n.scrollbarV.style.bottom=o?r+"px":"0",n.scrollbarV.firstChild.style.height=Math.max(0,i-t.clientHeight+(t.barHeight||n.scrollbarV.clientHeight))+"px"):(n.scrollbarV.style.display="",n.scrollbarV.firstChild.style.height="0"),o?(n.scrollbarH.style.display="block",n.scrollbarH.style.right=s?r+"px":"0",n.scrollbarH.firstChild.style.width=t.scrollWidth-t.clientWidth+(t.barWidth||n.scrollbarH.clientWidth)+"px"):(n.scrollbarH.style.display="",n.scrollbarH.firstChild.style.width="0"),o&&s?(n.scrollbarFiller.style.display="block",n.scrollbarFiller.style.height=n.scrollbarFiller.style.width=r+"px"):n.scrollbarFiller.style.display="",o&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(n.gutterFiller.style.display="block",n.gutterFiller.style.height=r+"px",n.gutterFiller.style.width=n.gutters.offsetWidth+"px"):n.gutterFiller.style.display="",!e.state.checkedOverlayScrollbar&&t.clientHeight>0){if(0===r){var a=ds&&!ss?"12px":"18px";n.scrollbarV.style.minWidth=n.scrollbarH.style.minHeight=a;var l=function(t){eo(t)!=n.scrollbarV&&eo(t)!=n.scrollbarH&&cn(e,En)(t)};aa(n.scrollbarV,"mousedown",l),aa(n.scrollbarH,"mousedown",l)}e.state.checkedOverlayScrollbar=!0}}function y(e,t,n){var r=n&&null!=n.top?Math.max(0,n.top):e.scroller.scrollTop;r=Math.floor(r-St(e));var i=n&&null!=n.bottom?n.bottom:r+e.wrapper.clientHeight,o=Hi(t,r),s=Hi(t,i);if(n&&n.ensure){var a=n.ensure.from.line,l=n.ensure.to.line;if(o>a)return{from:a,to:Hi(t,Pi(Ai(t,a))+e.wrapper.clientHeight)};if(Math.min(l,t.lastLine())>=s)return{from:Hi(t,Pi(Ai(t,l))-e.wrapper.clientHeight),to:l}}return{from:o,to:Math.max(s,o+1)}}function _(e){var t=e.display,n=t.view;if(t.alignWidgets||t.gutters.firstChild&&e.options.fixedGutter){for(var r=C(t)-t.scroller.scrollLeft+e.doc.scrollLeft,i=t.gutters.offsetWidth,o=r+"px",s=0;s<n.length;s++)if(!n[s].hidden){e.options.fixedGutter&&n[s].gutter&&(n[s].gutter.style.left=o);var a=n[s].alignable;if(a)for(var l=0;l<a.length;l++)a[l].style.left=o}e.options.fixedGutter&&(t.gutters.style.left=r+i+"px")}}function b(e){if(!e.options.lineNumbers)return!1;var t=e.doc,n=x(e.options,t.first+t.size-1),r=e.display;if(n.length!=r.lineNumChars){var i=r.measure.appendChild(xo("div",[xo("div",n)],"CodeMirror-linenumber CodeMirror-gutter-elt")),o=i.firstChild.offsetWidth,s=i.offsetWidth-o;return r.lineGutter.style.width="",r.lineNumInnerWidth=Math.max(o,r.lineGutter.offsetWidth-s),r.lineNumWidth=r.lineNumInnerWidth+s,r.lineNumChars=r.lineNumInnerWidth?n.length:-1,r.lineGutter.style.width=r.lineNumWidth+"px",h(e),!0}return!1}function x(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function C(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function w(e,t,n){var r=e.display;this.viewport=t,this.visible=y(r,e.doc,t),this.editorIsHidden=!r.wrapper.offsetWidth,this.wrapperHeight=r.wrapper.clientHeight,this.oldViewFrom=r.viewFrom,this.oldViewTo=r.viewTo,this.oldScrollerWidth=r.scroller.clientWidth,this.force=n,this.dims=O(e)}function k(e,t){var n=e.display,r=e.doc;if(t.editorIsHidden)return mn(e),!1;if(!t.force&&t.visible.from>=n.viewFrom&&t.visible.to<=n.viewTo&&(null==n.updateLineNumbers||n.updateLineNumbers>=n.viewTo)&&0==bn(e))return!1;b(e)&&(mn(e),t.dims=O(e));var i=r.first+r.size,o=Math.max(t.visible.from-e.options.viewportMargin,r.first),s=Math.min(i,t.visible.to+e.options.viewportMargin);n.viewFrom<o&&o-n.viewFrom<20&&(o=Math.max(r.first,n.viewFrom)),n.viewTo>s&&n.viewTo-s<20&&(s=Math.min(i,n.viewTo)),ms&&(o=ei(e.doc,o),s=ti(e.doc,s));var a=o!=n.viewFrom||s!=n.viewTo||n.lastSizeC!=t.wrapperHeight;_n(e,o,s),n.viewOffset=Pi(Ai(e.doc,n.viewFrom)),e.display.mover.style.top=n.viewOffset+"px";var l=bn(e);if(!a&&0==l&&!t.force&&(null==n.updateLineNumbers||n.updateLineNumbers>=n.viewTo))return!1;var c=So();return l>4&&(n.lineDiv.style.display="none"),E(e,n.updateLineNumbers,t.dims),l>4&&(n.lineDiv.style.display=""),c&&So()!=c&&c.offsetHeight&&c.focus(),Co(n.cursorDiv),Co(n.selectionDiv),a&&(n.lastSizeC=t.wrapperHeight,xt(e,400)),n.updateLineNumbers=null,!0}function S(e,t){for(var n=t.force,r=t.viewport,i=!0;;i=!1){if(i&&e.options.lineWrapping&&t.oldScrollerWidth!=e.display.scroller.clientWidth)n=!0;else if(n=!1,r&&null!=r.top&&(r={top:Math.min(e.doc.height+Tt(e.display)-ha-e.display.scroller.clientHeight,r.top)}),t.visible=y(e.display,e.doc,r),t.visible.from>=e.display.viewFrom&&t.visible.to<=e.display.viewTo)break;if(!k(e,t))break;M(e);var o=m(e);vt(e),L(e,o),v(e,o)}no(e,"update",e),(e.display.viewFrom!=t.oldViewFrom||e.display.viewTo!=t.oldViewTo)&&no(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo)}function T(e,t){var n=new w(e,t);if(k(e,n)){S(e,n);var r=m(e);vt(e),L(e,r),v(e,r)}}function L(e,t){e.display.sizer.style.minHeight=e.display.heightForcer.style.top=t.docHeight+"px",e.display.gutters.style.height=Math.max(t.docHeight,t.clientHeight-ha)+"px"}function j(e,t){e.display.sizer.offsetWidth+e.display.gutters.offsetWidth<e.display.scroller.clientWidth-1&&(e.display.sizer.style.minHeight=e.display.heightForcer.style.top="0px",e.display.gutters.style.height=t.docHeight+"px")}function M(e){for(var t=e.display,n=t.lineDiv.offsetTop,r=0;r<t.view.length;r++){var i,o=t.view[r];if(!o.hidden){if(Qo&&8>Zo){var s=o.node.offsetTop+o.node.offsetHeight;i=s-n,n=s}else{var a=o.node.getBoundingClientRect();i=a.bottom-a.top}var l=o.line.height-i;if(2>i&&(i=Yt(t)),(l>.001||-.001>l)&&(Ni(o.line,i),A(o.line),o.rest))for(var c=0;c<o.rest.length;c++)A(o.rest[c])}}}function A(e){if(e.widgets)for(var t=0;t<e.widgets.length;++t)e.widgets[t].height=e.widgets[t].node.offsetHeight}function O(e){for(var t=e.display,n={},r={},i=t.gutters.firstChild,o=0;i;i=i.nextSibling,++o)n[e.options.gutters[o]]=i.offsetLeft,r[e.options.gutters[o]]=i.offsetWidth;return{fixedPos:C(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:n,gutterWidth:r,wrapperWidth:t.wrapper.clientWidth}}function E(e,t,n){function r(t){var n=t.nextSibling;return es&&ds&&e.display.currentWheelTarget==t?t.style.display="none":t.parentNode.removeChild(t),n}for(var i=e.display,o=e.options.lineNumbers,s=i.lineDiv,a=s.firstChild,l=i.view,c=i.viewFrom,d=0;d<l.length;d++){var h=l[d];if(h.hidden);else if(h.node){for(;a!=h.node;)a=r(a);var u=o&&null!=t&&c>=t&&h.lineNumber;h.changes&&(fo(h.changes,"gutter")>-1&&(u=!1),N(e,h,c,n)),u&&(Co(h.lineNumber),h.lineNumber.appendChild(document.createTextNode(x(e.options,c)))),a=h.node.nextSibling}else{var f=W(e,h,c,n);s.insertBefore(f,a)}c+=h.size}for(;a;)a=r(a)}function N(e,t,n,r){for(var i=0;i<t.changes.length;i++){var o=t.changes[i];"text"==o?D(e,t):"gutter"==o?B(e,t,n,r):"class"==o?R(t):"widget"==o&&F(t,r)}t.changes=null}function I(e){return e.node==e.text&&(e.node=xo("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),Qo&&8>Zo&&(e.node.style.zIndex=2)),e.node}function H(e){var t=e.bgClass?e.bgClass+" "+(e.line.bgClass||""):e.line.bgClass;if(t&&(t+=" CodeMirror-linebackground"),e.background)t?e.background.className=t:(e.background.parentNode.removeChild(e.background),e.background=null);else if(t){var n=I(e);e.background=n.insertBefore(xo("div",null,t),n.firstChild)}}function P(e,t){var n=e.display.externalMeasured;return n&&n.line==t.line?(e.display.externalMeasured=null,t.measure=n.measure,n.built):vi(e,t)}function D(e,t){var n=t.text.className,r=P(e,t);t.text==t.node&&(t.node=r.pre),t.text.parentNode.replaceChild(r.pre,t.text),t.text=r.pre,r.bgClass!=t.bgClass||r.textClass!=t.textClass?(t.bgClass=r.bgClass,t.textClass=r.textClass,R(t)):n&&(t.text.className=n)}function R(e){H(e),e.line.wrapClass?I(e).className=e.line.wrapClass:e.node!=e.text&&(e.node.className="");var t=e.textClass?e.textClass+" "+(e.line.textClass||""):e.line.textClass;e.text.className=t||""}function B(e,t,n,r){t.gutter&&(t.node.removeChild(t.gutter),t.gutter=null);var i=t.line.gutterMarkers;if(e.options.lineNumbers||i){var o=I(t),s=t.gutter=o.insertBefore(xo("div",null,"CodeMirror-gutter-wrapper","position: absolute; left: "+(e.options.fixedGutter?r.fixedPos:-r.gutterTotalWidth)+"px"),t.text);if(!e.options.lineNumbers||i&&i["CodeMirror-linenumbers"]||(t.lineNumber=s.appendChild(xo("div",x(e.options,n),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+r.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))),i)for(var a=0;a<e.options.gutters.length;++a){var l=e.options.gutters[a],c=i.hasOwnProperty(l)&&i[l];c&&s.appendChild(xo("div",[c],"CodeMirror-gutter-elt","left: "+r.gutterLeft[l]+"px; width: "+r.gutterWidth[l]+"px"))}}}function F(e,t){e.alignable&&(e.alignable=null);for(var n,r=e.node.firstChild;r;r=n){var n=r.nextSibling;"CodeMirror-linewidget"==r.className&&e.node.removeChild(r)}K(e,t)}function W(e,t,n,r){var i=P(e,t);return t.text=t.node=i.pre,i.bgClass&&(t.bgClass=i.bgClass),i.textClass&&(t.textClass=i.textClass),R(t),B(e,t,n,r),K(t,r),t.node}function K(e,t){if(U(e.line,e,t,!0),e.rest)for(var n=0;n<e.rest.length;n++)U(e.rest[n],e,t,!1)}function U(e,t,n,r){if(e.widgets)for(var i=I(t),o=0,s=e.widgets;o<s.length;++o){var a=s[o],l=xo("div",[a.node],"CodeMirror-linewidget");a.handleMouseEvents||(l.ignoreEvents=!0),z(a,l,t,n),r&&a.above?i.insertBefore(l,t.gutter||t.text):i.appendChild(l),no(a,"redraw")}}function z(e,t,n,r){if(e.noHScroll){(n.alignable||(n.alignable=[])).push(t);var i=r.wrapperWidth;t.style.left=r.fixedPos+"px",e.coverGutter||(i-=r.gutterTotalWidth,t.style.paddingLeft=r.gutterTotalWidth+"px"),t.style.width=i+"px"}e.coverGutter&&(t.style.zIndex=5,t.style.position="relative",e.noHScroll||(t.style.marginLeft=-r.gutterTotalWidth+"px"))}function V(e){return vs(e.line,e.ch)}function q(e,t){return ys(e,t)<0?t:e}function G(e,t){return ys(e,t)<0?e:t}function X(e,t){this.ranges=e,this.primIndex=t}function $(e,t){this.anchor=e,this.head=t}function Y(e,t){var n=e[t];e.sort(function(e,t){return ys(e.from(),t.from())}),t=fo(e,n);for(var r=1;r<e.length;r++){var i=e[r],o=e[r-1];if(ys(o.to(),i.from())>=0){var s=G(o.from(),i.from()),a=q(o.to(),i.to()),l=o.empty()?i.from()==i.head:o.from()==o.head;t>=r&&--t,e.splice(--r,2,new $(l?a:s,l?s:a))}}return new X(e,t)}function J(e,t){return new X([new $(e,t||e)],0)}function Q(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function Z(e,t){if(t.line<e.first)return vs(e.first,0);var n=e.first+e.size-1;return t.line>n?vs(n,Ai(e,n).text.length):et(t,Ai(e,t.line).text.length)}function et(e,t){var n=e.ch;return null==n||n>t?vs(e.line,t):0>n?vs(e.line,0):e}function tt(e,t){return t>=e.first&&t<e.first+e.size}function nt(e,t){for(var n=[],r=0;r<t.length;r++)n[r]=Z(e,t[r]);return n}function rt(e,t,n,r){if(e.cm&&e.cm.display.shift||e.extend){var i=t.anchor;if(r){var o=ys(n,i)<0;o!=ys(r,i)<0?(i=n,n=r):o!=ys(n,r)<0&&(n=r)}return new $(i,n)}return new $(r||n,n)}function it(e,t,n,r){dt(e,new X([rt(e,e.sel.primary(),t,n)],0),r)}function ot(e,t,n){for(var r=[],i=0;i<e.sel.ranges.length;i++)r[i]=rt(e,e.sel.ranges[i],t[i],null);var o=Y(r,e.sel.primIndex);dt(e,o,n)}function st(e,t,n,r){var i=e.sel.ranges.slice(0);i[t]=n,dt(e,Y(i,e.sel.primIndex),r)}function at(e,t,n,r){dt(e,J(t,n),r)}function lt(e,t){var n={ranges:t.ranges,update:function(t){this.ranges=[];for(var n=0;n<t.length;n++)this.ranges[n]=new $(Z(e,t[n].anchor),Z(e,t[n].head))}};return ca(e,"beforeSelectionChange",e,n),e.cm&&ca(e.cm,"beforeSelectionChange",e.cm,n),n.ranges!=t.ranges?Y(n.ranges,n.ranges.length-1):t}function ct(e,t,n){var r=e.history.done,i=uo(r);i&&i.ranges?(r[r.length-1]=t,ht(e,t,n)):dt(e,t,n)}function dt(e,t,n){ht(e,t,n),zi(e,e.sel,e.cm?e.cm.curOp.id:0/0,n)}function ht(e,t,n){(so(e,"beforeSelectionChange")||e.cm&&so(e.cm,"beforeSelectionChange"))&&(t=lt(e,t));var r=n&&n.bias||(ys(t.primary().head,e.sel.primary().head)<0?-1:1);ut(e,pt(e,t,r,!0)),n&&n.scroll===!1||!e.cm||yr(e.cm)}function ut(e,t){t.equals(e.sel)||(e.sel=t,e.cm&&(e.cm.curOp.updateInput=e.cm.curOp.selectionChanged=!0,oo(e.cm)),no(e,"cursorActivity",e))}function ft(e){ut(e,pt(e,e.sel,null,!1),fa)}function pt(e,t,n,r){for(var i,o=0;o<t.ranges.length;o++){var s=t.ranges[o],a=gt(e,s.anchor,n,r),l=gt(e,s.head,n,r);(i||a!=s.anchor||l!=s.head)&&(i||(i=t.ranges.slice(0,o)),i[o]=new $(a,l))}return i?Y(i,t.primIndex):t}function gt(e,t,n,r){var i=!1,o=t,s=n||1;e.cantEdit=!1;e:for(;;){var a=Ai(e,o.line);if(a.markedSpans)for(var l=0;l<a.markedSpans.length;++l){var c=a.markedSpans[l],d=c.marker;if((null==c.from||(d.inclusiveLeft?c.from<=o.ch:c.from<o.ch))&&(null==c.to||(d.inclusiveRight?c.to>=o.ch:c.to>o.ch))){if(r&&(ca(d,"beforeCursorEnter"),d.explicitlyCleared)){if(a.markedSpans){--l;continue}break}if(!d.atomic)continue;var h=d.find(0>s?-1:1);if(0==ys(h,o)&&(h.ch+=s,h.ch<0?h=h.line>e.first?Z(e,vs(h.line-1)):null:h.ch>a.text.length&&(h=h.line<e.first+e.size-1?vs(h.line+1,0):null),!h)){if(i)return r?(e.cantEdit=!0,vs(e.first,0)):gt(e,t,n,!0);i=!0,h=t,s=-s}o=h;continue e}}return o}}function mt(e){for(var t=e.display,n=e.doc,r={},i=r.cursors=document.createDocumentFragment(),o=r.selection=document.createDocumentFragment(),s=0;s<n.sel.ranges.length;s++){var a=n.sel.ranges[s],l=a.empty();(l||e.options.showCursorWhenSelecting)&&yt(e,a,i),l||_t(e,a,o)}if(e.options.moveInputWithCursor){var c=Vt(e,n.sel.primary().head,"div"),d=t.wrapper.getBoundingClientRect(),h=t.lineDiv.getBoundingClientRect();r.teTop=Math.max(0,Math.min(t.wrapper.clientHeight-10,c.top+h.top-d.top)),r.teLeft=Math.max(0,Math.min(t.wrapper.clientWidth-10,c.left+h.left-d.left))}return r}function vt(e,t){t||(t=mt(e)),wo(e.display.cursorDiv,t.cursors),wo(e.display.selectionDiv,t.selection),null!=t.teTop&&(e.display.inputDiv.style.top=t.teTop+"px",e.display.inputDiv.style.left=t.teLeft+"px")}function yt(e,t,n){var r=Vt(e,t.head,"div",null,null,!e.options.singleCursorHeightPerLine),i=n.appendChild(xo("div"," ","CodeMirror-cursor"));if(i.style.left=r.left+"px",i.style.top=r.top+"px",i.style.height=Math.max(0,r.bottom-r.top)*e.options.cursorHeight+"px",r.other){var o=n.appendChild(xo("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"));o.style.display="",o.style.left=r.other.left+"px",o.style.top=r.other.top+"px",o.style.height=.85*(r.other.bottom-r.other.top)+"px"}}function _t(e,t,n){function r(e,t,n,r){0>t&&(t=0),t=Math.round(t),r=Math.round(r),a.appendChild(xo("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px; top: "+t+"px; width: "+(null==n?d-e:n)+"px; height: "+(r-t)+"px"))}function i(t,n,i){function o(n,r){return zt(e,vs(t,n),"div",h,r)}var a,l,h=Ai(s,t),u=h.text.length;return Do(Di(h),n||0,null==i?u:i,function(e,t,s){var h,f,p,g=o(e,"left");if(e==t)h=g,f=p=g.left;else{if(h=o(t-1,"right"),"rtl"==s){var m=g;g=h,h=m}f=g.left,p=h.right}null==n&&0==e&&(f=c),h.top-g.top>3&&(r(f,g.top,null,g.bottom),f=c,g.bottom<h.top&&r(f,g.bottom,null,h.top)),null==i&&t==u&&(p=d),(!a||g.top<a.top||g.top==a.top&&g.left<a.left)&&(a=g),(!l||h.bottom>l.bottom||h.bottom==l.bottom&&h.right>l.right)&&(l=h),c+1>f&&(f=c),r(f,h.top,p-f,h.bottom)}),{start:a,end:l}}var o=e.display,s=e.doc,a=document.createDocumentFragment(),l=Lt(e.display),c=l.left,d=o.lineSpace.offsetWidth-l.right,h=t.from(),u=t.to();if(h.line==u.line)i(h.line,h.ch,u.ch);else{var f=Ai(s,h.line),p=Ai(s,u.line),g=Qr(f)==Qr(p),m=i(h.line,h.ch,g?f.text.length+1:null).end,v=i(u.line,g?0:null,u.ch).start;g&&(m.top<v.top-2?(r(m.right,m.top,null,m.bottom),r(c,v.top,v.left,v.bottom)):r(m.right,m.top,v.left-m.right,m.bottom)),m.bottom<v.top&&r(c,m.bottom,null,v.top)}n.appendChild(a)}function bt(e){if(e.state.focused){var t=e.display;clearInterval(t.blinker);var n=!0;t.cursorDiv.style.visibility="",e.options.cursorBlinkRate>0?t.blinker=setInterval(function(){t.cursorDiv.style.visibility=(n=!n)?"":"hidden"},e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(t.cursorDiv.style.visibility="hidden")}}function xt(e,t){e.doc.mode.startState&&e.doc.frontier<e.display.viewTo&&e.state.highlight.set(t,vo(Ct,e))}function Ct(e){var t=e.doc;if(t.frontier<t.first&&(t.frontier=t.first),!(t.frontier>=e.display.viewTo)){var n=+new Date+e.options.workTime,r=Bs(t.mode,kt(e,t.frontier)),i=[];t.iter(t.frontier,Math.min(t.first+t.size,e.display.viewTo+500),function(o){if(t.frontier>=e.display.viewFrom){var s=o.styles,a=fi(e,o,r,!0);o.styles=a.styles;var l=o.styleClasses,c=a.classes;c?o.styleClasses=c:l&&(o.styleClasses=null);for(var d=!s||s.length!=o.styles.length||l!=c&&(!l||!c||l.bgClass!=c.bgClass||l.textClass!=c.textClass),h=0;!d&&h<s.length;++h)d=s[h]!=o.styles[h];d&&i.push(t.frontier),o.stateAfter=Bs(t.mode,r)}else gi(e,o.text,r),o.stateAfter=t.frontier%5==0?Bs(t.mode,r):null;return++t.frontier,+new Date>n?(xt(e,e.options.workDelay),!0):void 0}),i.length&&ln(e,function(){for(var t=0;t<i.length;t++)gn(e,i[t],"text")})}}function wt(e,t,n){for(var r,i,o=e.doc,s=n?-1:t-(e.doc.mode.innerMode?1e3:100),a=t;a>s;--a){if(a<=o.first)return o.first;var l=Ai(o,a-1);if(l.stateAfter&&(!n||a<=o.frontier))return a;var c=ma(l.text,null,e.options.tabSize);(null==i||r>c)&&(i=a-1,r=c)}return i}function kt(e,t,n){var r=e.doc,i=e.display;if(!r.mode.startState)return!0;var o=wt(e,t,n),s=o>r.first&&Ai(r,o-1).stateAfter;return s=s?Bs(r.mode,s):Fs(r.mode),r.iter(o,t,function(n){gi(e,n.text,s);var a=o==t-1||o%5==0||o>=i.viewFrom&&o<i.viewTo;n.stateAfter=a?Bs(r.mode,s):null,++o}),n&&(r.frontier=o),s}function St(e){return e.lineSpace.offsetTop}function Tt(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function Lt(e){if(e.cachedPaddingH)return e.cachedPaddingH;var t=wo(e.measure,xo("pre","x")),n=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,r={left:parseInt(n.paddingLeft),right:parseInt(n.paddingRight)};return isNaN(r.left)||isNaN(r.right)||(e.cachedPaddingH=r),r}function jt(e,t,n){var r=e.options.lineWrapping,i=r&&e.display.scroller.clientWidth;if(!t.measure.heights||r&&t.measure.width!=i){var o=t.measure.heights=[];if(r){t.measure.width=i;for(var s=t.text.firstChild.getClientRects(),a=0;a<s.length-1;a++){var l=s[a],c=s[a+1];Math.abs(l.bottom-c.bottom)>2&&o.push((l.bottom+c.top)/2-n.top)}}o.push(n.bottom-n.top)}}function Mt(e,t,n){if(e.line==t)return{map:e.measure.map,cache:e.measure.cache};for(var r=0;r<e.rest.length;r++)if(e.rest[r]==t)return{map:e.measure.maps[r],cache:e.measure.caches[r]};for(var r=0;r<e.rest.length;r++)if(Ii(e.rest[r])>n)return{map:e.measure.maps[r],cache:e.measure.caches[r],before:!0}}function At(e,t){t=Qr(t);var n=Ii(t),r=e.display.externalMeasured=new un(e.doc,t,n);r.lineN=n;var i=r.built=vi(e,r);return r.text=i.pre,wo(e.display.lineMeasure,i.pre),r}function Ot(e,t,n,r){return It(e,Nt(e,t),n,r)}function Et(e,t){if(t>=e.display.viewFrom&&t<e.display.viewTo)return e.display.view[vn(e,t)];var n=e.display.externalMeasured;return n&&t>=n.lineN&&t<n.lineN+n.size?n:void 0}function Nt(e,t){var n=Ii(t),r=Et(e,n);r&&!r.text?r=null:r&&r.changes&&N(e,r,n,O(e)),r||(r=At(e,t));var i=Mt(r,t,n);return{line:t,view:r,rect:null,map:i.map,cache:i.cache,before:i.before,hasHeights:!1}}function It(e,t,n,r,i){t.before&&(n=-1);var o,s=n+(r||"");return t.cache.hasOwnProperty(s)?o=t.cache[s]:(t.rect||(t.rect=t.view.text.getBoundingClientRect()),t.hasHeights||(jt(e,t.view,t.rect),t.hasHeights=!0),o=Ht(e,t,n,r),o.bogus||(t.cache[s]=o)),{left:o.left,right:o.right,top:i?o.rtop:o.top,bottom:i?o.rbottom:o.bottom}}function Ht(e,t,n,r){for(var i,o,s,a,l=t.map,c=0;c<l.length;c+=3){var d=l[c],h=l[c+1];if(d>n?(o=0,s=1,a="left"):h>n?(o=n-d,s=o+1):(c==l.length-3||n==h&&l[c+3]>n)&&(s=h-d,o=s-1,n>=h&&(a="right")),null!=o){if(i=l[c+2],d==h&&r==(i.insertLeft?"left":"right")&&(a=r),"left"==r&&0==o)for(;c&&l[c-2]==l[c-3]&&l[c-1].insertLeft;)i=l[(c-=3)+2],a="left";if("right"==r&&o==h-d)for(;c<l.length-3&&l[c+3]==l[c+4]&&!l[c+5].insertLeft;)i=l[(c+=3)+2],a="right";break}}var u;if(3==i.nodeType){for(;o&&bo(t.line.text.charAt(d+o));)--o;for(;h>d+s&&bo(t.line.text.charAt(d+s));)++s;if(Qo&&9>Zo&&0==o&&s==h-d)u=i.parentNode.getBoundingClientRect();else if(Qo&&e.options.lineWrapping){var f=_a(i,o,s).getClientRects();u=f.length?f["right"==r?f.length-1:0]:Cs}else u=_a(i,o,s).getBoundingClientRect()||Cs}else{o>0&&(a=r="right");var f;u=e.options.lineWrapping&&(f=i.getClientRects()).length>1?f["right"==r?f.length-1:0]:i.getBoundingClientRect()}if(Qo&&9>Zo&&!o&&(!u||!u.left&&!u.right)){var p=i.parentNode.getClientRects()[0];u=p?{left:p.left,right:p.left+Jt(e.display),top:p.top,bottom:p.bottom}:Cs}Qo&&11>Zo&&(u=Pt(e.display.measure,u));for(var g=u.top-t.rect.top,m=u.bottom-t.rect.top,v=(g+m)/2,y=t.view.measure.heights,c=0;c<y.length-1&&!(v<y[c]);c++);var _=c?y[c-1]:0,b=y[c],x={left:("right"==a?u.right:u.left)-t.rect.left,right:("left"==a?u.left:u.right)-t.rect.left,top:_,bottom:b};return u.left||u.right||(x.bogus=!0),e.options.singleCursorHeightPerLine||(x.rtop=g,x.rbottom=m),x}function Pt(e,t){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!Po(e))return t;var n=screen.logicalXDPI/screen.deviceXDPI,r=screen.logicalYDPI/screen.deviceYDPI;return{left:t.left*n,right:t.right*n,top:t.top*r,bottom:t.bottom*r}}function Dt(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(var t=0;t<e.rest.length;t++)e.measure.caches[t]={}}function Rt(e){e.display.externalMeasure=null,Co(e.display.lineMeasure);for(var t=0;t<e.display.view.length;t++)Dt(e.display.view[t])}function Bt(e){Rt(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function Ft(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function Wt(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function Kt(e,t,n,r){if(t.widgets)for(var i=0;i<t.widgets.length;++i)if(t.widgets[i].above){var o=oi(t.widgets[i]);n.top+=o,n.bottom+=o}if("line"==r)return n;r||(r="local");var s=Pi(t);if("local"==r?s+=St(e.display):s-=e.display.viewOffset,"page"==r||"window"==r){var a=e.display.lineSpace.getBoundingClientRect();s+=a.top+("window"==r?0:Wt());var l=a.left+("window"==r?0:Ft());n.left+=l,n.right+=l}return n.top+=s,n.bottom+=s,n}function Ut(e,t,n){if("div"==n)return t;var r=t.left,i=t.top;if("page"==n)r-=Ft(),i-=Wt();else if("local"==n||!n){var o=e.display.sizer.getBoundingClientRect();r+=o.left,i+=o.top}var s=e.display.lineSpace.getBoundingClientRect();return{left:r-s.left,top:i-s.top}}function zt(e,t,n,r,i){return r||(r=Ai(e.doc,t.line)),Kt(e,r,Ot(e,r,t.ch,i),n)}function Vt(e,t,n,r,i,o){function s(t,s){var a=It(e,i,t,s?"right":"left",o);return s?a.left=a.right:a.right=a.left,Kt(e,r,a,n)}function a(e,t){var n=l[t],r=n.level%2;return e==Ro(n)&&t&&n.level<l[t-1].level?(n=l[--t],e=Bo(n)-(n.level%2?0:1),r=!0):e==Bo(n)&&t<l.length-1&&n.level<l[t+1].level&&(n=l[++t],e=Ro(n)-n.level%2,r=!1),r&&e==n.to&&e>n.from?s(e-1):s(e,r)}r=r||Ai(e.doc,t.line),i||(i=Nt(e,r));var l=Di(r),c=t.ch;if(!l)return s(c);var d=Vo(l,c),h=a(c,d);return null!=Na&&(h.other=a(c,Na)),h}function qt(e,t){var n=0,t=Z(e.doc,t);e.options.lineWrapping||(n=Jt(e.display)*t.ch);var r=Ai(e.doc,t.line),i=Pi(r)+St(e.display);return{left:n,right:n,top:i,bottom:i+r.height}}function Gt(e,t,n,r){var i=vs(e,t);return i.xRel=r,n&&(i.outside=!0),i}function Xt(e,t,n){var r=e.doc;if(n+=e.display.viewOffset,0>n)return Gt(r.first,0,!0,-1);var i=Hi(r,n),o=r.first+r.size-1;if(i>o)return Gt(r.first+r.size-1,Ai(r,o).text.length,!0,1);0>t&&(t=0);for(var s=Ai(r,i);;){var a=$t(e,s,i,t,n),l=Yr(s),c=l&&l.find(0,!0);if(!l||!(a.ch>c.from.ch||a.ch==c.from.ch&&a.xRel>0))return a;i=Ii(s=c.to.line)}}function $t(e,t,n,r,i){function o(r){var i=Vt(e,vs(n,r),"line",t,c);return a=!0,s>i.bottom?i.left-l:s<i.top?i.left+l:(a=!1,i.left)}var s=i-Pi(t),a=!1,l=2*e.display.wrapper.clientWidth,c=Nt(e,t),d=Di(t),h=t.text.length,u=Fo(t),f=Wo(t),p=o(u),g=a,m=o(f),v=a;if(r>m)return Gt(n,f,v,1);for(;;){if(d?f==u||f==Go(t,u,1):1>=f-u){for(var y=p>r||m-r>=r-p?u:f,_=r-(y==u?p:m);bo(t.text.charAt(y));)++y;var b=Gt(n,y,y==u?g:v,-1>_?-1:_>1?1:0);return b}var x=Math.ceil(h/2),C=u+x;if(d){C=u;for(var w=0;x>w;++w)C=Go(t,C,1)}var k=o(C);k>r?(f=C,m=k,(v=a)&&(m+=1e3),h=x):(u=C,p=k,g=a,h-=x)}}function Yt(e){if(null!=e.cachedTextHeight)return e.cachedTextHeight;if(null==_s){_s=xo("pre");for(var t=0;49>t;++t)_s.appendChild(document.createTextNode("x")),_s.appendChild(xo("br"));_s.appendChild(document.createTextNode("x"))}wo(e.measure,_s);var n=_s.offsetHeight/50;return n>3&&(e.cachedTextHeight=n),Co(e.measure),n||1}function Jt(e){if(null!=e.cachedCharWidth)return e.cachedCharWidth;var t=xo("span","xxxxxxxxxx"),n=xo("pre",[t]);wo(e.measure,n);var r=t.getBoundingClientRect(),i=(r.right-r.left)/10;return i>2&&(e.cachedCharWidth=i),i||10}function Qt(e){e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:null,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,id:++ks},ws?ws.ops.push(e.curOp):e.curOp.ownsGroup=ws={ops:[e.curOp],delayedCallbacks:[]}}function Zt(e){var t=e.delayedCallbacks,n=0;do{for(;n<t.length;n++)t[n]();for(var r=0;r<e.ops.length;r++){var i=e.ops[r];if(i.cursorActivityHandlers)for(;i.cursorActivityCalled<i.cursorActivityHandlers.length;)i.cursorActivityHandlers[i.cursorActivityCalled++](i.cm)}}while(n<t.length)}function en(e){var t=e.curOp,n=t.ownsGroup;if(n)try{Zt(n)}finally{ws=null;for(var r=0;r<n.ops.length;r++)n.ops[r].cm.curOp=null;tn(n)}}function tn(e){for(var t=e.ops,n=0;n<t.length;n++)nn(t[n]);for(var n=0;n<t.length;n++)rn(t[n]);for(var n=0;n<t.length;n++)on(t[n]);for(var n=0;n<t.length;n++)sn(t[n]);for(var n=0;n<t.length;n++)an(t[n])}function nn(e){var t=e.cm,n=t.display;e.updateMaxLine&&f(t),e.mustUpdate=e.viewChanged||e.forceUpdate||null!=e.scrollTop||e.scrollToPos&&(e.scrollToPos.from.line<n.viewFrom||e.scrollToPos.to.line>=n.viewTo)||n.maxLineChanged&&t.options.lineWrapping,e.update=e.mustUpdate&&new w(t,e.mustUpdate&&{top:e.scrollTop,ensure:e.scrollToPos},e.forceUpdate)}function rn(e){e.updatedDisplay=e.mustUpdate&&k(e.cm,e.update)}function on(e){var t=e.cm,n=t.display;e.updatedDisplay&&M(t),n.maxLineChanged&&!t.options.lineWrapping&&(e.adjustWidthTo=Ot(t,n.maxLine,n.maxLine.text.length).left,e.maxScrollLeft=Math.max(0,n.sizer.offsetLeft+e.adjustWidthTo+ha-n.scroller.clientWidth)),e.barMeasure=m(t),(e.updatedDisplay||e.selectionChanged)&&(e.newSelectionNodes=mt(t))}function sn(e){var t=e.cm;null!=e.adjustWidthTo&&(t.display.sizer.style.minWidth=e.adjustWidthTo+"px",e.maxScrollLeft<t.doc.scrollLeft&&Wn(t,Math.min(t.display.scroller.scrollLeft,e.maxScrollLeft),!0)),e.newSelectionNodes&&vt(t,e.newSelectionNodes),e.updatedDisplay&&L(t,e.barMeasure),(e.updatedDisplay||e.startHeight!=t.doc.height)&&v(t,e.barMeasure),e.selectionChanged&&bt(t),t.state.focused&&e.updateInput&&kn(t,e.typing)
}function an(e){var t=e.cm,n=t.display,r=t.doc;if(e.updatedDisplay&&S(t,e.update),null==n.wheelStartX||null==e.scrollTop&&null==e.scrollLeft&&!e.scrollToPos||(n.wheelStartX=n.wheelStartY=null),null!=e.scrollTop&&n.scroller.scrollTop!=e.scrollTop){var i=Math.max(0,Math.min(n.scroller.scrollHeight-n.scroller.clientHeight,e.scrollTop));n.scroller.scrollTop=n.scrollbarV.scrollTop=r.scrollTop=i}if(null!=e.scrollLeft&&n.scroller.scrollLeft!=e.scrollLeft){var o=Math.max(0,Math.min(n.scroller.scrollWidth-n.scroller.clientWidth,e.scrollLeft));n.scroller.scrollLeft=n.scrollbarH.scrollLeft=r.scrollLeft=o,_(t)}if(e.scrollToPos){var s=pr(t,Z(r,e.scrollToPos.from),Z(r,e.scrollToPos.to),e.scrollToPos.margin);e.scrollToPos.isCursor&&t.state.focused&&fr(t,s)}var a=e.maybeHiddenMarkers,l=e.maybeUnhiddenMarkers;if(a)for(var c=0;c<a.length;++c)a[c].lines.length||ca(a[c],"hide");if(l)for(var c=0;c<l.length;++c)l[c].lines.length&&ca(l[c],"unhide");n.wrapper.offsetHeight&&(r.scrollTop=t.display.scroller.scrollTop),e.updatedDisplay&&es&&(t.options.lineWrapping&&j(t,e.barMeasure),e.barMeasure.scrollWidth>e.barMeasure.clientWidth&&e.barMeasure.scrollWidth<e.barMeasure.clientWidth+1&&!g(t)&&v(t)),e.changeObjs&&ca(t,"changes",t,e.changeObjs)}function ln(e,t){if(e.curOp)return t();Qt(e);try{return t()}finally{en(e)}}function cn(e,t){return function(){if(e.curOp)return t.apply(e,arguments);Qt(e);try{return t.apply(e,arguments)}finally{en(e)}}}function dn(e){return function(){if(this.curOp)return e.apply(this,arguments);Qt(this);try{return e.apply(this,arguments)}finally{en(this)}}}function hn(e){return function(){var t=this.cm;if(!t||t.curOp)return e.apply(this,arguments);Qt(t);try{return e.apply(this,arguments)}finally{en(t)}}}function un(e,t,n){this.line=t,this.rest=Zr(t),this.size=this.rest?Ii(uo(this.rest))-n+1:1,this.node=this.text=null,this.hidden=ni(e,t)}function fn(e,t,n){for(var r,i=[],o=t;n>o;o=r){var s=new un(e.doc,Ai(e.doc,o),o);r=o+s.size,i.push(s)}return i}function pn(e,t,n,r){null==t&&(t=e.doc.first),null==n&&(n=e.doc.first+e.doc.size),r||(r=0);var i=e.display;if(r&&n<i.viewTo&&(null==i.updateLineNumbers||i.updateLineNumbers>t)&&(i.updateLineNumbers=t),e.curOp.viewChanged=!0,t>=i.viewTo)ms&&ei(e.doc,t)<i.viewTo&&mn(e);else if(n<=i.viewFrom)ms&&ti(e.doc,n+r)>i.viewFrom?mn(e):(i.viewFrom+=r,i.viewTo+=r);else if(t<=i.viewFrom&&n>=i.viewTo)mn(e);else if(t<=i.viewFrom){var o=yn(e,n,n+r,1);o?(i.view=i.view.slice(o.index),i.viewFrom=o.lineN,i.viewTo+=r):mn(e)}else if(n>=i.viewTo){var o=yn(e,t,t,-1);o?(i.view=i.view.slice(0,o.index),i.viewTo=o.lineN):mn(e)}else{var s=yn(e,t,t,-1),a=yn(e,n,n+r,1);s&&a?(i.view=i.view.slice(0,s.index).concat(fn(e,s.lineN,a.lineN)).concat(i.view.slice(a.index)),i.viewTo+=r):mn(e)}var l=i.externalMeasured;l&&(n<l.lineN?l.lineN+=r:t<l.lineN+l.size&&(i.externalMeasured=null))}function gn(e,t,n){e.curOp.viewChanged=!0;var r=e.display,i=e.display.externalMeasured;if(i&&t>=i.lineN&&t<i.lineN+i.size&&(r.externalMeasured=null),!(t<r.viewFrom||t>=r.viewTo)){var o=r.view[vn(e,t)];if(null!=o.node){var s=o.changes||(o.changes=[]);-1==fo(s,n)&&s.push(n)}}}function mn(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function vn(e,t){if(t>=e.display.viewTo)return null;if(t-=e.display.viewFrom,0>t)return null;for(var n=e.display.view,r=0;r<n.length;r++)if(t-=n[r].size,0>t)return r}function yn(e,t,n,r){var i,o=vn(e,t),s=e.display.view;if(!ms||n==e.doc.first+e.doc.size)return{index:o,lineN:n};for(var a=0,l=e.display.viewFrom;o>a;a++)l+=s[a].size;if(l!=t){if(r>0){if(o==s.length-1)return null;i=l+s[o].size-t,o++}else i=l-t;t+=i,n+=i}for(;ei(e.doc,n)!=n;){if(o==(0>r?0:s.length-1))return null;n+=r*s[o-(0>r?1:0)].size,o+=r}return{index:o,lineN:n}}function _n(e,t,n){var r=e.display,i=r.view;0==i.length||t>=r.viewTo||n<=r.viewFrom?(r.view=fn(e,t,n),r.viewFrom=t):(r.viewFrom>t?r.view=fn(e,t,r.viewFrom).concat(r.view):r.viewFrom<t&&(r.view=r.view.slice(vn(e,t))),r.viewFrom=t,r.viewTo<n?r.view=r.view.concat(fn(e,r.viewTo,n)):r.viewTo>n&&(r.view=r.view.slice(0,vn(e,n)))),r.viewTo=n}function bn(e){for(var t=e.display.view,n=0,r=0;r<t.length;r++){var i=t[r];i.hidden||i.node&&!i.changes||++n}return n}function xn(e){e.display.pollingFast||e.display.poll.set(e.options.pollInterval,function(){wn(e),e.state.focused&&xn(e)})}function Cn(e){function t(){var r=wn(e);r||n?(e.display.pollingFast=!1,xn(e)):(n=!0,e.display.poll.set(60,t))}var n=!1;e.display.pollingFast=!0,e.display.poll.set(20,t)}function wn(e){var t=e.display.input,n=e.display.prevInput,r=e.doc;if(!e.state.focused||Ma(t)&&!n||Ln(e)||e.options.disableInput)return!1;e.state.pasteIncoming&&e.state.fakedLastChar&&(t.value=t.value.substring(0,t.value.length-1),e.state.fakedLastChar=!1);var i=t.value;if(i==n&&!e.somethingSelected())return!1;if(Qo&&Zo>=9&&e.display.inputHasSelection===i)return kn(e),!1;var o=!e.curOp;o&&Qt(e),e.display.shift=!1,8203!=i.charCodeAt(0)||r.sel!=e.display.selForContextMenu||n||(n="​");for(var s=0,a=Math.min(n.length,i.length);a>s&&n.charCodeAt(s)==i.charCodeAt(s);)++s;for(var l=i.slice(s),c=ja(l),d=e.state.pasteIncoming&&c.length>1&&r.sel.ranges.length==c.length,h=r.sel.ranges.length-1;h>=0;h--){var u=r.sel.ranges[h],f=u.from(),p=u.to();s<n.length?f=vs(f.line,f.ch-(n.length-s)):e.state.overwrite&&u.empty()&&!e.state.pasteIncoming&&(p=vs(p.line,Math.min(Ai(r,p.line).text.length,p.ch+uo(c).length)));var g=e.curOp.updateInput,m={from:f,to:p,text:d?[c[h]]:c,origin:e.state.pasteIncoming?"paste":e.state.cutIncoming?"cut":"+input"};if(sr(e.doc,m),no(e,"inputRead",e,m),l&&!e.state.pasteIncoming&&e.options.electricChars&&e.options.smartIndent&&u.head.ch<100&&(!h||r.sel.ranges[h-1].head.line!=u.head.line)){var v=e.getModeAt(u.head);if(v.electricChars){for(var y=0;y<v.electricChars.length;y++)if(l.indexOf(v.electricChars.charAt(y))>-1){br(e,u.head.line,"smart");break}}else if(v.electricInput){var _=As(m);v.electricInput.test(Ai(r,_.line).text.slice(0,_.ch))&&br(e,u.head.line,"smart")}}}return yr(e),e.curOp.updateInput=g,e.curOp.typing=!0,i.length>1e3||i.indexOf("\n")>-1?t.value=e.display.prevInput="":e.display.prevInput=i,o&&en(e),e.state.pasteIncoming=e.state.cutIncoming=!1,!0}function kn(e,t){var n,r,i=e.doc;if(e.somethingSelected()){e.display.prevInput="";var o=i.sel.primary();n=Aa&&(o.to().line-o.from().line>100||(r=e.getSelection()).length>1e3);var s=n?"-":r||e.getSelection();e.display.input.value=s,e.state.focused&&ya(e.display.input),Qo&&Zo>=9&&(e.display.inputHasSelection=s)}else t||(e.display.prevInput=e.display.input.value="",Qo&&Zo>=9&&(e.display.inputHasSelection=null));e.display.inaccurateSelection=n}function Sn(e){"nocursor"==e.options.readOnly||cs&&So()==e.display.input||e.display.input.focus()}function Tn(e){e.state.focused||(Sn(e),Jn(e))}function Ln(e){return e.options.readOnly||e.doc.cantEdit}function jn(e){function t(){e.state.focused&&setTimeout(vo(Sn,e),0)}function n(t){io(e,t)||sa(t)}function r(t){if(e.somethingSelected())i.inaccurateSelection&&(i.prevInput="",i.inaccurateSelection=!1,i.input.value=e.getSelection(),ya(i.input));else{for(var n="",r=[],o=0;o<e.doc.sel.ranges.length;o++){var s=e.doc.sel.ranges[o].head.line,a={anchor:vs(s,0),head:vs(s+1,0)};r.push(a),n+=e.getRange(a.anchor,a.head)}"cut"==t.type?e.setSelections(r,null,fa):(i.prevInput="",i.input.value=n,ya(i.input))}"cut"==t.type&&(e.state.cutIncoming=!0)}var i=e.display;aa(i.scroller,"mousedown",cn(e,En)),Qo&&11>Zo?aa(i.scroller,"dblclick",cn(e,function(t){if(!io(e,t)){var n=On(e,t);if(n&&!Dn(e,t)&&!An(e.display,t)){ia(t);var r=Sr(e,n);it(e.doc,r.anchor,r.head)}}})):aa(i.scroller,"dblclick",function(t){io(e,t)||ia(t)}),aa(i.lineSpace,"selectstart",function(e){An(i,e)||ia(e)}),ps||aa(i.scroller,"contextmenu",function(t){Zn(e,t)}),aa(i.scroller,"scroll",function(){i.scroller.clientHeight&&(Fn(e,i.scroller.scrollTop),Wn(e,i.scroller.scrollLeft,!0),ca(e,"scroll",e))}),aa(i.scrollbarV,"scroll",function(){i.scroller.clientHeight&&Fn(e,i.scrollbarV.scrollTop)}),aa(i.scrollbarH,"scroll",function(){i.scroller.clientHeight&&Wn(e,i.scrollbarH.scrollLeft)}),aa(i.scroller,"mousewheel",function(t){Kn(e,t)}),aa(i.scroller,"DOMMouseScroll",function(t){Kn(e,t)}),aa(i.scrollbarH,"mousedown",t),aa(i.scrollbarV,"mousedown",t),aa(i.wrapper,"scroll",function(){i.wrapper.scrollTop=i.wrapper.scrollLeft=0}),aa(i.input,"keyup",function(t){$n.call(e,t)}),aa(i.input,"input",function(){Qo&&Zo>=9&&e.display.inputHasSelection&&(e.display.inputHasSelection=null),Cn(e)}),aa(i.input,"keydown",cn(e,Gn)),aa(i.input,"keypress",cn(e,Yn)),aa(i.input,"focus",vo(Jn,e)),aa(i.input,"blur",vo(Qn,e)),e.options.dragDrop&&(aa(i.scroller,"dragstart",function(t){Bn(e,t)}),aa(i.scroller,"dragenter",n),aa(i.scroller,"dragover",n),aa(i.scroller,"drop",cn(e,Rn))),aa(i.scroller,"paste",function(t){An(i,t)||(e.state.pasteIncoming=!0,Sn(e),Cn(e))}),aa(i.input,"paste",function(){if(es&&!e.state.fakedLastChar&&!(new Date-e.state.lastMiddleDown<200)){var t=i.input.selectionStart,n=i.input.selectionEnd;i.input.value+="$",i.input.selectionEnd=n,i.input.selectionStart=t,e.state.fakedLastChar=!0}e.state.pasteIncoming=!0,Cn(e)}),aa(i.input,"cut",r),aa(i.input,"copy",r),os&&aa(i.sizer,"mouseup",function(){So()==i.input&&i.input.blur(),Sn(e)})}function Mn(e){var t=e.display;t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null,e.setSize()}function An(e,t){for(var n=eo(t);n!=e.wrapper;n=n.parentNode)if(!n||n.ignoreEvents||n.parentNode==e.sizer&&n!=e.mover)return!0}function On(e,t,n,r){var i=e.display;if(!n){var o=eo(t);if(o==i.scrollbarH||o==i.scrollbarV||o==i.scrollbarFiller||o==i.gutterFiller)return null}var s,a,l=i.lineSpace.getBoundingClientRect();try{s=t.clientX-l.left,a=t.clientY-l.top}catch(t){return null}var c,d=Xt(e,s,a);if(r&&1==d.xRel&&(c=Ai(e.doc,d.line).text).length==d.ch){var h=ma(c,c.length,e.options.tabSize)-c.length;d=vs(d.line,Math.max(0,Math.round((s-Lt(e.display).left)/Jt(e.display))-h))}return d}function En(e){if(!io(this,e)){var t=this,n=t.display;if(n.shift=e.shiftKey,An(n,e))return es||(n.scroller.draggable=!1,setTimeout(function(){n.scroller.draggable=!0},100)),void 0;if(!Dn(t,e)){var r=On(t,e);switch(window.focus(),to(e)){case 1:r?Nn(t,e,r):eo(e)==n.scroller&&ia(e);break;case 2:es&&(t.state.lastMiddleDown=+new Date),r&&it(t.doc,r),setTimeout(vo(Sn,t),20),ia(e);break;case 3:ps&&Zn(t,e)}}}}function Nn(e,t,n){setTimeout(vo(Tn,e),0);var r,i=+new Date;xs&&xs.time>i-400&&0==ys(xs.pos,n)?r="triple":bs&&bs.time>i-400&&0==ys(bs.pos,n)?(r="double",xs={time:i,pos:n}):(r="single",bs={time:i,pos:n});var o=e.doc.sel,s=ds?t.metaKey:t.ctrlKey;e.options.dragDrop&&La&&!Ln(e)&&"single"==r&&o.contains(n)>-1&&o.somethingSelected()?In(e,t,n,s):Hn(e,t,n,r,s)}function In(e,t,n,r){var i=e.display,o=cn(e,function(s){es&&(i.scroller.draggable=!1),e.state.draggingText=!1,la(document,"mouseup",o),la(i.scroller,"drop",o),Math.abs(t.clientX-s.clientX)+Math.abs(t.clientY-s.clientY)<10&&(ia(s),r||it(e.doc,n),Sn(e),Qo&&9==Zo&&setTimeout(function(){document.body.focus(),Sn(e)},20))});es&&(i.scroller.draggable=!0),e.state.draggingText=o,i.scroller.dragDrop&&i.scroller.dragDrop(),aa(document,"mouseup",o),aa(i.scroller,"drop",o)}function Hn(e,t,n,r,i){function o(t){if(0!=ys(g,t))if(g=t,"rect"==r){for(var i=[],o=e.options.tabSize,s=ma(Ai(c,n.line).text,n.ch,o),a=ma(Ai(c,t.line).text,t.ch,o),l=Math.min(s,a),f=Math.max(s,a),p=Math.min(n.line,t.line),m=Math.min(e.lastLine(),Math.max(n.line,t.line));m>=p;p++){var v=Ai(c,p).text,y=co(v,l,o);l==f?i.push(new $(vs(p,y),vs(p,y))):v.length>y&&i.push(new $(vs(p,y),vs(p,co(v,f,o))))}i.length||i.push(new $(n,n)),dt(c,Y(u.ranges.slice(0,h).concat(i),h),{origin:"*mouse",scroll:!1}),e.scrollIntoView(t)}else{var _=d,b=_.anchor,x=t;if("single"!=r){if("double"==r)var C=Sr(e,t);else var C=new $(vs(t.line,0),Z(c,vs(t.line+1,0)));ys(C.anchor,b)>0?(x=C.head,b=G(_.from(),C.anchor)):(x=C.anchor,b=q(_.to(),C.head))}var i=u.ranges.slice(0);i[h]=new $(Z(c,b),x),dt(c,Y(i,h),pa)}}function s(t){var n=++v,i=On(e,t,!0,"rect"==r);if(i)if(0!=ys(i,g)){Tn(e),o(i);var a=y(l,c);(i.line>=a.to||i.line<a.from)&&setTimeout(cn(e,function(){v==n&&s(t)}),150)}else{var d=t.clientY<m.top?-20:t.clientY>m.bottom?20:0;d&&setTimeout(cn(e,function(){v==n&&(l.scroller.scrollTop+=d,s(t))}),50)}}function a(t){v=1/0,ia(t),Sn(e),la(document,"mousemove",_),la(document,"mouseup",b),c.history.lastSelOrigin=null}var l=e.display,c=e.doc;ia(t);var d,h,u=c.sel;if(i&&!t.shiftKey?(h=c.sel.contains(n),d=h>-1?c.sel.ranges[h]:new $(n,n)):d=c.sel.primary(),t.altKey)r="rect",i||(d=new $(n,n)),n=On(e,t,!0,!0),h=-1;else if("double"==r){var f=Sr(e,n);d=e.display.shift||c.extend?rt(c,d,f.anchor,f.head):f}else if("triple"==r){var p=new $(vs(n.line,0),Z(c,vs(n.line+1,0)));d=e.display.shift||c.extend?rt(c,d,p.anchor,p.head):p}else d=rt(c,d,n);i?h>-1?st(c,h,d,pa):(h=c.sel.ranges.length,dt(c,Y(c.sel.ranges.concat([d]),h),{scroll:!1,origin:"*mouse"})):(h=0,dt(c,new X([d],0),pa),u=c.sel);var g=n,m=l.wrapper.getBoundingClientRect(),v=0,_=cn(e,function(e){to(e)?s(e):a(e)}),b=cn(e,a);aa(document,"mousemove",_),aa(document,"mouseup",b)}function Pn(e,t,n,r,i){try{var o=t.clientX,s=t.clientY}catch(t){return!1}if(o>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;r&&ia(t);var a=e.display,l=a.lineDiv.getBoundingClientRect();if(s>l.bottom||!so(e,n))return Zi(t);s-=l.top-a.viewOffset;for(var c=0;c<e.options.gutters.length;++c){var d=a.gutters.childNodes[c];if(d&&d.getBoundingClientRect().right>=o){var h=Hi(e.doc,s),u=e.options.gutters[c];return i(e,n,e,h,u,t),Zi(t)}}}function Dn(e,t){return Pn(e,t,"gutterClick",!0,no)}function Rn(e){var t=this;if(!io(t,e)&&!An(t.display,e)){ia(e),Qo&&(Ss=+new Date);var n=On(t,e,!0),r=e.dataTransfer.files;if(n&&!Ln(t))if(r&&r.length&&window.FileReader&&window.File)for(var i=r.length,o=Array(i),s=0,a=function(e,r){var a=new FileReader;a.onload=cn(t,function(){if(o[r]=a.result,++s==i){n=Z(t.doc,n);var e={from:n,to:n,text:ja(o.join("\n")),origin:"paste"};sr(t.doc,e),ct(t.doc,J(n,As(e)))}}),a.readAsText(e)},l=0;i>l;++l)a(r[l],l);else{if(t.state.draggingText&&t.doc.sel.contains(n)>-1)return t.state.draggingText(e),setTimeout(vo(Sn,t),20),void 0;try{var o=e.dataTransfer.getData("Text");if(o){if(t.state.draggingText&&!(ds?e.metaKey:e.ctrlKey))var c=t.listSelections();if(ht(t.doc,J(n,n)),c)for(var l=0;l<c.length;++l)ur(t.doc,"",c[l].anchor,c[l].head,"drag");t.replaceSelection(o,"around","paste"),Sn(t)}}catch(e){}}}}function Bn(e,t){if(Qo&&(!e.state.draggingText||+new Date-Ss<100))return sa(t),void 0;if(!io(e,t)&&!An(e.display,t)&&(t.dataTransfer.setData("Text",e.getSelection()),t.dataTransfer.setDragImage&&!is)){var n=xo("img",null,null,"position: fixed; left: 0; top: 0;");n.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",rs&&(n.width=n.height=1,e.display.wrapper.appendChild(n),n._top=n.offsetTop),t.dataTransfer.setDragImage(n,0,0),rs&&n.parentNode.removeChild(n)}}function Fn(e,t){Math.abs(e.doc.scrollTop-t)<2||(e.doc.scrollTop=t,$o||T(e,{top:t}),e.display.scroller.scrollTop!=t&&(e.display.scroller.scrollTop=t),e.display.scrollbarV.scrollTop!=t&&(e.display.scrollbarV.scrollTop=t),$o&&T(e),xt(e,100))}function Wn(e,t,n){(n?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)||(t=Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth),e.doc.scrollLeft=t,_(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbarH.scrollLeft!=t&&(e.display.scrollbarH.scrollLeft=t))}function Kn(e,t){var n=t.wheelDeltaX,r=t.wheelDeltaY;null==n&&t.detail&&t.axis==t.HORIZONTAL_AXIS&&(n=t.detail),null==r&&t.detail&&t.axis==t.VERTICAL_AXIS?r=t.detail:null==r&&(r=t.wheelDelta);var i=e.display,o=i.scroller;if(n&&o.scrollWidth>o.clientWidth||r&&o.scrollHeight>o.clientHeight){if(r&&ds&&es)e:for(var s=t.target,a=i.view;s!=o;s=s.parentNode)for(var l=0;l<a.length;l++)if(a[l].node==s){e.display.currentWheelTarget=s;break e}if(n&&!$o&&!rs&&null!=Ls)return r&&Fn(e,Math.max(0,Math.min(o.scrollTop+r*Ls,o.scrollHeight-o.clientHeight))),Wn(e,Math.max(0,Math.min(o.scrollLeft+n*Ls,o.scrollWidth-o.clientWidth))),ia(t),i.wheelStartX=null,void 0;if(r&&null!=Ls){var c=r*Ls,d=e.doc.scrollTop,h=d+i.wrapper.clientHeight;0>c?d=Math.max(0,d+c-50):h=Math.min(e.doc.height,h+c+50),T(e,{top:d,bottom:h})}20>Ts&&(null==i.wheelStartX?(i.wheelStartX=o.scrollLeft,i.wheelStartY=o.scrollTop,i.wheelDX=n,i.wheelDY=r,setTimeout(function(){if(null!=i.wheelStartX){var e=o.scrollLeft-i.wheelStartX,t=o.scrollTop-i.wheelStartY,n=t&&i.wheelDY&&t/i.wheelDY||e&&i.wheelDX&&e/i.wheelDX;i.wheelStartX=i.wheelStartY=null,n&&(Ls=(Ls*Ts+n)/(Ts+1),++Ts)}},200)):(i.wheelDX+=n,i.wheelDY+=r))}}function Un(e,t,n){if("string"==typeof t&&(t=Ws[t],!t))return!1;e.display.pollingFast&&wn(e)&&(e.display.pollingFast=!1);var r=e.display.shift,i=!1;try{Ln(e)&&(e.state.suppressEdits=!0),n&&(e.display.shift=!1),i=t(e)!=ua}finally{e.display.shift=r,e.state.suppressEdits=!1}return i}function zn(e){var t=e.state.keyMaps.slice(0);return e.options.extraKeys&&t.push(e.options.extraKeys),t.push(e.options.keyMap),t}function Vn(e,t){var n=Lr(e.options.keyMap),r=n.auto;clearTimeout(js),r&&!zs(t)&&(js=setTimeout(function(){Lr(e.options.keyMap)==n&&(e.options.keyMap=r.call?r.call(null,e):r,a(e))},50));var i=Vs(t,!0),o=!1;if(!i)return!1;var s=zn(e);return o=t.shiftKey?Us("Shift-"+i,s,function(t){return Un(e,t,!0)})||Us(i,s,function(t){return("string"==typeof t?/^go[A-Z]/.test(t):t.motion)?Un(e,t):void 0}):Us(i,s,function(t){return Un(e,t)}),o&&(ia(t),bt(e),no(e,"keyHandled",e,i,t)),o}function qn(e,t,n){var r=Us("'"+n+"'",zn(e),function(t){return Un(e,t,!0)});return r&&(ia(t),bt(e),no(e,"keyHandled",e,"'"+n+"'",t)),r}function Gn(e){var t=this;if(Tn(t),!io(t,e)){Qo&&11>Zo&&27==e.keyCode&&(e.returnValue=!1);var n=e.keyCode;t.display.shift=16==n||e.shiftKey;var r=Vn(t,e);rs&&(Ms=r?n:null,!r&&88==n&&!Aa&&(ds?e.metaKey:e.ctrlKey)&&t.replaceSelection("",null,"cut")),18!=n||/\bCodeMirror-crosshair\b/.test(t.display.lineDiv.className)||Xn(t)}}function Xn(e){function t(e){18!=e.keyCode&&e.altKey||(Lo(n,"CodeMirror-crosshair"),la(document,"keyup",t),la(document,"mouseover",t))}var n=e.display.lineDiv;jo(n,"CodeMirror-crosshair"),aa(document,"keyup",t),aa(document,"mouseover",t)}function $n(e){16==e.keyCode&&(this.doc.sel.shift=!1),io(this,e)}function Yn(e){var t=this;if(!(io(t,e)||e.ctrlKey&&!e.altKey||ds&&e.metaKey)){var n=e.keyCode,r=e.charCode;if(rs&&n==Ms)return Ms=null,ia(e),void 0;if(!(rs&&(!e.which||e.which<10)||os)||!Vn(t,e)){var i=String.fromCharCode(null==r?n:r);qn(t,e,i)||(Qo&&Zo>=9&&(t.display.inputHasSelection=null),Cn(t))}}}function Jn(e){"nocursor"!=e.options.readOnly&&(e.state.focused||(ca(e,"focus",e),e.state.focused=!0,jo(e.display.wrapper,"CodeMirror-focused"),e.curOp||e.display.selForContextMenu==e.doc.sel||(kn(e),es&&setTimeout(vo(kn,e,!0),0))),xn(e),bt(e))}function Qn(e){e.state.focused&&(ca(e,"blur",e),e.state.focused=!1,Lo(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.display.shift=!1)},150)}function Zn(e,t){function n(){if(null!=i.input.selectionStart){var t=e.somethingSelected(),n=i.input.value="​"+(t?i.input.value:"");i.prevInput=t?"":"​",i.input.selectionStart=1,i.input.selectionEnd=n.length,i.selForContextMenu=e.doc.sel}}function r(){if(i.inputDiv.style.position="relative",i.input.style.cssText=l,Qo&&9>Zo&&(i.scrollbarV.scrollTop=i.scroller.scrollTop=s),xn(e),null!=i.input.selectionStart){(!Qo||Qo&&9>Zo)&&n();var t=0,r=function(){i.selForContextMenu==e.doc.sel&&0==i.input.selectionStart?cn(e,Ws.selectAll)(e):t++<10?i.detectingSelectAll=setTimeout(r,500):kn(e)};i.detectingSelectAll=setTimeout(r,200)}}if(!io(e,t,"contextmenu")){var i=e.display;if(!An(i,t)&&!er(e,t)){var o=On(e,t),s=i.scroller.scrollTop;if(o&&!rs){var a=e.options.resetSelectionOnContextMenu;a&&-1==e.doc.sel.contains(o)&&cn(e,dt)(e.doc,J(o),fa);var l=i.input.style.cssText;if(i.inputDiv.style.position="absolute",i.input.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(t.clientY-5)+"px; left: "+(t.clientX-5)+"px; z-index: 1000; background: "+(Qo?"rgba(255, 255, 255, .05)":"transparent")+"; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",Sn(e),kn(e),e.somethingSelected()||(i.input.value=i.prevInput=" "),i.selForContextMenu=e.doc.sel,clearTimeout(i.detectingSelectAll),Qo&&Zo>=9&&n(),ps){sa(t);var c=function(){la(window,"mouseup",c),setTimeout(r,20)};aa(window,"mouseup",c)}else setTimeout(r,50)}}}}function er(e,t){return so(e,"gutterContextMenu")?Pn(e,t,"gutterContextMenu",!1,ca):!1}function tr(e,t){if(ys(e,t.from)<0)return e;if(ys(e,t.to)<=0)return As(t);var n=e.line+t.text.length-(t.to.line-t.from.line)-1,r=e.ch;return e.line==t.to.line&&(r+=As(t).ch-t.to.ch),vs(n,r)}function nr(e,t){for(var n=[],r=0;r<e.sel.ranges.length;r++){var i=e.sel.ranges[r];n.push(new $(tr(i.anchor,t),tr(i.head,t)))}return Y(n,e.sel.primIndex)}function rr(e,t,n){return e.line==t.line?vs(n.line,e.ch-t.ch+n.ch):vs(n.line+(e.line-t.line),e.ch)}function ir(e,t,n){for(var r=[],i=vs(e.first,0),o=i,s=0;s<t.length;s++){var a=t[s],l=rr(a.from,i,o),c=rr(As(a),i,o);if(i=a.to,o=c,"around"==n){var d=e.sel.ranges[s],h=ys(d.head,d.anchor)<0;r[s]=new $(h?c:l,h?l:c)}else r[s]=new $(l,l)}return new X(r,e.sel.primIndex)}function or(e,t,n){var r={canceled:!1,from:t.from,to:t.to,text:t.text,origin:t.origin,cancel:function(){this.canceled=!0}};return n&&(r.update=function(t,n,r,i){t&&(this.from=Z(e,t)),n&&(this.to=Z(e,n)),r&&(this.text=r),void 0!==i&&(this.origin=i)}),ca(e,"beforeChange",e,r),e.cm&&ca(e.cm,"beforeChange",e.cm,r),r.canceled?null:{from:r.from,to:r.to,text:r.text,origin:r.origin}}function sr(e,t,n){if(e.cm){if(!e.cm.curOp)return cn(e.cm,sr)(e,t,n);if(e.cm.state.suppressEdits)return}if(!(so(e,"beforeChange")||e.cm&&so(e.cm,"beforeChange"))||(t=or(e,t,!0))){var r=gs&&!n&&Kr(e,t.from,t.to);if(r)for(var i=r.length-1;i>=0;--i)ar(e,{from:r[i].from,to:r[i].to,text:i?[""]:t.text});else ar(e,t)}}function ar(e,t){if(1!=t.text.length||""!=t.text[0]||0!=ys(t.from,t.to)){var n=nr(e,t);Ki(e,t,n,e.cm?e.cm.curOp.id:0/0),dr(e,t,n,Br(e,t));var r=[];ji(e,function(e,n){n||-1!=fo(r,e.history)||(Qi(e.history,t),r.push(e.history)),dr(e,t,null,Br(e,t))})}}function lr(e,t,n){if(!e.cm||!e.cm.state.suppressEdits){for(var r,i=e.history,o=e.sel,s="undo"==t?i.done:i.undone,a="undo"==t?i.undone:i.done,l=0;l<s.length&&(r=s[l],n?!r.ranges||r.equals(e.sel):r.ranges);l++);if(l!=s.length){for(i.lastOrigin=i.lastSelOrigin=null;r=s.pop(),r.ranges;){if(Vi(r,a),n&&!r.equals(e.sel))return dt(e,r,{clearRedo:!1}),void 0;o=r}var c=[];Vi(o,a),a.push({changes:c,generation:i.generation}),i.generation=r.generation||++i.maxGeneration;for(var d=so(e,"beforeChange")||e.cm&&so(e.cm,"beforeChange"),l=r.changes.length-1;l>=0;--l){var h=r.changes[l];if(h.origin=t,d&&!or(e,h,!1))return s.length=0,void 0;c.push(Bi(e,h));var u=l?nr(e,h,null):uo(s);dr(e,h,u,Wr(e,h)),!l&&e.cm&&e.cm.scrollIntoView(h);var f=[];ji(e,function(e,t){t||-1!=fo(f,e.history)||(Qi(e.history,h),f.push(e.history)),dr(e,h,null,Wr(e,h))})}}}}function cr(e,t){if(0!=t&&(e.first+=t,e.sel=new X(po(e.sel.ranges,function(e){return new $(vs(e.anchor.line+t,e.anchor.ch),vs(e.head.line+t,e.head.ch))}),e.sel.primIndex),e.cm)){pn(e.cm,e.first,e.first-t,t);for(var n=e.cm.display,r=n.viewFrom;r<n.viewTo;r++)gn(e.cm,r,"gutter")}}function dr(e,t,n,r){if(e.cm&&!e.cm.curOp)return cn(e.cm,dr)(e,t,n,r);if(t.to.line<e.first)return cr(e,t.text.length-1-(t.to.line-t.from.line)),void 0;if(!(t.from.line>e.lastLine())){if(t.from.line<e.first){var i=t.text.length-1-(e.first-t.from.line);cr(e,i),t={from:vs(e.first,0),to:vs(t.to.line+i,t.to.ch),text:[uo(t.text)],origin:t.origin}}var o=e.lastLine();t.to.line>o&&(t={from:t.from,to:vs(o,Ai(e,o).text.length),text:[t.text[0]],origin:t.origin}),t.removed=Oi(e,t.from,t.to),n||(n=nr(e,t,null)),e.cm?hr(e.cm,t,r):Si(e,t,r),ht(e,n,fa)}}function hr(e,t,n){var r=e.doc,i=e.display,s=t.from,a=t.to,l=!1,c=s.line;e.options.lineWrapping||(c=Ii(Qr(Ai(r,s.line))),r.iter(c,a.line+1,function(e){return e==i.maxLine?(l=!0,!0):void 0})),r.sel.contains(t.from,t.to)>-1&&oo(e),Si(r,t,n,o(e)),e.options.lineWrapping||(r.iter(c,s.line+t.text.length,function(e){var t=u(e);t>i.maxLineLength&&(i.maxLine=e,i.maxLineLength=t,i.maxLineChanged=!0,l=!1)}),l&&(e.curOp.updateMaxLine=!0)),r.frontier=Math.min(r.frontier,s.line),xt(e,400);var d=t.text.length-(a.line-s.line)-1;s.line!=a.line||1!=t.text.length||ki(e.doc,t)?pn(e,s.line,a.line+1,d):gn(e,s.line,"text");var h=so(e,"changes"),f=so(e,"change");if(f||h){var p={from:s,to:a,text:t.text,removed:t.removed,origin:t.origin};f&&no(e,"change",e,p),h&&(e.curOp.changeObjs||(e.curOp.changeObjs=[])).push(p)}e.display.selForContextMenu=null}function ur(e,t,n,r,i){if(r||(r=n),ys(r,n)<0){var o=r;r=n,n=o}"string"==typeof t&&(t=ja(t)),sr(e,{from:n,to:r,text:t,origin:i})}function fr(e,t){var n=e.display,r=n.sizer.getBoundingClientRect(),i=null;if(t.top+r.top<0?i=!0:t.bottom+r.top>(window.innerHeight||document.documentElement.clientHeight)&&(i=!1),null!=i&&!as){var o=xo("div","​",null,"position: absolute; top: "+(t.top-n.viewOffset-St(e.display))+"px; height: "+(t.bottom-t.top+ha)+"px; left: "+t.left+"px; width: 2px;");e.display.lineSpace.appendChild(o),o.scrollIntoView(i),e.display.lineSpace.removeChild(o)}}function pr(e,t,n,r){for(null==r&&(r=0);;){var i=!1,o=Vt(e,t),s=n&&n!=t?Vt(e,n):o,a=mr(e,Math.min(o.left,s.left),Math.min(o.top,s.top)-r,Math.max(o.left,s.left),Math.max(o.bottom,s.bottom)+r),l=e.doc.scrollTop,c=e.doc.scrollLeft;if(null!=a.scrollTop&&(Fn(e,a.scrollTop),Math.abs(e.doc.scrollTop-l)>1&&(i=!0)),null!=a.scrollLeft&&(Wn(e,a.scrollLeft),Math.abs(e.doc.scrollLeft-c)>1&&(i=!0)),!i)return o}}function gr(e,t,n,r,i){var o=mr(e,t,n,r,i);null!=o.scrollTop&&Fn(e,o.scrollTop),null!=o.scrollLeft&&Wn(e,o.scrollLeft)}function mr(e,t,n,r,i){var o=e.display,s=Yt(e.display);0>n&&(n=0);var a=e.curOp&&null!=e.curOp.scrollTop?e.curOp.scrollTop:o.scroller.scrollTop,l=o.scroller.clientHeight-ha,c={},d=e.doc.height+Tt(o),h=s>n,u=i>d-s;if(a>n)c.scrollTop=h?0:n;else if(i>a+l){var f=Math.min(n,(u?d:i)-l);f!=a&&(c.scrollTop=f)}var p=e.curOp&&null!=e.curOp.scrollLeft?e.curOp.scrollLeft:o.scroller.scrollLeft,g=o.scroller.clientWidth-ha;t+=o.gutters.offsetWidth,r+=o.gutters.offsetWidth;var m=o.gutters.offsetWidth,v=m+10>t;return p+m>t||v?(v&&(t=0),c.scrollLeft=Math.max(0,t-10-m)):r>g+p-3&&(c.scrollLeft=r+10-g),c}function vr(e,t,n){(null!=t||null!=n)&&_r(e),null!=t&&(e.curOp.scrollLeft=(null==e.curOp.scrollLeft?e.doc.scrollLeft:e.curOp.scrollLeft)+t),null!=n&&(e.curOp.scrollTop=(null==e.curOp.scrollTop?e.doc.scrollTop:e.curOp.scrollTop)+n)}function yr(e){_r(e);var t=e.getCursor(),n=t,r=t;e.options.lineWrapping||(n=t.ch?vs(t.line,t.ch-1):t,r=vs(t.line,t.ch+1)),e.curOp.scrollToPos={from:n,to:r,margin:e.options.cursorScrollMargin,isCursor:!0}}function _r(e){var t=e.curOp.scrollToPos;if(t){e.curOp.scrollToPos=null;var n=qt(e,t.from),r=qt(e,t.to),i=mr(e,Math.min(n.left,r.left),Math.min(n.top,r.top)-t.margin,Math.max(n.right,r.right),Math.max(n.bottom,r.bottom)+t.margin);e.scrollTo(i.scrollLeft,i.scrollTop)}}function br(e,t,n,r){var i,o=e.doc;null==n&&(n="add"),"smart"==n&&(e.doc.mode.indent?i=kt(e,t):n="prev");var s=e.options.tabSize,a=Ai(o,t),l=ma(a.text,null,s);a.stateAfter&&(a.stateAfter=null);var c,d=a.text.match(/^\s*/)[0];if(r||/\S/.test(a.text)){if("smart"==n&&(c=e.doc.mode.indent(i,a.text.slice(d.length),a.text),c==ua)){if(!r)return;n="prev"}}else c=0,n="not";"prev"==n?c=t>o.first?ma(Ai(o,t-1).text,null,s):0:"add"==n?c=l+e.options.indentUnit:"subtract"==n?c=l-e.options.indentUnit:"number"==typeof n&&(c=l+n),c=Math.max(0,c);var h="",u=0;if(e.options.indentWithTabs)for(var f=Math.floor(c/s);f;--f)u+=s,h+="	";if(c>u&&(h+=ho(c-u)),h!=d)ur(e.doc,h,vs(t,0),vs(t,d.length),"+input");else for(var f=0;f<o.sel.ranges.length;f++){var p=o.sel.ranges[f];if(p.head.line==t&&p.head.ch<d.length){var u=vs(t,d.length);st(o,f,new $(u,u));break}}a.stateAfter=null}function xr(e,t,n,r){var i=t,o=t;return"number"==typeof t?o=Ai(e,Q(e,t)):i=Ii(t),null==i?null:(r(o,i)&&e.cm&&gn(e.cm,i,n),o)}function Cr(e,t){for(var n=e.doc.sel.ranges,r=[],i=0;i<n.length;i++){for(var o=t(n[i]);r.length&&ys(o.from,uo(r).to)<=0;){var s=r.pop();if(ys(s.from,o.from)<0){o.from=s.from;break}}r.push(o)}ln(e,function(){for(var t=r.length-1;t>=0;t--)ur(e.doc,"",r[t].from,r[t].to,"+delete");yr(e)})}function wr(e,t,n,r,i){function o(){var t=a+n;return t<e.first||t>=e.first+e.size?h=!1:(a=t,d=Ai(e,t))}function s(e){var t=(i?Go:Xo)(d,l,n,!0);if(null==t){if(e||!o())return h=!1;l=i?(0>n?Wo:Fo)(d):0>n?d.text.length:0}else l=t;return!0}var a=t.line,l=t.ch,c=n,d=Ai(e,a),h=!0;if("char"==r)s();else if("column"==r)s(!0);else if("word"==r||"group"==r)for(var u=null,f="group"==r,p=e.cm&&e.cm.getHelper(t,"wordChars"),g=!0;!(0>n)||s(!g);g=!1){var m=d.text.charAt(l)||"\n",v=yo(m,p)?"w":f&&"\n"==m?"n":!f||/\s/.test(m)?null:"p";if(!f||g||v||(v="s"),u&&u!=v){0>n&&(n=1,s());break}if(v&&(u=v),n>0&&!s(!g))break}var y=gt(e,vs(a,l),c,!0);return h||(y.hitSide=!0),y}function kr(e,t,n,r){var i,o=e.doc,s=t.left;if("page"==r){var a=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);i=t.top+n*(a-(0>n?1.5:.5)*Yt(e.display))}else"line"==r&&(i=n>0?t.bottom+3:t.top-3);for(;;){var l=Xt(e,s,i);if(!l.outside)break;if(0>n?0>=i:i>=o.height){l.hitSide=!0;break}i+=5*n}return l}function Sr(e,t){var n=e.doc,r=Ai(n,t.line).text,i=t.ch,o=t.ch;if(r){var s=e.getHelper(t,"wordChars");(t.xRel<0||o==r.length)&&i?--i:++o;for(var a=r.charAt(i),l=yo(a,s)?function(e){return yo(e,s)}:/\s/.test(a)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!yo(e)};i>0&&l(r.charAt(i-1));)--i;for(;o<r.length&&l(r.charAt(o));)++o}return new $(vs(t.line,i),vs(t.line,o))}function Tr(t,n,r,i){e.defaults[t]=n,r&&(Es[t]=i?function(e,t,n){n!=Ns&&r(e,t,n)}:r)}function Lr(e){return"string"==typeof e?Ks[e]:e}function jr(e,t,n,r,i){if(r&&r.shared)return Mr(e,t,n,r,i);if(e.cm&&!e.cm.curOp)return cn(e.cm,jr)(e,t,n,r,i);var o=new Gs(e,i),s=ys(t,n);if(r&&mo(r,o,!1),s>0||0==s&&o.clearWhenEmpty!==!1)return o;if(o.replacedWith&&(o.collapsed=!0,o.widgetNode=xo("span",[o.replacedWith],"CodeMirror-widget"),r.handleMouseEvents||(o.widgetNode.ignoreEvents=!0),r.insertLeft&&(o.widgetNode.insertLeft=!0)),o.collapsed){if(Jr(e,t.line,t,n,o)||t.line!=n.line&&Jr(e,n.line,t,n,o))throw new Error("Inserting collapsed marker partially overlapping an existing one");ms=!0}o.addToHistory&&Ki(e,{from:t,to:n,origin:"markText"},e.sel,0/0);var a,l=t.line,c=e.cm;if(e.iter(l,n.line+1,function(e){c&&o.collapsed&&!c.options.lineWrapping&&Qr(e)==c.display.maxLine&&(a=!0),o.collapsed&&l!=t.line&&Ni(e,0),Pr(e,new Nr(o,l==t.line?t.ch:null,l==n.line?n.ch:null)),++l}),o.collapsed&&e.iter(t.line,n.line+1,function(t){ni(e,t)&&Ni(t,0)}),o.clearOnEnter&&aa(o,"beforeCursorEnter",function(){o.clear()}),o.readOnly&&(gs=!0,(e.history.done.length||e.history.undone.length)&&e.clearHistory()),o.collapsed&&(o.id=++Xs,o.atomic=!0),c){if(a&&(c.curOp.updateMaxLine=!0),o.collapsed)pn(c,t.line,n.line+1);else if(o.className||o.title||o.startStyle||o.endStyle)for(var d=t.line;d<=n.line;d++)gn(c,d,"text");o.atomic&&ft(c.doc),no(c,"markerAdded",c,o)}return o}function Mr(e,t,n,r,i){r=mo(r),r.shared=!1;var o=[jr(e,t,n,r,i)],s=o[0],a=r.widgetNode;return ji(e,function(e){a&&(r.widgetNode=a.cloneNode(!0)),o.push(jr(e,Z(e,t),Z(e,n),r,i));for(var l=0;l<e.linked.length;++l)if(e.linked[l].isParent)return;s=uo(o)}),new $s(o,s)}function Ar(e){return e.findMarks(vs(e.first,0),e.clipPos(vs(e.lastLine())),function(e){return e.parent})}function Or(e,t){for(var n=0;n<t.length;n++){var r=t[n],i=r.find(),o=e.clipPos(i.from),s=e.clipPos(i.to);if(ys(o,s)){var a=jr(e,o,s,r.primary,r.primary.type);r.markers.push(a),a.parent=r}}}function Er(e){for(var t=0;t<e.length;t++){var n=e[t],r=[n.primary.doc];ji(n.primary.doc,function(e){r.push(e)});for(var i=0;i<n.markers.length;i++){var o=n.markers[i];-1==fo(r,o.doc)&&(o.parent=null,n.markers.splice(i--,1))}}}function Nr(e,t,n){this.marker=e,this.from=t,this.to=n}function Ir(e,t){if(e)for(var n=0;n<e.length;++n){var r=e[n];if(r.marker==t)return r}}function Hr(e,t){for(var n,r=0;r<e.length;++r)e[r]!=t&&(n||(n=[])).push(e[r]);return n}function Pr(e,t){e.markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t],t.marker.attachLine(e)}function Dr(e,t,n){if(e)for(var r,i=0;i<e.length;++i){var o=e[i],s=o.marker,a=null==o.from||(s.inclusiveLeft?o.from<=t:o.from<t);if(a||o.from==t&&"bookmark"==s.type&&(!n||!o.marker.insertLeft)){var l=null==o.to||(s.inclusiveRight?o.to>=t:o.to>t);(r||(r=[])).push(new Nr(s,o.from,l?null:o.to))}}return r}function Rr(e,t,n){if(e)for(var r,i=0;i<e.length;++i){var o=e[i],s=o.marker,a=null==o.to||(s.inclusiveRight?o.to>=t:o.to>t);if(a||o.from==t&&"bookmark"==s.type&&(!n||o.marker.insertLeft)){var l=null==o.from||(s.inclusiveLeft?o.from<=t:o.from<t);
(r||(r=[])).push(new Nr(s,l?null:o.from-t,null==o.to?null:o.to-t))}}return r}function Br(e,t){var n=tt(e,t.from.line)&&Ai(e,t.from.line).markedSpans,r=tt(e,t.to.line)&&Ai(e,t.to.line).markedSpans;if(!n&&!r)return null;var i=t.from.ch,o=t.to.ch,s=0==ys(t.from,t.to),a=Dr(n,i,s),l=Rr(r,o,s),c=1==t.text.length,d=uo(t.text).length+(c?i:0);if(a)for(var h=0;h<a.length;++h){var u=a[h];if(null==u.to){var f=Ir(l,u.marker);f?c&&(u.to=null==f.to?null:f.to+d):u.to=i}}if(l)for(var h=0;h<l.length;++h){var u=l[h];if(null!=u.to&&(u.to+=d),null==u.from){var f=Ir(a,u.marker);f||(u.from=d,c&&(a||(a=[])).push(u))}else u.from+=d,c&&(a||(a=[])).push(u)}a&&(a=Fr(a)),l&&l!=a&&(l=Fr(l));var p=[a];if(!c){var g,m=t.text.length-2;if(m>0&&a)for(var h=0;h<a.length;++h)null==a[h].to&&(g||(g=[])).push(new Nr(a[h].marker,null,null));for(var h=0;m>h;++h)p.push(g);p.push(l)}return p}function Fr(e){for(var t=0;t<e.length;++t){var n=e[t];null!=n.from&&n.from==n.to&&n.marker.clearWhenEmpty!==!1&&e.splice(t--,1)}return e.length?e:null}function Wr(e,t){var n=Xi(e,t),r=Br(e,t);if(!n)return r;if(!r)return n;for(var i=0;i<n.length;++i){var o=n[i],s=r[i];if(o&&s)e:for(var a=0;a<s.length;++a){for(var l=s[a],c=0;c<o.length;++c)if(o[c].marker==l.marker)continue e;o.push(l)}else s&&(n[i]=s)}return n}function Kr(e,t,n){var r=null;if(e.iter(t.line,n.line+1,function(e){if(e.markedSpans)for(var t=0;t<e.markedSpans.length;++t){var n=e.markedSpans[t].marker;!n.readOnly||r&&-1!=fo(r,n)||(r||(r=[])).push(n)}}),!r)return null;for(var i=[{from:t,to:n}],o=0;o<r.length;++o)for(var s=r[o],a=s.find(0),l=0;l<i.length;++l){var c=i[l];if(!(ys(c.to,a.from)<0||ys(c.from,a.to)>0)){var d=[l,1],h=ys(c.from,a.from),u=ys(c.to,a.to);(0>h||!s.inclusiveLeft&&!h)&&d.push({from:c.from,to:a.from}),(u>0||!s.inclusiveRight&&!u)&&d.push({from:a.to,to:c.to}),i.splice.apply(i,d),l+=d.length-1}}return i}function Ur(e){var t=e.markedSpans;if(t){for(var n=0;n<t.length;++n)t[n].marker.detachLine(e);e.markedSpans=null}}function zr(e,t){if(t){for(var n=0;n<t.length;++n)t[n].marker.attachLine(e);e.markedSpans=t}}function Vr(e){return e.inclusiveLeft?-1:0}function qr(e){return e.inclusiveRight?1:0}function Gr(e,t){var n=e.lines.length-t.lines.length;if(0!=n)return n;var r=e.find(),i=t.find(),o=ys(r.from,i.from)||Vr(e)-Vr(t);if(o)return-o;var s=ys(r.to,i.to)||qr(e)-qr(t);return s?s:t.id-e.id}function Xr(e,t){var n,r=ms&&e.markedSpans;if(r)for(var i,o=0;o<r.length;++o)i=r[o],i.marker.collapsed&&null==(t?i.from:i.to)&&(!n||Gr(n,i.marker)<0)&&(n=i.marker);return n}function $r(e){return Xr(e,!0)}function Yr(e){return Xr(e,!1)}function Jr(e,t,n,r,i){var o=Ai(e,t),s=ms&&o.markedSpans;if(s)for(var a=0;a<s.length;++a){var l=s[a];if(l.marker.collapsed){var c=l.marker.find(0),d=ys(c.from,n)||Vr(l.marker)-Vr(i),h=ys(c.to,r)||qr(l.marker)-qr(i);if(!(d>=0&&0>=h||0>=d&&h>=0)&&(0>=d&&(ys(c.to,n)>0||l.marker.inclusiveRight&&i.inclusiveLeft)||d>=0&&(ys(c.from,r)<0||l.marker.inclusiveLeft&&i.inclusiveRight)))return!0}}}function Qr(e){for(var t;t=$r(e);)e=t.find(-1,!0).line;return e}function Zr(e){for(var t,n;t=Yr(e);)e=t.find(1,!0).line,(n||(n=[])).push(e);return n}function ei(e,t){var n=Ai(e,t),r=Qr(n);return n==r?t:Ii(r)}function ti(e,t){if(t>e.lastLine())return t;var n,r=Ai(e,t);if(!ni(e,r))return t;for(;n=Yr(r);)r=n.find(1,!0).line;return Ii(r)+1}function ni(e,t){var n=ms&&t.markedSpans;if(n)for(var r,i=0;i<n.length;++i)if(r=n[i],r.marker.collapsed){if(null==r.from)return!0;if(!r.marker.widgetNode&&0==r.from&&r.marker.inclusiveLeft&&ri(e,t,r))return!0}}function ri(e,t,n){if(null==n.to){var r=n.marker.find(1,!0);return ri(e,r.line,Ir(r.line.markedSpans,n.marker))}if(n.marker.inclusiveRight&&n.to==t.text.length)return!0;for(var i,o=0;o<t.markedSpans.length;++o)if(i=t.markedSpans[o],i.marker.collapsed&&!i.marker.widgetNode&&i.from==n.to&&(null==i.to||i.to!=n.from)&&(i.marker.inclusiveLeft||n.marker.inclusiveRight)&&ri(e,t,i))return!0}function ii(e,t,n){Pi(t)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&vr(e,null,n)}function oi(e){if(null!=e.height)return e.height;if(!ko(document.body,e.node)){var t="position: relative;";e.coverGutter&&(t+="margin-left: -"+e.cm.getGutterElement().offsetWidth+"px;"),wo(e.cm.display.measure,xo("div",[e.node],null,t))}return e.height=e.node.offsetHeight}function si(e,t,n,r){var i=new Ys(e,n,r);return i.noHScroll&&(e.display.alignWidgets=!0),xr(e.doc,t,"widget",function(t){var n=t.widgets||(t.widgets=[]);if(null==i.insertAt?n.push(i):n.splice(Math.min(n.length-1,Math.max(0,i.insertAt)),0,i),i.line=t,!ni(e.doc,t)){var r=Pi(t)<e.doc.scrollTop;Ni(t,t.height+oi(i)),r&&vr(e,null,i.height),e.curOp.forceUpdate=!0}return!0}),i}function ai(e,t,n,r){e.text=t,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),null!=e.order&&(e.order=null),Ur(e),zr(e,n);var i=r?r(e):1;i!=e.height&&Ni(e,i)}function li(e){e.parent=null,Ur(e)}function ci(e,t){if(e)for(;;){var n=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!n)break;e=e.slice(0,n.index)+e.slice(n.index+n[0].length);var r=n[1]?"bgClass":"textClass";null==t[r]?t[r]=n[2]:new RegExp("(?:^|s)"+n[2]+"(?:$|s)").test(t[r])||(t[r]+=" "+n[2])}return e}function di(t,n){if(t.blankLine)return t.blankLine(n);if(t.innerMode){var r=e.innerMode(t,n);return r.mode.blankLine?r.mode.blankLine(r.state):void 0}}function hi(e,t,n){for(var r=0;10>r;r++){var i=e.token(t,n);if(t.pos>t.start)return i}throw new Error("Mode "+e.name+" failed to advance stream.")}function ui(t,n,r,i,o,s,a){var l=r.flattenSpans;null==l&&(l=t.options.flattenSpans);var c,d=0,h=null,u=new qs(n,t.options.tabSize);for(""==n&&ci(di(r,i),s);!u.eol();){if(u.pos>t.options.maxHighlightLength?(l=!1,a&&gi(t,n,i,u.pos),u.pos=n.length,c=null):c=ci(hi(r,u,i),s),t.options.addModeClass){var f=e.innerMode(r,i).mode.name;f&&(c="m-"+(c?f+" "+c:f))}l&&h==c||(d<u.start&&o(u.start,h),d=u.start,h=c),u.start=u.pos}for(;d<u.pos;){var p=Math.min(u.pos,d+5e4);o(p,h),d=p}}function fi(e,t,n,r){var i=[e.state.modeGen],o={};ui(e,t.text,e.doc.mode,n,function(e,t){i.push(e,t)},o,r);for(var s=0;s<e.state.overlays.length;++s){var a=e.state.overlays[s],l=1,c=0;ui(e,t.text,a.mode,!0,function(e,t){for(var n=l;e>c;){var r=i[l];r>e&&i.splice(l,1,e,i[l+1],r),l+=2,c=Math.min(e,r)}if(t)if(a.opaque)i.splice(n,l-n,e,"cm-overlay "+t),l=n+2;else for(;l>n;n+=2){var o=i[n+1];i[n+1]=(o?o+" ":"")+"cm-overlay "+t}},o)}return{styles:i,classes:o.bgClass||o.textClass?o:null}}function pi(e,t){if(!t.styles||t.styles[0]!=e.state.modeGen){var n=fi(e,t,t.stateAfter=kt(e,Ii(t)));t.styles=n.styles,n.classes?t.styleClasses=n.classes:t.styleClasses&&(t.styleClasses=null)}return t.styles}function gi(e,t,n,r){var i=e.doc.mode,o=new qs(t,e.options.tabSize);for(o.start=o.pos=r||0,""==t&&di(i,n);!o.eol()&&o.pos<=e.options.maxHighlightLength;)hi(i,o,n),o.start=o.pos}function mi(e,t){if(!e||/^\s*$/.test(e))return null;var n=t.addModeClass?Zs:Qs;return n[e]||(n[e]=e.replace(/\S+/g,"cm-$&"))}function vi(e,t){var n=xo("span",null,null,es?"padding-right: .1px":null),r={pre:xo("pre",[n]),content:n,col:0,pos:0,cm:e};t.measure={};for(var i=0;i<=(t.rest?t.rest.length:0);i++){var o,s=i?t.rest[i-1]:t.line;r.pos=0,r.addToken=_i,(Qo||es)&&e.getOption("lineWrapping")&&(r.addToken=bi(r.addToken)),Ho(e.display.measure)&&(o=Di(s))&&(r.addToken=xi(r.addToken,o)),r.map=[],wi(s,r,pi(e,s)),s.styleClasses&&(s.styleClasses.bgClass&&(r.bgClass=Mo(s.styleClasses.bgClass,r.bgClass||"")),s.styleClasses.textClass&&(r.textClass=Mo(s.styleClasses.textClass,r.textClass||""))),0==r.map.length&&r.map.push(0,0,r.content.appendChild(Io(e.display.measure))),0==i?(t.measure.map=r.map,t.measure.cache={}):((t.measure.maps||(t.measure.maps=[])).push(r.map),(t.measure.caches||(t.measure.caches=[])).push({}))}return ca(e,"renderLine",e,t.line,r.pre),r.pre.className&&(r.textClass=Mo(r.pre.className,r.textClass||"")),r}function yi(e){var t=xo("span","•","cm-invalidchar");return t.title="\\u"+e.charCodeAt(0).toString(16),t}function _i(e,t,n,r,i,o){if(t){var s=e.cm.options.specialChars,a=!1;if(s.test(t))for(var l=document.createDocumentFragment(),c=0;;){s.lastIndex=c;var d=s.exec(t),h=d?d.index-c:t.length-c;if(h){var u=document.createTextNode(t.slice(c,c+h));Qo&&9>Zo?l.appendChild(xo("span",[u])):l.appendChild(u),e.map.push(e.pos,e.pos+h,u),e.col+=h,e.pos+=h}if(!d)break;if(c+=h+1,"	"==d[0]){var f=e.cm.options.tabSize,p=f-e.col%f,u=l.appendChild(xo("span",ho(p),"cm-tab"));e.col+=p}else{var u=e.cm.options.specialCharPlaceholder(d[0]);Qo&&9>Zo?l.appendChild(xo("span",[u])):l.appendChild(u),e.col+=1}e.map.push(e.pos,e.pos+1,u),e.pos++}else{e.col+=t.length;var l=document.createTextNode(t);e.map.push(e.pos,e.pos+t.length,l),Qo&&9>Zo&&(a=!0),e.pos+=t.length}if(n||r||i||a){var g=n||"";r&&(g+=r),i&&(g+=i);var m=xo("span",[l],g);return o&&(m.title=o),e.content.appendChild(m)}e.content.appendChild(l)}}function bi(e){function t(e){for(var t=" ",n=0;n<e.length-2;++n)t+=n%2?" ":" ";return t+=" "}return function(n,r,i,o,s,a){e(n,r.replace(/ {3,}/g,t),i,o,s,a)}}function xi(e,t){return function(n,r,i,o,s,a){i=i?i+" cm-force-border":"cm-force-border";for(var l=n.pos,c=l+r.length;;){for(var d=0;d<t.length;d++){var h=t[d];if(h.to>l&&h.from<=l)break}if(h.to>=c)return e(n,r,i,o,s,a);e(n,r.slice(0,h.to-l),i,o,null,a),o=null,r=r.slice(h.to-l),l=h.to}}}function Ci(e,t,n,r){var i=!r&&n.widgetNode;i&&(e.map.push(e.pos,e.pos+t,i),e.content.appendChild(i)),e.pos+=t}function wi(e,t,n){var r=e.markedSpans,i=e.text,o=0;if(r)for(var s,a,l,c,d,h,u=i.length,f=0,p=1,g="",m=0;;){if(m==f){a=l=c=d="",h=null,m=1/0;for(var v=[],y=0;y<r.length;++y){var _=r[y],b=_.marker;_.from<=f&&(null==_.to||_.to>f)?(null!=_.to&&m>_.to&&(m=_.to,l=""),b.className&&(a+=" "+b.className),b.startStyle&&_.from==f&&(c+=" "+b.startStyle),b.endStyle&&_.to==m&&(l+=" "+b.endStyle),b.title&&!d&&(d=b.title),b.collapsed&&(!h||Gr(h.marker,b)<0)&&(h=_)):_.from>f&&m>_.from&&(m=_.from),"bookmark"==b.type&&_.from==f&&b.widgetNode&&v.push(b)}if(h&&(h.from||0)==f&&(Ci(t,(null==h.to?u+1:h.to)-f,h.marker,null==h.from),null==h.to))return;if(!h&&v.length)for(var y=0;y<v.length;++y)Ci(t,0,v[y])}if(f>=u)break;for(var x=Math.min(u,m);;){if(g){var C=f+g.length;if(!h){var w=C>x?g.slice(0,x-f):g;t.addToken(t,w,s?s+a:a,c,f+w.length==m?l:"",d)}if(C>=x){g=g.slice(x-f),f=x;break}f=C,c=""}g=i.slice(o,o=n[p++]),s=mi(n[p++],t.cm.options)}}else for(var p=1;p<n.length;p+=2)t.addToken(t,i.slice(o,o=n[p]),mi(n[p+1],t.cm.options))}function ki(e,t){return 0==t.from.ch&&0==t.to.ch&&""==uo(t.text)&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function Si(e,t,n,r){function i(e){return n?n[e]:null}function o(e,n,i){ai(e,n,i,r),no(e,"change",e,t)}var s=t.from,a=t.to,l=t.text,c=Ai(e,s.line),d=Ai(e,a.line),h=uo(l),u=i(l.length-1),f=a.line-s.line;if(ki(e,t)){for(var p=0,g=[];p<l.length-1;++p)g.push(new Js(l[p],i(p),r));o(d,d.text,u),f&&e.remove(s.line,f),g.length&&e.insert(s.line,g)}else if(c==d)if(1==l.length)o(c,c.text.slice(0,s.ch)+h+c.text.slice(a.ch),u);else{for(var g=[],p=1;p<l.length-1;++p)g.push(new Js(l[p],i(p),r));g.push(new Js(h+c.text.slice(a.ch),u,r)),o(c,c.text.slice(0,s.ch)+l[0],i(0)),e.insert(s.line+1,g)}else if(1==l.length)o(c,c.text.slice(0,s.ch)+l[0]+d.text.slice(a.ch),i(0)),e.remove(s.line+1,f);else{o(c,c.text.slice(0,s.ch)+l[0],i(0)),o(d,h+d.text.slice(a.ch),u);for(var p=1,g=[];p<l.length-1;++p)g.push(new Js(l[p],i(p),r));f>1&&e.remove(s.line+1,f-1),e.insert(s.line+1,g)}no(e,"change",e,t)}function Ti(e){this.lines=e,this.parent=null;for(var t=0,n=0;t<e.length;++t)e[t].parent=this,n+=e[t].height;this.height=n}function Li(e){this.children=e;for(var t=0,n=0,r=0;r<e.length;++r){var i=e[r];t+=i.chunkSize(),n+=i.height,i.parent=this}this.size=t,this.height=n,this.parent=null}function ji(e,t,n){function r(e,i,o){if(e.linked)for(var s=0;s<e.linked.length;++s){var a=e.linked[s];if(a.doc!=i){var l=o&&a.sharedHist;(!n||l)&&(t(a.doc,l),r(a.doc,e,l))}}}r(e,null,!0)}function Mi(e,t){if(t.cm)throw new Error("This document is already in use.");e.doc=t,t.cm=e,s(e),n(e),e.options.lineWrapping||f(e),e.options.mode=t.modeOption,pn(e)}function Ai(e,t){if(t-=e.first,0>t||t>=e.size)throw new Error("There is no line "+(t+e.first)+" in the document.");for(var n=e;!n.lines;)for(var r=0;;++r){var i=n.children[r],o=i.chunkSize();if(o>t){n=i;break}t-=o}return n.lines[t]}function Oi(e,t,n){var r=[],i=t.line;return e.iter(t.line,n.line+1,function(e){var o=e.text;i==n.line&&(o=o.slice(0,n.ch)),i==t.line&&(o=o.slice(t.ch)),r.push(o),++i}),r}function Ei(e,t,n){var r=[];return e.iter(t,n,function(e){r.push(e.text)}),r}function Ni(e,t){var n=t-e.height;if(n)for(var r=e;r;r=r.parent)r.height+=n}function Ii(e){if(null==e.parent)return null;for(var t=e.parent,n=fo(t.lines,e),r=t.parent;r;t=r,r=r.parent)for(var i=0;r.children[i]!=t;++i)n+=r.children[i].chunkSize();return n+t.first}function Hi(e,t){var n=e.first;e:do{for(var r=0;r<e.children.length;++r){var i=e.children[r],o=i.height;if(o>t){e=i;continue e}t-=o,n+=i.chunkSize()}return n}while(!e.lines);for(var r=0;r<e.lines.length;++r){var s=e.lines[r],a=s.height;if(a>t)break;t-=a}return n+r}function Pi(e){e=Qr(e);for(var t=0,n=e.parent,r=0;r<n.lines.length;++r){var i=n.lines[r];if(i==e)break;t+=i.height}for(var o=n.parent;o;n=o,o=n.parent)for(var r=0;r<o.children.length;++r){var s=o.children[r];if(s==n)break;t+=s.height}return t}function Di(e){var t=e.order;return null==t&&(t=e.order=Ia(e.text)),t}function Ri(e){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e||1}function Bi(e,t){var n={from:V(t.from),to:As(t),text:Oi(e,t.from,t.to)};return qi(e,n,t.from.line,t.to.line+1),ji(e,function(e){qi(e,n,t.from.line,t.to.line+1)},!0),n}function Fi(e){for(;e.length;){var t=uo(e);if(!t.ranges)break;e.pop()}}function Wi(e,t){return t?(Fi(e.done),uo(e.done)):e.done.length&&!uo(e.done).ranges?uo(e.done):e.done.length>1&&!e.done[e.done.length-2].ranges?(e.done.pop(),uo(e.done)):void 0}function Ki(e,t,n,r){var i=e.history;i.undone.length=0;var o,s=+new Date;if((i.lastOp==r||i.lastOrigin==t.origin&&t.origin&&("+"==t.origin.charAt(0)&&e.cm&&i.lastModTime>s-e.cm.options.historyEventDelay||"*"==t.origin.charAt(0)))&&(o=Wi(i,i.lastOp==r))){var a=uo(o.changes);0==ys(t.from,t.to)&&0==ys(t.from,a.to)?a.to=As(t):o.changes.push(Bi(e,t))}else{var l=uo(i.done);for(l&&l.ranges||Vi(e.sel,i.done),o={changes:[Bi(e,t)],generation:i.generation},i.done.push(o);i.done.length>i.undoDepth;)i.done.shift(),i.done[0].ranges||i.done.shift()}i.done.push(n),i.generation=++i.maxGeneration,i.lastModTime=i.lastSelTime=s,i.lastOp=r,i.lastOrigin=i.lastSelOrigin=t.origin,a||ca(e,"historyAdded")}function Ui(e,t,n,r){var i=t.charAt(0);return"*"==i||"+"==i&&n.ranges.length==r.ranges.length&&n.somethingSelected()==r.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500)}function zi(e,t,n,r){var i=e.history,o=r&&r.origin;n==i.lastOp||o&&i.lastSelOrigin==o&&(i.lastModTime==i.lastSelTime&&i.lastOrigin==o||Ui(e,o,uo(i.done),t))?i.done[i.done.length-1]=t:Vi(t,i.done),i.lastSelTime=+new Date,i.lastSelOrigin=o,i.lastOp=n,r&&r.clearRedo!==!1&&Fi(i.undone)}function Vi(e,t){var n=uo(t);n&&n.ranges&&n.equals(e)||t.push(e)}function qi(e,t,n,r){var i=t["spans_"+e.id],o=0;e.iter(Math.max(e.first,n),Math.min(e.first+e.size,r),function(n){n.markedSpans&&((i||(i=t["spans_"+e.id]={}))[o]=n.markedSpans),++o})}function Gi(e){if(!e)return null;for(var t,n=0;n<e.length;++n)e[n].marker.explicitlyCleared?t||(t=e.slice(0,n)):t&&t.push(e[n]);return t?t.length?t:null:e}function Xi(e,t){var n=t["spans_"+e.id];if(!n)return null;for(var r=0,i=[];r<t.text.length;++r)i.push(Gi(n[r]));return i}function $i(e,t,n){for(var r=0,i=[];r<e.length;++r){var o=e[r];if(o.ranges)i.push(n?X.prototype.deepCopy.call(o):o);else{var s=o.changes,a=[];i.push({changes:a});for(var l=0;l<s.length;++l){var c,d=s[l];if(a.push({from:d.from,to:d.to,text:d.text}),t)for(var h in d)(c=h.match(/^spans_(\d+)$/))&&fo(t,Number(c[1]))>-1&&(uo(a)[h]=d[h],delete d[h])}}}return i}function Yi(e,t,n,r){n<e.line?e.line+=r:t<e.line&&(e.line=t,e.ch=0)}function Ji(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i],s=!0;if(o.ranges){o.copied||(o=e[i]=o.deepCopy(),o.copied=!0);for(var a=0;a<o.ranges.length;a++)Yi(o.ranges[a].anchor,t,n,r),Yi(o.ranges[a].head,t,n,r)}else{for(var a=0;a<o.changes.length;++a){var l=o.changes[a];if(n<l.from.line)l.from=vs(l.from.line+r,l.from.ch),l.to=vs(l.to.line+r,l.to.ch);else if(t<=l.to.line){s=!1;break}}s||(e.splice(0,i+1),i=0)}}}function Qi(e,t){var n=t.from.line,r=t.to.line,i=t.text.length-(r-n)-1;Ji(e.done,n,r,i),Ji(e.undone,n,r,i)}function Zi(e){return null!=e.defaultPrevented?e.defaultPrevented:0==e.returnValue}function eo(e){return e.target||e.srcElement}function to(e){var t=e.which;return null==t&&(1&e.button?t=1:2&e.button?t=3:4&e.button&&(t=2)),ds&&e.ctrlKey&&1==t&&(t=3),t}function no(e,t){function n(e){return function(){e.apply(null,o)}}var r=e._handlers&&e._handlers[t];if(r){var i,o=Array.prototype.slice.call(arguments,2);ws?i=ws.delayedCallbacks:da?i=da:(i=da=[],setTimeout(ro,0));for(var s=0;s<r.length;++s)i.push(n(r[s]))}}function ro(){var e=da;da=null;for(var t=0;t<e.length;++t)e[t]()}function io(e,t,n){return ca(e,n||t.type,e,t),Zi(t)||t.codemirrorIgnore}function oo(e){var t=e._handlers&&e._handlers.cursorActivity;if(t)for(var n=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]),r=0;r<t.length;++r)-1==fo(n,t[r])&&n.push(t[r])}function so(e,t){var n=e._handlers&&e._handlers[t];return n&&n.length>0}function ao(e){e.prototype.on=function(e,t){aa(this,e,t)},e.prototype.off=function(e,t){la(this,e,t)}}function lo(){this.id=null}function co(e,t,n){for(var r=0,i=0;;){var o=e.indexOf("	",r);-1==o&&(o=e.length);var s=o-r;if(o==e.length||i+s>=t)return r+Math.min(s,t-i);if(i+=o-r,i+=n-i%n,r=o+1,i>=t)return r}}function ho(e){for(;va.length<=e;)va.push(uo(va)+" ");return va[e]}function uo(e){return e[e.length-1]}function fo(e,t){for(var n=0;n<e.length;++n)if(e[n]==t)return n;return-1}function po(e,t){for(var n=[],r=0;r<e.length;r++)n[r]=t(e[r],r);return n}function go(e,t){var n;if(Object.create)n=Object.create(e);else{var r=function(){};r.prototype=e,n=new r}return t&&mo(t,n),n}function mo(e,t,n){t||(t={});for(var r in e)!e.hasOwnProperty(r)||n===!1&&t.hasOwnProperty(r)||(t[r]=e[r]);return t}function vo(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function yo(e,t){return t?t.source.indexOf("\\w")>-1&&xa(e)?!0:t.test(e):xa(e)}function _o(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return!1;return!0}function bo(e){return e.charCodeAt(0)>=768&&Ca.test(e)}function xo(e,t,n,r){var i=document.createElement(e);if(n&&(i.className=n),r&&(i.style.cssText=r),"string"==typeof t)i.appendChild(document.createTextNode(t));else if(t)for(var o=0;o<t.length;++o)i.appendChild(t[o]);return i}function Co(e){for(var t=e.childNodes.length;t>0;--t)e.removeChild(e.firstChild);return e}function wo(e,t){return Co(e).appendChild(t)}function ko(e,t){if(e.contains)return e.contains(t);for(;t=t.parentNode;)if(t==e)return!0}function So(){return document.activeElement}function To(e){return new RegExp("\\b"+e+"\\b\\s*")}function Lo(e,t){var n=To(t);n.test(e.className)&&(e.className=e.className.replace(n,""))}function jo(e,t){To(t).test(e.className)||(e.className+=" "+t)}function Mo(e,t){for(var n=e.split(" "),r=0;r<n.length;r++)n[r]&&!To(n[r]).test(t)&&(t+=" "+n[r]);return t}function Ao(e){if(document.body.getElementsByClassName)for(var t=document.body.getElementsByClassName("CodeMirror"),n=0;n<t.length;n++){var r=t[n].CodeMirror;r&&e(r)}}function Oo(){Ta||(Eo(),Ta=!0)}function Eo(){var e;aa(window,"resize",function(){null==e&&(e=setTimeout(function(){e=null,wa=null,Ao(Mn)},100))}),aa(window,"blur",function(){Ao(Qn)})}function No(e){if(null!=wa)return wa;var t=xo("div",null,null,"width: 50px; height: 50px; overflow-x: scroll");return wo(e,t),t.offsetWidth&&(wa=t.offsetHeight-t.clientHeight),wa||0}function Io(e){if(null==ka){var t=xo("span","​");wo(e,xo("span",[t,document.createTextNode("x")])),0!=e.firstChild.offsetHeight&&(ka=t.offsetWidth<=1&&t.offsetHeight>2&&!(Qo&&8>Zo))}return ka?xo("span","​"):xo("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px")}function Ho(e){if(null!=Sa)return Sa;var t=wo(e,document.createTextNode("AخA")),n=_a(t,0,1).getBoundingClientRect();if(n.left==n.right)return!1;var r=_a(t,1,2).getBoundingClientRect();return Sa=r.right-n.right<3}function Po(e){if(null!=Oa)return Oa;var t=wo(e,xo("span","x")),n=t.getBoundingClientRect(),r=_a(t,0,1).getBoundingClientRect();return Oa=Math.abs(n.left-r.left)>1}function Do(e,t,n,r){if(!e)return r(t,n,"ltr");for(var i=!1,o=0;o<e.length;++o){var s=e[o];(s.from<n&&s.to>t||t==n&&s.to==t)&&(r(Math.max(s.from,t),Math.min(s.to,n),1==s.level?"rtl":"ltr"),i=!0)}i||r(t,n,"ltr")}function Ro(e){return e.level%2?e.to:e.from}function Bo(e){return e.level%2?e.from:e.to}function Fo(e){var t=Di(e);return t?Ro(t[0]):0}function Wo(e){var t=Di(e);return t?Bo(uo(t)):e.text.length}function Ko(e,t){var n=Ai(e.doc,t),r=Qr(n);r!=n&&(t=Ii(r));var i=Di(r),o=i?i[0].level%2?Wo(r):Fo(r):0;return vs(t,o)}function Uo(e,t){for(var n,r=Ai(e.doc,t);n=Yr(r);)r=n.find(1,!0).line,t=null;var i=Di(r),o=i?i[0].level%2?Fo(r):Wo(r):r.text.length;return vs(null==t?Ii(r):t,o)}function zo(e,t,n){var r=e[0].level;return t==r?!0:n==r?!1:n>t}function Vo(e,t){Na=null;for(var n,r=0;r<e.length;++r){var i=e[r];if(i.from<t&&i.to>t)return r;if(i.from==t||i.to==t){if(null!=n)return zo(e,i.level,e[n].level)?(i.from!=i.to&&(Na=n),r):(i.from!=i.to&&(Na=r),n);n=r}}return n}function qo(e,t,n,r){if(!r)return t+n;do t+=n;while(t>0&&bo(e.text.charAt(t)));return t}function Go(e,t,n,r){var i=Di(e);if(!i)return Xo(e,t,n,r);for(var o=Vo(i,t),s=i[o],a=qo(e,t,s.level%2?-n:n,r);;){if(a>s.from&&a<s.to)return a;if(a==s.from||a==s.to)return Vo(i,a)==o?a:(s=i[o+=n],n>0==s.level%2?s.to:s.from);if(s=i[o+=n],!s)return null;a=n>0==s.level%2?qo(e,s.to,-1,r):qo(e,s.from,1,r)}}function Xo(e,t,n,r){var i=t+n;if(r)for(;i>0&&bo(e.text.charAt(i));)i+=n;return 0>i||i>e.text.length?null:i}var $o=/gecko\/\d/i.test(navigator.userAgent),Yo=/MSIE \d/.test(navigator.userAgent),Jo=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Qo=Yo||Jo,Zo=Qo&&(Yo?document.documentMode||6:Jo[1]),es=/WebKit\//.test(navigator.userAgent),ts=es&&/Qt\/\d+\.\d+/.test(navigator.userAgent),ns=/Chrome\//.test(navigator.userAgent),rs=/Opera\//.test(navigator.userAgent),is=/Apple Computer/.test(navigator.vendor),os=/KHTML\//.test(navigator.userAgent),ss=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent),as=/PhantomJS/.test(navigator.userAgent),ls=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),cs=ls||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent),ds=ls||/Mac/.test(navigator.platform),hs=/win/i.test(navigator.platform),us=rs&&navigator.userAgent.match(/Version\/(\d*\.\d*)/);us&&(us=Number(us[1])),us&&us>=15&&(rs=!1,es=!0);var fs=ds&&(ts||rs&&(null==us||12.11>us)),ps=$o||Qo&&Zo>=9,gs=!1,ms=!1,vs=e.Pos=function(e,t){return this instanceof vs?(this.line=e,this.ch=t,void 0):new vs(e,t)},ys=e.cmpPos=function(e,t){return e.line-t.line||e.ch-t.ch};X.prototype={primary:function(){return this.ranges[this.primIndex]},equals:function(e){if(e==this)return!0;if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(var t=0;t<this.ranges.length;t++){var n=this.ranges[t],r=e.ranges[t];if(0!=ys(n.anchor,r.anchor)||0!=ys(n.head,r.head))return!1}return!0},deepCopy:function(){for(var e=[],t=0;t<this.ranges.length;t++)e[t]=new $(V(this.ranges[t].anchor),V(this.ranges[t].head));return new X(e,this.primIndex)},somethingSelected:function(){for(var e=0;e<this.ranges.length;e++)if(!this.ranges[e].empty())return!0;return!1},contains:function(e,t){t||(t=e);for(var n=0;n<this.ranges.length;n++){var r=this.ranges[n];if(ys(t,r.from())>=0&&ys(e,r.to())<=0)return n}return-1}},$.prototype={from:function(){return G(this.anchor,this.head)},to:function(){return q(this.anchor,this.head)},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch}};var _s,bs,xs,Cs={left:0,right:0,top:0,bottom:0},ws=null,ks=0,Ss=0,Ts=0,Ls=null;Qo?Ls=-.53:$o?Ls=15:ns?Ls=-.7:is&&(Ls=-1/3);var js,Ms=null,As=e.changeEnd=function(e){return e.text?vs(e.from.line+e.text.length-1,uo(e.text).length+(1==e.text.length?e.from.ch:0)):e.to};e.prototype={constructor:e,focus:function(){window.focus(),Sn(this),Cn(this)},setOption:function(e,t){var n=this.options,r=n[e];(n[e]!=t||"mode"==e)&&(n[e]=t,Es.hasOwnProperty(e)&&cn(this,Es[e])(this,t,r))},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e,t){this.state.keyMaps[t?"push":"unshift"](e)},removeKeyMap:function(e){for(var t=this.state.keyMaps,n=0;n<t.length;++n)if(t[n]==e||"string"!=typeof t[n]&&t[n].name==e)return t.splice(n,1),!0},addOverlay:dn(function(t,n){var r=t.token?t:e.getMode(this.options,t);if(r.startState)throw new Error("Overlays may not be stateful.");this.state.overlays.push({mode:r,modeSpec:t,opaque:n&&n.opaque}),this.state.modeGen++,pn(this)}),removeOverlay:dn(function(e){for(var t=this.state.overlays,n=0;n<t.length;++n){var r=t[n].modeSpec;if(r==e||"string"==typeof e&&r.name==e)return t.splice(n,1),this.state.modeGen++,pn(this),void 0}}),indentLine:dn(function(e,t,n){"string"!=typeof t&&"number"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract"),tt(this.doc,e)&&br(this,e,t,n)}),indentSelection:dn(function(e){for(var t=this.doc.sel.ranges,n=-1,r=0;r<t.length;r++){var i=t[r];if(i.empty())i.head.line>n&&(br(this,i.head.line,e,!0),n=i.head.line,r==this.doc.sel.primIndex&&yr(this));else{var o=Math.max(n,i.from().line),s=i.to();n=Math.min(this.lastLine(),s.line-(s.ch?0:1))+1;for(var a=o;n>a;++a)br(this,a,e)}}}),getTokenAt:function(e,t){var n=this.doc;e=Z(n,e);for(var r=kt(this,e.line,t),i=this.doc.mode,o=Ai(n,e.line),s=new qs(o.text,this.options.tabSize);s.pos<e.ch&&!s.eol();){s.start=s.pos;var a=hi(i,s,r)}return{start:s.start,end:s.pos,string:s.current(),type:a||null,state:r}},getTokenTypeAt:function(e){e=Z(this.doc,e);var t,n=pi(this,Ai(this.doc,e.line)),r=0,i=(n.length-1)/2,o=e.ch;if(0==o)t=n[2];else for(;;){var s=r+i>>1;if((s?n[2*s-1]:0)>=o)i=s;else{if(!(n[2*s+1]<o)){t=n[2*s+2];break}r=s+1}}var a=t?t.indexOf("cm-overlay "):-1;return 0>a?t:0==a?null:t.slice(0,a-1)},getModeAt:function(t){var n=this.doc.mode;return n.innerMode?e.innerMode(n,this.getTokenAt(t).state).mode:n},getHelper:function(e,t){return this.getHelpers(e,t)[0]},getHelpers:function(e,t){var n=[];if(!Rs.hasOwnProperty(t))return Rs;var r=Rs[t],i=this.getModeAt(e);if("string"==typeof i[t])r[i[t]]&&n.push(r[i[t]]);else if(i[t])for(var o=0;o<i[t].length;o++){var s=r[i[t][o]];s&&n.push(s)}else i.helperType&&r[i.helperType]?n.push(r[i.helperType]):r[i.name]&&n.push(r[i.name]);for(var o=0;o<r._global.length;o++){var a=r._global[o];a.pred(i,this)&&-1==fo(n,a.val)&&n.push(a.val)}return n},getStateAfter:function(e,t){var n=this.doc;return e=Q(n,null==e?n.first+n.size-1:e),kt(this,e+1,t)},cursorCoords:function(e,t){var n,r=this.doc.sel.primary();return n=null==e?r.head:"object"==typeof e?Z(this.doc,e):e?r.from():r.to(),Vt(this,n,t||"page")},charCoords:function(e,t){return zt(this,Z(this.doc,e),t||"page")},coordsChar:function(e,t){return e=Ut(this,e,t||"page"),Xt(this,e.left,e.top)},lineAtHeight:function(e,t){return e=Ut(this,{top:e,left:0},t||"page").top,Hi(this.doc,e+this.display.viewOffset)},heightAtLine:function(e,t){var n=!1,r=this.doc.first+this.doc.size-1;e<this.doc.first?e=this.doc.first:e>r&&(e=r,n=!0);var i=Ai(this.doc,e);return Kt(this,i,{top:0,left:0},t||"page").top+(n?this.doc.height-Pi(i):0)},defaultTextHeight:function(){return Yt(this.display)},defaultCharWidth:function(){return Jt(this.display)},setGutterMarker:dn(function(e,t,n){return xr(this.doc,e,"gutter",function(e){var r=e.gutterMarkers||(e.gutterMarkers={});return r[t]=n,!n&&_o(r)&&(e.gutterMarkers=null),!0})}),clearGutter:dn(function(e){var t=this,n=t.doc,r=n.first;n.iter(function(n){n.gutterMarkers&&n.gutterMarkers[e]&&(n.gutterMarkers[e]=null,gn(t,r,"gutter"),_o(n.gutterMarkers)&&(n.gutterMarkers=null)),++r})}),addLineWidget:dn(function(e,t,n){return si(this,e,t,n)}),removeLineWidget:function(e){e.clear()},lineInfo:function(e){if("number"==typeof e){if(!tt(this.doc,e))return null;var t=e;if(e=Ai(this.doc,e),!e)return null}else{var t=Ii(e);if(null==t)return null}return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(e,t,n,r,i){var o=this.display;e=Vt(this,Z(this.doc,e));var s=e.bottom,a=e.left;if(t.style.position="absolute",o.sizer.appendChild(t),"over"==r)s=e.top;else if("above"==r||"near"==r){var l=Math.max(o.wrapper.clientHeight,this.doc.height),c=Math.max(o.sizer.clientWidth,o.lineSpace.clientWidth);("above"==r||e.bottom+t.offsetHeight>l)&&e.top>t.offsetHeight?s=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=l&&(s=e.bottom),a+t.offsetWidth>c&&(a=c-t.offsetWidth)}t.style.top=s+"px",t.style.left=t.style.right="","right"==i?(a=o.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==i?a=0:"middle"==i&&(a=(o.sizer.clientWidth-t.offsetWidth)/2),t.style.left=a+"px"),n&&gr(this,a,s,a+t.offsetWidth,s+t.offsetHeight)},triggerOnKeyDown:dn(Gn),triggerOnKeyPress:dn(Yn),triggerOnKeyUp:$n,execCommand:function(e){return Ws.hasOwnProperty(e)?Ws[e](this):void 0},findPosH:function(e,t,n,r){var i=1;0>t&&(i=-1,t=-t);for(var o=0,s=Z(this.doc,e);t>o&&(s=wr(this.doc,s,i,n,r),!s.hitSide);++o);return s},moveH:dn(function(e,t){var n=this;n.extendSelectionsBy(function(r){return n.display.shift||n.doc.extend||r.empty()?wr(n.doc,r.head,e,t,n.options.rtlMoveVisually):0>e?r.from():r.to()},ga)}),deleteH:dn(function(e,t){var n=this.doc.sel,r=this.doc;n.somethingSelected()?r.replaceSelection("",null,"+delete"):Cr(this,function(n){var i=wr(r,n.head,e,t,!1);return 0>e?{from:i,to:n.head}:{from:n.head,to:i}})}),findPosV:function(e,t,n,r){var i=1,o=r;0>t&&(i=-1,t=-t);for(var s=0,a=Z(this.doc,e);t>s;++s){var l=Vt(this,a,"div");if(null==o?o=l.left:l.left=o,a=kr(this,l,i,n),a.hitSide)break}return a},moveV:dn(function(e,t){var n=this,r=this.doc,i=[],o=!n.display.shift&&!r.extend&&r.sel.somethingSelected();if(r.extendSelectionsBy(function(s){if(o)return 0>e?s.from():s.to();var a=Vt(n,s.head,"div");null!=s.goalColumn&&(a.left=s.goalColumn),i.push(a.left);var l=kr(n,a,e,t);return"page"==t&&s==r.sel.primary()&&vr(n,null,zt(n,l,"div").top-a.top),l},ga),i.length)for(var s=0;s<r.sel.ranges.length;s++)r.sel.ranges[s].goalColumn=i[s]}),toggleOverwrite:function(e){(null==e||e!=this.state.overwrite)&&((this.state.overwrite=!this.state.overwrite)?jo(this.display.cursorDiv,"CodeMirror-overwrite"):Lo(this.display.cursorDiv,"CodeMirror-overwrite"),ca(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return So()==this.display.input},scrollTo:dn(function(e,t){(null!=e||null!=t)&&_r(this),null!=e&&(this.curOp.scrollLeft=e),null!=t&&(this.curOp.scrollTop=t)}),getScrollInfo:function(){var e=this.display.scroller,t=ha;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-t,width:e.scrollWidth-t,clientHeight:e.clientHeight-t,clientWidth:e.clientWidth-t}},scrollIntoView:dn(function(e,t){if(null==e?(e={from:this.doc.sel.primary().head,to:null},null==t&&(t=this.options.cursorScrollMargin)):"number"==typeof e?e={from:vs(e,0),to:null}:null==e.from&&(e={from:e,to:null}),e.to||(e.to=e.from),e.margin=t||0,null!=e.from.line)_r(this),this.curOp.scrollToPos=e;else{var n=mr(this,Math.min(e.from.left,e.to.left),Math.min(e.from.top,e.to.top)-e.margin,Math.max(e.from.right,e.to.right),Math.max(e.from.bottom,e.to.bottom)+e.margin);this.scrollTo(n.scrollLeft,n.scrollTop)}}),setSize:dn(function(e,t){function n(e){return"number"==typeof e||/^\d+$/.test(String(e))?e+"px":e}var r=this;null!=e&&(r.display.wrapper.style.width=n(e)),null!=t&&(r.display.wrapper.style.height=n(t)),r.options.lineWrapping&&Rt(this);var i=r.display.viewFrom;r.doc.iter(i,r.display.viewTo,function(e){if(e.widgets)for(var t=0;t<e.widgets.length;t++)if(e.widgets[t].noHScroll){gn(r,i,"widget");break}++i}),r.curOp.forceUpdate=!0,ca(r,"refresh",this)}),operation:function(e){return ln(this,e)},refresh:dn(function(){var e=this.display.cachedTextHeight;pn(this),this.curOp.forceUpdate=!0,Bt(this),this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop),h(this),(null==e||Math.abs(e-Yt(this.display))>.5)&&s(this),ca(this,"refresh",this)}),swapDoc:dn(function(e){var t=this.doc;return t.cm=null,Mi(this,e),Bt(this),kn(this),this.scrollTo(e.scrollLeft,e.scrollTop),no(this,"swapDoc",this,t),t}),getInputField:function(){return this.display.input
},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},ao(e);var Os=e.defaults={},Es=e.optionHandlers={},Ns=e.Init={toString:function(){return"CodeMirror.Init"}};Tr("value","",function(e,t){e.setValue(t)},!0),Tr("mode",null,function(e,t){e.doc.modeOption=t,n(e)},!0),Tr("indentUnit",2,n,!0),Tr("indentWithTabs",!1),Tr("smartIndent",!0),Tr("tabSize",4,function(e){r(e),Bt(e),pn(e)},!0),Tr("specialChars",/[\t\u0000-\u0019\u00ad\u200b\u2028\u2029\ufeff]/g,function(e,t){e.options.specialChars=new RegExp(t.source+(t.test("	")?"":"|	"),"g"),e.refresh()},!0),Tr("specialCharPlaceholder",yi,function(e){e.refresh()},!0),Tr("electricChars",!0),Tr("rtlMoveVisually",!hs),Tr("wholeLineUpdateBefore",!0),Tr("theme","default",function(e){l(e),c(e)},!0),Tr("keyMap","default",a),Tr("extraKeys",null),Tr("lineWrapping",!1,i,!0),Tr("gutters",[],function(e){p(e.options),c(e)},!0),Tr("fixedGutter",!0,function(e,t){e.display.gutters.style.left=t?C(e.display)+"px":"0",e.refresh()},!0),Tr("coverGutterNextToScrollbar",!1,v,!0),Tr("lineNumbers",!1,function(e){p(e.options),c(e)},!0),Tr("firstLineNumber",1,c,!0),Tr("lineNumberFormatter",function(e){return e},c,!0),Tr("showCursorWhenSelecting",!1,vt,!0),Tr("resetSelectionOnContextMenu",!0),Tr("readOnly",!1,function(e,t){"nocursor"==t?(Qn(e),e.display.input.blur(),e.display.disabled=!0):(e.display.disabled=!1,t||kn(e))}),Tr("disableInput",!1,function(e,t){t||kn(e)},!0),Tr("dragDrop",!0),Tr("cursorBlinkRate",530),Tr("cursorScrollMargin",0),Tr("cursorHeight",1,vt,!0),Tr("singleCursorHeightPerLine",!0,vt,!0),Tr("workTime",100),Tr("workDelay",100),Tr("flattenSpans",!0,r,!0),Tr("addModeClass",!1,r,!0),Tr("pollInterval",100),Tr("undoDepth",200,function(e,t){e.doc.history.undoDepth=t}),Tr("historyEventDelay",1250),Tr("viewportMargin",10,function(e){e.refresh()},!0),Tr("maxHighlightLength",1e4,r,!0),Tr("moveInputWithCursor",!0,function(e,t){t||(e.display.inputDiv.style.top=e.display.inputDiv.style.left=0)}),Tr("tabindex",null,function(e,t){e.display.input.tabIndex=t||""}),Tr("autofocus",null);var Is=e.modes={},Hs=e.mimeModes={};e.defineMode=function(t,n){if(e.defaults.mode||"null"==t||(e.defaults.mode=t),arguments.length>2){n.dependencies=[];for(var r=2;r<arguments.length;++r)n.dependencies.push(arguments[r])}Is[t]=n},e.defineMIME=function(e,t){Hs[e]=t},e.resolveMode=function(t){if("string"==typeof t&&Hs.hasOwnProperty(t))t=Hs[t];else if(t&&"string"==typeof t.name&&Hs.hasOwnProperty(t.name)){var n=Hs[t.name];"string"==typeof n&&(n={name:n}),t=go(n,t),t.name=n.name}else if("string"==typeof t&&/^[\w\-]+\/[\w\-]+\+xml$/.test(t))return e.resolveMode("application/xml");return"string"==typeof t?{name:t}:t||{name:"null"}},e.getMode=function(t,n){var n=e.resolveMode(n),r=Is[n.name];if(!r)return e.getMode(t,"text/plain");var i=r(t,n);if(Ps.hasOwnProperty(n.name)){var o=Ps[n.name];for(var s in o)o.hasOwnProperty(s)&&(i.hasOwnProperty(s)&&(i["_"+s]=i[s]),i[s]=o[s])}if(i.name=n.name,n.helperType&&(i.helperType=n.helperType),n.modeProps)for(var s in n.modeProps)i[s]=n.modeProps[s];return i},e.defineMode("null",function(){return{token:function(e){e.skipToEnd()}}}),e.defineMIME("text/plain","null");var Ps=e.modeExtensions={};e.extendMode=function(e,t){var n=Ps.hasOwnProperty(e)?Ps[e]:Ps[e]={};mo(t,n)},e.defineExtension=function(t,n){e.prototype[t]=n},e.defineDocExtension=function(e,t){ta.prototype[e]=t},e.defineOption=Tr;var Ds=[];e.defineInitHook=function(e){Ds.push(e)};var Rs=e.helpers={};e.registerHelper=function(t,n,r){Rs.hasOwnProperty(t)||(Rs[t]=e[t]={_global:[]}),Rs[t][n]=r},e.registerGlobalHelper=function(t,n,r,i){e.registerHelper(t,n,i),Rs[t]._global.push({pred:r,val:i})};var Bs=e.copyState=function(e,t){if(t===!0)return t;if(e.copyState)return e.copyState(t);var n={};for(var r in t){var i=t[r];i instanceof Array&&(i=i.concat([])),n[r]=i}return n},Fs=e.startState=function(e,t,n){return e.startState?e.startState(t,n):!0};e.innerMode=function(e,t){for(;e.innerMode;){var n=e.innerMode(t);if(!n||n.mode==e)break;t=n.state,e=n.mode}return n||{mode:e,state:t}};var Ws=e.commands={selectAll:function(e){e.setSelection(vs(e.firstLine(),0),vs(e.lastLine()),fa)},singleSelection:function(e){e.setSelection(e.getCursor("anchor"),e.getCursor("head"),fa)},killLine:function(e){Cr(e,function(t){if(t.empty()){var n=Ai(e.doc,t.head.line).text.length;return t.head.ch==n&&t.head.line<e.lastLine()?{from:t.head,to:vs(t.head.line+1,0)}:{from:t.head,to:vs(t.head.line,n)}}return{from:t.from(),to:t.to()}})},deleteLine:function(e){Cr(e,function(t){return{from:vs(t.from().line,0),to:Z(e.doc,vs(t.to().line+1,0))}})},delLineLeft:function(e){Cr(e,function(e){return{from:vs(e.from().line,0),to:e.from()}})},undo:function(e){e.undo()},redo:function(e){e.redo()},undoSelection:function(e){e.undoSelection()},redoSelection:function(e){e.redoSelection()},goDocStart:function(e){e.extendSelection(vs(e.firstLine(),0))},goDocEnd:function(e){e.extendSelection(vs(e.lastLine()))},goLineStart:function(e){e.extendSelectionsBy(function(t){return Ko(e,t.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(e){e.extendSelectionsBy(function(t){var n=Ko(e,t.head.line),r=e.getLineHandle(n.line),i=Di(r);if(!i||0==i[0].level){var o=Math.max(0,r.text.search(/\S/)),s=t.head.line==n.line&&t.head.ch<=o&&t.head.ch;return vs(n.line,s?0:o)}return n},{origin:"+move",bias:1})},goLineEnd:function(e){e.extendSelectionsBy(function(t){return Uo(e,t.head.line)},{origin:"+move",bias:-1})},goLineRight:function(e){e.extendSelectionsBy(function(t){var n=e.charCoords(t.head,"div").top+5;return e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:n},"div")},ga)},goLineLeft:function(e){e.extendSelectionsBy(function(t){var n=e.charCoords(t.head,"div").top+5;return e.coordsChar({left:0,top:n},"div")},ga)},goLineUp:function(e){e.moveV(-1,"line")},goLineDown:function(e){e.moveV(1,"line")},goPageUp:function(e){e.moveV(-1,"page")},goPageDown:function(e){e.moveV(1,"page")},goCharLeft:function(e){e.moveH(-1,"char")},goCharRight:function(e){e.moveH(1,"char")},goColumnLeft:function(e){e.moveH(-1,"column")},goColumnRight:function(e){e.moveH(1,"column")},goWordLeft:function(e){e.moveH(-1,"word")},goGroupRight:function(e){e.moveH(1,"group")},goGroupLeft:function(e){e.moveH(-1,"group")},goWordRight:function(e){e.moveH(1,"word")},delCharBefore:function(e){e.deleteH(-1,"char")},delCharAfter:function(e){e.deleteH(1,"char")},delWordBefore:function(e){e.deleteH(-1,"word")},delWordAfter:function(e){e.deleteH(1,"word")},delGroupBefore:function(e){e.deleteH(-1,"group")},delGroupAfter:function(e){e.deleteH(1,"group")},indentAuto:function(e){e.indentSelection("smart")},indentMore:function(e){e.indentSelection("add")},indentLess:function(e){e.indentSelection("subtract")},insertTab:function(e){e.replaceSelection("	")},insertSoftTab:function(e){for(var t=[],n=e.listSelections(),r=e.options.tabSize,i=0;i<n.length;i++){var o=n[i].from(),s=ma(e.getLine(o.line),o.ch,r);t.push(new Array(r-s%r+1).join(" "))}e.replaceSelections(t)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(e){ln(e,function(){for(var t=e.listSelections(),n=[],r=0;r<t.length;r++){var i=t[r].head,o=Ai(e.doc,i.line).text;if(o)if(i.ch==o.length&&(i=new vs(i.line,i.ch-1)),i.ch>0)i=new vs(i.line,i.ch+1),e.replaceRange(o.charAt(i.ch-1)+o.charAt(i.ch-2),vs(i.line,i.ch-2),i,"+transpose");else if(i.line>e.doc.first){var s=Ai(e.doc,i.line-1).text;s&&e.replaceRange(o.charAt(0)+"\n"+s.charAt(s.length-1),vs(i.line-1,s.length-1),vs(i.line,1),"+transpose")}n.push(new $(i,i))}e.setSelections(n)})},newlineAndIndent:function(e){ln(e,function(){for(var t=e.listSelections().length,n=0;t>n;n++){var r=e.listSelections()[n];e.replaceRange("\n",r.anchor,r.head,"+input"),e.indentLine(r.from().line+1,null,!0),yr(e)}})},toggleOverwrite:function(e){e.toggleOverwrite()}},Ks=e.keyMap={};Ks.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},Ks.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-Up":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Down":"goDocEnd","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},Ks.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineStart","Cmd-Right":"goLineEnd","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delLineLeft","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection",fallthrough:["basic","emacsy"]},Ks.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"},Ks["default"]=ds?Ks.macDefault:Ks.pcDefault;var Us=e.lookupKey=function(e,t,n){function r(t){t=Lr(t);var i=t[e];if(i===!1)return"stop";if(null!=i&&n(i))return!0;if(t.nofallthrough)return"stop";var o=t.fallthrough;if(null==o)return!1;if("[object Array]"!=Object.prototype.toString.call(o))return r(o);for(var s=0;s<o.length;++s){var a=r(o[s]);if(a)return a}return!1}for(var i=0;i<t.length;++i){var o=r(t[i]);if(o)return"stop"!=o}},zs=e.isModifierKey=function(e){var t=Ea[e.keyCode];return"Ctrl"==t||"Alt"==t||"Shift"==t||"Mod"==t},Vs=e.keyName=function(e,t){if(rs&&34==e.keyCode&&e["char"])return!1;var n=Ea[e.keyCode];return null==n||e.altGraphKey?!1:(e.altKey&&(n="Alt-"+n),(fs?e.metaKey:e.ctrlKey)&&(n="Ctrl-"+n),(fs?e.ctrlKey:e.metaKey)&&(n="Cmd-"+n),!t&&e.shiftKey&&(n="Shift-"+n),n)};e.fromTextArea=function(t,n){function r(){t.value=c.getValue()}if(n||(n={}),n.value=t.value,!n.tabindex&&t.tabindex&&(n.tabindex=t.tabindex),!n.placeholder&&t.placeholder&&(n.placeholder=t.placeholder),null==n.autofocus){var i=So();n.autofocus=i==t||null!=t.getAttribute("autofocus")&&i==document.body}if(t.form&&(aa(t.form,"submit",r),!n.leaveSubmitMethodAlone)){var o=t.form,s=o.submit;try{var a=o.submit=function(){r(),o.submit=s,o.submit(),o.submit=a}}catch(l){}}t.style.display="none";var c=e(function(e){t.parentNode.insertBefore(e,t.nextSibling)},n);return c.save=r,c.getTextArea=function(){return t},c.toTextArea=function(){r(),t.parentNode.removeChild(c.getWrapperElement()),t.style.display="",t.form&&(la(t.form,"submit",r),"function"==typeof t.form.submit&&(t.form.submit=s))},c};var qs=e.StringStream=function(e,t){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0};qs.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){return this.pos<this.string.length?this.string.charAt(this.pos++):void 0},eat:function(e){var t=this.string.charAt(this.pos);if("string"==typeof e)var n=t==e;else var n=t&&(e.test?e.test(t):e(t));return n?(++this.pos,t):void 0},eatWhile:function(e){for(var t=this.pos;this.eat(e););return this.pos>t},eatSpace:function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},skipToEnd:function(){this.pos=this.string.length},skipTo:function(e){var t=this.string.indexOf(e,this.pos);return t>-1?(this.pos=t,!0):void 0},backUp:function(e){this.pos-=e},column:function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=ma(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?ma(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return ma(this.string,null,this.tabSize)-(this.lineStart?ma(this.string,this.lineStart,this.tabSize):0)},match:function(e,t,n){if("string"!=typeof e){var r=this.string.slice(this.pos).match(e);return r&&r.index>0?null:(r&&t!==!1&&(this.pos+=r[0].length),r)}var i=function(e){return n?e.toLowerCase():e},o=this.string.substr(this.pos,e.length);return i(o)==i(e)?(t!==!1&&(this.pos+=e.length),!0):void 0},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}}};var Gs=e.TextMarker=function(e,t){this.lines=[],this.type=t,this.doc=e};ao(Gs),Gs.prototype.clear=function(){if(!this.explicitlyCleared){var e=this.doc.cm,t=e&&!e.curOp;if(t&&Qt(e),so(this,"clear")){var n=this.find();n&&no(this,"clear",n.from,n.to)}for(var r=null,i=null,o=0;o<this.lines.length;++o){var s=this.lines[o],a=Ir(s.markedSpans,this);e&&!this.collapsed?gn(e,Ii(s),"text"):e&&(null!=a.to&&(i=Ii(s)),null!=a.from&&(r=Ii(s))),s.markedSpans=Hr(s.markedSpans,a),null==a.from&&this.collapsed&&!ni(this.doc,s)&&e&&Ni(s,Yt(e.display))}if(e&&this.collapsed&&!e.options.lineWrapping)for(var o=0;o<this.lines.length;++o){var l=Qr(this.lines[o]),c=u(l);c>e.display.maxLineLength&&(e.display.maxLine=l,e.display.maxLineLength=c,e.display.maxLineChanged=!0)}null!=r&&e&&this.collapsed&&pn(e,r,i+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e&&ft(e.doc)),e&&no(e,"markerCleared",e,this),t&&en(e),this.parent&&this.parent.clear()}},Gs.prototype.find=function(e,t){null==e&&"bookmark"==this.type&&(e=1);for(var n,r,i=0;i<this.lines.length;++i){var o=this.lines[i],s=Ir(o.markedSpans,this);if(null!=s.from&&(n=vs(t?o:Ii(o),s.from),-1==e))return n;if(null!=s.to&&(r=vs(t?o:Ii(o),s.to),1==e))return r}return n&&{from:n,to:r}},Gs.prototype.changed=function(){var e=this.find(-1,!0),t=this,n=this.doc.cm;e&&n&&ln(n,function(){var r=e.line,i=Ii(e.line),o=Et(n,i);if(o&&(Dt(o),n.curOp.selectionChanged=n.curOp.forceUpdate=!0),n.curOp.updateMaxLine=!0,!ni(t.doc,r)&&null!=t.height){var s=t.height;t.height=null;var a=oi(t)-s;a&&Ni(r,r.height+a)}})},Gs.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;t.maybeHiddenMarkers&&-1!=fo(t.maybeHiddenMarkers,this)||(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},Gs.prototype.detachLine=function(e){if(this.lines.splice(fo(this.lines,e),1),!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(t.maybeHiddenMarkers||(t.maybeHiddenMarkers=[])).push(this)}};var Xs=0,$s=e.SharedTextMarker=function(e,t){this.markers=e,this.primary=t;for(var n=0;n<e.length;++n)e[n].parent=this};ao($s),$s.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();no(this,"clear")}},$s.prototype.find=function(e,t){return this.primary.find(e,t)};var Ys=e.LineWidget=function(e,t,n){if(n)for(var r in n)n.hasOwnProperty(r)&&(this[r]=n[r]);this.cm=e,this.node=t};ao(Ys),Ys.prototype.clear=function(){var e=this.cm,t=this.line.widgets,n=this.line,r=Ii(n);if(null!=r&&t){for(var i=0;i<t.length;++i)t[i]==this&&t.splice(i--,1);t.length||(n.widgets=null);var o=oi(this);ln(e,function(){ii(e,n,-o),gn(e,r,"widget"),Ni(n,Math.max(0,n.height-o))})}},Ys.prototype.changed=function(){var e=this.height,t=this.cm,n=this.line;this.height=null;var r=oi(this)-e;r&&ln(t,function(){t.curOp.forceUpdate=!0,ii(t,n,r),Ni(n,n.height+r)})};var Js=e.Line=function(e,t,n){this.text=e,zr(this,t),this.height=n?n(this):1};ao(Js),Js.prototype.lineNo=function(){return Ii(this)};var Qs={},Zs={};Ti.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var n=e,r=e+t;r>n;++n){var i=this.lines[n];this.height-=i.height,li(i),no(i,"delete")}this.lines.splice(e,t)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,t,n){this.height+=n,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var r=0;r<t.length;++r)t[r].parent=this},iterN:function(e,t,n){for(var r=e+t;r>e;++e)if(n(this.lines[e]))return!0}},Li.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){this.size-=t;for(var n=0;n<this.children.length;++n){var r=this.children[n],i=r.chunkSize();if(i>e){var o=Math.min(t,i-e),s=r.height;if(r.removeInner(e,o),this.height-=s-r.height,i==o&&(this.children.splice(n--,1),r.parent=null),0==(t-=o))break;e=0}else e-=i}if(this.size-t<25&&(this.children.length>1||!(this.children[0]instanceof Ti))){var a=[];this.collapse(a),this.children=[new Ti(a)],this.children[0].parent=this}},collapse:function(e){for(var t=0;t<this.children.length;++t)this.children[t].collapse(e)},insertInner:function(e,t,n){this.size+=t.length,this.height+=n;for(var r=0;r<this.children.length;++r){var i=this.children[r],o=i.chunkSize();if(o>=e){if(i.insertInner(e,t,n),i.lines&&i.lines.length>50){for(;i.lines.length>50;){var s=i.lines.splice(i.lines.length-25,25),a=new Ti(s);i.height-=a.height,this.children.splice(r+1,0,a),a.parent=this}this.maybeSpill()}break}e-=o}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var t=e.children.splice(e.children.length-5,5),n=new Li(t);if(e.parent){e.size-=n.size,e.height-=n.height;var r=fo(e.parent.children,e);e.parent.children.splice(r+1,0,n)}else{var i=new Li(e.children);i.parent=e,e.children=[i,n],e=i}n.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()}},iterN:function(e,t,n){for(var r=0;r<this.children.length;++r){var i=this.children[r],o=i.chunkSize();if(o>e){var s=Math.min(t,o-e);if(i.iterN(e,s,n))return!0;if(0==(t-=s))break;e=0}else e-=o}}};var ea=0,ta=e.Doc=function(e,t,n){if(!(this instanceof ta))return new ta(e,t,n);null==n&&(n=0),Li.call(this,[new Ti([new Js("",null)])]),this.first=n,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.frontier=n;var r=vs(n,0);this.sel=J(r),this.history=new Ri(null),this.id=++ea,this.modeOption=t,"string"==typeof e&&(e=ja(e)),Si(this,{from:r,to:r,text:e}),dt(this,J(r),fa)};ta.prototype=go(Li.prototype,{constructor:ta,iter:function(e,t,n){n?this.iterN(e-this.first,t-e,n):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var n=0,r=0;r<t.length;++r)n+=t[r].height;this.insertInner(e-this.first,t,n)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=Ei(this,this.first,this.first+this.size);return e===!1?t:t.join(e||"\n")},setValue:hn(function(e){var t=vs(this.first,0),n=this.first+this.size-1;sr(this,{from:t,to:vs(n,Ai(this,n).text.length),text:ja(e),origin:"setValue"},!0),dt(this,J(t))}),replaceRange:function(e,t,n,r){t=Z(this,t),n=n?Z(this,n):t,ur(this,e,t,n,r)},getRange:function(e,t,n){var r=Oi(this,Z(this,e),Z(this,t));return n===!1?r:r.join(n||"\n")},getLine:function(e){var t=this.getLineHandle(e);return t&&t.text},getLineHandle:function(e){return tt(this,e)?Ai(this,e):void 0},getLineNumber:function(e){return Ii(e)},getLineHandleVisualStart:function(e){return"number"==typeof e&&(e=Ai(this,e)),Qr(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return Z(this,e)},getCursor:function(e){var t,n=this.sel.primary();return t=null==e||"head"==e?n.head:"anchor"==e?n.anchor:"end"==e||"to"==e||e===!1?n.to():n.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:hn(function(e,t,n){at(this,Z(this,"number"==typeof e?vs(e,t||0):e),null,n)}),setSelection:hn(function(e,t,n){at(this,Z(this,e),Z(this,t||e),n)}),extendSelection:hn(function(e,t,n){it(this,Z(this,e),t&&Z(this,t),n)}),extendSelections:hn(function(e,t){ot(this,nt(this,e,t))}),extendSelectionsBy:hn(function(e,t){ot(this,po(this.sel.ranges,e),t)}),setSelections:hn(function(e,t,n){if(e.length){for(var r=0,i=[];r<e.length;r++)i[r]=new $(Z(this,e[r].anchor),Z(this,e[r].head));null==t&&(t=Math.min(e.length-1,this.sel.primIndex)),dt(this,Y(i,t),n)}}),addSelection:hn(function(e,t,n){var r=this.sel.ranges.slice(0);r.push(new $(Z(this,e),Z(this,t||e))),dt(this,Y(r,r.length-1),n)}),getSelection:function(e){for(var t,n=this.sel.ranges,r=0;r<n.length;r++){var i=Oi(this,n[r].from(),n[r].to());t=t?t.concat(i):i}return e===!1?t:t.join(e||"\n")},getSelections:function(e){for(var t=[],n=this.sel.ranges,r=0;r<n.length;r++){var i=Oi(this,n[r].from(),n[r].to());e!==!1&&(i=i.join(e||"\n")),t[r]=i}return t},replaceSelection:function(e,t,n){for(var r=[],i=0;i<this.sel.ranges.length;i++)r[i]=e;this.replaceSelections(r,t,n||"+input")},replaceSelections:hn(function(e,t,n){for(var r=[],i=this.sel,o=0;o<i.ranges.length;o++){var s=i.ranges[o];r[o]={from:s.from(),to:s.to(),text:ja(e[o]),origin:n}}for(var a=t&&"end"!=t&&ir(this,r,t),o=r.length-1;o>=0;o--)sr(this,r[o]);a?ct(this,a):this.cm&&yr(this.cm)}),undo:hn(function(){lr(this,"undo")}),redo:hn(function(){lr(this,"redo")}),undoSelection:hn(function(){lr(this,"undo",!0)}),redoSelection:hn(function(){lr(this,"redo",!0)}),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){for(var e=this.history,t=0,n=0,r=0;r<e.done.length;r++)e.done[r].ranges||++t;for(var r=0;r<e.undone.length;r++)e.undone[r].ranges||++n;return{undo:t,redo:n}},clearHistory:function(){this.history=new Ri(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:$i(this.history.done),undone:$i(this.history.undone)}},setHistory:function(e){var t=this.history=new Ri(this.history.maxGeneration);t.done=$i(e.done.slice(0),null,!0),t.undone=$i(e.undone.slice(0),null,!0)},addLineClass:hn(function(e,t,n){return xr(this,e,"class",function(e){var r="text"==t?"textClass":"background"==t?"bgClass":"wrapClass";if(e[r]){if(new RegExp("(?:^|\\s)"+n+"(?:$|\\s)").test(e[r]))return!1;e[r]+=" "+n}else e[r]=n;return!0})}),removeLineClass:hn(function(e,t,n){return xr(this,e,"class",function(e){var r="text"==t?"textClass":"background"==t?"bgClass":"wrapClass",i=e[r];if(!i)return!1;if(null==n)e[r]=null;else{var o=i.match(new RegExp("(?:^|\\s+)"+n+"(?:$|\\s+)"));if(!o)return!1;var s=o.index+o[0].length;e[r]=i.slice(0,o.index)+(o.index&&s!=i.length?" ":"")+i.slice(s)||null}return!0})}),markText:function(e,t,n){return jr(this,Z(this,e),Z(this,t),n,"range")},setBookmark:function(e,t){var n={replacedWith:t&&(null==t.nodeType?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1,shared:t&&t.shared};return e=Z(this,e),jr(this,e,e,n,"bookmark")},findMarksAt:function(e){e=Z(this,e);var t=[],n=Ai(this,e.line).markedSpans;if(n)for(var r=0;r<n.length;++r){var i=n[r];(null==i.from||i.from<=e.ch)&&(null==i.to||i.to>=e.ch)&&t.push(i.marker.parent||i.marker)}return t},findMarks:function(e,t,n){e=Z(this,e),t=Z(this,t);var r=[],i=e.line;return this.iter(e.line,t.line+1,function(o){var s=o.markedSpans;if(s)for(var a=0;a<s.length;a++){var l=s[a];i==e.line&&e.ch>l.to||null==l.from&&i!=e.line||i==t.line&&l.from>t.ch||n&&!n(l.marker)||r.push(l.marker.parent||l.marker)}++i}),r},getAllMarks:function(){var e=[];return this.iter(function(t){var n=t.markedSpans;if(n)for(var r=0;r<n.length;++r)null!=n[r].from&&e.push(n[r].marker)}),e},posFromIndex:function(e){var t,n=this.first;return this.iter(function(r){var i=r.text.length+1;return i>e?(t=e,!0):(e-=i,++n,void 0)}),Z(this,vs(n,t))},indexFromPos:function(e){e=Z(this,e);var t=e.ch;return e.line<this.first||e.ch<0?0:(this.iter(this.first,e.line,function(e){t+=e.text.length+1}),t)},copy:function(e){var t=new ta(Ei(this,this.first,this.first+this.size),this.modeOption,this.first);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel=this.sel,t.extend=!1,e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){e||(e={});var t=this.first,n=this.first+this.size;null!=e.from&&e.from>t&&(t=e.from),null!=e.to&&e.to<n&&(n=e.to);var r=new ta(Ei(this,t,n),e.mode||this.modeOption,t);return e.sharedHist&&(r.history=this.history),(this.linked||(this.linked=[])).push({doc:r,sharedHist:e.sharedHist}),r.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],Or(r,Ar(this)),r},unlinkDoc:function(t){if(t instanceof e&&(t=t.doc),this.linked)for(var n=0;n<this.linked.length;++n){var r=this.linked[n];if(r.doc==t){this.linked.splice(n,1),t.unlinkDoc(this),Er(Ar(this));break}}if(t.history==this.history){var i=[t.id];ji(t,function(e){i.push(e.id)},!0),t.history=new Ri(null),t.history.done=$i(this.history.done,i),t.history.undone=$i(this.history.undone,i)}},iterLinkedDocs:function(e){ji(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm}}),ta.prototype.eachLine=ta.prototype.iter;var na="iter insert remove copy getEditor".split(" ");for(var ra in ta.prototype)ta.prototype.hasOwnProperty(ra)&&fo(na,ra)<0&&(e.prototype[ra]=function(e){return function(){return e.apply(this.doc,arguments)}}(ta.prototype[ra]));ao(ta);var ia=e.e_preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},oa=e.e_stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},sa=e.e_stop=function(e){ia(e),oa(e)},aa=e.on=function(e,t,n){if(e.addEventListener)e.addEventListener(t,n,!1);else if(e.attachEvent)e.attachEvent("on"+t,n);else{var r=e._handlers||(e._handlers={}),i=r[t]||(r[t]=[]);i.push(n)}},la=e.off=function(e,t,n){if(e.removeEventListener)e.removeEventListener(t,n,!1);else if(e.detachEvent)e.detachEvent("on"+t,n);else{var r=e._handlers&&e._handlers[t];if(!r)return;for(var i=0;i<r.length;++i)if(r[i]==n){r.splice(i,1);break}}},ca=e.signal=function(e,t){var n=e._handlers&&e._handlers[t];if(n)for(var r=Array.prototype.slice.call(arguments,2),i=0;i<n.length;++i)n[i].apply(null,r)},da=null,ha=30,ua=e.Pass={toString:function(){return"CodeMirror.Pass"}},fa={scroll:!1},pa={origin:"*mouse"},ga={origin:"+move"};lo.prototype.set=function(e,t){clearTimeout(this.id),this.id=setTimeout(t,e)};var ma=e.countColumn=function(e,t,n,r,i){null==t&&(t=e.search(/[^\s\u00a0]/),-1==t&&(t=e.length));for(var o=r||0,s=i||0;;){var a=e.indexOf("	",o);if(0>a||a>=t)return s+(t-o);s+=a-o,s+=n-s%n,o=a+1}},va=[""],ya=function(e){e.select()};ls?ya=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:Qo&&(ya=function(e){try{e.select()}catch(t){}}),[].indexOf&&(fo=function(e,t){return e.indexOf(t)}),[].map&&(po=function(e,t){return e.map(t)});var _a,ba=/[\u00df\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,xa=e.isWordChar=function(e){return/\w/.test(e)||e>""&&(e.toUpperCase()!=e.toLowerCase()||ba.test(e))},Ca=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;_a=document.createRange?function(e,t,n){var r=document.createRange();return r.setEnd(e,n),r.setStart(e,t),r}:function(e,t,n){var r=document.body.createTextRange();return r.moveToElementText(e.parentNode),r.collapse(!0),r.moveEnd("character",n),r.moveStart("character",t),r},Qo&&11>Zo&&(So=function(){try{return document.activeElement}catch(e){return document.body}});var wa,ka,Sa,Ta=!1,La=function(){if(Qo&&9>Zo)return!1;var e=xo("div");return"draggable"in e||"dragDrop"in e}(),ja=e.splitLines=3!="\n\nb".split(/\n/).length?function(e){for(var t=0,n=[],r=e.length;r>=t;){var i=e.indexOf("\n",t);-1==i&&(i=e.length);var o=e.slice(t,"\r"==e.charAt(i-1)?i-1:i),s=o.indexOf("\r");-1!=s?(n.push(o.slice(0,s)),t+=s+1):(n.push(o),t=i+1)}return n}:function(e){return e.split(/\r\n?|\n/)},Ma=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(t){return!1}}:function(e){try{var t=e.ownerDocument.selection.createRange()}catch(n){}return t&&t.parentElement()==e?0!=t.compareEndPoints("StartToEnd",t):!1},Aa=function(){var e=xo("div");return"oncopy"in e?!0:(e.setAttribute("oncopy","return;"),"function"==typeof e.oncopy)}(),Oa=null,Ea={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",107:"=",109:"-",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};e.keyNames=Ea,function(){for(var e=0;10>e;e++)Ea[e+48]=Ea[e+96]=String(e);for(var e=65;90>=e;e++)Ea[e]=String.fromCharCode(e);for(var e=1;12>=e;e++)Ea[e+111]=Ea[e+63235]="F"+e}();var Na,Ia=function(){function e(e){return 247>=e?n.charAt(e):e>=1424&&1524>=e?"R":e>=1536&&1773>=e?r.charAt(e-1536):e>=1774&&2220>=e?"r":e>=8192&&8203>=e?"w":8204==e?"b":"L"}function t(e,t,n){this.level=e,this.from=t,this.to=n}var n="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",r="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm",i=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,o=/[stwN]/,s=/[LRr]/,a=/[Lb1n]/,l=/[1n]/,c="L";return function(n){if(!i.test(n))return!1;for(var r,d=n.length,h=[],u=0;d>u;++u)h.push(r=e(n.charCodeAt(u)));for(var u=0,f=c;d>u;++u){var r=h[u];"m"==r?h[u]=f:f=r}for(var u=0,p=c;d>u;++u){var r=h[u];"1"==r&&"r"==p?h[u]="n":s.test(r)&&(p=r,"r"==r&&(h[u]="R"))}for(var u=1,f=h[0];d-1>u;++u){var r=h[u];"+"==r&&"1"==f&&"1"==h[u+1]?h[u]="1":","!=r||f!=h[u+1]||"1"!=f&&"n"!=f||(h[u]=f),f=r}for(var u=0;d>u;++u){var r=h[u];if(","==r)h[u]="N";else if("%"==r){for(var g=u+1;d>g&&"%"==h[g];++g);for(var m=u&&"!"==h[u-1]||d>g&&"1"==h[g]?"1":"N",v=u;g>v;++v)h[v]=m;
u=g-1}}for(var u=0,p=c;d>u;++u){var r=h[u];"L"==p&&"1"==r?h[u]="L":s.test(r)&&(p=r)}for(var u=0;d>u;++u)if(o.test(h[u])){for(var g=u+1;d>g&&o.test(h[g]);++g);for(var y="L"==(u?h[u-1]:c),_="L"==(d>g?h[g]:c),m=y||_?"L":"R",v=u;g>v;++v)h[v]=m;u=g-1}for(var b,x=[],u=0;d>u;)if(a.test(h[u])){var C=u;for(++u;d>u&&a.test(h[u]);++u);x.push(new t(0,C,u))}else{var w=u,k=x.length;for(++u;d>u&&"L"!=h[u];++u);for(var v=w;u>v;)if(l.test(h[v])){v>w&&x.splice(k,0,new t(1,w,v));var S=v;for(++v;u>v&&l.test(h[v]);++v);x.splice(k,0,new t(2,S,v)),w=v}else++v;u>w&&x.splice(k,0,new t(1,w,u))}return 1==x[0].level&&(b=n.match(/^\s+/))&&(x[0].from=b[0].length,x.unshift(new t(0,0,b[0].length))),1==uo(x).level&&(b=n.match(/\s+$/))&&(uo(x).to-=b[0].length,x.push(new t(0,d-b[0].length,d))),x[0].level!=uo(x).level&&x.push(new t(x[0].level,d,d)),x}}();return e.version="4.3.1",e}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(e){"object"==typeof exports&&"object"==typeof module?e(require("../lib/codemirror"),require("../addon/search/searchcursor"),require("../addon/dialog/dialog"),require("../addon/edit/matchbrackets.js")):"function"==typeof define&&define.amd?define(["../lib/codemirror","../addon/search/searchcursor","../addon/dialog/dialog","../addon/edit/matchbrackets"],e):e(CodeMirror)}(function(e){"use strict";var t=[{keys:["<Left>"],type:"keyToKey",toKeys:["h"]},{keys:["<Right>"],type:"keyToKey",toKeys:["l"]},{keys:["<Up>"],type:"keyToKey",toKeys:["k"]},{keys:["<Down>"],type:"keyToKey",toKeys:["j"]},{keys:["<Space>"],type:"keyToKey",toKeys:["l"]},{keys:["<BS>"],type:"keyToKey",toKeys:["h"]},{keys:["<C-Space>"],type:"keyToKey",toKeys:["W"]},{keys:["<C-BS>"],type:"keyToKey",toKeys:["B"]},{keys:["<S-Space>"],type:"keyToKey",toKeys:["w"]},{keys:["<S-BS>"],type:"keyToKey",toKeys:["b"]},{keys:["<C-n>"],type:"keyToKey",toKeys:["j"]},{keys:["<C-p>"],type:"keyToKey",toKeys:["k"]},{keys:["<C-[>"],type:"keyToKey",toKeys:["<Esc>"]},{keys:["<C-c>"],type:"keyToKey",toKeys:["<Esc>"]},{keys:["s"],type:"keyToKey",toKeys:["c","l"],context:"normal"},{keys:["s"],type:"keyToKey",toKeys:["x","i"],context:"visual"},{keys:["S"],type:"keyToKey",toKeys:["c","c"],context:"normal"},{keys:["S"],type:"keyToKey",toKeys:["d","c","c"],context:"visual"},{keys:["<Home>"],type:"keyToKey",toKeys:["0"]},{keys:["<End>"],type:"keyToKey",toKeys:["$"]},{keys:["<PageUp>"],type:"keyToKey",toKeys:["<C-b>"]},{keys:["<PageDown>"],type:"keyToKey",toKeys:["<C-f>"]},{keys:["<CR>"],type:"keyToKey",toKeys:["j","^"],context:"normal"},{keys:["H"],type:"motion",motion:"moveToTopLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:["M"],type:"motion",motion:"moveToMiddleLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:["L"],type:"motion",motion:"moveToBottomLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:["h"],type:"motion",motion:"moveByCharacters",motionArgs:{forward:!1}},{keys:["l"],type:"motion",motion:"moveByCharacters",motionArgs:{forward:!0}},{keys:["j"],type:"motion",motion:"moveByLines",motionArgs:{forward:!0,linewise:!0}},{keys:["k"],type:"motion",motion:"moveByLines",motionArgs:{forward:!1,linewise:!0}},{keys:["g","j"],type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!0}},{keys:["g","k"],type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!1}},{keys:["w"],type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1}},{keys:["W"],type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1,bigWord:!0}},{keys:["e"],type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,inclusive:!0}},{keys:["E"],type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:["b"],type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1}},{keys:["B"],type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1,bigWord:!0}},{keys:["g","e"],type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,inclusive:!0}},{keys:["g","E"],type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:["{"],type:"motion",motion:"moveByParagraph",motionArgs:{forward:!1,toJumplist:!0}},{keys:["}"],type:"motion",motion:"moveByParagraph",motionArgs:{forward:!0,toJumplist:!0}},{keys:["<C-f>"],type:"motion",motion:"moveByPage",motionArgs:{forward:!0}},{keys:["<C-b>"],type:"motion",motion:"moveByPage",motionArgs:{forward:!1}},{keys:["<C-d>"],type:"motion",motion:"moveByScroll",motionArgs:{forward:!0,explicitRepeat:!0}},{keys:["<C-u>"],type:"motion",motion:"moveByScroll",motionArgs:{forward:!1,explicitRepeat:!0}},{keys:["g","g"],type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:["G"],type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!0,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:["0"],type:"motion",motion:"moveToStartOfLine"},{keys:["^"],type:"motion",motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:["+"],type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0}},{keys:["-"],type:"motion",motion:"moveByLines",motionArgs:{forward:!1,toFirstChar:!0}},{keys:["_"],type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0,repeatOffset:-1}},{keys:["$"],type:"motion",motion:"moveToEol",motionArgs:{inclusive:!0}},{keys:["%"],type:"motion",motion:"moveToMatchedSymbol",motionArgs:{inclusive:!0,toJumplist:!0}},{keys:["f","character"],type:"motion",motion:"moveToCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:["F","character"],type:"motion",motion:"moveToCharacter",motionArgs:{forward:!1}},{keys:["t","character"],type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:["T","character"],type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!1}},{keys:[";"],type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!0}},{keys:[","],type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!1}},{keys:["'","character"],type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0,linewise:!0}},{keys:["`","character"],type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0}},{keys:["]","`"],type:"motion",motion:"jumpToMark",motionArgs:{forward:!0}},{keys:["[","`"],type:"motion",motion:"jumpToMark",motionArgs:{forward:!1}},{keys:["]","'"],type:"motion",motion:"jumpToMark",motionArgs:{forward:!0,linewise:!0}},{keys:["[","'"],type:"motion",motion:"jumpToMark",motionArgs:{forward:!1,linewise:!0}},{keys:["]","p"],type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0,matchIndent:!0}},{keys:["[","p"],type:"action",action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0,matchIndent:!0}},{keys:["]","character"],type:"motion",motion:"moveToSymbol",motionArgs:{forward:!0,toJumplist:!0}},{keys:["[","character"],type:"motion",motion:"moveToSymbol",motionArgs:{forward:!1,toJumplist:!0}},{keys:["|"],type:"motion",motion:"moveToColumn",motionArgs:{}},{keys:["o"],type:"motion",motion:"moveToOtherHighlightedEnd",motionArgs:{},context:"visual"},{keys:["O"],type:"motion",motion:"moveToOtherHighlightedEnd",motionArgs:{sameLine:!0},context:"visual"},{keys:["d"],type:"operator",operator:"delete"},{keys:["y"],type:"operator",operator:"yank"},{keys:["c"],type:"operator",operator:"change"},{keys:[">"],type:"operator",operator:"indent",operatorArgs:{indentRight:!0}},{keys:["<"],type:"operator",operator:"indent",operatorArgs:{indentRight:!1}},{keys:["g","~"],type:"operator",operator:"swapcase"},{keys:["n"],type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:!0}},{keys:["N"],type:"motion",motion:"findNext",motionArgs:{forward:!1,toJumplist:!0}},{keys:["x"],type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!0},operatorMotionArgs:{visualLine:!1}},{keys:["X"],type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!1},operatorMotionArgs:{visualLine:!0}},{keys:["D"],type:"operatorMotion",operator:"delete",motion:"moveToEol",motionArgs:{inclusive:!0},operatorMotionArgs:{visualLine:!0}},{keys:["Y"],type:"operatorMotion",operator:"yank",motion:"moveToEol",motionArgs:{inclusive:!0},operatorMotionArgs:{visualLine:!0}},{keys:["C"],type:"operatorMotion",operator:"change",motion:"moveToEol",motionArgs:{inclusive:!0},operatorMotionArgs:{visualLine:!0}},{keys:["~"],type:"operatorMotion",operator:"swapcase",operatorArgs:{shouldMoveCursor:!0},motion:"moveByCharacters",motionArgs:{forward:!0}},{keys:["<C-i>"],type:"action",action:"jumpListWalk",actionArgs:{forward:!0}},{keys:["<C-o>"],type:"action",action:"jumpListWalk",actionArgs:{forward:!1}},{keys:["<C-e>"],type:"action",action:"scroll",actionArgs:{forward:!0,linewise:!0}},{keys:["<C-y>"],type:"action",action:"scroll",actionArgs:{forward:!1,linewise:!0}},{keys:["a"],type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"charAfter"}},{keys:["A"],type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"eol"}},{keys:["A"],type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"endOfSelectedArea"},context:"visual"},{keys:["i"],type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"inplace"}},{keys:["I"],type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"firstNonBlank"}},{keys:["o"],type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!0}},{keys:["O"],type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!1}},{keys:["v"],type:"action",action:"toggleVisualMode"},{keys:["V"],type:"action",action:"toggleVisualMode",actionArgs:{linewise:!0}},{keys:["<C-v>"],type:"action",action:"toggleVisualMode",actionArgs:{blockwise:!0}},{keys:["g","v"],type:"action",action:"reselectLastSelection"},{keys:["J"],type:"action",action:"joinLines",isEdit:!0},{keys:["p"],type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0}},{keys:["P"],type:"action",action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0}},{keys:["r","character"],type:"action",action:"replace",isEdit:!0},{keys:["@","character"],type:"action",action:"replayMacro"},{keys:["q","character"],type:"action",action:"enterMacroRecordMode"},{keys:["R"],type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{replace:!0}},{keys:["u"],type:"action",action:"undo"},{keys:["u"],type:"action",action:"changeCase",actionArgs:{toLower:!0},context:"visual",isEdit:!0},{keys:["U"],type:"action",action:"changeCase",actionArgs:{toLower:!1},context:"visual",isEdit:!0},{keys:["<C-r>"],type:"action",action:"redo"},{keys:["m","character"],type:"action",action:"setMark"},{keys:['"',"character"],type:"action",action:"setRegister"},{keys:["z","z"],type:"action",action:"scrollToCursor",actionArgs:{position:"center"}},{keys:["z","."],type:"action",action:"scrollToCursor",actionArgs:{position:"center"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:["z","t"],type:"action",action:"scrollToCursor",actionArgs:{position:"top"}},{keys:["z","<CR>"],type:"action",action:"scrollToCursor",actionArgs:{position:"top"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:["z","-"],type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"}},{keys:["z","b"],type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:["."],type:"action",action:"repeatLastEdit"},{keys:["<C-a>"],type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!0,backtrack:!1}},{keys:["<C-x>"],type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!1,backtrack:!1}},{keys:["a","character"],type:"motion",motion:"textObjectManipulation"},{keys:["i","character"],type:"motion",motion:"textObjectManipulation",motionArgs:{textObjectInner:!0}},{keys:["/"],type:"search",searchArgs:{forward:!0,querySrc:"prompt",toJumplist:!0}},{keys:["?"],type:"search",searchArgs:{forward:!1,querySrc:"prompt",toJumplist:!0}},{keys:["*"],type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",wholeWordOnly:!0,toJumplist:!0}},{keys:["#"],type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",wholeWordOnly:!0,toJumplist:!0}},{keys:["g","*"],type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:["g","#"],type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:[":"],type:"ex"}],n=e.Pos,r=function(){function i(e){var t=e.state.vim;return t.onPasteFn||(t.onPasteFn=function(){t.insertMode||(e.setCursor(T(e.getCursor(),0,1)),tn.enterInsertMode(e,{},t))}),t.onPasteFn}function o(e,t){for(var n=[],r=e;e+t>r;r++)n.push(String.fromCharCode(r));return n}function s(e,t){return t>=e.firstLine()&&t<=e.lastLine()}function a(e){return/^[a-z]$/.test(e)}function l(e){return-1!="()[]{}".indexOf(e)}function c(e){return Dt.test(e)}function d(e){return/^[A-Z]$/.test(e)}function h(e){return/^\s*$/.test(e)}function u(e,t){for(var n=0;n<t.length;n++)if(t[n]==e)return!0;return!1}function f(e,t,n){if(void 0===t)throw Error("defaultValue is required");n||(n="string"),Gt[e]={type:n,defaultValue:t},p(e,t)}function p(e,t){var n=Gt[e];if(!n)throw Error("Unknown option: "+e);if("boolean"==n.type){if(t&&t!==!0)throw Error("Invalid argument: "+e+"="+t);t!==!1&&(t=!0)}n.value="boolean"==n.type?!!t:t}function g(e){var t=Gt[e];if(!t)throw Error("Unknown option: "+e);return t.value}function m(){this.latestRegister=void 0,this.isPlaying=!1,this.isRecording=!1,this.replaySearchQueries=[],this.onRecordingDone=void 0,this.lastInsertModeChanges=$t()}function v(e){return e.state.vim||(e.state.vim={inputState:new _,lastEditInputState:void 0,lastEditActionCommand:void 0,lastHPos:-1,lastHSPos:-1,lastMotion:null,marks:{},fakeCursor:null,insertMode:!1,insertModeRepeat:void 0,visualMode:!1,visualLine:!1,visualBlock:!1,lastSelection:null,lastPastedText:null}),e.state.vim}function y(){Yt={searchQuery:null,searchIsReversed:!1,lastSubstituteReplacePart:void 0,jumpList:Xt(),macroModeState:new m,lastChararacterSearch:{increment:0,forward:!0,selectedCharacter:""},registerController:new C({}),searchHistoryController:new w({}),exCommandHistoryController:new w({})};for(var e in Gt){var t=Gt[e];t.value=t.defaultValue}}function _(){this.prefixRepeat=[],this.motionRepeat=[],this.operator=null,this.operatorArgs=null,this.motion=null,this.motionArgs=null,this.keyBuffer=[],this.registerName=null}function b(t,n){t.state.vim.inputState=new _,e.signal(t,"vim-command-done",n)}function x(e,t){this.clear(),this.keyBuffer=[e||""],this.insertModeChanges=[],this.searchQueries=[],this.linewise=!!t}function C(e){this.registers=e,this.unnamedRegister=e['"']=new x,e["."]=new x,e[":"]=new x,e["/"]=new x}function w(){this.historyBuffer=[],this.iterator,this.initialPrefix=null}function k(e,t,r){var i=Math.min(Math.max(e.firstLine(),t.line),e.lastLine()),o=N(e,i)-1;o=r?o+1:o;var s=Math.min(Math.max(0,t.ch),o);return n(i,s)}function S(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function T(e,t,r){return n(e.line+t,e.ch+r)}function L(e,t){for(var n=0;n<e.length;n++)if(e[n]!=t[n]&&"character"!=t[n])return!1;return!0}function j(e,t,n){return function(){for(var r=0;n>r;r++)t(e)}}function M(e){return n(e.line,e.ch)}function A(e,t){return e.ch==t.ch&&e.line==t.line}function O(e,t){return e.line<t.line?!0:e.line==t.line&&e.ch<t.ch?!0:!1}function E(e,t,n){var r=O(e,t),i=O(t,n);return r&&i}function N(e,t){return e.getLine(t).length}function I(e){return e.split("").reverse().join("")}function H(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function P(e){return e.replace(/([.?*+$\[\]\/\\(){}|\-])/g,"\\$1")}function D(e,t){var n,r,i,o=[],s=e.listSelections(),a=s[0].anchor,l=s[s.length-1].anchor,c=e.getCursor("head"),d=R(s,c),h=R(s,t)<0?!1:!0;t=e.clipPos(t);var u=Math.abs(a.line-t.line)-Math.abs(l.line-t.line);if(u>0?(r=t.line,n=a.line,l.line==t.line&&h&&(n=r)):0>u?(n=t.line,r=l.line,a.line==t.line&&h&&(r=n)):0==d?(n=t.line,r=l.line):(n=a.line,r=t.line),n>r){var f=n;n=r,r=f}for(i=u>0?a:l;r>=n;){var p={line:n,ch:i.ch},g={line:n,ch:t.ch};p.ch<c.ch&&(g.ch==p.ch||p.ch-g.ch==1)?(p.ch++,g.ch--):p.ch>c.ch&&(g.ch==p.ch||p.ch-g.ch==-1)&&(p.ch--,g.ch++);var m={anchor:p,head:g};o.push(m),A(g,t)&&(d=o.indexOf(m)),n++}return t.ch=o[0].head.ch,i.ch=o[0].anchor.ch,e.setSelections(o,d),i}function R(e,t){for(var n=0;n<e.length;n++)if(A(e[n].head,t))return n;return-1}function B(e,t){var n=e.getCursor("anchor"),r=e.getCursor("head"),i=t.lastSelection;if(t.visualMode){if(O(r,n)){var o=n;n=r,r=o}W(e)}else{var s=t.lastSelection.curStartMark.find(),a=t.lastSelection.curEndMark.find(),l=a.line-s.line,c=l?a.ch:a.ch-s.ch;if(r={line:r.line+l,ch:l?r.ch:c+r.ch},i.visualLine)return[{line:n.line,ch:0},{line:r.line,ch:N(e,r.line)}]}return[n,r]}function F(e,t,n,r){n&&r||(n=t.marks["<"].find()||e.getCursor("anchor"),r=t.marks[">"].find()||e.getCursor("head")),t.lastPastedText&&(r=e.posFromIndex(e.indexFromPos(n)+t.lastPastedText.length),t.lastPastedText=null);var i=e.listSelections(),o=R(i,n)>-1;t.lastSelection={curStartMark:e.setBookmark(o?r:n),curEndMark:e.setBookmark(o?n:r),visualMode:t.visualMode,visualLine:t.visualLine,visualBlock:t.visualBlock}}function W(t){t.off("mousedown",W);var n=t.state.vim,r=t.getCursor("anchor"),i=t.getCursor("head");F(t,n),n.visualMode=!1,n.visualLine=!1,n.visualBlock=!1,A(r,i)||t.setCursor(k(t,i)),e.signal(t,"vim-mode-change",{mode:"normal"}),n.fakeCursor&&n.fakeCursor.clear()}function K(e,t,n){var r=e.getRange(t,n);if(/\n\s*$/.test(r)){var i=r.split("\n");i.pop();for(var o,o=i.pop();i.length>0&&o&&h(o);o=i.pop())n.line--,n.ch=0;o?(n.line--,n.ch=N(e,n.line)):n.ch=0}}function U(e,t,n){t.ch=0,n.ch=0,n.line++}function z(e){if(!e)return 0;var t=e.search(/\S/);return-1==t?e.length:t}function V(e,t,r,i,o){var s,a=e.getCursor(),l=e.getLine(a.line),c=a.ch,d=l.substring(c);if(s=o?d.search(/\w/):d.search(/\S/),-1==s)return null;c+=s,d=l.substring(c);var h,u=l.substring(0,c);h=i?/^\S+/:/\w/.test(l.charAt(c))?/^\w+/:/^[^\w\s]+/;var f=h.exec(d),p=c,g=c+f[0].length,m=I(u),v=h.exec(m);if(v&&(p-=v[0].length),t){var y=l.substring(g),_=y.match(/^\s*/)[0].length;if(_>0)g+=_;else{var b=m.length-p,x=m.substring(b),C=x.match(/^\s*/)[0].length;p-=C}}return{start:n(a.line,p),end:n(a.line,g)}}function q(e,t,n){A(t,n)||Yt.jumpList.add(e,t,n)}function G(e,t){Yt.lastChararacterSearch.increment=e,Yt.lastChararacterSearch.forward=t.forward,Yt.lastChararacterSearch.selectedCharacter=t.selectedCharacter}function X(e,t,r,i){var o=M(e.getCursor()),s=r?1:-1,a=r?e.lineCount():-1,l=o.ch,c=o.line,d=e.getLine(c),h={lineText:d,nextCh:d.charAt(l),lastCh:null,index:l,symb:i,reverseSymb:(r?{")":"(","}":"{"}:{"(":")","{":"}"})[i],forward:r,depth:0,curMoveThrough:!1},u=nn[i];if(!u)return o;var f=rn[u].init,p=rn[u].isComplete;for(f&&f(h);c!==a&&t;){if(h.index+=s,h.nextCh=h.lineText.charAt(h.index),!h.nextCh){if(c+=s,h.lineText=e.getLine(c)||"",s>0)h.index=0;else{var g=h.lineText.length;h.index=g>0?g-1:0}h.nextCh=h.lineText.charAt(h.index)}p(h)&&(o.line=c,o.ch=h.index,t--)}return h.nextCh||h.curMoveThrough?n(c,h.index):o}function $(e,t,n,r,i){var o=t.line,a=t.ch,l=e.getLine(o),c=n?1:-1,d=r?Bt:Rt;if(i&&""==l){if(o+=c,l=e.getLine(o),!s(e,o))return null;a=n?0:l.length}for(;;){if(i&&""==l)return{from:0,to:0,line:o};for(var h=c>0?l.length:-1,u=h,f=h;a!=h;){for(var p=!1,g=0;g<d.length&&!p;++g)if(d[g].test(l.charAt(a))){for(u=a;a!=h&&d[g].test(l.charAt(a));)a+=c;if(f=a,p=u!=f,u==t.ch&&o==t.line&&f==u+c)continue;return{from:Math.min(u,f+1),to:Math.max(u,f),line:o}}p||(a+=c)}if(o+=c,!s(e,o))return null;l=e.getLine(o),a=c>0?0:l.length}throw new Error("The impossible happened.")}function Y(e,t,r,i,o){var s=e.getCursor(),a=M(s),l=[];(r&&!i||!r&&i)&&t++;for(var c=!(r&&i),d=0;t>d;d++){var h=$(e,s,r,o,c);if(!h){var u=N(e,e.lastLine());l.push(r?{line:e.lastLine(),from:u,to:u}:{line:0,from:0,to:0});break}l.push(h),s=n(h.line,r?h.to-1:h.from)}var f=l.length!=t,p=l[0],g=l.pop();return r&&!i?(f||p.from==a.ch&&p.line==a.line||(g=l.pop()),n(g.line,g.from)):r&&i?n(g.line,g.to-1):!r&&i?(f||p.to==a.ch&&p.line==a.line||(g=l.pop()),n(g.line,g.to)):n(g.line,g.from)}function J(e,t,r,i){for(var o,s=e.getCursor(),a=s.ch,l=0;t>l;l++){var c=e.getLine(s.line);if(o=et(a,c,i,r,!0),-1==o)return null;a=o}return n(e.getCursor().line,o)}function Q(e,t){var r=e.getCursor().line;return k(e,n(r,t-1))}function Z(e,t,n,r){u(n,Vt)&&(t.marks[n]&&t.marks[n].clear(),t.marks[n]=e.setBookmark(r))}function et(e,t,n,r,i){var o;return r?(o=t.indexOf(n,e+1),-1==o||i||(o-=1)):(o=t.lastIndexOf(n,e-1),-1==o||i||(o+=1)),o}function tt(e,t,r){var i,o,s=e.getCursor(),a={"(":/[()]/,")":/[()]/,"[":/[[\]]/,"]":/[[\]]/,"{":/[{}]/,"}":/[{}]/}[t],l={"(":"(",")":"(","[":"[","]":"[","{":"{","}":"{"}[t],c=e.getLine(s.line).charAt(s.ch),d=c===l?1:0;if(i=e.scanForBracket(n(s.line,s.ch+d),-1,null,{bracketRegex:a}),o=e.scanForBracket(n(s.line,s.ch+d),1,null,{bracketRegex:a}),!i||!o)return{start:s,end:s};if(i=i.pos,o=o.pos,i.line==o.line&&i.ch>o.ch||i.line>o.line){var h=i;i=o,o=h}return r?o.ch+=1:i.ch+=1,{start:i,end:o}}function nt(e,t,r){var i,o,s,a,l=M(e.getCursor()),c=e.getLine(l.line),d=c.split(""),h=d.indexOf(t);if(l.ch<h?l.ch=h:h<l.ch&&d[l.ch]==t&&(o=l.ch,--l.ch),d[l.ch]!=t||o)for(s=l.ch;s>-1&&!i;s--)d[s]==t&&(i=s+1);else i=l.ch+1;if(i&&!o)for(s=i,a=d.length;a>s&&!o;s++)d[s]==t&&(o=s);return i&&o?(r&&(--i,++o),{start:n(l.line,i),end:n(l.line,o)}):{start:l,end:l}}function rt(){}function it(e){var t=e.state.vim;return t.searchState_||(t.searchState_=new rt)}function ot(e,t,n,r,i){e.openDialog?e.openDialog(t,r,{bottom:!0,value:i.value,onKeyDown:i.onKeyDown,onKeyUp:i.onKeyUp}):r(prompt(n,""))}function st(e){var t=at(e)||[];if(!t.length)return[];var n=[];if(0===t[0]){for(var r=0;r<t.length;r++)"number"==typeof t[r]&&n.push(e.substring(t[r]+1,t[r+1]));return n}}function at(e){for(var t=!1,n=[],r=0;r<e.length;r++){var i=e.charAt(r);t||"/"!=i||n.push(r),t=!t&&"\\"==i}return n}function lt(e){for(var t="|(){",n="}",r=!1,i=[],o=-1;o<e.length;o++){var s=e.charAt(o)||"",a=e.charAt(o+1)||"",l=a&&-1!=t.indexOf(a);r?("\\"===s&&l||i.push(s),r=!1):"\\"===s?(r=!0,a&&-1!=n.indexOf(a)&&(l=!0),l&&"\\"!==a||i.push(s)):(i.push(s),l&&"\\"!==a&&i.push("\\"))}return i.join("")}function ct(e){for(var t=!1,n=[],r=-1;r<e.length;r++){var i=e.charAt(r)||"",o=e.charAt(r+1)||"";t?(n.push(i),t=!1):"\\"===i?(t=!0,c(o)||"$"===o?n.push("$"):"/"!==o&&"\\"!==o&&n.push("\\")):("$"===i&&n.push("$"),n.push(i),"/"===o&&n.push("\\"))}return n.join("")}function dt(t){for(var n=new e.StringStream(t),r=[];!n.eol();){for(;n.peek()&&"\\"!=n.peek();)r.push(n.next());n.match("\\/",!0)?r.push("/"):n.match("\\\\",!0)?r.push("\\"):r.push(n.next())}return r.join("")}function ht(e,t,n){var r=Yt.registerController.getRegister("/");if(r.setText(e),e instanceof RegExp)return e;var i,o,s=at(e);if(s.length){i=e.substring(0,s[0]);var a=e.substring(s[0]);o=-1!=a.indexOf("i")}else i=e;if(!i)return null;g("pcre")||(i=lt(i)),n&&(t=/^[^A-Z]*$/.test(i));var l=new RegExp(i,t||o?"i":void 0);return l}function ut(e,t){e.openNotification?e.openNotification('<span style="color: red">'+t+"</span>",{bottom:!0,duration:5e3}):alert(t)}function ft(e,t){var n="";return e&&(n+='<span style="font-family: monospace">'+e+"</span>"),n+='<input type="text"/> <span style="color: #888">',t&&(n+='<span style="color: #888">',n+=t,n+="</span>"),n}function pt(e,t){var n=(t.prefix||"")+" "+(t.desc||""),r=ft(t.prefix,t.desc);ot(e,r,n,t.onClose,t)}function gt(e,t){if(e instanceof RegExp&&t instanceof RegExp){for(var n=["global","multiline","ignoreCase","source"],r=0;r<n.length;r++){var i=n[r];if(e[i]!==t[i])return!1}return!0}return!1}function mt(e,t,n,r){if(t){var i=it(e),o=ht(t,!!n,!!r);if(o)return yt(e,o),gt(o,i.getQuery())?o:(i.setQuery(o),o)}}function vt(e){if("^"==e.source.charAt(0))var t=!0;return{token:function(n){if(t&&!n.sol())return n.skipToEnd(),void 0;var r=n.match(e,!1);if(r)return 0==r[0].length?(n.next(),"searching"):n.sol()||(n.backUp(1),e.exec(n.next()+r[0]))?(n.match(e),"searching"):(n.next(),null);for(;!n.eol()&&(n.next(),!n.match(e,!1)););},query:e}}function yt(e,t){var n=it(e).getOverlay();n&&t==n.query||(n&&e.removeOverlay(n),n=vt(t),e.addOverlay(n),it(e).setOverlay(n))}function _t(e,t,r,i){return void 0===i&&(i=1),e.operation(function(){for(var o=e.getCursor(),s=e.getSearchCursor(r,o),a=0;i>a;a++){var l=s.find(t);if(0==a&&l&&A(s.from(),o)&&(l=s.find(t)),!l&&(s=e.getSearchCursor(r,t?n(e.lastLine()):n(e.firstLine(),0)),!s.find(t)))return}return s.from()})}function bt(e){e.removeOverlay(it(e).getOverlay()),it(e).setOverlay(null)}function xt(e,t,n){return"number"!=typeof e&&(e=e.line),t instanceof Array?u(e,t):n?e>=t&&n>=e:e==t}function Ct(e){var t=e.getScrollInfo(),n=6,r=10,i=e.coordsChar({left:0,top:n+t.top},"local"),o=t.clientHeight-r+t.top,s=e.coordsChar({left:0,top:o},"local");return{top:i.line,bottom:s.line}}function wt(e){for(var t,n,r=[];e&&(n=/<\w+-.+?>|<\w+>|./.exec(e),null!==n);)t=n[0],e=e.substring(n.index+t.length),r.push(t);return r}function kt(t,n,r,i,o,s,a,l,c){function d(){t.operation(function(){for(;!g;)h(),u();f()})}function h(){var e=t.getRange(s.from(),s.to()),n=e.replace(a,l);s.replace(n)}function u(){for(var e;e=s.findNext()&&xt(s.from(),i,o);)if(r||!m||s.from().line!=m.line)return t.scrollIntoView(s.from(),30),t.setSelection(s.from(),s.to()),m=s.from(),g=!1,void 0;g=!0}function f(e){if(e&&e(),t.focus(),m){t.setCursor(m);var n=t.state.vim;n.exMode=!1,n.lastHPos=n.lastHSPos=m.ch}c&&c()}function p(n,r,i){e.e_stop(n);var o=e.keyName(n);switch(o){case"Y":h(),u();break;case"N":u();break;case"A":var s=c;c=void 0,t.operation(d),c=s;break;case"L":h();case"Q":case"Esc":case"Ctrl-C":case"Ctrl-[":f(i)}g&&f(i)}t.state.vim.exMode=!0;var g=!1,m=s.from();return u(),g?(ut(t,"No matches for "+a.source),void 0):n?(pt(t,{prefix:"replace with <strong>"+l+"</strong> (y/n/a/q/l)",onKeyDown:p}),void 0):(d(),c&&c(),void 0)}function St(){function t(e,t){var n=e;d(n)&&"Ctrl"==t&&(n=n.toLowerCase()),t&&(n=t.charAt(0)+"-"+n);var r={Enter:"CR",Backspace:"BS",Delete:"Del"}[n];return n=r?r:n,n=n.length>1?"<"+n+">":n}function n(t){return function(n){e.signal(n,"vim-keypress",t),e.Vim.handleKey(n,t)}}function r(e,r){for(var o=0;o<e.length;o++){var s=e[o];r||1!=s.length||(s="'"+s+"'");var a=t(e[o],r),l=r?r+"-"+s:s;i[l]=n(a)}}var i={nofallthrough:!0,style:"fat-cursor"};return r(Ft),r(Wt),r(Ft,"Ctrl"),r(Ut),r(Ut,"Ctrl"),r(Kt),r(Kt,"Ctrl"),r(zt),r(zt,"Ctrl"),i}function Tt(t){var n=t.state.vim,r=Yt.macroModeState,i=Yt.registerController.getRegister("."),o=r.isPlaying;o||(t.off("change",Ot),e.off(t.getInputField(),"keydown",It)),!o&&n.insertModeRepeat>1&&(Ht(t,n,n.insertModeRepeat-1,!0),n.lastEditInputState.repeatOverride=n.insertModeRepeat),delete n.insertModeRepeat,n.insertMode=!1,t.setCursor(t.getCursor().line,t.getCursor().ch-1),t.setOption("keyMap","vim"),t.setOption("disableInput",!0),t.toggleOverwrite(!1),i.setText(r.lastInsertModeChanges.changes.join("")),e.signal(t,"vim-mode-change",{mode:"normal"}),r.isRecording&&Mt(r)}function Lt(t,n,r,i){var o=Yt.registerController.getRegister(i),s=o.keyBuffer,a=0;r.isPlaying=!0,r.replaySearchQueries=o.searchQueries.slice(0);for(var l=0;l<s.length;l++)for(var c,d,h=s[l];h;)if(c=/<\w+-.+?>|<\w+>|./.exec(h),d=c[0],h=h.substring(c.index+d.length),e.Vim.handleKey(t,d),n.insertMode){var u=o.insertModeChanges[a++].changes;Yt.macroModeState.lastInsertModeChanges.changes=u,Pt(t,u,1),Tt(t)}r.isPlaying=!1}function jt(e,t){if(!e.isPlaying){var n=e.latestRegister,r=Yt.registerController.getRegister(n);r&&r.pushText(t)}}function Mt(e){if(!e.isPlaying){var t=e.latestRegister,n=Yt.registerController.getRegister(t);n&&n.pushInsertModeChanges(e.lastInsertModeChanges)}}function At(e,t){if(!e.isPlaying){var n=e.latestRegister,r=Yt.registerController.getRegister(n);r&&r.pushSearchQuery(t)}}function Ot(e,t){var n=Yt.macroModeState,r=n.lastInsertModeChanges;if(!n.isPlaying)for(;t;){if(r.expectCursorActivityForChange=!0,"+input"==t.origin||"paste"==t.origin||void 0===t.origin){var i=t.text.join("\n");r.changes.push(i)}t=t.next}}function Et(e){var t=e.state.vim;if(t.insertMode){var r=Yt.macroModeState;if(r.isPlaying)return;var i=r.lastInsertModeChanges;i.expectCursorActivityForChange?i.expectCursorActivityForChange=!1:i.changes=[]}else"*mouse"==e.doc.history.lastSelOrigin&&(t.lastHPos=e.doc.getCursor().ch,e.somethingSelected()&&(t.visualMode=!0));if(t.visualMode){var o,s;o=s=e.getCursor("head");var a=e.getCursor("anchor"),l=n(s.line,o.ch+(O(a,s)?-1:1));if(O(l,o)){var c=o;o=l,l=c}t.fakeCursor&&t.fakeCursor.clear(),t.fakeCursor=e.markText(o,l,{className:"cm-animate-fat-cursor"})}}function Nt(e){this.keyName=e}function It(t){function n(){return i.changes.push(new Nt(o)),!0}var r=Yt.macroModeState,i=r.lastInsertModeChanges,o=e.keyName(t);(-1!=o.indexOf("Delete")||-1!=o.indexOf("Backspace"))&&e.lookupKey(o,["vim-insert"],n)}function Ht(e,t,n,r){function i(){a?Qt.processAction(e,t,t.lastEditActionCommand):Qt.evalInput(e,t)}function o(n){if(s.lastInsertModeChanges.changes.length>0){n=t.lastEditActionCommand?n:1;var r=s.lastInsertModeChanges;s.lastInsertModeChanges={},Pt(e,r.changes,n),s.lastInsertModeChanges=r}}var s=Yt.macroModeState;s.isPlaying=!0;var a=!!t.lastEditActionCommand,l=t.inputState;if(t.inputState=t.lastEditInputState,a&&t.lastEditActionCommand.interlaceInsertRepeat)for(var c=0;n>c;c++)i(),o(1);else r||i(),o(n);t.inputState=l,t.insertMode&&!r&&Tt(e),s.isPlaying=!1}function Pt(t,n,r){function i(n){return"string"==typeof n?e.commands[n](t):n(t),!0}for(var o=0;r>o;o++)for(var s=0;s<n.length;s++){var a=n[s];if(a instanceof Nt)e.lookupKey(a.keyName,["vim-insert"],i);else{var l=t.getCursor();t.replaceRange(a,l,l)}}}e.defineOption("vimMode",!1,function(t,n){n?(t.setOption("keyMap","vim"),t.setOption("disableInput",!0),t.setOption("showCursorWhenSelecting",!1),e.signal(t,"vim-mode-change",{mode:"normal"}),t.on("cursorActivity",Et),v(t),e.on(t.getInputField(),"paste",i(t))):t.state.vim&&(t.setOption("keyMap","default"),t.setOption("disableInput",!1),t.off("cursorActivity",Et),e.off(t.getInputField(),"paste",i(t)),t.state.vim=null)});var Dt=/[\d]/,Rt=[/\w/,/[^\w\s]/],Bt=[/\S/],Ft=o(65,26),Wt=o(97,26),Kt=o(48,10),Ut="~`!@#$%^&*()_-+=[{}]\\|/?.,<>:;\"'".split(""),zt=["Left","Right","Up","Down","Space","Backspace","Esc","Home","End","PageUp","PageDown","Enter"],Vt=[].concat(Ft,Wt,Kt,["<",">"]),qt=[].concat(Ft,Wt,Kt,["-",'"',".",":","/"]),Gt={},Xt=function(){function e(e,t,a){function l(t){var i=++r%n,o=s[i];o&&o.clear(),s[i]=e.setBookmark(t)}var c=r%n,d=s[c];if(d){var h=d.find();h&&!A(h,t)&&l(t)}else l(t);l(a),i=r,o=r-n+1,0>o&&(o=0)}function t(e,t){r+=t,r>i?r=i:o>r&&(r=o);var a=s[(n+r)%n];if(a&&!a.find()){var l,c=t>0?1:-1,d=e.getCursor();do if(r+=c,a=s[(n+r)%n],a&&(l=a.find())&&!A(d,l))break;while(i>r&&r>o)}return a}var n=100,r=-1,i=0,o=0,s=new Array(n);return{cachedCursor:void 0,add:e,move:t}},$t=function(e){return e?{changes:e.changes,expectCursorActivityForChange:e.expectCursorActivityForChange}:{changes:[],expectCursorActivityForChange:!1}};m.prototype={exitMacroRecordMode:function(){var e=Yt.macroModeState;e.onRecordingDone(),e.onRecordingDone=void 0,e.isRecording=!1},enterMacroRecordMode:function(e,t){var n=Yt.registerController.getRegister(t);n&&(n.clear(),this.latestRegister=t,this.onRecordingDone=e.openDialog("(recording)["+t+"]",null,{bottom:!0}),this.isRecording=!0)}};var Yt,Jt={buildKeyMap:function(){},getRegisterController:function(){return Yt.registerController},resetVimGlobalState_:y,getVimGlobalState_:function(){return Yt},maybeInitVimState_:v,InsertModeKey:Nt,map:function(e,t,n){ln.map(e,t,n)},setOption:p,getOption:g,defineOption:f,defineEx:function(e,t,n){if(0!==e.indexOf(t))throw new Error('(Vim.defineEx) "'+t+'" is not a prefix of "'+e+'", command not registered');an[e]=n,ln.commandMap_[t]={name:e,shortName:t,type:"api"}},handleKey:function(n,r){var i,o=v(n),s=Yt.macroModeState;if(s.isRecording&&"q"==r)return s.exitMacroRecordMode(),b(n),void 0;if("<Esc>"==r)return b(n),o.visualMode&&W(n),void 0;if(o.visualMode||A(n.getCursor("head"),n.getCursor("anchor"))||(o.visualMode=!0,o.visualLine=!1,e.signal(n,"vim-mode-change",{mode:"visual"}),n.on("mousedown",W)),("0"!=r||"0"==r&&0===o.inputState.getRepeat())&&(i=Qt.matchCommand(r,t,o)),!i)return c(r)&&o.inputState.pushRepeatDigit(r),s.isRecording&&jt(s,r),void 0;if("keyToKey"==i.type)for(var a=0;a<i.toKeys.length;a++)this.handleKey(n,i.toKeys[a]);else s.isRecording&&jt(s,r),Qt.processCommand(n,o,i)},handleEx:function(e,t){ln.processCommand(e,t)}};_.prototype.pushRepeatDigit=function(e){this.operator?this.motionRepeat=this.motionRepeat.concat(e):this.prefixRepeat=this.prefixRepeat.concat(e)},_.prototype.getRepeat=function(){var e=0;return(this.prefixRepeat.length>0||this.motionRepeat.length>0)&&(e=1,this.prefixRepeat.length>0&&(e*=parseInt(this.prefixRepeat.join(""),10)),this.motionRepeat.length>0&&(e*=parseInt(this.motionRepeat.join(""),10))),e},x.prototype={setText:function(e,t){this.keyBuffer=[e||""],this.linewise=!!t},pushText:function(e,t){t&&(this.linewise||this.keyBuffer.push("\n"),this.linewise=!0),this.keyBuffer.push(e)},pushInsertModeChanges:function(e){this.insertModeChanges.push($t(e))},pushSearchQuery:function(e){this.searchQueries.push(e)},clear:function(){this.keyBuffer=[],this.insertModeChanges=[],this.searchQueries=[],this.linewise=!1},toString:function(){return this.keyBuffer.join("")}},C.prototype={pushText:function(e,t,n,r){r&&"\n"==n.charAt(0)&&(n=n.slice(1)+"\n"),r&&"\n"!==n.charAt(n.length-1)&&(n+="\n");var i=this.isValidRegister(e)?this.getRegister(e):null;if(!i){switch(t){case"yank":this.registers["0"]=new x(n,r);break;case"delete":case"change":-1==n.indexOf("\n")?this.registers["-"]=new x(n,r):(this.shiftNumericRegisters_(),this.registers["1"]=new x(n,r))
}return this.unnamedRegister.setText(n,r),void 0}var o=d(e);o?i.pushText(n,r):i.setText(n,r),this.unnamedRegister.setText(i.toString(),r)},getRegister:function(e){return this.isValidRegister(e)?(e=e.toLowerCase(),this.registers[e]||(this.registers[e]=new x),this.registers[e]):this.unnamedRegister},isValidRegister:function(e){return e&&u(e,qt)},shiftNumericRegisters_:function(){for(var e=9;e>=2;e--)this.registers[e]=this.getRegister(""+(e-1))}},w.prototype={nextMatch:function(e,t){var n=this.historyBuffer,r=t?-1:1;null===this.initialPrefix&&(this.initialPrefix=e);for(var i=this.iterator+r;t?i>=0:i<n.length;i+=r)for(var o=n[i],s=0;s<=o.length;s++)if(this.initialPrefix==o.substring(0,s))return this.iterator=i,o;return i>=n.length?(this.iterator=n.length,this.initialPrefix):0>i?e:void 0},pushInput:function(e){var t=this.historyBuffer.indexOf(e);t>-1&&this.historyBuffer.splice(t,1),e.length&&this.historyBuffer.push(e)},reset:function(){this.initialPrefix=null,this.iterator=this.historyBuffer.length}};var Qt={matchCommand:function(e,t,n){function r(t){return s.length<t.keys.length?(o.keyBuffer.push(e),null):("character"==t.keys[s.length-1]&&(o.selectedCharacter=i),o.keyBuffer=[],t)}for(var i,o=n.inputState,s=o.keyBuffer.concat(e),a=[],l=0;l<t.length;l++){var c=t[l];if(L(s,c.keys)){if(o.operator&&"action"==c.type)continue;if("character"==c.keys[s.length-1]&&(i=s[s.length-1],i.length>1))switch(i){case"<CR>":i="\n";break;case"<Space>":i=" ";break;default:continue}a.push(c)}}if(a.length){if(1==a.length)return r(a[0]);for(var d,h=n.visualMode?"visual":"normal",l=0;l<a.length;l++){var u=a[l];if(u.context==h){d=u;break}d||u.context||(d=u)}return r(d)}return o.keyBuffer=[],null},processCommand:function(e,t,n){switch(t.inputState.repeatOverride=n.repeatOverride,n.type){case"motion":this.processMotion(e,t,n);break;case"operator":this.processOperator(e,t,n);break;case"operatorMotion":this.processOperatorMotion(e,t,n);break;case"action":this.processAction(e,t,n);break;case"search":this.processSearch(e,t,n);break;case"ex":case"keyToEx":this.processEx(e,t,n)}},processMotion:function(e,t,n){t.inputState.motion=n.motion,t.inputState.motionArgs=S(n.motionArgs),this.evalInput(e,t)},processOperator:function(e,t,n){var r=t.inputState;if(r.operator){if(r.operator==n.operator)return r.motion="expandToLine",r.motionArgs={linewise:!0},this.evalInput(e,t),void 0;b(e)}r.operator=n.operator,r.operatorArgs=S(n.operatorArgs),t.visualMode&&this.evalInput(e,t)},processOperatorMotion:function(e,t,n){var r=t.visualMode,i=S(n.operatorMotionArgs);i&&r&&i.visualLine&&(t.visualLine=!0),this.processOperator(e,t,n),r||this.processMotion(e,t,n)},processAction:function(e,t,n){var r=t.inputState,i=r.getRepeat(),o=!!i,s=S(n.actionArgs)||{};r.selectedCharacter&&(s.selectedCharacter=r.selectedCharacter),n.operator&&this.processOperator(e,t,n),n.motion&&this.processMotion(e,t,n),(n.motion||n.operator)&&this.evalInput(e,t),s.repeat=i||1,s.repeatIsExplicit=o,s.registerName=r.registerName,b(e),t.lastMotion=null,n.isEdit&&this.recordLastEdit(t,r,n),tn[n.action](e,s,t)},processSearch:function(t,n,r){function i(e,i,o){Yt.searchHistoryController.pushInput(e),Yt.searchHistoryController.reset();try{mt(t,e,i,o)}catch(s){return ut(t,"Invalid regex: "+e),void 0}Qt.processMotion(t,n,{type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:r.searchArgs.toJumplist}})}function o(e){t.scrollTo(u.left,u.top),i(e,!0,!0);var n=Yt.macroModeState;n.isRecording&&At(n,e)}function s(n,r,i){var o,s=e.keyName(n);"Up"==s||"Down"==s?(o="Up"==s?!0:!1,r=Yt.searchHistoryController.nextMatch(r,o)||"",i(r)):"Left"!=s&&"Right"!=s&&"Ctrl"!=s&&"Alt"!=s&&"Shift"!=s&&Yt.searchHistoryController.reset();var a;try{a=mt(t,r,!0,!0)}catch(n){}a?t.scrollIntoView(_t(t,!l,a),30):(bt(t),t.scrollTo(u.left,u.top))}function a(n,r,i){var o=e.keyName(n);("Esc"==o||"Ctrl-C"==o||"Ctrl-["==o)&&(Yt.searchHistoryController.pushInput(r),Yt.searchHistoryController.reset(),mt(t,h),bt(t),t.scrollTo(u.left,u.top),e.e_stop(n),i(),t.focus())}if(t.getSearchCursor){var l=r.searchArgs.forward,c=r.searchArgs.wholeWordOnly;it(t).setReversed(!l);var d=l?"/":"?",h=it(t).getQuery(),u=t.getScrollInfo();switch(r.searchArgs.querySrc){case"prompt":var f=Yt.macroModeState;if(f.isPlaying){var p=f.replaySearchQueries.shift();i(p,!0,!1)}else pt(t,{onClose:o,prefix:d,desc:on,onKeyUp:s,onKeyDown:a});break;case"wordUnderCursor":var g=V(t,!1,!0,!1,!0),m=!0;if(g||(g=V(t,!1,!0,!1,!1),m=!1),!g)return;var p=t.getLine(g.start.line).substring(g.start.ch,g.end.ch);p=m&&c?"\\b"+p+"\\b":P(p),Yt.jumpList.cachedCursor=t.getCursor(),t.setCursor(g.start),i(p,!0,!1)}}},processEx:function(t,n,r){function i(e){Yt.exCommandHistoryController.pushInput(e),Yt.exCommandHistoryController.reset(),ln.processCommand(t,e)}function o(n,r,i){var o,s=e.keyName(n);("Esc"==s||"Ctrl-C"==s||"Ctrl-["==s)&&(Yt.exCommandHistoryController.pushInput(r),Yt.exCommandHistoryController.reset(),e.e_stop(n),i(),t.focus()),"Up"==s||"Down"==s?(o="Up"==s?!0:!1,r=Yt.exCommandHistoryController.nextMatch(r,o)||"",i(r)):"Left"!=s&&"Right"!=s&&"Ctrl"!=s&&"Alt"!=s&&"Shift"!=s&&Yt.exCommandHistoryController.reset()}"keyToEx"==r.type?ln.processCommand(t,r.exArgs.input):n.visualMode?pt(t,{onClose:i,prefix:":",value:"'<,'>",onKeyDown:o}):pt(t,{onClose:i,prefix:":",onKeyDown:o})},evalInput:function(e,t){var r,i,o=t.inputState,s=o.motion,a=o.motionArgs||{},l=o.operator,c=o.operatorArgs||{},d=o.registerName,h=M(e.getCursor("head")),u=M(e.getCursor("anchor")),f=M(h),p=M(f);if(l&&this.recordLastEdit(t,o),i=void 0!==o.repeatOverride?o.repeatOverride:o.getRepeat(),i>0&&a.explicitRepeat?a.repeatIsExplicit=!0:(a.noRepeat||!a.explicitRepeat&&0===i)&&(i=1,a.repeatIsExplicit=!1),o.selectedCharacter&&(a.selectedCharacter=c.selectedCharacter=o.selectedCharacter),a.repeat=i,b(e),s){var g=Zt[s](e,a,t);if(t.lastMotion=Zt[s],!g)return;if(a.toJumplist){var m=Yt.jumpList,v=m.cachedCursor;v?(q(e,v,g),delete m.cachedCursor):q(e,p,g)}if(g instanceof Array?(f=g[0],r=g[1]):r=g,r||(r=n(f.line,f.ch)),t.visualMode){var y=0;if(O(u,h)&&(A(u,r)||O(r,u))?(u.ch+=1,y=-1):O(h,u)&&(A(u,r)||O(u,r))&&(u.ch-=1,y=1),t.visualBlock||g instanceof Array||(r.ch+=y),1/0!=t.lastHPos&&(t.lastHPos=r.ch),h=r,u=g instanceof Array?f:u,t.visualLine)if(O(u,h)){u.ch=0;var _=e.lastLine();h.line>_&&(h.line=_),h.ch=N(e,h.line)}else h.ch=0,u.ch=N(e,u.line);else t.visualBlock&&(u=D(e,h));t.visualBlock||e.setSelection(u,h),Z(e,t,"<",O(u,h)?u:h),Z(e,t,">",O(u,h)?h:u)}else l||(r=k(e,r),e.setCursor(r.line,r.ch))}if(l){var x=!1;if(t.lastMotion=null,c.repeat=i,t.visualMode&&(f=u,r=h,a.inclusive=!0,c.shouldMoveCursor=!1),r&&O(r,f)){var C=f;f=r,r=C,x=!0}else r||(r=M(f));if(a.inclusive&&!t.visualMode&&r.ch++,c.selOffset)r.line=f.line+c.selOffset.line,r.ch=c.selOffset.line?c.selOffset.ch:f.ch+c.selOffset.ch;else if(t.visualMode){var w=n();w.line=r.line-f.line,w.ch=w.line?r.ch:r.ch-f.ch,c.selOffset=w}var S=a.linewise||t.visualMode&&t.visualLine||c.linewise;S?U(e,f,r):a.forward&&K(e,f,r),c.registerName=d,c.linewise=S,t.visualBlock||e.extendSelection(f,r),en[l](e,c,t,f,r,p),t.visualMode&&W(e)}},recordLastEdit:function(e,t,n){var r=Yt.macroModeState;r.isPlaying||(e.lastEditInputState=t,e.lastEditActionCommand=n,r.lastInsertModeChanges.changes=[],r.lastInsertModeChanges.expectCursorActivityForChange=!1)}},Zt={moveToTopLine:function(e,t){var r=Ct(e).top+t.repeat-1;return n(r,z(e.getLine(r)))},moveToMiddleLine:function(e){var t=Ct(e),r=Math.floor(.5*(t.top+t.bottom));return n(r,z(e.getLine(r)))},moveToBottomLine:function(e,t){var r=Ct(e).bottom-t.repeat+1;return n(r,z(e.getLine(r)))},expandToLine:function(e,t){var r=e.getCursor();return n(r.line+t.repeat-1,1/0)},findNext:function(e,t){var n=it(e),r=n.getQuery();if(r){var i=!t.forward;return i=n.isReversed()?!i:i,yt(e,r),_t(e,i,r,t.repeat)}},goToMark:function(e,t,n){var r=n.marks[t.selectedCharacter];if(r){var i=r.find();return t.linewise?{line:i.line,ch:z(e.getLine(i.line))}:i}return null},moveToOtherHighlightedEnd:function(e,t,r){var i=e.listSelections(),o=e.getCursor("head"),s=i[0].anchor,a=A(i[0].head,o)?i.length-1:0;return t.sameLine&&r.visualBlock?(s=n(o.line,i[a].anchor.ch),o=n(i[a].head.line,o.ch)):s=i[a].anchor,e.setCursor(o),[o,s]},jumpToMark:function(e,t,r){for(var i=e.getCursor(),o=0;o<t.repeat;o++){var s=i;for(var l in r.marks)if(a(l)){var c=r.marks[l].find(),d=t.forward?O(c,s):O(s,c);if(!(d||t.linewise&&c.line==s.line)){var h=A(s,i),u=t.forward?E(s,c,i):E(i,c,s);(h||u)&&(i=c)}}}return t.linewise&&(i=n(i.line,z(e.getLine(i.line)))),i},moveByCharacters:function(e,t){var r=e.getCursor(),i=t.repeat,o=t.forward?r.ch+i:r.ch-i;return n(r.line,o)},moveByLines:function(e,t,r){var i=e.getCursor(),o=i.ch;switch(r.lastMotion){case this.moveByLines:case this.moveByDisplayLines:case this.moveByScroll:case this.moveToColumn:case this.moveToEol:o=r.lastHPos;break;default:r.lastHPos=o}var s=t.repeat+(t.repeatOffset||0),a=t.forward?i.line+s:i.line-s,l=e.firstLine(),c=e.lastLine();return l>a&&i.line==l||a>c&&i.line==c?void 0:(t.toFirstChar&&(o=z(e.getLine(a)),r.lastHPos=o),r.lastHSPos=e.charCoords(n(a,o),"div").left,n(a,o))},moveByDisplayLines:function(e,t,r){var i=e.getCursor();switch(r.lastMotion){case this.moveByDisplayLines:case this.moveByScroll:case this.moveByLines:case this.moveToColumn:case this.moveToEol:break;default:r.lastHSPos=e.charCoords(i,"div").left}var o=t.repeat,s=e.findPosV(i,t.forward?o:-o,"line",r.lastHSPos);if(s.hitSide)if(t.forward)var a=e.charCoords(s,"div"),l={top:a.top+8,left:r.lastHSPos},s=e.coordsChar(l,"div");else{var c=e.charCoords(n(e.firstLine(),0),"div");c.left=r.lastHSPos,s=e.coordsChar(c,"div")}return r.lastHPos=s.ch,s},moveByPage:function(e,t){var n=e.getCursor(),r=t.repeat;return e.findPosV(n,t.forward?r:-r,"page")},moveByParagraph:function(e,t){for(var r=e.getCursor().line,i=t.repeat,o=t.forward?1:-1,s=0;i>s&&!(!t.forward&&r===e.firstLine()||t.forward&&r==e.lastLine());s++)for(r+=o;r!==e.firstLine()&&r!=e.lastLine()&&e.getLine(r);)r+=o;return n(r,0)},moveByScroll:function(e,t,n){var r=e.getScrollInfo(),i=null,o=t.repeat;o||(o=r.clientHeight/(2*e.defaultTextHeight()));var s=e.charCoords(e.getCursor(),"local");t.repeat=o;var i=Zt.moveByDisplayLines(e,t,n);if(!i)return null;var a=e.charCoords(i,"local");return e.scrollTo(null,r.top+a.top-s.top),i},moveByWords:function(e,t){return Y(e,t.repeat,!!t.forward,!!t.wordEnd,!!t.bigWord)},moveTillCharacter:function(e,t){var n=t.repeat,r=J(e,n,t.forward,t.selectedCharacter),i=t.forward?-1:1;return G(i,t),r?(r.ch+=i,r):null},moveToCharacter:function(e,t){var n=t.repeat;return G(0,t),J(e,n,t.forward,t.selectedCharacter)||e.getCursor()},moveToSymbol:function(e,t){var n=t.repeat;return X(e,n,t.forward,t.selectedCharacter)||e.getCursor()},moveToColumn:function(e,t,n){var r=t.repeat;return n.lastHPos=r-1,n.lastHSPos=e.charCoords(e.getCursor(),"div").left,Q(e,r)},moveToEol:function(e,t,r){var i=e.getCursor();r.lastHPos=1/0;var o=n(i.line+t.repeat-1,1/0),s=e.clipPos(o);return s.ch--,r.lastHSPos=e.charCoords(s,"div").left,o},moveToFirstNonWhiteSpaceCharacter:function(e){var t=e.getCursor();return n(t.line,z(e.getLine(t.line)))},moveToMatchedSymbol:function(e){var t,r=e.getCursor(),i=r.line,o=r.ch,s=e.getLine(i);do if(t=s.charAt(o++),t&&l(t)){var a=e.getTokenTypeAt(n(i,o));if("string"!==a&&"comment"!==a)break}while(t);if(t){var c=e.findMatchingBracket(n(i,o));return c.to}return r},moveToStartOfLine:function(e){var t=e.getCursor();return n(t.line,0)},moveToLineOrEdgeOfDocument:function(e,t){var r=t.forward?e.lastLine():e.firstLine();return t.repeatIsExplicit&&(r=t.repeat-e.getOption("firstLineNumber")),n(r,z(e.getLine(r)))},textObjectManipulation:function(e,t){var n={"(":")",")":"(","{":"}","}":"{","[":"]","]":"["},r={"'":!0,'"':!0},i=t.selectedCharacter;"b"==i?i="(":"B"==i&&(i="{");var o,s=!t.textObjectInner;if(n[i])o=tt(e,i,s);else if(r[i])o=nt(e,i,s);else if("W"===i)o=V(e,s,!0,!0);else{if("w"!==i)return null;o=V(e,s,!0,!1)}return[o.start,o.end]},repeatLastCharacterSearch:function(e,t){var n=Yt.lastChararacterSearch,r=t.repeat,i=t.forward===n.forward,o=(n.increment?1:0)*(i?-1:1);e.moveH(-o,"char"),t.inclusive=i?!0:!1;var s=J(e,r,i,n.selectedCharacter);return s?(s.ch+=o,s):(e.moveH(o,"char"),e.getCursor())}},en={change:function(e,t,n,r,i){if(Yt.registerController.pushText(t.registerName,"change",e.getRange(r,i),t.linewise),t.linewise){var o=i.line>e.lastLine()?"":"\n";e.replaceRange(o,r,i),e.indentLine(r.line,"smart"),r.ch=null}else{var s=e.getRange(r,i);if(!h(s)){var a=/\s+$/.exec(s);a&&(i=T(i,0,-a[0].length))}e.replaceRange("",r,i)}tn.enterInsertMode(e,{},e.state.vim),e.setCursor(r)},"delete":function(e,t,n,r,i){var o=n.visualMode?n.marks[">"].find():null;if(t.linewise&&i.line>e.lastLine()&&r.line>e.firstLine()&&(r.line--,r.ch=N(e,r.line)),Yt.registerController.pushText(t.registerName,"delete",e.getRange(r,i),t.linewise),n.visualBlock){var s=e.listSelections();r=s[0].anchor;var a=new Array(s.length).join("1").split("1");e.replaceSelections(a)}else e.replaceRange("",r,i);o&&(n.marks[">"]=e.setBookmark(o)),t.linewise?e.setCursor(Zt.moveToFirstNonWhiteSpaceCharacter(e)):e.setCursor(r)},indent:function(e,t,n,r,i){var o=r.line,s=i.line,a=n.visualMode?t.repeat:1;t.linewise&&s--;for(var l=o;s>=l;l++)for(var c=0;a>c;c++)e.indentLine(l,t.indentRight);e.setCursor(r),e.setCursor(Zt.moveToFirstNonWhiteSpaceCharacter(e))},swapcase:function(e,t){for(var n=e.getSelections(),r=e.listSelections(),i=[],o=0;o<n.length;o++){for(var s=n[o],a="",l=0;l<s.length;l++){var c=s.charAt(l);a+=d(c)?c.toLowerCase():c.toUpperCase()}i.push(a)}e.replaceSelections(i);var h=r[0].anchor,u=r[0].head;t.shouldMoveCursor||e.setCursor(O(h,u)?h:u)},yank:function(e,t,n,r,i,o){var s=e.getSelection();Yt.registerController.pushText(t.registerName,"yank",s,t.linewise),e.setCursor(o)}},tn={jumpListWalk:function(e,t,n){if(!n.visualMode){var r=t.repeat,i=t.forward,o=Yt.jumpList,s=o.move(e,i?r:-r),a=s?s.find():void 0;a=a?a:e.getCursor(),e.setCursor(a)}},scroll:function(e,t,n){if(!n.visualMode){var r=t.repeat||1,i=e.defaultTextHeight(),o=e.getScrollInfo().top,s=i*r,a=t.forward?o+s:o-s,l=M(e.getCursor()),c=e.charCoords(l,"local");if(t.forward)a>c.top?(l.line+=(a-c.top)/i,l.line=Math.ceil(l.line),e.setCursor(l),c=e.charCoords(l,"local"),e.scrollTo(null,c.top)):e.scrollTo(null,a);else{var d=a+e.getScrollInfo().clientHeight;d<c.bottom?(l.line-=(c.bottom-d)/i,l.line=Math.floor(l.line),e.setCursor(l),c=e.charCoords(l,"local"),e.scrollTo(null,c.bottom-e.getScrollInfo().clientHeight)):e.scrollTo(null,a)}}},scrollToCursor:function(e,t){var r=e.getCursor().line,i=e.charCoords(n(r,0),"local"),o=e.getScrollInfo().clientHeight,s=i.top,a=i.bottom-s;switch(t.position){case"center":s=s-o/2+a;break;case"bottom":s=s-o+1.4*a;break;case"top":s+=.4*a}e.scrollTo(null,s)},replayMacro:function(e,t,n){var r=t.selectedCharacter,i=t.repeat,o=Yt.macroModeState;for("@"==r&&(r=o.latestRegister);i--;)Lt(e,n,o,r)},enterMacroRecordMode:function(e,t){var n=Yt.macroModeState,r=t.selectedCharacter;n.enterMacroRecordMode(e,r)},enterInsertMode:function(t,r,i){if(!t.getOption("readOnly")){i.insertMode=!0,i.insertModeRepeat=r&&r.repeat||1;var o=r?r.insertAt:null;if("eol"==o){var s=t.getCursor();s=n(s.line,N(t,s.line)),t.setCursor(s)}else if("charAfter"==o)t.setCursor(T(t.getCursor(),0,1));else if("firstNonBlank"==o)t.setCursor(Zt.moveToFirstNonWhiteSpaceCharacter(t));else if("endOfSelectedArea"==o){var a=t.getCursor("head"),l=t.getCursor("anchor");a.line<l.line&&(a=n(l.line,0)),t.setCursor(a),W(t)}t.setOption("keyMap","vim-insert"),t.setOption("disableInput",!1),r&&r.replace?(t.toggleOverwrite(!0),t.setOption("keyMap","vim-replace"),e.signal(t,"vim-mode-change",{mode:"replace"})):(t.setOption("keyMap","vim-insert"),e.signal(t,"vim-mode-change",{mode:"insert"})),Yt.macroModeState.isPlaying||(t.on("change",Ot),e.on(t.getInputField(),"keydown",It))}},toggleVisualMode:function(t,r,i){var o,s=r.repeat,a=t.getCursor(),l=t.listSelections();i.visualMode?(a=t.getCursor("anchor"),o=t.getCursor("head"),i.visualLine?(r.blockwise?(i.visualBlock=!0,D(t,o),e.signal(t,"vim-mode-change",{mode:"visual",subMode:"blockwise"})):r.linewise?W(t):e.signal(t,"vim-mode-change",{mode:"visual"}),i.visualLine=!1):i.visualBlock?(r.linewise?(i.visualLine=!0,a=n(l[0].anchor.line,0),o=n(l[l.length-1].anchor.line,N(t,l[l.length-1].anchor.line)),t.setSelection(a,o),e.signal(t,"vim-mode-change",{mode:"visual",subMode:"linewise"})):r.blockwise?W(t):(a=o!=l[0].head?l[0].anchor:l[l.length-1].anchor,t.setSelection(a,o),e.signal(t,"vim-mode-change",{mode:"visual"})),i.visualBlock=!1):r.linewise?(i.visualLine=!0,a.ch=O(a,o)?0:N(t,a.line),o.ch=O(a,o)?N(t,o.line):0,t.setSelection(a,o),e.signal(t,"vim-mode-change",{mode:"visual",subMode:"linewise"})):r.blockwise?(i.visualBlock=!0,D(t,o),e.signal(t,"vim-mode-change",{mode:"visual",subMode:"blockwise"})):W(t)):(t.on("mousedown",W),i.visualMode=!0,i.visualLine=!!r.linewise,i.visualBlock=!!r.blockwise,i.visualLine?(a.ch=0,o=k(t,n(a.line+s-1,N(t,a.line)),!0)):o=k(t,n(a.line,a.ch+s),!0),t.setSelection(a,o),e.signal(t,"vim-mode-change",{mode:"visual",subMode:i.visualLine?"linewise":""})),Z(t,i,"<",O(a,o)?a:o),Z(t,i,">",O(a,o)?o:a)},reselectLastSelection:function(t,n,r){var i=r.marks["<"].find(),o=r.marks[">"].find(),s=r.lastSelection;if(s){var a=s.curStartMark.find(),l=s.curEndMark.find(),c=s.visualBlock;F(t,r,i,o),c?(t.setCursor(a),a=D(t,l)):(t.setSelection(a,l),a=t.getCursor("anchor"),l=t.getCursor("head")),r.visualMode&&(Z(t,r,"<",O(a,l)?a:l),Z(t,r,">",O(a,l)?l:a)),r.visualMode=!0,s.visualLine?(r.visualLine=!0,r.visualBlock=!1):s.visualBlock?(r.visualLine=!1,r.visualBlock=!0):r.visualBlock=r.visualLine=!1,e.signal(t,"vim-mode-change",{mode:"visual",subMode:r.visualLine?"linewise":""})}},joinLines:function(e,t,r){var i,o;if(r.visualMode)i=e.getCursor("anchor"),o=e.getCursor("head"),o.ch=N(e,o.line)-1;else{var s=Math.max(t.repeat,2);i=e.getCursor(),o=k(e,n(i.line+s-1,1/0))}var a=0;e.operation(function(){for(var t=i.line;t<o.line;t++){a=N(e,i.line);var r=n(i.line+1,N(e,i.line+1)),s=e.getRange(i,r);s=s.replace(/\n\s*/g," "),e.replaceRange(s,i,r)}var l=n(i.line,a);e.setCursor(l)})},newLineAndEnterInsertMode:function(t,r,i){i.insertMode=!0;var o=M(t.getCursor());if(o.line!==t.firstLine()||r.after){o.line=r.after?o.line:o.line-1,o.ch=N(t,o.line),t.setCursor(o);var s=e.commands.newlineAndIndentContinueComment||e.commands.newlineAndIndent;s(t)}else t.replaceRange("\n",n(t.firstLine(),0)),t.setCursor(t.firstLine(),0);this.enterInsertMode(t,{repeat:r.repeat},i)},paste:function(e,t,r){var i=M(e.getCursor()),o=Yt.registerController.getRegister(t.registerName),s=o.toString();if(s){if(t.matchIndent){var a=function(t){var n=t.split("	").length-1,r=t.split(" ").length-1;return n*e.options.tabSize+1*r},l=e.getLine(e.getCursor().line),c=a(l.match(/^\s*/)[0]),d=s.replace(/\n$/,""),h=s!==d,u=a(s.match(/^\s*/)[0]),s=d.replace(/^\s*/gm,function(t){var n=c+(a(t)-u);if(0>n)return"";if(e.options.indentWithTabs){var r=Math.floor(n/e.options.tabSize);return Array(r+1).join("	")}return Array(n+1).join(" ")});s+=h?"\n":""}if(t.repeat>1)var s=Array(t.repeat+1).join(s);var f=o.linewise;f?r.visualMode?s=r.visualLine?s.slice(0,-1):"\n"+s.slice(0,s.length-1)+"\n":t.after?(s="\n"+s.slice(0,s.length-1),i.ch=N(e,i.line)):i.ch=0:i.ch+=t.after?1:0;var p,g;if(r.visualMode){r.lastPastedText=s;var m,v=B(e,r),y=v[0],_=v[1];r.lastSelection&&(m=r.lastSelection.curEndMark.find()),Yt.registerController.unnamedRegister.setText(e.getRange(y,_)),e.replaceRange(s,y,_),m&&(r.lastSelection.curEndMark=e.setBookmark(m)),p=e.posFromIndex(e.indexFromPos(y)+s.length-1),f&&(p.ch=0)}else e.replaceRange(s,i),f&&t.after?p=n(i.line+1,z(e.getLine(i.line+1))):f&&!t.after?p=n(i.line,z(e.getLine(i.line))):!f&&t.after?(g=e.indexFromPos(i),p=e.posFromIndex(g+s.length-1)):(g=e.indexFromPos(i),p=e.posFromIndex(g+s.length));e.setCursor(p)}},undo:function(t,n){t.operation(function(){j(t,e.commands.undo,n.repeat)(),t.setCursor(t.getCursor("anchor"))})},redo:function(t,n){j(t,e.commands.redo,n.repeat)()},setRegister:function(e,t,n){n.inputState.registerName=t.selectedCharacter},setMark:function(e,t,n){var r=t.selectedCharacter;Z(e,n,r,e.getCursor())},replace:function(t,r,i){var o,s,a=r.selectedCharacter,l=t.getCursor();if(i.visualMode)l=t.getCursor("start"),s=t.getCursor("end");else{var c=t.getLine(l.line);o=l.ch+r.repeat,o>c.length&&(o=c.length),s=n(l.line,o)}if("\n"==a)i.visualMode||t.replaceRange("",l,s),(e.commands.newlineAndIndentContinueComment||e.commands.newlineAndIndent)(t);else{var d=t.getRange(l,s);d=d.replace(/[^\n]/g,a),t.replaceRange(d,l,s),i.visualMode?(t.setCursor(l),W(t)):t.setCursor(T(s,0,-1))}},incrementNumberToken:function(e,t){for(var r,i,o,s,a,l=e.getCursor(),c=e.getLine(l.line),d=/-?\d+/g;null!==(r=d.exec(c))&&(a=r[0],i=r.index,o=i+a.length,!(l.ch<o)););if((t.backtrack||!(o<=l.ch))&&a){var h=t.increase?1:-1,u=parseInt(a)+h*t.repeat,f=n(l.line,i),p=n(l.line,o);s=u.toString(),e.replaceRange(s,f,p),e.setCursor(n(l.line,i+s.length-1))}},repeatLastEdit:function(e,t,n){var r=n.lastEditInputState;if(r){var i=t.repeat;i&&t.repeatIsExplicit?n.lastEditInputState.repeatOverride=i:i=n.lastEditInputState.repeatOverride||i,Ht(e,n,i,!1)}},changeCase:function(e,t,n){var r=B(e,n),i=r[0],o=r[1],s=n.lastSelection.curEndMark.find(),a=t.toLower,l=e.getRange(i,o);e.replaceRange(a?l.toLowerCase():l.toUpperCase(),i,o),n.lastSelection.curEndMark=e.setBookmark(s),e.setCursor(i)}},nn={"(":"bracket",")":"bracket","{":"bracket","}":"bracket","[":"section","]":"section","*":"comment","/":"comment",m:"method",M:"method","#":"preprocess"},rn={bracket:{isComplete:function(e){if(e.nextCh===e.symb){if(e.depth++,e.depth>=1)return!0}else e.nextCh===e.reverseSymb&&e.depth--;return!1}},section:{init:function(e){e.curMoveThrough=!0,e.symb=(e.forward?"]":"[")===e.symb?"{":"}"},isComplete:function(e){return 0===e.index&&e.nextCh===e.symb}},comment:{isComplete:function(e){var t="*"===e.lastCh&&"/"===e.nextCh;return e.lastCh=e.nextCh,t}},method:{init:function(e){e.symb="m"===e.symb?"{":"}",e.reverseSymb="{"===e.symb?"}":"{"},isComplete:function(e){return e.nextCh===e.symb?!0:!1}},preprocess:{init:function(e){e.index=0},isComplete:function(e){if("#"===e.nextCh){var t=e.lineText.match(/#(\w+)/)[1];if("endif"===t){if(e.forward&&0===e.depth)return!0;e.depth++}else if("if"===t){if(!e.forward&&0===e.depth)return!0;e.depth--}if("else"===t&&0===e.depth)return!0}return!1}}};f("pcre",!0,"boolean"),rt.prototype={getQuery:function(){return Yt.query},setQuery:function(e){Yt.query=e},getOverlay:function(){return this.searchOverlay},setOverlay:function(e){this.searchOverlay=e},isReversed:function(){return Yt.isReversed},setReversed:function(e){Yt.isReversed=e}};var on="(Javascript regexp)",sn=[{name:"map"},{name:"nmap",shortName:"nm"},{name:"vmap",shortName:"vm"},{name:"unmap"},{name:"write",shortName:"w"},{name:"undo",shortName:"u"},{name:"redo",shortName:"red"},{name:"set",shortName:"set"},{name:"sort",shortName:"sor"},{name:"substitute",shortName:"s",possiblyAsync:!0},{name:"nohlsearch",shortName:"noh"},{name:"delmarks",shortName:"delm"},{name:"registers",shortName:"reg",excludeFromCommandHistory:!0},{name:"global",shortName:"g"}];r.ExCommandDispatcher=function(){this.buildCommandMap_()},r.ExCommandDispatcher.prototype={processCommand:function(t,n,r){var i=t.state.vim,o=Yt.registerController.getRegister(":"),s=o.toString();i.visualMode&&W(t);var a=new e.StringStream(n);o.setText(n);var l=r||{};l.input=n;try{this.parseInput_(t,a,l)}catch(c){throw ut(t,c),c}var d,h;if(l.commandName){if(d=this.matchCommand_(l.commandName)){if(h=d.name,d.excludeFromCommandHistory&&o.setText(s),this.parseCommandArgs_(a,l,d),"exToKey"==d.type){for(var u=0;u<d.toKeys.length;u++)e.Vim.handleKey(t,d.toKeys[u]);return}if("exToEx"==d.type)return this.processCommand(t,d.toInput),void 0}}else void 0!==l.line&&(h="move");if(!h)return ut(t,'Not an editor command ":'+n+'"'),void 0;try{an[h](t,l),d&&d.possiblyAsync||!l.callback||l.callback()}catch(c){throw ut(t,c),c}},parseInput_:function(e,t,n){t.eatWhile(":"),t.eat("%")?(n.line=e.firstLine(),n.lineEnd=e.lastLine()):(n.line=this.parseLineSpec_(e,t),void 0!==n.line&&t.eat(",")&&(n.lineEnd=this.parseLineSpec_(e,t)));var r=t.match(/^(\w+)/);return n.commandName=r?r[1]:t.match(/.*/)[0],n},parseLineSpec_:function(e,t){var n=t.match(/^(\d+)/);if(n)return parseInt(n[1],10)-1;switch(t.next()){case".":return e.getCursor().line;case"$":return e.lastLine();case"'":var r=e.state.vim.marks[t.next()];if(r&&r.find())return r.find().line;throw new Error("Mark not set");default:return t.backUp(1),void 0}},parseCommandArgs_:function(e,t,n){if(!e.eol()){t.argString=e.match(/.*/)[0];var r=n.argDelimiter||/\s+/,i=H(t.argString).split(r);i.length&&i[0]&&(t.args=i)}},matchCommand_:function(e){for(var t=e.length;t>0;t--){var n=e.substring(0,t);if(this.commandMap_[n]){var r=this.commandMap_[n];if(0===r.name.indexOf(e))return r}}return null},buildCommandMap_:function(){this.commandMap_={};for(var e=0;e<sn.length;e++){var t=sn[e],n=t.shortName||t.name;this.commandMap_[n]=t}},map:function(e,n,r){if(":"!=e&&":"==e.charAt(0)){if(r)throw Error("Mode not supported for ex mappings");var i=e.substring(1);this.commandMap_[i]=":"!=n&&":"==n.charAt(0)?{name:i,type:"exToEx",toInput:n.substring(1),user:!0}:{name:i,type:"exToKey",toKeys:wt(n),user:!0}}else if(":"!=n&&":"==n.charAt(0)){var o={keys:wt(e),type:"keyToEx",exArgs:{input:n.substring(1)},user:!0};r&&(o.context=r),t.unshift(o)}else{var o={keys:wt(e),type:"keyToKey",toKeys:wt(n),user:!0};r&&(o.context=r),t.unshift(o)}},unmap:function(e,n){var r=function(e,t){if(e===t)return!0;if(null==e||null==t)return!0;if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0};if(":"!=e&&":"==e.charAt(0)){if(n)throw Error("Mode not supported for ex mappings");var i=e.substring(1);if(this.commandMap_[i]&&this.commandMap_[i].user)return delete this.commandMap_[i],void 0}else for(var o=wt(e),s=0;s<t.length;s++)if(r(o,t[s].keys)&&t[s].context===n&&t[s].user)return t.splice(s,1),void 0;throw Error("No such mapping.")}};var an={map:function(e,t,n){var r=t.args;return!r||r.length<2?(e&&ut(e,"Invalid mapping: "+t.input),void 0):(ln.map(r[0],r[1],n),void 0)},nmap:function(e,t){this.map(e,t,"normal")},vmap:function(e,t){this.map(e,t,"visual")},unmap:function(e,t,n){var r=t.args;return!r||r.length<1?(e&&ut(e,"No such mapping: "+t.input),void 0):(ln.unmap(r[0],n),void 0)},move:function(e,t){Qt.processCommand(e,e.state.vim,{type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0},repeatOverride:t.line+1})},set:function(e,t){var n=t.args;if(!n||n.length<1)return e&&ut(e,"Invalid mapping: "+t.input),void 0;var r=n[0].split("="),i=r[0],o=r[1],s=!1;if("?"==i.charAt(i.length-1)){if(o)throw Error("Trailing characters: "+t.argString);i=i.substring(0,i.length-1),s=!0}void 0===o&&"no"==i.substring(0,2)&&(i=i.substring(2),o=!1);var a=Gt[i]&&"boolean"==Gt[i].type;if(a&&void 0==o&&(o=!0),!a&&!o||s){var l=g(i);l===!0||l===!1?ut(e," "+(l?"":"no")+i):ut(e,"  "+i+"="+l)}else p(i,o)},registers:function(e,t){var n=t.args,r=Yt.registerController.registers,i="----------Registers----------<br><br>";if(n){var o;n=n.join("");for(var s=0;s<n.length;s++)if(o=n.charAt(s),Yt.registerController.isValidRegister(o)){var a=r[o]||new x;i+='"'+o+"    "+a.toString()+"<br>"}}else for(var o in r){var l=r[o].toString();l.length&&(i+='"'+o+"    "+l+"<br>")}ut(e,i)},sort:function(t,r){function i(){if(r.argString){var t=new e.StringStream(r.argString);if(t.eat("!")&&(s=!0),t.eol())return;if(!t.eatSpace())return"Invalid arguments";var n=t.match(/[a-z]+/);if(n){n=n[0],a=-1!=n.indexOf("i"),l=-1!=n.indexOf("u");var i=-1!=n.indexOf("d")&&1,o=-1!=n.indexOf("x")&&1,d=-1!=n.indexOf("o")&&1;if(i+o+d>1)return"Invalid arguments";c=i&&"decimal"||o&&"hex"||d&&"octal"}t.eatSpace()&&t.match(/\/.*\//)}}function o(e,t){if(s){var n;n=e,e=t,t=n}a&&(e=e.toLowerCase(),t=t.toLowerCase());var r=c&&m.exec(e),i=c&&m.exec(t);return r?(r=parseInt((r[1]+r[2]).toLowerCase(),v),i=parseInt((i[1]+i[2]).toLowerCase(),v),r-i):t>e?-1:1}var s,a,l,c,d=i();if(d)return ut(t,d+": "+r.argString),void 0;var h=r.line||t.firstLine(),u=r.lineEnd||r.line||t.lastLine();if(h!=u){var f=n(h,0),p=n(u,N(t,u)),g=t.getRange(f,p).split("\n"),m="decimal"==c?/(-?)([\d]+)/:"hex"==c?/(-?)(?:0x)?([0-9a-f]+)/i:"octal"==c?/([0-7]+)/:null,v="decimal"==c?10:"hex"==c?16:"octal"==c?8:null,y=[],_=[];if(c)for(var b=0;b<g.length;b++)m.exec(g[b])?y.push(g[b]):_.push(g[b]);else _=g;if(y.sort(o),_.sort(o),g=s?y.concat(_):_.concat(y),l){var x,C=g;g=[];for(var b=0;b<C.length;b++)C[b]!=x&&g.push(C[b]),x=C[b]}t.replaceRange(g.join("\n"),f,p)}},global:function(e,t){var n=t.argString;if(!n)return ut(e,"Regular Expression missing from global"),void 0;var r,i=void 0!==t.line?t.line:e.firstLine(),o=t.lineEnd||t.line||e.lastLine(),s=st(n),a=n;if(s.length&&(a=s[0],r=s.slice(1,s.length).join("/")),a)try{mt(e,a,!0,!0)}catch(l){return ut(e,"Invalid regex: "+a),void 0}for(var c=it(e).getQuery(),d=[],h="",u=i;o>=u;u++){var f=c.test(e.getLine(u));f&&(d.push(u+1),h+=e.getLine(u)+"<br>")}if(!r)return ut(e,h),void 0;var p=0,g=function(){if(p<d.length){var t=d[p]+r;ln.processCommand(e,t,{callback:g})}p++};g()},substitute:function(e,t){if(!e.getSearchCursor)throw new Error("Search feature not available. Requires searchcursor.js or any other getSearchCursor implementation.");var r,i,o,s,a=t.argString,l=a?st(a):[],c="",d=!1,h=!1;if(l.length)r=l[0],c=l[1],void 0!==c&&(c=g("pcre")?dt(c):ct(c),Yt.lastSubstituteReplacePart=c),i=l[2]?l[2].split(" "):[];else if(a&&a.length)return ut(e,"Substitutions should be of the form :s/pattern/replace/"),void 0;if(i&&(o=i[0],s=parseInt(i[1]),o&&(-1!=o.indexOf("c")&&(d=!0,o.replace("c","")),-1!=o.indexOf("g")&&(h=!0,o.replace("g","")),r=r+"/"+o)),r)try{mt(e,r,!0,!0)}catch(u){return ut(e,"Invalid regex: "+r),void 0}if(c=c||Yt.lastSubstituteReplacePart,void 0===c)return ut(e,"No previous substitute regular expression"),void 0;var f=it(e),p=f.getQuery(),m=void 0!==t.line?t.line:e.getCursor().line,v=t.lineEnd||m;s&&(m=v,v=m+s-1);var y=k(e,n(m,0)),_=e.getSearchCursor(p,y);kt(e,d,h,m,v,_,p,c,t.callback)},redo:e.commands.redo,undo:e.commands.undo,write:function(t){e.commands.save?e.commands.save(t):t.save()},nohlsearch:function(e){bt(e)},delmarks:function(t,n){if(!n.argString||!H(n.argString))return ut(t,"Argument required"),void 0;for(var r=t.state.vim,i=new e.StringStream(H(n.argString));!i.eol();){i.eatSpace();var o=i.pos;if(!i.match(/[a-zA-Z]/,!1))return ut(t,"Invalid argument: "+n.argString.substring(o)),void 0;var s=i.next();if(i.match("-",!0)){if(!i.match(/[a-zA-Z]/,!1))return ut(t,"Invalid argument: "+n.argString.substring(o)),void 0;var l=s,c=i.next();if(!(a(l)&&a(c)||d(l)&&d(c)))return ut(t,"Invalid argument: "+l+"-"),void 0;var h=l.charCodeAt(0),u=c.charCodeAt(0);if(h>=u)return ut(t,"Invalid argument: "+n.argString.substring(o)),void 0;for(var f=0;u-h>=f;f++){var p=String.fromCharCode(h+f);delete r.marks[p]}}else delete r.marks[s]}}},ln=new r.ExCommandDispatcher;return e.keyMap.vim=St(),e.keyMap["vim-insert"]={Esc:Tt,"Ctrl-[":Tt,"Ctrl-C":Tt,"Ctrl-N":"autocomplete","Ctrl-P":"autocomplete",Enter:function(t){var n=e.commands.newlineAndIndentContinueComment||e.commands.newlineAndIndent;n(t)},fallthrough:["default"]},e.keyMap["vim-replace"]={Backspace:"goCharLeft",fallthrough:["vim-insert"]},y(),Jt};e.Vim=r()}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(e){"object"==typeof exports&&"object"==typeof module?e(require("../lib/codemirror")):"function"==typeof define&&define.amd?define(["../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e,t){return e.line==t.line&&e.ch==t.ch}function n(e){N.push(e),N.length>50&&N.shift()}function r(e){return N.length?(N[N.length-1]+=e,void 0):n(e)}function i(e){return N[N.length-(e?Math.min(e,1):1)]||""}function o(){return N.length>1&&N.pop(),i()}function s(e,i,o,s,a){null==a&&(a=e.getRange(i,o)),s&&I&&I.cm==e&&t(i,I.pos)&&e.isClean(I.gen)?r(a):n(a),e.replaceRange("",i,o,"+delete"),I=s?{cm:e,pos:i,gen:e.changeGeneration()}:null}function a(e,t,n){return e.findPosH(t,n,"char",!0)}function l(e,t,n){return e.findPosH(t,n,"word",!0)}function c(e,t,n){return e.findPosV(t,n,"line",e.doc.sel.goalColumn)}function d(e,t,n){return e.findPosV(t,n,"page",e.doc.sel.goalColumn)}function h(e,t,n){for(var r=t.line,i=e.getLine(r),o=/\S/.test(0>n?i.slice(0,t.ch):i.slice(t.ch)),s=e.firstLine(),a=e.lastLine();;){if(r+=n,s>r||r>a)return e.clipPos(E(r-n,0>n?0:null));i=e.getLine(r);var l=/\S/.test(i);if(l)o=!0;else if(o)return E(r,0)}}function u(e,t,n){for(var r=t.line,i=t.ch,o=e.getLine(t.line),s=!1;;){var a=o.charAt(i+(0>n?-1:0));if(a){if(s&&/[!?.]/.test(a))return E(r,i+(n>0?1:0));s||(s=/\w/.test(a)),i+=n}else{if(r==(0>n?e.firstLine():e.lastLine()))return E(r,i);if(o=e.getLine(r+n),!/\S/.test(o))return E(r,i);r+=n,i=0>n?o.length:0}}}function f(e,n,r){var i;if(e.findMatchingBracket&&(i=e.findMatchingBracket(n,!0))&&i.match&&(i.forward?1:-1)==r)return r>0?E(i.to.line,i.to.ch+1):i.to;for(var o=!0;;o=!1){var s=e.getTokenAt(n),a=E(n.line,0>r?s.start:s.end);if(!(o&&r>0&&s.end==n.ch)&&/\w/.test(s.string))return a;var l=e.findPosH(a,r,"char");if(t(a,l))return n;n=l}}function p(e,t){var n=e.state.emacsPrefix;return n?(x(e),"-"==n?-1:Number(n)):t?null:1}function g(e){var t="string"==typeof e?function(t){t.execCommand(e)}:e;return function(e){var n=p(e);t(e);for(var r=1;n>r;++r)t(e)}}function m(e,n,r){var i=e.getCursor(),o=p(e);0>o&&(r=-r,o=-o);for(var s=0;o>s;++s){var a=n(e,i,r);if(t(a,i))break;i=a}return i}function v(e,t){var n=function(n){n.extendSelection(m(n,e,t))};return n.motion=!0,n}function y(e,t,n){s(e,e.getCursor(),m(e,t,n),!0)}function _(e,t){return e.state.emacsPrefix?("-"!=t&&(e.state.emacsPrefix+=t),void 0):(e.state.emacsPrefix=t,e.on("keyHandled",b),e.on("inputRead",C),void 0)}function b(e,t){e.state.emacsPrefixMap||H.hasOwnProperty(t)||x(e)}function x(e){e.state.emacsPrefix=null,e.off("keyHandled",b),e.off("inputRead",C)}function C(e,t){var n=p(e);if(n>1&&"+input"==t.origin){for(var r=t.text.join("\n"),i="",o=1;n>o;++o)i+=r;e.replaceSelection(i)}}function w(e){e.state.emacsPrefixMap=!0,e.addKeyMap(D),e.on("keyHandled",k),e.on("inputRead",k)}function k(e,t){("string"!=typeof t||!/^\d$/.test(t)&&"Ctrl-U"!=t)&&(e.removeKeyMap(D),e.state.emacsPrefixMap=!1,e.off("keyHandled",k),e.off("inputRead",k))}function S(e){e.setCursor(e.getCursor()),e.setExtending(!e.getExtending()),e.on("change",function(){e.setExtending(!1)})}function T(e){e.setExtending(!1),e.setCursor(e.getCursor())}function L(e,t,n){e.openDialog?e.openDialog(t+': <input type="text" style="width: 10em"/>',n,{bottom:!0}):n(prompt(t,""))}function j(e,t){var n=e.getCursor(),r=e.findPosH(n,1,"word");e.replaceRange(t(e.getRange(n,r)),n,r),e.setCursor(r)}function M(e){for(var t=e.getCursor(),n=t.line,r=t.ch,i=[];n>=e.firstLine();){for(var o=e.getLine(n),s=null==r?o.length:r;s>0;){var r=o.charAt(--s);if(")"==r)i.push("(");else if("]"==r)i.push("[");else if("}"==r)i.push("{");else if(/[\(\{\[]/.test(r)&&(!i.length||i.pop()!=r))return e.extendSelection(E(n,s))}--n,r=null}}function A(e){e.execCommand("clearSearch"),T(e)}function O(e){D[e]=function(t){_(t,e)},P["Ctrl-"+e]=function(t){_(t,e)},H["Ctrl-"+e]=!0}var E=e.Pos,N=[],I=null,H={"Alt-G":!0,"Ctrl-X":!0,"Ctrl-Q":!0,"Ctrl-U":!0},P=e.keyMap.emacs={"Ctrl-W":function(e){s(e,e.getCursor("start"),e.getCursor("end"))},"Ctrl-K":g(function(e){var t=e.getCursor(),n=e.clipPos(E(t.line)),r=e.getRange(t,n);/\S/.test(r)||(r+="\n",n=E(t.line+1,0)),s(e,t,n,!0,r)}),"Alt-W":function(e){n(e.getSelection()),T(e)},"Ctrl-Y":function(e){var t=e.getCursor();e.replaceRange(i(p(e)),t,t,"paste"),e.setSelection(t,e.getCursor())},"Alt-Y":function(e){e.replaceSelection(o(),"around","paste")},"Ctrl-Space":S,"Ctrl-Shift-2":S,"Ctrl-F":v(a,1),"Ctrl-B":v(a,-1),Right:v(a,1),Left:v(a,-1),"Ctrl-D":function(e){y(e,a,1)},Delete:function(e){y(e,a,1)},"Ctrl-H":function(e){y(e,a,-1)},Backspace:function(e){y(e,a,-1)},"Alt-F":v(l,1),"Alt-B":v(l,-1),"Alt-D":function(e){y(e,l,1)},"Alt-Backspace":function(e){y(e,l,-1)},"Ctrl-N":v(c,1),"Ctrl-P":v(c,-1),Down:v(c,1),Up:v(c,-1),"Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd",End:"goLineEnd",Home:"goLineStart","Alt-V":v(d,-1),"Ctrl-V":v(d,1),PageUp:v(d,-1),PageDown:v(d,1),"Ctrl-Up":v(h,-1),"Ctrl-Down":v(h,1),"Alt-A":v(u,-1),"Alt-E":v(u,1),"Alt-K":function(e){y(e,u,1)},"Ctrl-Alt-K":function(e){y(e,f,1)},"Ctrl-Alt-Backspace":function(e){y(e,f,-1)},"Ctrl-Alt-F":v(f,1),"Ctrl-Alt-B":v(f,-1),"Shift-Ctrl-Alt-2":function(e){e.setSelection(m(e,f,1),e.getCursor())},"Ctrl-Alt-T":function(e){var t=f(e,e.getCursor(),-1),n=f(e,t,1),r=f(e,n,1),i=f(e,r,-1);e.replaceRange(e.getRange(i,r)+e.getRange(n,i)+e.getRange(t,n),t,r)},"Ctrl-Alt-U":g(M),"Alt-Space":function(e){for(var t=e.getCursor(),n=t.ch,r=t.ch,i=e.getLine(t.line);n&&/\s/.test(i.charAt(n-1));)--n;for(;r<i.length&&/\s/.test(i.charAt(r));)++r;e.replaceRange(" ",E(t.line,n),E(t.line,r))},"Ctrl-O":g(function(e){e.replaceSelection("\n","start")}),"Ctrl-T":g(function(e){e.execCommand("transposeChars")}),"Alt-C":g(function(e){j(e,function(e){var t=e.search(/\w/);return-1==t?e:e.slice(0,t)+e.charAt(t).toUpperCase()+e.slice(t+1).toLowerCase()})}),"Alt-U":g(function(e){j(e,function(e){return e.toUpperCase()})}),"Alt-L":g(function(e){j(e,function(e){return e.toLowerCase()})}),"Alt-;":"toggleComment","Ctrl-/":g("undo"),"Shift-Ctrl--":g("undo"),"Ctrl-Z":g("undo"),"Cmd-Z":g("undo"),"Shift-Alt-,":"goDocStart","Shift-Alt-.":"goDocEnd","Ctrl-S":"findNext","Ctrl-R":"findPrev","Ctrl-G":A,"Shift-Alt-5":"replace","Alt-/":"autocomplete","Ctrl-J":"newlineAndIndent",Enter:!1,Tab:"indentAuto","Alt-G":function(e){e.setOption("keyMap","emacs-Alt-G")},"Ctrl-X":function(e){e.setOption("keyMap","emacs-Ctrl-X")},"Ctrl-Q":function(e){e.setOption("keyMap","emacs-Ctrl-Q")},"Ctrl-U":w};e.keyMap["emacs-Ctrl-X"]={Tab:function(e){e.indentSelection(p(e,!0)||e.getOption("indentUnit"))},"Ctrl-X":function(e){e.setSelection(e.getCursor("head"),e.getCursor("anchor"))},"Ctrl-S":"save","Ctrl-W":"save",S:"saveAll",F:"open",U:g("undo"),K:"close",Delete:function(e){s(e,e.getCursor(),u(e,e.getCursor(),1),!0)},auto:"emacs",nofallthrough:!0,disableInput:!0},e.keyMap["emacs-Alt-G"]={G:function(e){var t=p(e,!0);return null!=t&&t>0?e.setCursor(t-1):(L(e,"Goto line",function(t){var n;t&&!isNaN(n=Number(t))&&n==n|0&&n>0&&e.setCursor(n-1)}),void 0)},auto:"emacs",nofallthrough:!0,disableInput:!0},e.keyMap["emacs-Ctrl-Q"]={Tab:g("insertTab"),auto:"emacs",nofallthrough:!0};for(var D={"Ctrl-G":x},R=0;10>R;++R)O(String(R));O("-")}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.registerHelper("fold","brace",function(t,n){function r(r){for(var i=n.ch,l=0;;){var c=0>=i?-1:a.lastIndexOf(r,i-1);if(-1!=c){if(1==l&&c<n.ch)break;if(o=t.getTokenTypeAt(e.Pos(s,c+1)),!/^(comment|string)/.test(o))return c+1;i=c-1}else{if(1==l)break;l=1,i=a.length}}}var i,o,s=n.line,a=t.getLine(s),l="{",c="}",i=r("{");if(null==i&&(l="[",c="]",i=r("[")),null!=i){var d,h,u=1,f=t.lastLine();e:for(var p=s;f>=p;++p)for(var g=t.getLine(p),m=p==s?i:0;;){var v=g.indexOf(l,m),y=g.indexOf(c,m);if(0>v&&(v=g.length),0>y&&(y=g.length),m=Math.min(v,y),m==g.length)break;if(t.getTokenTypeAt(e.Pos(p,m+1))==o)if(m==v)++u;else if(!--u){d=p,h=m;break e}++m}if(null!=d&&(s!=d||h!=i))return{from:e.Pos(s,i),to:e.Pos(d,h)}}}),e.registerHelper("fold","import",function(t,n){function r(n){if(n<t.firstLine()||n>t.lastLine())return null;var r=t.getTokenAt(e.Pos(n,1));if(/\S/.test(r.string)||(r=t.getTokenAt(e.Pos(n,r.end+1))),"keyword"!=r.type||"import"!=r.string)return null;for(var i=n,o=Math.min(t.lastLine(),n+10);o>=i;++i){var s=t.getLine(i),a=s.indexOf(";");if(-1!=a)return{startCh:r.end,end:e.Pos(i,a)}}}var i,n=n.line,o=r(n);if(!o||r(n-1)||(i=r(n-2))&&i.end.line==n-1)return null;for(var s=o.end;;){var a=r(s.line+1);if(null==a)break;s=a.end}return{from:t.clipPos(e.Pos(n,o.startCh+1)),to:s}}),e.registerHelper("fold","include",function(t,n){function r(n){if(n<t.firstLine()||n>t.lastLine())return null;var r=t.getTokenAt(e.Pos(n,1));return/\S/.test(r.string)||(r=t.getTokenAt(e.Pos(n,r.end+1))),"meta"==r.type&&"#include"==r.string.slice(0,8)?r.start+8:void 0}var n=n.line,i=r(n);if(null==i||null!=r(n-1))return null;for(var o=n;;){var s=r(o+1);if(null==s)break;++o}return{from:e.Pos(n,i+1),to:t.clipPos(e.Pos(o))}})}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e,t){return e.line-t.line||e.ch-t.ch}function n(e,t,n,r){this.line=t,this.ch=n,this.cm=e,this.text=e.getLine(t),this.min=r?r.from:e.firstLine(),this.max=r?r.to-1:e.lastLine()}function r(e,t){var n=e.cm.getTokenTypeAt(u(e.line,t));return n&&/\btag\b/.test(n)}function i(e){return e.line>=e.max?void 0:(e.ch=0,e.text=e.cm.getLine(++e.line),!0)}function o(e){return e.line<=e.min?void 0:(e.text=e.cm.getLine(--e.line),e.ch=e.text.length,!0)}function s(e){for(;;){var t=e.text.indexOf(">",e.ch);if(-1==t){if(i(e))continue;return}{if(r(e,t+1)){var n=e.text.lastIndexOf("/",t),o=n>-1&&!/\S/.test(e.text.slice(n+1,t));return e.ch=t+1,o?"selfClose":"regular"}e.ch=t+1}}}function a(e){for(;;){var t=e.ch?e.text.lastIndexOf("<",e.ch-1):-1;if(-1==t){if(o(e))continue;return}if(r(e,t+1)){g.lastIndex=t,e.ch=t;var n=g.exec(e.text);if(n&&n.index==t)return n}else e.ch=t}}function l(e){for(;;){g.lastIndex=e.ch;var t=g.exec(e.text);if(!t){if(i(e))continue;return}{if(r(e,t.index+1))return e.ch=t.index+t[0].length,t;e.ch=t.index+1}}}function c(e){for(;;){var t=e.ch?e.text.lastIndexOf(">",e.ch-1):-1;if(-1==t){if(o(e))continue;return}{if(r(e,t+1)){var n=e.text.lastIndexOf("/",t),i=n>-1&&!/\S/.test(e.text.slice(n+1,t));return e.ch=t+1,i?"selfClose":"regular"}e.ch=t}}}function d(e,t){for(var n=[];;){var r,i=l(e),o=e.line,a=e.ch-(i?i[0].length:0);if(!i||!(r=s(e)))return;if("selfClose"!=r)if(i[1]){for(var c=n.length-1;c>=0;--c)if(n[c]==i[2]){n.length=c;break}if(0>c&&(!t||t==i[2]))return{tag:i[2],from:u(o,a),to:u(e.line,e.ch)}}else n.push(i[2])}}function h(e,t){for(var n=[];;){var r=c(e);if(!r)return;if("selfClose"!=r){var i=e.line,o=e.ch,s=a(e);if(!s)return;if(s[1])n.push(s[2]);else{for(var l=n.length-1;l>=0;--l)if(n[l]==s[2]){n.length=l;break}if(0>l&&(!t||t==s[2]))return{tag:s[2],from:u(e.line,e.ch),to:u(i,o)}}}else a(e)}}var u=e.Pos,f="A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",p=f+"-:.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040",g=new RegExp("<(/?)(["+f+"]["+p+"]*)","g");e.registerHelper("fold","xml",function(e,t){for(var r=new n(e,t.line,0);;){var i,o=l(r);if(!o||r.line!=t.line||!(i=s(r)))return;if(!o[1]&&"selfClose"!=i){var t=u(r.line,r.ch),a=d(r,o[2]);return a&&{from:t,to:a.from}}}}),e.findMatchingTag=function(e,r,i){var o=new n(e,r.line,r.ch,i);if(-1!=o.text.indexOf(">")||-1!=o.text.indexOf("<")){var l=s(o),c=l&&u(o.line,o.ch),f=l&&a(o);if(l&&"selfClose"!=l&&f&&!(t(o,r)>0)){var p={from:u(o.line,o.ch),to:c,tag:f[2]};return f[1]?{open:h(o,f[2]),close:p,at:"close"}:(o=new n(e,c.line,c.ch,i),{open:p,close:d(o,f[2]),at:"open"})}}},e.findEnclosingTag=function(e,t,r){for(var i=new n(e,t.line,t.ch,r);;){var o=h(i);if(!o)break;var s=new n(e,t.line,t.ch,r),a=d(s,o.tag);if(a)return{open:o,close:a}}},e.scanForClosingTag=function(e,t,r,i){var o=new n(e,t.line,t.ch,i?{from:0,to:i}:null);return d(o,r)}}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.registerHelper("fold","markdown",function(t,n){function r(n){var r=t.getTokenTypeAt(e.Pos(n,0));return r&&/\bheader\b/.test(r)}function i(e,t,n){var i=t&&t.match(/^#+/);return i&&r(e)?i[0].length:(i=n&&n.match(/^[=\-]+\s*$/),i&&r(e+1)?"="==n[0]?1:2:o)}var o=100,s=t.getLine(n.line),a=t.getLine(n.line+1),l=i(n.line,s,a);if(l===o)return void 0;for(var c=t.lastLine(),d=n.line,h=t.getLine(d+2);c>d&&!(i(d+1,a,h)<=l);)++d,a=h,h=t.getLine(d+2);return{from:e.Pos(n.line,s.length),to:e.Pos(d,t.getLine(d).length)}})}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.registerGlobalHelper("fold","comment",function(e){return e.blockCommentStart&&e.blockCommentEnd},function(t,n){var r=t.getModeAt(n),i=r.blockCommentStart,o=r.blockCommentEnd;if(i&&o){for(var s,a=n.line,l=t.getLine(a),c=n.ch,d=0;;){var h=0>=c?-1:l.lastIndexOf(i,c-1);if(-1!=h){if(1==d&&h<n.ch)return;if(/comment/.test(t.getTokenTypeAt(e.Pos(a,h+1)))){s=h+i.length;break}c=h-1}else{if(1==d)return;d=1,c=l.length}}var u,f,p=1,g=t.lastLine();e:for(var m=a;g>=m;++m)for(var v=t.getLine(m),y=m==a?s:0;;){var _=v.indexOf(i,y),b=v.indexOf(o,y);if(0>_&&(_=v.length),0>b&&(b=v.length),y=Math.min(_,b),y==v.length)break;if(y==_)++p;else if(!--p){u=m,f=y;break e}++y}if(null!=u&&(a!=u||f!=s))return{from:e.Pos(a,s),to:e.Pos(u,f)}}})}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.registerHelper("fold","indent",function(t,n){var r=t.getOption("tabSize"),i=t.getLine(n.line);if(/\S/.test(i)){for(var o=function(t){return e.countColumn(t,null,r)},s=o(i),a=null,l=n.line+1,c=t.lastLine();c>=l;++l){var d=t.getLine(l),h=o(d);if(h>s)a=l;else if(/\S/.test(d))break}return a?{from:e.Pos(n.line,i.length),to:e.Pos(a,t.getLine(a).length)}:void 0}})}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(t,i,o,s){function a(e){var n=l(t,i);if(!n||n.to.line-n.from.line<c)return null;for(var r=t.findMarksAt(n.from),o=0;o<r.length;++o)if(r[o].__isFold&&"fold"!==s){if(!e)return null;n.cleared=!0,r[o].clear()}return n}if(o&&o.call){var l=o;o=null}else var l=r(t,o,"rangeFinder");"number"==typeof i&&(i=e.Pos(i,0));var c=r(t,o,"minFoldSize"),d=a(!0);if(r(t,o,"scanUp"))for(;!d&&i.line>t.firstLine();)i=e.Pos(i.line-1,0),d=a(!1);if(d&&!d.cleared&&"unfold"!==s){var h=n(t,o);e.on(h,"mousedown",function(t){u.clear(),e.e_preventDefault(t)});var u=t.markText(d.from,d.to,{replacedWith:h,clearOnEnter:!0,__isFold:!0});u.on("clear",function(n,r){e.signal(t,"unfold",t,n,r)}),e.signal(t,"fold",t,d.from,d.to)}}function n(e,t){var n=r(e,t,"widget");if("string"==typeof n){var i=document.createTextNode(n);n=document.createElement("span"),n.appendChild(i),n.className="CodeMirror-foldmarker"}return n}function r(e,t,n){if(t&&void 0!==t[n])return t[n];var r=e.options.foldOptions;return r&&void 0!==r[n]?r[n]:i[n]}e.newFoldFunction=function(e,n){return function(r,i){t(r,i,{rangeFinder:e,widget:n})}},e.defineExtension("foldCode",function(e,n,r){t(this,e,n,r)}),e.defineExtension("isFolded",function(e){for(var t=this.findMarksAt(e),n=0;n<t.length;++n)if(t[n].__isFold)return!0}),e.commands.toggleFold=function(e){e.foldCode(e.getCursor())},e.commands.fold=function(e){e.foldCode(e.getCursor(),null,"fold")},e.commands.unfold=function(e){e.foldCode(e.getCursor(),null,"unfold")},e.commands.foldAll=function(t){t.operation(function(){for(var n=t.firstLine(),r=t.lastLine();r>=n;n++)t.foldCode(e.Pos(n,0),null,"fold")})},e.commands.unfoldAll=function(t){t.operation(function(){for(var n=t.firstLine(),r=t.lastLine();r>=n;n++)t.foldCode(e.Pos(n,0),null,"unfold")})},e.registerHelper("fold","combine",function(){var e=Array.prototype.slice.call(arguments,0);return function(t,n){for(var r=0;r<e.length;++r){var i=e[r](t,n);if(i)return i}}}),e.registerHelper("fold","auto",function(e,t){for(var n=e.getHelpers(t,"fold"),r=0;r<n.length;r++){var i=n[r](e,t);if(i)return i}});var i={rangeFinder:e.fold.auto,widget:"↔",minFoldSize:0,scanUp:!1};e.defineOption("foldOptions",null)}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("./foldcode")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","./foldcode"],e):e(CodeMirror)}(function(e){"use strict";function t(e){this.options=e,this.from=this.to=0}function n(e){return e===!0&&(e={}),null==e.gutter&&(e.gutter="CodeMirror-foldgutter"),null==e.indicatorOpen&&(e.indicatorOpen="CodeMirror-foldgutter-open"),null==e.indicatorFolded&&(e.indicatorFolded="CodeMirror-foldgutter-folded"),e}function r(e,t){for(var n=e.findMarksAt(h(t)),r=0;r<n.length;++r)if(n[r].__isFold&&n[r].find().from.line==t)return!0}function i(e){if("string"==typeof e){var t=document.createElement("div");return t.className=e+" CodeMirror-guttermarker-subtle",t}return e.cloneNode(!0)}function o(t,n,o){var s=t.state.foldGutter.options,a=n;t.eachLine(n,o,function(n){var o=null;if(r(t,a))o=i(s.indicatorFolded);else{var l=h(a,0),c=s.rangeFinder||e.fold.auto,d=c&&c(t,l);d&&d.from.line+1<d.to.line&&(o=i(s.indicatorOpen))}t.setGutterMarker(n,s.gutter,o),++a})}function s(e){var t=e.getViewport(),n=e.state.foldGutter;n&&(e.operation(function(){o(e,t.from,t.to)}),n.from=t.from,n.to=t.to)}function a(e,t,n){var r=e.state.foldGutter.options;n==r.gutter&&e.foldCode(h(t,0),r.rangeFinder)}function l(e){var t=e.state.foldGutter,n=e.state.foldGutter.options;t.from=t.to=0,clearTimeout(t.changeUpdate),t.changeUpdate=setTimeout(function(){s(e)},n.foldOnChangeTimeSpan||600)}function c(e){var t=e.state.foldGutter,n=e.state.foldGutter.options;clearTimeout(t.changeUpdate),t.changeUpdate=setTimeout(function(){var n=e.getViewport();t.from==t.to||n.from-t.to>20||t.from-n.to>20?s(e):e.operation(function(){n.from<t.from&&(o(e,n.from,t.from),t.from=n.from),n.to>t.to&&(o(e,t.to,n.to),t.to=n.to)})},n.updateViewportTimeSpan||400)}function d(e,t){var n=e.state.foldGutter,r=t.line;r>=n.from&&r<n.to&&o(e,r,r+1)}e.defineOption("foldGutter",!1,function(r,i,o){o&&o!=e.Init&&(r.clearGutter(r.state.foldGutter.options.gutter),r.state.foldGutter=null,r.off("gutterClick",a),r.off("change",l),r.off("viewportChange",c),r.off("fold",d),r.off("unfold",d),r.off("swapDoc",s)),i&&(r.state.foldGutter=new t(n(i)),s(r),r.on("gutterClick",a),r.on("change",l),r.on("viewportChange",c),r.on("fold",d),r.on("unfold",d),r.on("swapDoc",s))});var h=e.Pos}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e){var t=e.search(r);return-1==t?0:t}var n={},r=/[^\s\u00a0]/,i=e.Pos;e.commands.toggleComment=function(e){for(var t=1/0,n=e.listSelections(),r=null,o=n.length-1;o>=0;o--){var s=n[o].from(),a=n[o].to();s.line>=t||(a.line>=t&&(a=i(t,0)),t=s.line,null==r?e.uncomment(s,a)?r="un":(e.lineComment(s,a),r="line"):"un"==r?e.uncomment(s,a):e.lineComment(s,a))}},e.defineExtension("lineComment",function(e,o,s){s||(s=n);var a=this,l=a.getModeAt(e),c=s.lineComment||l.lineComment;if(!c)return(s.blockCommentStart||l.blockCommentStart)&&(s.fullLines=!0,a.blockComment(e,o,s)),void 0;var d=a.getLine(e.line);if(null!=d){var h=Math.min(0!=o.ch||o.line==e.line?o.line+1:o.line,a.lastLine()+1),u=null==s.padding?" ":s.padding,f=s.commentBlankLines||e.line==o.line;a.operation(function(){if(s.indent)for(var n=d.slice(0,t(d)),o=e.line;h>o;++o){var l=a.getLine(o),p=n.length;(f||r.test(l))&&(l.slice(0,p)!=n&&(p=t(l)),a.replaceRange(n+c+u,i(o,0),i(o,p)))}else for(var o=e.line;h>o;++o)(f||r.test(a.getLine(o)))&&a.replaceRange(c+u,i(o,0))})}}),e.defineExtension("blockComment",function(e,t,o){o||(o=n);var s=this,a=s.getModeAt(e),l=o.blockCommentStart||a.blockCommentStart,c=o.blockCommentEnd||a.blockCommentEnd;if(!l||!c)return(o.lineComment||a.lineComment)&&0!=o.fullLines&&s.lineComment(e,t,o),void 0;var d=Math.min(t.line,s.lastLine());d!=e.line&&0==t.ch&&r.test(s.getLine(d))&&--d;var h=null==o.padding?" ":o.padding;e.line>d||s.operation(function(){if(0!=o.fullLines){var n=r.test(s.getLine(d));s.replaceRange(h+c,i(d)),s.replaceRange(l+h,i(e.line,0));var u=o.blockCommentLead||a.blockCommentLead;if(null!=u)for(var f=e.line+1;d>=f;++f)(f!=d||n)&&s.replaceRange(u+h,i(f,0))}else s.replaceRange(c,t),s.replaceRange(l,e)})}),e.defineExtension("uncomment",function(e,t,o){o||(o=n);var s,a=this,l=a.getModeAt(e),c=Math.min(t.line,a.lastLine()),d=Math.min(e.line,c),h=o.lineComment||l.lineComment,u=[],f=null==o.padding?" ":o.padding;e:if(h){for(var p=d;c>=p;++p){var g=a.getLine(p),m=g.indexOf(h);if(m>-1&&!/comment/.test(a.getTokenTypeAt(i(p,m+1)))&&(m=-1),-1==m&&(p!=c||p==d)&&r.test(g))break e;if(m>-1&&r.test(g.slice(0,m)))break e;u.push(g)}if(a.operation(function(){for(var e=d;c>=e;++e){var t=u[e-d],n=t.indexOf(h),r=n+h.length;0>n||(t.slice(r,r+f.length)==f&&(r+=f.length),s=!0,a.replaceRange("",i(e,n),i(e,r)))}}),s)return!0}var v=o.blockCommentStart||l.blockCommentStart,y=o.blockCommentEnd||l.blockCommentEnd;if(!v||!y)return!1;var _=o.blockCommentLead||l.blockCommentLead,b=a.getLine(d),x=c==d?b:a.getLine(c),C=b.indexOf(v),w=x.lastIndexOf(y);if(-1==w&&d!=c&&(x=a.getLine(--c),w=x.lastIndexOf(y)),-1==C||-1==w||!/comment/.test(a.getTokenTypeAt(i(d,C+1)))||!/comment/.test(a.getTokenTypeAt(i(c,w+1))))return!1;var k=b.lastIndexOf(v,e.ch),S=-1==k?-1:b.slice(0,e.ch).indexOf(y,k+v.length);if(-1!=k&&-1!=S)return!1;S=x.indexOf(y,t.ch);var T=x.slice(t.ch).lastIndexOf(v,S-t.ch);return k=-1==S||-1==T?-1:t.ch+T,-1!=S&&-1!=k?!1:(a.operation(function(){a.replaceRange("",i(c,w-(f&&x.slice(w-f.length,w)==f?f.length:0)),i(c,w+y.length));var e=C+v.length;if(f&&b.slice(e,e+f.length)==f&&(e+=f.length),a.replaceRange("",i(d,C),i(d,e)),_)for(var t=d+1;c>=t;++t){var n=a.getLine(t),o=n.indexOf(_);if(-1!=o&&!r.test(n.slice(0,o))){var s=o+_.length;f&&n.slice(s,s+f.length)==f&&(s+=f.length),a.replaceRange("",i(t,o),i(t,s))}}}),!0)})}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function t(e,t){var n=e.getRange(l(t.line,t.ch-1),l(t.line,t.ch+1));return 2==n.length?n:null}function n(t,n,r){var i=t.getLine(n.line),o=t.getTokenAt(n);if(/\bstring2?\b/.test(o.type))return!1;var s=new e.StringStream(i.slice(0,n.ch)+r+i.slice(n.ch),4);for(s.pos=s.start=o.start;;){var a=t.getMode().token(s,o.state);if(s.pos>=n.ch+1)return/\bstring2?\b/.test(a);s.start=s.pos}}function r(r){for(var i={name:"autoCloseBrackets",Backspace:function(n){if(n.getOption("disableInput"))return e.Pass;for(var i=n.listSelections(),o=0;o<i.length;o++){if(!i[o].empty())return e.Pass;var s=t(n,i[o].head);if(!s||r.indexOf(s)%2!=0)return e.Pass}for(var o=i.length-1;o>=0;o--){var a=i[o].head;n.replaceRange("",l(a.line,a.ch-1),l(a.line,a.ch+1))}}},o="",s=0;s<r.length;s+=2)(function(t,r){t!=r&&(o+=r),i["'"+t+"'"]=function(i){if(i.getOption("disableInput"))return e.Pass;for(var s,c,d=i.listSelections(),h=0;h<d.length;h++){var u,f=d[h],p=f.head,c=i.getRange(p,l(p.line,p.ch+1));if(f.empty())if(t==r&&c==r)u=i.getRange(p,l(p.line,p.ch+3))==t+t+t?"skipThree":"skip";else if(t==r&&p.ch>1&&i.getRange(l(p.line,p.ch-2),p)==t+t&&(p.ch<=2||i.getRange(l(p.line,p.ch-3),l(p.line,p.ch-2))!=t))u="addFour";else if('"'==t||"'"==t){if(e.isWordChar(c)||!n(i,p,t))return e.Pass;u="both"}else{if(!(i.getLine(p.line).length==p.ch||o.indexOf(c)>=0||a.test(c)))return e.Pass;u="both"}else u="surround";if(s){if(s!=u)return e.Pass}else s=u}i.operation(function(){if("skip"==s)i.execCommand("goCharRight");else if("skipThree"==s)for(var e=0;3>e;e++)i.execCommand("goCharRight");else if("surround"==s){for(var n=i.getSelections(),e=0;e<n.length;e++)n[e]=t+n[e]+r;i.replaceSelections(n,"around")}else"both"==s?(i.replaceSelection(t+r,null),i.execCommand("goCharLeft")):"addFour"==s&&(i.replaceSelection(t+t+t+t,"before"),i.execCommand("goCharRight"))})},t!=r&&(i["'"+r+"'"]=function(t){for(var n=t.listSelections(),i=0;i<n.length;i++){var o=n[i];if(!o.empty()||t.getRange(o.head,l(o.head.line,o.head.ch+1))!=r)return e.Pass}t.execCommand("goCharRight")})})(r.charAt(s),r.charAt(s+1));return i}function i(n){return function(r){if(r.getOption("disableInput"))return e.Pass;for(var i=r.listSelections(),o=0;o<i.length;o++){if(!i[o].empty())return e.Pass;var s=t(r,i[o].head);if(!s||n.indexOf(s)%2!=0)return e.Pass}r.operation(function(){r.replaceSelection("\n\n",null),r.execCommand("goCharLeft"),i=r.listSelections();for(var e=0;e<i.length;e++){var t=i[e].head.line;r.indentLine(t,null,!0),r.indentLine(t+1,null,!0)}})}}var o="()[]{}''\"\"",s="[]{}",a=/\s/,l=e.Pos;e.defineOption("autoCloseBrackets",!1,function(t,n,a){if(a!=e.Init&&a&&t.removeKeyMap("autoCloseBrackets"),n){var l=o,c=s;"string"==typeof n?l=n:"object"==typeof n&&(null!=n.pairs&&(l=n.pairs),null!=n.explode&&(c=n.explode));var d=r(l);c&&(d.Enter=i(c)),t.addKeyMap(d)}})}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function t(e,t,r,i){var o=e.getLineHandle(t.line),l=t.ch-1,c=l>=0&&a[o.text.charAt(l)]||a[o.text.charAt(++l)];if(!c)return null;var d=">"==c.charAt(1)?1:-1;if(r&&d>0!=(l==t.ch))return null;var h=e.getTokenTypeAt(s(t.line,l+1)),u=n(e,s(t.line,l+(d>0?1:0)),d,h||null,i);return null==u?null:{from:s(t.line,l),to:u&&u.pos,match:u&&u.ch==c.charAt(0),forward:d>0}}function n(e,t,n,r,i){for(var o=i&&i.maxScanLineLength||1e4,l=i&&i.maxScanLines||1e3,c=[],d=i&&i.bracketRegex?i.bracketRegex:/[(){}[\]]/,h=n>0?Math.min(t.line+l,e.lastLine()+1):Math.max(e.firstLine()-1,t.line-l),u=t.line;u!=h;u+=n){var f=e.getLine(u);if(f){var p=n>0?0:f.length-1,g=n>0?f.length:-1;if(!(f.length>o))for(u==t.line&&(p=t.ch-(0>n?1:0));p!=g;p+=n){var m=f.charAt(p);if(d.test(m)&&(void 0===r||e.getTokenTypeAt(s(u,p+1))==r)){var v=a[m];if(">"==v.charAt(1)==n>0)c.push(m);else{if(!c.length)return{pos:s(u,p),ch:m};c.pop()}}}}}return u-n==(n>0?e.lastLine():e.firstLine())?!1:null}function r(e,n,r){for(var i=e.state.matchBrackets.maxHighlightLineLength||1e3,a=[],l=e.listSelections(),c=0;c<l.length;c++){var d=l[c].empty()&&t(e,l[c].head,!1,r);if(d&&e.getLine(d.from.line).length<=i){var h=d.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";a.push(e.markText(d.from,s(d.from.line,d.from.ch+1),{className:h})),d.to&&e.getLine(d.to.line).length<=i&&a.push(e.markText(d.to,s(d.to.line,d.to.ch+1),{className:h}))}}if(a.length){o&&e.state.focused&&e.display.input.focus();var u=function(){e.operation(function(){for(var e=0;e<a.length;e++)a[e].clear()})};if(!n)return u;setTimeout(u,800)}}function i(e){e.operation(function(){l&&(l(),l=null),l=r(e,!1,e.state.matchBrackets)})}var o=/MSIE \d/.test(navigator.userAgent)&&(null==document.documentMode||document.documentMode<8),s=e.Pos,a={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"},l=null;e.defineOption("matchBrackets",!1,function(t,n,r){r&&r!=e.Init&&t.off("cursorActivity",i),n&&(t.state.matchBrackets="object"==typeof n?n:{},t.on("cursorActivity",i))}),e.defineExtension("matchBrackets",function(){r(this,!0)}),e.defineExtension("findMatchingBracket",function(e,n,r){return t(this,e,n,r)}),e.defineExtension("scanForBracket",function(e,t,r,i){return n(this,e,t,r,i)})}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.runMode=function(t,n,r,i){var o=e.getMode(e.defaults,n),s=/MSIE \d/.test(navigator.userAgent),a=s&&(null==document.documentMode||document.documentMode<9);if(1==r.nodeType){var l=i&&i.tabSize||e.defaults.tabSize,c=r,d=0;c.innerHTML="",r=function(e,t){if("\n"==e)return c.appendChild(document.createTextNode(a?"\r":e)),d=0,void 0;for(var n="",r=0;;){var i=e.indexOf("	",r);if(-1==i){n+=e.slice(r),d+=e.length-r;break}d+=i-r,n+=e.slice(r,i);var o=l-d%l;d+=o;for(var s=0;o>s;++s)n+=" ";r=i+1}if(t){var h=c.appendChild(document.createElement("span"));h.className="cm-"+t.replace(/ +/g," cm-"),h.appendChild(document.createTextNode(n))}else c.appendChild(document.createTextNode(n))}}for(var h=e.splitLines(t),u=i&&i.state||e.startState(o),f=0,p=h.length;p>f;++f){f&&r("\n");var g=new e.StringStream(h[f]);for(!g.string&&o.blankLine&&o.blankLine(u);!g.eol();){var m=o.token(g,u);r(g.current(),m,f,g.start,u),g.start=g.pos}}}}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e,t){this.cm=e,this.options=this.buildOptions(t),this.widget=this.onClose=null}function n(e){return"string"==typeof e?e:e.text}function r(e,t){function n(e,n){var i;i="string"!=typeof n?function(e){return n(e,t)}:r.hasOwnProperty(n)?r[n]:n,o[e]=i}var r={Up:function(){t.moveFocus(-1)},Down:function(){t.moveFocus(1)},PageUp:function(){t.moveFocus(-t.menuSize()+1,!0)},PageDown:function(){t.moveFocus(t.menuSize()-1,!0)},Home:function(){t.setFocus(0)},End:function(){t.setFocus(t.length-1)},Enter:t.pick,Tab:t.pick,Esc:t.close},i=e.options.customKeys,o=i?{}:r;if(i)for(var s in i)i.hasOwnProperty(s)&&n(s,i[s]);var a=e.options.extraKeys;if(a)for(var s in a)a.hasOwnProperty(s)&&n(s,a[s]);return o}function i(e,t){for(;t&&t!=e;){if("LI"===t.nodeName.toUpperCase()&&t.parentNode==e)return t;t=t.parentNode}}function o(t,o){this.completion=t,this.data=o;var l=this,c=t.cm,d=this.hints=document.createElement("ul");d.className="CodeMirror-hints",this.selectedHint=o.selectedHint||0;for(var h=o.list,u=0;u<h.length;++u){var f=d.appendChild(document.createElement("li")),p=h[u],g=s+(u!=this.selectedHint?"":" "+a);null!=p.className&&(g=p.className+" "+g),f.className=g,p.render?p.render(f,o,p):f.appendChild(document.createTextNode(p.displayText||n(p))),f.hintId=u}var m=c.cursorCoords(t.options.alignWithWord?o.from:null),v=m.left,y=m.bottom,_=!0;d.style.left=v+"px",d.style.top=y+"px";var b=window.innerWidth||Math.max(document.body.offsetWidth,document.documentElement.offsetWidth),x=window.innerHeight||Math.max(document.body.offsetHeight,document.documentElement.offsetHeight);(t.options.container||document.body).appendChild(d);var C=d.getBoundingClientRect(),w=C.bottom-x;if(w>0){var k=C.bottom-C.top,S=m.top-(m.bottom-C.top);if(S-k>0)d.style.top=(y=m.top-k)+"px",_=!1;else if(k>x){d.style.height=x-5+"px",d.style.top=(y=m.bottom-C.top)+"px";var T=c.getCursor();o.from.ch!=T.ch&&(m=c.cursorCoords(T),d.style.left=(v=m.left)+"px",C=d.getBoundingClientRect())}}var L=C.left-b;if(L>0&&(C.right-C.left>b&&(d.style.width=b-5+"px",L-=C.right-C.left-b),d.style.left=(v=m.left-L)+"px"),c.addKeyMap(this.keyMap=r(t,{moveFocus:function(e,t){l.changeActive(l.selectedHint+e,t)},setFocus:function(e){l.changeActive(e)},menuSize:function(){return l.screenAmount()},length:h.length,close:function(){t.close()},pick:function(){l.pick()},data:o})),t.options.closeOnUnfocus){var j;c.on("blur",this.onBlur=function(){j=setTimeout(function(){t.close()},100)}),c.on("focus",this.onFocus=function(){clearTimeout(j)})}var M=c.getScrollInfo();return c.on("scroll",this.onScroll=function(){var e=c.getScrollInfo(),n=c.getWrapperElement().getBoundingClientRect(),r=y+M.top-e.top,i=r-(window.pageYOffset||(document.documentElement||document.body).scrollTop);return _||(i+=d.offsetHeight),i<=n.top||i>=n.bottom?t.close():(d.style.top=r+"px",d.style.left=v+M.left-e.left+"px",void 0)}),e.on(d,"dblclick",function(e){var t=i(d,e.target||e.srcElement);t&&null!=t.hintId&&(l.changeActive(t.hintId),l.pick())}),e.on(d,"click",function(e){var n=i(d,e.target||e.srcElement);n&&null!=n.hintId&&(l.changeActive(n.hintId),t.options.completeOnSingleClick&&l.pick())}),e.on(d,"mousedown",function(){setTimeout(function(){c.focus()},20)}),e.signal(o,"select",h[0],d.firstChild),!0}var s="CodeMirror-hint",a="CodeMirror-hint-active";e.showHint=function(e,t,n){if(!t)return e.showHint(n);n&&n.async&&(t.async=!0);var r={hint:t};if(n)for(var i in n)r[i]=n[i];return e.showHint(r)},e.defineExtension("showHint",function(n){if(!(this.listSelections().length>1||this.somethingSelected())){this.state.completionActive&&this.state.completionActive.close();var r=this.state.completionActive=new t(this,n),i=r.options.hint;if(i)return e.signal(this,"startCompletion",this),i.async?(i(this,function(e){r.showHints(e)},r.options),void 0):r.showHints(i(this,r.options))}}),t.prototype={close:function(){this.active()&&(this.cm.state.completionActive=null,this.widget&&this.widget.close(),this.onClose&&this.onClose(),e.signal(this.cm,"endCompletion",this.cm))},active:function(){return this.cm.state.completionActive==this},pick:function(t,r){var i=t.list[r];i.hint?i.hint(this.cm,t,i):this.cm.replaceRange(n(i),i.from||t.from,i.to||t.to,"complete"),e.signal(t,"pick",i),this.close()},showHints:function(e){return e&&e.list.length&&this.active()?(this.options.completeSingle&&1==e.list.length?this.pick(e,0):this.showWidget(e),void 0):this.close()},showWidget:function(t){function n(){l||(l=!0,d.close(),d.cm.off("cursorActivity",a),t&&e.signal(t,"close"))}function r(){if(!l){e.signal(t,"update");var n=d.options.hint;n.async?n(d.cm,i,d.options):i(n(d.cm,d.options))}}function i(e){if(t=e,!l){if(!t||!t.list.length)return n();d.widget&&d.widget.close(),d.widget=new o(d,t)}}function s(){c&&(g(c),c=0)}function a(){s();var e=d.cm.getCursor(),t=d.cm.getLine(e.line);e.line!=u.line||t.length-e.ch!=f-u.ch||e.ch<u.ch||d.cm.somethingSelected()||e.ch&&h.test(t.charAt(e.ch-1))?d.close():(c=p(r),d.widget&&d.widget.close())}this.widget=new o(this,t),e.signal(t,"shown");var l,c=0,d=this,h=this.options.closeCharacters,u=this.cm.getCursor(),f=this.cm.getLine(u.line).length,p=window.requestAnimationFrame||function(e){return setTimeout(e,1e3/60)},g=window.cancelAnimationFrame||clearTimeout;this.cm.on("cursorActivity",a),this.onClose=n},buildOptions:function(e){var t=this.cm.options.hintOptions,n={};for(var r in l)n[r]=l[r];if(t)for(var r in t)void 0!==t[r]&&(n[r]=t[r]);if(e)for(var r in e)void 0!==e[r]&&(n[r]=e[r]);return n}},o.prototype={close:function(){if(this.completion.widget==this){this.completion.widget=null,this.hints.parentNode.removeChild(this.hints),this.completion.cm.removeKeyMap(this.keyMap);var e=this.completion.cm;this.completion.options.closeOnUnfocus&&(e.off("blur",this.onBlur),e.off("focus",this.onFocus)),e.off("scroll",this.onScroll)}},pick:function(){this.completion.pick(this.data,this.selectedHint)},changeActive:function(t,n){if(t>=this.data.list.length?t=n?this.data.list.length-1:0:0>t&&(t=n?0:this.data.list.length-1),this.selectedHint!=t){var r=this.hints.childNodes[this.selectedHint];r.className=r.className.replace(" "+a,""),r=this.hints.childNodes[this.selectedHint=t],r.className+=" "+a,r.offsetTop<this.hints.scrollTop?this.hints.scrollTop=r.offsetTop-3:r.offsetTop+r.offsetHeight>this.hints.scrollTop+this.hints.clientHeight&&(this.hints.scrollTop=r.offsetTop+r.offsetHeight-this.hints.clientHeight+3),e.signal(this.data,"select",this.data.list[this.selectedHint],r)}},screenAmount:function(){return Math.floor(this.hints.clientHeight/this.hints.firstChild.offsetHeight)||1}},e.registerHelper("hint","auto",function(t,n){var r,i=t.getHelpers(t.getCursor(),"hint");if(i.length)for(var o=0;o<i.length;o++){var s=i[o](t,n);if(s&&s.list.length)return s}else if(r=t.getHelper(t.getCursor(),"hintWords")){if(r)return e.hint.fromList(t,{words:r})}else if(e.hint.anyword)return e.hint.anyword(t,n)}),e.registerHelper("hint","fromList",function(t,n){for(var r=t.getCursor(),i=t.getTokenAt(r),o=[],s=0;s<n.words.length;s++){var a=n.words[s];a.slice(0,i.string.length)==i.string&&o.push(a)}return o.length?{list:o,from:e.Pos(r.line,i.start),to:e.Pos(r.line,i.end)}:void 0}),e.commands.autocomplete=e.showHint;var l={hint:e.hint.auto,completeSingle:!0,alignWithWord:!0,closeCharacters:/[\s()\[\]{};:>,]/,closeOnUnfocus:!0,completeOnSingleClick:!1,container:null,customKeys:null,extraKeys:null};e.defineOption("hintOptions",null)}),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?e(require("jquery")):e(jQuery)}(function(e,t){"use strict";if(!e.jstree){var n,r,i=0,o=!1,s=!1,a=!1,l=[],c=e("script:last").attr("src"),d=document,h=d.createElement("LI");h.setAttribute("role","treeitem"),n=d.createElement("I"),n.className="jstree-icon jstree-ocl",h.appendChild(n),n=d.createElement("A"),n.className="jstree-anchor",n.setAttribute("href","#"),r=d.createElement("I"),r.className="jstree-icon jstree-themeicon",n.appendChild(r),h.appendChild(n),n=r=null,e.jstree={version:"3.0.2",defaults:{plugins:[]},plugins:{},path:c&&-1!==c.indexOf("/")?c.replace(/\/[^\/]+$/,""):"",idregex:/[\\:&!^|()\[\]<>@*'+~#";.,=\- \/${}]/g},e.jstree.create=function(t,n){var r=new e.jstree.core(++i),o=n;return n=e.extend(!0,{},e.jstree.defaults,n),o&&o.plugins&&(n.plugins=o.plugins),e.each(n.plugins,function(e,t){"core"!==e&&(r=r.plugin(t,n[t]))}),r.init(t,n),r},e.jstree.core=function(e){this._id=e,this._cnt=0,this._wrk=null,this._data={core:{themes:{name:!1,dots:!1,icons:!1},selected:[],last_error:{}}}},e.jstree.reference=function(n){var r=null,i=null;if(n&&n.id&&(n=n.id),!i||!i.length)try{i=e(n)}catch(o){}if(!i||!i.length)try{i=e("#"+n.replace(e.jstree.idregex,"\\$&"))}catch(o){}return i&&i.length&&(i=i.closest(".jstree")).length&&(i=i.data("jstree"))?r=i:e(".jstree").each(function(){var i=e(this).data("jstree");return i&&i._model.data[n]?(r=i,!1):t}),r},e.fn.jstree=function(n){var r="string"==typeof n,i=Array.prototype.slice.call(arguments,1),o=null;return this.each(function(){var s=e.jstree.reference(this),a=r&&s?s[n]:null;return o=r&&a?a.apply(s,i):null,s||r||n!==t&&!e.isPlainObject(n)||e(this).data("jstree",new e.jstree.create(this,n)),(s&&!r||n===!0)&&(o=s||!1),null!==o&&o!==t?!1:t}),null!==o&&o!==t?o:this},e.expr[":"].jstree=e.expr.createPseudo(function(){return function(n){return e(n).hasClass("jstree")&&e(n).data("jstree")!==t}}),e.jstree.defaults.core={data:!1,strings:!1,check_callback:!1,error:e.noop,animation:200,multiple:!0,themes:{name:!1,url:!1,dir:!1,dots:!0,icons:!0,stripes:!1,variant:!1,responsive:!1},expand_selected_onload:!0,worker:!0},e.jstree.core.prototype={plugin:function(t,n){var r=e.jstree.plugins[t];return r?(this._data[t]={},r.prototype=this,new r(n,this)):this},init:function(t,n){this._model={data:{"#":{id:"#",parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}}},changed:[],force_full_redraw:!1,redraw_timeout:!1,default_state:{loaded:!0,opened:!1,selected:!1,disabled:!1}},this.element=e(t).addClass("jstree jstree-"+this._id),this.settings=n,this.element.bind("destroyed",e.proxy(this.teardown,this)),this._data.core.ready=!1,this._data.core.loaded=!1,this._data.core.rtl="rtl"===this.element.css("direction"),this.element[this._data.core.rtl?"addClass":"removeClass"]("jstree-rtl"),this.element.attr("role","tree"),this.bind(),this.trigger("init"),this._data.core.original_container_html=this.element.find(" > ul > li").clone(!0),this._data.core.original_container_html.find("li").addBack().contents().filter(function(){return 3===this.nodeType&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove(),this.element.html("<ul class='jstree-container-ul jstree-children'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this._data.core.li_height=this.get_container_ul().children("li:eq(0)").height()||24,this.trigger("loading"),this.load_node("#")},destroy:function(e){e||this.element.empty(),this.element.unbind("destroyed",this.teardown),this.teardown()},teardown:function(){this.unbind(),this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/gi,"")}),this.element=null},bind:function(){this.element.on("dblclick.jstree",function(){if(document.selection&&document.selection.empty)document.selection.empty();else if(window.getSelection){var e=window.getSelection();try{e.removeAllRanges(),e.collapse()}catch(t){}}}).on("click.jstree",".jstree-ocl",e.proxy(function(e){this.toggle_node(e.target)},this)).on("click.jstree",".jstree-anchor",e.proxy(function(t){t.preventDefault(),e(t.currentTarget).focus(),this.activate_node(t.currentTarget,t)},this)).on("keydown.jstree",".jstree-anchor",e.proxy(function(t){if("INPUT"===t.target.tagName)return!0;var n=null;switch(t.which){case 13:case 32:t.type="click",e(t.currentTarget).trigger(t);break;case 37:t.preventDefault(),this.is_open(t.currentTarget)?this.close_node(t.currentTarget):(n=this.get_prev_dom(t.currentTarget),n&&n.length&&n.children(".jstree-anchor").focus());break;case 38:t.preventDefault(),n=this.get_prev_dom(t.currentTarget),n&&n.length&&n.children(".jstree-anchor").focus();break;case 39:t.preventDefault(),this.is_closed(t.currentTarget)?this.open_node(t.currentTarget,function(e){this.get_node(e,!0).children(".jstree-anchor").focus()}):(n=this.get_next_dom(t.currentTarget),n&&n.length&&n.children(".jstree-anchor").focus());break;case 40:t.preventDefault(),n=this.get_next_dom(t.currentTarget),n&&n.length&&n.children(".jstree-anchor").focus();break;case 46:t.preventDefault(),n=this.get_node(t.currentTarget),n&&n.id&&"#"!==n.id&&(n=this.is_selected(n)?this.get_selected():n);break;case 113:t.preventDefault(),n=this.get_node(t.currentTarget)}},this)).on("load_node.jstree",e.proxy(function(t,n){if(n.status&&("#"!==n.node.id||this._data.core.loaded||(this._data.core.loaded=!0,this.trigger("loaded")),!this._data.core.ready&&!this.get_container_ul().find(".jstree-loading:eq(0)").length)){if(this._data.core.ready=!0,this._data.core.selected.length){if(this.settings.core.expand_selected_onload){var r,i,o=[];for(r=0,i=this._data.core.selected.length;i>r;r++)o=o.concat(this._model.data[this._data.core.selected[r]].parents);for(o=e.vakata.array_unique(o),r=0,i=o.length;i>r;r++)this.open_node(o[r],!1,0)}this.trigger("changed",{action:"ready",selected:this._data.core.selected})}setTimeout(e.proxy(function(){this.trigger("ready")},this),0)}},this)).on("init.jstree",e.proxy(function(){var e=this.settings.core.themes;this._data.core.themes.dots=e.dots,this._data.core.themes.stripes=e.stripes,this._data.core.themes.icons=e.icons,this.set_theme(e.name||"default",e.url),this.set_theme_variant(e.variant)},this)).on("loading.jstree",e.proxy(function(){this[this._data.core.themes.dots?"show_dots":"hide_dots"](),this[this._data.core.themes.icons?"show_icons":"hide_icons"](),this[this._data.core.themes.stripes?"show_stripes":"hide_stripes"]()},this)).on("blur.jstree",".jstree-anchor",e.proxy(function(t){e(t.currentTarget).filter(".jstree-hovered").mouseleave()},this)).on("focus.jstree",".jstree-anchor",e.proxy(function(t){this.element.find(".jstree-hovered").not(t.currentTarget).mouseleave(),e(t.currentTarget).mouseenter()},this)).on("mouseenter.jstree",".jstree-anchor",e.proxy(function(e){this.hover_node(e.currentTarget)},this)).on("mouseleave.jstree",".jstree-anchor",e.proxy(function(e){this.dehover_node(e.currentTarget)},this))},unbind:function(){this.element.off(".jstree"),e(document).off(".jstree-"+this._id)},trigger:function(e,t){t||(t={}),t.instance=this,this.element.triggerHandler(e.replace(".jstree","")+".jstree",t)},get_container:function(){return this.element},get_container_ul:function(){return this.element.children(".jstree-children:eq(0)")},get_string:function(t){var n=this.settings.core.strings;return e.isFunction(n)?n.call(this,t):n&&n[t]?n[t]:t},_firstChild:function(e){for(e=e?e.firstChild:null;null!==e&&1!==e.nodeType;)e=e.nextSibling;return e},_nextSibling:function(e){for(e=e?e.nextSibling:null;null!==e&&1!==e.nodeType;)e=e.nextSibling;return e},_previousSibling:function(e){for(e=e?e.previousSibling:null;null!==e&&1!==e.nodeType;)e=e.previousSibling;return e},get_node:function(t,n){t&&t.id&&(t=t.id);var r;try{if(this._model.data[t])t=this._model.data[t];else if(((r=e(t,this.element)).length||(r=e("#"+t.replace(e.jstree.idregex,"\\$&"),this.element)).length)&&this._model.data[r.closest(".jstree-node").attr("id")])t=this._model.data[r.closest(".jstree-node").attr("id")];else{if(!(r=e(t,this.element)).length||!r.hasClass("jstree"))return!1;t=this._model.data["#"]}return n&&(t="#"===t.id?this.element:e("#"+t.id.replace(e.jstree.idregex,"\\$&"),this.element)),t}catch(i){return!1}},get_path:function(e,t,n){if(e=e.parents?e:this.get_node(e),!e||"#"===e.id||!e.parents)return!1;var r,i,o=[];for(o.push(n?e.id:e.text),r=0,i=e.parents.length;i>r;r++)o.push(n?e.parents[r]:this.get_text(e.parents[r]));return o=o.reverse().slice(1),t?o.join(t):o},get_next_dom:function(t,n){var r;return t=this.get_node(t,!0),t[0]===this.element[0]?(r=this._firstChild(this.get_container_ul()[0]),r?e(r):!1):t&&t.length?n?(r=this._nextSibling(t[0]),r?e(r):!1):t.hasClass("jstree-open")?(r=this._firstChild(t.children(".jstree-children")[0]),r?e(r):!1):null!==(r=this._nextSibling(t[0]))?e(r):t.parentsUntil(".jstree",".jstree-node").next(".jstree-node").eq(0):!1},get_prev_dom:function(t,n){var r;if(t=this.get_node(t,!0),t[0]===this.element[0])return r=this.get_container_ul()[0].lastChild,r?e(r):!1;if(!t||!t.length)return!1;if(n)return r=this._previousSibling(t[0]),r?e(r):!1;if(null!==(r=this._previousSibling(t[0]))){for(t=e(r);t.hasClass("jstree-open");)t=t.children(".jstree-children:eq(0)").children(".jstree-node:last");return t}return r=t[0].parentNode.parentNode,r&&r.className&&-1!==r.className.indexOf("jstree-node")?e(r):!1},get_parent:function(e){return e=this.get_node(e),e&&"#"!==e.id?e.parent:!1},get_children_dom:function(e){return e=this.get_node(e,!0),e[0]===this.element[0]?this.get_container_ul().children(".jstree-node"):e&&e.length?e.children(".jstree-children").children(".jstree-node"):!1},is_parent:function(e){return e=this.get_node(e),e&&(e.state.loaded===!1||e.children.length>0)},is_loaded:function(e){return e=this.get_node(e),e&&e.state.loaded},is_loading:function(e){return e=this.get_node(e),e&&e.state&&e.state.loading},is_open:function(e){return e=this.get_node(e),e&&e.state.opened},is_closed:function(e){return e=this.get_node(e),e&&this.is_parent(e)&&!e.state.opened},is_leaf:function(e){return!this.is_parent(e)},load_node:function(t,n){var r,i,o,s,a;if(e.isArray(t))return this._load_nodes(t.slice(),n),!0;if(t=this.get_node(t),!t)return n&&n.call(this,t,!1),!1;if(t.state.loaded){for(t.state.loaded=!1,r=0,i=t.children_d.length;i>r;r++){for(o=0,s=t.parents.length;s>o;o++)this._model.data[t.parents[o]].children_d=e.vakata.array_remove_item(this._model.data[t.parents[o]].children_d,t.children_d[r]);this._model.data[t.children_d[r]].state.selected&&(a=!0,this._data.core.selected=e.vakata.array_remove_item(this._data.core.selected,t.children_d[r])),delete this._model.data[t.children_d[r]]}t.children=[],t.children_d=[],a&&this.trigger("changed",{action:"load_node",node:t,selected:this._data.core.selected})}return t.state.loading=!0,this.get_node(t,!0).addClass("jstree-loading"),this._load_node(t,e.proxy(function(e){t=this._model.data[t.id],t.state.loading=!1,t.state.loaded=e;var r=this.get_node(t,!0);t.state.loaded&&!t.children.length&&r&&r.length&&!r.hasClass("jstree-leaf")&&r.removeClass("jstree-closed jstree-open").addClass("jstree-leaf"),r.removeClass("jstree-loading"),this.trigger("load_node",{node:t,status:e}),n&&n.call(this,t,e)},this)),!0},_load_nodes:function(e,t,n){var r,i,o=!0,s=function(){this._load_nodes(e,t,!0)},a=this._model.data;for(r=0,i=e.length;i>r;r++)!a[e[r]]||a[e[r]].state.loaded&&n||(this.is_loading(e[r])||this.load_node(e[r],s),o=!1);o&&(t.done||(t.call(this,e),t.done=!0))},_load_node:function(t,n){var r,i=this.settings.core.data;return i?e.isFunction(i)?i.call(this,t,e.proxy(function(r){r===!1&&n.call(this,!1),this["string"==typeof r?"_append_html_data":"_append_json_data"](t,"string"==typeof r?e(r):r,function(e){n.call(this,e)})},this)):"object"==typeof i?i.url?(i=e.extend(!0,{},i),e.isFunction(i.url)&&(i.url=i.url.call(this,t)),e.isFunction(i.data)&&(i.data=i.data.call(this,t)),e.ajax(i).done(e.proxy(function(r,i,o){var s=o.getResponseHeader("Content-Type");return-1!==s.indexOf("json")||"object"==typeof r?this._append_json_data(t,r,function(e){n.call(this,e)}):-1!==s.indexOf("html")||"string"==typeof r?this._append_html_data(t,e(r),function(e){n.call(this,e)}):(this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:t.id,xhr:o})},this.settings.core.error.call(this,this._data.core.last_error),n.call(this,!1))},this)).fail(e.proxy(function(e){n.call(this,!1),this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:t.id,xhr:e})},this.settings.core.error.call(this,this._data.core.last_error)},this))):(r=e.isArray(i)||e.isPlainObject(i)?JSON.parse(JSON.stringify(i)):i,"#"===t.id?this._append_json_data(t,r,function(e){n.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_05",reason:"Could not load node",data:JSON.stringify({id:t.id})},this.settings.core.error.call(this,this._data.core.last_error),n.call(this,!1))):"string"==typeof i?"#"===t.id?this._append_html_data(t,e(i),function(e){n.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_06",reason:"Could not load node",data:JSON.stringify({id:t.id})},this.settings.core.error.call(this,this._data.core.last_error),n.call(this,!1)):n.call(this,!1):"#"===t.id?this._append_html_data(t,this._data.core.original_container_html.clone(!0),function(e){n.call(this,e)}):n.call(this,!1)},_node_changed:function(e){e=this.get_node(e),e&&this._model.changed.push(e.id)},_append_html_data:function(t,n,r){t=this.get_node(t),t.children=[],t.children_d=[];var i,o,s,a=n.is("ul")?n.children():n,l=t.id,c=[],d=[],h=this._model.data,u=h[l],f=this._data.core.selected.length;for(a.each(e.proxy(function(t,n){i=this._parse_model_from_html(e(n),l,u.parents.concat()),i&&(c.push(i),d.push(i),h[i].children_d.length&&(d=d.concat(h[i].children_d)))},this)),u.children=c,u.children_d=d,o=0,s=u.parents.length;s>o;o++)h[u.parents[o]].children_d=h[u.parents[o]].children_d.concat(d);this.trigger("model",{nodes:d,parent:l}),"#"!==l?(this._node_changed(l),this.redraw()):(this.get_container_ul().children(".jstree-initial-node").remove(),this.redraw(!0)),this._data.core.selected.length!==f&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),r.call(this,!0)},_append_json_data:function(t,n,r){t=this.get_node(t),t.children=[],t.children_d=[],n.d&&(n=n.d,"string"==typeof n&&(n=JSON.parse(n))),e.isArray(n)||(n=[n]);var i=null,o={df:this._model.default_state,dat:n,par:t.id,m:this._model.data,t_id:this._id,t_cnt:this._cnt,sel:this._data.core.selected},s=function(e,t){e.data&&(e=e.data);var n,r,i,o,s=e.dat,a=e.par,l=[],c=[],d=[],h=e.df,u=e.t_id,f=e.t_cnt,p=e.m,g=p[a],m=e.sel,v=function(e,n,r){r=r?r.concat():[],n&&r.unshift(n);var i,o,s,a,l=""+e.id,c={id:l,text:e.text||"",icon:e.icon!==t?e.icon:!0,parent:n,parents:r,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(i in h)h.hasOwnProperty(i)&&(c.state[i]=h[i]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(c.icon=e.data.jstree.icon),e&&e.data&&(c.data=e.data,e.data.jstree))for(i in e.data.jstree)e.data.jstree.hasOwnProperty(i)&&(c.state[i]=e.data.jstree[i]);if(e&&"object"==typeof e.state)for(i in e.state)e.state.hasOwnProperty(i)&&(c.state[i]=e.state[i]);if(e&&"object"==typeof e.li_attr)for(i in e.li_attr)e.li_attr.hasOwnProperty(i)&&(c.li_attr[i]=e.li_attr[i]);if(c.li_attr.id||(c.li_attr.id=l),e&&"object"==typeof e.a_attr)for(i in e.a_attr)e.a_attr.hasOwnProperty(i)&&(c.a_attr[i]=e.a_attr[i]);for(e&&e.children&&e.children===!0&&(c.state.loaded=!1,c.children=[],c.children_d=[]),p[c.id]=c,i=0,o=c.children.length;o>i;i++)s=v(p[c.children[i]],c.id,r),a=p[s],c.children_d.push(s),a.children_d.length&&(c.children_d=c.children_d.concat(a.children_d));return delete e.data,delete e.children,p[c.id].original=e,c.state.selected&&d.push(c.id),c.id},y=function(e,n,r){r=r?r.concat():[],n&&r.unshift(n);var i,o,s,a,l,c=!1;do c="j"+u+"_"+ ++f;while(p[c]);l={id:!1,text:"string"==typeof e?e:"",icon:"object"==typeof e&&e.icon!==t?e.icon:!0,parent:n,parents:r,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(i in h)h.hasOwnProperty(i)&&(l.state[i]=h[i]);if(e&&e.id&&(l.id=""+e.id),e&&e.text&&(l.text=e.text),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(l.icon=e.data.jstree.icon),e&&e.data&&(l.data=e.data,e.data.jstree))for(i in e.data.jstree)e.data.jstree.hasOwnProperty(i)&&(l.state[i]=e.data.jstree[i]);if(e&&"object"==typeof e.state)for(i in e.state)e.state.hasOwnProperty(i)&&(l.state[i]=e.state[i]);if(e&&"object"==typeof e.li_attr)for(i in e.li_attr)e.li_attr.hasOwnProperty(i)&&(l.li_attr[i]=e.li_attr[i]);if(l.li_attr.id&&!l.id&&(l.id=""+l.li_attr.id),l.id||(l.id=c),l.li_attr.id||(l.li_attr.id=l.id),e&&"object"==typeof e.a_attr)for(i in e.a_attr)e.a_attr.hasOwnProperty(i)&&(l.a_attr[i]=e.a_attr[i]);if(e&&e.children&&e.children.length){for(i=0,o=e.children.length;o>i;i++)s=y(e.children[i],l.id,r),a=p[s],l.children.push(s),a.children_d.length&&(l.children_d=l.children_d.concat(a.children_d));l.children_d=l.children_d.concat(l.children)}return e&&e.children&&e.children===!0&&(l.state.loaded=!1,l.children=[],l.children_d=[]),delete e.data,delete e.children,l.original=e,p[l.id]=l,l.state.selected&&d.push(l.id),l.id};if(s.length&&s[0].id!==t&&s[0].parent!==t){for(r=0,i=s.length;i>r;r++)s[r].children||(s[r].children=[]),p[""+s[r].id]=s[r];for(r=0,i=s.length;i>r;r++)p[""+s[r].parent].children.push(""+s[r].id),g.children_d.push(""+s[r].id);for(r=0,i=g.children.length;i>r;r++)n=v(p[g.children[r]],a,g.parents.concat()),c.push(n),p[n].children_d.length&&(c=c.concat(p[n].children_d));o={cnt:f,mod:p,sel:m,par:a,dpc:c,add:d}}else{for(r=0,i=s.length;i>r;r++)n=y(s[r],a,g.parents.concat()),n&&(l.push(n),c.push(n),p[n].children_d.length&&(c=c.concat(p[n].children_d)));for(g.children=l,g.children_d=c,r=0,i=g.parents.length;i>r;r++)p[g.parents[r]].children_d=p[g.parents[r]].children_d.concat(c);o={cnt:f,mod:p,sel:m,par:a,dpc:c,add:d}}return o},a=function(t,n){if(this._cnt=t.cnt,this._model.data=t.mod,n){var i,o,s=t.add,a=t.sel,l=this._data.core.selected.slice(),c=this._model.data;if(a.length!==l.length||e.vakata.array_unique(a.concat(l)).length!==a.length){for(i=0,o=a.length;o>i;i++)-1===e.inArray(a[i],s)&&-1===e.inArray(a[i],l)&&(c[a[i]].state.selected=!1);for(i=0,o=l.length;o>i;i++)-1===e.inArray(l[i],a)&&(c[l[i]].state.selected=!0)}}t.add.length&&(this._data.core.selected=this._data.core.selected.concat(t.add)),this.trigger("model",{nodes:t.dpc,parent:t.par}),"#"!==t.par?(this._node_changed(t.par),this.redraw()):this.redraw(!0),t.add.length&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),r.call(this,!0)};if(this.settings.core.worker&&window.Blob&&window.URL&&window.Worker)try{null===this._wrk&&(this._wrk=window.URL.createObjectURL(new window.Blob(["self.onmessage = "+(""+s).replace(/return ([^;}]+)[\s;}]+$/,"postMessage($1);}")],{type:"text/javascript"}))),i=new window.Worker(this._wrk),i.onmessage=e.proxy(function(e){a.call(this,e.data,!0)},this),i.postMessage(o)}catch(l){a.call(this,s(o),!1)}else a.call(this,s(o),!1)},_parse_model_from_html:function(n,r,i){i=i?[].concat(i):[],r&&i.unshift(r);var o,s,a,l,c,d=this._model.data,h={id:!1,text:!1,icon:!0,parent:r,parents:i,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(a in this._model.default_state)this._model.default_state.hasOwnProperty(a)&&(h.state[a]=this._model.default_state[a]);if(l=e.vakata.attributes(n,!0),e.each(l,function(n,r){return r=e.trim(r),r.length?(h.li_attr[n]=r,"id"===n&&(h.id=""+r),t):!0}),l=n.children("a").eq(0),l.length&&(l=e.vakata.attributes(l,!0),e.each(l,function(t,n){n=e.trim(n),n.length&&(h.a_attr[t]=n)})),l=n.children("a:eq(0)").length?n.children("a:eq(0)").clone():n.clone(),l.children("ins, i, ul").remove(),l=l.html(),l=e("<div />").html(l),h.text=l.html(),l=n.data(),h.data=l?e.extend(!0,{},l):null,h.state.opened=n.hasClass("jstree-open"),h.state.selected=n.children("a").hasClass("jstree-clicked"),h.state.disabled=n.children("a").hasClass("jstree-disabled"),h.data&&h.data.jstree)for(a in h.data.jstree)h.data.jstree.hasOwnProperty(a)&&(h.state[a]=h.data.jstree[a]);l=n.children("a").children(".jstree-themeicon"),l.length&&(h.icon=l.hasClass("jstree-themeicon-hidden")?!1:l.attr("rel")),h.state.icon&&(h.icon=h.state.icon),l=n.children("ul").children("li");do c="j"+this._id+"_"+ ++this._cnt;while(d[c]);return h.id=h.li_attr.id?""+h.li_attr.id:c,l.length?(l.each(e.proxy(function(t,n){o=this._parse_model_from_html(e(n),h.id,i),s=this._model.data[o],h.children.push(o),s.children_d.length&&(h.children_d=h.children_d.concat(s.children_d))},this)),h.children_d=h.children_d.concat(h.children)):n.hasClass("jstree-closed")&&(h.state.loaded=!1),h.li_attr["class"]&&(h.li_attr["class"]=h.li_attr["class"].replace("jstree-closed","").replace("jstree-open","")),h.a_attr["class"]&&(h.a_attr["class"]=h.a_attr["class"].replace("jstree-clicked","").replace("jstree-disabled","")),d[h.id]=h,h.state.selected&&this._data.core.selected.push(h.id),h.id},_parse_model_from_flat_json:function(e,n,r){r=r?r.concat():[],n&&r.unshift(n);var i,o,s,a,l=""+e.id,c=this._model.data,d=this._model.default_state,h={id:l,text:e.text||"",icon:e.icon!==t?e.icon:!0,parent:n,parents:r,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(i in d)d.hasOwnProperty(i)&&(h.state[i]=d[i]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(h.icon=e.data.jstree.icon),e&&e.data&&(h.data=e.data,e.data.jstree))for(i in e.data.jstree)e.data.jstree.hasOwnProperty(i)&&(h.state[i]=e.data.jstree[i]);if(e&&"object"==typeof e.state)for(i in e.state)e.state.hasOwnProperty(i)&&(h.state[i]=e.state[i]);if(e&&"object"==typeof e.li_attr)for(i in e.li_attr)e.li_attr.hasOwnProperty(i)&&(h.li_attr[i]=e.li_attr[i]);if(h.li_attr.id||(h.li_attr.id=l),e&&"object"==typeof e.a_attr)for(i in e.a_attr)e.a_attr.hasOwnProperty(i)&&(h.a_attr[i]=e.a_attr[i]);for(e&&e.children&&e.children===!0&&(h.state.loaded=!1,h.children=[],h.children_d=[]),c[h.id]=h,i=0,o=h.children.length;o>i;i++)s=this._parse_model_from_flat_json(c[h.children[i]],h.id,r),a=c[s],h.children_d.push(s),a.children_d.length&&(h.children_d=h.children_d.concat(a.children_d));return delete e.data,delete e.children,c[h.id].original=e,h.state.selected&&this._data.core.selected.push(h.id),h.id},_parse_model_from_json:function(e,n,r){r=r?r.concat():[],n&&r.unshift(n);var i,o,s,a,l,c=!1,d=this._model.data,h=this._model.default_state;do c="j"+this._id+"_"+ ++this._cnt;while(d[c]);l={id:!1,text:"string"==typeof e?e:"",icon:"object"==typeof e&&e.icon!==t?e.icon:!0,parent:n,parents:r,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(i in h)h.hasOwnProperty(i)&&(l.state[i]=h[i]);if(e&&e.id&&(l.id=""+e.id),e&&e.text&&(l.text=e.text),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(l.icon=e.data.jstree.icon),e&&e.data&&(l.data=e.data,e.data.jstree))for(i in e.data.jstree)e.data.jstree.hasOwnProperty(i)&&(l.state[i]=e.data.jstree[i]);if(e&&"object"==typeof e.state)for(i in e.state)e.state.hasOwnProperty(i)&&(l.state[i]=e.state[i]);if(e&&"object"==typeof e.li_attr)for(i in e.li_attr)e.li_attr.hasOwnProperty(i)&&(l.li_attr[i]=e.li_attr[i]);if(l.li_attr.id&&!l.id&&(l.id=""+l.li_attr.id),l.id||(l.id=c),l.li_attr.id||(l.li_attr.id=l.id),e&&"object"==typeof e.a_attr)for(i in e.a_attr)e.a_attr.hasOwnProperty(i)&&(l.a_attr[i]=e.a_attr[i]);if(e&&e.children&&e.children.length){for(i=0,o=e.children.length;o>i;i++)s=this._parse_model_from_json(e.children[i],l.id,r),a=d[s],l.children.push(s),a.children_d.length&&(l.children_d=l.children_d.concat(a.children_d));l.children_d=l.children_d.concat(l.children)}return e&&e.children&&e.children===!0&&(l.state.loaded=!1,l.children=[],l.children_d=[]),delete e.data,delete e.children,l.original=e,d[l.id]=l,l.state.selected&&this._data.core.selected.push(l.id),l.id},_redraw:function(){var e,t,n,r=this._model.force_full_redraw?this._model.data["#"].children.concat([]):this._model.changed.concat([]),i=document.createElement("UL");for(t=0,n=r.length;n>t;t++)e=this.redraw_node(r[t],!0,this._model.force_full_redraw),e&&this._model.force_full_redraw&&i.appendChild(e);this._model.force_full_redraw&&(i.className=this.get_container_ul()[0].className,this.element.empty().append(i)),this._model.force_full_redraw=!1,this._model.changed=[],this.trigger("redraw",{nodes:r})},redraw:function(e){e&&(this._model.force_full_redraw=!0),this._redraw()},redraw_node:function(t,n,r){var i=this.get_node(t),o=!1,s=!1,a=!1,l=!1,c=!1,d=!1,u="",f=document,p=this._model.data,g=!1,m=!1,v=null;if(!i)return!1;if("#"===i.id)return this.redraw(!0);if(n=n||0===i.children.length,t=document.querySelector?this.element[0].querySelector("#"+(-1!=="0123456789".indexOf(i.id[0])?"\\3"+i.id[0]+" "+i.id.substr(1).replace(e.jstree.idregex,"\\$&"):i.id.replace(e.jstree.idregex,"\\$&"))):document.getElementById(i.id))t=e(t),r||(o=t.parent().parent()[0],o===this.element[0]&&(o=null),s=t.index()),n||!i.children.length||t.children(".jstree-children").length||(n=!0),n||(a=t.children(".jstree-children")[0]),m=t.attr("aria-selected"),g=t.children(".jstree-anchor")[0]===document.activeElement,t.remove();
else if(n=!0,!r){if(o="#"!==i.parent?e("#"+i.parent.replace(e.jstree.idregex,"\\$&"),this.element)[0]:null,!(null===o||o&&p[i.parent].state.opened))return!1;s=e.inArray(i.id,null===o?p["#"].children:p[i.parent].children)}t=h.cloneNode(!0),u="jstree-node ";for(l in i.li_attr)if(i.li_attr.hasOwnProperty(l)){if("id"===l)continue;"class"!==l?t.setAttribute(l,i.li_attr[l]):u+=i.li_attr[l]}m&&"false"!==m&&t.setAttribute("aria-selected",!0),i.state.loaded&&!i.children.length?u+=" jstree-leaf":(u+=i.state.opened&&i.state.loaded?" jstree-open":" jstree-closed",t.setAttribute("aria-expanded",i.state.opened&&i.state.loaded)),null!==i.parent&&p[i.parent].children[p[i.parent].children.length-1]===i.id&&(u+=" jstree-last"),t.id=i.id,t.className=u,u=(i.state.selected?" jstree-clicked":"")+(i.state.disabled?" jstree-disabled":"");for(c in i.a_attr)if(i.a_attr.hasOwnProperty(c)){if("href"===c&&"#"===i.a_attr[c])continue;"class"!==c?t.childNodes[1].setAttribute(c,i.a_attr[c]):u+=" "+i.a_attr[c]}if(u.length&&(t.childNodes[1].className="jstree-anchor "+u),(i.icon&&i.icon!==!0||i.icon===!1)&&(i.icon===!1?t.childNodes[1].childNodes[0].className+=" jstree-themeicon-hidden":-1===i.icon.indexOf("/")&&-1===i.icon.indexOf(".")?t.childNodes[1].childNodes[0].className+=" "+i.icon+" jstree-themeicon-custom":(t.childNodes[1].childNodes[0].style.backgroundImage="url("+i.icon+")",t.childNodes[1].childNodes[0].style.backgroundPosition="center center",t.childNodes[1].childNodes[0].style.backgroundSize="auto",t.childNodes[1].childNodes[0].className+=" jstree-themeicon-custom")),t.childNodes[1].innerHTML+=i.text,n&&i.children.length&&i.state.opened&&i.state.loaded){for(d=f.createElement("UL"),d.setAttribute("role","group"),d.className="jstree-children",l=0,c=i.children.length;c>l;l++)d.appendChild(this.redraw_node(i.children[l],n,!0));t.appendChild(d)}if(a&&t.appendChild(a),!r){for(o||(o=this.element[0]),l=0,c=o.childNodes.length;c>l;l++)if(o.childNodes[l]&&o.childNodes[l].className&&-1!==o.childNodes[l].className.indexOf("jstree-children")){v=o.childNodes[l];break}v||(v=f.createElement("UL"),v.setAttribute("role","group"),v.className="jstree-children",o.appendChild(v)),o=v,o.childNodes.length>s?o.insertBefore(t,o.childNodes[s]):o.appendChild(t),g&&t.childNodes[1].focus()}return i.state.opened&&!i.state.loaded&&(i.state.opened=!1,setTimeout(e.proxy(function(){this.open_node(i.id,!1,0)},this),0)),t},open_node:function(n,r,i){var o,s,a,l;if(e.isArray(n)){for(n=n.slice(),o=0,s=n.length;s>o;o++)this.open_node(n[o],r,i);return!0}if(n=this.get_node(n),!n||"#"===n.id)return!1;if(i=i===t?this.settings.core.animation:i,!this.is_closed(n))return r&&r.call(this,n,!1),!1;if(this.is_loaded(n))a=this.get_node(n,!0),l=this,a.length&&(n.children.length&&!this._firstChild(a.children(".jstree-children")[0])&&(n.state.opened=!0,this.redraw_node(n,!0),a=this.get_node(n,!0)),i?(this.trigger("before_open",{node:n}),a.children(".jstree-children").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").attr("aria-expanded",!0).children(".jstree-children").stop(!0,!0).slideDown(i,function(){this.style.display="",l.trigger("after_open",{node:n})})):(this.trigger("before_open",{node:n}),a[0].className=a[0].className.replace("jstree-closed","jstree-open"),a[0].setAttribute("aria-expanded",!0))),n.state.opened=!0,r&&r.call(this,n,!0),a.length||this.trigger("before_open",{node:n}),this.trigger("open_node",{node:n}),i&&a.length||this.trigger("after_open",{node:n});else{if(this.is_loading(n))return setTimeout(e.proxy(function(){this.open_node(n,r,i)},this),500);this.load_node(n,function(e,t){return t?this.open_node(e,r,i):r?r.call(this,e,!1):!1})}},_open_to:function(t){if(t=this.get_node(t),!t||"#"===t.id)return!1;var n,r,i=t.parents;for(n=0,r=i.length;r>n;n+=1)"#"!==n&&this.open_node(i[n],!1,0);return e("#"+t.id.replace(e.jstree.idregex,"\\$&"),this.element)},close_node:function(n,r){var i,o,s,a;if(e.isArray(n)){for(n=n.slice(),i=0,o=n.length;o>i;i++)this.close_node(n[i],r);return!0}return n=this.get_node(n),n&&"#"!==n.id?this.is_closed(n)?!1:(r=r===t?this.settings.core.animation:r,s=this,a=this.get_node(n,!0),a.length&&(r?a.children(".jstree-children").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").attr("aria-expanded",!1).children(".jstree-children").stop(!0,!0).slideUp(r,function(){this.style.display="",a.children(".jstree-children").remove(),s.trigger("after_close",{node:n})}):(a[0].className=a[0].className.replace("jstree-open","jstree-closed"),a.attr("aria-expanded",!1).children(".jstree-children").remove())),n.state.opened=!1,this.trigger("close_node",{node:n}),r&&a.length||this.trigger("after_close",{node:n}),t):!1},toggle_node:function(n){var r,i;if(e.isArray(n)){for(n=n.slice(),r=0,i=n.length;i>r;r++)this.toggle_node(n[r]);return!0}return this.is_closed(n)?this.open_node(n):this.is_open(n)?this.close_node(n):t},open_all:function(e,t,n){if(e||(e="#"),e=this.get_node(e),!e)return!1;var r,i,o,s="#"===e.id?this.get_container_ul():this.get_node(e,!0);if(!s.length){for(r=0,i=e.children_d.length;i>r;r++)this.is_closed(this._model.data[e.children_d[r]])&&(this._model.data[e.children_d[r]].state.opened=!0);return this.trigger("open_all",{node:e})}n=n||s,o=this,s=this.is_closed(e)?s.find(".jstree-closed").addBack():s.find(".jstree-closed"),s.each(function(){o.open_node(this,function(e,r){r&&this.is_parent(e)&&this.open_all(e,t,n)},t||0)}),0===n.find(".jstree-closed").length&&this.trigger("open_all",{node:this.get_node(n)})},close_all:function(t,n){if(t||(t="#"),t=this.get_node(t),!t)return!1;var r,i,o="#"===t.id?this.get_container_ul():this.get_node(t,!0),s=this;if(!o.length){for(r=0,i=t.children_d.length;i>r;r++)this._model.data[t.children_d[r]].state.opened=!1;return this.trigger("close_all",{node:t})}o=this.is_open(t)?o.find(".jstree-open").addBack():o.find(".jstree-open"),e(o.get().reverse()).each(function(){s.close_node(this,n||0)}),this.trigger("close_all",{node:t})},is_disabled:function(e){return e=this.get_node(e),e&&e.state&&e.state.disabled},enable_node:function(n){var r,i;if(e.isArray(n)){for(n=n.slice(),r=0,i=n.length;i>r;r++)this.enable_node(n[r]);return!0}return n=this.get_node(n),n&&"#"!==n.id?(n.state.disabled=!1,this.get_node(n,!0).children(".jstree-anchor").removeClass("jstree-disabled"),this.trigger("enable_node",{node:n}),t):!1},disable_node:function(n){var r,i;if(e.isArray(n)){for(n=n.slice(),r=0,i=n.length;i>r;r++)this.disable_node(n[r]);return!0}return n=this.get_node(n),n&&"#"!==n.id?(n.state.disabled=!0,this.get_node(n,!0).children(".jstree-anchor").addClass("jstree-disabled"),this.trigger("disable_node",{node:n}),t):!1},activate_node:function(e,n){if(this.is_disabled(e))return!1;if(this._data.core.last_clicked=this._data.core.last_clicked&&this._data.core.last_clicked.id!==t?this.get_node(this._data.core.last_clicked.id):null,this._data.core.last_clicked&&!this._data.core.last_clicked.state.selected&&(this._data.core.last_clicked=null),!this._data.core.last_clicked&&this._data.core.selected.length&&(this._data.core.last_clicked=this.get_node(this._data.core.selected[this._data.core.selected.length-1])),this.settings.core.multiple&&(n.metaKey||n.ctrlKey||n.shiftKey)&&(!n.shiftKey||this._data.core.last_clicked&&this.get_parent(e)&&this.get_parent(e)===this._data.core.last_clicked.parent))if(n.shiftKey){var r,i,o=this.get_node(e).id,s=this._data.core.last_clicked.id,a=this.get_node(this._data.core.last_clicked.parent).children,l=!1;for(r=0,i=a.length;i>r;r+=1)a[r]===o&&(l=!l),a[r]===s&&(l=!l),l||a[r]===o||a[r]===s?this.select_node(a[r],!1,!1,n):this.deselect_node(a[r],!1,n)}else this.is_selected(e)?this.deselect_node(e,!1,n):this.select_node(e,!1,!1,n);else!this.settings.core.multiple&&(n.metaKey||n.ctrlKey||n.shiftKey)&&this.is_selected(e)?this.deselect_node(e,!1,n):(this.deselect_all(!0),this.select_node(e,!1,!1,n),this._data.core.last_clicked=this.get_node(e));this.trigger("activate_node",{node:this.get_node(e)})},hover_node:function(e){if(e=this.get_node(e,!0),!e||!e.length||e.children(".jstree-hovered").length)return!1;var t=this.element.find(".jstree-hovered"),n=this.element;t&&t.length&&this.dehover_node(t),e.children(".jstree-anchor").addClass("jstree-hovered"),this.trigger("hover_node",{node:this.get_node(e)}),setTimeout(function(){n.attr("aria-activedescendant",e[0].id),e.attr("aria-selected",!0)},0)},dehover_node:function(e){return e=this.get_node(e,!0),e&&e.length&&e.children(".jstree-hovered").length?(e.attr("aria-selected",!1).children(".jstree-anchor").removeClass("jstree-hovered"),this.trigger("dehover_node",{node:this.get_node(e)}),t):!1},select_node:function(n,r,i,o){var s,a,l;if(e.isArray(n)){for(n=n.slice(),a=0,l=n.length;l>a;a++)this.select_node(n[a],r,i,o);return!0}return n=this.get_node(n),n&&"#"!==n.id?(s=this.get_node(n,!0),n.state.selected||(n.state.selected=!0,this._data.core.selected.push(n.id),i||(s=this._open_to(n)),s&&s.length&&s.children(".jstree-anchor").addClass("jstree-clicked"),this.trigger("select_node",{node:n,selected:this._data.core.selected,event:o}),r||this.trigger("changed",{action:"select_node",node:n,selected:this._data.core.selected,event:o})),t):!1},deselect_node:function(n,r,i){var o,s,a;if(e.isArray(n)){for(n=n.slice(),o=0,s=n.length;s>o;o++)this.deselect_node(n[o],r,i);return!0}return n=this.get_node(n),n&&"#"!==n.id?(a=this.get_node(n,!0),n.state.selected&&(n.state.selected=!1,this._data.core.selected=e.vakata.array_remove_item(this._data.core.selected,n.id),a.length&&a.children(".jstree-anchor").removeClass("jstree-clicked"),this.trigger("deselect_node",{node:n,selected:this._data.core.selected,event:i}),r||this.trigger("changed",{action:"deselect_node",node:n,selected:this._data.core.selected,event:i})),t):!1},select_all:function(e){var t,n,r=this._data.core.selected.concat([]);for(this._data.core.selected=this._model.data["#"].children_d.concat(),t=0,n=this._data.core.selected.length;n>t;t++)this._model.data[this._data.core.selected[t]]&&(this._model.data[this._data.core.selected[t]].state.selected=!0);this.redraw(!0),this.trigger("select_all",{selected:this._data.core.selected}),e||this.trigger("changed",{action:"select_all",selected:this._data.core.selected,old_selection:r})},deselect_all:function(e){var t,n,r=this._data.core.selected.concat([]);for(t=0,n=this._data.core.selected.length;n>t;t++)this._model.data[this._data.core.selected[t]]&&(this._model.data[this._data.core.selected[t]].state.selected=!1);this._data.core.selected=[],this.element.find(".jstree-clicked").removeClass("jstree-clicked"),this.trigger("deselect_all",{selected:this._data.core.selected,node:r}),e||this.trigger("changed",{action:"deselect_all",selected:this._data.core.selected,old_selection:r})},is_selected:function(e){return e=this.get_node(e),e&&"#"!==e.id?e.state.selected:!1},get_selected:function(t){return t?e.map(this._data.core.selected,e.proxy(function(e){return this.get_node(e)},this)):this._data.core.selected},get_top_selected:function(t){var n,r,i,o,s=this.get_selected(!0),a={};for(n=0,r=s.length;r>n;n++)a[s[n].id]=s[n];for(n=0,r=s.length;r>n;n++)for(i=0,o=s[n].children_d.length;o>i;i++)a[s[n].children_d[i]]&&delete a[s[n].children_d[i]];s=[];for(n in a)a.hasOwnProperty(n)&&s.push(n);return t?e.map(s,e.proxy(function(e){return this.get_node(e)},this)):s},get_bottom_selected:function(t){var n,r,i=this.get_selected(!0),o=[];for(n=0,r=i.length;r>n;n++)i[n].children.length||o.push(i[n].id);return t?e.map(o,e.proxy(function(e){return this.get_node(e)},this)):o},get_state:function(){var e,t={core:{open:[],scroll:{left:this.element.scrollLeft(),top:this.element.scrollTop()},selected:[]}};for(e in this._model.data)this._model.data.hasOwnProperty(e)&&"#"!==e&&(this._model.data[e].state.opened&&t.core.open.push(e),this._model.data[e].state.selected&&t.core.selected.push(e));return t},set_state:function(n,r){if(n){if(n.core){var i,o,s,a;if(n.core.open)return e.isArray(n.core.open)?(i=!0,o=!1,s=this,e.each(n.core.open.concat([]),function(t,a){o=s.get_node(a),o&&(s.is_loaded(a)?(s.is_closed(a)&&s.open_node(a,!1,0),n&&n.core&&n.core.open&&e.vakata.array_remove_item(n.core.open,a)):(s.is_loading(a)||s.open_node(a,e.proxy(function(t,i){!i&&n&&n.core&&n.core.open&&e.vakata.array_remove_item(n.core.open,t.id),this.set_state(n,r)},s),0),i=!1))}),i&&(delete n.core.open,this.set_state(n,r)),!1):(delete n.core.open,this.set_state(n,r),!1);if(n.core.scroll)return n.core.scroll&&n.core.scroll.left!==t&&this.element.scrollLeft(n.core.scroll.left),n.core.scroll&&n.core.scroll.top!==t&&this.element.scrollTop(n.core.scroll.top),delete n.core.scroll,this.set_state(n,r),!1;if(n.core.selected)return a=this,this.deselect_all(),e.each(n.core.selected,function(e,t){a.select_node(t)}),delete n.core.selected,this.set_state(n,r),!1;if(e.isEmptyObject(n.core))return delete n.core,this.set_state(n,r),!1}return e.isEmptyObject(n)?(n=null,r&&r.call(this),this.trigger("set_state"),!1):!0}return!1},refresh:function(t){this._data.core.state=this.get_state(),this._cnt=0,this._model.data={"#":{id:"#",parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}}};var n=this.get_container_ul()[0].className;t||this.element.html("<ul class='"+n+"'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.load_node("#",function(t,r){r&&(this.get_container_ul()[0].className=n,this.set_state(e.extend(!0,{},this._data.core.state),function(){this.trigger("refresh")})),this._data.core.state=null})},refresh_node:function(t){if(t=this.get_node(t),!t||"#"===t.id)return!1;{var n=[];this._data.core.selected.concat([])}t.state.opened===!0&&n.push(t.id),this.get_node(t,!0).find(".jstree-open").each(function(){n.push(this.id)}),this._load_nodes(n,e.proxy(function(e){this.open_node(e,!1,0),this.select_node(this._data.core.selected),this.trigger("refresh_node",{node:t,nodes:e})},this))},set_id:function(t,n){if(t=this.get_node(t),!t||"#"===t.id)return!1;var r,i,o=this._model.data;for(n=""+n,o[t.parent].children[e.inArray(t.id,o[t.parent].children)]=n,r=0,i=t.parents.length;i>r;r++)o[t.parents[r]].children_d[e.inArray(t.id,o[t.parents[r]].children_d)]=n;for(r=0,i=t.children.length;i>r;r++)o[t.children[r]].parent=n;for(r=0,i=t.children_d.length;i>r;r++)o[t.children_d[r]].parents[e.inArray(t.id,o[t.children_d[r]].parents)]=n;return r=e.inArray(t.id,this._data.core.selected),-1!==r&&(this._data.core.selected[r]=n),r=this.get_node(t.id,!0),r&&r.attr("id",n),delete o[t.id],t.id=n,o[n]=t,!0},get_text:function(e){return e=this.get_node(e),e&&"#"!==e.id?e.text:!1},set_text:function(t,n){var r,i,o,s;if(e.isArray(t)){for(t=t.slice(),r=0,i=t.length;i>r;r++)this.set_text(t[r],n);return!0}return t=this.get_node(t),t&&"#"!==t.id?(t.text=n,o=this.get_node(t,!0),o.length&&(o=o.children(".jstree-anchor:eq(0)"),s=o.children("I").clone(),o.html(n).prepend(s),this.trigger("set_text",{obj:t,text:n})),!0):!1},get_json:function(e,t,n){if(e=this.get_node(e||"#"),!e)return!1;t&&t.flat&&!n&&(n=[]);var r,i,o={id:e.id,text:e.text,icon:this.get_icon(e),li_attr:e.li_attr,a_attr:e.a_attr,state:{},data:t&&t.no_data?!1:e.data};if(t&&t.flat?o.parent=e.parent:o.children=[],!t||!t.no_state)for(r in e.state)e.state.hasOwnProperty(r)&&(o.state[r]=e.state[r]);if(t&&t.no_id&&(delete o.id,o.li_attr&&o.li_attr.id&&delete o.li_attr.id),t&&t.flat&&"#"!==e.id&&n.push(o),!t||!t.no_children)for(r=0,i=e.children.length;i>r;r++)t&&t.flat?this.get_json(e.children[r],t,n):o.children.push(this.get_json(e.children[r],t));return t&&t.flat?n:"#"===e.id?o.children:o},create_node:function(n,r,i,o,s){if(null===n&&(n="#"),n=this.get_node(n),!n)return!1;if(i=i===t?"last":i,!(""+i).match(/^(before|after)$/)&&!s&&!this.is_loaded(n))return this.load_node(n,function(){this.create_node(n,r,i,o,!0)});r||(r={text:this.get_string("New node")}),r.text===t&&(r.text=this.get_string("New node"));var a,l,c,d;switch("#"===n.id&&("before"===i&&(i="first"),"after"===i&&(i="last")),i){case"before":a=this.get_node(n.parent),i=e.inArray(n.id,a.children),n=a;break;case"after":a=this.get_node(n.parent),i=e.inArray(n.id,a.children)+1,n=a;break;case"inside":case"first":i=0;break;case"last":i=n.children.length;break;default:i||(i=0)}if(i>n.children.length&&(i=n.children.length),r.id||(r.id=!0),!this.check("create_node",r,n,i))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(r.id===!0&&delete r.id,r=this._parse_model_from_json(r,n.id,n.parents.concat()),!r)return!1;for(a=this.get_node(r),l=[],l.push(r),l=l.concat(a.children_d),this.trigger("model",{nodes:l,parent:n.id}),n.children_d=n.children_d.concat(l),c=0,d=n.parents.length;d>c;c++)this._model.data[n.parents[c]].children_d=this._model.data[n.parents[c]].children_d.concat(l);for(r=a,a=[],c=0,d=n.children.length;d>c;c++)a[c>=i?c+1:c]=n.children[c];return a[i]=r.id,n.children=a,this.redraw_node(n,!0),o&&o.call(this,this.get_node(r)),this.trigger("create_node",{node:this.get_node(r),parent:n.id,position:i}),r.id},rename_node:function(t,n){var r,i,o;if(e.isArray(t)){for(t=t.slice(),r=0,i=t.length;i>r;r++)this.rename_node(t[r],n);return!0}return t=this.get_node(t),t&&"#"!==t.id?(o=t.text,this.check("rename_node",t,this.get_parent(t),n)?(this.set_text(t,n),this.trigger("rename_node",{node:t,text:n,old:o}),!0):(this.settings.core.error.call(this,this._data.core.last_error),!1)):!1},delete_node:function(t){var n,r,i,o,s,a,l,c,d,h;if(e.isArray(t)){for(t=t.slice(),n=0,r=t.length;r>n;n++)this.delete_node(t[n]);return!0}if(t=this.get_node(t),!t||"#"===t.id)return!1;if(i=this.get_node(t.parent),o=e.inArray(t.id,i.children),h=!1,!this.check("delete_node",t,i,o))return this.settings.core.error.call(this,this._data.core.last_error),!1;for(-1!==o&&(i.children=e.vakata.array_remove(i.children,o)),s=t.children_d.concat([]),s.push(t.id),c=0,d=s.length;d>c;c++){for(a=0,l=t.parents.length;l>a;a++)o=e.inArray(s[c],this._model.data[t.parents[a]].children_d),-1!==o&&(this._model.data[t.parents[a]].children_d=e.vakata.array_remove(this._model.data[t.parents[a]].children_d,o));this._model.data[s[c]].state.selected&&(h=!0,o=e.inArray(s[c],this._data.core.selected),-1!==o&&(this._data.core.selected=e.vakata.array_remove(this._data.core.selected,o)))}for(this.trigger("delete_node",{node:t,parent:i.id}),h&&this.trigger("changed",{action:"delete_node",node:t,selected:this._data.core.selected,parent:i.id}),c=0,d=s.length;d>c;c++)delete this._model.data[s[c]];return this.redraw_node(i,!0),!0},check:function(t,n,r,i,o){n=n&&n.id?n:this.get_node(n),r=r&&r.id?r:this.get_node(r);var s=t.match(/^move_node|copy_node|create_node$/i)?r:n,a=this.settings.core.check_callback;return"move_node"!==t&&"copy_node"!==t||o&&o.is_multi||n.id!==r.id&&e.inArray(n.id,r.children)!==i&&-1===e.inArray(r.id,n.children_d)?(s&&s.data&&(s=s.data),s&&s.functions&&(s.functions[t]===!1||s.functions[t]===!0)?(s.functions[t]===!1&&(this._data.core.last_error={error:"check",plugin:"core",id:"core_02",reason:"Node data prevents function: "+t,data:JSON.stringify({chk:t,pos:i,obj:n&&n.id?n.id:!1,par:r&&r.id?r.id:!1})}),s.functions[t]):a===!1||e.isFunction(a)&&a.call(this,t,n,r,i,o)===!1||a&&a[t]===!1?(this._data.core.last_error={error:"check",plugin:"core",id:"core_03",reason:"User config for core.check_callback prevents function: "+t,data:JSON.stringify({chk:t,pos:i,obj:n&&n.id?n.id:!1,par:r&&r.id?r.id:!1})},!1):!0):(this._data.core.last_error={error:"check",plugin:"core",id:"core_01",reason:"Moving parent inside child",data:JSON.stringify({chk:t,pos:i,obj:n&&n.id?n.id:!1,par:r&&r.id?r.id:!1})},!1)},last_error:function(){return this._data.core.last_error},move_node:function(n,r,i,o,s){var a,l,c,d,h,u,f,p,g,m,v,y,_,b;if(r=this.get_node(r),i=i===t?0:i,!r)return!1;if(!(""+i).match(/^(before|after)$/)&&!s&&!this.is_loaded(r))return this.load_node(r,function(){this.move_node(n,r,i,o,!0)});if(e.isArray(n)){for(n=n.reverse().slice(),a=0,l=n.length;l>a;a++)this.move_node(n[a],r,i,o,s);return!0}if(n=n&&n.id?n:this.get_node(n),!n||"#"===n.id)return!1;if(c=""+(n.parent||"#"),h=(""+i).match(/^(before|after)$/)&&"#"!==r.id?this.get_node(r.parent):r,u=n.instance?n.instance:this._model.data[n.id]?this:e.jstree.reference(n.id),f=!u||!u._id||this._id!==u._id,d=u&&u._id&&c&&u._model.data[c]&&u._model.data[c].children?e.inArray(n.id,u._model.data[c].children):-1,f)return this.copy_node(n,r,i,o,s)?(u&&u.delete_node(n),!0):!1;switch("#"===h.id&&("before"===i&&(i="first"),"after"===i&&(i="last")),i){case"before":i=e.inArray(r.id,h.children);break;case"after":i=e.inArray(r.id,h.children)+1;break;case"inside":case"first":i=0;break;case"last":i=h.children.length;break;default:i||(i=0)}if(i>h.children.length&&(i=h.children.length),!this.check("move_node",n,h,i,{core:!0,is_multi:u&&u._id&&u._id!==this._id,is_foreign:!u||!u._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(n.parent===h.id){for(p=h.children.concat(),g=e.inArray(n.id,p),-1!==g&&(p=e.vakata.array_remove(p,g),i>g&&i--),g=[],m=0,v=p.length;v>m;m++)g[m>=i?m+1:m]=p[m];g[i]=n.id,h.children=g,this._node_changed(h.id),this.redraw("#"===h.id)}else{for(g=n.children_d.concat(),g.push(n.id),m=0,v=n.parents.length;v>m;m++){for(p=[],b=u._model.data[n.parents[m]].children_d,y=0,_=b.length;_>y;y++)-1===e.inArray(b[y],g)&&p.push(b[y]);u._model.data[n.parents[m]].children_d=p}for(u._model.data[c].children=e.vakata.array_remove_item(u._model.data[c].children,n.id),m=0,v=h.parents.length;v>m;m++)this._model.data[h.parents[m]].children_d=this._model.data[h.parents[m]].children_d.concat(g);for(p=[],m=0,v=h.children.length;v>m;m++)p[m>=i?m+1:m]=h.children[m];for(p[i]=n.id,h.children=p,h.children_d.push(n.id),h.children_d=h.children_d.concat(n.children_d),n.parent=h.id,g=h.parents.concat(),g.unshift(h.id),b=n.parents.length,n.parents=g,g=g.concat(),m=0,v=n.children_d.length;v>m;m++)this._model.data[n.children_d[m]].parents=this._model.data[n.children_d[m]].parents.slice(0,-1*b),Array.prototype.push.apply(this._model.data[n.children_d[m]].parents,g);this._node_changed(c),this._node_changed(h.id),this.redraw("#"===c||"#"===h.id)}return o&&o.call(this,n,h,i),this.trigger("move_node",{node:n,parent:h.id,position:i,old_parent:c,old_position:d,is_multi:u&&u._id&&u._id!==this._id,is_foreign:!u||!u._id,old_instance:u,new_instance:this}),!0},copy_node:function(n,r,i,o,s){var a,l,c,d,h,u,f,p,g,m,v;if(r=this.get_node(r),i=i===t?0:i,!r)return!1;if(!(""+i).match(/^(before|after)$/)&&!s&&!this.is_loaded(r))return this.load_node(r,function(){this.copy_node(n,r,i,o,!0)});if(e.isArray(n)){for(n=n.reverse().slice(),a=0,l=n.length;l>a;a++)this.copy_node(n[a],r,i,o,s);return!0}if(n=n&&n.id?n:this.get_node(n),!n||"#"===n.id)return!1;switch(p=""+(n.parent||"#"),g=(""+i).match(/^(before|after)$/)&&"#"!==r.id?this.get_node(r.parent):r,m=n.instance?n.instance:this._model.data[n.id]?this:e.jstree.reference(n.id),v=!m||!m._id||this._id!==m._id,"#"===g.id&&("before"===i&&(i="first"),"after"===i&&(i="last")),i){case"before":i=e.inArray(r.id,g.children);break;case"after":i=e.inArray(r.id,g.children)+1;break;case"inside":case"first":i=0;break;case"last":i=g.children.length;break;default:i||(i=0)}if(i>g.children.length&&(i=g.children.length),!this.check("copy_node",n,g,i,{core:!0,is_multi:m&&m._id&&m._id!==this._id,is_foreign:!m||!m._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(f=m?m.get_json(n,{no_id:!0,no_data:!0,no_state:!0}):n,!f)return!1;if(f.id===!0&&delete f.id,f=this._parse_model_from_json(f,g.id,g.parents.concat()),!f)return!1;for(d=this.get_node(f),n&&n.state&&n.state.loaded===!1&&(d.state.loaded=!1),c=[],c.push(f),c=c.concat(d.children_d),this.trigger("model",{nodes:c,parent:g.id}),h=0,u=g.parents.length;u>h;h++)this._model.data[g.parents[h]].children_d=this._model.data[g.parents[h]].children_d.concat(c);for(c=[],h=0,u=g.children.length;u>h;h++)c[h>=i?h+1:h]=g.children[h];return c[i]=d.id,g.children=c,g.children_d.push(d.id),g.children_d=g.children_d.concat(d.children_d),this._node_changed(g.id),this.redraw("#"===g.id),o&&o.call(this,d,g,i),this.trigger("copy_node",{node:d,original:n,parent:g.id,position:i,old_parent:p,old_position:m&&m._id&&p&&m._model.data[p]&&m._model.data[p].children?e.inArray(n.id,m._model.data[p].children):-1,is_multi:m&&m._id&&m._id!==this._id,is_foreign:!m||!m._id,old_instance:m,new_instance:this}),d.id},cut:function(n){if(n||(n=this._data.core.selected.concat()),e.isArray(n)||(n=[n]),!n.length)return!1;var r,i,l,c=[];for(i=0,l=n.length;l>i;i++)r=this.get_node(n[i]),r&&r.id&&"#"!==r.id&&c.push(r);return c.length?(o=c,a=this,s="move_node",this.trigger("cut",{node:n}),t):!1},copy:function(n){if(n||(n=this._data.core.selected.concat()),e.isArray(n)||(n=[n]),!n.length)return!1;var r,i,l,c=[];for(i=0,l=n.length;l>i;i++)r=this.get_node(n[i]),r&&r.id&&"#"!==r.id&&c.push(r);return c.length?(o=c,a=this,s="copy_node",this.trigger("copy",{node:n}),t):!1},get_buffer:function(){return{mode:s,node:o,inst:a}},can_paste:function(){return s!==!1&&o!==!1},paste:function(e,n){return e=this.get_node(e),e&&s&&s.match(/^(copy_node|move_node)$/)&&o?(this[s](o,e,n)&&this.trigger("paste",{parent:e.id,node:o,mode:s}),o=!1,s=!1,a=!1,t):!1},edit:function(n,r){if(n=this._open_to(n),!n||!n.length)return!1;if(this.settings.core.check_callback===!1)return this._data.core.last_error={error:"check",plugin:"core",id:"core_07",reason:"Could not edit node because of check_callback"},this.settings.core.error.call(this,this._data.core.last_error),!1;var i=this._data.core.rtl,o=this.element.width(),s=n.children(".jstree-anchor"),a=e("<span>"),l="string"==typeof r?r:this.get_text(n),c=e("<div />",{css:{position:"absolute",top:"-200px",left:i?"0px":"-1000px",visibility:"hidden"}}).appendTo("body"),d=e("<input />",{value:l,"class":"jstree-rename-input",css:{padding:"0",border:"1px solid silver","box-sizing":"border-box",display:"inline-block",height:this._data.core.li_height+"px",lineHeight:this._data.core.li_height+"px",width:"150px"},blur:e.proxy(function(){var e=a.children(".jstree-rename-input"),t=e.val();""===t&&(t=l),c.remove(),a.replaceWith(s),a.remove(),this.set_text(n,l),this.rename_node(n,t)===!1&&this.set_text(n,l)},this),keydown:function(e){var t=e.which;27===t&&(this.value=l),(27===t||13===t||37===t||38===t||39===t||40===t||32===t)&&e.stopImmediatePropagation(),(27===t||13===t)&&(e.preventDefault(),this.blur())},click:function(e){e.stopImmediatePropagation()},mousedown:function(e){e.stopImmediatePropagation()},keyup:function(){d.width(Math.min(c.text("pW"+this.value).width(),o))},keypress:function(e){return 13===e.which?!1:t}}),h={fontFamily:s.css("fontFamily")||"",fontSize:s.css("fontSize")||"",fontWeight:s.css("fontWeight")||"",fontStyle:s.css("fontStyle")||"",fontStretch:s.css("fontStretch")||"",fontVariant:s.css("fontVariant")||"",letterSpacing:s.css("letterSpacing")||"",wordSpacing:s.css("wordSpacing")||""};this.set_text(n,""),a.attr("class",s.attr("class")).append(s.contents().clone()).append(d),s.replaceWith(a),c.css(h),d.css(h).width(Math.min(c.text("pW"+d[0].value).width(),o))[0].select()},set_theme:function(t,n){if(!t)return!1;if(n===!0){var r=this.settings.core.themes.dir;r||(r=e.jstree.path+"/themes"),n=r+"/"+t+"/style.css"}n&&-1===e.inArray(n,l)&&(e("head").append('<link rel="stylesheet" href="'+n+'" type="text/css" />'),l.push(n)),this._data.core.themes.name&&this.element.removeClass("jstree-"+this._data.core.themes.name),this._data.core.themes.name=t,this.element.addClass("jstree-"+t),this.element[this.settings.core.themes.responsive?"addClass":"removeClass"]("jstree-"+t+"-responsive"),this.trigger("set_theme",{theme:t})},get_theme:function(){return this._data.core.themes.name},set_theme_variant:function(e){this._data.core.themes.variant&&this.element.removeClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant),this._data.core.themes.variant=e,e&&this.element.addClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)},get_theme_variant:function(){return this._data.core.themes.variant},show_stripes:function(){this._data.core.themes.stripes=!0,this.get_container_ul().addClass("jstree-striped")},hide_stripes:function(){this._data.core.themes.stripes=!1,this.get_container_ul().removeClass("jstree-striped")},toggle_stripes:function(){this._data.core.themes.stripes?this.hide_stripes():this.show_stripes()},show_dots:function(){this._data.core.themes.dots=!0,this.get_container_ul().removeClass("jstree-no-dots")},hide_dots:function(){this._data.core.themes.dots=!1,this.get_container_ul().addClass("jstree-no-dots")},toggle_dots:function(){this._data.core.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this._data.core.themes.icons=!0,this.get_container_ul().removeClass("jstree-no-icons")},hide_icons:function(){this._data.core.themes.icons=!1,this.get_container_ul().addClass("jstree-no-icons")},toggle_icons:function(){this._data.core.themes.icons?this.hide_icons():this.show_icons()},set_icon:function(t,n){var r,i,o,s;if(e.isArray(t)){for(t=t.slice(),r=0,i=t.length;i>r;r++)this.set_icon(t[r],n);return!0}return t=this.get_node(t),t&&"#"!==t.id?(s=t.icon,t.icon=n,o=this.get_node(t,!0).children(".jstree-anchor").children(".jstree-themeicon"),n===!1?this.hide_icon(t):n===!0?o.removeClass("jstree-themeicon-custom "+s).css("background","").removeAttr("rel"):-1===n.indexOf("/")&&-1===n.indexOf(".")?(o.removeClass(s).css("background",""),o.addClass(n+" jstree-themeicon-custom").attr("rel",n)):(o.removeClass(s).css("background",""),o.addClass("jstree-themeicon-custom").css("background","url('"+n+"') center center no-repeat").attr("rel",n)),!0):!1},get_icon:function(e){return e=this.get_node(e),e&&"#"!==e.id?e.icon:!1},hide_icon:function(t){var n,r;if(e.isArray(t)){for(t=t.slice(),n=0,r=t.length;r>n;n++)this.hide_icon(t[n]);return!0}return t=this.get_node(t),t&&"#"!==t?(t.icon=!1,this.get_node(t,!0).children(".jstree-anchor").children(".jstree-themeicon").addClass("jstree-themeicon-hidden"),!0):!1},show_icon:function(t){var n,r,i;if(e.isArray(t)){for(t=t.slice(),n=0,r=t.length;r>n;n++)this.show_icon(t[n]);return!0}return t=this.get_node(t),t&&"#"!==t?(i=this.get_node(t,!0),t.icon=i.length?i.children(".jstree-anchor").children(".jstree-themeicon").attr("rel"):!0,t.icon||(t.icon=!0),i.children(".jstree-anchor").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden"),!0):!1}},e.vakata={},e.vakata.attributes=function(t,n){t=e(t)[0];var r=n?{}:[];return t&&t.attributes&&e.each(t.attributes,function(t,i){-1===e.inArray(i.nodeName.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])&&null!==i.nodeValue&&""!==e.trim(i.nodeValue)&&(n?r[i.nodeName]=i.nodeValue:r.push(i.nodeName))}),r},e.vakata.array_unique=function(e){var t,n,r,i=[];for(t=0,r=e.length;r>t;t++){for(n=0;t>=n&&e[t]!==e[n];n++);n===t&&i.push(e[t])}return i},e.vakata.array_remove=function(e,t,n){var r=e.slice((n||t)+1||e.length);return e.length=0>t?e.length+t:t,e.push.apply(e,r),e},e.vakata.array_remove_item=function(t,n){var r=e.inArray(n,t);return-1!==r?e.vakata.array_remove(t,r):t};var u=document.createElement("I");u.className="jstree-icon jstree-checkbox",e.jstree.defaults.checkbox={visible:!0,three_state:!0,whole_node:!0,keep_selected_style:!0,cascade:""},e.jstree.plugins.checkbox=function(t,n){this.bind=function(){n.bind.call(this),this._data.checkbox.uto=!1,this.settings.checkbox.three_state&&(this.settings.checkbox.cascade="up+down+undetermined"),this.element.on("init.jstree",e.proxy(function(){this._data.checkbox.visible=this.settings.checkbox.visible,this.settings.checkbox.keep_selected_style||this.element.addClass("jstree-checkbox-no-clicked")},this)).on("loading.jstree",e.proxy(function(){this[this._data.checkbox.visible?"show_checkboxes":"hide_checkboxes"]()},this)),-1!==this.settings.checkbox.cascade.indexOf("undetermined")&&this.element.on("changed.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree",e.proxy(function(){this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(e.proxy(this._undetermined,this),50)},this)),(-1!==this.settings.checkbox.cascade.indexOf("up")||-1!==this.settings.checkbox.cascade.indexOf("down"))&&this.element.on("model.jstree",e.proxy(function(t,n){var r,i,o,s,a,l,c=this._model.data,d=c[n.parent],h=n.nodes,u=[],f=this.settings.checkbox.cascade;if(-1!==f.indexOf("down"))if(d.state.selected){for(i=0,o=h.length;o>i;i++)c[h[i]].state.selected=!0;this._data.core.selected=this._data.core.selected.concat(h)}else for(i=0,o=h.length;o>i;i++)if(c[h[i]].state.selected){for(s=0,a=c[h[i]].children_d.length;a>s;s++)c[c[h[i]].children_d[s]].state.selected=!0;
this._data.core.selected=this._data.core.selected.concat(c[h[i]].children_d)}if(-1!==f.indexOf("up")){for(i=0,o=d.children_d.length;o>i;i++)c[d.children_d[i]].children.length||u.push(c[d.children_d[i]].parent);for(u=e.vakata.array_unique(u),s=0,a=u.length;a>s;s++)for(d=c[u[s]];d&&"#"!==d.id;){for(r=0,i=0,o=d.children.length;o>i;i++)r+=c[d.children[i]].state.selected;if(r!==o)break;d.state.selected=!0,this._data.core.selected.push(d.id),l=this.get_node(d,!0),l&&l.length&&l.children(".jstree-anchor").addClass("jstree-clicked"),d=this.get_node(d.parent)}}this._data.core.selected=e.vakata.array_unique(this._data.core.selected)},this)).on("select_node.jstree",e.proxy(function(t,n){var r,i,o,s,a=n.node,l=this._model.data,c=this.get_node(a.parent),d=this.get_node(a,!0),h=this.settings.checkbox.cascade;if(-1!==h.indexOf("down"))for(this._data.core.selected=e.vakata.array_unique(this._data.core.selected.concat(a.children_d)),r=0,i=a.children_d.length;i>r;r++)s=l[a.children_d[r]],s.state.selected=!0,s&&s.original&&s.original.state&&s.original.state.undetermined&&(s.original.state.undetermined=!1);if(-1!==h.indexOf("up"))for(;c&&"#"!==c.id;){for(o=0,r=0,i=c.children.length;i>r;r++)o+=l[c.children[r]].state.selected;if(o!==i)break;c.state.selected=!0,this._data.core.selected.push(c.id),s=this.get_node(c,!0),s&&s.length&&s.children(".jstree-anchor").addClass("jstree-clicked"),c=this.get_node(c.parent)}-1!==h.indexOf("down")&&d.length&&d.find(".jstree-anchor").addClass("jstree-clicked")},this)).on("deselect_all.jstree",e.proxy(function(){var e,t,n,r=this.get_node("#"),i=this._model.data;for(e=0,t=r.children_d.length;t>e;e++)n=i[r.children_d[e]],n&&n.original&&n.original.state&&n.original.state.undetermined&&(n.original.state.undetermined=!1)},this)).on("deselect_node.jstree",e.proxy(function(t,n){var r,i,o,s=n.node,a=this.get_node(s,!0),l=this.settings.checkbox.cascade;if(s&&s.original&&s.original.state&&s.original.state.undetermined&&(s.original.state.undetermined=!1),-1!==l.indexOf("down"))for(r=0,i=s.children_d.length;i>r;r++)o=this._model.data[s.children_d[r]],o.state.selected=!1,o&&o.original&&o.original.state&&o.original.state.undetermined&&(o.original.state.undetermined=!1);if(-1!==l.indexOf("up"))for(r=0,i=s.parents.length;i>r;r++)o=this._model.data[s.parents[r]],o.state.selected=!1,o&&o.original&&o.original.state&&o.original.state.undetermined&&(o.original.state.undetermined=!1),o=this.get_node(s.parents[r],!0),o&&o.length&&o.children(".jstree-anchor").removeClass("jstree-clicked");for(o=[],r=0,i=this._data.core.selected.length;i>r;r++)-1!==l.indexOf("down")&&-1!==e.inArray(this._data.core.selected[r],s.children_d)||-1!==l.indexOf("up")&&-1!==e.inArray(this._data.core.selected[r],s.parents)||o.push(this._data.core.selected[r]);this._data.core.selected=e.vakata.array_unique(o),-1!==l.indexOf("down")&&a.length&&a.find(".jstree-anchor").removeClass("jstree-clicked")},this)),-1!==this.settings.checkbox.cascade.indexOf("up")&&this.element.on("delete_node.jstree",e.proxy(function(e,t){for(var n,r,i,o,s=this.get_node(t.parent),a=this._model.data;s&&"#"!==s.id;){for(i=0,n=0,r=s.children.length;r>n;n++)i+=a[s.children[n]].state.selected;if(i!==r)break;s.state.selected=!0,this._data.core.selected.push(s.id),o=this.get_node(s,!0),o&&o.length&&o.children(".jstree-anchor").addClass("jstree-clicked"),s=this.get_node(s.parent)}},this)).on("move_node.jstree",e.proxy(function(t,n){var r,i,o,s,a,l=n.is_multi,c=n.old_parent,d=this.get_node(n.parent),h=this._model.data;if(!l)for(r=this.get_node(c);r&&"#"!==r.id;){for(i=0,o=0,s=r.children.length;s>o;o++)i+=h[r.children[o]].state.selected;if(i!==s)break;r.state.selected=!0,this._data.core.selected.push(r.id),a=this.get_node(r,!0),a&&a.length&&a.children(".jstree-anchor").addClass("jstree-clicked"),r=this.get_node(r.parent)}for(r=d;r&&"#"!==r.id;){for(i=0,o=0,s=r.children.length;s>o;o++)i+=h[r.children[o]].state.selected;if(i===s)r.state.selected||(r.state.selected=!0,this._data.core.selected.push(r.id),a=this.get_node(r,!0),a&&a.length&&a.children(".jstree-anchor").addClass("jstree-clicked"));else{if(!r.state.selected)break;r.state.selected=!1,this._data.core.selected=e.vakata.array_remove_item(this._data.core.selected,r.id),a=this.get_node(r,!0),a&&a.length&&a.children(".jstree-anchor").removeClass("jstree-clicked")}r=this.get_node(r.parent)}},this))},this._undetermined=function(){var t,n,r=this._model.data,i=this._data.core.selected,o=[],s=this;for(t=0,n=i.length;n>t;t++)r[i[t]]&&r[i[t]].parents&&(o=o.concat(r[i[t]].parents));for(this.element.find(".jstree-closed").not(":has(.jstree-children)").each(function(){var e,i=s.get_node(this);if(i.state.loaded)for(t=0,n=i.children_d.length;n>t;t++)e=r[i.children_d[t]],!e.state.loaded&&e.original&&e.original.state&&e.original.state.undetermined&&e.original.state.undetermined===!0&&(o.push(e.id),o=o.concat(e.parents));else i.original&&i.original.state&&i.original.state.undetermined&&i.original.state.undetermined===!0&&(o.push(i.id),o=o.concat(i.parents))}),o=e.vakata.array_unique(o),o=e.vakata.array_remove_item(o,"#"),this.element.find(".jstree-undetermined").removeClass("jstree-undetermined"),t=0,n=o.length;n>t;t++)r[o[t]].state.selected||(i=this.get_node(o[t],!0),i&&i.length&&i.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-undetermined"))},this.redraw_node=function(t,r,i){if(t=n.redraw_node.call(this,t,r,i)){var o,s,a=null;for(o=0,s=t.childNodes.length;s>o;o++)if(t.childNodes[o]&&t.childNodes[o].className&&-1!==t.childNodes[o].className.indexOf("jstree-anchor")){a=t.childNodes[o];break}a&&a.insertBefore(u.cloneNode(!1),a.childNodes[0])}return i||-1===this.settings.checkbox.cascade.indexOf("undetermined")||(this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(e.proxy(this._undetermined,this),50)),t},this.activate_node=function(t,r){return(this.settings.checkbox.whole_node||e(r.target).hasClass("jstree-checkbox"))&&(r.ctrlKey=!0),n.activate_node.call(this,t,r)},this.show_checkboxes=function(){this._data.core.themes.checkboxes=!0,this.get_container_ul().removeClass("jstree-no-checkboxes")},this.hide_checkboxes=function(){this._data.core.themes.checkboxes=!1,this.get_container_ul().addClass("jstree-no-checkboxes")},this.toggle_checkboxes=function(){this._data.core.themes.checkboxes?this.hide_checkboxes():this.show_checkboxes()}},e.jstree.defaults.contextmenu={select_node:!0,show_at_node:!0,items:function(){return{create:{separator_before:!1,separator_after:!0,_disabled:!1,label:"Create",action:function(t){var n=e.jstree.reference(t.reference),r=n.get_node(t.reference);n.create_node(r,{},"last",function(e){setTimeout(function(){n.edit(e)},0)})}},rename:{separator_before:!1,separator_after:!1,_disabled:!1,label:"Rename",action:function(t){var n=e.jstree.reference(t.reference),r=n.get_node(t.reference);n.edit(r)}},remove:{separator_before:!1,icon:!1,separator_after:!1,_disabled:!1,label:"Delete",action:function(t){var n=e.jstree.reference(t.reference),r=n.get_node(t.reference);n.is_selected(r)?n.delete_node(n.get_selected()):n.delete_node(r)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(t){var n=e.jstree.reference(t.reference),r=n.get_node(t.reference);n.is_selected(r)?n.cut(n.get_selected()):n.cut(r)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(t){var n=e.jstree.reference(t.reference),r=n.get_node(t.reference);n.is_selected(r)?n.copy(n.get_selected()):n.copy(r)}},paste:{separator_before:!1,icon:!1,_disabled:function(t){return!e.jstree.reference(t.reference).can_paste()},separator_after:!1,label:"Paste",action:function(t){var n=e.jstree.reference(t.reference),r=n.get_node(t.reference);n.paste(r)}}}}}}},e.jstree.plugins.contextmenu=function(n,r){this.bind=function(){r.bind.call(this);var t=0;this.element.on("contextmenu.jstree",".jstree-anchor",e.proxy(function(e){e.preventDefault(),t=e.ctrlKey?e.timeStamp:0,this.is_loading(e.currentTarget)||this.show_contextmenu(e.currentTarget,e.pageX,e.pageY,e)},this)).on("click.jstree",".jstree-anchor",e.proxy(function(n){this._data.contextmenu.visible&&(!t||n.timeStamp-t>250)&&e.vakata.context.hide()},this)),e(document).on("context_hide.vakata",e.proxy(function(){this._data.contextmenu.visible=!1},this))},this.teardown=function(){this._data.contextmenu.visible&&e.vakata.context.hide(),r.teardown.call(this)},this.show_contextmenu=function(n,r,i,o){if(n=this.get_node(n),!n||"#"===n.id)return!1;var s=this.settings.contextmenu,a=this.get_node(n,!0),l=a.children(".jstree-anchor"),c=!1,d=!1;(s.show_at_node||r===t||i===t)&&(c=l.offset(),r=c.left,i=c.top+this._data.core.li_height),this.settings.contextmenu.select_node&&!this.is_selected(n)&&this.activate_node(n,o),d=s.items,e.isFunction(d)&&(d=d.call(this,n,e.proxy(function(e){this._show_contextmenu(n,r,i,e)},this))),e.isPlainObject(d)&&this._show_contextmenu(n,r,i,d)},this._show_contextmenu=function(t,n,r,i){var o=this.get_node(t,!0),s=o.children(".jstree-anchor");e(document).one("context_show.vakata",e.proxy(function(t,n){var r="jstree-contextmenu jstree-"+this.get_theme()+"-contextmenu";e(n.element).addClass(r)},this)),this._data.contextmenu.visible=!0,e.vakata.context.show(s,{x:n,y:r},i),this.trigger("show_contextmenu",{node:t,x:n,y:r})}},function(e){var n=!1,r={element:!1,reference:!1,position_x:0,position_y:0,items:[],html:"",is_visible:!1};e.vakata.context={settings:{hide_onmouseleave:0,icons:!0},_trigger:function(t){e(document).triggerHandler("context_"+t+".vakata",{reference:r.reference,element:r.element,position:{x:r.position_x,y:r.position_y}})},_execute:function(t){return t=r.items[t],t&&(!t._disabled||e.isFunction(t._disabled)&&!t._disabled({item:t,reference:r.reference,element:r.element}))&&t.action?t.action.call(null,{item:t,reference:r.reference,element:r.element,position:{x:r.position_x,y:r.position_y}}):!1},_parse:function(n,i){if(!n)return!1;i||(r.html="",r.items=[]);var o,s="",a=!1;return i&&(s+="<ul>"),e.each(n,function(n,i){return i?(r.items.push(i),!a&&i.separator_before&&(s+="<li class='vakata-context-separator'><a href='#' "+(e.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>"),a=!1,s+="<li class='"+(i._class||"")+(i._disabled===!0||e.isFunction(i._disabled)&&i._disabled({item:i,reference:r.reference,element:r.element})?" vakata-contextmenu-disabled ":"")+"' "+(i.shortcut?" data-shortcut='"+i.shortcut+"' ":"")+">",s+="<a href='#' rel='"+(r.items.length-1)+"'>",e.vakata.context.settings.icons&&(s+="<i ",i.icon&&(s+=-1!==i.icon.indexOf("/")||-1!==i.icon.indexOf(".")?" style='background:url(\""+i.icon+"\") center center no-repeat' ":" class='"+i.icon+"' "),s+="></i><span class='vakata-contextmenu-sep'>&#160;</span>"),s+=(e.isFunction(i.label)?i.label({item:n,reference:r.reference,element:r.element}):i.label)+(i.shortcut?' <span class="vakata-contextmenu-shortcut vakata-contextmenu-shortcut-'+i.shortcut+'">'+(i.shortcut_label||"")+"</span>":"")+"</a>",i.submenu&&(o=e.vakata.context._parse(i.submenu,!0),o&&(s+=o)),s+="</li>",i.separator_after&&(s+="<li class='vakata-context-separator'><a href='#' "+(e.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>",a=!0),t):!0}),s=s.replace(/<li class\='vakata-context-separator'\><\/li\>$/,""),i&&(s+="</ul>"),i||(r.html=s,e.vakata.context._trigger("parse")),s.length>10?s:!1},_show_submenu:function(t){if(t=e(t),t.length&&t.children("ul").length){var r=t.children("ul"),i=t.offset().left+t.outerWidth(),o=t.offset().top,s=r.width(),a=r.height(),l=e(window).width()+e(window).scrollLeft(),c=e(window).height()+e(window).scrollTop();n?t[0>i-(s+10+t.outerWidth())?"addClass":"removeClass"]("vakata-context-left"):t[i+s+10>l?"addClass":"removeClass"]("vakata-context-right"),o+a+10>c&&r.css("bottom","-1px"),r.show()}},show:function(t,i,o){var s,a,l,c,d,h,u,f,p=!0;switch(r.element&&r.element.length&&r.element.width(""),p){case!i&&!t:return!1;case!!i&&!!t:r.reference=t,r.position_x=i.x,r.position_y=i.y;break;case!i&&!!t:r.reference=t,s=t.offset(),r.position_x=s.left+t.outerHeight(),r.position_y=s.top;break;case!!i&&!t:r.position_x=i.x,r.position_y=i.y}t&&!o&&e(t).data("vakata_contextmenu")&&(o=e(t).data("vakata_contextmenu")),e.vakata.context._parse(o)&&r.element.html(r.html),r.items.length&&(a=r.element,l=r.position_x,c=r.position_y,d=a.width(),h=a.height(),u=e(window).width()+e(window).scrollLeft(),f=e(window).height()+e(window).scrollTop(),n&&(l-=a.outerWidth(),e(window).scrollLeft()+20>l&&(l=e(window).scrollLeft()+20)),l+d+20>u&&(l=u-(d+20)),c+h+20>f&&(c=f-(h+20)),r.element.css({left:l,top:c}).show().find("a:eq(0)").focus().parent().addClass("vakata-context-hover"),r.is_visible=!0,e.vakata.context._trigger("show"))},hide:function(){r.is_visible&&(r.element.hide().find("ul").hide().end().find(":focus").blur(),r.is_visible=!1,e.vakata.context._trigger("hide"))}},e(function(){n="rtl"===e("body").css("direction");var t=!1;r.element=e("<ul class='vakata-context'></ul>"),r.element.on("mouseenter","li",function(n){n.stopImmediatePropagation(),e.contains(this,n.relatedTarget)||(t&&clearTimeout(t),r.element.find(".vakata-context-hover").removeClass("vakata-context-hover").end(),e(this).siblings().find("ul").hide().end().end().parentsUntil(".vakata-context","li").addBack().addClass("vakata-context-hover"),e.vakata.context._show_submenu(this))}).on("mouseleave","li",function(t){e.contains(this,t.relatedTarget)||e(this).find(".vakata-context-hover").addBack().removeClass("vakata-context-hover")}).on("mouseleave",function(){e(this).find(".vakata-context-hover").removeClass("vakata-context-hover"),e.vakata.context.settings.hide_onmouseleave&&(t=setTimeout(function(){return function(){e.vakata.context.hide()}}(this),e.vakata.context.settings.hide_onmouseleave))}).on("click","a",function(t){t.preventDefault(),e(this).blur().parent().hasClass("vakata-context-disabled")||e.vakata.context._execute(e(this).attr("rel"))===!1||e.vakata.context.hide()}).on("keydown","a",function(t){var n=null;switch(t.which){case 13:case 32:t.type="mouseup",t.preventDefault(),e(t.currentTarget).trigger(t);break;case 37:r.is_visible&&(r.element.find(".vakata-context-hover").last().parents("li:eq(0)").find("ul").hide().find(".vakata-context-hover").removeClass("vakata-context-hover").end().end().children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 38:r.is_visible&&(n=r.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").prevAll("li:not(.vakata-context-separator)").first(),n.length||(n=r.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").last()),n.addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 39:r.is_visible&&(r.element.find(".vakata-context-hover").last().children("ul").show().children("li:not(.vakata-context-separator)").removeClass("vakata-context-hover").first().addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 40:r.is_visible&&(n=r.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").nextAll("li:not(.vakata-context-separator)").first(),n.length||(n=r.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").first()),n.addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 27:e.vakata.context.hide(),t.preventDefault()}}).on("keydown",function(e){e.preventDefault();var t=r.element.find(".vakata-contextmenu-shortcut-"+e.which).parent();t.parent().not(".vakata-context-disabled")&&t.mouseup()}).appendTo("body"),e(document).on("mousedown",function(t){r.is_visible&&!e.contains(r.element[0],t.target)&&e.vakata.context.hide()}).on("context_show.vakata",function(){r.element.find("li:has(ul)").children("a").addClass("vakata-context-parent"),n&&r.element.addClass("vakata-context-rtl").css("direction","rtl"),r.element.find("ul").hide().end()})})}(e),e.jstree.defaults.dnd={copy:!0,open_timeout:500,is_draggable:!0,check_while_dragging:!0,always_copy:!1,inside_pos:0},e.jstree.plugins.dnd=function(n,r){this.bind=function(){r.bind.call(this),this.element.on("mousedown.jstree touchstart.jstree",".jstree-anchor",e.proxy(function(n){var r=this.get_node(n.target),i=this.is_selected(r)?this.get_selected().length:1;return r&&r.id&&"#"!==r.id&&(1===n.which||"touchstart"===n.type)&&(this.settings.dnd.is_draggable===!0||e.isFunction(this.settings.dnd.is_draggable)&&this.settings.dnd.is_draggable.call(this,i>1?this.get_selected(!0):[r]))?(this.element.trigger("mousedown.jstree"),e.vakata.dnd.start(n,{jstree:!0,origin:this,obj:this.get_node(r,!0),nodes:i>1?this.get_selected():[r.id]},'<div id="jstree-dnd" class="jstree-'+this.get_theme()+(this.settings.core.themes.responsive?" jstree-dnd-responsive":"")+'"><i class="jstree-icon jstree-er"></i>'+(i>1?i+" "+this.get_string("nodes"):this.get_text(n.currentTarget,!0))+'<ins class="jstree-copy" style="display:none;">+</ins></div>')):t},this))}},e(function(){var n=!1,r=!1,i=!1,o=e('<div id="jstree-marker">&#160;</div>').hide().appendTo("body");e(document).bind("dnd_start.vakata",function(){n=!1}).bind("dnd_move.vakata",function(s,a){if(i&&clearTimeout(i),a.data.jstree&&(!a.event.target.id||"jstree-marker"!==a.event.target.id)){var l,c,d,h,u,f,p,g,m,v,y,_,b,x,C=e.jstree.reference(a.event.target),w=!1,k=!1,S=!1;if(C&&C._data&&C._data.dnd)if(o.attr("class","jstree-"+C.get_theme()+(C.settings.core.themes.responsive?" jstree-dnd-responsive":"")),a.helper.children().attr("class","jstree-"+C.get_theme()+(C.settings.core.themes.responsive?" jstree-dnd-responsive":"")).find(".jstree-copy:eq(0)")[a.data.origin&&(a.data.origin.settings.dnd.always_copy||a.data.origin.settings.dnd.copy&&(a.event.metaKey||a.event.ctrlKey))?"show":"hide"](),a.event.target!==C.element[0]&&a.event.target!==C.get_container_ul()[0]||0!==C.get_container_ul().children().length){if(w=e(a.event.target).closest(".jstree-anchor"),w&&w.length&&w.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")&&(k=w.offset(),S=a.event.pageY-k.top,d=w.height(),f=d/3>S?["b","i","a"]:S>d-d/3?["a","i","b"]:S>d/2?["i","a","b"]:["i","b","a"],e.each(f,function(s,S){switch(S){case"b":l=k.left-6,c=k.top,h=C.get_parent(w),u=w.parent().index();break;case"i":b=C.settings.dnd.inside_pos,x=C.get_node(w.parent()),l=k.left-2,c=k.top+d/2+1,h=x.id,u="first"===b?0:"last"===b?x.children.length:Math.min(b,x.children.length);break;case"a":l=k.left-6,c=k.top+d,h=C.get_parent(w),u=w.parent().index()+1}for(p=!0,g=0,m=a.data.nodes.length;m>g;g++)if(v=a.data.origin&&(a.data.origin.settings.dnd.always_copy||a.data.origin.settings.dnd.copy&&(a.event.metaKey||a.event.ctrlKey))?"copy_node":"move_node",y=u,"move_node"===v&&"a"===S&&a.data.origin&&a.data.origin===C&&h===C.get_parent(a.data.nodes[g])&&(_=C.get_node(h),y>e.inArray(a.data.nodes[g],_.children)&&(y-=1)),p=p&&(C&&C.settings&&C.settings.dnd&&C.settings.dnd.check_while_dragging===!1||C.check(v,a.data.origin&&a.data.origin!==C?a.data.origin.get_node(a.data.nodes[g]):a.data.nodes[g],h,y,{dnd:!0,ref:C.get_node(w.parent()),pos:S,is_multi:a.data.origin&&a.data.origin!==C,is_foreign:!a.data.origin})),!p){C&&C.last_error&&(r=C.last_error());break}return p?("i"===S&&w.parent().is(".jstree-closed")&&C.settings.dnd.open_timeout&&(i=setTimeout(function(e,t){return function(){e.open_node(t)}}(C,w),C.settings.dnd.open_timeout)),n={ins:C,par:h,pos:"i"!==S||"last"!==b||0!==u||C.is_loaded(x)?u:"last"},o.css({left:l+"px",top:c+"px"}).show(),a.helper.find(".jstree-icon:eq(0)").removeClass("jstree-er").addClass("jstree-ok"),r={},f=!0,!1):t}),f===!0))return}else{for(p=!0,g=0,m=a.data.nodes.length;m>g&&(p=p&&C.check(a.data.origin&&(a.data.origin.settings.dnd.always_copy||a.data.origin.settings.dnd.copy&&(a.event.metaKey||a.event.ctrlKey))?"copy_node":"move_node",a.data.origin&&a.data.origin!==C?a.data.origin.get_node(a.data.nodes[g]):a.data.nodes[g],"#","last",{dnd:!0,ref:C.get_node("#"),pos:"i",is_multi:a.data.origin&&a.data.origin!==C,is_foreign:!a.data.origin}),p);g++);if(p)return n={ins:C,par:"#",pos:"last"},o.hide(),a.helper.find(".jstree-icon:eq(0)").removeClass("jstree-er").addClass("jstree-ok"),t}n=!1,a.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er"),o.hide()}}).bind("dnd_scroll.vakata",function(e,t){t.data.jstree&&(o.hide(),n=!1,t.helper.find(".jstree-icon:eq(0)").removeClass("jstree-ok").addClass("jstree-er"))}).bind("dnd_stop.vakata",function(t,s){if(i&&clearTimeout(i),s.data.jstree){o.hide();var a,l,c=[];if(n){for(a=0,l=s.data.nodes.length;l>a;a++)c[a]=s.data.origin?s.data.origin.get_node(s.data.nodes[a]):s.data.nodes[a],s.data.origin&&(c[a].instance=s.data.origin);n.ins[s.data.origin&&(s.data.origin.settings.dnd.always_copy||s.data.origin.settings.dnd.copy&&(s.event.metaKey||s.event.ctrlKey))?"copy_node":"move_node"](c,n.par,n.pos)}else a=e(s.event.target).closest(".jstree"),a.length&&r&&r.error&&"check"===r.error&&(a=a.jstree(!0),a&&a.settings.core.error.call(this,r))}}).bind("keyup keydown",function(t,n){n=e.vakata.dnd._get(),n.data&&n.data.jstree&&n.helper.find(".jstree-copy:eq(0)")[n.data.origin&&(n.data.origin.settings.dnd.always_copy||n.data.origin.settings.dnd.copy&&(t.metaKey||t.ctrlKey))?"show":"hide"]()})}),function(e){var n={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1};e.vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5,threshold_touch:50},_trigger:function(t,n){var r=e.vakata.dnd._get();r.event=n,e(document).triggerHandler("dnd_"+t+".vakata",r)},_get:function(){return{data:n.data,element:n.element,helper:n.helper}},_clean:function(){n.helper&&n.helper.remove(),n.scroll_i&&(clearInterval(n.scroll_i),n.scroll_i=!1),n={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1},e(document).off("mousemove touchmove",e.vakata.dnd.drag),e(document).off("mouseup touchend",e.vakata.dnd.stop)},_scroll:function(t){if(!n.scroll_e||!n.scroll_l&&!n.scroll_t)return n.scroll_i&&(clearInterval(n.scroll_i),n.scroll_i=!1),!1;if(!n.scroll_i)return n.scroll_i=setInterval(e.vakata.dnd._scroll,100),!1;if(t===!0)return!1;var r=n.scroll_e.scrollTop(),i=n.scroll_e.scrollLeft();n.scroll_e.scrollTop(r+n.scroll_t*e.vakata.dnd.settings.scroll_speed),n.scroll_e.scrollLeft(i+n.scroll_l*e.vakata.dnd.settings.scroll_speed),(r!==n.scroll_e.scrollTop()||i!==n.scroll_e.scrollLeft())&&e.vakata.dnd._trigger("scroll",n.scroll_e)},start:function(t,r,i){"touchstart"===t.type&&t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]&&(t.pageX=t.originalEvent.changedTouches[0].pageX,t.pageY=t.originalEvent.changedTouches[0].pageY,t.target=document.elementFromPoint(t.originalEvent.changedTouches[0].pageX-window.pageXOffset,t.originalEvent.changedTouches[0].pageY-window.pageYOffset)),n.is_drag&&e.vakata.dnd.stop({});try{t.currentTarget.unselectable="on",t.currentTarget.onselectstart=function(){return!1},t.currentTarget.style&&(t.currentTarget.style.MozUserSelect="none")}catch(o){}return n.init_x=t.pageX,n.init_y=t.pageY,n.data=r,n.is_down=!0,n.element=t.currentTarget,n.target=t.target,n.is_touch="touchstart"===t.type,i!==!1&&(n.helper=e("<div id='vakata-dnd'></div>").html(i).css({display:"block",margin:"0",padding:"0",position:"absolute",top:"-2000px",lineHeight:"16px",zIndex:"10000"})),e(document).bind("mousemove touchmove",e.vakata.dnd.drag),e(document).bind("mouseup touchend",e.vakata.dnd.stop),!1},drag:function(r){if("touchmove"===r.type&&r.originalEvent&&r.originalEvent.changedTouches&&r.originalEvent.changedTouches[0]&&(r.pageX=r.originalEvent.changedTouches[0].pageX,r.pageY=r.originalEvent.changedTouches[0].pageY,r.target=document.elementFromPoint(r.originalEvent.changedTouches[0].pageX-window.pageXOffset,r.originalEvent.changedTouches[0].pageY-window.pageYOffset)),n.is_down){if(!n.is_drag){if(!(Math.abs(r.pageX-n.init_x)>(n.is_touch?e.vakata.dnd.settings.threshold_touch:e.vakata.dnd.settings.threshold)||Math.abs(r.pageY-n.init_y)>(n.is_touch?e.vakata.dnd.settings.threshold_touch:e.vakata.dnd.settings.threshold)))return;n.helper&&(n.helper.appendTo("body"),n.helper_w=n.helper.outerWidth()),n.is_drag=!0,e.vakata.dnd._trigger("start",r)}var i=!1,o=!1,s=!1,a=!1,l=!1,c=!1,d=!1,h=!1,u=!1,f=!1;return n.scroll_t=0,n.scroll_l=0,n.scroll_e=!1,e(e(r.target).parentsUntil("body").addBack().get().reverse()).filter(function(){return/^auto|scroll$/.test(e(this).css("overflow"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var i=e(this),o=i.offset();return this.scrollHeight>this.offsetHeight&&(o.top+i.height()-r.pageY<e.vakata.dnd.settings.scroll_proximity&&(n.scroll_t=1),r.pageY-o.top<e.vakata.dnd.settings.scroll_proximity&&(n.scroll_t=-1)),this.scrollWidth>this.offsetWidth&&(o.left+i.width()-r.pageX<e.vakata.dnd.settings.scroll_proximity&&(n.scroll_l=1),r.pageX-o.left<e.vakata.dnd.settings.scroll_proximity&&(n.scroll_l=-1)),n.scroll_t||n.scroll_l?(n.scroll_e=e(this),!1):t}),n.scroll_e||(i=e(document),o=e(window),s=i.height(),a=o.height(),l=i.width(),c=o.width(),d=i.scrollTop(),h=i.scrollLeft(),s>a&&r.pageY-d<e.vakata.dnd.settings.scroll_proximity&&(n.scroll_t=-1),s>a&&a-(r.pageY-d)<e.vakata.dnd.settings.scroll_proximity&&(n.scroll_t=1),l>c&&r.pageX-h<e.vakata.dnd.settings.scroll_proximity&&(n.scroll_l=-1),l>c&&c-(r.pageX-h)<e.vakata.dnd.settings.scroll_proximity&&(n.scroll_l=1),(n.scroll_t||n.scroll_l)&&(n.scroll_e=i)),n.scroll_e&&e.vakata.dnd._scroll(!0),n.helper&&(u=parseInt(r.pageY+e.vakata.dnd.settings.helper_top,10),f=parseInt(r.pageX+e.vakata.dnd.settings.helper_left,10),s&&u+25>s&&(u=s-50),l&&f+n.helper_w>l&&(f=l-(n.helper_w+2)),n.helper.css({left:f+"px",top:u+"px"})),e.vakata.dnd._trigger("move",r),!1}},stop:function(t){if("touchend"===t.type&&t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]&&(t.pageX=t.originalEvent.changedTouches[0].pageX,t.pageY=t.originalEvent.changedTouches[0].pageY,t.target=document.elementFromPoint(t.originalEvent.changedTouches[0].pageX-window.pageXOffset,t.originalEvent.changedTouches[0].pageY-window.pageYOffset)),n.is_drag)e.vakata.dnd._trigger("stop",t);else if("touchend"===t.type&&t.target===n.target){var r=setTimeout(function(){e(t.target).click()},100);e(t.target).one("click",function(){r&&clearTimeout(r)})}return e.vakata.dnd._clean(),!1}}}(jQuery),e.jstree.defaults.search={ajax:!1,fuzzy:!1,case_sensitive:!1,show_only_matches:!1,close_opened_onclear:!0,search_leaves_only:!1,search_callback:!1},e.jstree.plugins.search=function(n,r){this.bind=function(){r.bind.call(this),this._data.search.str="",this._data.search.dom=e(),this._data.search.res=[],this._data.search.opn=[],this.element.on("before_open.jstree",e.proxy(function(){var t,n,r=this._data.search.res,i=[],o=e();if(r&&r.length&&(this._data.search.dom=e(this.element[0].querySelectorAll("#"+e.map(r,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.dom.children(".jstree-anchor").addClass("jstree-search"),this.settings.search.show_only_matches&&this._data.search.res.length)){for(t=0,n=r.length;n>t;t++)i=i.concat(this.get_node(r[t]).parents);i=e.vakata.array_remove_item(e.vakata.array_unique(i),"#"),o=i.length?e(this.element[0].querySelectorAll("#"+e.map(i,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #"))):e(),this.element.find(".jstree-node").hide().filter(".jstree-last").filter(function(){return this.nextSibling}).removeClass("jstree-last"),o=o.add(this._data.search.dom),o.parentsUntil(".jstree").addBack().show().filter(".jstree-children").each(function(){e(this).children(".jstree-node:visible").eq(-1).addClass("jstree-last")})}},this)),this.settings.search.show_only_matches&&this.element.on("search.jstree",function(t,n){n.nodes.length&&(e(this).find(".jstree-node").hide().filter(".jstree-last").filter(function(){return this.nextSibling}).removeClass("jstree-last"),n.nodes.parentsUntil(".jstree").addBack().show().filter(".jstree-children").each(function(){e(this).children(".jstree-node:visible").eq(-1).addClass("jstree-last")}))}).on("clear_search.jstree",function(t,n){n.nodes.length&&e(this).find(".jstree-node").css("display","").filter(".jstree-last").filter(function(){return this.nextSibling}).removeClass("jstree-last")})},this.search=function(n,r){if(n===!1||""===e.trim(""+n))return this.clear_search();n=""+n;var i=this.settings.search,o=i.ajax?i.ajax:!1,s=null,a=[],l=[];return this._data.search.res.length&&this.clear_search(),r||o===!1?(this._data.search.str=n,this._data.search.dom=e(),this._data.search.res=[],this._data.search.opn=[],s=new e.vakata.search(n,!0,{caseSensitive:i.case_sensitive,fuzzy:i.fuzzy}),e.each(this._model.data,function(e,t){t.text&&(i.search_callback&&i.search_callback.call(this,n,t)||!i.search_callback&&s.search(t.text).isMatch)&&(!i.search_leaves_only||t.state.loaded&&0===t.children.length)&&(a.push(e),l=l.concat(t.parents))}),a.length&&(l=e.vakata.array_unique(l),this._search_open(l),this._data.search.dom=e(this.element[0].querySelectorAll("#"+e.map(a,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.res=a,this._data.search.dom.children(".jstree-anchor").addClass("jstree-search")),this.trigger("search",{nodes:this._data.search.dom,str:n,res:this._data.search.res}),t):e.isFunction(o)?o.call(this,n,e.proxy(function(t){t&&t.d&&(t=t.d),this._load_nodes(e.isArray(t)?e.vakata.array_unique(t):[],function(){this.search(n,!0)},!0)},this)):(o=e.extend({},o),o.data||(o.data={}),o.data.str=n,e.ajax(o).fail(e.proxy(function(){this._data.core.last_error={error:"ajax",plugin:"search",id:"search_01",reason:"Could not load search parents",data:JSON.stringify(o)},this.settings.core.error.call(this,this._data.core.last_error)},this)).done(e.proxy(function(t){t&&t.d&&(t=t.d),this._load_nodes(e.isArray(t)?e.vakata.array_unique(t):[],function(){this.search(n,!0)},!0)},this)))},this.clear_search=function(){this._data.search.dom.children(".jstree-anchor").removeClass("jstree-search"),this.settings.search.close_opened_onclear&&this.close_node(this._data.search.opn,0),this.trigger("clear_search",{nodes:this._data.search.dom,str:this._data.search.str,res:this._data.search.res}),this._data.search.str="",this._data.search.res=[],this._data.search.opn=[],this._data.search.dom=e()},this._search_open=function(t){var n=this;e.each(t.concat([]),function(r,i){if("#"===i)return!0;try{i=e("#"+i.replace(e.jstree.idregex,"\\$&"),n.element)}catch(o){}i&&i.length&&n.is_closed(i)&&(n._data.search.opn.push(i[0].id),n.open_node(i,function(){n._search_open(t)},0))})}},function(e){e.vakata.search=function(e,t,n){n=n||{},n.fuzzy!==!1&&(n.fuzzy=!0),e=n.caseSensitive?e:e.toLowerCase();var r,i,o,s,a=n.location||0,l=n.distance||100,c=n.threshold||.6,d=e.length;return d>32&&(n.fuzzy=!1),n.fuzzy&&(r=1<<d-1,i=function(){var t={},n=0;for(n=0;d>n;n++)t[e.charAt(n)]=0;for(n=0;d>n;n++)t[e.charAt(n)]|=1<<d-n-1;return t}(),o=function(e,t){var n=e/d,r=Math.abs(a-t);return l?n+r/l:r?1:n}),s=function(t){if(t=n.caseSensitive?t:t.toLowerCase(),e===t||-1!==t.indexOf(e))return{isMatch:!0,score:0};if(!n.fuzzy)return{isMatch:!1,score:1};var s,l,h,u,f,p,g,m,v,y=t.length,_=c,b=t.indexOf(e,a),x=d+y,C=1,w=[];for(-1!==b&&(_=Math.min(o(0,b),_),b=t.lastIndexOf(e,a+d),-1!==b&&(_=Math.min(o(0,b),_))),b=-1,s=0;d>s;s++){for(h=0,u=x;u>h;)_>=o(s,a+u)?h=u:x=u,u=Math.floor((x-h)/2+h);for(x=u,p=Math.max(1,a-u+1),g=Math.min(a+u,y)+d,m=Array(g+2),m[g+1]=(1<<s)-1,l=g;l>=p;l--)if(v=i[t.charAt(l-1)],m[l]=0===s?(1|m[l+1]<<1)&v:(1|m[l+1]<<1)&v|(1|(f[l+1]|f[l])<<1)|f[l+1],m[l]&r&&(C=o(s,l-1),_>=C)){if(_=C,b=l-1,w.push(b),!(b>a))break;p=Math.max(1,2*a-b)}if(o(s+1,a)>_)break;f=m}return{isMatch:b>=0,score:C}},t===!0?{search:s}:s(t)}}(jQuery),e.jstree.defaults.sort=function(e,t){return this.get_text(e)>this.get_text(t)?1:-1},e.jstree.plugins.sort=function(t,n){this.bind=function(){n.bind.call(this),this.element.on("model.jstree",e.proxy(function(e,t){this.sort(t.parent,!0)},this)).on("rename_node.jstree create_node.jstree",e.proxy(function(e,t){this.sort(t.parent||t.node.parent,!1),this.redraw_node(t.parent||t.node.parent,!0)
},this)).on("move_node.jstree copy_node.jstree",e.proxy(function(e,t){this.sort(t.parent,!1),this.redraw_node(t.parent,!0)},this))},this.sort=function(t,n){var r,i;if(t=this.get_node(t),t&&t.children&&t.children.length&&(t.children.sort(e.proxy(this.settings.sort,this)),n))for(r=0,i=t.children_d.length;i>r;r++)this.sort(t.children_d[r],!1)}};var f=!1;e.jstree.defaults.state={key:"jstree",events:"changed.jstree open_node.jstree close_node.jstree",ttl:!1,filter:!1},e.jstree.plugins.state=function(t,n){this.bind=function(){n.bind.call(this);var t=e.proxy(function(){this.element.on(this.settings.state.events,e.proxy(function(){f&&clearTimeout(f),f=setTimeout(e.proxy(function(){this.save_state()},this),100)},this))},this);this.element.on("ready.jstree",e.proxy(function(){this.element.one("restore_state.jstree",t),this.restore_state()||t()},this))},this.save_state=function(){var t={state:this.get_state(),ttl:this.settings.state.ttl,sec:+new Date};e.vakata.storage.set(this.settings.state.key,JSON.stringify(t))},this.restore_state=function(){var t=e.vakata.storage.get(this.settings.state.key);if(t)try{t=JSON.parse(t)}catch(n){return!1}return t&&t.ttl&&t.sec&&+new Date-t.sec>t.ttl?!1:(t&&t.state&&(t=t.state),t&&e.isFunction(this.settings.state.filter)&&(t=this.settings.state.filter.call(this,t)),t?(this.element.one("set_state.jstree",function(n,r){r.instance.trigger("restore_state",{state:e.extend(!0,{},t)})}),this.set_state(t),!0):!1)},this.clear_state=function(){return e.vakata.storage.del(this.settings.state.key)}},function(e){e.vakata.storage={set:function(e,t){return window.localStorage.setItem(e,t)},get:function(e){return window.localStorage.getItem(e)},del:function(e){return window.localStorage.removeItem(e)}}}(jQuery),e.jstree.defaults.types={"#":{},"default":{}},e.jstree.plugins.types=function(n,r){this.init=function(e,n){var i,o;if(n&&n.types&&n.types["default"])for(i in n.types)if("default"!==i&&"#"!==i&&n.types.hasOwnProperty(i))for(o in n.types["default"])n.types["default"].hasOwnProperty(o)&&n.types[i][o]===t&&(n.types[i][o]=n.types["default"][o]);r.init.call(this,e,n),this._model.data["#"].type="#"},this.refresh=function(e){r.refresh.call(this,e),this._model.data["#"].type="#"},this.bind=function(){this.element.on("model.jstree",e.proxy(function(e,n){var r,i,o=this._model.data,s=n.nodes,a=this.settings.types,l="default";for(r=0,i=s.length;i>r;r++)l="default",o[s[r]].original&&o[s[r]].original.type&&a[o[s[r]].original.type]&&(l=o[s[r]].original.type),o[s[r]].data&&o[s[r]].data.jstree&&o[s[r]].data.jstree.type&&a[o[s[r]].data.jstree.type]&&(l=o[s[r]].data.jstree.type),o[s[r]].type=l,o[s[r]].icon===!0&&a[l].icon!==t&&(o[s[r]].icon=a[l].icon);o["#"].type="#"},this)),r.bind.call(this)},this.get_json=function(t,n,i){var o,s,a=this._model.data,l=n?e.extend(!0,{},n,{no_id:!1}):{},c=r.get_json.call(this,t,l,i);if(c===!1)return!1;if(e.isArray(c))for(o=0,s=c.length;s>o;o++)c[o].type=c[o].id&&a[c[o].id]&&a[c[o].id].type?a[c[o].id].type:"default",n&&n.no_id&&(delete c[o].id,c[o].li_attr&&c[o].li_attr.id&&delete c[o].li_attr.id);else c.type=c.id&&a[c.id]&&a[c.id].type?a[c.id].type:"default",n&&n.no_id&&(c=this._delete_ids(c));return c},this._delete_ids=function(t){if(e.isArray(t)){for(var n=0,r=t.length;r>n;n++)t[n]=this._delete_ids(t[n]);return t}return delete t.id,t.li_attr&&t.li_attr.id&&delete t.li_attr.id,t.children&&e.isArray(t.children)&&(t.children=this._delete_ids(t.children)),t},this.check=function(n,i,o,s,a){if(r.check.call(this,n,i,o,s,a)===!1)return!1;i=i&&i.id?i:this.get_node(i),o=o&&o.id?o:this.get_node(o);var l,c,d,h,u=i&&i.id?e.jstree.reference(i.id):null;switch(u=u&&u._model&&u._model.data?u._model.data:null,n){case"create_node":case"move_node":case"copy_node":if("move_node"!==n||-1===e.inArray(i.id,o.children)){if(l=this.get_rules(o),l.max_children!==t&&-1!==l.max_children&&l.max_children===o.children.length)return this._data.core.last_error={error:"check",plugin:"types",id:"types_01",reason:"max_children prevents function: "+n,data:JSON.stringify({chk:n,pos:s,obj:i&&i.id?i.id:!1,par:o&&o.id?o.id:!1})},!1;if(l.valid_children!==t&&-1!==l.valid_children&&-1===e.inArray(i.type,l.valid_children))return this._data.core.last_error={error:"check",plugin:"types",id:"types_02",reason:"valid_children prevents function: "+n,data:JSON.stringify({chk:n,pos:s,obj:i&&i.id?i.id:!1,par:o&&o.id?o.id:!1})},!1;if(u&&i.children_d&&i.parents){for(c=0,d=0,h=i.children_d.length;h>d;d++)c=Math.max(c,u[i.children_d[d]].parents.length);c=c-i.parents.length+1}(0>=c||c===t)&&(c=1);do{if(l.max_depth!==t&&-1!==l.max_depth&&c>l.max_depth)return this._data.core.last_error={error:"check",plugin:"types",id:"types_03",reason:"max_depth prevents function: "+n,data:JSON.stringify({chk:n,pos:s,obj:i&&i.id?i.id:!1,par:o&&o.id?o.id:!1})},!1;o=this.get_node(o.parent),l=this.get_rules(o),c++}while(o)}}return!0},this.get_rules=function(e){if(e=this.get_node(e),!e)return!1;var n=this.get_type(e,!0);return n.max_depth===t&&(n.max_depth=-1),n.max_children===t&&(n.max_children=-1),n.valid_children===t&&(n.valid_children=-1),n},this.get_type=function(t,n){return t=this.get_node(t),t?n?e.extend({type:t.type},this.settings.types[t.type]):t.type:!1},this.set_type=function(n,r){var i,o,s,a,l;if(e.isArray(n)){for(n=n.slice(),o=0,s=n.length;s>o;o++)this.set_type(n[o],r);return!0}return i=this.settings.types,n=this.get_node(n),i[r]&&n?(a=n.type,l=this.get_icon(n),n.type=r,(l===!0||i[a]&&i[a].icon&&l===i[a].icon)&&this.set_icon(n,i[r].icon!==t?i[r].icon:!0),!0):!1}},e.jstree.defaults.unique={case_sensitive:!1,duplicate:function(e,t){return e+" ("+t+")"}},e.jstree.plugins.unique=function(n,r){this.check=function(t,n,i,o,s){if(r.check.call(this,t,n,i,o,s)===!1)return!1;if(n=n&&n.id?n:this.get_node(n),i=i&&i.id?i:this.get_node(i),!i||!i.children)return!0;var a,l,c="rename_node"===t?o:n.text,d=[],h=this.settings.unique.case_sensitive,u=this._model.data;for(a=0,l=i.children.length;l>a;a++)d.push(h?u[i.children[a]].text:u[i.children[a]].text.toLowerCase());switch(h||(c=c.toLowerCase()),t){case"delete_node":return!0;case"rename_node":return a=-1===e.inArray(c,d)||n.text&&n.text===c,a||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_01",reason:"Child with name "+c+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:o,obj:n&&n.id?n.id:!1,par:i&&i.id?i.id:!1})}),a;case"create_node":return a=-1===e.inArray(c,d),a||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_04",reason:"Child with name "+c+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:o,obj:n&&n.id?n.id:!1,par:i&&i.id?i.id:!1})}),a;case"copy_node":return a=-1===e.inArray(c,d),a||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_02",reason:"Child with name "+c+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:o,obj:n&&n.id?n.id:!1,par:i&&i.id?i.id:!1})}),a;case"move_node":return a=n.parent===i.id||-1===e.inArray(c,d),a||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_03",reason:"Child with name "+c+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:o,obj:n&&n.id?n.id:!1,par:i&&i.id?i.id:!1})}),a}return!0},this.create_node=function(n,i,o,s,a){if(!i||i.text===t){if(null===n&&(n="#"),n=this.get_node(n),!n)return r.create_node.call(this,n,i,o,s,a);if(o=o===t?"last":o,!(""+o).match(/^(before|after)$/)&&!a&&!this.is_loaded(n))return r.create_node.call(this,n,i,o,s,a);i||(i={});var l,c,d,h,u,f=this._model.data,p=this.settings.unique.case_sensitive,g=this.settings.unique.duplicate;for(c=l=this.get_string("New node"),d=[],h=0,u=n.children.length;u>h;h++)d.push(p?f[n.children[h]].text:f[n.children[h]].text.toLowerCase());for(h=1;-1!==e.inArray(p?c:c.toLowerCase(),d);)c=""+g.call(this,l,++h);i.text=c}return r.create_node.call(this,n,i,o,s,a)}};var p=document.createElement("DIV");p.setAttribute("unselectable","on"),p.className="jstree-wholerow",p.innerHTML="&#160;",e.jstree.plugins.wholerow=function(t,n){this.bind=function(){n.bind.call(this),this.element.on("ready.jstree set_state.jstree",e.proxy(function(){this.hide_dots()},this)).on("init.jstree loading.jstree ready.jstree",e.proxy(function(){this.get_container_ul().addClass("jstree-wholerow-ul")},this)).on("deselect_all.jstree",e.proxy(function(){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked")},this)).on("changed.jstree",e.proxy(function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked");var n,r,i=!1;for(n=0,r=t.selected.length;r>n;n++)i=this.get_node(t.selected[n],!0),i&&i.length&&i.children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("open_node.jstree",e.proxy(function(e,t){this.get_node(t.node,!0).find(".jstree-clicked").parent().children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("hover_node.jstree dehover_node.jstree",e.proxy(function(e,t){this.get_node(t.node,!0).children(".jstree-wholerow")["hover_node"===e.type?"addClass":"removeClass"]("jstree-wholerow-hovered")},this)).on("contextmenu.jstree",".jstree-wholerow",e.proxy(function(t){t.preventDefault();var n=e.Event("contextmenu",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,pageX:t.pageX,pageY:t.pageY});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor:eq(0)").trigger(n)},this)).on("click.jstree",".jstree-wholerow",function(t){t.stopImmediatePropagation();var n=e.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor:eq(0)").trigger(n).focus()}).on("click.jstree",".jstree-leaf > .jstree-ocl",e.proxy(function(t){t.stopImmediatePropagation();var n=e.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor:eq(0)").trigger(n).focus()},this)).on("mouseover.jstree",".jstree-wholerow, .jstree-icon",e.proxy(function(e){return e.stopImmediatePropagation(),this.hover_node(e.currentTarget),!1},this)).on("mouseleave.jstree",".jstree-node",e.proxy(function(e){this.dehover_node(e.currentTarget)},this))},this.teardown=function(){this.settings.wholerow&&this.element.find(".jstree-wholerow").remove(),n.teardown.call(this)},this.redraw_node=function(t,r,i){if(t=n.redraw_node.call(this,t,r,i)){var o=p.cloneNode(!0);-1!==e.inArray(t.id,this._data.core.selected)&&(o.className+=" jstree-wholerow-clicked"),t.insertBefore(o,t.childNodes[0])}return t}}}}),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};!function(e){"function"==typeof define&&define.amd?define("codeshell",["jquery","underscore","codemirror/lib/codemirror","select2","json2","jstorage","jstree"],function(t,n,r){e(window.jQuery,window,n,r)}):e(window.jQuery,window,window._,window.CodeMirror)}(function(t,n,r,i){return t.widget("hr.codeshell",{options:{},_options:{showFileTree:!1,enableIntellisense:!1,showSave:!1,showCustomInput:!0,showCompileTest:!0,showSubmit:!1,showUploadCode:!1,showFullScreen:!1,statusText:"",showTheme:!1,showNonEditableHeadTail:!1,enableVersioning:!1,versionIds:[],versioningRestUrl:"",foldCode:!1,dynamicMode:!1,languages:["c","cpp","java","csharp","haskell","php","python","perl","ruby","bash","oracle","mysql","sql","clojure","scala","code","text","brainfuck","javascript","d","go","lua","erlang","sbcl","ocaml","pascal","python3","groovy","text_pseudo","objectivec","fsharp","visualbasic","cobol","tsql","lolcode","smalltalk","tcl","html","css","java8","db2","octave","r"],language:"c",showTemplate:!0,autoSaveNamespace:null,onSave:null,autoSave:null,firstLineNumber:1,initialCode:"",compile_button_text:"Run Code",submit_button_text:"Submit Code",lang_line_nos:{},lang_head_template:{},lang_body_template:{},lang_tail_template:{},lang_template:{},lang_mime_mapping:{c:"text/x-csrc",cpp:"text/x-c++src",java:"text/x-java",csharp:"text/x-csharp",haskell:"text/x-haskell",php:"text/x-php",python:"text/x-python",perl:"text/x-perl",ruby:"text/x-ruby",bash:"text/x-bash",oracle:"text/x-plsql",mysql:"text/x-plsql",tsql:"text/x-plsql",sql:"text/x-plsql",clojure:"text/x-scheme",scala:"text/x-scala",code:"text/plain",text:"text/plain",brainfuck:"text/plain",javascript:"text/javascript",d:"text/x-d",go:"text/x-go",lua:"text/x-lua",erlang:"text/x-erlang",sbcl:"text/x-common-lisp",ocaml:"text/x-ocaml",pascal:"text/x-pascal",python3:"text/x-python",groovy:"text/x-groovy",text_pseudo:"text/plain",objectivec:"text/x-csrc",fsharp:"text/x-fsharp",visualbasic:"text/x-vb",cobol:"text/x-cobol",smalltalk:"text/x-stsrc",tcl:"text/x-tcl",html:"text/html",css:"text/css",java8:"text/x-java",db2:"text/x-plsql",octave:"text/x-octave",r:"text/x-rsrc"},lang_display_mapping:{c:"C",cpp:"C++",java:"Java",csharp:"C#",haskell:"Haskell",php:"PHP",python:"Python 2",ruby:"Ruby",perl:"Perl",bash:"BASH",oracle:"Oracle",mysql:"MySQL",sql:"SQL",clojure:"Clojure",scala:"Scala",code:"Generic",text:"Plain Text",brainfuck:"Brainfuck",javascript:"Javascript",lua:"Lua",sbcl:"Lisp",erlang:"Erlang",go:"Go",d:"D",ocaml:"OCaml",pascal:"Pascal",python3:"Python 3",groovy:"Groovy",objectivec:"Objective C",text_pseudo:"Plain Text",fsharp:"F#",visualbasic:"VB.NET",cobol:"COBOL",tsql:"T-SQL",lolcode:"LOLCODE",smalltalk:"Smalltalk",tcl:"Tcl",whitespace:"Whitespace",css:"CSS",html:"HTML",java8:"Java 8",db2:"DB2",octave:"Octave",r:"R"},default_head_end:{c:"/* Head ends here */",cpp:"/* Head ends here */",java:"/* Head ends here */",csharp:"/* Head ends here */",haskell:"-- Head ends here",php:"/* Head ends here */",python:"# Head ends here",perl:"# Head ends here",ruby:"# Head ends here",bash:"# Head ends here",clojure:"; Head ends here",scala:"/* Head ends here */",sbcl:"; Head ends here",lua:"-- Head ends here",javascript:"/* Head ends here */",pascal:"{ Head ends here }",python3:"# Head ends here",groovy:"// Head ends here",objectivec:"// Head ends here",fsharp:"// Head ends here",visualbasic:"' Head ends here",cobol:"* Head ends here",lolcode:"BTW Head ends here",smalltalk:'" Head ends here"',tcl:"# Head ends here",whitespace:"Head ends here",html:"<!-- Head ends here -->",css:"/* Head ends here */",java8:"/* Head ends here */",db2:"/* Head ends here */",octave:"# Head ends here",r:"# Head ends here"},lang_fold_mapping:{c:"brace",cpp:"brace",java:"brace",csharp:"brace",haskell:"indent",php:"brace",python:"indent",ruby:"indent",perl:"brace",bash:"brace",oracle:"indent",mysql:"indent",sql:"indent",clojure:"indent",scala:"brace",code:"brace",text:"indent",brainfuck:"indent",javascript:"brace",lua:"indent",sbcl:"indent",erlang:"indent",go:"brace",d:"brace",ocaml:"indent",pascal:"indent",python3:"indent",groovy:"brace",objectivec:"brace",text_pseudo:"indent",fsharp:"indent",visualbasic:"indent",cobol:"indent",lolcode:"indent",smalltalk:"indent",tcl:"brace",whitespace:"indent",html:"tag",css:"brace",java8:"brace",db2:"indent",octave:"indent",r:"brace"},default_tail_start:{c:"/* Tail starts here */",cpp:"/* Tail starts here */",java:"/* Tail starts here */",csharp:"/* Tail starts here */",haskell:"-- Tail starts here",php:"/* Tail starts here */",python:"# Tail starts here",perl:"# Tail starts here",ruby:"# Tail starts here",bash:"# Tail starts here",clojure:"; Tail starts here",scala:"/* Tail starts here */",sbcl:"; Tail starts here",lua:"-- Tail starts here",javascript:"/* Tail starts here */",pascal:"{ Tail starts here }",python3:"# Tail starts here",groovy:"// Tail starts here",objectivec:"// Tail starts here",fsharp:"// Tail starts here",visualbasic:"' Tail starts here",cobol:"* Tail starts here",lolcode:"BTW Tail starts here",smalltalk:'" Tail starts here"',tcl:"# Tail starts here",whitespace:"Tail starts here",html:"<!-- Tail starts here -->",css:"/* Tails starts here */",java8:"/* Tail starts here */",db2:"/* Tail starts here */",octave:"# Tail starts here ",r:"# Tail starts here "},lang_default_text:{c:"#include <stdio.h>\n#include <string.h>\n#include <math.h>\n#include <stdlib.h>\n\nint main() {\n\n    /* Enter your code here. Read input from STDIN. Print output to STDOUT */    \n    return 0;\n}\n",cpp:"#include <cmath>\n#include <cstdio>\n#include <vector>\n#include <iostream>\n#include <algorithm>\nusing namespace std;\n\n\nint main() {\n    /* Enter your code here. Read input from STDIN. Print output to STDOUT */   \n    return 0;\n}\n",java:"import java.io.*;\nimport java.util.*;\nimport java.text.*;\nimport java.math.*;\nimport java.util.regex.*;\n\npublic class Solution {\n\n    public static void main(String[] args) {\n        /* Enter your code here. Read input from STDIN. Print output to STDOUT. Your class should be named Solution. */\n    }\n}",csharp:"using System;\nusing System.Collections.Generic;\nusing System.IO;\nclass Solution {\n    static void Main(String[] args) {\n        /* Enter your code here. Read input from STDIN. Print output to STDOUT. Your class should be named Solution */\n    }\n}",php:'<?php\n$_fp = fopen("php://stdin", "r");\n/* Enter your code here. Read input from STDIN. Print output to STDOUT */\n\n?>',ruby:"# Enter your code here. Read input from STDIN. Print output to STDOUT",python:"# Enter your code here. Read input from STDIN. Print output to STDOUT",perl:"# Enter your code here. Read input from STDIN. Print output to STDOUT",haskell:"-- Enter your code here. Read input from STDIN. Print output to STDOUT",clojure:"; Enter your code here. Read input from STDIN. Print output to STDOUT\n;",lua:"-- Enter your code here. Read input from STDIN. Print output to STDOUT",sbcl:";; Enter your code here. Read input from STDIN. Print output to STDOUT",erlang:"% Enter your code here. Read input from STDIN. Print output to STDOUT\n% Your class should be named solution\n\n-module(solution).\n-export([main/0]).\n\nmain() ->\n	.\n",scala:"object Solution {\n\n    def main(args: Array[String]) {\n        /* Enter your code here. Read input from STDIN. Print output to STDOUT. Your class should be named Solution\n*/\n    }\n}",go:'package main\nimport "fmt"\n\nfunc main() {\n //Enter your code here. Read input from STDIN. Print output to STDOUT\n}',javascript:'function processData(input) {\n    //Enter your code here\n} \n\nprocess.stdin.resume();\nprocess.stdin.setEncoding("ascii");\n_input = "";\nprocess.stdin.on("data", function (input) {\n    _input += input;\n});\n\nprocess.stdin.on("end", function () {\n   processData(_input);\n});\n',d:"/* Enter your code here. Read input from STDIN. Print output to STDOUT */",ocaml:"(* Enter your code here. Read input from STDIN. Print output to STDOUT *)",pascal:"(* Enter your code here. Read input from STDIN. Print output to STDOUT *)",groovy:"//Enter your code here. Read input from STDIN. Print output to STDOUT",text:"",objectivec:"//Enter your code here. Read input from STDIN. Print output to STDOUT",fsharp:"//Enter your code here. Read input from STDIN. Print output to STDOUT",visualbasic:"'Enter your code here. Read input from STDIN. Print output to STDOUT",cobol:"*Enter your code here. Read input from STDIN. Print output to STDOUT",lolcode:"BTW Enter your code here. Read input from STDIN. Print output to STDOUT",smalltalk:'"Enter your code here. Read input from STDIN. Print output to STDOUT"',tcl:"# Enter your code here. Read input from STDIN. Print output to STDOUT",whitespace:"Enter your code here. Read input from STDIN. Print output to STDOUT",html:"<!-- Enter your code here -->",css:"/* Enter your code here*/",java8:"import java.io.*;\nimport java.util.*;\n\npublic class Solution {\n\n    public static void main(String[] args) {\n        /* Enter your code here. Read input from STDIN. Print output to STDOUT. Your class should be named Solution. */\n    }\n}",octave:"# Enter your code here. Read input from STDIN. Print output to STDOUT",r:"# Enter your code here. Read input from STDIN. Print output to STDOUT"}},headerTemplate:'<div class="clearfix grey-header cap plL plR psT psB" style="position: relative;">\n  <% if (enableVersioning) { %>\n  <div class="fork-dialog cs-dialog hide">\n    <div class="header">Fork <span class="version-seq"></span></div>\n    <div class="body">\n      <p class="grey-msg">past buffers are marked read only, you wont be able to edit your current buffer without forking it</p>\n      <div class="m msT">\n        <button class="btn close-fork-dialog">Cancel</button>&nbsp;&nbsp;\n        <button class="btn btn-primary fork-version" data-action="fork">Fork <span class="version-seq"></span></button>&nbsp;&nbsp;\n        <button class="btn btn-primary fork-version" data-action="orphan">Create New Buffer</button>\n      </div>\n    </div>\n  </div>\n  <div class="fork-limit-reached-dialog cs-dialog hide">\n    <div class="header">Fork Limit Reached</div>\n    <div class="body">\n      <p class="grey-msg">You can&rsquo;t create more than 20 buffers, please delete one of your old bufferes to create a new buffer.</p>\n      <div class="m msT">\n        <button class="btn close-fork-limit-reached-dialog">OK</button>&nbsp;&nbsp;\n      </div>\n    </div>\n  </div>\n  <div class="delete-version-dialog cs-dialog hide">\n    <div class="header">Delete <span class="version-seq"></span></div>\n    <div class="body">\n      <p class="grey-msg">Are you sure you want to delete <strong><span class="version-seq"></span></strong>? This action can&rsquo;t be undone.</p>\n      <div class="m msT">\n        <button class="btn delete-version-button">Yes</button>&nbsp;&nbsp;\n      </div>\n    </div>\n  </div>\n  <div class="pull-left no-select">\n    <p style="padding-top: 8px;">\n      <strong class="version-name">Current Buffer</strong>\n      <span class="gray-text version-meta">(saved locally, editable)</span>\n      &nbsp;&nbsp;\n      <a class="fork-this-version"><i class="icon--grey cursor icon-flow-branch"></i></a>\n      <a class="show-version-timeline"><i class="icon--grey cursor icon-back-in-time"></i></a>\n      <a class="delete-active-version hide"><i class="icon--grey cursor icon-trash"></i></a>\n    </p>\n  </div>\n  <% } %>\n  <div class="pull-right">\n    <div class="inline large lines inverse pull-right msT msL">\n      <% if (showSave) { %>\n      <a href="javascript:;" class="cursor save-code no-select" id="save-code"><i class="icon-floppy icon--grey no-select"></i></a>\n      <% } %>\n      <% if (showFullScreen) { %>\n      <a class="restorefullscreen force-hide active-link no-select">\n          <i class="icon-resize-small-alt icon--grey no-select"></i></a>\n      <a class="fullscreen active-link no-select"\n         data-analytics="Switch to fullscreen"><i class="icon-resize-full-alt icon--grey no-select"></i></a>\n      <% } %>\n      <a class="hide" style="display:none;"></a>\n      <div style="position:relative; margin-left: 0px;">\n        <a class="cursor no-select" id="show-preferences"><i class="icon-cog icon--grey no-select"></i></a>\n        <div id="pref-pane"\n          style="position: absolute;right: -0.5em;top: 2em;z-index: 9;background: #fff;border: 1px solid #ddd;border-radius: 5px;padding: 10px;  width: 16em; display: none;">\n          <div style="position: absolute;width: 0;right: 0.8em;height: 0;border-left: 7px solid transparent;border-right: 7px solid transparent;border-bottom: 7px solid #ddd;top: -0.4em;"></div>\n          <label>Editor Mode</label>\n          <div class="btn-group msB no-select">\n            <a class="cursor emacs btn btn-white editor-mode-button no-select" data-editor="emacs">Emacs</a>\n            <a class="cursor default btn btn-white editor-mode-button no-select" data-editor="default">Normal</a>\n            <a class="cursor vim btn btn-white editor-mode-button no-select" data-editor="vim">Vim</a>\n          </div>\n          <% if (showTheme) { %>\n          <label>Editor Theme</label>\n          <select id="editor-theme">\n            <option value="light">Light</option>\n            <option value="dark">Dark</option>\n          </select>\n          <% } %>\n          <label>Tab Spaces</label>\n          <input id="tab-spaces" type="text" style="width: 4em;">\n          <% if (enableIntellisense) { %>\n            <label for="auto-complete">\n              <input id="auto-complete" type="checkbox" checked>\n              Auto Complete\n            </label>\n          <% } %>\n        </div>\n      </div>\n    </div>\n    <div class="pull-right">\n      <div class="dummy-lang-container hide"></div>\n      <select id="select-lang">\n       <% _.each(languages, function(l){ %>\n        <option value="<%=l%>"><%=lang_display_mapping[l]%></option>\n       <% }); %>\n      </select>\n    </div>\n    <div class="clearfix"></div>\n  </div>\n</div>\n<% if (enableVersioning) { %>\n<div class="version-timeline">\n  <div class="version-timeline-inner">\n    <div class="cross-line"></div>\n    <div class="start-slab pull-left"></div>\n    <% _.each (versionIds, function (version_id) { %>\n      <div class="version-ball pull-left cursor" data-version-id="<%= version_id %>"></div>\n    <% }); %>\n    <div class="current-version-ball green-bkg pull-left cursor"></div>\n  </div>\n</div>\n<% } %>',bodyTemplate:'<div class="hr_tour-code-solution flex-row" style="display: flex;">\n  <% if (showFileTree) { %>\n  <div class="code-filetree">\n    <div id="filetree">\n    </div>\n  </div>\n  <% } %>\n  <div class="code-checker">\n    <div class="code-editors">\n      <% if (showNonEditableHeadTail){ %> <div class="code-head"> <textarea id="codeheadview" style="width:100%"/> </div> <%}%>\n      <% if (dynamicMode) { %> <div class="loading-mode" style="display:none">Loading Editor... </div> <% } %>\n      <div class="code-body"> <textarea id="codeview" style="width:100%"></textarea> </div>\n      <% if (showNonEditableHeadTail){ %> <div class="code-tail"> <textarea id="codetailview" style="width:100%"/> </div> <%}%>\n      <div class="clearfix"></div>\n    </div>\n    <div id="codeeditor-statusbar" class="clearfix psA codeeditor_statusbar">\n      <span id="statusbar-mode"></span>\n      <span><em id="status-text"><%-statusText%></em></span>\n      <div class="pull-right">\n        <span id="statusbar-line"></span>\n        <span id="statusbar-col"></span>\n        <span id="statusbar-count"></span>\n      </div>\n    </div>\n  </div>\n</div>',footerTemplate:'<div class="clearfix mlT">\n  <div class="pull-right">\n    <% if (showCompileTest) { %>\n    <button class="btn bb-compile msR" data-analytics="Compile and Test"><%= compile_button_text %></button>\n    <% } %>\n    <% if (showSubmit) { %>\n    <button class="btn btn-primary bb-submit ans-submit" data-analytics="Submit Code"><%= submit_button_text %></button>\n    <% } %>\n  </div>\n  <div class="pull-left inline">\n      <% if(showUploadCode) { %>\n      <button class="btn btn-text upload_file" data-analytics="Upload File"><i class="icon-upload"></i>Upload Code as File</button>\n      <% } %>\n      <% if (showCustomInput) { %>\n      <div class="mlL mmT">\n          <label for="customtestcase"><input type="checkbox" id="customtestcase"><span class="lmT msL">Use a custom test case</span></label>\n          <textarea rows="5" id="custominput" style="display:none"></textarea>\n      </div>\n      <% } %>\n  </div>\n</div>',_create:function(){var e,i;return this.ele_name=this.element.context.id,e=t(this.element),this.options=t.extend(this._options,this.options),this.current_code=e.html(),e.empty(),e.append(r.template(this.headerTemplate,this.options)),e.append(r.template(this.bodyTemplate,this.options)),e.append(r.template(this.footerTemplate,this.options)),i=this,this.codeEditor=this._initCodeEditor(e.find("textarea#codeview")[0]),this.options.showNonEditableHeadTail&&(this.codeEditorHead=this._initCodeEditor(e.find("textarea#codeheadview")[0],!0),this.codeEditorTail=this._initCodeEditor(e.find("textarea#codetailview")[0],!0)),this.codeEditor.on("update",function(){return i._updateStatusBar(i)}),this.codeEditor.on("cursorActivity",function(e){return i._updateStatusPosition(e)}),this.options.showNonEditableHeadTail&&(this.codeEditorHead.on("cursorActivity",function(e){return i._updateStatusPosition(e)}),this.codeEditorTail.on("cursorActivity",function(e){return i._updateStatusPosition(e)})),this.codeEditor.on("change",function(){return i._saveLangCode(i),i.options.showNonEditableHeadTail?i._updateTailEditorLineNumber():void 0}),this.codeEditor.on("viewportChange",function(){return i._growEditor()}),this.changeLanguage("cpp"),this.changeLanguage(e.find("#select-lang").select2("val")),this._shiftPressed=!1,this.options.enableIntellisense&&this.codeEditor.on("keyup",function(e,t){16===t.keyCode&&(i._shiftPressed=!1),190===t.keyCode&&i._shiftPressed===!1&&i._enableIntellisenseFunc(e)}),this.options.enableIntellisense&&this.codeEditor.on("keydown",function(e,t){16===t.keyCode&&(i._shiftPressed=!0),i._autoCompleteReqestStatus===!0&&(i._autoCompleteReqestStatus=!1)}),this.codeEditor.on("blur",function(){return i._autoCompleteReqestStatus===!0?i._autoCompleteReqestStatus=!1:void 0}),e.find("#select-lang").change(function(e){return i._changeLanguage(e,i)}),e.find("#save-code").click(function(e){return i._saveCode(e,i)}),e.find("#select-lang").on("select2-close",function(){return setTimeout(function(){return i._focusEditor(i)},100)}),e.find(".editor-mode-button").click(function(e){return i._setEditorMode(e,i),i._updateStatusBar(i)}),e.find("button.bb-compile").click(function(){var e;return i.options.showFileTree?(i._checkAndSave(null,null,i),e={}):(e={code:i.codeEditor.getValue(),language:i.options.language},i.options.showCustomInput&&t(i.element).find("#customtestcase").attr("checked")&&(e.custominput=t(i.element).find("#custominput").val())),i._trigger("compile",{},e)}),e.find("button.bb-submit").click(function(){var e;return i.options.showFileTree?(i._checkAndSave(null,null,i),e={}):(e={code:i.codeEditor.getValue(),language:i.options.language},i.options.showCustomInput&&t(i.element).find("#customtestcase").attr("checked")&&(e.custominput=t(i.element).find("#custominput").val())),i._trigger("submit",{},e)}),e.find("#customtestcase").click(function(){return t(i.element).find("#custominput").toggle(this.checked)}),e.find("#show-preferences").click(function(n){return function(r){var i;return i=e.find("#pref-pane"),"none"===i.css("display")?(t(r.currentTarget).find("i").addClass("green-color"),i.show(),n.element.find("#tab-spaces").val(n.codeEditor.options.tabSize)):(t(r.currentTarget).find("i").removeClass("green-color"),i.hide())}}(this)),e.find("#editor-theme").change(function(e){return function(n){return e._changeTheme(t(n.currentTarget).val())}}(this)),e.find("#tab-spaces").keyup(function(e){return function(n){return e._setTabSize(t(n.currentTarget).val())}}(this)),e.find(".fork-this-version").click(function(n){return function(i){var o;return n.options.versionIds&&n.options.versionIds.length<20?(o=".fork-dialog",void 0===n.ActiveVersionId||null===n.ActiveVersionId?e.find(".fork-dialog .version-seq").html("Current Buffer"):e.find(".fork-dialog .version-seq").html("Buffer #"+(r.indexOf(n.options.versionIds,n.ActiveVersionId)+1))):o=".fork-limit-reached-dialog","none"===n.element.find(o).css("display")?(n.element.find(o).show(),t(i.currentTarget).find("i").addClass("green-color")):(n.element.find(o).hide(),t(i.currentTarget).find("i").removeClass("green-color"))}}(this)),e.find(".show-version-timeline").click(function(e){return function(n){return"none"===e.element.find(".version-timeline").css("display")?(e.element.find(".version-timeline").show(),t(n.currentTarget).find("i").addClass("green-color")):(e.element.find(".version-timeline").hide(),t(n.currentTarget).find("i").removeClass("green-color"))}}(this)),this.options.enableIntellisense&&this._initializeAutoComplete(),this._suggestionBoxDisplayStatus=!1,this._autoCompleteReqestStatus=!1,this._supportedLanguages=["java","c","cpp","csharp","ruby"],this._bindVersionBall(),this._bindCurrentVersionBall(),e.find(".fork-version").click(function(e){return function(n){var r;return r="orphan"===t(n.currentTarget).attr("data-action")?{code:i._getDefaultLangCode(i.options.language),language:i.options.language}:{code:e.codeEditor.getValue(),language:e.options.language},e._forkNewBuffer(r)}}(this)),e.find(".close-fork-dialog").click(function(e){return function(){return e.element.find(".fork-dialog").hide(),e.element.find(".fork-this-version").find("i").removeClass("green-color")}}(this)),e.find(".close-fork-limit-reached-dialog").click(function(e){return function(){return e.element.find(".fork-limit-reached-dialog").hide(),e.element.find(".fork-this-version").find("i").removeClass("green-color")}}(this)),e.find(".delete-active-version").click(function(n){return function(i){return t(i.currentTarget).find("i").hasClass("green-color")?(t(i.currentTarget).find("i").removeClass("green-color"),e.find(".delete-version-dialog").hide()):null!==n.ActiveVersionId?(t(i.currentTarget).find("i").addClass("green-color"),e.find(".delete-version-dialog").find(".version-seq").html("Buffer #"+(r.indexOf(n.options.versionIds,n.ActiveVersionId)+1)),e.find(".delete-version-dialog").show(),e.find(".delete-version-dialog").find(".delete-version-button").attr("data-version-id",n.ActiveVersionId)):void 0
}}(this)),e.find(".delete-version-button").click(function(n){return function(){var o,s;return s=parseInt(e.find(".delete-version-button").attr("data-version-id")),o=r.indexOf(n.options.versionIds,s),i=n,t.ajax({url:n.options.versioningRestUrl,type:"DELETE",data:{version_id:s},success:function(){var t;return i.options.versionIds=r.reject(i.options.versionIds,function(e){return e===s}),i.element.find(".version-ball[data-version-id="+s+"]").remove(),t=o<i.options.versionIds.length?i.element.find(".version-ball[data-version-id="+i.options.versionIds[o]+"]"):i.element.find(".current-version-ball"),t.click(),e.find(".delete-active-version").find("i").removeClass("green-color"),e.find(".delete-version-dialog").hide()}})}}(this)),null===e.find("#select-lang").val()&&e.find("#select-lang").select2("val",this.options.languages[0]),e.find("#select-lang").trigger("change"),this._trigger("compile",{},{}),this._changeTheme(),this._setTabSize(this.codeEditor.options.tabSize),this.options.showFileTree&&(i.options.mime_lang_mapping={},r.each(i.options.lang_mime_mapping,function(e,t){return i.options.mime_lang_mapping[e]=t}),i=this,this.currentFile=null,this.fileTree=e.find("#filetree").jstree({core:{multiple:!1,data:this.options.showFileTree.data,check_callback:function(e,n,r,o){var s;switch(s=function(e,n){var r;return null==n&&(n=null),e?(r=t.jstree.reference("#filetree"),n&&e.id!==n&&r.set_id(e,n),r.refresh_node(e)):void 0},e){case"create_node":i.options.showFileTree.onCreate&&i.options.showFileTree.onCreate(n,r,s);break;case"rename_node":n.text!==o&&i.options.showFileTree.onRename&&i.options.showFileTree.onRename(n,r,o,s);break;case"delete_node":i.options.showFileTree.onDelete&&i.options.showFileTree.onDelete(n,r,s)}return!0}},types:{file:{icon:"jstree-file"}},contextmenu:{items:function(e){var n;return n=t.jstree.defaults.contextmenu.items(),delete n.ccp,i.options.showFileTree.onRename||delete n.rename,i.options.showFileTree.onDelete||delete n.remove,i.options.showFileTree.onCreate?(delete n.create.action,n.create.label="New",n.create.submenu={create_folder:{separator_after:!0,label:"Folder",action:function(e){var n,r;return n=t.jstree.reference(e.reference),r=n.get_node(e.reference),"file"===r.type&&(r=n.get_node(r.parent)),n.create_node(r,{id:Date.now().toString(36),text:"New_Folder",type:"default"},"last",function(e){return setTimeout(function(){return n.edit(e)},0)})}},create_file:{label:"File",action:function(e){var n,r;return n=t.jstree.reference(e.reference),r=n.get_node(e.reference),"file"===r.type&&(r=n.get_node(r.parent)),n.create_node(r,{id:Date.now().toString(36),text:"New_File",type:"file"},"last",function(e){return setTimeout(function(){return n.edit(e)},0)})}}},this.get_type("file"===e)&&delete n.create):delete n.create,n}},plugins:["wholerow","types","contextmenu"]}).on("activate_node.jstree",function(e,t){return i._checkAndSave(e,t,i)})),n.codeEditor=this.codeEditor},_checkAndSave:function(e){return function(n,r,i){var o;return n=t(e.element),r?"file"===r.node.type?(i._showLoading(),i.currentFile&&!i.currentFile.original.readOnly&&(o=i.value(),i.currentFile.original.fileContents.code!==o.code&&(i.currentFile.original.fileContents=o,i.options.showFileTree.onSave(i.currentFile))),r.node.original.fileContents?(i.currentFile=r.node,i.setValue(r.node.original.fileContents)):i.options.showFileTree.fetch(r,function(e){var n;return n=i.options.mime_lang_mapping[e.node.original.fileContents.mime_type],e.node.original.fileContents.language=n?n:"text",e.node.id!==t("#filetree").jstree("get_selected")[0]&&i.currentFile?void 0:(i.currentFile=e.node,i.setValue(e.node.original.fileContents))}),r.node.original.readOnly?i.codeEditor.setOption("readOnly",!0):i.codeEditor.setOption("readOnly",!1)):void 0:(i.currentFile&&!i.currentFile.original.readOnly&&(o=i.value(),i.currentFile.original.fileContents.code!==o.code&&(i.currentFile.original.fileContents=o,i.options.showFileTree.onSave(i.currentFile))),void 0)}}(this),_initializeAutoComplete:function(){var e;return e=t(this.element),"undefined"==typeof t.cookie("enableIntellisenseUserPref")?(e.find("#auto-complete").prop("checked",!0),t.cookie("enableIntellisenseUserPref","true")):"true"===t.cookie("enableIntellisenseUserPref")?e.find("#auto-complete").prop("checked",!0):"false"===t.cookie("enableIntellisenseUserPref")?e.find("#auto-complete").prop("checked",!1):(e.find("#auto-complete").prop("checked",!0),t.cookie("enableIntellisenseUserPref","true")),e.find("#auto-complete").click(function(){return function(){e.find("#auto-complete").is(":checked")?t.cookie("enableIntellisenseUserPref","true"):t.cookie("enableIntellisenseUserPref","false")}}(this))},_copyToCurrentBuffer:function(e){var n,r;return n=t(this.element),n.find(".version-ball").removeClass("green-bkg"),n.find(".version-name").html("Current Buffer"),n.find(".version-meta").html("(saved locally, editable)"),n.find(".current-version-ball").hasClass("green-bkg")||n.find(".current-version-ball").addClass("green-bkg"),this.versionGetXhr&&void 0===this.versionGetXhr.status&&this.versionGetXhr.abort(),this._showLoading("Loading current buffer... "),this.codeEditor.setOption("readOnly",!1),this.setValue(e),this.ActiveVersionId=null,this.saveLangCode(),r=this,setTimeout(function(){return r._hideLoading(),t(r.element).find(".dummy-lang-container").hide(),t(r.element).find("#select-lang").siblings(".select2-container").show(),r.element.find(".delete-active-version").hide(),r.ActiveVersionId=null},100)},_forkNewBuffer:function(e){var n,r,i;return null==e&&(e=null),r=t(this.element),n=void 0===this.ActiveVersionId||null===this.ActiveVersionId?{code:this.codeEditor.getValue(),language:this.options.language}:{code:this._getLangCode(this.currentBufferLang),language:this.currentBufferLang},this._showLoading("Saving previous buffer on cloud... "),this.element.find(".close-fork-dialog").click(),i=this,t.ajax({url:this.options.versioningRestUrl,type:"POST",data:n,success:function(t){return e&&i._copyToCurrentBuffer(e),i._hideLoading(),"none"===r.find(".version-timeline").css("display")&&r.find(".show-version-timeline").click(),r.find(".version-ball").removeClass("green-bkg"),r.find(".version-ball").hasClass("green-bkg")||r.find(".current-version-ball").addClass("green-bkg"),i._addNewVersion(t.id)}})},forkNewBuffer:function(e){var t,n;return this.options.enableVersioning?this.options.versionIds&&this.options.versionIds.length<20?(this._forkNewBuffer(e),n=this,setTimeout(function(){return n.saveLangCode()},0)):(t=".fork-limit-reached-dialog","none"===this.element.find(t).css("display")?(this.element.find(t).show(),this.element.find(".fork-this-version i").addClass("green-color")):(this.element.find(t).hide(),this.element.find(".fork-this-version i").removeClass("green-color"))):this.setValue(e)},_bindCurrentVersionBall:function(){var e;return e=t(this.element),e.find(".current-version-ball").click(function(e){return function(){var t;return t={code:e._getLangCode(e.currentBufferLang||e.options.language),language:e.currentBufferLang||e.options.language},e._copyToCurrentBuffer(t)}}(this))},_bindVersionBall:function(){var e;return e=t(this.element),e.find(".version-ball").unbind("click").click(function(n){return function(i){var o,s,a;return s=parseInt(t(i.currentTarget).attr("data-version-id")),a=r.indexOf(n.options.versionIds,s)+1,e.find(".current-version-ball").hasClass("green-bkg")&&(n.currentBufferLang=n.options.language,n.saveLangCode()),n.element.find(".delete-active-version").hide(),e.find(".version-name").html("Buffer #"+a),e.find(".version-meta").html("(saved on cloud, read-only)"),e.find(".version-ball").removeClass("green-bkg"),e.find(".current-version-ball").removeClass("green-bkg"),t(i.currentTarget).hasClass("green-bkg")||t(i.currentTarget).addClass("green-bkg"),o=n,n._showLoading("Looking up cloud for buffer #"+a+"... "),n.versionGetXhr&&void 0===n.versionGetXhr.status&&n.versionGetXhr.abort(),n.versionGetXhr=t.ajax({url:n.options.versioningRestUrl,type:"GET",data:{version_id:s},success:function(e){return o.setValue({code:e.source,language:e.language}),o.codeEditor.setOption("readOnly",!0),t(o.element).find(".dummy-lang-container").html(o.options.lang_display_mapping[e.language]).show(),t(o.element).find("#select-lang").siblings(".select2-container").hide(),o._hideLoading(),o.ActiveVersionId=s,o.element.find(".delete-active-version").show()}})}}(this))},_addNewVersion:function(e){var t;return-1===r.indexOf(this.options.versionIds,e)?(this.options.versionIds.push(e),this.options.versionIds=r.sortBy(this.options.versionIds,function(e){return e}),t=null,r.each(this.options.versionIds,function(e){var n;return 0===this.element.find(".version-ball[data-version-id="+e+"]").length&&(n=null!==t?this.element.find(".version-ball[data-version-id="+t+"]"):this.element.find(".start-slab"),n.after("<div class='version-ball pull-left cursor' data-version-id='"+e+"'></div>"),this._bindVersionBall()),t=e},this)):void 0},_updateStatusBar:function(){var e;return e=function(){switch(this.codeEditor.options.keyMap){case"vim":return"--VIM--";case"vim-insert":return"-- INSERT --";case"emacs":return"EMACS";case"emacs-Ctrl-X":return"C-x-";default:return""}}.call(this),t(this.element).find("#statusbar-mode").text(e)},_updateStatusPosition:function(e){var n,r;return n=e.doc.getCursor(),r=e.getOption("firstLineNumber"),e=t(this.element),e.find("#statusbar-line").text("Line: "+(n.line+r)),e.find("#statusbar-col").text("Col: "+(n.ch+1))},_getThemeName:function(e){return"dark"===e?"ambiance":"default"},_changeTheme:function(e){return null==e&&(e=null),e||(e=t.cookie("hacker_editor_theme")),"dark"!==e&&"light"!==e&&(e="light"),t.cookie("hacker_editor_theme",e),this.element.find("select#editor-theme option[value="+e+"]").attr("selected",!0),this.codeEditor.setOption("theme",this._getThemeName(e)),this.codeEditor.refresh()},_setTabSize:function(e){return e=parseInt(e),r.isNumber(e)&&!r.isNaN(e)&&this.codeEditor.options.tabSize!==e?(this._saveUserOpts({tabSize:e,indentUnit:e}),this.codeEditor.setOption("tabSize",e),this.codeEditor.setOption("indentUnit",e)):void 0},_parseJson:function(e,n){var r,i;return r=[],i=this,t.each(e,function(e,t){var i;i={},i.text=t.completion,""===t.type&&(t.type=" "),i.displayText=t.menu,i.type=t.type,i.completion=t.completion,i.menu=t.menu,i.info=t.info,n===!0&&(i.render=function(e,t,n){var r,i,o;(" "===n.type||""===n.type)&&(n.type="("===n.completion[n.completion.length-1]||")"===n.completion[n.completion.length-1]?"f":"v"),"("===n.completion[n.completion.length-1]&&(n.completion+=")"),o=document.createElement("DIV"),o.className="CodeMirror-hint-divTypeText",o.appendChild(document.createTextNode(n.type)),r=document.createElement("DIV"),r.className="CodeMirror-hint-divCompletionText",r.appendChild(document.createTextNode(" "+n.completion+" ")),i=document.createElement("DIV"),i.className="CodeMirror-hint-divMenuText",i.appendChild(document.createTextNode(n.menu+" ")),e.appendChild(o),e.appendChild(r),e.appendChild(i),e.style.display="table-row"}),r.push(i)}),r},_updateLoadingMessage:function(e,t){var n,r;n=!0,r={completeSingle:!1,hint:function(e){var r;return n===!0?n=!1:t=[],r={from:e.getCursor(),to:e.getCursor(),list:[]},r.list=t,r}},i.showHint(e,r.hint,r)},_cleanToken:function(e){var t,n;for(n=0;n<e.length&&(t=e.charCodeAt(n),!(t>47&&58>t||t>64&&91>t||t>96&&123>t||"_"===e[n]));)n++;return e=e.substr(n)},_filterSuggestions:function(e,t){var n,r,i,o,s,a;for(t=t.toLowerCase(),n=[],r=0;r<e.length;){for(a=e[r].text.toLowerCase(),i=1,s=0,o=0;o<t.length;){for(;a[s]!==t[o]&&s<a.length;)s++;if(s===a.length){i=0;break}o++}1===i&&n.push(e[r]),r++}return n},_adjustHeightSuggestionBox:function(e){var r,i,o,s,a,l,c,d,h,u;o=this.codeEditor,d=o.cursorCoords(o.getCursor()),u=n.innerWidth||Math.max(document.body.offsetWidth,document.documentElement.offsetWidth),h=n.innerHeight||Math.max(document.body.offsetHeight,document.documentElement.offsetHeight),i=e.getBoundingClientRect(),s=t("#CodeMirror-hint-infoDiv")[0],r=s.offsetHeight,a=i.bottom+r-i.top,a>h?(e.style.height=h-5-r+"px",c=parseInt(e.style.top.substr(0,e.style.top.length-2),10),c+=h-5-r,t(s).css("top",c+"px")):(l=parseInt(e.style.top.substr(0,e.style.top.length-2),10),l<d.top&&l+(i.bottom-i.top)+r!==d.top&&(e.style.top=d.top-r-(i.bottom-i.top)+"px",c=d.top-r,t(s).css("top",c+"px")))},_adjustWidthSuggestionBox:function(e){var n,r,i,o,s;r=this.codeEditor,s=r.cursorCoords(r.getCursor()),n=e.getBoundingClientRect(),i=t(r.display.wrapper),o=i.offset(),i.width()>n.width?o.left+i.width()>=n.right?e.style.width=n.width:(e.style.width=n.width,e.style.left=s.left-(n.right-(o.left+i.width()))-5+"px"):(e.style.left=o.left+"px",e.style.width=i.width()+"px")},_setMaxWidthCompletionText:function(e){var t,n,r,i,o,s;if(n=e.getElementsByClassName("CodeMirror-hint-divCompletionText"),n.length>0)for(r=n.length-1;r>=0;)o=n[r],i=void 0,s=void 0,i=e.style.width,i=parseInt(i.substr(0,i.length-2)),t=o.offsetWidth,t>i&&(t=i-40,o.style.maxWidth=t+"px",o.style.textOverflow="ellipsis"),r--},_setMaxWidthMenuText:function(e){var t,n,r,i,o;if(t=e.getElementsByClassName("CodeMirror-hint-divMenuText"),t.length>0)for(n=t.length-1;n>=0;)r=t[n],i=e.style.width,i=parseInt(i.substr(0,i.length-2)),o=r.offsetLeft,i-=o,r.style.maxWidth=i-20+"px",n--},_removeShowHintWidget:function(e){this._updateSuggestions(e,[])},_updateSuggestions:function(e,n){var r,o,s;o=n,s=this,r={completeSingle:!1,hint:function(e){var r,a;return n=o,a=e.getTokenAt(e.getCursor()).string,a=s._cleanToken(a),a.length>0&&(n=s._filterSuggestions(n,a)),r={from:e.getCursor(),to:e.getCursor(),list:[]},r.list=n,i.on(r,"shown",function(){s._suggestionBoxDisplayStatus=!0}),i.on(r,"close",function(){t("#CodeMirror-hint-infoDiv").remove(),s._suggestionBoxDisplayStatus=!1}),i.on(r,"select",function(e,n){var r,i,o,a;s._adjustWidthSuggestionBox(t(".CodeMirror-hints")[0]),s._setMaxWidthMenuText(t(".CodeMirror-hints")[0]),s._setMaxWidthCompletionText(t(".CodeMirror-hints")[0]),(e.menu.length>0||e.info.length>0)&&(e.info===e.menu&&(e.info=""),t("#CodeMirror-hint-infoDiv").length>0?(t("#CodeMirror-hint-infoDivMenu").text(e.menu),t("#CodeMirror-hint-infoDivInfo").text(e.info),t("#CodeMirror-hint-infoDiv").css("width",t(n).parent().css("width")),t("#CodeMirror-hint-infoDiv").css("left",t(n).parent().css("left")),r=parseInt(t(n).parent().css("top").substr(0,t(n).parent().css("top").length-2),10),r+=parseInt(t(n).parent().css("height").substr(0,t(n).parent().css("height").length-2),10),t("#CodeMirror-hint-infoDiv").css("top",r+"px")):(i=document.createElement("ul"),i.id="CodeMirror-hint-infoDiv",t(n.parentNode.parentNode).append(t(i)),t(i).css("width",t(n).parent().css("width")),t(i).css("left",t(n).parent().css("left")),r=parseInt(t(n).parent().css("top").substr(0,t(n).parent().css("top").length-2),10),r+=parseInt(t(n).parent().css("height").substr(0,t(n).parent().css("height").length-2),10),t(i).css("top",r+"px"),a=document.createElement("span"),a.id="CodeMirror-hint-infoDivMenu",t(a).css("color","blue"),t(a).text(e.menu),o=document.createElement("span"),o.id="CodeMirror-hint-infoDivInfo",t(o).css("color","#D757FA"),t(o).css("margin-left","10px"),t(o).text(e.info),t(i).append(t(a)),t(i).append(t(o)))),s._adjustHeightSuggestionBox(t(".CodeMirror-hints")[0])}),i.on(r,"pick",function(){var t,n,i;t=r.to.ch-a.length,i={},i.line=r.from.line,i.ch=t,n={},n.line=r.to.line,n.ch=r.to.ch,e.replaceRange("",i,n)}),r}},i.showHint(e,r.hint,r)},_getLoadingData:function(){var e;return e=[],e.push({type:"",completion:"",menu:"Loading hints...   ",info:""}),e},_showAutoCompleteLoadingMsg:function(e){var t,n;t=this._getLoadingData(),n=this._parseJson(t,!1),this._updateLoadingMessage(e,n)},_enableIntellisenseFunc:function(n){var r,i,o,s,a;return i=t(this.element),i.find("#auto-complete").prop("checked")!==!1?(o=this.options.language,e.call(this._supportedLanguages,o)>=0?(this._autoCompleteReqestStatus=!0,r=this._getFullCodeOffsetLanguage(n),s=[],a=this,t.ajax({type:"POST",url:"https://autocomplete.hackerrank.com/autocomplete",data:r,dataType:"json",success:function(e){return e.msg?(console.log("No suggestions obtained - error"),a._removeShowHintWidget(n),void 0):(a._autoCompleteReqestStatus===!0&&(s=a._parseJson(e,!0),a._updateSuggestions(n,s)),void 0)}})):(this._removeShowHintWidget(n),void 0)):void 0},_getFullCodeOffsetLanguage:function(e){var t,n,r,i,o,s,a,l,c,d;for(i=this.options.language,n="",this.options.showNonEditableHeadTail===!0&&(r=this._getLangHeadCode(i),0!==r.length&&(n+=r)),n+="\n",a=n.split("\n").length,a-=1,l=n.length,o=e.getCursor(),s=0;s<o.line;)l+=e.getLine(s).length+1,s++;return l+=o.ch,n+=e.getValue(),n+="\n",this.options.showNonEditableHeadTail===!0&&(c=this._getLangTailCode(i),0!==c.length&&(n+=c)),n+="\n",d=e.getTokenAt(o).string,d=this._cleanToken(d),t={column:o.ch+1,WantDocumentationForEveryCompletionResult:"false",line:o.line+1+a,wordToComplete:d,code:n,offset:l,fileType:i}},_initCodeEditor:function(n,r){var o,s,a,l,c;return null==r&&(r=!1),s=this._getUserOpts(),o=t(this.element),o.find(".editor-mode-button[data-editor="+s.keyMap+"]").addClass("disabled"),a=o.find("#select-lang"),a.select2({width:"off"}),this._initAutoSave(),s.userPreferredLang&&(c=s.userPreferredLang,e.call(this.options.languages,c)>=0)?(a.select2("val",s.userPreferredLang),s.mode=this.options.lang_mime_mapping[s.userPreferredLang]):(a.select2("val",this.options.language),s.mode=this.options.lang_mime_mapping[this.options.language]),l=this,this.options.enableIntellisense&&"emacs"!==s.keyMap&&(s.extraKeys["Ctrl-Space"]=function(e){l._showAutoCompleteLoadingMsg(e),l._enableIntellisenseFunc(e)}),s.readOnly=r,i.fromTextArea(n,s)},_changeLanguage:function(e){return this.changeLanguage(t(e.currentTarget).select2("val"))},changeLanguage:function(e,t){return null==t&&(t=null),null!==e?(this.newLanguage=e,this.options.dynamicMode?(this._showLoading(),this._trigger("loadmode",{},{lang:e,callback:function(e){return function(){return e._changeMode(t)}}(this)})):this._changeMode(t)):void 0},_showLoading:function(e){return null==e&&(e="Loading Editor... "),t(this.element).find(".code-body, .code-head, .code-tail").hide(),t(this.element).find(".loading-mode").html(e).show()},_hideLoading:function(){return t(this.element).find(".code-body, .code-head, .code-tail").show(),t(this.element).find(".loading-mode").hide()},_changeMode:function(e){var n,r,i;return null==e&&(e=null),this._hideLoading(),r=this.newLanguage,n=this.options.language,this.options.language=r,this.options.showFileTree||this.codeEditor.setValue(this._getLangCode(r)),this._foldCode(),this.options.showNonEditableHeadTail&&this._displayHeadAndTail(r),this._saveUserOpts({userPreferredLang:r}),this.codeEditor.setOption("mode",this.options.lang_mime_mapping[r]),this.options.showNonEditableHeadTail===!1&&this._setMainEditorLineNumber(r),i=t(this.element).find("#select-lang"),i.select2("val",r),this.codeEditor.clearHistory(),this._trigger("languagechange",{},{from:n,to:r}),null!==e?e():void 0},_saveCode:function(e){return e.preventDefault(),this.options.onSave?this.options.onSave():void 0},_initAutoSave:function(){var e,t;return this.options.autoSave&&this.options.onSave?(t=parseInt(this.options.autoSave,10),e=this.options.onSave,this._autoSaveCode(t,e)):void 0},_autoSaveCode:function(e,t){return t(),setInterval(this._autoSaveCode,e,e,t)},_setEditorMode:function(e){var n,r;return n=t(e.currentTarget).attr("data-editor"),t(e.currentTarget).parent().find(".editor-mode-button").removeClass("disabled"),t(e.currentTarget).addClass("disabled"),this.codeEditor.setOption("keyMap",n),r=this,"emacs"===n?delete this.codeEditor.options.extraKeys["Ctrl-Space"]:this.codeEditor.options.extraKeys["Ctrl-Space"]=function(e){r._showAutoCompleteLoadingMsg(e),r._enableIntellisenseFunc(e)},this._focusEditor(e),this._saveUserOpts({keyMap:n})},_focusEditor:function(){return this.codeEditor.focus()},_getDefaultLangCode:function(e){var t,n,r,i,o;if(this.options.showTemplate&&!this.options.showNonEditableHeadTail){if(void 0!==this.options.lang_head_template[e]||void 0!==this.options.lang_body_template[e]||void 0!==this.options.lang_tail_template[e]||void 0!==this.options.lang_template[e])return i=function(e){var t,n;return t=new Array(4).join(" "),n="	",void 0===e?"":e.split(n).join(t)},o=function(e){return e&&-1===e.indexOf("\n",e.length-1)?""+e+"\n":e},n=o(i(this.options.lang_head_template[e]||"")),t=o(i(this.options.lang_template[e]||this.options.lang_body_template[e]||"")),r=o(i(this.options.lang_tail_template[e]||"")),""+n+t+r}else if(this.options.lang_template[e]||this.options.lang_body_template[e]||this.options.lang_default_text[e])return this.options.lang_template[e]||this.options.lang_body_template[e]||this.options.lang_default_text[e];return""},_getLangCode:function(e){var n;return this.options.autoSaveNamespace&&(n=t.jStorage.get(this.getCurrentAutosavekey(e)),n&&!t.jStorage.get(""+this.getCurrentAutosavekey(e)+"-default_template"))?n:this._getDefaultLangCode(e)},_getLangHeadCode:function(e){return this.options.lang_head_template[e]?this.options.lang_head_template[e]:""},_getLangTailCode:function(e){return this.options.lang_tail_template[e]?this.options.lang_tail_template[e]:""},_displayHeadAndTail:function(e){var n,r,i;return n=t(this.element),0!==this._getLangHeadCode(e).length?(this.codeEditorHead.setValue(this._getLangHeadCode(e)),r=this.codeEditorHead.getValue().split("\n").length,this.codeEditor.setOption("firstLineNumber",r+1),this.codeEditorHead.setOption("mode",this.options.lang_mime_mapping[e])):n.find(".code-head").hide(),0!==this._getLangTailCode(e).length?(this.codeEditorTail.setValue(this._getLangTailCode(e)),this._updateTailEditorLineNumber(),this.codeEditorTail.setOption("mode",this.options.lang_mime_mapping[e])):n.find(".code-tail").hide(),i=n.find(".code-head").height(),n.find(".code-editors").scrollTop(i-60)},_updateTailEditorLineNumber:function(){var e,t;return e=this.codeEditorHead.getValue().split("\n").length,t=this.codeEditor.getValue().split("\n").length,this.codeEditorTail.setOption("firstLineNumber",e+t+1)},_setMainEditorLineNumber:function(e){return this.options.lang_line_nos&&this.options.lang_line_nos[e]?this.codeEditor.setOption("firstLineNumber",this.options.lang_line_nos[e]):this.codeEditor.setOption("firstLineNumber",1)},_growEditor:function(){var e;return e=this.element.find(".code-body").height(),300>e&&(e=300),this.element.find(".code-editors, #filetree").css("max-height",""+(e+110)+"px"),this.options.showFileTree?this.element.find("#filetree").css("max-height",""+e+"px"):void 0},_saveLangCode:function(){var e,t,r;return void 0===this.ActiveVersionId||null===this.ActiveVersionId?(e=new Date,t=""+this.options.language+e.getHours()+e.getMinutes(),n[t]&&clearTimeout(n[t]),r=this,n[t]=setTimeout(function(){return r.saveLangCode()},3e3)):void 0},saveLangCode:function(){var e,n,r;return void 0!==this.ActiveVersionId&&null!==this.ActiveVersionId||(r=this.options,!r.autoSaveNamespace||r.lang_mime_mapping[r.language]!==this.codeEditor.options.mode)?void 0:(n=this.getCurrentAutosavekey(),e=this.codeEditor.getValue(),t.jStorage.set(""+n+"-default_template",this._getDefaultLangCode(r.language)===e||this.options.lang_default_text[r.language]===e),t.jStorage.set(n,e))},getCurrentAutosavekey:function(e){var t;return null==e&&(e=null),t=this.options,null===e&&(e=t.language),t.autoSaveNamespace&&t.language?""+t.autoSaveNamespace+"-"+e:""},_getUserOpts:function(){var e,n;return e={lineNumbers:!0,lineWrapping:!0,styleActiveLine:!0,autoCloseBrackets:!0,autoCloseTags:!0,indentWithTabs:!1,matchBrackets:!0,keyMap:"default",userPreferredLang:null,indentUnit:4},n={extraKeys:{Tab:function(e){var t,n,r;return t=e.coordsChar(e.cursorCoords()).ch,n=t%e.getOption("indentUnit"),r=Array(e.getOption("indentUnit")+1-n).join(" "),e.replaceSelection(r,"end","+input")}},foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"]},t.extend(t.extend(e,t.parseJSON(t.jStorage.get("codeshellUserOpts"))),n)},_saveUserOpts:function(e){var n;return n=t.extend(this._getUserOpts(),e),t.jStorage.set("codeshellUserOpts",JSON.stringify(n))},value:function(e){var t;return null==e&&(e=!1),e?this.options.showFileTree?(this._checkAndSave(null,null,this),{}):(t=[],r.each(this.options.languages,function(e){return function(n){return n===e.options.language?t.push(e.value()):t.push({code:e._getLangCode(n),language:n})}}(this)),t):{code:this.codeEditor.getValue(),language:this.options.language}},_foldCode:function(){var e,t,n,r,o,s,a,l,c,d,h;if(this.options.foldCode){for(o=this.codeEditor.getValue(),a=0,e=!1,t=!1,l=(o||"").split("\n"),h=[],c=0,d=l.length;d>c;c++)s=l[c],a+=1,e||t||-1===s.indexOf("Head ends")||(n=function(){return{from:{ch:0,line:0},to:{ch:0,line:a}}},i.newFoldFunction(n)(this.codeEditor,{}),e=!0),t||-1===s.indexOf("Tail starts")?h.push(void 0):(r=function(){return{from:{ch:0,line:a-1},to:{ch:0,line:l.length}}},i.newFoldFunction(r)(this.codeEditor,{}),h.push(t=!0));return h}},setValue:function(e){return e.language?this.changeLanguage(e.language,function(t){return function(){return e.code?(t.codeEditor.setValue(e.code),t._foldCode()):void 0}}(this)):void 0},setValueorFork:function(e){var r;return r=this,e.language&&n.HR.forkable===!0?this.changeLanguage(e.language,function(){var i;return e.code?(t.jStorage.get(""+r.getCurrentAutosavekey(e.language))&&(i=r.value().code)!==e.code&&""!==i&&i!==r._getDefaultLangCode(e.language)&&i!==r.options.lang_default_text[e.language]&&n.HR.forkable===!0&&(n.HR.forkable=!1,r._forkNewBuffer(e)),r.setValue(e),r._foldCode()):void 0}):void 0},refresh:function(){return setTimeout(function(e){return function(){return e.codeEditor.refresh()}}(this),25),this.options.showNonEditableHeadTail?(setTimeout(function(e){return function(){return e.codeEditorHead.refresh()}}(this),25),setTimeout(function(e){return function(){return e.codeEditorTail.refresh()}}(this),25)):void 0},onChange:function(e){return null!==e?this.codeEditor.on("change",e):void 0},setOption:function(e,t){return this.codeEditor.setOption(e,t)},getOptions:function(){return this.options},setStatusText:function(e){return null==e&&(e=""),this.options.statusText=e,t(this.element).find("#status-text").html(r.escape(e))},deleteLangCode:function(){var e,n;return n=this.options,n.autoSaveNamespace&&n.lang_mime_mapping[n.language]===this.codeEditor.options.mode?(e=""+n.autoSaveNamespace+"-"+n.language,t.jStorage.deleteKey(e)):void 0},enableCompileBtn:function(){var e;return e=t(this.element).find("button.bb-compile"),e.removeAttr("btn-disabled").removeClass("disabled")},getEditor:function(){return this.codeEditor},destroy:function(){return this._saveLangCode(this),t.Widget.prototype.destroy.call(this)}})})}.call(this);var requirejs=_requirejs;_requirejs=void 0;var require=_require;_require=void 0;var define=_define;_define=void 0;
//# sourceMappingURL=codemirror_basic-f9d713f67c89130b3236224c96812d74.js.map